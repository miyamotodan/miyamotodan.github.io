var La=Object.defineProperty;var Gi=n=>{throw TypeError(n)};var $a=(n,t,r)=>t in n?La(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var Et=(n,t,r)=>$a(n,typeof t!="symbol"?t+"":t,r),ri=(n,t,r)=>t.has(n)||Gi("Cannot "+r);var Oe=(n,t,r)=>(ri(n,t,"read from private field"),r?r.call(n):t.get(n)),_t=(n,t,r)=>t.has(n)?Gi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,r),ht=(n,t,r,a)=>(ri(n,t,"write to private field"),a?a.call(n,r):t.set(n,r),r),st=(n,t,r)=>(ri(n,t,"access private method"),r);var On=(n,t,r,a)=>({set _(o){ht(n,t,o,r)},get _(){return Oe(n,t,a)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const s of u.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(o){if(o.ep)return;o.ep=!0;const u=r(o);fetch(o.href,u)}})();const DEV=!1;var is_array=Array.isArray,index_of=Array.prototype.indexOf,array_from=Array.from,define_property=Object.defineProperty,get_descriptor=Object.getOwnPropertyDescriptor,get_descriptors=Object.getOwnPropertyDescriptors,get_prototype_of=Object.getPrototypeOf;const noop$4=()=>{};function run(n){return n()}function run_all(n){for(var t=0;t<n.length;t++)n[t]()}const DERIVED=2,EFFECT=4,RENDER_EFFECT=8,BLOCK_EFFECT=16,BRANCH_EFFECT=32,ROOT_EFFECT=64,BOUNDARY_EFFECT=128,UNOWNED=256,DISCONNECTED=512,CLEAN=1024,DIRTY=2048,MAYBE_DIRTY=4096,INERT=8192,DESTROYED=16384,EFFECT_RAN=32768,EFFECT_TRANSPARENT=65536,LEGACY_DERIVED_PROP=1<<17,HEAD_EFFECT=1<<19,EFFECT_HAS_DERIVED=1<<20,STATE_SYMBOL=Symbol("$state"),LEGACY_PROPS=Symbol("legacy props"),LOADING_ATTR_SYMBOL=Symbol("");function equals(n){return n===this.v}function safe_not_equal(n,t){return n!=n?t==t:n!==t||n!==null&&typeof n=="object"||typeof n=="function"}function safe_equals(n){return!safe_not_equal(n,this.v)}function effect_in_teardown(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function effect_in_unowned_derived(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function effect_orphan(n){throw new Error("https://svelte.dev/e/effect_orphan")}function effect_update_depth_exceeded(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function state_unsafe_local_read(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function state_unsafe_mutation(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let legacy_mode_flag=!1,tracing_mode_flag=!1;function enable_legacy_mode_flag(){legacy_mode_flag=!0}const EACH_ITEM_REACTIVE=1,EACH_INDEX_REACTIVE=2,EACH_ITEM_IMMUTABLE=16,PROPS_IS_IMMUTABLE=1,PROPS_IS_RUNES=2,TEMPLATE_FRAGMENT=1,TEMPLATE_USE_IMPORT_NODE=2,UNINITIALIZED=Symbol();function lifecycle_outside_component(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let component_context=null;function set_component_context(n){component_context=n}function push$2(n,t=!1,r){component_context={p:component_context,c:null,e:null,m:!1,s:n,x:null,l:null},legacy_mode_flag&&!t&&(component_context.l={s:null,u:null,r1:[],r2:source(!1)})}function pop$1(n){const t=component_context;if(t!==null){const s=t.e;if(s!==null){var r=active_effect,a=active_reaction;t.e=null;try{for(var o=0;o<s.length;o++){var u=s[o];set_active_effect(u.effect),set_active_reaction(u.reaction),effect(u.fn)}}finally{set_active_effect(r),set_active_reaction(a)}}component_context=t.p,t.m=!0}return{}}function is_runes(){return!legacy_mode_flag||component_context!==null&&component_context.l===null}function source(n,t){var r={f:0,v:n,reactions:null,equals,rv:0,wv:0};return r}function mutable_source(n,t=!1){var a;const r=source(n);return t||(r.equals=safe_equals),legacy_mode_flag&&component_context!==null&&component_context.l!==null&&((a=component_context.l).s??(a.s=[])).push(r),r}function mutable_state(n,t=!1){return push_derived_source(mutable_source(n,t))}function push_derived_source(n){return active_reaction!==null&&!untracking&&active_reaction.f&DERIVED&&(derived_sources===null?set_derived_sources([n]):derived_sources.push(n)),n}function mutate(n,t){return set$4(n,untrack(()=>get$4(n))),t}function set$4(n,t){return active_reaction!==null&&!untracking&&is_runes()&&active_reaction.f&(DERIVED|BLOCK_EFFECT)&&(derived_sources===null||!derived_sources.includes(n))&&state_unsafe_mutation(),internal_set(n,t)}function internal_set(n,t){return n.equals(t)||(n.v,n.v=t,n.wv=increment_write_version(),mark_reactions(n,DIRTY),is_runes()&&active_effect!==null&&active_effect.f&CLEAN&&!(active_effect.f&(BRANCH_EFFECT|ROOT_EFFECT))&&(untracked_writes===null?set_untracked_writes([n]):untracked_writes.push(n))),t}function mark_reactions(n,t){var r=n.reactions;if(r!==null)for(var a=is_runes(),o=r.length,u=0;u<o;u++){var s=r[u],c=s.f;c&DIRTY||!a&&s===active_effect||(set_signal_status(s,t),c&(CLEAN|UNOWNED)&&(c&DERIVED?mark_reactions(s,MAYBE_DIRTY):schedule_effect(s)))}}let hydrating=!1;function get_proxied_value(n){return n!==null&&typeof n=="object"&&STATE_SYMBOL in n?n[STATE_SYMBOL]:n}function is$1(n,t){return Object.is(get_proxied_value(n),get_proxied_value(t))}var $window,first_child_getter,next_sibling_getter;function init_operations(){if($window===void 0){$window=window;var n=Element.prototype,t=Node.prototype;first_child_getter=get_descriptor(t,"firstChild").get,next_sibling_getter=get_descriptor(t,"nextSibling").get,n.__click=void 0,n.__className="",n.__attributes=null,n.__styles=null,n.__e=void 0,Text.prototype.__t=void 0}}function create_text(n=""){return document.createTextNode(n)}function get_first_child(n){return first_child_getter.call(n)}function get_next_sibling(n){return next_sibling_getter.call(n)}function child(n,t){return get_first_child(n)}function first_child(n,t){{var r=get_first_child(n);return r instanceof Comment&&r.data===""?get_next_sibling(r):r}}function sibling(n,t=1,r=!1){let a=n;for(;t--;)a=get_next_sibling(a);return a}function clear_text_content(n){n.textContent=""}function derived(n){var t=DERIVED|DIRTY,r=active_reaction!==null&&active_reaction.f&DERIVED?active_reaction:null;return active_effect===null||r!==null&&r.f&UNOWNED?t|=UNOWNED:active_effect.f|=EFFECT_HAS_DERIVED,{ctx:component_context,deps:null,effects:null,equals,f:t,fn:n,reactions:null,rv:0,v:null,wv:0,parent:r??active_effect}}function derived_safe_equal(n){const t=derived(n);return t.equals=safe_equals,t}function destroy_derived_effects(n){var t=n.effects;if(t!==null){n.effects=null;for(var r=0;r<t.length;r+=1)destroy_effect(t[r])}}function get_derived_parent_effect(n){for(var t=n.parent;t!==null;){if(!(t.f&DERIVED))return t;t=t.parent}return null}function execute_derived(n){var t,r=active_effect;set_active_effect(get_derived_parent_effect(n));try{destroy_derived_effects(n),t=update_reaction(n)}finally{set_active_effect(r)}return t}function update_derived(n){var t=execute_derived(n),r=(skip_reaction||n.f&UNOWNED)&&n.deps!==null?MAYBE_DIRTY:CLEAN;set_signal_status(n,r),n.equals(t)||(n.v=t,n.wv=increment_write_version())}function validate_effect(n){active_effect===null&&active_reaction===null&&effect_orphan(),active_reaction!==null&&active_reaction.f&UNOWNED&&active_effect===null&&effect_in_unowned_derived(),is_destroying_effect&&effect_in_teardown()}function push_effect(n,t){var r=t.last;r===null?t.last=t.first=n:(r.next=n,n.prev=r,t.last=n)}function create_effect(n,t,r,a=!0){var o=(n&ROOT_EFFECT)!==0,u=active_effect,s={ctx:component_context,deps:null,nodes_start:null,nodes_end:null,f:n|DIRTY,first:null,fn:t,last:null,next:null,parent:o?null:u,prev:null,teardown:null,transitions:null,wv:0};if(r){var c=is_flushing_effect;try{set_is_flushing_effect(!0),update_effect(s),s.f|=EFFECT_RAN}catch(f){throw destroy_effect(s),f}finally{set_is_flushing_effect(c)}}else t!==null&&schedule_effect(s);var l=r&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(EFFECT_HAS_DERIVED|BOUNDARY_EFFECT))===0;if(!l&&!o&&a&&(u!==null&&push_effect(s,u),active_reaction!==null&&active_reaction.f&DERIVED)){var d=active_reaction;(d.effects??(d.effects=[])).push(s)}return s}function teardown(n){const t=create_effect(RENDER_EFFECT,null,!1);return set_signal_status(t,CLEAN),t.teardown=n,t}function user_effect(n){validate_effect();var t=active_effect!==null&&(active_effect.f&BRANCH_EFFECT)!==0&&component_context!==null&&!component_context.m;if(t){var r=component_context;(r.e??(r.e=[])).push({fn:n,effect:active_effect,reaction:active_reaction})}else{var a=effect(n);return a}}function user_pre_effect(n){return validate_effect(),render_effect(n)}function component_root(n){const t=create_effect(ROOT_EFFECT,n,!0);return(r={})=>new Promise(a=>{r.outro?pause_effect(t,()=>{destroy_effect(t),a(void 0)}):(destroy_effect(t),a(void 0))})}function effect(n){return create_effect(EFFECT,n,!1)}function legacy_pre_effect(n,t){var r=component_context,a={effect:null,ran:!1};r.l.r1.push(a),a.effect=render_effect(()=>{n(),!a.ran&&(a.ran=!0,set$4(r.l.r2,!0),untrack(t))})}function legacy_pre_effect_reset(){var n=component_context;render_effect(()=>{if(get$4(n.l.r2)){for(var t of n.l.r1){var r=t.effect;r.f&CLEAN&&set_signal_status(r,MAYBE_DIRTY),check_dirtiness(r)&&update_effect(r),t.ran=!1}n.l.r2.v=!1}})}function render_effect(n){return create_effect(RENDER_EFFECT,n,!0)}function template_effect(n,t=[],r=derived){const a=t.map(r);return block$1(()=>n(...a.map(get$4)))}function block$1(n,t=0){return create_effect(RENDER_EFFECT|BLOCK_EFFECT|t,n,!0)}function branch(n,t=!0){return create_effect(RENDER_EFFECT|BRANCH_EFFECT,n,!0,t)}function execute_effect_teardown(n){var t=n.teardown;if(t!==null){const r=is_destroying_effect,a=active_reaction;set_is_destroying_effect(!0),set_active_reaction(null);try{t.call(null)}finally{set_is_destroying_effect(r),set_active_reaction(a)}}}function destroy_effect_children(n,t=!1){var r=n.first;for(n.first=n.last=null;r!==null;){var a=r.next;destroy_effect(r,t),r=a}}function destroy_block_effect_children(n){for(var t=n.first;t!==null;){var r=t.next;t.f&BRANCH_EFFECT||destroy_effect(t),t=r}}function destroy_effect(n,t=!0){var r=!1;if((t||n.f&HEAD_EFFECT)&&n.nodes_start!==null){for(var a=n.nodes_start,o=n.nodes_end;a!==null;){var u=a===o?null:get_next_sibling(a);a.remove(),a=u}r=!0}destroy_effect_children(n,t&&!r),remove_reactions(n,0),set_signal_status(n,DESTROYED);var s=n.transitions;if(s!==null)for(const l of s)l.stop();execute_effect_teardown(n);var c=n.parent;c!==null&&c.first!==null&&unlink_effect(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=null}function unlink_effect(n){var t=n.parent,r=n.prev,a=n.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),t!==null&&(t.first===n&&(t.first=a),t.last===n&&(t.last=r))}function pause_effect(n,t){var r=[];pause_children(n,r,!0),run_out_transitions(r,()=>{destroy_effect(n),t&&t()})}function run_out_transitions(n,t){var r=n.length;if(r>0){var a=()=>--r||t();for(var o of n)o.out(a)}else t()}function pause_children(n,t,r){if(!(n.f&INERT)){if(n.f^=INERT,n.transitions!==null)for(const s of n.transitions)(s.is_global||r)&&t.push(s);for(var a=n.first;a!==null;){var o=a.next,u=(a.f&EFFECT_TRANSPARENT)!==0||(a.f&BRANCH_EFFECT)!==0;pause_children(a,t,u?r:!1),a=o}}}function resume_effect(n){resume_children(n,!0)}function resume_children(n,t){if(n.f&INERT){n.f^=INERT,n.f&CLEAN||(n.f^=CLEAN),check_dirtiness(n)&&(set_signal_status(n,DIRTY),schedule_effect(n));for(var r=n.first;r!==null;){var a=r.next,o=(r.f&EFFECT_TRANSPARENT)!==0||(r.f&BRANCH_EFFECT)!==0;resume_children(r,o?t:!1),r=a}if(n.transitions!==null)for(const u of n.transitions)(u.is_global||t)&&u.in()}}let is_micro_task_queued$1=!1,current_queued_micro_tasks=[];function process_micro_tasks(){is_micro_task_queued$1=!1;const n=current_queued_micro_tasks.slice();current_queued_micro_tasks=[],run_all(n)}function queue_micro_task(n){is_micro_task_queued$1||(is_micro_task_queued$1=!0,queueMicrotask(process_micro_tasks)),current_queued_micro_tasks.push(n)}let is_throwing_error=!1,is_micro_task_queued=!1,last_scheduled_effect=null,is_flushing_effect=!1,is_destroying_effect=!1;function set_is_flushing_effect(n){is_flushing_effect=n}function set_is_destroying_effect(n){is_destroying_effect=n}let queued_root_effects=[],flush_count=0,dev_effect_stack=[],active_reaction=null,untracking=!1;function set_active_reaction(n){active_reaction=n}let active_effect=null;function set_active_effect(n){active_effect=n}let derived_sources=null;function set_derived_sources(n){derived_sources=n}let new_deps=null,skipped_deps=0,untracked_writes=null;function set_untracked_writes(n){untracked_writes=n}let write_version=1,read_version=0,skip_reaction=!1,captured_signals=null;function increment_write_version(){return++write_version}function check_dirtiness(n){var d;var t=n.f;if(t&DIRTY)return!0;if(t&MAYBE_DIRTY){var r=n.deps,a=(t&UNOWNED)!==0;if(r!==null){var o,u,s=(t&DISCONNECTED)!==0,c=a&&active_effect!==null&&!skip_reaction,l=r.length;if(s||c){for(o=0;o<l;o++)u=r[o],(s||!((d=u==null?void 0:u.reactions)!=null&&d.includes(n)))&&(u.reactions??(u.reactions=[])).push(n);s&&(n.f^=DISCONNECTED)}for(o=0;o<l;o++)if(u=r[o],check_dirtiness(u)&&update_derived(u),u.wv>n.wv)return!0}(!a||active_effect!==null&&!skip_reaction)&&set_signal_status(n,CLEAN)}return!1}function propagate_error(n,t){for(var r=t;r!==null;){if(r.f&BOUNDARY_EFFECT)try{r.fn(n);return}catch{r.f^=BOUNDARY_EFFECT}r=r.parent}throw is_throwing_error=!1,n}function should_rethrow_error(n){return(n.f&DESTROYED)===0&&(n.parent===null||(n.parent.f&BOUNDARY_EFFECT)===0)}function handle_error(n,t,r,a){if(is_throwing_error){if(r===null&&(is_throwing_error=!1),should_rethrow_error(t))throw n;return}r!==null&&(is_throwing_error=!0);{propagate_error(n,t);return}}function schedule_possible_effect_self_invalidation(n,t,r=0){var a=n.reactions;if(a!==null)for(var o=0;o<a.length;o++){var u=a[o];u.f&DERIVED?schedule_possible_effect_self_invalidation(u,t,r+1):t===u&&(r===0?set_signal_status(u,DIRTY):u.f&CLEAN&&set_signal_status(u,MAYBE_DIRTY),schedule_effect(u))}}function update_reaction(n){var g;var t=new_deps,r=skipped_deps,a=untracked_writes,o=active_reaction,u=skip_reaction,s=derived_sources,c=component_context,l=untracking,d=n.f;new_deps=null,skipped_deps=0,untracked_writes=null,active_reaction=d&(BRANCH_EFFECT|ROOT_EFFECT)?null:n,skip_reaction=(d&UNOWNED)!==0&&(!is_flushing_effect||o===null||l),derived_sources=null,set_component_context(n.ctx),untracking=!1,read_version++;try{var f=(0,n.fn)(),h=n.deps;if(new_deps!==null){var v;if(remove_reactions(n,skipped_deps),h!==null&&skipped_deps>0)for(h.length=skipped_deps+new_deps.length,v=0;v<new_deps.length;v++)h[skipped_deps+v]=new_deps[v];else n.deps=h=new_deps;if(!skip_reaction)for(v=skipped_deps;v<h.length;v++)((g=h[v]).reactions??(g.reactions=[])).push(n)}else h!==null&&skipped_deps<h.length&&(remove_reactions(n,skipped_deps),h.length=skipped_deps);if(is_runes()&&untracked_writes!==null&&!(n.f&(DERIVED|MAYBE_DIRTY|DIRTY)))for(v=0;v<untracked_writes.length;v++)schedule_possible_effect_self_invalidation(untracked_writes[v],n);return o!==null&&read_version++,f}finally{new_deps=t,skipped_deps=r,untracked_writes=a,active_reaction=o,skip_reaction=u,derived_sources=s,set_component_context(c),untracking=l}}function remove_reaction(n,t){let r=t.reactions;if(r!==null){var a=index_of.call(r,n);if(a!==-1){var o=r.length-1;o===0?r=t.reactions=null:(r[a]=r[o],r.pop())}}r===null&&t.f&DERIVED&&(new_deps===null||!new_deps.includes(t))&&(set_signal_status(t,MAYBE_DIRTY),t.f&(UNOWNED|DISCONNECTED)||(t.f^=DISCONNECTED),destroy_derived_effects(t),remove_reactions(t,0))}function remove_reactions(n,t){var r=n.deps;if(r!==null)for(var a=t;a<r.length;a++)remove_reaction(n,r[a])}function update_effect(n){var t=n.f;if(!(t&DESTROYED)){set_signal_status(n,CLEAN);var r=active_effect,a=component_context;active_effect=n;try{t&BLOCK_EFFECT?destroy_block_effect_children(n):destroy_effect_children(n),execute_effect_teardown(n);var o=update_reaction(n);n.teardown=typeof o=="function"?o:null,n.wv=write_version;var u=n.deps,s;DEV&&tracing_mode_flag&&n.f&DIRTY}catch(c){handle_error(c,n,r,a||n.ctx)}finally{active_effect=r}}}function infinite_loop_guard(){if(flush_count>1e3){flush_count=0;try{effect_update_depth_exceeded()}catch(n){if(last_scheduled_effect!==null)handle_error(n,last_scheduled_effect,null);else throw n}}flush_count++}function flush_queued_root_effects(n){var t=n.length;if(t!==0){infinite_loop_guard();var r=is_flushing_effect;is_flushing_effect=!0;try{for(var a=0;a<t;a++){var o=n[a];o.f&CLEAN||(o.f^=CLEAN);var u=[];process_effects(o,u),flush_queued_effects(u)}}finally{is_flushing_effect=r}}}function flush_queued_effects(n){var t=n.length;if(t!==0)for(var r=0;r<t;r++){var a=n[r];if(!(a.f&(DESTROYED|INERT)))try{check_dirtiness(a)&&(update_effect(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?unlink_effect(a):a.fn=null))}catch(o){handle_error(o,a,null,a.ctx)}}}function process_deferred(){if(is_micro_task_queued=!1,flush_count>1001)return;const n=queued_root_effects;queued_root_effects=[],flush_queued_root_effects(n),is_micro_task_queued||(flush_count=0,last_scheduled_effect=null)}function schedule_effect(n){is_micro_task_queued||(is_micro_task_queued=!0,queueMicrotask(process_deferred)),last_scheduled_effect=n;for(var t=n;t.parent!==null;){t=t.parent;var r=t.f;if(r&(ROOT_EFFECT|BRANCH_EFFECT)){if(!(r&CLEAN))return;t.f^=CLEAN}}queued_root_effects.push(t)}function process_effects(n,t){var r=n.first,a=[];e:for(;r!==null;){var o=r.f,u=(o&BRANCH_EFFECT)!==0,s=u&&(o&CLEAN)!==0,c=r.next;if(!s&&!(o&INERT))if(o&RENDER_EFFECT){if(u)r.f^=CLEAN;else{var l=active_reaction;try{active_reaction=r,check_dirtiness(r)&&update_effect(r)}catch(v){handle_error(v,r,null,r.ctx)}finally{active_reaction=l}}var d=r.first;if(d!==null){r=d;continue}}else o&EFFECT&&a.push(r);if(c===null){let v=r.parent;for(;v!==null;){if(n===v)break e;var f=v.next;if(f!==null){r=f;continue e}v=v.parent}}r=c}for(var h=0;h<a.length;h++)d=a[h],t.push(d),process_effects(d,t)}function get$4(n){var t=n.f,r=(t&DERIVED)!==0;if(captured_signals!==null&&captured_signals.add(n),active_reaction!==null&&!untracking){derived_sources!==null&&derived_sources.includes(n)&&state_unsafe_local_read();var a=active_reaction.deps;n.rv<read_version&&(n.rv=read_version,new_deps===null&&a!==null&&a[skipped_deps]===n?skipped_deps++:new_deps===null?new_deps=[n]:(!skip_reaction||!new_deps.includes(n))&&new_deps.push(n))}else if(r&&n.deps===null&&n.effects===null){var o=n,u=o.parent;u!==null&&!(u.f&UNOWNED)&&(o.f^=UNOWNED)}return r&&(o=n,check_dirtiness(o)&&update_derived(o)),n.v}function capture_signals(n){var t=captured_signals;captured_signals=new Set;var r=captured_signals,a;try{if(untrack(n),t!==null)for(a of captured_signals)t.add(a)}finally{captured_signals=t}return r}function invalidate_inner_signals(n){var t=capture_signals(()=>untrack(n));for(var r of t)if(r.f&LEGACY_DERIVED_PROP)for(const a of r.deps||[])a.f&DERIVED||internal_set(a,a.v);else internal_set(r,r.v)}function untrack(n){var t=untracking;try{return untracking=!0,n()}finally{untracking=t}}const STATUS_MASK=-7169;function set_signal_status(n,t){n.f=n.f&STATUS_MASK|t}function deep_read_state(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(STATE_SYMBOL in n)deep_read(n);else if(!Array.isArray(n))for(let t in n){const r=n[t];typeof r=="object"&&r&&STATE_SYMBOL in r&&deep_read(r)}}}function deep_read(n,t=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!t.has(n)){t.add(n),n instanceof Date&&n.getTime();for(let a in n)try{deep_read(n[a],t)}catch{}const r=get_prototype_of(n);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const a=get_descriptors(r);for(let o in a){const u=a[o].get;if(u)try{u.call(n)}catch{}}}}}const PASSIVE_EVENTS=["touchstart","touchmove"];function is_passive_event(n){return PASSIVE_EVENTS.includes(n)}let listening_to_form_reset=!1;function add_form_reset_listener(){listening_to_form_reset||(listening_to_form_reset=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const r of n.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function without_reactive_context(n){var t=active_reaction,r=active_effect;set_active_reaction(null),set_active_effect(null);try{return n()}finally{set_active_reaction(t),set_active_effect(r)}}function listen_to_event_and_reset_event(n,t,r,a=r){n.addEventListener(t,()=>without_reactive_context(r));const o=n.__on_r;o?n.__on_r=()=>{o(),a(!0)}:n.__on_r=()=>a(!0),add_form_reset_listener()}const all_registered_events=new Set,root_event_handles=new Set;function create_event(n,t,r,a={}){function o(u){if(a.capture||handle_event_propagation.call(t,u),!u.cancelBubble)return without_reactive_context(()=>r==null?void 0:r.call(this,u))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?queue_micro_task(()=>{t.addEventListener(n,o,a)}):t.addEventListener(n,o,a),o}function event$1(n,t,r,a,o){var u={capture:a,passive:o},s=create_event(n,t,r,u);(t===document.body||t===window||t===document)&&teardown(()=>{t.removeEventListener(n,s,u)})}function handle_event_propagation(n){var w;var t=this,r=t.ownerDocument,a=n.type,o=((w=n.composedPath)==null?void 0:w.call(n))||[],u=o[0]||n.target,s=0,c=n.__root;if(c){var l=o.indexOf(c);if(l!==-1&&(t===document||t===window)){n.__root=t;return}var d=o.indexOf(t);if(d===-1)return;l<=d&&(s=l)}if(u=o[s]||n.target,u!==t){define_property(n,"currentTarget",{configurable:!0,get(){return u||r}});var f=active_reaction,h=active_effect;set_active_reaction(null),set_active_effect(null);try{for(var v,g=[];u!==null;){var b=u.assignedSlot||u.parentNode||u.host||null;try{var _=u["__"+a];if(_!==void 0&&!u.disabled)if(is_array(_)){var[S,...T]=_;S.apply(u,[n,...T])}else _.call(u,n)}catch(A){v?g.push(A):v=A}if(n.cancelBubble||b===t||b===null)break;u=b}if(v){for(let A of g)queueMicrotask(()=>{throw A});throw v}}finally{n.__root=t,delete n.currentTarget,set_active_reaction(f),set_active_effect(h)}}}function create_fragment_from_html(n){var t=document.createElement("template");return t.innerHTML=n,t.content}function assign_nodes(n,t){var r=active_effect;r.nodes_start===null&&(r.nodes_start=n,r.nodes_end=t)}function template(n,t){var r=(t&TEMPLATE_FRAGMENT)!==0,a=(t&TEMPLATE_USE_IMPORT_NODE)!==0,o,u=!n.startsWith("<!>");return()=>{o===void 0&&(o=create_fragment_from_html(u?n:"<!>"+n),r||(o=get_first_child(o)));var s=a?document.importNode(o,!0):o.cloneNode(!0);if(r){var c=get_first_child(s),l=s.lastChild;assign_nodes(c,l)}else assign_nodes(s,s);return s}}function comment(){var n=document.createDocumentFragment(),t=document.createComment(""),r=create_text();return n.append(t,r),assign_nodes(t,r),n}function append(n,t){n!==null&&n.before(t)}function set_text(n,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=r,n.nodeValue=r+"")}function mount(n,t){return _mount(n,t)}const document_listeners=new Map;function _mount(n,{target:t,anchor:r,props:a={},events:o,context:u,intro:s=!0}){init_operations();var c=new Set,l=h=>{for(var v=0;v<h.length;v++){var g=h[v];if(!c.has(g)){c.add(g);var b=is_passive_event(g);t.addEventListener(g,handle_event_propagation,{passive:b});var _=document_listeners.get(g);_===void 0?(document.addEventListener(g,handle_event_propagation,{passive:b}),document_listeners.set(g,1)):document_listeners.set(g,_+1)}}};l(array_from(all_registered_events)),root_event_handles.add(l);var d=void 0,f=component_root(()=>{var h=r??t.appendChild(create_text());return branch(()=>{if(u){push$2({});var v=component_context;v.c=u}o&&(a.$$events=o),d=n(h,a)||{},u&&pop$1()}),()=>{var b;for(var v of c){t.removeEventListener(v,handle_event_propagation);var g=document_listeners.get(v);--g===0?(document.removeEventListener(v,handle_event_propagation),document_listeners.delete(v)):document_listeners.set(v,g)}root_event_handles.delete(l),h!==r&&((b=h.parentNode)==null||b.removeChild(h))}});return mounted_components.set(d,f),d}let mounted_components=new WeakMap;function if_block(n,t,r=!1){var a=n,o=null,u=null,s=UNINITIALIZED,c=r?EFFECT_TRANSPARENT:0,l=!1;const d=(h,v=!0)=>{l=!0,f(v,h)},f=(h,v)=>{s!==(s=h)&&(s?(o?resume_effect(o):v&&(o=branch(()=>v(a))),u&&pause_effect(u,()=>{u=null})):(u?resume_effect(u):v&&(u=branch(()=>v(a))),o&&pause_effect(o,()=>{o=null})))};block$1(()=>{l=!1,t(d),l||f(null,null)},c)}function index(n,t){return t}function pause_effects(n,t,r,a){for(var o=[],u=t.length,s=0;s<u;s++)pause_children(t[s].e,o,!0);var c=u>0&&o.length===0&&r!==null;if(c){var l=r.parentNode;clear_text_content(l),l.append(r),a.clear(),link$1(n,t[0].prev,t[u-1].next)}run_out_transitions(o,()=>{for(var d=0;d<u;d++){var f=t[d];c||(a.delete(f.k),link$1(n,f.prev,f.next)),destroy_effect(f.e,!c)}})}function each$g(n,t,r,a,o,u=null){var s=n,c={items:new Map,first:null};{var l=n;s=l.appendChild(create_text())}var d=null,f=!1,h=derived_safe_equal(()=>{var v=r();return is_array(v)?v:v==null?[]:array_from(v)});block$1(()=>{var v=get$4(h),g=v.length;f&&g===0||(f=g===0,reconcile(v,c,s,o,t,a,r),u!==null&&(g===0?d?resume_effect(d):d=branch(()=>u(s)):d!==null&&pause_effect(d,()=>{d=null})),get$4(h))})}function reconcile(n,t,r,a,o,u,s){var c=n.length,l=t.items,d=t.first,f=d,h,v=null,g=[],b=[],_,S,T,w;for(w=0;w<c;w+=1){if(_=n[w],S=u(_,w),T=l.get(S),T===void 0){var A=f?f.e.nodes_start:r;v=create_item(A,t,v,v===null?t.first:v.next,_,S,w,a,o,s),l.set(S,v),g=[],b=[],f=v.next;continue}if(update_item(T,_,w),T.e.f&INERT&&resume_effect(T.e),T!==f){if(h!==void 0&&h.has(T)){if(g.length<b.length){var R=b[0],E;v=R.prev;var I=g[0],L=g[g.length-1];for(E=0;E<g.length;E+=1)move(g[E],R,r);for(E=0;E<b.length;E+=1)h.delete(b[E]);link$1(t,I.prev,L.next),link$1(t,v,I),link$1(t,L,R),f=R,v=L,w-=1,g=[],b=[]}else h.delete(T),move(T,f,r),link$1(t,T.prev,T.next),link$1(t,T,v===null?t.first:v.next),link$1(t,v,T),v=T;continue}for(g=[],b=[];f!==null&&f.k!==S;)f.e.f&INERT||(h??(h=new Set)).add(f),b.push(f),f=f.next;if(f===null)continue;T=f}g.push(T),v=T,f=T.next}if(f!==null||h!==void 0){for(var F=h===void 0?[]:array_from(h);f!==null;)f.e.f&INERT||F.push(f),f=f.next;var D=F.length;if(D>0){var $=c===0?r:null;pause_effects(t,F,$,l)}}active_effect.first=t.first&&t.first.e,active_effect.last=v&&v.e}function update_item(n,t,r,a){internal_set(n.v,t),n.i=r}function create_item(n,t,r,a,o,u,s,c,l,d){var f=(l&EACH_ITEM_REACTIVE)!==0,h=(l&EACH_ITEM_IMMUTABLE)===0,v=f?h?mutable_source(o):source(o):o,g=l&EACH_INDEX_REACTIVE?source(s):s,b={i:g,v,k:u,a:null,e:null,prev:r,next:a};try{return b.e=branch(()=>c(n,v,g,d),hydrating),b.e.prev=r&&r.e,b.e.next=a&&a.e,r===null?t.first=b:(r.next=b,r.e.next=b.e),a!==null&&(a.prev=b,a.e.prev=b.e),b}finally{}}function move(n,t,r){for(var a=n.next?n.next.e.nodes_start:r,o=t?t.e.nodes_start:r,u=n.e.nodes_start;u!==a;){var s=get_next_sibling(u);o.before(u),u=s}}function link$1(n,t,r){t===null?n.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function set_selected(n,t){t?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function set_attribute(n,t,r,a){var o=n.__attributes??(n.__attributes={});o[t]!==(o[t]=r)&&(t==="style"&&"__styles"in n&&(n.__styles={}),t==="loading"&&(n[LOADING_ATTR_SYMBOL]=r),r==null?n.removeAttribute(t):typeof r!="string"&&get_setters(n).includes(t)?n[t]=r:n.setAttribute(t,r))}var setters_cache=new Map;function get_setters(n){var t=setters_cache.get(n.nodeName);if(t)return t;setters_cache.set(n.nodeName,t=[]);for(var r,a=n,o=Element.prototype;o!==a;){r=get_descriptors(a);for(var u in r)r[u].set&&t.push(u);a=get_prototype_of(a)}return t}function bind_value(n,t,r=t){var a=is_runes();listen_to_event_and_reset_event(n,"input",o=>{var u=o?n.defaultValue:n.value;if(u=is_numberlike_input(n)?to_number(u):u,r(u),a&&u!==(u=t())){var s=n.selectionStart,c=n.selectionEnd;n.value=u??"",c!==null&&(n.selectionStart=s,n.selectionEnd=Math.min(c,n.value.length))}}),untrack(t)==null&&n.value&&r(is_numberlike_input(n)?to_number(n.value):n.value),render_effect(()=>{var o=t();is_numberlike_input(n)&&o===to_number(n.value)||n.type==="date"&&!o&&!n.value||o!==n.value&&(n.value=o??"")})}function bind_checked(n,t,r=t){listen_to_event_and_reset_event(n,"change",a=>{var o=a?n.defaultChecked:n.checked;r(o)}),untrack(t)==null&&r(n.checked),render_effect(()=>{var a=t();n.checked=!!a})}function is_numberlike_input(n){var t=n.type;return t==="number"||t==="range"}function to_number(n){return n===""?null:+n}function select_option(n,t,r){if(n.multiple)return select_options(n,t);for(var a of n.options){var o=get_option_value(a);if(is$1(o,t)){a.selected=!0;return}}(!r||t!==void 0)&&(n.selectedIndex=-1)}function init_select(n,t){effect(()=>{var r=new MutationObserver(()=>{var a=n.__value;select_option(n,a)});return r.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function bind_select_value(n,t,r=t){var a=!0;listen_to_event_and_reset_event(n,"change",o=>{var u=o?"[selected]":":checked",s;if(n.multiple)s=[].map.call(n.querySelectorAll(u),get_option_value);else{var c=n.querySelector(u)??n.querySelector("option:not([disabled])");s=c&&get_option_value(c)}r(s)}),effect(()=>{var o=t();if(select_option(n,o,a),a&&o===void 0){var u=n.querySelector(":checked");u!==null&&(o=get_option_value(u),r(o))}n.__value=o,a=!1}),init_select(n)}function select_options(n,t){for(var r of n.options)r.selected=~t.indexOf(get_option_value(r))}function get_option_value(n){return"__value"in n?n.__value:n.value}function is_bound_this(n,t){return n===t||(n==null?void 0:n[STATE_SYMBOL])===t}function bind_this(n={},t,r,a){return effect(()=>{var o,u;return render_effect(()=>{o=u,u=[],untrack(()=>{n!==r(...u)&&(t(n,...u),o&&is_bound_this(r(...o),n)&&t(null,...o))})}),()=>{queue_micro_task(()=>{u&&is_bound_this(r(...u),n)&&t(null,...u)})}}),n}function init$2(n=!1){const t=component_context,r=t.l.u;if(!r)return;let a=()=>deep_read_state(t.s);if(n){let o=0,u={};const s=derived(()=>{let c=!1;const l=t.s;for(const d in l)l[d]!==u[d]&&(u[d]=l[d],c=!0);return c&&o++,o});a=()=>get$4(s)}r.b.length&&user_pre_effect(()=>{observe_all(t,a),run_all(r.b)}),user_effect(()=>{const o=untrack(()=>r.m.map(run));return()=>{for(const u of o)typeof u=="function"&&u()}}),r.a.length&&user_effect(()=>{observe_all(t,a),run_all(r.a)})}function observe_all(n,t){if(n.l.s)for(const r of n.l.s)get$4(r);t()}function subscribe_to_store(n,t,r){if(n==null)return t(void 0),noop$4;const a=untrack(()=>n.subscribe(t,r));return a.unsubscribe?()=>a.unsubscribe():a}const subscriber_queue=[];function writable$1(n,t=noop$4){let r=null;const a=new Set;function o(c){if(safe_not_equal(n,c)&&(n=c,r)){const l=!subscriber_queue.length;for(const d of a)d[1](),subscriber_queue.push(d,n);if(l){for(let d=0;d<subscriber_queue.length;d+=2)subscriber_queue[d][0](subscriber_queue[d+1]);subscriber_queue.length=0}}}function u(c){o(c(n))}function s(c,l=noop$4){const d=[c,l];return a.add(d),a.size===1&&(r=t(o,u)||noop$4),c(n),()=>{a.delete(d),a.size===0&&r&&(r(),r=null)}}return{set:o,update:u,subscribe:s}}function get$3(n){let t;return subscribe_to_store(n,r=>t=r)(),t}let is_store_binding=!1,IS_UNMOUNTED=Symbol();function store_get(n,t,r){const a=r[t]??(r[t]={store:null,source:mutable_source(void 0),unsubscribe:noop$4});if(a.store!==n&&!(IS_UNMOUNTED in r))if(a.unsubscribe(),a.store=n??null,n==null)a.source.v=void 0,a.unsubscribe=noop$4;else{var o=!0;a.unsubscribe=subscribe_to_store(n,u=>{o?a.source.v=u:set$4(a.source,u)}),o=!1}return n&&IS_UNMOUNTED in r?get$3(n):get$4(a.source)}function store_set(n,t){return n.set(t),t}function setup_stores(){const n={};function t(){teardown(()=>{for(var r in n)n[r].unsubscribe();define_property(n,IS_UNMOUNTED,{enumerable:!1,value:!0})})}return[n,t]}function store_mutate(n,t,r){return n.set(r),t}function capture_store_binding(n){var t=is_store_binding;try{return is_store_binding=!1,[n(),is_store_binding]}finally{is_store_binding=t}}function with_parent_branch(n){for(var t=active_effect,r=active_effect;t!==null&&!(t.f&(BRANCH_EFFECT|ROOT_EFFECT));)t=t.parent;try{return set_active_effect(t),n()}finally{set_active_effect(r)}}function prop(n,t,r,a){var b;var o=(r&PROPS_IS_IMMUTABLE)!==0,u=!legacy_mode_flag||(r&PROPS_IS_RUNES)!==0,s=!1,c;[c,s]=capture_store_binding(()=>n[t]);var l=STATE_SYMBOL in n||LEGACY_PROPS in n;((b=get_descriptor(n,t))==null?void 0:b.set)??(l&&t in n);var d=a,f=!0,h=()=>(f&&(f=!1,d=a),d),v;if(u)v=()=>{var _=n[t];return _===void 0?h():(f=!0,_)};else{var g=with_parent_branch(()=>(o?derived:derived_safe_equal)(()=>n[t]));g.f|=LEGACY_DERIVED_PROP,v=()=>{var _=get$4(g);return _!==void 0&&(d=void 0),_===void 0?d:_}}return v}function onMount(n){component_context===null&&lifecycle_outside_component(),legacy_mode_flag&&component_context.l!==null?init_update_callbacks(component_context).m.push(n):user_effect(()=>{const t=untrack(n);if(typeof t=="function")return t})}function init_update_callbacks(n){var t=n.l;return t.u??(t.u={a:[],b:[],m:[]})}const PUBLIC_VERSION="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(PUBLIC_VERSION);enable_legacy_mode_flag();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(n,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},extendStatics(n,t)};function __extends(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");extendStatics(n,t);function r(){this.constructor=n}n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Browser=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),Env=function(){function n(){this.browser=new Browser,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),env=new Env;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(env.wxa=!0,env.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?env.worker=!0:!env.hasGlobalWindow||"Deno"in window?(env.node=!0,env.svgSupported=!0):detect(navigator.userAgent,env);function detect(n,t){var r=t.browser,a=n.match(/Firefox\/([\d.]+)/),o=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),u=n.match(/Edge?\/([\d.]+)/),s=/micromessenger/i.test(n);a&&(r.firefox=!0,r.version=a[1]),o&&(r.ie=!0,r.version=o[1]),u&&(r.edge=!0,r.version=u[1],r.newEdge=+u[1].split(".")[0]>18),s&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var c=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in c||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in c)&&!("OTransition"in c),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}var DEFAULT_FONT_SIZE=12,DEFAULT_FONT_FAMILY="sans-serif",DEFAULT_FONT=DEFAULT_FONT_SIZE+"px "+DEFAULT_FONT_FAMILY,OFFSET=20,SCALE=100,defaultWidthMapStr="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function getTextWidthMap(n){var t={};if(typeof JSON>"u")return t;for(var r=0;r<n.length;r++){var a=String.fromCharCode(r+32),o=(n.charCodeAt(r)-OFFSET)/SCALE;t[a]=o}return t}var DEFAULT_TEXT_WIDTH_MAP=getTextWidthMap(defaultWidthMapStr),platformApi={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,t;return function(r,a){if(!n){var o=platformApi.createCanvas();n=o&&o.getContext("2d")}if(n)return t!==a&&(t=n.font=a||DEFAULT_FONT),n.measureText(r);r=r||"",a=a||DEFAULT_FONT;var u=/((?:\d+)?\.?\d*)px/.exec(a),s=u&&+u[1]||DEFAULT_FONT_SIZE,c=0;if(a.indexOf("mono")>=0)c=s*r.length;else for(var l=0;l<r.length;l++){var d=DEFAULT_TEXT_WIDTH_MAP[r[l]];c+=d==null?s:d*s}return{width:c}}}(),loadImage:function(n,t,r){var a=new Image;return a.onload=t,a.onerror=r,a.src=n,a}},BUILTIN_OBJECT=reduce$1(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,t){return n["[object "+t+"]"]=!0,n},{}),TYPED_ARRAY=reduce$1(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,t){return n["[object "+t+"Array]"]=!0,n},{}),objToString=Object.prototype.toString,arrayProto$1=Array.prototype,nativeForEach=arrayProto$1.forEach,nativeFilter=arrayProto$1.filter,nativeSlice=arrayProto$1.slice,nativeMap=arrayProto$1.map,ctorFunction=(function(){}).constructor,protoFunction=ctorFunction?ctorFunction.prototype:null,protoKey="__proto__",idStart=2311;function guid(){return idStart++}function logError(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];typeof console<"u"&&console.error.apply(console,n)}function clone$5(n){if(n==null||typeof n!="object")return n;var t=n,r=objToString.call(n);if(r==="[object Array]"){if(!isPrimitive(n)){t=[];for(var a=0,o=n.length;a<o;a++)t[a]=clone$5(n[a])}}else if(TYPED_ARRAY[r]){if(!isPrimitive(n)){var u=n.constructor;if(u.from)t=u.from(n);else{t=new u(n.length);for(var a=0,o=n.length;a<o;a++)t[a]=n[a]}}}else if(!BUILTIN_OBJECT[r]&&!isPrimitive(n)&&!isDom(n)){t={};for(var s in n)n.hasOwnProperty(s)&&s!==protoKey&&(t[s]=clone$5(n[s]))}return t}function merge$3(n,t,r){if(!isObject$4(t)||!isObject$4(n))return r?clone$5(t):n;for(var a in t)if(t.hasOwnProperty(a)&&a!==protoKey){var o=n[a],u=t[a];isObject$4(u)&&isObject$4(o)&&!isArray$2(u)&&!isArray$2(o)&&!isDom(u)&&!isDom(o)&&!isBuiltInObject(u)&&!isBuiltInObject(o)&&!isPrimitive(u)&&!isPrimitive(o)?merge$3(o,u,r):(r||!(a in n))&&(n[a]=clone$5(t[a]))}return n}function mergeAll(n,t){for(var r=n[0],a=1,o=n.length;a<o;a++)r=merge$3(r,n[a],t);return r}function extend$1(n,t){if(Object.assign)Object.assign(n,t);else for(var r in t)t.hasOwnProperty(r)&&r!==protoKey&&(n[r]=t[r]);return n}function defaults$h(n,t,r){for(var a=keys(t),o=0,u=a.length;o<u;o++){var s=a[o];(r?t[s]!=null:n[s]==null)&&(n[s]=t[s])}return n}function indexOf(n,t){if(n){if(n.indexOf)return n.indexOf(t);for(var r=0,a=n.length;r<a;r++)if(n[r]===t)return r}return-1}function inherits(n,t){var r=n.prototype;function a(){}a.prototype=t.prototype,n.prototype=new a;for(var o in r)r.hasOwnProperty(o)&&(n.prototype[o]=r[o]);n.prototype.constructor=n,n.superClass=t}function mixin$1(n,t,r){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var a=Object.getOwnPropertyNames(t),o=0;o<a.length;o++){var u=a[o];u!=="constructor"&&(r?t[u]!=null:n[u]==null)&&(n[u]=t[u])}else defaults$h(n,t,r)}function isArrayLike$1(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function each$f(n,t,r){if(n&&t)if(n.forEach&&n.forEach===nativeForEach)n.forEach(t,r);else if(n.length===+n.length)for(var a=0,o=n.length;a<o;a++)t.call(r,n[a],a,n);else for(var u in n)n.hasOwnProperty(u)&&t.call(r,n[u],u,n)}function map$1(n,t,r){if(!n)return[];if(!t)return slice(n);if(n.map&&n.map===nativeMap)return n.map(t,r);for(var a=[],o=0,u=n.length;o<u;o++)a.push(t.call(r,n[o],o,n));return a}function reduce$1(n,t,r,a){if(n&&t){for(var o=0,u=n.length;o<u;o++)r=t.call(a,r,n[o],o,n);return r}}function filter$1(n,t,r){if(!n)return[];if(!t)return slice(n);if(n.filter&&n.filter===nativeFilter)return n.filter(t,r);for(var a=[],o=0,u=n.length;o<u;o++)t.call(r,n[o],o,n)&&a.push(n[o]);return a}function find(n,t,r){if(n&&t){for(var a=0,o=n.length;a<o;a++)if(t.call(r,n[a],a,n))return n[a]}}function keys(n){if(!n)return[];if(Object.keys)return Object.keys(n);var t=[];for(var r in n)n.hasOwnProperty(r)&&t.push(r);return t}function bindPolyfill(n,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return function(){return n.apply(t,r.concat(nativeSlice.call(arguments)))}}var bind$1=protoFunction&&isFunction$1(protoFunction.bind)?protoFunction.call.bind(protoFunction.bind):bindPolyfill;function curry$1(n){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return n.apply(this,t.concat(nativeSlice.call(arguments)))}}function isArray$2(n){return Array.isArray?Array.isArray(n):objToString.call(n)==="[object Array]"}function isFunction$1(n){return typeof n=="function"}function isString(n){return typeof n=="string"}function isStringSafe(n){return objToString.call(n)==="[object String]"}function isNumber(n){return typeof n=="number"}function isObject$4(n){var t=typeof n;return t==="function"||!!n&&t==="object"}function isBuiltInObject(n){return!!BUILTIN_OBJECT[objToString.call(n)]}function isTypedArray(n){return!!TYPED_ARRAY[objToString.call(n)]}function isDom(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function isGradientObject(n){return n.colorStops!=null}function isImagePatternObject(n){return n.image!=null}function isRegExp(n){return objToString.call(n)==="[object RegExp]"}function eqNaN(n){return n!==n}function retrieve(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var r=0,a=n.length;r<a;r++)if(n[r]!=null)return n[r]}function retrieve2(n,t){return n??t}function retrieve3(n,t,r){return n??t??r}function slice(n){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return nativeSlice.apply(n,t)}function normalizeCssArray$1(n){if(typeof n=="number")return[n,n,n,n];var t=n.length;return t===2?[n[0],n[1],n[0],n[1]]:t===3?[n[0],n[1],n[2],n[1]]:n}function assert(n,t){if(!n)throw new Error(t)}function trim$1(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var primitiveKey="__ec_primitive__";function setAsPrimitive(n){n[primitiveKey]=!0}function isPrimitive(n){return n[primitiveKey]}var MapPolyfill=function(){function n(){this.data={}}return n.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},n.prototype.has=function(t){return this.data.hasOwnProperty(t)},n.prototype.get=function(t){return this.data[t]},n.prototype.set=function(t,r){return this.data[t]=r,this},n.prototype.keys=function(){return keys(this.data)},n.prototype.forEach=function(t){var r=this.data;for(var a in r)r.hasOwnProperty(a)&&t(r[a],a)},n}(),isNativeMapSupported=typeof Map=="function";function maybeNativeMap(){return isNativeMapSupported?new Map:new MapPolyfill}var HashMap=function(){function n(t){var r=isArray$2(t);this.data=maybeNativeMap();var a=this;t instanceof n?t.each(o):t&&each$f(t,o);function o(u,s){r?a.set(u,s):a.set(s,u)}}return n.prototype.hasKey=function(t){return this.data.has(t)},n.prototype.get=function(t){return this.data.get(t)},n.prototype.set=function(t,r){return this.data.set(t,r),r},n.prototype.each=function(t,r){this.data.forEach(function(a,o){t.call(r,a,o)})},n.prototype.keys=function(){var t=this.data.keys();return isNativeMapSupported?Array.from(t):t},n.prototype.removeKey=function(t){this.data.delete(t)},n}();function createHashMap(n){return new HashMap(n)}function concatArray(n,t){for(var r=new n.constructor(n.length+t.length),a=0;a<n.length;a++)r[a]=n[a];for(var o=n.length,a=0;a<t.length;a++)r[a+o]=t[a];return r}function createObject(n,t){var r;if(Object.create)r=Object.create(n);else{var a=function(){};a.prototype=n,r=new a}return t&&extend$1(r,t),r}function disableUserSelect(n){var t=n.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function hasOwn(n,t){return n.hasOwnProperty(t)}function noop$3(){}var RADIAN_TO_DEGREE=180/Math.PI;function create$3(n,t){return n==null&&(n=0),t==null&&(t=0),[n,t]}function copy$2(n,t){return n[0]=t[0],n[1]=t[1],n}function clone$4(n){return[n[0],n[1]]}function set$3(n,t,r){return n[0]=t,n[1]=r,n}function add(n,t,r){return n[0]=t[0]+r[0],n[1]=t[1]+r[1],n}function scaleAndAdd$1(n,t,r,a){return n[0]=t[0]+r[0]*a,n[1]=t[1]+r[1]*a,n}function sub(n,t,r){return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n}function len(n){return Math.sqrt(lenSquare(n))}function lenSquare(n){return n[0]*n[0]+n[1]*n[1]}function scale$3(n,t,r){return n[0]=t[0]*r,n[1]=t[1]*r,n}function normalize$4(n,t){var r=len(t);return r===0?(n[0]=0,n[1]=0):(n[0]=t[0]/r,n[1]=t[1]/r),n}function distance(n,t){return Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1]))}var dist$7=distance;function distanceSquare(n,t){return(n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])}var distSquare=distanceSquare;function lerp$1(n,t,r,a){return n[0]=t[0]+a*(r[0]-t[0]),n[1]=t[1]+a*(r[1]-t[1]),n}function applyTransform$1(n,t,r){var a=t[0],o=t[1];return n[0]=r[0]*a+r[2]*o+r[4],n[1]=r[1]*a+r[3]*o+r[5],n}function min$2(n,t,r){return n[0]=Math.min(t[0],r[0]),n[1]=Math.min(t[1],r[1]),n}function max$3(n,t,r){return n[0]=Math.max(t[0],r[0]),n[1]=Math.max(t[1],r[1]),n}var Param=function(){function n(t,r){this.target=t,this.topTarget=r&&r.topTarget}return n}(),Draggable=function(){function n(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new Param(r,t),"dragstart",t.event))},n.prototype._drag=function(t){var r=this._draggingTarget;if(r){var a=t.offsetX,o=t.offsetY,u=a-this._x,s=o-this._y;this._x=a,this._y=o,r.drift(u,s,t),this.handler.dispatchToElement(new Param(r,t),"drag",t.event);var c=this.handler.findHover(a,o,r).target,l=this._dropTarget;this._dropTarget=c,r!==c&&(l&&c!==l&&this.handler.dispatchToElement(new Param(l,t),"dragleave",t.event),c&&c!==l&&this.handler.dispatchToElement(new Param(c,t),"dragenter",t.event))}},n.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new Param(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new Param(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},n}(),Eventful=function(){function n(t){t&&(this._$eventProcessor=t)}return n.prototype.on=function(t,r,a,o){this._$handlers||(this._$handlers={});var u=this._$handlers;if(typeof r=="function"&&(o=a,a=r,r=null),!a||!t)return this;var s=this._$eventProcessor;r!=null&&s&&s.normalizeQuery&&(r=s.normalizeQuery(r)),u[t]||(u[t]=[]);for(var c=0;c<u[t].length;c++)if(u[t][c].h===a)return this;var l={h:a,query:r,ctx:o||this,callAtLast:a.zrEventfulCallAtLast},d=u[t].length-1,f=u[t][d];return f&&f.callAtLast?u[t].splice(d,0,l):u[t].push(l),this},n.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},n.prototype.off=function(t,r){var a=this._$handlers;if(!a)return this;if(!t)return this._$handlers={},this;if(r){if(a[t]){for(var o=[],u=0,s=a[t].length;u<s;u++)a[t][u].h!==r&&o.push(a[t][u]);a[t]=o}a[t]&&a[t].length===0&&delete a[t]}else delete a[t];return this},n.prototype.trigger=function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];if(!this._$handlers)return this;var o=this._$handlers[t],u=this._$eventProcessor;if(o)for(var s=r.length,c=o.length,l=0;l<c;l++){var d=o[l];if(!(u&&u.filter&&d.query!=null&&!u.filter(t,d.query)))switch(s){case 0:d.h.call(d.ctx);break;case 1:d.h.call(d.ctx,r[0]);break;case 2:d.h.call(d.ctx,r[0],r[1]);break;default:d.h.apply(d.ctx,r);break}}return u&&u.afterTrigger&&u.afterTrigger(t),this},n.prototype.triggerWithContext=function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];if(!this._$handlers)return this;var o=this._$handlers[t],u=this._$eventProcessor;if(o)for(var s=r.length,c=r[s-1],l=o.length,d=0;d<l;d++){var f=o[d];if(!(u&&u.filter&&f.query!=null&&!u.filter(t,f.query)))switch(s){case 0:f.h.call(c);break;case 1:f.h.call(c,r[0]);break;case 2:f.h.call(c,r[0],r[1]);break;default:f.h.apply(c,r.slice(1,s-1));break}}return u&&u.afterTrigger&&u.afterTrigger(t),this},n}(),LN2=Math.log(2);function determinant(n,t,r,a,o,u){var s=a+"-"+o,c=n.length;if(u.hasOwnProperty(s))return u[s];if(t===1){var l=Math.round(Math.log((1<<c)-1&~o)/LN2);return n[r][l]}for(var d=a|1<<r,f=r+1;a&1<<f;)f++;for(var h=0,v=0,g=0;v<c;v++){var b=1<<v;b&o||(h+=(g%2?-1:1)*n[r][v]*determinant(n,t-1,f,d,o|b,u),g++)}return u[s]=h,h}function buildTransformer(n,t){var r=[[n[0],n[1],1,0,0,0,-t[0]*n[0],-t[0]*n[1]],[0,0,0,n[0],n[1],1,-t[1]*n[0],-t[1]*n[1]],[n[2],n[3],1,0,0,0,-t[2]*n[2],-t[2]*n[3]],[0,0,0,n[2],n[3],1,-t[3]*n[2],-t[3]*n[3]],[n[4],n[5],1,0,0,0,-t[4]*n[4],-t[4]*n[5]],[0,0,0,n[4],n[5],1,-t[5]*n[4],-t[5]*n[5]],[n[6],n[7],1,0,0,0,-t[6]*n[6],-t[6]*n[7]],[0,0,0,n[6],n[7],1,-t[7]*n[6],-t[7]*n[7]]],a={},o=determinant(r,8,0,0,0,a);if(o!==0){for(var u=[],s=0;s<8;s++)for(var c=0;c<8;c++)u[c]==null&&(u[c]=0),u[c]+=((s+c)%2?-1:1)*determinant(r,7,s===0?1:0,1<<s,1<<c,a)/o*t[s];return function(l,d,f){var h=d*u[6]+f*u[7]+1;l[0]=(d*u[0]+f*u[1]+u[2])/h,l[1]=(d*u[3]+f*u[4]+u[5])/h}}}var EVENT_SAVED_PROP="___zrEVENTSAVED",_calcOut$1=[];function transformLocalCoord(n,t,r,a,o){return transformCoordWithViewport(_calcOut$1,t,a,o,!0)&&transformCoordWithViewport(n,r,_calcOut$1[0],_calcOut$1[1])}function transformCoordWithViewport(n,t,r,a,o){if(t.getBoundingClientRect&&env.domSupported&&!isCanvasEl(t)){var u=t[EVENT_SAVED_PROP]||(t[EVENT_SAVED_PROP]={}),s=prepareCoordMarkers(t,u),c=preparePointerTransformer(s,u,o);if(c)return c(n,r,a),!0}return!1}function prepareCoordMarkers(n,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var a=["left","right"],o=["top","bottom"],u=0;u<4;u++){var s=document.createElement("div"),c=s.style,l=u%2,d=(u>>1)%2;c.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",a[l]+":0",o[d]+":0",a[1-l]+":auto",o[1-d]+":auto",""].join("!important;"),n.appendChild(s),r.push(s)}return r}function preparePointerTransformer(n,t,r){for(var a=r?"invTrans":"trans",o=t[a],u=t.srcCoords,s=[],c=[],l=!0,d=0;d<4;d++){var f=n[d].getBoundingClientRect(),h=2*d,v=f.left,g=f.top;s.push(v,g),l=l&&u&&v===u[h]&&g===u[h+1],c.push(n[d].offsetLeft,n[d].offsetTop)}return l&&o?o:(t.srcCoords=s,t[a]=r?buildTransformer(c,s):buildTransformer(s,c))}function isCanvasEl(n){return n.nodeName.toUpperCase()==="CANVAS"}var replaceReg=/([&<>"'])/g,replaceMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function encodeHTML(n){return n==null?"":(n+"").replace(replaceReg,function(t,r){return replaceMap[r]})}var MOUSE_EVENT_REG=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_calcOut=[],firefoxNotSupportOffsetXY=env.browser.firefox&&+env.browser.version.split(".")[0]<39;function clientToLocal(n,t,r,a){return r=r||{},a?calculateZrXY(n,t,r):firefoxNotSupportOffsetXY&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):calculateZrXY(n,t,r),r}function calculateZrXY(n,t,r){if(env.domSupported&&n.getBoundingClientRect){var a=t.clientX,o=t.clientY;if(isCanvasEl(n)){var u=n.getBoundingClientRect();r.zrX=a-u.left,r.zrY=o-u.top;return}else if(transformCoordWithViewport(_calcOut,n,a,o)){r.zrX=_calcOut[0],r.zrY=_calcOut[1];return}}r.zrX=r.zrY=0}function getNativeEvent(n){return n||window.event}function normalizeEvent(n,t,r){if(t=getNativeEvent(t),t.zrX!=null)return t;var a=t.type,o=a&&a.indexOf("touch")>=0;if(o){var s=a!=="touchend"?t.targetTouches[0]:t.changedTouches[0];s&&clientToLocal(n,s,t,r)}else{clientToLocal(n,t,t,r);var u=getWheelDeltaMayPolyfill(t);t.zrDelta=u?u/120:-(t.detail||0)/3}var c=t.button;return t.which==null&&c!==void 0&&MOUSE_EVENT_REG.test(t.type)&&(t.which=c&1?1:c&2?3:c&4?2:0),t}function getWheelDeltaMayPolyfill(n){var t=n.wheelDelta;if(t)return t;var r=n.deltaX,a=n.deltaY;if(r==null||a==null)return t;var o=Math.abs(a!==0?a:r),u=a>0?-1:a<0?1:r>0?-1:1;return 3*o*u}function addEventListener(n,t,r,a){n.addEventListener(t,r,a)}function removeEventListener(n,t,r,a){n.removeEventListener(t,r,a)}var stop=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0};function isMiddleOrRightButtonOnMouseUpDown(n){return n.which===2||n.which===3}var GestureMgr=function(){function n(){this._track=[]}return n.prototype.recognize=function(t,r,a){return this._doTrack(t,r,a),this._recognize(t)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(t,r,a){var o=t.touches;if(o){for(var u={points:[],touches:[],target:r,event:t},s=0,c=o.length;s<c;s++){var l=o[s],d=clientToLocal(a,l,{});u.points.push([d.zrX,d.zrY]),u.touches.push(l)}this._track.push(u)}},n.prototype._recognize=function(t){for(var r in recognizers)if(recognizers.hasOwnProperty(r)){var a=recognizers[r](this._track,t);if(a)return a}},n}();function dist$6(n){var t=n[1][0]-n[0][0],r=n[1][1]-n[0][1];return Math.sqrt(t*t+r*r)}function center$1(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var recognizers={pinch:function(n,t){var r=n.length;if(r){var a=(n[r-1]||{}).points,o=(n[r-2]||{}).points||a;if(o&&o.length>1&&a&&a.length>1){var u=dist$6(a)/dist$6(o);!isFinite(u)&&(u=1),t.pinchScale=u;var s=center$1(a);return t.pinchX=s[0],t.pinchY=s[1],{type:"pinch",target:n[0].target,event:t}}}}};function create$2(){return[1,0,0,1,0,0]}function identity$2(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function copy$1(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function mul(n,t,r){var a=t[0]*r[0]+t[2]*r[1],o=t[1]*r[0]+t[3]*r[1],u=t[0]*r[2]+t[2]*r[3],s=t[1]*r[2]+t[3]*r[3],c=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return n[0]=a,n[1]=o,n[2]=u,n[3]=s,n[4]=c,n[5]=l,n}function translate$1(n,t,r){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4]+r[0],n[5]=t[5]+r[1],n}function rotate$1(n,t,r,a){a===void 0&&(a=[0,0]);var o=t[0],u=t[2],s=t[4],c=t[1],l=t[3],d=t[5],f=Math.sin(r),h=Math.cos(r);return n[0]=o*h+c*f,n[1]=-o*f+c*h,n[2]=u*h+l*f,n[3]=-u*f+h*l,n[4]=h*(s-a[0])+f*(d-a[1])+a[0],n[5]=h*(d-a[1])-f*(s-a[0])+a[1],n}function scale$2(n,t,r){var a=r[0],o=r[1];return n[0]=t[0]*a,n[1]=t[1]*o,n[2]=t[2]*a,n[3]=t[3]*o,n[4]=t[4]*a,n[5]=t[5]*o,n}function invert(n,t){var r=t[0],a=t[2],o=t[4],u=t[1],s=t[3],c=t[5],l=r*s-u*a;return l?(l=1/l,n[0]=s*l,n[1]=-u*l,n[2]=-a*l,n[3]=r*l,n[4]=(a*c-s*o)*l,n[5]=(u*o-r*c)*l,n):null}function clone$3(n){var t=create$2();return copy$1(t,n),t}var Point=function(){function n(t,r){this.x=t||0,this.y=r||0}return n.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(t,r){return this.x=t,this.y=r,this},n.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.scale=function(t){this.x*=t,this.y*=t},n.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},n.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},n.prototype.distance=function(t){var r=this.x-t.x,a=this.y-t.y;return Math.sqrt(r*r+a*a)},n.prototype.distanceSquare=function(t){var r=this.x-t.x,a=this.y-t.y;return r*r+a*a},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(t){if(t){var r=this.x,a=this.y;return this.x=t[0]*r+t[2]*a+t[4],this.y=t[1]*r+t[3]*a+t[5],this}},n.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},n.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},n.set=function(t,r,a){t.x=r,t.y=a},n.copy=function(t,r){t.x=r.x,t.y=r.y},n.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.lenSquare=function(t){return t.x*t.x+t.y*t.y},n.dot=function(t,r){return t.x*r.x+t.y*r.y},n.add=function(t,r,a){t.x=r.x+a.x,t.y=r.y+a.y},n.sub=function(t,r,a){t.x=r.x-a.x,t.y=r.y-a.y},n.scale=function(t,r,a){t.x=r.x*a,t.y=r.y*a},n.scaleAndAdd=function(t,r,a,o){t.x=r.x+a.x*o,t.y=r.y+a.y*o},n.lerp=function(t,r,a,o){var u=1-o;t.x=u*r.x+o*a.x,t.y=u*r.y+o*a.y},n}(),mathMin$a=Math.min,mathMax$a=Math.max,lt=new Point,rb=new Point,lb=new Point,rt=new Point,minTv$1=new Point,maxTv$1=new Point,BoundingRect=function(){function n(t,r,a,o){a<0&&(t=t+a,a=-a),o<0&&(r=r+o,o=-o),this.x=t,this.y=r,this.width=a,this.height=o}return n.prototype.union=function(t){var r=mathMin$a(t.x,this.x),a=mathMin$a(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=mathMax$a(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=mathMax$a(t.y+t.height,this.y+this.height)-a:this.height=t.height,this.x=r,this.y=a},n.prototype.applyTransform=function(t){n.applyTransform(this,this,t)},n.prototype.calculateTransform=function(t){var r=this,a=t.width/r.width,o=t.height/r.height,u=create$2();return translate$1(u,u,[-r.x,-r.y]),scale$2(u,u,[a,o]),translate$1(u,u,[t.x,t.y]),u},n.prototype.intersect=function(t,r){if(!t)return!1;t instanceof n||(t=n.create(t));var a=this,o=a.x,u=a.x+a.width,s=a.y,c=a.y+a.height,l=t.x,d=t.x+t.width,f=t.y,h=t.y+t.height,v=!(u<l||d<o||c<f||h<s);if(r){var g=1/0,b=0,_=Math.abs(u-l),S=Math.abs(d-o),T=Math.abs(c-f),w=Math.abs(h-s),A=Math.min(_,S),R=Math.min(T,w);u<l||d<o?A>b&&(b=A,_<S?Point.set(maxTv$1,-_,0):Point.set(maxTv$1,S,0)):A<g&&(g=A,_<S?Point.set(minTv$1,_,0):Point.set(minTv$1,-S,0)),c<f||h<s?R>b&&(b=R,T<w?Point.set(maxTv$1,0,-T):Point.set(maxTv$1,0,w)):A<g&&(g=A,T<w?Point.set(minTv$1,0,T):Point.set(minTv$1,0,-w))}return r&&Point.copy(r,v?minTv$1:maxTv$1),v},n.prototype.contain=function(t,r){var a=this;return t>=a.x&&t<=a.x+a.width&&r>=a.y&&r<=a.y+a.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(t){n.copy(this,t)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(t){return new n(t.x,t.y,t.width,t.height)},n.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},n.applyTransform=function(t,r,a){if(!a){t!==r&&n.copy(t,r);return}if(a[1]<1e-5&&a[1]>-1e-5&&a[2]<1e-5&&a[2]>-1e-5){var o=a[0],u=a[3],s=a[4],c=a[5];t.x=r.x*o+s,t.y=r.y*u+c,t.width=r.width*o,t.height=r.height*u,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}lt.x=lb.x=r.x,lt.y=rt.y=r.y,rb.x=rt.x=r.x+r.width,rb.y=lb.y=r.y+r.height,lt.transform(a),rt.transform(a),rb.transform(a),lb.transform(a),t.x=mathMin$a(lt.x,rb.x,lb.x,rt.x),t.y=mathMin$a(lt.y,rb.y,lb.y,rt.y);var l=mathMax$a(lt.x,rb.x,lb.x,rt.x),d=mathMax$a(lt.y,rb.y,lb.y,rt.y);t.width=l-t.x,t.height=d-t.y},n}(),SILENT="silent";function makeEventPacket(n,t,r){return{type:n,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:stopEvent}}function stopEvent(){stop(this.event)}var EmptyProxy=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(Eventful),HoveredResult=function(){function n(t,r){this.x=t,this.y=r}return n}(),handlerNames=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],tmpRect$1=new BoundingRect(0,0,0,0),Handler=function(n){__extends(t,n);function t(r,a,o,u,s){var c=n.call(this)||this;return c._hovered=new HoveredResult(0,0),c.storage=r,c.painter=a,c.painterRoot=u,c._pointerSize=s,o=o||new EmptyProxy,c.proxy=null,c.setHandlerProxy(o),c._draggingMgr=new Draggable(c),c}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(each$f(handlerNames,function(a){r.on&&r.on(a,this[a],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var a=r.zrX,o=r.zrY,u=isOutsideBoundary(this,a,o),s=this._hovered,c=s.target;c&&!c.__zr&&(s=this.findHover(s.x,s.y),c=s.target);var l=this._hovered=u?new HoveredResult(a,o):this.findHover(a,o),d=l.target,f=this.proxy;f.setCursor&&f.setCursor(d?d.cursor:"default"),c&&d!==c&&this.dispatchToElement(s,"mouseout",r),this.dispatchToElement(l,"mousemove",r),d&&d!==c&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var a=r.zrEventControl;a!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),a!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new HoveredResult(0,0)},t.prototype.dispatch=function(r,a){var o=this[r];o&&o.call(this,a)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var a=this.proxy;a.setCursor&&a.setCursor(r)},t.prototype.dispatchToElement=function(r,a,o){r=r||{};var u=r.target;if(!(u&&u.silent)){for(var s="on"+a,c=makeEventPacket(a,r,o);u&&(u[s]&&(c.cancelBubble=!!u[s].call(u,c)),u.trigger(a,c),u=u.__hostTarget?u.__hostTarget:u.parent,!c.cancelBubble););c.cancelBubble||(this.trigger(a,c),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[s]=="function"&&l[s].call(l,c),l.trigger&&l.trigger(a,c)}))}},t.prototype.findHover=function(r,a,o){var u=this.storage.getDisplayList(),s=new HoveredResult(r,a);if(setHoverTarget(u,s,r,a,o),this._pointerSize&&!s.target){for(var c=[],l=this._pointerSize,d=l/2,f=new BoundingRect(r-d,a-d,l,l),h=u.length-1;h>=0;h--){var v=u[h];v!==o&&!v.ignore&&!v.ignoreCoarsePointer&&(!v.parent||!v.parent.ignoreCoarsePointer)&&(tmpRect$1.copy(v.getBoundingRect()),v.transform&&tmpRect$1.applyTransform(v.transform),tmpRect$1.intersect(f)&&c.push(v))}if(c.length)for(var g=4,b=Math.PI/12,_=Math.PI*2,S=0;S<d;S+=g)for(var T=0;T<_;T+=b){var w=r+S*Math.cos(T),A=a+S*Math.sin(T);if(setHoverTarget(c,s,w,A,o),s.target)return s}}return s},t.prototype.processGesture=function(r,a){this._gestureMgr||(this._gestureMgr=new GestureMgr);var o=this._gestureMgr;a==="start"&&o.clear();var u=o.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(a==="end"&&o.clear(),u){var s=u.type;r.gestureEvent=s;var c=new HoveredResult;c.target=u.target,this.dispatchToElement(c,s,u.event)}},t}(Eventful);each$f(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){Handler.prototype[n]=function(t){var r=t.zrX,a=t.zrY,o=isOutsideBoundary(this,r,a),u,s;if((n!=="mouseup"||!o)&&(u=this.findHover(r,a),s=u.target),n==="mousedown")this._downEl=s,this._downPoint=[t.zrX,t.zrY],this._upEl=s;else if(n==="mouseup")this._upEl=s;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||dist$7(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(u,n,t)}});function isHover(n,t,r){if(n[n.rectHover?"rectContain":"contain"](t,r)){for(var a=n,o=void 0,u=!1;a;){if(a.ignoreClip&&(u=!0),!u){var s=a.getClipPath();if(s&&!s.contain(t,r))return!1}a.silent&&(o=!0);var c=a.__hostTarget;a=c||a.parent}return o?SILENT:!0}return!1}function setHoverTarget(n,t,r,a,o){for(var u=n.length-1;u>=0;u--){var s=n[u],c=void 0;if(s!==o&&!s.ignore&&(c=isHover(s,r,a))&&(!t.topTarget&&(t.topTarget=s),c!==SILENT)){t.target=s;break}}}function isOutsideBoundary(n,t,r){var a=n.painter;return t<0||t>a.getWidth()||r<0||r>a.getHeight()}var DEFAULT_MIN_MERGE=32,DEFAULT_MIN_GALLOPING=7;function minRunLength(n){for(var t=0;n>=DEFAULT_MIN_MERGE;)t|=n&1,n>>=1;return n+t}function makeAscendingRun(n,t,r,a){var o=t+1;if(o===r)return 1;if(a(n[o++],n[t])<0){for(;o<r&&a(n[o],n[o-1])<0;)o++;reverseRun(n,t,o)}else for(;o<r&&a(n[o],n[o-1])>=0;)o++;return o-t}function reverseRun(n,t,r){for(r--;t<r;){var a=n[t];n[t++]=n[r],n[r--]=a}}function binaryInsertionSort(n,t,r,a,o){for(a===t&&a++;a<r;a++){for(var u=n[a],s=t,c=a,l;s<c;)l=s+c>>>1,o(u,n[l])<0?c=l:s=l+1;var d=a-s;switch(d){case 3:n[s+3]=n[s+2];case 2:n[s+2]=n[s+1];case 1:n[s+1]=n[s];break;default:for(;d>0;)n[s+d]=n[s+d-1],d--}n[s]=u}}function gallopLeft(n,t,r,a,o,u){var s=0,c=0,l=1;if(u(n,t[r+o])>0){for(c=a-o;l<c&&u(n,t[r+o+l])>0;)s=l,l=(l<<1)+1,l<=0&&(l=c);l>c&&(l=c),s+=o,l+=o}else{for(c=o+1;l<c&&u(n,t[r+o-l])<=0;)s=l,l=(l<<1)+1,l<=0&&(l=c);l>c&&(l=c);var d=s;s=o-l,l=o-d}for(s++;s<l;){var f=s+(l-s>>>1);u(n,t[r+f])>0?s=f+1:l=f}return l}function gallopRight(n,t,r,a,o,u){var s=0,c=0,l=1;if(u(n,t[r+o])<0){for(c=o+1;l<c&&u(n,t[r+o-l])<0;)s=l,l=(l<<1)+1,l<=0&&(l=c);l>c&&(l=c);var d=s;s=o-l,l=o-d}else{for(c=a-o;l<c&&u(n,t[r+o+l])>=0;)s=l,l=(l<<1)+1,l<=0&&(l=c);l>c&&(l=c),s+=o,l+=o}for(s++;s<l;){var f=s+(l-s>>>1);u(n,t[r+f])<0?l=f:s=f+1}return l}function TimSort(n,t){var r=DEFAULT_MIN_GALLOPING,a,o,u=0,s=[];a=[],o=[];function c(g,b){a[u]=g,o[u]=b,u+=1}function l(){for(;u>1;){var g=u-2;if(g>=1&&o[g-1]<=o[g]+o[g+1]||g>=2&&o[g-2]<=o[g]+o[g-1])o[g-1]<o[g+1]&&g--;else if(o[g]>o[g+1])break;f(g)}}function d(){for(;u>1;){var g=u-2;g>0&&o[g-1]<o[g+1]&&g--,f(g)}}function f(g){var b=a[g],_=o[g],S=a[g+1],T=o[g+1];o[g]=_+T,g===u-3&&(a[g+1]=a[g+2],o[g+1]=o[g+2]),u--;var w=gallopRight(n[S],n,b,_,0,t);b+=w,_-=w,_!==0&&(T=gallopLeft(n[b+_-1],n,S,T,T-1,t),T!==0&&(_<=T?h(b,_,S,T):v(b,_,S,T)))}function h(g,b,_,S){var T=0;for(T=0;T<b;T++)s[T]=n[g+T];var w=0,A=_,R=g;if(n[R++]=n[A++],--S===0){for(T=0;T<b;T++)n[R+T]=s[w+T];return}if(b===1){for(T=0;T<S;T++)n[R+T]=n[A+T];n[R+S]=s[w];return}for(var E=r,I,L,F;;){I=0,L=0,F=!1;do if(t(n[A],s[w])<0){if(n[R++]=n[A++],L++,I=0,--S===0){F=!0;break}}else if(n[R++]=s[w++],I++,L=0,--b===1){F=!0;break}while((I|L)<E);if(F)break;do{if(I=gallopRight(n[A],s,w,b,0,t),I!==0){for(T=0;T<I;T++)n[R+T]=s[w+T];if(R+=I,w+=I,b-=I,b<=1){F=!0;break}}if(n[R++]=n[A++],--S===0){F=!0;break}if(L=gallopLeft(s[w],n,A,S,0,t),L!==0){for(T=0;T<L;T++)n[R+T]=n[A+T];if(R+=L,A+=L,S-=L,S===0){F=!0;break}}if(n[R++]=s[w++],--b===1){F=!0;break}E--}while(I>=DEFAULT_MIN_GALLOPING||L>=DEFAULT_MIN_GALLOPING);if(F)break;E<0&&(E=0),E+=2}if(r=E,r<1&&(r=1),b===1){for(T=0;T<S;T++)n[R+T]=n[A+T];n[R+S]=s[w]}else{if(b===0)throw new Error;for(T=0;T<b;T++)n[R+T]=s[w+T]}}function v(g,b,_,S){var T=0;for(T=0;T<S;T++)s[T]=n[_+T];var w=g+b-1,A=S-1,R=_+S-1,E=0,I=0;if(n[R--]=n[w--],--b===0){for(E=R-(S-1),T=0;T<S;T++)n[E+T]=s[T];return}if(S===1){for(R-=b,w-=b,I=R+1,E=w+1,T=b-1;T>=0;T--)n[I+T]=n[E+T];n[R]=s[A];return}for(var L=r;;){var F=0,D=0,$=!1;do if(t(s[A],n[w])<0){if(n[R--]=n[w--],F++,D=0,--b===0){$=!0;break}}else if(n[R--]=s[A--],D++,F=0,--S===1){$=!0;break}while((F|D)<L);if($)break;do{if(F=b-gallopRight(s[A],n,g,b,b-1,t),F!==0){for(R-=F,w-=F,b-=F,I=R+1,E=w+1,T=F-1;T>=0;T--)n[I+T]=n[E+T];if(b===0){$=!0;break}}if(n[R--]=s[A--],--S===1){$=!0;break}if(D=S-gallopLeft(n[w],s,0,S,S-1,t),D!==0){for(R-=D,A-=D,S-=D,I=R+1,E=A+1,T=0;T<D;T++)n[I+T]=s[E+T];if(S<=1){$=!0;break}}if(n[R--]=n[w--],--b===0){$=!0;break}L--}while(F>=DEFAULT_MIN_GALLOPING||D>=DEFAULT_MIN_GALLOPING);if($)break;L<0&&(L=0),L+=2}if(r=L,r<1&&(r=1),S===1){for(R-=b,w-=b,I=R+1,E=w+1,T=b-1;T>=0;T--)n[I+T]=n[E+T];n[R]=s[A]}else{if(S===0)throw new Error;for(E=R-(S-1),T=0;T<S;T++)n[E+T]=s[T]}}return{mergeRuns:l,forceMergeRuns:d,pushRun:c}}function sort$2(n,t,r,a){r||(r=0),a||(a=n.length);var o=a-r;if(!(o<2)){var u=0;if(o<DEFAULT_MIN_MERGE){u=makeAscendingRun(n,r,a,t),binaryInsertionSort(n,r,a,r+u,t);return}var s=TimSort(n,t),c=minRunLength(o);do{if(u=makeAscendingRun(n,r,a,t),u<c){var l=o;l>c&&(l=c),binaryInsertionSort(n,r,r+l,r+u,t),u=l}s.pushRun(r,u),s.mergeRuns(),o-=u,r+=u}while(o!==0);s.forceMergeRuns()}}var REDRAW_BIT=1,STYLE_CHANGED_BIT=2,SHAPE_CHANGED_BIT=4,invalidZErrorLogged=!1;function logInvalidZError(){invalidZErrorLogged||(invalidZErrorLogged=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function shapeCompareFunc(n,t){return n.zlevel===t.zlevel?n.z===t.z?n.z2-t.z2:n.z-t.z:n.zlevel-t.zlevel}var Storage=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=shapeCompareFunc}return n.prototype.traverse=function(t,r){for(var a=0;a<this._roots.length;a++)this._roots[a].traverse(t,r)},n.prototype.getDisplayList=function(t,r){r=r||!1;var a=this._displayList;return(t||!a.length)&&this.updateDisplayList(r),a},n.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,a=this._displayList,o=0,u=r.length;o<u;o++)this._updateAndAddDisplayable(r[o],null,t);a.length=this._displayListLen,sort$2(a,shapeCompareFunc)},n.prototype._updateAndAddDisplayable=function(t,r,a){if(!(t.ignore&&!a)){t.beforeUpdate(),t.update(),t.afterUpdate();var o=t.getClipPath();if(t.ignoreClip)r=null;else if(o){r?r=r.slice():r=[];for(var u=o,s=t;u;)u.parent=s,u.updateTransform(),r.push(u),s=u,u=u.getClipPath()}if(t.childrenRef){for(var c=t.childrenRef(),l=0;l<c.length;l++){var d=c[l];t.__dirty&&(d.__dirty|=REDRAW_BIT),this._updateAndAddDisplayable(d,r,a)}t.__dirty=0}else{var f=t;r&&r.length?f.__clipPaths=r:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(logInvalidZError(),f.z=0),isNaN(f.z2)&&(logInvalidZError(),f.z2=0),isNaN(f.zlevel)&&(logInvalidZError(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var h=t.getDecalElement&&t.getDecalElement();h&&this._updateAndAddDisplayable(h,r,a);var v=t.getTextGuideLine();v&&this._updateAndAddDisplayable(v,r,a);var g=t.getTextContent();g&&this._updateAndAddDisplayable(g,r,a)}},n.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},n.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,a=t.length;r<a;r++)this.delRoot(t[r]);return}var o=indexOf(this._roots,t);o>=0&&this._roots.splice(o,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}(),requestAnimationFrame$1;requestAnimationFrame$1=env.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};var easingFuncs={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var t,r=.1,a=.4;return n===0?0:n===1?1:(!r||r<1?(r=1,t=a/4):t=a*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/a)))},elasticOut:function(n){var t,r=.1,a=.4;return n===0?0:n===1?1:(!r||r<1?(r=1,t=a/4):t=a*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*n)*Math.sin((n-t)*(2*Math.PI)/a)+1)},elasticInOut:function(n){var t,r=.1,a=.4;return n===0?0:n===1?1:(!r||r<1?(r=1,t=a/4):t=a*Math.asin(1/r)/(2*Math.PI),(n*=2)<1?-.5*(r*Math.pow(2,10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/a)):r*Math.pow(2,-10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/a)*.5+1)},backIn:function(n){var t=1.70158;return n*n*((t+1)*n-t)},backOut:function(n){var t=1.70158;return--n*n*((t+1)*n+t)+1},backInOut:function(n){var t=2.5949095;return(n*=2)<1?.5*(n*n*((t+1)*n-t)):.5*((n-=2)*n*((t+1)*n+t)+2)},bounceIn:function(n){return 1-easingFuncs.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?easingFuncs.bounceIn(n*2)*.5:easingFuncs.bounceOut(n*2-1)*.5+.5}},mathPow$2=Math.pow,mathSqrt$3=Math.sqrt,EPSILON$4=1e-8,EPSILON_NUMERIC=1e-4,THREE_SQRT=mathSqrt$3(3),ONE_THIRD=1/3,_v0=create$3(),_v1=create$3(),_v2=create$3();function isAroundZero$1(n){return n>-1e-8&&n<EPSILON$4}function isNotAroundZero$1(n){return n>EPSILON$4||n<-1e-8}function cubicAt(n,t,r,a,o){var u=1-o;return u*u*(u*n+3*o*t)+o*o*(o*a+3*u*r)}function cubicDerivativeAt(n,t,r,a,o){var u=1-o;return 3*(((t-n)*u+2*(r-t)*o)*u+(a-r)*o*o)}function cubicRootAt(n,t,r,a,o,u){var s=a+3*(t-r)-n,c=3*(r-t*2+n),l=3*(t-n),d=n-o,f=c*c-3*s*l,h=c*l-9*s*d,v=l*l-3*c*d,g=0;if(isAroundZero$1(f)&&isAroundZero$1(h))if(isAroundZero$1(c))u[0]=0;else{var b=-l/c;b>=0&&b<=1&&(u[g++]=b)}else{var _=h*h-4*f*v;if(isAroundZero$1(_)){var S=h/f,b=-c/s+S,T=-S/2;b>=0&&b<=1&&(u[g++]=b),T>=0&&T<=1&&(u[g++]=T)}else if(_>0){var w=mathSqrt$3(_),A=f*c+1.5*s*(-h+w),R=f*c+1.5*s*(-h-w);A<0?A=-mathPow$2(-A,ONE_THIRD):A=mathPow$2(A,ONE_THIRD),R<0?R=-mathPow$2(-R,ONE_THIRD):R=mathPow$2(R,ONE_THIRD);var b=(-c-(A+R))/(3*s);b>=0&&b<=1&&(u[g++]=b)}else{var E=(2*f*c-3*s*h)/(2*mathSqrt$3(f*f*f)),I=Math.acos(E)/3,L=mathSqrt$3(f),F=Math.cos(I),b=(-c-2*L*F)/(3*s),T=(-c+L*(F+THREE_SQRT*Math.sin(I)))/(3*s),D=(-c+L*(F-THREE_SQRT*Math.sin(I)))/(3*s);b>=0&&b<=1&&(u[g++]=b),T>=0&&T<=1&&(u[g++]=T),D>=0&&D<=1&&(u[g++]=D)}}return g}function cubicExtrema(n,t,r,a,o){var u=6*r-12*t+6*n,s=9*t+3*a-3*n-9*r,c=3*t-3*n,l=0;if(isAroundZero$1(s)){if(isNotAroundZero$1(u)){var d=-c/u;d>=0&&d<=1&&(o[l++]=d)}}else{var f=u*u-4*s*c;if(isAroundZero$1(f))o[0]=-u/(2*s);else if(f>0){var h=mathSqrt$3(f),d=(-u+h)/(2*s),v=(-u-h)/(2*s);d>=0&&d<=1&&(o[l++]=d),v>=0&&v<=1&&(o[l++]=v)}}return l}function cubicSubdivide(n,t,r,a,o,u){var s=(t-n)*o+n,c=(r-t)*o+t,l=(a-r)*o+r,d=(c-s)*o+s,f=(l-c)*o+c,h=(f-d)*o+d;u[0]=n,u[1]=s,u[2]=d,u[3]=h,u[4]=h,u[5]=f,u[6]=l,u[7]=a}function cubicProjectPoint(n,t,r,a,o,u,s,c,l,d,f){var h,v=.005,g=1/0,b,_,S,T;_v0[0]=l,_v0[1]=d;for(var w=0;w<1;w+=.05)_v1[0]=cubicAt(n,r,o,s,w),_v1[1]=cubicAt(t,a,u,c,w),S=distSquare(_v0,_v1),S<g&&(h=w,g=S);g=1/0;for(var A=0;A<32&&!(v<EPSILON_NUMERIC);A++)b=h-v,_=h+v,_v1[0]=cubicAt(n,r,o,s,b),_v1[1]=cubicAt(t,a,u,c,b),S=distSquare(_v1,_v0),b>=0&&S<g?(h=b,g=S):(_v2[0]=cubicAt(n,r,o,s,_),_v2[1]=cubicAt(t,a,u,c,_),T=distSquare(_v2,_v0),_<=1&&T<g?(h=_,g=T):v*=.5);return f&&(f[0]=cubicAt(n,r,o,s,h),f[1]=cubicAt(t,a,u,c,h)),mathSqrt$3(g)}function cubicLength(n,t,r,a,o,u,s,c,l){for(var d=n,f=t,h=0,v=1/l,g=1;g<=l;g++){var b=g*v,_=cubicAt(n,r,o,s,b),S=cubicAt(t,a,u,c,b),T=_-d,w=S-f;h+=Math.sqrt(T*T+w*w),d=_,f=S}return h}function quadraticAt$1(n,t,r,a){var o=1-a;return o*(o*n+2*a*t)+a*a*r}function quadraticDerivativeAt(n,t,r,a){return 2*((1-a)*(t-n)+a*(r-t))}function quadraticRootAt(n,t,r,a,o){var u=n-2*t+r,s=2*(t-n),c=n-a,l=0;if(isAroundZero$1(u)){if(isNotAroundZero$1(s)){var d=-c/s;d>=0&&d<=1&&(o[l++]=d)}}else{var f=s*s-4*u*c;if(isAroundZero$1(f)){var d=-s/(2*u);d>=0&&d<=1&&(o[l++]=d)}else if(f>0){var h=mathSqrt$3(f),d=(-s+h)/(2*u),v=(-s-h)/(2*u);d>=0&&d<=1&&(o[l++]=d),v>=0&&v<=1&&(o[l++]=v)}}return l}function quadraticExtremum(n,t,r){var a=n+r-2*t;return a===0?.5:(n-t)/a}function quadraticSubdivide(n,t,r,a,o){var u=(t-n)*a+n,s=(r-t)*a+t,c=(s-u)*a+u;o[0]=n,o[1]=u,o[2]=c,o[3]=c,o[4]=s,o[5]=r}function quadraticProjectPoint(n,t,r,a,o,u,s,c,l){var d,f=.005,h=1/0;_v0[0]=s,_v0[1]=c;for(var v=0;v<1;v+=.05){_v1[0]=quadraticAt$1(n,r,o,v),_v1[1]=quadraticAt$1(t,a,u,v);var g=distSquare(_v0,_v1);g<h&&(d=v,h=g)}h=1/0;for(var b=0;b<32&&!(f<EPSILON_NUMERIC);b++){var _=d-f,S=d+f;_v1[0]=quadraticAt$1(n,r,o,_),_v1[1]=quadraticAt$1(t,a,u,_);var g=distSquare(_v1,_v0);if(_>=0&&g<h)d=_,h=g;else{_v2[0]=quadraticAt$1(n,r,o,S),_v2[1]=quadraticAt$1(t,a,u,S);var T=distSquare(_v2,_v0);S<=1&&T<h?(d=S,h=T):f*=.5}}return l&&(l[0]=quadraticAt$1(n,r,o,d),l[1]=quadraticAt$1(t,a,u,d)),mathSqrt$3(h)}function quadraticLength(n,t,r,a,o,u,s){for(var c=n,l=t,d=0,f=1/s,h=1;h<=s;h++){var v=h*f,g=quadraticAt$1(n,r,o,v),b=quadraticAt$1(t,a,u,v),_=g-c,S=b-l;d+=Math.sqrt(_*_+S*S),c=g,l=b}return d}var regexp=/cubic-bezier\(([0-9,\.e ]+)\)/;function createCubicEasingFunc(n){var t=n&&regexp.exec(n);if(t){var r=t[1].split(","),a=+trim$1(r[0]),o=+trim$1(r[1]),u=+trim$1(r[2]),s=+trim$1(r[3]);if(isNaN(a+o+u+s))return;var c=[];return function(l){return l<=0?0:l>=1?1:cubicRootAt(0,a,u,1,l,c)&&cubicAt(0,o,s,1,c[0])}}}var Clip=function(){function n(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||noop$3,this.ondestroy=t.ondestroy||noop$3,this.onrestart=t.onrestart||noop$3,t.easing&&this.setEasing(t.easing)}return n.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var a=this._life,o=t-this._startTime-this._pausedTime,u=o/a;u<0&&(u=0),u=Math.min(u,1);var s=this.easingFunc,c=s?s(u):u;if(this.onframe(c),u===1)if(this.loop){var l=o%a;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(t){this.easing=t,this.easingFunc=isFunction$1(t)?t:easingFuncs[t]||createCubicEasingFunc(t)},n}(),Entry=function(){function n(t){this.value=t}return n}(),LinkedList=function(){function n(){this._len=0}return n.prototype.insert=function(t){var r=new Entry(t);return this.insertEntry(r),r},n.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},n.prototype.remove=function(t){var r=t.prev,a=t.next;r?r.next=a:this.head=a,a?a.prev=r:this.tail=r,t.next=t.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),LRU=function(){function n(t){this._list=new LinkedList,this._maxSize=10,this._map={},this._maxSize=t}return n.prototype.put=function(t,r){var a=this._list,o=this._map,u=null;if(o[t]==null){var s=a.len(),c=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var l=a.head;a.remove(l),delete o[l.key],u=l.value,this._lastRemovedEntry=l}c?c.value=r:c=new Entry(r),c.key=t,a.insertEntry(c),o[t]=c}return u},n.prototype.get=function(t){var r=this._map[t],a=this._list;if(r!=null)return r!==a.tail&&(a.remove(r),a.insertEntry(r)),r.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}(),kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clampCssByte(n){return n=Math.round(n),n<0?0:n>255?255:n}function clampCssAngle(n){return n=Math.round(n),n<0?0:n>360?360:n}function clampCssFloat(n){return n<0?0:n>1?1:n}function parseCssInt(n){var t=n;return t.length&&t.charAt(t.length-1)==="%"?clampCssByte(parseFloat(t)/100*255):clampCssByte(parseInt(t,10))}function parseCssFloat(n){var t=n;return t.length&&t.charAt(t.length-1)==="%"?clampCssFloat(parseFloat(t)/100):clampCssFloat(parseFloat(t))}function cssHueToRgb(n,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?n+(t-n)*r*6:r*2<1?t:r*3<2?n+(t-n)*(2/3-r)*6:n}function lerpNumber(n,t,r){return n+(t-n)*r}function setRgba(n,t,r,a,o){return n[0]=t,n[1]=r,n[2]=a,n[3]=o,n}function copyRgba(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}var colorCache=new LRU(20),lastRemovedArr=null;function putToCache(n,t){lastRemovedArr&&copyRgba(lastRemovedArr,t),lastRemovedArr=colorCache.put(n,lastRemovedArr||t.slice())}function parse$4(n,t){if(n){t=t||[];var r=colorCache.get(n);if(r)return copyRgba(t,r);n=n+"";var a=n.replace(/ /g,"").toLowerCase();if(a in kCSSColorTable)return copyRgba(t,kCSSColorTable[a]),putToCache(n,t),t;var o=a.length;if(a.charAt(0)==="#"){if(o===4||o===5){var u=parseInt(a.slice(1,4),16);if(!(u>=0&&u<=4095)){setRgba(t,0,0,0,1);return}return setRgba(t,(u&3840)>>4|(u&3840)>>8,u&240|(u&240)>>4,u&15|(u&15)<<4,o===5?parseInt(a.slice(4),16)/15:1),putToCache(n,t),t}else if(o===7||o===9){var u=parseInt(a.slice(1,7),16);if(!(u>=0&&u<=16777215)){setRgba(t,0,0,0,1);return}return setRgba(t,(u&16711680)>>16,(u&65280)>>8,u&255,o===9?parseInt(a.slice(7),16)/255:1),putToCache(n,t),t}return}var s=a.indexOf("("),c=a.indexOf(")");if(s!==-1&&c+1===o){var l=a.substr(0,s),d=a.substr(s+1,c-(s+1)).split(","),f=1;switch(l){case"rgba":if(d.length!==4)return d.length===3?setRgba(t,+d[0],+d[1],+d[2],1):setRgba(t,0,0,0,1);f=parseCssFloat(d.pop());case"rgb":if(d.length>=3)return setRgba(t,parseCssInt(d[0]),parseCssInt(d[1]),parseCssInt(d[2]),d.length===3?f:parseCssFloat(d[3])),putToCache(n,t),t;setRgba(t,0,0,0,1);return;case"hsla":if(d.length!==4){setRgba(t,0,0,0,1);return}return d[3]=parseCssFloat(d[3]),hsla2rgba(d,t),putToCache(n,t),t;case"hsl":if(d.length!==3){setRgba(t,0,0,0,1);return}return hsla2rgba(d,t),putToCache(n,t),t;default:return}}setRgba(t,0,0,0,1)}}function hsla2rgba(n,t){var r=(parseFloat(n[0])%360+360)%360/360,a=parseCssFloat(n[1]),o=parseCssFloat(n[2]),u=o<=.5?o*(a+1):o+a-o*a,s=o*2-u;return t=t||[],setRgba(t,clampCssByte(cssHueToRgb(s,u,r+1/3)*255),clampCssByte(cssHueToRgb(s,u,r)*255),clampCssByte(cssHueToRgb(s,u,r-1/3)*255),1),n.length===4&&(t[3]=n[3]),t}function rgba2hsla(n){if(n){var t=n[0]/255,r=n[1]/255,a=n[2]/255,o=Math.min(t,r,a),u=Math.max(t,r,a),s=u-o,c=(u+o)/2,l,d;if(s===0)l=0,d=0;else{c<.5?d=s/(u+o):d=s/(2-u-o);var f=((u-t)/6+s/2)/s,h=((u-r)/6+s/2)/s,v=((u-a)/6+s/2)/s;t===u?l=v-h:r===u?l=1/3+f-v:a===u&&(l=2/3+h-f),l<0&&(l+=1),l>1&&(l-=1)}var g=[l*360,d,c];return n[3]!=null&&g.push(n[3]),g}}function lift(n,t){var r=parse$4(n);if(r){for(var a=0;a<3;a++)t<0?r[a]=r[a]*(1-t)|0:r[a]=(255-r[a])*t+r[a]|0,r[a]>255?r[a]=255:r[a]<0&&(r[a]=0);return stringify$2(r,r.length===4?"rgba":"rgb")}}function fastLerp(n,t,r){if(!(!(t&&t.length)||!(n>=0&&n<=1))){r=r||[];var a=n*(t.length-1),o=Math.floor(a),u=Math.ceil(a),s=t[o],c=t[u],l=a-o;return r[0]=clampCssByte(lerpNumber(s[0],c[0],l)),r[1]=clampCssByte(lerpNumber(s[1],c[1],l)),r[2]=clampCssByte(lerpNumber(s[2],c[2],l)),r[3]=clampCssFloat(lerpNumber(s[3],c[3],l)),r}}function lerp(n,t,r){if(!(!(t&&t.length)||!(n>=0&&n<=1))){var a=n*(t.length-1),o=Math.floor(a),u=Math.ceil(a),s=parse$4(t[o]),c=parse$4(t[u]),l=a-o,d=stringify$2([clampCssByte(lerpNumber(s[0],c[0],l)),clampCssByte(lerpNumber(s[1],c[1],l)),clampCssByte(lerpNumber(s[2],c[2],l)),clampCssFloat(lerpNumber(s[3],c[3],l))],"rgba");return r?{color:d,leftIndex:o,rightIndex:u,value:a}:d}}function modifyHSL(n,t,r,a){var o=parse$4(n);if(n)return o=rgba2hsla(o),t!=null&&(o[0]=clampCssAngle(t)),r!=null&&(o[1]=parseCssFloat(r)),a!=null&&(o[2]=parseCssFloat(a)),stringify$2(hsla2rgba(o),"rgba")}function modifyAlpha(n,t){var r=parse$4(n);if(r&&t!=null)return r[3]=clampCssFloat(t),stringify$2(r,"rgba")}function stringify$2(n,t){if(!(!n||!n.length)){var r=n[0]+","+n[1]+","+n[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+n[3]),t+"("+r+")"}}function lum(n,t){var r=parse$4(n);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}var liftedColorCache=new LRU(100);function liftColor(n){if(isString(n)){var t=liftedColorCache.get(n);return t||(t=lift(n,-.1),liftedColorCache.put(n,t)),t}else if(isGradientObject(n)){var r=extend$1({},n);return r.colorStops=map$1(n.colorStops,function(a){return{offset:a.offset,color:lift(a.color,-.1)}}),r}return n}var mathRound$1=Math.round;function normalizeColor(n){var t;if(!n||n==="transparent")n="none";else if(typeof n=="string"&&n.indexOf("rgba")>-1){var r=parse$4(n);r&&(n="rgb("+r[0]+","+r[1]+","+r[2]+")",t=r[3])}return{color:n,opacity:t??1}}var EPSILON$3=1e-4;function isAroundZero(n){return n<EPSILON$3&&n>-1e-4}function round3(n){return mathRound$1(n*1e3)/1e3}function round4(n){return mathRound$1(n*1e4)/1e4}function getMatrixStr(n){return"matrix("+round3(n[0])+","+round3(n[1])+","+round3(n[2])+","+round3(n[3])+","+round4(n[4])+","+round4(n[5])+")"}var TEXT_ALIGN_TO_ANCHOR={left:"start",right:"end",center:"middle",middle:"middle"};function adjustTextY$1(n,t,r){return r==="top"?n+=t/2:r==="bottom"&&(n-=t/2),n}function hasShadow(n){return n&&(n.shadowBlur||n.shadowOffsetX||n.shadowOffsetY)}function getShadowKey(n){var t=n.style,r=n.getGlobalScale();return[t.shadowColor,(t.shadowBlur||0).toFixed(2),(t.shadowOffsetX||0).toFixed(2),(t.shadowOffsetY||0).toFixed(2),r[0],r[1]].join(",")}function isImagePattern(n){return n&&!!n.image}function isSVGPattern(n){return n&&!!n.svgElement}function isPattern(n){return isImagePattern(n)||isSVGPattern(n)}function isLinearGradient(n){return n.type==="linear"}function isRadialGradient(n){return n.type==="radial"}function isGradient(n){return n&&(n.type==="linear"||n.type==="radial")}function getIdURL(n){return"url(#"+n+")"}function getPathPrecision(n){var t=n.getGlobalScale(),r=Math.max(t[0],t[1]);return Math.max(Math.ceil(Math.log(r)/Math.log(10)),1)}function getSRTTransformString(n){var t=n.x||0,r=n.y||0,a=(n.rotation||0)*RADIAN_TO_DEGREE,o=retrieve2(n.scaleX,1),u=retrieve2(n.scaleY,1),s=n.skewX||0,c=n.skewY||0,l=[];return(t||r)&&l.push("translate("+t+"px,"+r+"px)"),a&&l.push("rotate("+a+")"),(o!==1||u!==1)&&l.push("scale("+o+","+u+")"),(s||c)&&l.push("skew("+mathRound$1(s*RADIAN_TO_DEGREE)+"deg, "+mathRound$1(c*RADIAN_TO_DEGREE)+"deg)"),l.join(" ")}var encodeBase64=function(){return env.hasGlobalWindow&&isFunction$1(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}}(),arraySlice=Array.prototype.slice;function interpolateNumber$1(n,t,r){return(t-n)*r+n}function interpolate1DArray(n,t,r,a){for(var o=t.length,u=0;u<o;u++)n[u]=interpolateNumber$1(t[u],r[u],a);return n}function interpolate2DArray(n,t,r,a){for(var o=t.length,u=o&&t[0].length,s=0;s<o;s++){n[s]||(n[s]=[]);for(var c=0;c<u;c++)n[s][c]=interpolateNumber$1(t[s][c],r[s][c],a)}return n}function add1DArray(n,t,r,a){for(var o=t.length,u=0;u<o;u++)n[u]=t[u]+r[u]*a;return n}function add2DArray(n,t,r,a){for(var o=t.length,u=o&&t[0].length,s=0;s<o;s++){n[s]||(n[s]=[]);for(var c=0;c<u;c++)n[s][c]=t[s][c]+r[s][c]*a}return n}function fillColorStops(n,t){for(var r=n.length,a=t.length,o=r>a?t:n,u=Math.min(r,a),s=o[u-1]||{color:[0,0,0,0],offset:0},c=u;c<Math.max(r,a);c++)o.push({offset:s.offset,color:s.color.slice()})}function fillArray(n,t,r){var a=n,o=t;if(!(!a.push||!o.push)){var u=a.length,s=o.length;if(u!==s){var c=u>s;if(c)a.length=s;else for(var l=u;l<s;l++)a.push(r===1?o[l]:arraySlice.call(o[l]))}for(var d=a[0]&&a[0].length,l=0;l<a.length;l++)if(r===1)isNaN(a[l])&&(a[l]=o[l]);else for(var f=0;f<d;f++)isNaN(a[l][f])&&(a[l][f]=o[l][f])}}function cloneValue(n){if(isArrayLike$1(n)){var t=n.length;if(isArrayLike$1(n[0])){for(var r=[],a=0;a<t;a++)r.push(arraySlice.call(n[a]));return r}return arraySlice.call(n)}return n}function rgba2String(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function guessArrayDim(n){return isArrayLike$1(n&&n[0])?2:1}var VALUE_TYPE_NUMBER=0,VALUE_TYPE_1D_ARRAY=1,VALUE_TYPE_2D_ARRAY=2,VALUE_TYPE_COLOR=3,VALUE_TYPE_LINEAR_GRADIENT=4,VALUE_TYPE_RADIAL_GRADIENT=5,VALUE_TYPE_UNKOWN=6;function isGradientValueType(n){return n===VALUE_TYPE_LINEAR_GRADIENT||n===VALUE_TYPE_RADIAL_GRADIENT}function isArrayValueType(n){return n===VALUE_TYPE_1D_ARRAY||n===VALUE_TYPE_2D_ARRAY}var tmpRgba=[0,0,0,0],Track=function(){function n(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(t,r,a){this._needsSort=!0;var o=this.keyframes,u=o.length,s=!1,c=VALUE_TYPE_UNKOWN,l=r;if(isArrayLike$1(r)){var d=guessArrayDim(r);c=d,(d===1&&!isNumber(r[0])||d===2&&!isNumber(r[0][0]))&&(s=!0)}else if(isNumber(r)&&!eqNaN(r))c=VALUE_TYPE_NUMBER;else if(isString(r))if(!isNaN(+r))c=VALUE_TYPE_NUMBER;else{var f=parse$4(r);f&&(l=f,c=VALUE_TYPE_COLOR)}else if(isGradientObject(r)){var h=extend$1({},l);h.colorStops=map$1(r.colorStops,function(g){return{offset:g.offset,color:parse$4(g.color)}}),isLinearGradient(r)?c=VALUE_TYPE_LINEAR_GRADIENT:isRadialGradient(r)&&(c=VALUE_TYPE_RADIAL_GRADIENT),l=h}u===0?this.valType=c:(c!==this.valType||c===VALUE_TYPE_UNKOWN)&&(s=!0),this.discrete=this.discrete||s;var v={time:t,value:l,rawValue:r,percent:0};return a&&(v.easing=a,v.easingFunc=isFunction$1(a)?a:easingFuncs[a]||createCubicEasingFunc(a)),o.push(v),v},n.prototype.prepare=function(t,r){var a=this.keyframes;this._needsSort&&a.sort(function(_,S){return _.time-S.time});for(var o=this.valType,u=a.length,s=a[u-1],c=this.discrete,l=isArrayValueType(o),d=isGradientValueType(o),f=0;f<u;f++){var h=a[f],v=h.value,g=s.value;h.percent=h.time/t,c||(l&&f!==u-1?fillArray(v,g,o):d&&fillColorStops(v.colorStops,g.colorStops))}if(!c&&o!==VALUE_TYPE_RADIAL_GRADIENT&&r&&this.needsAnimate()&&r.needsAnimate()&&o===r.valType&&!r._finished){this._additiveTrack=r;for(var b=a[0].value,f=0;f<u;f++)o===VALUE_TYPE_NUMBER?a[f].additiveValue=a[f].value-b:o===VALUE_TYPE_COLOR?a[f].additiveValue=add1DArray([],a[f].value,b,-1):isArrayValueType(o)&&(a[f].additiveValue=o===VALUE_TYPE_1D_ARRAY?add1DArray([],a[f].value,b,-1):add2DArray([],a[f].value,b,-1))}},n.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var a=this._additiveTrack!=null,o=a?"additiveValue":"value",u=this.valType,s=this.keyframes,c=s.length,l=this.propName,d=u===VALUE_TYPE_COLOR,f,h=this._lastFr,v=Math.min,g,b;if(c===1)g=b=s[0];else{if(r<0)f=0;else if(r<this._lastFrP){var _=v(h+1,c-1);for(f=_;f>=0&&!(s[f].percent<=r);f--);f=v(f,c-2)}else{for(f=h;f<c&&!(s[f].percent>r);f++);f=v(f-1,c-2)}b=s[f+1],g=s[f]}if(g&&b){this._lastFr=f,this._lastFrP=r;var S=b.percent-g.percent,T=S===0?1:v((r-g.percent)/S,1);b.easingFunc&&(T=b.easingFunc(T));var w=a?this._additiveValue:d?tmpRgba:t[l];if((isArrayValueType(u)||d)&&!w&&(w=this._additiveValue=[]),this.discrete)t[l]=T<1?g.rawValue:b.rawValue;else if(isArrayValueType(u))u===VALUE_TYPE_1D_ARRAY?interpolate1DArray(w,g[o],b[o],T):interpolate2DArray(w,g[o],b[o],T);else if(isGradientValueType(u)){var A=g[o],R=b[o],E=u===VALUE_TYPE_LINEAR_GRADIENT;t[l]={type:E?"linear":"radial",x:interpolateNumber$1(A.x,R.x,T),y:interpolateNumber$1(A.y,R.y,T),colorStops:map$1(A.colorStops,function(L,F){var D=R.colorStops[F];return{offset:interpolateNumber$1(L.offset,D.offset,T),color:rgba2String(interpolate1DArray([],L.color,D.color,T))}}),global:R.global},E?(t[l].x2=interpolateNumber$1(A.x2,R.x2,T),t[l].y2=interpolateNumber$1(A.y2,R.y2,T)):t[l].r=interpolateNumber$1(A.r,R.r,T)}else if(d)interpolate1DArray(w,g[o],b[o],T),a||(t[l]=rgba2String(w));else{var I=interpolateNumber$1(g[o],b[o],T);a?this._additiveValue=I:t[l]=I}a&&this._addToTarget(t)}}},n.prototype._addToTarget=function(t){var r=this.valType,a=this.propName,o=this._additiveValue;r===VALUE_TYPE_NUMBER?t[a]=t[a]+o:r===VALUE_TYPE_COLOR?(parse$4(t[a],tmpRgba),add1DArray(tmpRgba,tmpRgba,o,1),t[a]=rgba2String(tmpRgba)):r===VALUE_TYPE_1D_ARRAY?add1DArray(t[a],t[a],o,1):r===VALUE_TYPE_2D_ARRAY&&add2DArray(t[a],t[a],o,1)},n}(),Animator=function(){function n(t,r,a,o){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&o){logError("Can' use additive animation on looped animation.");return}this._additiveAnimators=o,this._allowDiscrete=a}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(t){this._target=t},n.prototype.when=function(t,r,a){return this.whenWithKeys(t,r,keys(r),a)},n.prototype.whenWithKeys=function(t,r,a,o){for(var u=this._tracks,s=0;s<a.length;s++){var c=a[s],l=u[c];if(!l){l=u[c]=new Track(c);var d=void 0,f=this._getAdditiveTrack(c);if(f){var h=f.keyframes,v=h[h.length-1];d=v&&v.value,f.valType===VALUE_TYPE_COLOR&&d&&(d=rgba2String(d))}else d=this._target[c];if(d==null)continue;t>0&&l.addKeyframe(0,cloneValue(d),o),this._trackKeys.push(c)}l.addKeyframe(t,cloneValue(r[c]),o)}return this._maxTime=Math.max(this._maxTime,t),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,a=0;a<r;a++)t[a].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var a=0;a<r.length;a++)r[a].call(this)},n.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,a=0;a<r.length;a++)t[r[a]].setFinished()},n.prototype._getAdditiveTrack=function(t){var r,a=this._additiveAnimators;if(a)for(var o=0;o<a.length;o++){var u=a[o].getTrack(t);u&&(r=u)}return r},n.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,a=[],o=this._maxTime||0,u=0;u<this._trackKeys.length;u++){var s=this._trackKeys[u],c=this._tracks[s],l=this._getAdditiveTrack(s),d=c.keyframes,f=d.length;if(c.prepare(o,l),c.needsAnimate())if(!this._allowDiscrete&&c.discrete){var h=d[f-1];h&&(r._target[c.propName]=h.rawValue),c.setFinished()}else a.push(c)}if(a.length||this._force){var v=new Clip({life:o,loop:this._loop,delay:this._delay||0,onframe:function(g){r._started=2;var b=r._additiveAnimators;if(b){for(var _=!1,S=0;S<b.length;S++)if(b[S]._clip){_=!0;break}_||(r._additiveAnimators=null)}for(var S=0;S<a.length;S++)a[S].step(r._target,g);var T=r._onframeCbs;if(T)for(var S=0;S<T.length;S++)T[S](r._target,g)},ondestroy:function(){r._doneCallback()}});this._clip=v,this.animation&&this.animation.addClip(v),t&&v.setEasing(t)}else this._doneCallback();return this}},n.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},n.prototype.delay=function(t){return this._delay=t,this},n.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},n.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},n.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(t){return this._tracks[t]},n.prototype.getTracks=function(){var t=this;return map$1(this._trackKeys,function(r){return t._tracks[r]})},n.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var a=this._tracks,o=this._trackKeys,u=0;u<t.length;u++){var s=a[t[u]];s&&!s.isFinished()&&(r?s.step(this._target,1):this._started===1&&s.step(this._target,0),s.setFinished())}for(var c=!0,u=0;u<o.length;u++)if(!a[o[u]].isFinished()){c=!1;break}return c&&this._abortedCallback(),c},n.prototype.saveTo=function(t,r,a){if(t){r=r||this._trackKeys;for(var o=0;o<r.length;o++){var u=r[o],s=this._tracks[u];if(!(!s||s.isFinished())){var c=s.keyframes,l=c[a?0:c.length-1];l&&(t[u]=cloneValue(l.rawValue))}}}},n.prototype.__changeFinalValue=function(t,r){r=r||keys(t);for(var a=0;a<r.length;a++){var o=r[a],u=this._tracks[o];if(u){var s=u.keyframes;if(s.length>1){var c=s.pop();u.addKeyframe(c.time,t[o]),u.prepare(this._maxTime,u.getAdditiveTrack())}}}},n}();function getTime(){return new Date().getTime()}var Animation$1=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;return a._running=!1,a._time=0,a._pausedTime=0,a._pauseStart=0,a._paused=!1,r=r||{},a.stage=r.stage||{},a}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var a=r.getClip();a&&this.addClip(a)},t.prototype.removeClip=function(r){if(r.animation){var a=r.prev,o=r.next;a?a.next=o:this._head=o,o?o.prev=a:this._tail=a,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var a=r.getClip();a&&this.removeClip(a),r.animation=null},t.prototype.update=function(r){for(var a=getTime()-this._pausedTime,o=a-this._time,u=this._head;u;){var s=u.next,c=u.step(a,o);c&&(u.ondestroy(),this.removeClip(u)),u=s}this._time=a,r||(this.trigger("frame",o),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function a(){r._running&&(requestAnimationFrame$1(a),!r._paused&&r.update())}requestAnimationFrame$1(a)},t.prototype.start=function(){this._running||(this._time=getTime(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=getTime(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=getTime()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var a=r.next;r.prev=r.next=r.animation=null,r=a}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,a){a=a||{},this.start();var o=new Animator(r,a.loop);return this.addAnimator(o),o},t}(Eventful),TOUCH_CLICK_DELAY=300,globalEventSupported=env.domSupported,localNativeListenerNames=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},a=map$1(n,function(o){var u=o.replace("mouse","pointer");return r.hasOwnProperty(u)?u:o});return{mouse:n,touch:t,pointer:a}}(),globalNativeListenerNames={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},wheelEventSupported=!1;function isPointerFromTouch(n){var t=n.pointerType;return t==="pen"||t==="touch"}function setTouchTimer(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function markTouch(n){n&&(n.zrByTouch=!0)}function normalizeGlobalEvent(n,t){return normalizeEvent(n.dom,new FakeGlobalEvent(n,t),!0)}function isLocalEl(n,t){for(var r=t,a=!1;r&&r.nodeType!==9&&!(a=r.domBelongToZr||r!==t&&r===n.painterRoot);)r=r.parentNode;return a}var FakeGlobalEvent=function(){function n(t,r){this.stopPropagation=noop$3,this.stopImmediatePropagation=noop$3,this.preventDefault=noop$3,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return n}(),localDOMHandlers={mousedown:function(n){n=normalizeEvent(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=normalizeEvent(this.dom,n);var t=this.__mayPointerCapture;t&&(n.zrX!==t[0]||n.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=normalizeEvent(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=normalizeEvent(this.dom,n);var t=n.toElement||n.relatedTarget;isLocalEl(this,t)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){wheelEventSupported=!0,n=normalizeEvent(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){wheelEventSupported||(n=normalizeEvent(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=normalizeEvent(this.dom,n),markTouch(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),localDOMHandlers.mousemove.call(this,n),localDOMHandlers.mousedown.call(this,n)},touchmove:function(n){n=normalizeEvent(this.dom,n),markTouch(n),this.handler.processGesture(n,"change"),localDOMHandlers.mousemove.call(this,n)},touchend:function(n){n=normalizeEvent(this.dom,n),markTouch(n),this.handler.processGesture(n,"end"),localDOMHandlers.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<TOUCH_CLICK_DELAY&&localDOMHandlers.click.call(this,n)},pointerdown:function(n){localDOMHandlers.mousedown.call(this,n)},pointermove:function(n){isPointerFromTouch(n)||localDOMHandlers.mousemove.call(this,n)},pointerup:function(n){localDOMHandlers.mouseup.call(this,n)},pointerout:function(n){isPointerFromTouch(n)||localDOMHandlers.mouseout.call(this,n)}};each$f(["click","dblclick","contextmenu"],function(n){localDOMHandlers[n]=function(t){t=normalizeEvent(this.dom,t),this.trigger(n,t)}});var globalDOMHandlers={pointermove:function(n){isPointerFromTouch(n)||globalDOMHandlers.mousemove.call(this,n)},pointerup:function(n){globalDOMHandlers.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),t&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function mountLocalDOMEventListeners(n,t){var r=t.domHandlers;env.pointerEventsSupported?each$f(localNativeListenerNames.pointer,function(a){mountSingleDOMEventListener(t,a,function(o){r[a].call(n,o)})}):(env.touchEventsSupported&&each$f(localNativeListenerNames.touch,function(a){mountSingleDOMEventListener(t,a,function(o){r[a].call(n,o),setTouchTimer(t)})}),each$f(localNativeListenerNames.mouse,function(a){mountSingleDOMEventListener(t,a,function(o){o=getNativeEvent(o),t.touching||r[a].call(n,o)})}))}function mountGlobalDOMEventListeners(n,t){env.pointerEventsSupported?each$f(globalNativeListenerNames.pointer,r):env.touchEventsSupported||each$f(globalNativeListenerNames.mouse,r);function r(a){function o(u){u=getNativeEvent(u),isLocalEl(n,u.target)||(u=normalizeGlobalEvent(n,u),t.domHandlers[a].call(n,u))}mountSingleDOMEventListener(t,a,o,{capture:!0})}}function mountSingleDOMEventListener(n,t,r,a){n.mounted[t]=r,n.listenerOpts[t]=a,addEventListener(n.domTarget,t,r,a)}function unmountDOMEventListeners(n){var t=n.mounted;for(var r in t)t.hasOwnProperty(r)&&removeEventListener(n.domTarget,r,t[r],n.listenerOpts[r]);n.mounted={}}var DOMHandlerScope=function(){function n(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return n}(),HandlerDomProxy=function(n){__extends(t,n);function t(r,a){var o=n.call(this)||this;return o.__pointerCapturing=!1,o.dom=r,o.painterRoot=a,o._localHandlerScope=new DOMHandlerScope(r,localDOMHandlers),globalEventSupported&&(o._globalHandlerScope=new DOMHandlerScope(document,globalDOMHandlers)),mountLocalDOMEventListeners(o,o._localHandlerScope),o}return t.prototype.dispose=function(){unmountDOMEventListeners(this._localHandlerScope),globalEventSupported&&unmountDOMEventListeners(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,globalEventSupported&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var a=this._globalHandlerScope;r?mountGlobalDOMEventListeners(this,a):unmountDOMEventListeners(a)}},t}(Eventful),dpr=1;env.hasGlobalWindow&&(dpr=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var devicePixelRatio=dpr,DARK_MODE_THRESHOLD=.4,DARK_LABEL_COLOR="#333",LIGHT_LABEL_COLOR="#ccc",LIGHTER_LABEL_COLOR="#eee",mIdentity=identity$2,EPSILON$2=5e-5;function isNotAroundZero(n){return n>EPSILON$2||n<-5e-5}var scaleTmp=[],tmpTransform=[],originTransform=create$2(),abs=Math.abs,Transformable=function(){function n(){}return n.prototype.getLocalTransform=function(t){return n.getLocalTransform(this,t)},n.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},n.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},n.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},n.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},n.prototype.needLocalTransform=function(){return isNotAroundZero(this.rotation)||isNotAroundZero(this.x)||isNotAroundZero(this.y)||isNotAroundZero(this.scaleX-1)||isNotAroundZero(this.scaleY-1)||isNotAroundZero(this.skewX)||isNotAroundZero(this.skewY)},n.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),a=this.transform;if(!(r||t)){a&&(mIdentity(a),this.invTransform=null);return}a=a||create$2(),r?this.getLocalTransform(a):mIdentity(a),t&&(r?mul(a,t,a):copy$1(a,t)),this.transform=a,this._resolveGlobalScaleRatio(a)},n.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(scaleTmp);var a=scaleTmp[0]<0?-1:1,o=scaleTmp[1]<0?-1:1,u=((scaleTmp[0]-a)*r+a)/scaleTmp[0]||0,s=((scaleTmp[1]-o)*r+o)/scaleTmp[1]||0;t[0]*=u,t[1]*=u,t[2]*=s,t[3]*=s}this.invTransform=this.invTransform||create$2(),invert(this.invTransform,t)},n.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},n.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],a=t[2]*t[2]+t[3]*t[3],o=Math.atan2(t[1],t[0]),u=Math.PI/2+o-Math.atan2(t[3],t[2]);a=Math.sqrt(a)*Math.cos(u),r=Math.sqrt(r),this.skewX=u,this.skewY=0,this.rotation=-o,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=a,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(t.invTransform=t.invTransform||create$2(),mul(tmpTransform,t.invTransform,r),r=tmpTransform);var a=this.originX,o=this.originY;(a||o)&&(originTransform[4]=a,originTransform[5]=o,mul(tmpTransform,r,originTransform),tmpTransform[4]-=a,tmpTransform[5]-=o,r=tmpTransform),this.setLocalTransform(r)}},n.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},n.prototype.transformCoordToLocal=function(t,r){var a=[t,r],o=this.invTransform;return o&&applyTransform$1(a,a,o),a},n.prototype.transformCoordToGlobal=function(t,r){var a=[t,r],o=this.transform;return o&&applyTransform$1(a,a,o),a},n.prototype.getLineScale=function(){var t=this.transform;return t&&abs(t[0]-1)>1e-10&&abs(t[3]-1)>1e-10?Math.sqrt(abs(t[0]*t[3]-t[2]*t[1])):1},n.prototype.copyTransform=function(t){copyTransform(this,t)},n.getLocalTransform=function(t,r){r=r||[];var a=t.originX||0,o=t.originY||0,u=t.scaleX,s=t.scaleY,c=t.anchorX,l=t.anchorY,d=t.rotation||0,f=t.x,h=t.y,v=t.skewX?Math.tan(t.skewX):0,g=t.skewY?Math.tan(-t.skewY):0;if(a||o||c||l){var b=a+c,_=o+l;r[4]=-b*u-v*_*s,r[5]=-_*s-g*b*u}else r[4]=r[5]=0;return r[0]=u,r[3]=s,r[1]=g*u,r[2]=v*s,d&&rotate$1(r,r,d),r[4]+=a+f,r[5]+=o+h,r},n.initDefaultProps=function(){var t=n.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),n}(),TRANSFORMABLE_PROPS=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function copyTransform(n,t){for(var r=0;r<TRANSFORMABLE_PROPS.length;r++){var a=TRANSFORMABLE_PROPS[r];n[a]=t[a]}}var textWidthCache={};function getWidth(n,t){t=t||DEFAULT_FONT;var r=textWidthCache[t];r||(r=textWidthCache[t]=new LRU(500));var a=r.get(n);return a==null&&(a=platformApi.measureText(n,t).width,r.put(n,a)),a}function innerGetBoundingRect(n,t,r,a){var o=getWidth(n,t),u=getLineHeight(t),s=adjustTextX(0,o,r),c=adjustTextY(0,u,a),l=new BoundingRect(s,c,o,u);return l}function getBoundingRect(n,t,r,a){var o=((n||"")+"").split(`
`),u=o.length;if(u===1)return innerGetBoundingRect(o[0],t,r,a);for(var s=new BoundingRect(0,0,0,0),c=0;c<o.length;c++){var l=innerGetBoundingRect(o[c],t,r,a);c===0?s.copy(l):s.union(l)}return s}function adjustTextX(n,t,r){return r==="right"?n-=t:r==="center"&&(n-=t/2),n}function adjustTextY(n,t,r){return r==="middle"?n-=t/2:r==="bottom"&&(n-=t),n}function getLineHeight(n){return getWidth("",n)}function parsePercent$1(n,t){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*t:parseFloat(n):n}function calculateTextPosition(n,t,r){var a=t.position||"inside",o=t.distance!=null?t.distance:5,u=r.height,s=r.width,c=u/2,l=r.x,d=r.y,f="left",h="top";if(a instanceof Array)l+=parsePercent$1(a[0],r.width),d+=parsePercent$1(a[1],r.height),f=null,h=null;else switch(a){case"left":l-=o,d+=c,f="right",h="middle";break;case"right":l+=o+s,d+=c,h="middle";break;case"top":l+=s/2,d-=o,f="center",h="bottom";break;case"bottom":l+=s/2,d+=u+o,f="center";break;case"inside":l+=s/2,d+=c,f="center",h="middle";break;case"insideLeft":l+=o,d+=c,h="middle";break;case"insideRight":l+=s-o,d+=c,f="right",h="middle";break;case"insideTop":l+=s/2,d+=o,f="center";break;case"insideBottom":l+=s/2,d+=u-o,f="center",h="bottom";break;case"insideTopLeft":l+=o,d+=o;break;case"insideTopRight":l+=s-o,d+=o,f="right";break;case"insideBottomLeft":l+=o,d+=u-o,h="bottom";break;case"insideBottomRight":l+=s-o,d+=u-o,f="right",h="bottom";break}return n=n||{},n.x=l,n.y=d,n.align=f,n.verticalAlign=h,n}var PRESERVED_NORMAL_STATE="__zr_normal__",PRIMARY_STATES_KEYS$1=TRANSFORMABLE_PROPS.concat(["ignore"]),DEFAULT_ANIMATABLE_MAP=reduce$1(TRANSFORMABLE_PROPS,function(n,t){return n[t]=!0,n},{ignore:!1}),tmpTextPosCalcRes={},tmpBoundingRect=new BoundingRect(0,0,0,0),Element$2=function(){function n(t){this.id=guid(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return n.prototype._init=function(t){this.attr(t)},n.prototype.drift=function(t,r,a){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var o=this.transform;o||(o=this.transform=[1,0,0,1,0,0]),o[4]+=t,o[5]+=r,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var a=this.textConfig,o=a.local,u=r.innerTransformable,s=void 0,c=void 0,l=!1;u.parent=o?this:null;var d=!1;if(u.copyTransform(r),a.position!=null){var f=tmpBoundingRect;a.layoutRect?f.copy(a.layoutRect):f.copy(this.getBoundingRect()),o||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(tmpTextPosCalcRes,a,f):calculateTextPosition(tmpTextPosCalcRes,a,f),u.x=tmpTextPosCalcRes.x,u.y=tmpTextPosCalcRes.y,s=tmpTextPosCalcRes.align,c=tmpTextPosCalcRes.verticalAlign;var h=a.origin;if(h&&a.rotation!=null){var v=void 0,g=void 0;h==="center"?(v=f.width*.5,g=f.height*.5):(v=parsePercent$1(h[0],f.width),g=parsePercent$1(h[1],f.height)),d=!0,u.originX=-u.x+v+(o?0:f.x),u.originY=-u.y+g+(o?0:f.y)}}a.rotation!=null&&(u.rotation=a.rotation);var b=a.offset;b&&(u.x+=b[0],u.y+=b[1],d||(u.originX=-b[0],u.originY=-b[1]));var _=a.inside==null?typeof a.position=="string"&&a.position.indexOf("inside")>=0:a.inside,S=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),T=void 0,w=void 0,A=void 0;_&&this.canBeInsideText()?(T=a.insideFill,w=a.insideStroke,(T==null||T==="auto")&&(T=this.getInsideTextFill()),(w==null||w==="auto")&&(w=this.getInsideTextStroke(T),A=!0)):(T=a.outsideFill,w=a.outsideStroke,(T==null||T==="auto")&&(T=this.getOutsideFill()),(w==null||w==="auto")&&(w=this.getOutsideStroke(T),A=!0)),T=T||"#000",(T!==S.fill||w!==S.stroke||A!==S.autoStroke||s!==S.align||c!==S.verticalAlign)&&(l=!0,S.fill=T,S.stroke=w,S.autoStroke=A,S.align=s,S.verticalAlign=c,r.setDefaultTextStyle(S)),r.__dirty|=REDRAW_BIT,l&&r.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(t){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?LIGHT_LABEL_COLOR:DARK_LABEL_COLOR},n.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),a=typeof r=="string"&&parse$4(r);a||(a=[255,255,255,1]);for(var o=a[3],u=this.__zr.isDarkMode(),s=0;s<3;s++)a[s]=a[s]*o+(u?0:255)*(1-o);return a[3]=1,stringify$2(a,"rgba")},n.prototype.traverse=function(t,r){},n.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},extend$1(this.extra,r)):this[t]=r},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if(isObject$4(t))for(var a=t,o=keys(a),u=0;u<o.length;u++){var s=o[u];this.attrKV(s,t[s])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,a=0;a<this.animators.length;a++){var o=this.animators[a],u=o.__fromStateTransition;if(!(o.getLoop()||u&&u!==PRESERVED_NORMAL_STATE)){var s=o.targetName,c=s?r[s]:r;o.saveTo(c)}}},n.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,PRIMARY_STATES_KEYS$1)},n.prototype._savePrimaryToNormal=function(t,r,a){for(var o=0;o<a.length;o++){var u=a[o];t[u]!=null&&!(u in r)&&(r[u]=this[u])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(t){return this.states[t]},n.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},n.prototype.clearStates=function(t){this.useState(PRESERVED_NORMAL_STATE,!1,t)},n.prototype.useState=function(t,r,a,o){var u=t===PRESERVED_NORMAL_STATE,s=this.hasState();if(!(!s&&u)){var c=this.currentStates,l=this.stateTransition;if(!(indexOf(c,t)>=0&&(r||c.length===1))){var d;if(this.stateProxy&&!u&&(d=this.stateProxy(t)),d||(d=this.states&&this.states[t]),!d&&!u){logError("State "+t+" not exists.");return}u||this.saveCurrentToNormalState(d);var f=!!(d&&d.hoverLayer||o);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,d,this._normalState,r,!a&&!this.__inHover&&l&&l.duration>0,l);var h=this._textContent,v=this._textGuide;return h&&h.useState(t,r,a,f),v&&v.useState(t,r,a,f),u?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),d}}},n.prototype.useStates=function(t,r,a){if(!t.length)this.clearStates();else{var o=[],u=this.currentStates,s=t.length,c=s===u.length;if(c){for(var l=0;l<s;l++)if(t[l]!==u[l]){c=!1;break}}if(c)return;for(var l=0;l<s;l++){var d=t[l],f=void 0;this.stateProxy&&(f=this.stateProxy(d,t)),f||(f=this.states[d]),f&&o.push(f)}var h=o[s-1],v=!!(h&&h.hoverLayer||a);v&&this._toggleHoverLayerFlag(!0);var g=this._mergeStates(o),b=this.stateTransition;this.saveCurrentToNormalState(g),this._applyStateObj(t.join(","),g,this._normalState,!1,!r&&!this.__inHover&&b&&b.duration>0,b);var _=this._textContent,S=this._textGuide;_&&_.useStates(t,r,v),S&&S.useStates(t,r,v),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!v&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}},n.prototype.isSilent=function(){for(var t=this.silent,r=this.parent;!t&&r;){if(r.silent){t=!0;break}r=r.parent}return t},n.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},n.prototype.removeState=function(t){var r=indexOf(this.currentStates,t);if(r>=0){var a=this.currentStates.slice();a.splice(r,1),this.useStates(a)}},n.prototype.replaceState=function(t,r,a){var o=this.currentStates.slice(),u=indexOf(o,t),s=indexOf(o,r)>=0;u>=0?s?o.splice(u,1):o[u]=r:a&&!s&&o.push(r),this.useStates(o)},n.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},n.prototype._mergeStates=function(t){for(var r={},a,o=0;o<t.length;o++){var u=t[o];extend$1(r,u),u.textConfig&&(a=a||{},extend$1(a,u.textConfig))}return a&&(r.textConfig=a),r},n.prototype._applyStateObj=function(t,r,a,o,u,s){var c=!(r&&o);r&&r.textConfig?(this.textConfig=extend$1({},o?this.textConfig:a.textConfig),extend$1(this.textConfig,r.textConfig)):c&&a.textConfig&&(this.textConfig=a.textConfig);for(var l={},d=!1,f=0;f<PRIMARY_STATES_KEYS$1.length;f++){var h=PRIMARY_STATES_KEYS$1[f],v=u&&DEFAULT_ANIMATABLE_MAP[h];r&&r[h]!=null?v?(d=!0,l[h]=r[h]):this[h]=r[h]:c&&a[h]!=null&&(v?(d=!0,l[h]=a[h]):this[h]=a[h])}if(!u)for(var f=0;f<this.animators.length;f++){var g=this.animators[f],b=g.targetName;g.getLoop()||g.__changeFinalValue(b?(r||a)[b]:r||a)}d&&this._transitionState(t,l,s)},n.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},n.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},n.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new Transformable,this._attachComponent(t),this._textContent=t,this.markRedraw())},n.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),extend$1(this.textConfig,t),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=REDRAW_BIT;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,a=this._textGuide;r&&(r.__inHover=t),a&&(a.__inHover=t)},n.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var a=0;a<r.length;a++)t.animation.addAnimator(r[a]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},n.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var a=0;a<r.length;a++)t.animation.removeAnimator(r[a]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},n.prototype.animate=function(t,r,a){var o=t?this[t]:this,u=new Animator(o,r,a);return t&&(u.targetName=t),this.addAnimator(u,t),u},n.prototype.addAnimator=function(t,r){var a=this.__zr,o=this;t.during(function(){o.updateDuringAnimation(r)}).done(function(){var u=o.animators,s=indexOf(u,t);s>=0&&u.splice(s,1)}),this.animators.push(t),a&&a.animation.addAnimator(t),a&&a.wakeUp()},n.prototype.updateDuringAnimation=function(t){this.markRedraw()},n.prototype.stopAnimation=function(t,r){for(var a=this.animators,o=a.length,u=[],s=0;s<o;s++){var c=a[s];!t||t===c.scope?c.stop(r):u.push(c)}return this.animators=u,this},n.prototype.animateTo=function(t,r,a){animateTo(this,t,r,a)},n.prototype.animateFrom=function(t,r,a){animateTo(this,t,r,a,!0)},n.prototype._transitionState=function(t,r,a,o){for(var u=animateTo(this,r,a,o),s=0;s<u.length;s++)u[s].__fromStateTransition=t},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var t=n.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=REDRAW_BIT;function r(a,o,u,s){Object.defineProperty(t,a,{get:function(){if(!this[o]){var l=this[o]=[];c(this,l)}return this[o]},set:function(l){this[u]=l[0],this[s]=l[1],this[o]=l,c(this,l)}});function c(l,d){Object.defineProperty(d,0,{get:function(){return l[u]},set:function(f){l[u]=f}}),Object.defineProperty(d,1,{get:function(){return l[s]},set:function(f){l[s]=f}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),n}();mixin$1(Element$2,Eventful);mixin$1(Element$2,Transformable);function animateTo(n,t,r,a,o){r=r||{};var u=[];animateToShallow(n,"",n,t,r,a,u,o);var s=u.length,c=!1,l=r.done,d=r.aborted,f=function(){c=!0,s--,s<=0&&(c?l&&l():d&&d())},h=function(){s--,s<=0&&(c?l&&l():d&&d())};s||l&&l(),u.length>0&&r.during&&u[0].during(function(b,_){r.during(_)});for(var v=0;v<u.length;v++){var g=u[v];f&&g.done(f),h&&g.aborted(h),r.force&&g.duration(r.duration),g.start(r.easing)}return u}function copyArrShallow(n,t,r){for(var a=0;a<r;a++)n[a]=t[a]}function is2DArray(n){return isArrayLike$1(n[0])}function copyValue(n,t,r){if(isArrayLike$1(t[r]))if(isArrayLike$1(n[r])||(n[r]=[]),isTypedArray(t[r])){var a=t[r].length;n[r].length!==a&&(n[r]=new t[r].constructor(a),copyArrShallow(n[r],t[r],a))}else{var o=t[r],u=n[r],s=o.length;if(is2DArray(o))for(var c=o[0].length,l=0;l<s;l++)u[l]?copyArrShallow(u[l],o[l],c):u[l]=Array.prototype.slice.call(o[l]);else copyArrShallow(u,o,s);u.length=o.length}else n[r]=t[r]}function isValueSame(n,t){return n===t||isArrayLike$1(n)&&isArrayLike$1(t)&&is1DArraySame(n,t)}function is1DArraySame(n,t){var r=n.length;if(r!==t.length)return!1;for(var a=0;a<r;a++)if(n[a]!==t[a])return!1;return!0}function animateToShallow(n,t,r,a,o,u,s,c){for(var l=keys(a),d=o.duration,f=o.delay,h=o.additive,v=o.setToFinal,g=!isObject$4(u),b=n.animators,_=[],S=0;S<l.length;S++){var T=l[S],w=a[T];if(w!=null&&r[T]!=null&&(g||u[T]))if(isObject$4(w)&&!isArrayLike$1(w)&&!isGradientObject(w)){if(t){c||(r[T]=w,n.updateDuringAnimation(t));continue}animateToShallow(n,T,r[T],w,o,u&&u[T],s,c)}else _.push(T);else c||(r[T]=w,n.updateDuringAnimation(t),_.push(T))}var A=_.length;if(!h&&A)for(var R=0;R<b.length;R++){var E=b[R];if(E.targetName===t){var I=E.stopTracks(_);if(I){var L=indexOf(b,E);b.splice(L,1)}}}if(o.force||(_=filter$1(_,function(O){return!isValueSame(a[O],r[O])}),A=_.length),A>0||o.force&&!s.length){var F=void 0,D=void 0,$=void 0;if(c){D={},v&&(F={});for(var R=0;R<A;R++){var T=_[R];D[T]=r[T],v?F[T]=a[T]:r[T]=a[T]}}else if(v){$={};for(var R=0;R<A;R++){var T=_[R];$[T]=cloneValue(r[T]),copyValue(r,a,T)}}var E=new Animator(r,!1,!1,h?filter$1(b,function(P){return P.targetName===t}):null);E.targetName=t,o.scope&&(E.scope=o.scope),v&&F&&E.whenWithKeys(0,F,_),$&&E.whenWithKeys(0,$,_),E.whenWithKeys(d??500,c?D:a,_).delay(f||0),n.addAnimator(E,t),s.push(E)}}var Group$3=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;return a.isGroup=!0,a._children=[],a.attr(r),a}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var a=this._children,o=0;o<a.length;o++)if(a[o].name===r)return a[o]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,a){if(r&&r!==this&&r.parent!==this&&a&&a.parent===this){var o=this._children,u=o.indexOf(a);u>=0&&(o.splice(u,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,a){var o=indexOf(this._children,r);return o>=0&&this.replaceAt(a,o),this},t.prototype.replaceAt=function(r,a){var o=this._children,u=o[a];if(r&&r!==this&&r.parent!==this&&r!==u){o[a]=r,u.parent=null;var s=this.__zr;s&&u.removeSelfFromZr(s),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var a=this.__zr;a&&a!==r.__zr&&r.addSelfToZr(a),a&&a.refresh()},t.prototype.remove=function(r){var a=this.__zr,o=this._children,u=indexOf(o,r);return u<0?this:(o.splice(u,1),r.parent=null,a&&r.removeSelfFromZr(a),a&&a.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,a=this.__zr,o=0;o<r.length;o++){var u=r[o];a&&u.removeSelfFromZr(a),u.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,a){for(var o=this._children,u=0;u<o.length;u++){var s=o[u];r.call(a,s,u)}return this},t.prototype.traverse=function(r,a){for(var o=0;o<this._children.length;o++){var u=this._children[o],s=r.call(a,u);u.isGroup&&!s&&u.traverse(r,a)}return this},t.prototype.addSelfToZr=function(r){n.prototype.addSelfToZr.call(this,r);for(var a=0;a<this._children.length;a++){var o=this._children[a];o.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){n.prototype.removeSelfFromZr.call(this,r);for(var a=0;a<this._children.length;a++){var o=this._children[a];o.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var a=new BoundingRect(0,0,0,0),o=r||this._children,u=[],s=null,c=0;c<o.length;c++){var l=o[c];if(!(l.ignore||l.invisible)){var d=l.getBoundingRect(),f=l.getLocalTransform(u);f?(BoundingRect.applyTransform(a,d,f),s=s||a.clone(),s.union(a)):(s=s||d.clone(),s.union(d))}}return s||a},t}(Element$2);Group$3.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var painterCtors={},instances$1={};function delInstance(n){delete instances$1[n]}function isDarkMode(n){if(!n)return!1;if(typeof n=="string")return lum(n,1)<DARK_MODE_THRESHOLD;if(n.colorStops){for(var t=n.colorStops,r=0,a=t.length,o=0;o<a;o++)r+=lum(t[o].color,1);return r/=a,r<DARK_MODE_THRESHOLD}return!1}var ZRender=function(){function n(t,r,a){var o=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,a=a||{},this.dom=r,this.id=t;var u=new Storage,s=a.renderer||"canvas";painterCtors[s]||(s=keys(painterCtors)[0]),a.useDirtyRect=a.useDirtyRect==null?!1:a.useDirtyRect;var c=new painterCtors[s](r,u,a,t),l=a.ssr||c.ssrOnly;this.storage=u,this.painter=c;var d=!env.node&&!env.worker&&!l?new HandlerDomProxy(c.getViewportRoot(),c.root):null,f=a.useCoarsePointer,h=f==null||f==="auto"?env.touchEventsSupported:!!f,v=44,g;h&&(g=retrieve2(a.pointerSize,v)),this.handler=new Handler(u,c,d,c.root,g),this.animation=new Animation$1({stage:{update:l?null:function(){return o._flush(!0)}}}),l||this.animation.start()}return n.prototype.add=function(t){this._disposed||!t||(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},n.prototype.remove=function(t){this._disposed||!t||(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(t,r){this._disposed||(this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh())},n.prototype.setBackgroundColor=function(t){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=isDarkMode(t))},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(t){this._darkMode=t},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(t){this._disposed||(t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},n.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},n.prototype.flush=function(){this._disposed||this._flush(!1)},n.prototype._flush=function(t){var r,a=getTime();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var o=getTime();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:o-a})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},n.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},n.prototype.resize=function(t){this._disposed||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},n.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},n.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},n.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},n.prototype.setCursorStyle=function(t){this._disposed||this.handler.setCursorStyle(t)},n.prototype.findHover=function(t,r){if(!this._disposed)return this.handler.findHover(t,r)},n.prototype.on=function(t,r,a){return this._disposed||this.handler.on(t,r,a),this},n.prototype.off=function(t,r){this._disposed||this.handler.off(t,r)},n.prototype.trigger=function(t,r){this._disposed||this.handler.trigger(t,r)},n.prototype.clear=function(){if(!this._disposed){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof Group$3&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},n.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,delInstance(this.id))},n}();function init$1(n,t){var r=new ZRender(guid(),n,t);return instances$1[r.id]=r,r}function registerPainter(n,t){painterCtors[n]=t}var ssrDataGetter;function getElementSSRData(n){if(typeof ssrDataGetter=="function")return ssrDataGetter(n)}function registerSSRDataGetter(n){ssrDataGetter=n}var RADIAN_EPSILON=1e-4,ROUND_SUPPORTED_PRECISION_MAX=20;function _trim(n){return n.replace(/^\s+|\s+$/g,"")}function linearMap$2(n,t,r,a){var o=t[0],u=t[1],s=r[0],c=r[1],l=u-o,d=c-s;if(l===0)return d===0?s:(s+c)/2;if(a)if(l>0){if(n<=o)return s;if(n>=u)return c}else{if(n>=o)return s;if(n<=u)return c}else{if(n===o)return s;if(n===u)return c}return(n-o)/l*d+s}function parsePercent(n,t){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return isString(n)?_trim(n).match(/%$/)?parseFloat(n)/100*t:parseFloat(n):n==null?NaN:+n}function round$3(n,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),ROUND_SUPPORTED_PRECISION_MAX),n=(+n).toFixed(t),r?n:+n}function asc$2(n){return n.sort(function(t,r){return t-r}),n}function getPrecision(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(n*t)/t===n)return r}return getPrecisionSafe(n)}function getPrecisionSafe(n){var t=n.toString().toLowerCase(),r=t.indexOf("e"),a=r>0?+t.slice(r+1):0,o=r>0?r:t.length,u=t.indexOf("."),s=u<0?0:o-1-u;return Math.max(0,s-a)}function getPixelPrecision(n,t){var r=Math.log,a=Math.LN10,o=Math.floor(r(n[1]-n[0])/a),u=Math.round(r(Math.abs(t[1]-t[0]))/a),s=Math.min(Math.max(-o+u,0),20);return isFinite(s)?s:20}function getPercentSeats(n,t){var r=reduce$1(n,function(g,b){return g+(isNaN(b)?0:b)},0);if(r===0)return[];for(var a=Math.pow(10,t),o=map$1(n,function(g){return(isNaN(g)?0:g)/r*a*100}),u=a*100,s=map$1(o,function(g){return Math.floor(g)}),c=reduce$1(s,function(g,b){return g+b},0),l=map$1(o,function(g,b){return g-s[b]});c<u;){for(var d=Number.NEGATIVE_INFINITY,f=null,h=0,v=l.length;h<v;++h)l[h]>d&&(d=l[h],f=h);++s[f],l[f]=0,++c}return map$1(s,function(g){return g/a})}function addSafe(n,t){var r=Math.max(getPrecision(n),getPrecision(t)),a=n+t;return r>ROUND_SUPPORTED_PRECISION_MAX?a:round$3(a,r)}var MAX_SAFE_INTEGER$1=9007199254740991;function remRadian(n){var t=Math.PI*2;return(n%t+t)%t}function isRadianAroundZero(n){return n>-1e-4&&n<RADIAN_EPSILON}var TIME_REG=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function parseDate(n){if(n instanceof Date)return n;if(isString(n)){var t=TIME_REG.exec(n);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function quantity(n){return Math.pow(10,quantityExponent(n))}function quantityExponent(n){if(n===0)return 0;var t=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,t)>=10&&t++,t}function nice(n,t){var r=quantityExponent(n),a=Math.pow(10,r),o=n/a,u;return o<1.5?u=1:o<2.5?u=2:o<4?u=3:o<7?u=5:u=10,n=u*a,r>=-20?+n.toFixed(r<0?-r:0):n}function quantile(n,t){var r=(n.length-1)*t+1,a=Math.floor(r),o=+n[a-1],u=r-a;return u?o+u*(n[a]-o):o}function reformIntervals(n){n.sort(function(l,d){return c(l,d,0)?-1:1});for(var t=-1/0,r=1,a=0;a<n.length;){for(var o=n[a].interval,u=n[a].close,s=0;s<2;s++)o[s]<=t&&(o[s]=t,u[s]=s?1:1-r),t=o[s],r=u[s];o[0]===o[1]&&u[0]*u[1]!==1?n.splice(a,1):a++}return n;function c(l,d,f){return l.interval[f]<d.interval[f]||l.interval[f]===d.interval[f]&&(l.close[f]-d.close[f]===(f?-1:1)||!f&&c(l,d,1))}}function numericToNumber(n){var t=parseFloat(n);return t==n&&(t!==0||!isString(n)||n.indexOf("x")<=0)?t:NaN}function isNumeric(n){return!isNaN(numericToNumber(n))}function getRandomIdBase(){return Math.round(Math.random()*9)}function getGreatestCommonDividor(n,t){return t===0?n:getGreatestCommonDividor(t,n%t)}function getLeastCommonMultiple(n,t){return n==null?t:t==null?n:n*t/getGreatestCommonDividor(n,t)}function throwError(n){throw new Error(n)}function interpolateNumber(n,t,r){return(t-n)*r+n}var DUMMY_COMPONENT_NAME_PREFIX="series\0",INTERNAL_COMPONENT_ID_PREFIX="\0_ec_\0";function normalizeToArray(n){return n instanceof Array?n:n==null?[]:[n]}function defaultEmphasis(n,t,r){if(n){n[t]=n[t]||{},n.emphasis=n.emphasis||{},n.emphasis[t]=n.emphasis[t]||{};for(var a=0,o=r.length;a<o;a++){var u=r[a];!n.emphasis[t].hasOwnProperty(u)&&n[t].hasOwnProperty(u)&&(n.emphasis[t][u]=n[t][u])}}}var TEXT_STYLE_OPTIONS=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function getDataItemValue(n){return isObject$4(n)&&!isArray$2(n)&&!(n instanceof Date)?n.value:n}function isDataItemOption(n){return isObject$4(n)&&!(n instanceof Array)}function mappingToExists(n,t,r){var a=r==="normalMerge",o=r==="replaceMerge",u=r==="replaceAll";n=n||[],t=(t||[]).slice();var s=createHashMap();each$f(t,function(l,d){if(!isObject$4(l)){t[d]=null;return}});var c=prepareResult(n,s,r);return(a||o)&&mappingById(c,n,s,t),a&&mappingByName(c,t),a||o?mappingByIndex(c,t,o):u&&mappingInReplaceAllMode(c,t),makeIdAndName(c),c}function prepareResult(n,t,r){var a=[];if(r==="replaceAll")return a;for(var o=0;o<n.length;o++){var u=n[o];u&&u.id!=null&&t.set(u.id,o),a.push({existing:r==="replaceMerge"||isComponentIdInternal(u)?null:u,newOption:null,keyInfo:null,brandNew:null})}return a}function mappingById(n,t,r,a){each$f(a,function(o,u){if(!(!o||o.id==null)){var s=makeComparableKey(o.id),c=r.get(s);if(c!=null){var l=n[c];assert(!l.newOption,'Duplicated option on id "'+s+'".'),l.newOption=o,l.existing=t[c],a[u]=null}}})}function mappingByName(n,t){each$f(t,function(r,a){if(!(!r||r.name==null))for(var o=0;o<n.length;o++){var u=n[o].existing;if(!n[o].newOption&&u&&(u.id==null||r.id==null)&&!isComponentIdInternal(r)&&!isComponentIdInternal(u)&&keyExistAndEqual("name",u,r)){n[o].newOption=r,t[a]=null;return}}})}function mappingByIndex(n,t,r){each$f(t,function(a){if(a){for(var o,u=0;(o=n[u])&&(o.newOption||isComponentIdInternal(o.existing)||o.existing&&a.id!=null&&!keyExistAndEqual("id",a,o.existing));)u++;o?(o.newOption=a,o.brandNew=r):n.push({newOption:a,brandNew:r,existing:null,keyInfo:null}),u++}})}function mappingInReplaceAllMode(n,t){each$f(t,function(r){n.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function makeIdAndName(n){var t=createHashMap();each$f(n,function(r){var a=r.existing;a&&t.set(a.id,r)}),each$f(n,function(r){var a=r.newOption;assert(!a||a.id==null||!t.get(a.id)||t.get(a.id)===r,"id duplicates: "+(a&&a.id)),a&&a.id!=null&&t.set(a.id,r),!r.keyInfo&&(r.keyInfo={})}),each$f(n,function(r,a){var o=r.existing,u=r.newOption,s=r.keyInfo;if(isObject$4(u)){if(s.name=u.name!=null?makeComparableKey(u.name):o?o.name:DUMMY_COMPONENT_NAME_PREFIX+a,o)s.id=makeComparableKey(o.id);else if(u.id!=null)s.id=makeComparableKey(u.id);else{var c=0;do s.id="\0"+s.name+"\0"+c++;while(t.get(s.id))}t.set(s.id,r)}})}function keyExistAndEqual(n,t,r){var a=convertOptionIdName(t[n],null),o=convertOptionIdName(r[n],null);return a!=null&&o!=null&&a===o}function makeComparableKey(n){return convertOptionIdName(n,"")}function convertOptionIdName(n,t){return n==null?t:isString(n)?n:isNumber(n)||isStringSafe(n)?n+"":t}function isNameSpecified(n){var t=n.name;return!!(t&&t.indexOf(DUMMY_COMPONENT_NAME_PREFIX))}function isComponentIdInternal(n){return n&&n.id!=null&&makeComparableKey(n.id).indexOf(INTERNAL_COMPONENT_ID_PREFIX)===0}function makeInternalComponentId(n){return INTERNAL_COMPONENT_ID_PREFIX+n}function setComponentTypeToKeyInfo(n,t,r){each$f(n,function(a){var o=a.newOption;isObject$4(o)&&(a.keyInfo.mainType=t,a.keyInfo.subType=determineSubType(t,o,a.existing,r))})}function determineSubType(n,t,r,a){var o=t.type?t.type:r?r.subType:a.determineSubType(n,t);return o}function compressBatches(n,t){var r={},a={};return o(n||[],r),o(t||[],a,r),[u(r),u(a)];function o(s,c,l){for(var d=0,f=s.length;d<f;d++){var h=convertOptionIdName(s[d].seriesId,null);if(h==null)return;for(var v=normalizeToArray(s[d].dataIndex),g=l&&l[h],b=0,_=v.length;b<_;b++){var S=v[b];g&&g[S]?g[S]=null:(c[h]||(c[h]={}))[S]=1}}}function u(s,c){var l=[];for(var d in s)if(s.hasOwnProperty(d)&&s[d]!=null)if(c)l.push(+d);else{var f=u(s[d],!0);f.length&&l.push({seriesId:d,dataIndex:f})}return l}}function queryDataIndex(n,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return isArray$2(t.dataIndex)?map$1(t.dataIndex,function(r){return n.indexOfRawIndex(r)}):n.indexOfRawIndex(t.dataIndex);if(t.name!=null)return isArray$2(t.name)?map$1(t.name,function(r){return n.indexOfName(r)}):n.indexOfName(t.name)}function makeInner(){var n="__ec_inner_"+innerUniqueIndex++;return function(t){return t[n]||(t[n]={})}}var innerUniqueIndex=getRandomIdBase();function parseFinder$1(n,t,r){var a=preParseFinder(t,r),o=a.mainTypeSpecified,u=a.queryOptionMap,s=a.others,c=s,l=r?r.defaultMainType:null;return!o&&l&&u.set(l,{}),u.each(function(d,f){var h=queryReferringComponents(n,f,d,{useDefault:l===f,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});c[f+"Models"]=h.models,c[f+"Model"]=h.models[0]}),c}function preParseFinder(n,t){var r;if(isString(n)){var a={};a[n+"Index"]=0,r=a}else r=n;var o=createHashMap(),u={},s=!1;return each$f(r,function(c,l){if(l==="dataIndex"||l==="dataIndexInside"){u[l]=c;return}var d=l.match(/^(\w+)(Index|Id|Name)$/)||[],f=d[1],h=(d[2]||"").toLowerCase();if(!(!f||!h||t&&t.includeMainTypes&&indexOf(t.includeMainTypes,f)<0)){s=s||!!f;var v=o.get(f)||o.set(f,{});v[h]=c}}),{mainTypeSpecified:s,queryOptionMap:o,others:u}}var SINGLE_REFERRING={useDefault:!0,enableAll:!1,enableNone:!1},MULTIPLE_REFERRING={useDefault:!1,enableAll:!0,enableNone:!0};function queryReferringComponents(n,t,r,a){a=a||SINGLE_REFERRING;var o=r.index,u=r.id,s=r.name,c={models:null,specified:o!=null||u!=null||s!=null};if(!c.specified){var l=void 0;return c.models=a.useDefault&&(l=n.getComponent(t))?[l]:[],c}return o==="none"||o===!1?(assert(a.enableNone,'`"none"` or `false` is not a valid value on index option.'),c.models=[],c):(o==="all"&&(assert(a.enableAll,'`"all"` is not a valid value on index option.'),o=u=s=null),c.models=n.queryComponents({mainType:t,index:o,id:u,name:s}),c)}function setAttribute(n,t,r){n.setAttribute?n.setAttribute(t,r):n[t]=r}function getTooltipRenderMode(n){return n==="auto"?env.domSupported?"html":"richText":n||"html"}function groupData(n,t){var r=createHashMap(),a=[];return each$f(n,function(o){var u=t(o);(r.get(u)||(a.push(u),r.set(u,[]))).push(o)}),{keys:a,buckets:r}}function interpolateRawValues(n,t,r,a,o){var u=t==null||t==="auto";if(a==null)return a;if(isNumber(a)){var s=interpolateNumber(r||0,a,o);return round$3(s,u?Math.max(getPrecision(r||0),getPrecision(a)):t)}else{if(isString(a))return o<1?r:a;for(var c=[],l=r,d=a,f=Math.max(l?l.length:0,d.length),h=0;h<f;++h){var v=n.getDimensionInfo(h);if(v&&v.type==="ordinal")c[h]=(o<1&&l?l:d)[h];else{var g=l&&l[h]?l[h]:0,b=d[h],s=interpolateNumber(g,b,o);c[h]=round$3(s,u?Math.max(getPrecision(g),getPrecision(b)):t)}}return c}}var TYPE_DELIMITER=".",IS_CONTAINER="___EC__COMPONENT__CONTAINER___",IS_EXTENDED_CLASS="___EC__EXTENDED_CLASS___";function parseClassType(n){var t={main:"",sub:""};if(n){var r=n.split(TYPE_DELIMITER);t.main=r[0]||"",t.sub=r[1]||""}return t}function checkClassType(n){assert(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function isExtendedClass(n){return!!(n&&n[IS_EXTENDED_CLASS])}function enableClassExtend(n,t){n.$constructor=n,n.extend=function(r){var a=this,o;return isESClass(a)?o=function(u){__extends(s,u);function s(){return u.apply(this,arguments)||this}return s}(a):(o=function(){(r.$constructor||a).apply(this,arguments)},inherits(o,this)),extend$1(o.prototype,r),o[IS_EXTENDED_CLASS]=!0,o.extend=this.extend,o.superCall=superCall,o.superApply=superApply,o.superClass=a,o}}function isESClass(n){return isFunction$1(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function mountExtend(n,t){n.extend=t.extend}var classBase=Math.round(Math.random()*10);function enableClassCheck(n){var t=["__\0is_clz",classBase++].join("_");n.prototype[t]=!0,n.isInstance=function(r){return!!(r&&r[t])}}function superCall(n,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return this.superClass.prototype[t].apply(n,r)}function superApply(n,t,r){return this.superClass.prototype[t].apply(n,r)}function enableClassManagement(n){var t={};n.registerClass=function(a){var o=a.type||a.prototype.type;if(o){checkClassType(o),a.prototype.type=o;var u=parseClassType(o);if(!u.sub)t[u.main]=a;else if(u.sub!==IS_CONTAINER){var s=r(u);s[u.sub]=a}}return a},n.getClass=function(a,o,u){var s=t[a];if(s&&s[IS_CONTAINER]&&(s=o?s[o]:null),u&&!s)throw new Error(o?"Component "+a+"."+(o||"")+" is used but not imported.":a+".type should be specified.");return s},n.getClassesByMainType=function(a){var o=parseClassType(a),u=[],s=t[o.main];return s&&s[IS_CONTAINER]?each$f(s,function(c,l){l!==IS_CONTAINER&&u.push(c)}):u.push(s),u},n.hasClass=function(a){var o=parseClassType(a);return!!t[o.main]},n.getAllClassMainTypes=function(){var a=[];return each$f(t,function(o,u){a.push(u)}),a},n.hasSubTypes=function(a){var o=parseClassType(a),u=t[o.main];return u&&u[IS_CONTAINER]};function r(a){var o=t[a.main];return(!o||!o[IS_CONTAINER])&&(o=t[a.main]={},o[IS_CONTAINER]=!0),o}}function makeStyleMapper(n,t){for(var r=0;r<n.length;r++)n[r][1]||(n[r][1]=n[r][0]);return t=t||!1,function(a,o,u){for(var s={},c=0;c<n.length;c++){var l=n[c][1];if(!(o&&indexOf(o,l)>=0||u&&indexOf(u,l)<0)){var d=a.getShallow(l,t);d!=null&&(s[n[c][0]]=d)}}return s}}var AREA_STYLE_KEY_MAP=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],getAreaStyle=makeStyleMapper(AREA_STYLE_KEY_MAP),AreaStyleMixin=function(){function n(){}return n.prototype.getAreaStyle=function(t,r){return getAreaStyle(this,t,r)},n}(),globalImageCache=new LRU(50);function findExistImage(n){if(typeof n=="string"){var t=globalImageCache.get(n);return t&&t.image}else return n}function createOrUpdateImage(n,t,r,a,o){if(n)if(typeof n=="string"){if(t&&t.__zrImageSrc===n||!r)return t;var u=globalImageCache.get(n),s={hostEl:r,cb:a,cbPayload:o};return u?(t=u.image,!isImageReady(t)&&u.pending.push(s)):(t=platformApi.loadImage(n,imageOnLoad,imageOnLoad),t.__zrImageSrc=n,globalImageCache.put(n,t.__cachedImgObj={image:t,pending:[s]})),t}else return n;else return t}function imageOnLoad(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<n.pending.length;t++){var r=n.pending[t],a=r.cb;a&&a(this,r.cbPayload),r.hostEl.dirty()}n.pending.length=0}function isImageReady(n){return n&&n.width&&n.height}var STYLE_REG=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function truncateText2(n,t,r,a,o,u){if(!r){n.text="",n.isTruncated=!1;return}var s=(t+"").split(`
`);u=prepareTruncateOptions(r,a,o,u);for(var c=!1,l={},d=0,f=s.length;d<f;d++)truncateSingleLine(l,s[d],u),s[d]=l.textLine,c=c||l.isTruncated;n.text=s.join(`
`),n.isTruncated=c}function prepareTruncateOptions(n,t,r,a){a=a||{};var o=extend$1({},a);o.font=t,r=retrieve2(r,"..."),o.maxIterations=retrieve2(a.maxIterations,2);var u=o.minChar=retrieve2(a.minChar,0);o.cnCharWidth=getWidth("",t);var s=o.ascCharWidth=getWidth("a",t);o.placeholder=retrieve2(a.placeholder,"");for(var c=n=Math.max(0,n-1),l=0;l<u&&c>=s;l++)c-=s;var d=getWidth(r,t);return d>c&&(r="",d=0),c=n-d,o.ellipsis=r,o.ellipsisWidth=d,o.contentWidth=c,o.containerWidth=n,o}function truncateSingleLine(n,t,r){var a=r.containerWidth,o=r.font,u=r.contentWidth;if(!a){n.textLine="",n.isTruncated=!1;return}var s=getWidth(t,o);if(s<=a){n.textLine=t,n.isTruncated=!1;return}for(var c=0;;c++){if(s<=u||c>=r.maxIterations){t+=r.ellipsis;break}var l=c===0?estimateLength(t,u,r.ascCharWidth,r.cnCharWidth):s>0?Math.floor(t.length*u/s):0;t=t.substr(0,l),s=getWidth(t,o)}t===""&&(t=r.placeholder),n.textLine=t,n.isTruncated=!0}function estimateLength(n,t,r,a){for(var o=0,u=0,s=n.length;u<s&&o<t;u++){var c=n.charCodeAt(u);o+=0<=c&&c<=127?r:a}return u}function parsePlainText(n,t){n!=null&&(n+="");var r=t.overflow,a=t.padding,o=t.font,u=r==="truncate",s=getLineHeight(o),c=retrieve2(t.lineHeight,s),l=!!t.backgroundColor,d=t.lineOverflow==="truncate",f=!1,h=t.width,v;h!=null&&(r==="break"||r==="breakAll")?v=n?wrapText(n,t.font,h,r==="breakAll",0).lines:[]:v=n?n.split(`
`):[];var g=v.length*c,b=retrieve2(t.height,g);if(g>b&&d){var _=Math.floor(b/c);f=f||v.length>_,v=v.slice(0,_)}if(n&&u&&h!=null)for(var S=prepareTruncateOptions(h,o,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),T={},w=0;w<v.length;w++)truncateSingleLine(T,v[w],S),v[w]=T.textLine,f=f||T.isTruncated;for(var A=b,R=0,w=0;w<v.length;w++)R=Math.max(getWidth(v[w],o),R);h==null&&(h=R);var E=R;return a&&(A+=a[0]+a[2],E+=a[1]+a[3],h+=a[1]+a[3]),l&&(E=h),{lines:v,height:b,outerWidth:E,outerHeight:A,lineHeight:c,calculatedLineHeight:s,contentWidth:R,contentHeight:g,width:h,isTruncated:f}}var RichTextToken=function(){function n(){}return n}(),RichTextLine=function(){function n(t){this.tokens=[],t&&(this.tokens=t)}return n}(),RichTextContentBlock=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}return n}();function parseRichText(n,t){var r=new RichTextContentBlock;if(n!=null&&(n+=""),!n)return r;for(var a=t.width,o=t.height,u=t.overflow,s=(u==="break"||u==="breakAll")&&a!=null?{width:a,accumWidth:0,breakAll:u==="breakAll"}:null,c=STYLE_REG.lastIndex=0,l;(l=STYLE_REG.exec(n))!=null;){var d=l.index;d>c&&pushTokens(r,n.substring(c,d),t,s),pushTokens(r,l[2],t,s,l[1]),c=STYLE_REG.lastIndex}c<n.length&&pushTokens(r,n.substring(c,n.length),t,s);var f=[],h=0,v=0,g=t.padding,b=u==="truncate",_=t.lineOverflow==="truncate",S={};function T(W,te,ue){W.width=te,W.lineHeight=ue,h+=ue,v=Math.max(v,te)}e:for(var w=0;w<r.lines.length;w++){for(var A=r.lines[w],R=0,E=0,I=0;I<A.tokens.length;I++){var L=A.tokens[I],F=L.styleName&&t.rich[L.styleName]||{},D=L.textPadding=F.padding,$=D?D[1]+D[3]:0,O=L.font=F.font||t.font;L.contentHeight=getLineHeight(O);var P=retrieve2(F.height,L.contentHeight);if(L.innerHeight=P,D&&(P+=D[0]+D[2]),L.height=P,L.lineHeight=retrieve3(F.lineHeight,t.lineHeight,P),L.align=F&&F.align||t.align,L.verticalAlign=F&&F.verticalAlign||"middle",_&&o!=null&&h+L.lineHeight>o){var C=r.lines.length;I>0?(A.tokens=A.tokens.slice(0,I),T(A,E,R),r.lines=r.lines.slice(0,w+1)):r.lines=r.lines.slice(0,w),r.isTruncated=r.isTruncated||r.lines.length<C;break e}var q=F.width,M=q==null||q==="auto";if(typeof q=="string"&&q.charAt(q.length-1)==="%")L.percentWidth=q,f.push(L),L.contentWidth=getWidth(L.text,O);else{if(M){var N=F.backgroundColor,G=N&&N.image;G&&(G=findExistImage(G),isImageReady(G)&&(L.width=Math.max(L.width,G.width*P/G.height)))}var X=b&&a!=null?a-E:null;X!=null&&X<L.width?!M||X<$?(L.text="",L.width=L.contentWidth=0):(truncateText2(S,L.text,X-$,O,t.ellipsis,{minChar:t.truncateMinChar}),L.text=S.text,r.isTruncated=r.isTruncated||S.isTruncated,L.width=L.contentWidth=getWidth(L.text,O)):L.contentWidth=getWidth(L.text,O)}L.width+=$,E+=L.width,F&&(R=Math.max(R,L.lineHeight))}T(A,E,R)}r.outerWidth=r.width=retrieve2(a,v),r.outerHeight=r.height=retrieve2(o,h),r.contentHeight=h,r.contentWidth=v,g&&(r.outerWidth+=g[1]+g[3],r.outerHeight+=g[0]+g[2]);for(var w=0;w<f.length;w++){var L=f[w],Y=L.percentWidth;L.width=parseInt(Y,10)/100*r.width}return r}function pushTokens(n,t,r,a,o){var u=t==="",s=o&&r.rich[o]||{},c=n.lines,l=s.font||r.font,d=!1,f,h;if(a){var v=s.padding,g=v?v[1]+v[3]:0;if(s.width!=null&&s.width!=="auto"){var b=parsePercent$1(s.width,a.width)+g;c.length>0&&b+a.accumWidth>a.width&&(f=t.split(`
`),d=!0),a.accumWidth=b}else{var _=wrapText(t,l,a.width,a.breakAll,a.accumWidth);a.accumWidth=_.accumWidth+g,h=_.linesWidths,f=_.lines}}else f=t.split(`
`);for(var S=0;S<f.length;S++){var T=f[S],w=new RichTextToken;if(w.styleName=o,w.text=T,w.isLineHolder=!T&&!u,typeof s.width=="number"?w.width=s.width:w.width=h?h[S]:getWidth(T,l),!S&&!d){var A=(c[c.length-1]||(c[0]=new RichTextLine)).tokens,R=A.length;R===1&&A[0].isLineHolder?A[0]=w:(T||!R||u)&&A.push(w)}else c.push(new RichTextLine([w]))}}function isAlphabeticLetter(n){var t=n.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var breakCharMap=reduce$1(",&?/;] ".split(""),function(n,t){return n[t]=!0,n},{});function isWordBreakChar(n){return isAlphabeticLetter(n)?!!breakCharMap[n]:!0}function wrapText(n,t,r,a,o){for(var u=[],s=[],c="",l="",d=0,f=0,h=0;h<n.length;h++){var v=n.charAt(h);if(v===`
`){l&&(c+=l,f+=d),u.push(c),s.push(f),c="",l="",d=0,f=0;continue}var g=getWidth(v,t),b=a?!1:!isWordBreakChar(v);if(u.length?f+g>r:o+f+g>r){f?(c||l)&&(b?(c||(c=l,l="",d=0,f=d),u.push(c),s.push(f-d),l+=v,d+=g,c="",f=d):(l&&(c+=l,l="",d=0),u.push(c),s.push(f),c=v,f=g)):b?(u.push(l),s.push(d),l=v,d=g):(u.push(v),s.push(g));continue}f+=g,b?(l+=v,d+=g):(l&&(c+=l,l="",d=0),c+=v)}return!u.length&&!c&&(c=n,l="",d=0),l&&(c+=l),c&&(u.push(c),s.push(f)),u.length===1&&(f+=o),{accumWidth:f,lines:u,linesWidths:s}}var STYLE_MAGIC_KEY="__zr_style_"+Math.round(Math.random()*10),DEFAULT_COMMON_STYLE={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},DEFAULT_COMMON_ANIMATION_PROPS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};DEFAULT_COMMON_STYLE[STYLE_MAGIC_KEY]=!0;var PRIMARY_STATES_KEYS=["z","z2","invisible"],PRIMARY_STATES_KEYS_IN_HOVER_LAYER=["invisible"],Displayable=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype._init=function(r){for(var a=keys(r),o=0;o<a.length;o++){var u=a[o];u==="style"?this.useStyle(r[u]):n.prototype.attrKV.call(this,u,r[u])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,a,o,u){var s=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&isDisplayableCulled(this,r,a)||s&&!s[0]&&!s[3])return!1;if(o&&this.__clipPaths){for(var c=0;c<this.__clipPaths.length;++c)if(this.__clipPaths[c].isZeroArea())return!1}if(u&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,a){return this.rectContain(r,a)},t.prototype.traverse=function(r,a){r.call(a,this)},t.prototype.rectContain=function(r,a){var o=this.transformCoordToLocal(r,a),u=this.getBoundingRect();return u.contain(o[0],o[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var a=this.transform,o=this.getBoundingRect(),u=this.style,s=u.shadowBlur||0,c=u.shadowOffsetX||0,l=u.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new BoundingRect(0,0,0,0)),a?BoundingRect.applyTransform(r,o,a):r.copy(o),(s||c||l)&&(r.width+=s*2+Math.abs(c),r.height+=s*2+Math.abs(l),r.x=Math.min(r.x,r.x+c-s),r.y=Math.min(r.y,r.y+l-s));var d=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-d),r.y=Math.floor(r.y-d),r.width=Math.ceil(r.width+1+d*2),r.height=Math.ceil(r.height+1+d*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new BoundingRect(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,a){r!=="style"?n.prototype.attrKV.call(this,r,a):this.style?this.setStyle(a):this.useStyle(a)},t.prototype.setStyle=function(r,a){return typeof r=="string"?this.style[r]=a:extend$1(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=STYLE_CHANGED_BIT,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&STYLE_CHANGED_BIT)},t.prototype.styleUpdated=function(){this.__dirty&=-3},t.prototype.createStyle=function(r){return createObject(DEFAULT_COMMON_STYLE,r)},t.prototype.useStyle=function(r){r[STYLE_MAGIC_KEY]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[STYLE_MAGIC_KEY]},t.prototype._innerSaveToNormal=function(r){n.prototype._innerSaveToNormal.call(this,r);var a=this._normalState;r.style&&!a.style&&(a.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,a,PRIMARY_STATES_KEYS)},t.prototype._applyStateObj=function(r,a,o,u,s,c){n.prototype._applyStateObj.call(this,r,a,o,u,s,c);var l=!(a&&u),d;if(a&&a.style?s?u?d=a.style:(d=this._mergeStyle(this.createStyle(),o.style),this._mergeStyle(d,a.style)):(d=this._mergeStyle(this.createStyle(),u?this.style:o.style),this._mergeStyle(d,a.style)):l&&(d=o.style),d)if(s){var f=this.style;if(this.style=this.createStyle(l?{}:f),l)for(var h=keys(f),v=0;v<h.length;v++){var g=h[v];g in d&&(d[g]=d[g],this.style[g]=f[g])}for(var b=keys(d),v=0;v<b.length;v++){var g=b[v];this.style[g]=this.style[g]}this._transitionState(r,{style:d},c,this.getAnimationStyleProps())}else this.useStyle(d);for(var _=this.__inHover?PRIMARY_STATES_KEYS_IN_HOVER_LAYER:PRIMARY_STATES_KEYS,v=0;v<_.length;v++){var g=_[v];a&&a[g]!=null?this[g]=a[g]:l&&o[g]!=null&&(this[g]=o[g])}},t.prototype._mergeStates=function(r){for(var a=n.prototype._mergeStates.call(this,r),o,u=0;u<r.length;u++){var s=r[u];s.style&&(o=o||{},this._mergeStyle(o,s.style))}return o&&(a.style=o),a},t.prototype._mergeStyle=function(r,a){return extend$1(r,a),r},t.prototype.getAnimationStyleProps=function(){return DEFAULT_COMMON_ANIMATION_PROPS},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT}(),t}(Element$2),tmpRect=new BoundingRect(0,0,0,0),viewRect=new BoundingRect(0,0,0,0);function isDisplayableCulled(n,t,r){return tmpRect.copy(n.getBoundingRect()),n.transform&&tmpRect.applyTransform(n.transform),viewRect.width=t,viewRect.height=r,!tmpRect.intersect(viewRect)}var mathMin$9=Math.min,mathMax$9=Math.max,mathSin$4=Math.sin,mathCos$4=Math.cos,PI2$8=Math.PI*2,start=create$3(),end=create$3(),extremity=create$3();function fromPoints(n,t,r){if(n.length!==0){for(var a=n[0],o=a[0],u=a[0],s=a[1],c=a[1],l=1;l<n.length;l++)a=n[l],o=mathMin$9(o,a[0]),u=mathMax$9(u,a[0]),s=mathMin$9(s,a[1]),c=mathMax$9(c,a[1]);t[0]=o,t[1]=s,r[0]=u,r[1]=c}}function fromLine(n,t,r,a,o,u){o[0]=mathMin$9(n,r),o[1]=mathMin$9(t,a),u[0]=mathMax$9(n,r),u[1]=mathMax$9(t,a)}var xDim=[],yDim=[];function fromCubic(n,t,r,a,o,u,s,c,l,d){var f=cubicExtrema,h=cubicAt,v=f(n,r,o,s,xDim);l[0]=1/0,l[1]=1/0,d[0]=-1/0,d[1]=-1/0;for(var g=0;g<v;g++){var b=h(n,r,o,s,xDim[g]);l[0]=mathMin$9(b,l[0]),d[0]=mathMax$9(b,d[0])}v=f(t,a,u,c,yDim);for(var g=0;g<v;g++){var _=h(t,a,u,c,yDim[g]);l[1]=mathMin$9(_,l[1]),d[1]=mathMax$9(_,d[1])}l[0]=mathMin$9(n,l[0]),d[0]=mathMax$9(n,d[0]),l[0]=mathMin$9(s,l[0]),d[0]=mathMax$9(s,d[0]),l[1]=mathMin$9(t,l[1]),d[1]=mathMax$9(t,d[1]),l[1]=mathMin$9(c,l[1]),d[1]=mathMax$9(c,d[1])}function fromQuadratic(n,t,r,a,o,u,s,c){var l=quadraticExtremum,d=quadraticAt$1,f=mathMax$9(mathMin$9(l(n,r,o),1),0),h=mathMax$9(mathMin$9(l(t,a,u),1),0),v=d(n,r,o,f),g=d(t,a,u,h);s[0]=mathMin$9(n,o,v),s[1]=mathMin$9(t,u,g),c[0]=mathMax$9(n,o,v),c[1]=mathMax$9(t,u,g)}function fromArc(n,t,r,a,o,u,s,c,l){var d=min$2,f=max$3,h=Math.abs(o-u);if(h%PI2$8<1e-4&&h>1e-4){c[0]=n-r,c[1]=t-a,l[0]=n+r,l[1]=t+a;return}if(start[0]=mathCos$4(o)*r+n,start[1]=mathSin$4(o)*a+t,end[0]=mathCos$4(u)*r+n,end[1]=mathSin$4(u)*a+t,d(c,start,end),f(l,start,end),o=o%PI2$8,o<0&&(o=o+PI2$8),u=u%PI2$8,u<0&&(u=u+PI2$8),o>u&&!s?u+=PI2$8:o<u&&s&&(o+=PI2$8),s){var v=u;u=o,o=v}for(var g=0;g<u;g+=Math.PI/2)g>o&&(extremity[0]=mathCos$4(g)*r+n,extremity[1]=mathSin$4(g)*a+t,d(c,extremity,c),f(l,extremity,l))}var CMD$4={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},tmpOutX=[],tmpOutY=[],min$1=[],max$2=[],min2=[],max2=[],mathMin$8=Math.min,mathMax$8=Math.max,mathCos$3=Math.cos,mathSin$3=Math.sin,mathAbs$2=Math.abs,PI$8=Math.PI,PI2$7=PI$8*2,hasTypedArray=typeof Float32Array<"u",tmpAngles=[];function modPI2(n){var t=Math.round(n/PI$8*1e8)/1e8;return t%2*PI$8}function normalizeArcAngles(n,t){var r=modPI2(n[0]);r<0&&(r+=PI2$7);var a=r-n[0],o=n[1];o+=a,!t&&o-r>=PI2$7?o=r+PI2$7:t&&r-o>=PI2$7?o=r-PI2$7:!t&&r>o?o=r+(PI2$7-modPI2(r-o)):t&&r<o&&(o=r-(PI2$7-modPI2(o-r))),n[0]=r,n[1]=o}var PathProxy=function(){function n(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(t,r,a){a=a||0,a>0&&(this._ux=mathAbs$2(a/devicePixelRatio/t)||0,this._uy=mathAbs$2(a/devicePixelRatio/r)||0)},n.prototype.setDPR=function(t){this.dpr=t},n.prototype.setContext=function(t){this._ctx=t},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(CMD$4.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},n.prototype.lineTo=function(t,r){var a=mathAbs$2(t-this._xi),o=mathAbs$2(r-this._yi),u=a>this._ux||o>this._uy;if(this.addData(CMD$4.L,t,r),this._ctx&&u&&this._ctx.lineTo(t,r),u)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var s=a*a+o*o;s>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=s)}return this},n.prototype.bezierCurveTo=function(t,r,a,o,u,s){return this._drawPendingPt(),this.addData(CMD$4.C,t,r,a,o,u,s),this._ctx&&this._ctx.bezierCurveTo(t,r,a,o,u,s),this._xi=u,this._yi=s,this},n.prototype.quadraticCurveTo=function(t,r,a,o){return this._drawPendingPt(),this.addData(CMD$4.Q,t,r,a,o),this._ctx&&this._ctx.quadraticCurveTo(t,r,a,o),this._xi=a,this._yi=o,this},n.prototype.arc=function(t,r,a,o,u,s){this._drawPendingPt(),tmpAngles[0]=o,tmpAngles[1]=u,normalizeArcAngles(tmpAngles,s),o=tmpAngles[0],u=tmpAngles[1];var c=u-o;return this.addData(CMD$4.A,t,r,a,a,o,c,0,s?0:1),this._ctx&&this._ctx.arc(t,r,a,o,u,s),this._xi=mathCos$3(u)*a+t,this._yi=mathSin$3(u)*a+r,this},n.prototype.arcTo=function(t,r,a,o,u){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,a,o,u),this},n.prototype.rect=function(t,r,a,o){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,a,o),this.addData(CMD$4.R,t,r,a,o),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(CMD$4.Z);var t=this._ctx,r=this._x0,a=this._y0;return t&&t.closePath(),this._xi=r,this._yi=a,this},n.prototype.fill=function(t){t&&t.fill(),this.toStatic()},n.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&hasTypedArray&&(this.data=new Float32Array(r));for(var a=0;a<r;a++)this.data[a]=t[a];this._len=r},n.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,a=0,o=this._len,u=0;u<r;u++)a+=t[u].len();hasTypedArray&&this.data instanceof Float32Array&&(this.data=new Float32Array(o+a));for(var u=0;u<r;u++)for(var s=t[u].data,c=0;c<s.length;c++)this.data[o++]=s[c];this._len=o},n.prototype.addData=function(t,r,a,o,u,s,c,l,d){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var h=0;h<arguments.length;h++)f[this._len++]=arguments[h]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,hasTypedArray&&this._len>11&&(this.data=new Float32Array(t)))}},n.prototype.getBoundingRect=function(){min$1[0]=min$1[1]=min2[0]=min2[1]=Number.MAX_VALUE,max$2[0]=max$2[1]=max2[0]=max2[1]=-Number.MAX_VALUE;var t=this.data,r=0,a=0,o=0,u=0,s;for(s=0;s<this._len;){var c=t[s++],l=s===1;switch(l&&(r=t[s],a=t[s+1],o=r,u=a),c){case CMD$4.M:r=o=t[s++],a=u=t[s++],min2[0]=o,min2[1]=u,max2[0]=o,max2[1]=u;break;case CMD$4.L:fromLine(r,a,t[s],t[s+1],min2,max2),r=t[s++],a=t[s++];break;case CMD$4.C:fromCubic(r,a,t[s++],t[s++],t[s++],t[s++],t[s],t[s+1],min2,max2),r=t[s++],a=t[s++];break;case CMD$4.Q:fromQuadratic(r,a,t[s++],t[s++],t[s],t[s+1],min2,max2),r=t[s++],a=t[s++];break;case CMD$4.A:var d=t[s++],f=t[s++],h=t[s++],v=t[s++],g=t[s++],b=t[s++]+g;s+=1;var _=!t[s++];l&&(o=mathCos$3(g)*h+d,u=mathSin$3(g)*v+f),fromArc(d,f,h,v,g,b,_,min2,max2),r=mathCos$3(b)*h+d,a=mathSin$3(b)*v+f;break;case CMD$4.R:o=r=t[s++],u=a=t[s++];var S=t[s++],T=t[s++];fromLine(o,u,o+S,u+T,min2,max2);break;case CMD$4.Z:r=o,a=u;break}min$2(min$1,min$1,min2),max$3(max$2,max$2,max2)}return s===0&&(min$1[0]=min$1[1]=max$2[0]=max$2[1]=0),new BoundingRect(min$1[0],min$1[1],max$2[0]-min$1[0],max$2[1]-min$1[1])},n.prototype._calculateLength=function(){var t=this.data,r=this._len,a=this._ux,o=this._uy,u=0,s=0,c=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var d=this._pathSegLen,f=0,h=0,v=0;v<r;){var g=t[v++],b=v===1;b&&(u=t[v],s=t[v+1],c=u,l=s);var _=-1;switch(g){case CMD$4.M:u=c=t[v++],s=l=t[v++];break;case CMD$4.L:{var S=t[v++],T=t[v++],w=S-u,A=T-s;(mathAbs$2(w)>a||mathAbs$2(A)>o||v===r-1)&&(_=Math.sqrt(w*w+A*A),u=S,s=T);break}case CMD$4.C:{var R=t[v++],E=t[v++],S=t[v++],T=t[v++],I=t[v++],L=t[v++];_=cubicLength(u,s,R,E,S,T,I,L,10),u=I,s=L;break}case CMD$4.Q:{var R=t[v++],E=t[v++],S=t[v++],T=t[v++];_=quadraticLength(u,s,R,E,S,T,10),u=S,s=T;break}case CMD$4.A:var F=t[v++],D=t[v++],$=t[v++],O=t[v++],P=t[v++],C=t[v++],q=C+P;v+=1,b&&(c=mathCos$3(P)*$+F,l=mathSin$3(P)*O+D),_=mathMax$8($,O)*mathMin$8(PI2$7,Math.abs(C)),u=mathCos$3(q)*$+F,s=mathSin$3(q)*O+D;break;case CMD$4.R:{c=u=t[v++],l=s=t[v++];var M=t[v++],N=t[v++];_=M*2+N*2;break}case CMD$4.Z:{var w=c-u,A=l-s;_=Math.sqrt(w*w+A*A),u=c,s=l;break}}_>=0&&(d[h++]=_,f+=_)}return this._pathLen=f,f},n.prototype.rebuildPath=function(t,r){var a=this.data,o=this._ux,u=this._uy,s=this._len,c,l,d,f,h,v,g=r<1,b,_,S=0,T=0,w,A=0,R,E;if(!(g&&(this._pathSegLen||this._calculateLength(),b=this._pathSegLen,_=this._pathLen,w=r*_,!w)))e:for(var I=0;I<s;){var L=a[I++],F=I===1;switch(F&&(d=a[I],f=a[I+1],c=d,l=f),L!==CMD$4.L&&A>0&&(t.lineTo(R,E),A=0),L){case CMD$4.M:c=d=a[I++],l=f=a[I++],t.moveTo(d,f);break;case CMD$4.L:{h=a[I++],v=a[I++];var D=mathAbs$2(h-d),$=mathAbs$2(v-f);if(D>o||$>u){if(g){var O=b[T++];if(S+O>w){var P=(w-S)/O;t.lineTo(d*(1-P)+h*P,f*(1-P)+v*P);break e}S+=O}t.lineTo(h,v),d=h,f=v,A=0}else{var C=D*D+$*$;C>A&&(R=h,E=v,A=C)}break}case CMD$4.C:{var q=a[I++],M=a[I++],N=a[I++],G=a[I++],X=a[I++],Y=a[I++];if(g){var O=b[T++];if(S+O>w){var P=(w-S)/O;cubicSubdivide(d,q,N,X,P,tmpOutX),cubicSubdivide(f,M,G,Y,P,tmpOutY),t.bezierCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2],tmpOutX[3],tmpOutY[3]);break e}S+=O}t.bezierCurveTo(q,M,N,G,X,Y),d=X,f=Y;break}case CMD$4.Q:{var q=a[I++],M=a[I++],N=a[I++],G=a[I++];if(g){var O=b[T++];if(S+O>w){var P=(w-S)/O;quadraticSubdivide(d,q,N,P,tmpOutX),quadraticSubdivide(f,M,G,P,tmpOutY),t.quadraticCurveTo(tmpOutX[1],tmpOutY[1],tmpOutX[2],tmpOutY[2]);break e}S+=O}t.quadraticCurveTo(q,M,N,G),d=N,f=G;break}case CMD$4.A:var W=a[I++],te=a[I++],ue=a[I++],fe=a[I++],re=a[I++],ye=a[I++],Te=a[I++],Re=!a[I++],ve=ue>fe?ue:fe,ce=mathAbs$2(ue-fe)>.001,J=re+ye,j=!1;if(g){var O=b[T++];S+O>w&&(J=re+ye*(w-S)/O,j=!0),S+=O}if(ce&&t.ellipse?t.ellipse(W,te,ue,fe,Te,re,J,Re):t.arc(W,te,ve,re,J,Re),j)break e;F&&(c=mathCos$3(re)*ue+W,l=mathSin$3(re)*fe+te),d=mathCos$3(J)*ue+W,f=mathSin$3(J)*fe+te;break;case CMD$4.R:c=d=a[I],l=f=a[I+1],h=a[I++],v=a[I++];var z=a[I++],B=a[I++];if(g){var O=b[T++];if(S+O>w){var U=w-S;t.moveTo(h,v),t.lineTo(h+mathMin$8(U,z),v),U-=z,U>0&&t.lineTo(h+z,v+mathMin$8(U,B)),U-=B,U>0&&t.lineTo(h+mathMax$8(z-U,0),v+B),U-=z,U>0&&t.lineTo(h,v+mathMax$8(B-U,0));break e}S+=O}t.rect(h,v,z,B);break;case CMD$4.Z:if(g){var O=b[T++];if(S+O>w){var P=(w-S)/O;t.lineTo(d*(1-P)+c*P,f*(1-P)+l*P);break e}S+=O}t.closePath(),d=c,f=l}}},n.prototype.clone=function(){var t=new n,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},n.CMD=CMD$4,n.initDefaultProps=function(){var t=n.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),n}();function containStroke$4(n,t,r,a,o,u,s){if(o===0)return!1;var c=o,l=0,d=n;if(s>t+c&&s>a+c||s<t-c&&s<a-c||u>n+c&&u>r+c||u<n-c&&u<r-c)return!1;if(n!==r)l=(t-a)/(n-r),d=(n*a-r*t)/(n-r);else return Math.abs(u-n)<=c/2;var f=l*u-s+d,h=f*f/(l*l+1);return h<=c/2*c/2}function containStroke$3(n,t,r,a,o,u,s,c,l,d,f){if(l===0)return!1;var h=l;if(f>t+h&&f>a+h&&f>u+h&&f>c+h||f<t-h&&f<a-h&&f<u-h&&f<c-h||d>n+h&&d>r+h&&d>o+h&&d>s+h||d<n-h&&d<r-h&&d<o-h&&d<s-h)return!1;var v=cubicProjectPoint(n,t,r,a,o,u,s,c,d,f,null);return v<=h/2}function containStroke$2(n,t,r,a,o,u,s,c,l){if(s===0)return!1;var d=s;if(l>t+d&&l>a+d&&l>u+d||l<t-d&&l<a-d&&l<u-d||c>n+d&&c>r+d&&c>o+d||c<n-d&&c<r-d&&c<o-d)return!1;var f=quadraticProjectPoint(n,t,r,a,o,u,c,l,null);return f<=d/2}var PI2$6=Math.PI*2;function normalizeRadian(n){return n%=PI2$6,n<0&&(n+=PI2$6),n}var PI2$5=Math.PI*2;function containStroke$1(n,t,r,a,o,u,s,c,l){if(s===0)return!1;var d=s;c-=n,l-=t;var f=Math.sqrt(c*c+l*l);if(f-d>r||f+d<r)return!1;if(Math.abs(a-o)%PI2$5<1e-4)return!0;if(u){var h=a;a=normalizeRadian(o),o=normalizeRadian(h)}else a=normalizeRadian(a),o=normalizeRadian(o);a>o&&(o+=PI2$5);var v=Math.atan2(l,c);return v<0&&(v+=PI2$5),v>=a&&v<=o||v+PI2$5>=a&&v+PI2$5<=o}function windingLine(n,t,r,a,o,u){if(u>t&&u>a||u<t&&u<a||a===t)return 0;var s=(u-t)/(a-t),c=a<t?1:-1;(s===1||s===0)&&(c=a<t?.5:-.5);var l=s*(r-n)+n;return l===o?1/0:l>o?c:0}var CMD$3=PathProxy.CMD,PI2$4=Math.PI*2,EPSILON$1=1e-4;function isAroundEqual$1(n,t){return Math.abs(n-t)<EPSILON$1}var roots=[-1,-1,-1],extrema=[-1,-1];function swapExtrema(){var n=extrema[0];extrema[0]=extrema[1],extrema[1]=n}function windingCubic(n,t,r,a,o,u,s,c,l,d){if(d>t&&d>a&&d>u&&d>c||d<t&&d<a&&d<u&&d<c)return 0;var f=cubicRootAt(t,a,u,c,d,roots);if(f===0)return 0;for(var h=0,v=-1,g=void 0,b=void 0,_=0;_<f;_++){var S=roots[_],T=S===0||S===1?.5:1,w=cubicAt(n,r,o,s,S);w<l||(v<0&&(v=cubicExtrema(t,a,u,c,extrema),extrema[1]<extrema[0]&&v>1&&swapExtrema(),g=cubicAt(t,a,u,c,extrema[0]),v>1&&(b=cubicAt(t,a,u,c,extrema[1]))),v===2?S<extrema[0]?h+=g<t?T:-T:S<extrema[1]?h+=b<g?T:-T:h+=c<b?T:-T:S<extrema[0]?h+=g<t?T:-T:h+=c<g?T:-T)}return h}function windingQuadratic(n,t,r,a,o,u,s,c){if(c>t&&c>a&&c>u||c<t&&c<a&&c<u)return 0;var l=quadraticRootAt(t,a,u,c,roots);if(l===0)return 0;var d=quadraticExtremum(t,a,u);if(d>=0&&d<=1){for(var f=0,h=quadraticAt$1(t,a,u,d),v=0;v<l;v++){var g=roots[v]===0||roots[v]===1?.5:1,b=quadraticAt$1(n,r,o,roots[v]);b<s||(roots[v]<d?f+=h<t?g:-g:f+=u<h?g:-g)}return f}else{var g=roots[0]===0||roots[0]===1?.5:1,b=quadraticAt$1(n,r,o,roots[0]);return b<s?0:u<t?g:-g}}function windingArc(n,t,r,a,o,u,s,c){if(c-=t,c>r||c<-r)return 0;var l=Math.sqrt(r*r-c*c);roots[0]=-l,roots[1]=l;var d=Math.abs(a-o);if(d<1e-4)return 0;if(d>=PI2$4-1e-4){a=0,o=PI2$4;var f=u?1:-1;return s>=roots[0]+n&&s<=roots[1]+n?f:0}if(a>o){var h=a;a=o,o=h}a<0&&(a+=PI2$4,o+=PI2$4);for(var v=0,g=0;g<2;g++){var b=roots[g];if(b+n>s){var _=Math.atan2(c,b),f=u?1:-1;_<0&&(_=PI2$4+_),(_>=a&&_<=o||_+PI2$4>=a&&_+PI2$4<=o)&&(_>Math.PI/2&&_<Math.PI*1.5&&(f=-f),v+=f)}}return v}function containPath(n,t,r,a,o){for(var u=n.data,s=n.len(),c=0,l=0,d=0,f=0,h=0,v,g,b=0;b<s;){var _=u[b++],S=b===1;switch(_===CMD$3.M&&b>1&&(r||(c+=windingLine(l,d,f,h,a,o))),S&&(l=u[b],d=u[b+1],f=l,h=d),_){case CMD$3.M:f=u[b++],h=u[b++],l=f,d=h;break;case CMD$3.L:if(r){if(containStroke$4(l,d,u[b],u[b+1],t,a,o))return!0}else c+=windingLine(l,d,u[b],u[b+1],a,o)||0;l=u[b++],d=u[b++];break;case CMD$3.C:if(r){if(containStroke$3(l,d,u[b++],u[b++],u[b++],u[b++],u[b],u[b+1],t,a,o))return!0}else c+=windingCubic(l,d,u[b++],u[b++],u[b++],u[b++],u[b],u[b+1],a,o)||0;l=u[b++],d=u[b++];break;case CMD$3.Q:if(r){if(containStroke$2(l,d,u[b++],u[b++],u[b],u[b+1],t,a,o))return!0}else c+=windingQuadratic(l,d,u[b++],u[b++],u[b],u[b+1],a,o)||0;l=u[b++],d=u[b++];break;case CMD$3.A:var T=u[b++],w=u[b++],A=u[b++],R=u[b++],E=u[b++],I=u[b++];b+=1;var L=!!(1-u[b++]);v=Math.cos(E)*A+T,g=Math.sin(E)*R+w,S?(f=v,h=g):c+=windingLine(l,d,v,g,a,o);var F=(a-T)*R/A+T;if(r){if(containStroke$1(T,w,R,E,E+I,L,t,F,o))return!0}else c+=windingArc(T,w,R,E,E+I,L,F,o);l=Math.cos(E+I)*A+T,d=Math.sin(E+I)*R+w;break;case CMD$3.R:f=l=u[b++],h=d=u[b++];var D=u[b++],$=u[b++];if(v=f+D,g=h+$,r){if(containStroke$4(f,h,v,h,t,a,o)||containStroke$4(v,h,v,g,t,a,o)||containStroke$4(v,g,f,g,t,a,o)||containStroke$4(f,g,f,h,t,a,o))return!0}else c+=windingLine(v,h,v,g,a,o),c+=windingLine(f,g,f,h,a,o);break;case CMD$3.Z:if(r){if(containStroke$4(l,d,f,h,t,a,o))return!0}else c+=windingLine(l,d,f,h,a,o);l=f,d=h;break}}return!r&&!isAroundEqual$1(d,h)&&(c+=windingLine(l,d,f,h,a,o)||0),c!==0}function contain$2(n,t,r){return containPath(n,0,!1,t,r)}function containStroke(n,t,r,a){return containPath(n,t,!0,r,a)}var DEFAULT_PATH_STYLE=defaults$h({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},DEFAULT_COMMON_STYLE),DEFAULT_PATH_ANIMATION_PROPS={style:defaults$h({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},pathCopyParams=TRANSFORMABLE_PROPS.concat(["invisible","culling","z","z2","zlevel","parent"]),Path=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.update=function(){var r=this;n.prototype.update.call(this);var a=this.style;if(a.decal){var o=this._decalEl=this._decalEl||new t;o.buildPath===t.prototype.buildPath&&(o.buildPath=function(l){r.buildPath(l,r.shape)}),o.silent=!0;var u=o.style;for(var s in a)u[s]!==a[s]&&(u[s]=a[s]);u.fill=a.fill?a.decal:null,u.decal=null,u.shadowColor=null,a.strokeFirst&&(u.stroke=null);for(var c=0;c<pathCopyParams.length;++c)o[pathCopyParams[c]]=this[pathCopyParams[c]];o.__dirty|=REDRAW_BIT}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var a=keys(r);this.shape=this.getDefaultShape();var o=this.getDefaultStyle();o&&this.useStyle(o);for(var u=0;u<a.length;u++){var s=a[u],c=r[s];s==="style"?this.style?extend$1(this.style,c):this.useStyle(c):s==="shape"?extend$1(this.shape,c):n.prototype.attrKV.call(this,s,c)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(isString(r)){var a=lum(r,0);return a>.5?DARK_LABEL_COLOR:a>.2?LIGHTER_LABEL_COLOR:LIGHT_LABEL_COLOR}else if(r)return LIGHT_LABEL_COLOR}return DARK_LABEL_COLOR},t.prototype.getInsideTextStroke=function(r){var a=this.style.fill;if(isString(a)){var o=this.__zr,u=!!(o&&o.isDarkMode()),s=lum(r,0)<DARK_MODE_THRESHOLD;if(u===s)return a}},t.prototype.buildPath=function(r,a,o){},t.prototype.pathUpdated=function(){this.__dirty&=-5},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new PathProxy(!1)},t.prototype.hasStroke=function(){var r=this.style,a=r.stroke;return!(a==null||a==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,a=r.fill;return a!=null&&a!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,a=this.style,o=!r;if(o){var u=!1;this.path||(u=!0,this.createPathProxy());var s=this.path;(u||this.__dirty&SHAPE_CHANGED_BIT)&&(s.beginPath(),this.buildPath(s,this.shape,!1),this.pathUpdated()),r=s.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var c=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||o){c.copy(r);var l=a.strokeNoScale?this.getLineScale():1,d=a.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;d=Math.max(d,f??4)}l>1e-10&&(c.width+=d/l,c.height+=d/l,c.x-=d/l/2,c.y-=d/l/2)}return c}return r},t.prototype.contain=function(r,a){var o=this.transformCoordToLocal(r,a),u=this.getBoundingRect(),s=this.style;if(r=o[0],a=o[1],u.contain(r,a)){var c=this.path;if(this.hasStroke()){var l=s.lineWidth,d=s.strokeNoScale?this.getLineScale():1;if(d>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),containStroke(c,l/d,r,a)))return!0}if(this.hasFill())return contain$2(c,r,a)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=SHAPE_CHANGED_BIT,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,a){r==="shape"?this.setShape(a):n.prototype.attrKV.call(this,r,a)},t.prototype.setShape=function(r,a){var o=this.shape;return o||(o=this.shape={}),typeof r=="string"?o[r]=a:extend$1(o,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&SHAPE_CHANGED_BIT)},t.prototype.createStyle=function(r){return createObject(DEFAULT_PATH_STYLE,r)},t.prototype._innerSaveToNormal=function(r){n.prototype._innerSaveToNormal.call(this,r);var a=this._normalState;r.shape&&!a.shape&&(a.shape=extend$1({},this.shape))},t.prototype._applyStateObj=function(r,a,o,u,s,c){n.prototype._applyStateObj.call(this,r,a,o,u,s,c);var l=!(a&&u),d;if(a&&a.shape?s?u?d=a.shape:(d=extend$1({},o.shape),extend$1(d,a.shape)):(d=extend$1({},u?this.shape:o.shape),extend$1(d,a.shape)):l&&(d=o.shape),d)if(s){this.shape=extend$1({},this.shape);for(var f={},h=keys(d),v=0;v<h.length;v++){var g=h[v];typeof d[g]=="object"?this.shape[g]=d[g]:f[g]=d[g]}this._transitionState(r,{shape:f},c)}else this.shape=d,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var a=n.prototype._mergeStates.call(this,r),o,u=0;u<r.length;u++){var s=r[u];s.shape&&(o=o||{},this._mergeStyle(o,s.shape))}return o&&(a.shape=o),a},t.prototype.getAnimationStyleProps=function(){return DEFAULT_PATH_ANIMATION_PROPS},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var a=function(u){__extends(s,u);function s(c){var l=u.call(this,c)||this;return r.init&&r.init.call(l,c),l}return s.prototype.getDefaultStyle=function(){return clone$5(r.style)},s.prototype.getDefaultShape=function(){return clone$5(r.shape)},s}(t);for(var o in r)typeof r[o]=="function"&&(a.prototype[o]=r[o]);return a},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=REDRAW_BIT|STYLE_CHANGED_BIT|SHAPE_CHANGED_BIT}(),t}(Displayable),DEFAULT_TSPAN_STYLE=defaults$h({strokeFirst:!0,font:DEFAULT_FONT,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},DEFAULT_PATH_STYLE),TSpan=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,a=r.stroke;return a!=null&&a!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,a=r.fill;return a!=null&&a!=="none"},t.prototype.createStyle=function(r){return createObject(DEFAULT_TSPAN_STYLE,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var a=r.text;a!=null?a+="":a="";var o=getBoundingRect(a,r.font,r.textAlign,r.textBaseline);if(o.x+=r.x||0,o.y+=r.y||0,this.hasStroke()){var u=r.lineWidth;o.x-=u/2,o.y-=u/2,o.width+=u,o.height+=u}this._rect=o}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(Displayable);TSpan.prototype.type="tspan";var DEFAULT_IMAGE_STYLE=defaults$h({x:0,y:0},DEFAULT_COMMON_STYLE),DEFAULT_IMAGE_ANIMATION_PROPS={style:defaults$h({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)};function isImageLike$1(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var ZRImage=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return createObject(DEFAULT_IMAGE_STYLE,r)},t.prototype._getSize=function(r){var a=this.style,o=a[r];if(o!=null)return o;var u=isImageLike$1(a.image)?a.image:this.__image;if(!u)return 0;var s=r==="width"?"height":"width",c=a[s];return c==null?u[r]:u[r]/u[s]*c},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return DEFAULT_IMAGE_ANIMATION_PROPS},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new BoundingRect(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(Displayable);ZRImage.prototype.type="image";function buildPath$2(n,t){var r=t.x,a=t.y,o=t.width,u=t.height,s=t.r,c,l,d,f;o<0&&(r=r+o,o=-o),u<0&&(a=a+u,u=-u),typeof s=="number"?c=l=d=f=s:s instanceof Array?s.length===1?c=l=d=f=s[0]:s.length===2?(c=d=s[0],l=f=s[1]):s.length===3?(c=s[0],l=f=s[1],d=s[2]):(c=s[0],l=s[1],d=s[2],f=s[3]):c=l=d=f=0;var h;c+l>o&&(h=c+l,c*=o/h,l*=o/h),d+f>o&&(h=d+f,d*=o/h,f*=o/h),l+d>u&&(h=l+d,l*=u/h,d*=u/h),c+f>u&&(h=c+f,c*=u/h,f*=u/h),n.moveTo(r+c,a),n.lineTo(r+o-l,a),l!==0&&n.arc(r+o-l,a+l,l,-Math.PI/2,0),n.lineTo(r+o,a+u-d),d!==0&&n.arc(r+o-d,a+u-d,d,0,Math.PI/2),n.lineTo(r+f,a+u),f!==0&&n.arc(r+f,a+u-f,f,Math.PI/2,Math.PI),n.lineTo(r,a+c),c!==0&&n.arc(r+c,a+c,c,Math.PI,Math.PI*1.5)}var round$2=Math.round;function subPixelOptimizeLine$1(n,t,r){if(t){var a=t.x1,o=t.x2,u=t.y1,s=t.y2;n.x1=a,n.x2=o,n.y1=u,n.y2=s;var c=r&&r.lineWidth;return c&&(round$2(a*2)===round$2(o*2)&&(n.x1=n.x2=subPixelOptimize$1(a,c,!0)),round$2(u*2)===round$2(s*2)&&(n.y1=n.y2=subPixelOptimize$1(u,c,!0))),n}}function subPixelOptimizeRect$1(n,t,r){if(t){var a=t.x,o=t.y,u=t.width,s=t.height;n.x=a,n.y=o,n.width=u,n.height=s;var c=r&&r.lineWidth;return c&&(n.x=subPixelOptimize$1(a,c,!0),n.y=subPixelOptimize$1(o,c,!0),n.width=Math.max(subPixelOptimize$1(a+u,c,!1)-n.x,u===0?0:1),n.height=Math.max(subPixelOptimize$1(o+s,c,!1)-n.y,s===0?0:1)),n}}function subPixelOptimize$1(n,t,r){if(!t)return n;var a=round$2(n*2);return(a+round$2(t))%2===0?a/2:(a+(r?1:-1))/2}var RectShape=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),subPixelOptimizeOutputShape$1={},Rect$2=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new RectShape},t.prototype.buildPath=function(r,a){var o,u,s,c;if(this.subPixelOptimize){var l=subPixelOptimizeRect$1(subPixelOptimizeOutputShape$1,a,this.style);o=l.x,u=l.y,s=l.width,c=l.height,l.r=a.r,a=l}else o=a.x,u=a.y,s=a.width,c=a.height;a.r?buildPath$2(r,a):r.rect(o,u,s,c)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(Path);Rect$2.prototype.type="rect";var DEFAULT_RICH_TEXT_COLOR={fill:"#000"},DEFAULT_STROKE_LINE_WIDTH=2,DEFAULT_TEXT_ANIMATION_PROPS={style:defaults$h({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},DEFAULT_COMMON_ANIMATION_PROPS.style)},ZRText=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;return a.type="text",a._children=[],a._defaultStyle=DEFAULT_RICH_TEXT_COLOR,a.attr(r),a}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var a=this._children[r];a.zlevel=this.zlevel,a.z=this.z,a.z2=this.z2,a.culling=this.culling,a.cursor=this.cursor,a.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):n.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var a=this.innerTransformable;return a?a.getLocalTransform(r):n.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,normalizeTextStyle(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){n.prototype.addSelfToZr.call(this,r);for(var a=0;a<this._children.length;a++)this._children[a].__zr=r},t.prototype.removeSelfFromZr=function(r){n.prototype.removeSelfFromZr.call(this,r);for(var a=0;a<this._children.length;a++)this._children[a].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new BoundingRect(0,0,0,0),a=this._children,o=[],u=null,s=0;s<a.length;s++){var c=a[s],l=c.getBoundingRect(),d=c.getLocalTransform(o);d?(r.copy(l),r.applyTransform(d),u=u||r.clone(),u.union(r)):(u=u||l.clone(),u.union(l))}this._rect=u||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||DEFAULT_RICH_TEXT_COLOR},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,a){if(!a)return r;var o=a.rich,u=r.rich||o&&{};return extend$1(r,a),o&&u?(this._mergeRich(u,o),r.rich=u):u&&(r.rich=u),r},t.prototype._mergeRich=function(r,a){for(var o=keys(a),u=0;u<o.length;u++){var s=o[u];r[s]=r[s]||{},extend$1(r[s],a[s])}},t.prototype.getAnimationStyleProps=function(){return DEFAULT_TEXT_ANIMATION_PROPS},t.prototype._getOrCreateChild=function(r){var a=this._children[this._childCursor];return(!a||!(a instanceof r))&&(a=new r),this._children[this._childCursor++]=a,a.__zr=this.__zr,a.parent=this,a},t.prototype._updatePlainTexts=function(){var r=this.style,a=r.font||DEFAULT_FONT,o=r.padding,u=getStyleText(r),s=parsePlainText(u,r),c=needDrawBackground(r),l=!!r.backgroundColor,d=s.outerHeight,f=s.outerWidth,h=s.contentWidth,v=s.lines,g=s.lineHeight,b=this._defaultStyle;this.isTruncated=!!s.isTruncated;var _=r.x||0,S=r.y||0,T=r.align||b.align||"left",w=r.verticalAlign||b.verticalAlign||"top",A=_,R=adjustTextY(S,s.contentHeight,w);if(c||o){var E=adjustTextX(_,f,T),I=adjustTextY(S,d,w);c&&this._renderBackground(r,r,E,I,f,d)}R+=g/2,o&&(A=getTextXForPadding(_,T,o),w==="top"?R+=o[0]:w==="bottom"&&(R-=o[2]));for(var L=0,F=!1,D=getFill("fill"in r?r.fill:(F=!0,b.fill)),$=getStroke("stroke"in r?r.stroke:!l&&(!b.autoStroke||F)?(L=DEFAULT_STROKE_LINE_WIDTH,b.stroke):null),O=r.textShadowBlur>0,P=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),C=s.calculatedLineHeight,q=0;q<v.length;q++){var M=this._getOrCreateChild(TSpan),N=M.createStyle();M.useStyle(N),N.text=v[q],N.x=A,N.y=R,N.textAlign=T,N.textBaseline="middle",N.opacity=r.opacity,N.strokeFirst=!0,O&&(N.shadowBlur=r.textShadowBlur||0,N.shadowColor=r.textShadowColor||"transparent",N.shadowOffsetX=r.textShadowOffsetX||0,N.shadowOffsetY=r.textShadowOffsetY||0),N.stroke=$,N.fill=D,$&&(N.lineWidth=r.lineWidth||L,N.lineDash=r.lineDash,N.lineDashOffset=r.lineDashOffset||0),N.font=a,setSeparateFont(N,r),R+=g,P&&M.setBoundingRect(new BoundingRect(adjustTextX(N.x,h,N.textAlign),adjustTextY(N.y,C,N.textBaseline),h,C))}},t.prototype._updateRichTexts=function(){var r=this.style,a=getStyleText(r),o=parseRichText(a,r),u=o.width,s=o.outerWidth,c=o.outerHeight,l=r.padding,d=r.x||0,f=r.y||0,h=this._defaultStyle,v=r.align||h.align,g=r.verticalAlign||h.verticalAlign;this.isTruncated=!!o.isTruncated;var b=adjustTextX(d,s,v),_=adjustTextY(f,c,g),S=b,T=_;l&&(S+=l[3],T+=l[0]);var w=S+u;needDrawBackground(r)&&this._renderBackground(r,r,b,_,s,c);for(var A=!!r.backgroundColor,R=0;R<o.lines.length;R++){for(var E=o.lines[R],I=E.tokens,L=I.length,F=E.lineHeight,D=E.width,$=0,O=S,P=w,C=L-1,q=void 0;$<L&&(q=I[$],!q.align||q.align==="left");)this._placeToken(q,r,F,T,O,"left",A),D-=q.width,O+=q.width,$++;for(;C>=0&&(q=I[C],q.align==="right");)this._placeToken(q,r,F,T,P,"right",A),D-=q.width,P-=q.width,C--;for(O+=(u-(O-S)-(w-P)-D)/2;$<=C;)q=I[$],this._placeToken(q,r,F,T,O+q.width/2,"center",A),O+=q.width,$++;T+=F}},t.prototype._placeToken=function(r,a,o,u,s,c,l){var d=a.rich[r.styleName]||{};d.text=r.text;var f=r.verticalAlign,h=u+o/2;f==="top"?h=u+r.height/2:f==="bottom"&&(h=u+o-r.height/2);var v=!r.isLineHolder&&needDrawBackground(d);v&&this._renderBackground(d,a,c==="right"?s-r.width:c==="center"?s-r.width/2:s,h-r.height/2,r.width,r.height);var g=!!d.backgroundColor,b=r.textPadding;b&&(s=getTextXForPadding(s,c,b),h-=r.height/2-b[0]-r.innerHeight/2);var _=this._getOrCreateChild(TSpan),S=_.createStyle();_.useStyle(S);var T=this._defaultStyle,w=!1,A=0,R=getFill("fill"in d?d.fill:"fill"in a?a.fill:(w=!0,T.fill)),E=getStroke("stroke"in d?d.stroke:"stroke"in a?a.stroke:!g&&!l&&(!T.autoStroke||w)?(A=DEFAULT_STROKE_LINE_WIDTH,T.stroke):null),I=d.textShadowBlur>0||a.textShadowBlur>0;S.text=r.text,S.x=s,S.y=h,I&&(S.shadowBlur=d.textShadowBlur||a.textShadowBlur||0,S.shadowColor=d.textShadowColor||a.textShadowColor||"transparent",S.shadowOffsetX=d.textShadowOffsetX||a.textShadowOffsetX||0,S.shadowOffsetY=d.textShadowOffsetY||a.textShadowOffsetY||0),S.textAlign=c,S.textBaseline="middle",S.font=r.font||DEFAULT_FONT,S.opacity=retrieve3(d.opacity,a.opacity,1),setSeparateFont(S,d),E&&(S.lineWidth=retrieve3(d.lineWidth,a.lineWidth,A),S.lineDash=retrieve2(d.lineDash,a.lineDash),S.lineDashOffset=a.lineDashOffset||0,S.stroke=E),R&&(S.fill=R);var L=r.contentWidth,F=r.contentHeight;_.setBoundingRect(new BoundingRect(adjustTextX(S.x,L,S.textAlign),adjustTextY(S.y,F,S.textBaseline),L,F))},t.prototype._renderBackground=function(r,a,o,u,s,c){var l=r.backgroundColor,d=r.borderWidth,f=r.borderColor,h=l&&l.image,v=l&&!h,g=r.borderRadius,b=this,_,S;if(v||r.lineHeight||d&&f){_=this._getOrCreateChild(Rect$2),_.useStyle(_.createStyle()),_.style.fill=null;var T=_.shape;T.x=o,T.y=u,T.width=s,T.height=c,T.r=g,_.dirtyShape()}if(v){var w=_.style;w.fill=l||null,w.fillOpacity=retrieve2(r.fillOpacity,1)}else if(h){S=this._getOrCreateChild(ZRImage),S.onload=function(){b.dirtyStyle()};var A=S.style;A.image=l.image,A.x=o,A.y=u,A.width=s,A.height=c}if(d&&f){var w=_.style;w.lineWidth=d,w.stroke=f,w.strokeOpacity=retrieve2(r.strokeOpacity,1),w.lineDash=r.borderDash,w.lineDashOffset=r.borderDashOffset||0,_.strokeContainThreshold=0,_.hasFill()&&_.hasStroke()&&(w.strokeFirst=!0,w.lineWidth*=2)}var R=(_||S).style;R.shadowBlur=r.shadowBlur||0,R.shadowColor=r.shadowColor||"transparent",R.shadowOffsetX=r.shadowOffsetX||0,R.shadowOffsetY=r.shadowOffsetY||0,R.opacity=retrieve3(r.opacity,a.opacity,1)},t.makeFont=function(r){var a="";return hasSeparateFont(r)&&(a=[r.fontStyle,r.fontWeight,parseFontSize(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),a&&trim$1(a)||r.textFont||r.font},t}(Displayable),VALID_TEXT_ALIGN={left:!0,right:1,center:1},VALID_TEXT_VERTICAL_ALIGN={top:1,bottom:1,middle:1},FONT_PARTS=["fontStyle","fontWeight","fontSize","fontFamily"];function parseFontSize(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?DEFAULT_FONT_SIZE+"px":n+"px"}function setSeparateFont(n,t){for(var r=0;r<FONT_PARTS.length;r++){var a=FONT_PARTS[r],o=t[a];o!=null&&(n[a]=o)}}function hasSeparateFont(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function normalizeTextStyle(n){return normalizeStyle(n),each$f(n.rich,normalizeStyle),n}function normalizeStyle(n){if(n){n.font=ZRText.makeFont(n);var t=n.align;t==="middle"&&(t="center"),n.align=t==null||VALID_TEXT_ALIGN[t]?t:"left";var r=n.verticalAlign;r==="center"&&(r="middle"),n.verticalAlign=r==null||VALID_TEXT_VERTICAL_ALIGN[r]?r:"top";var a=n.padding;a&&(n.padding=normalizeCssArray$1(n.padding))}}function getStroke(n,t){return n==null||t<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function getFill(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function getTextXForPadding(n,t,r){return t==="right"?n-r[1]:t==="center"?n+r[3]/2-r[1]/2:n+r[3]}function getStyleText(n){var t=n.text;return t!=null&&(t+=""),t}function needDrawBackground(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}var getECData=makeInner(),setCommonECData=function(n,t,r,a){if(a){var o=getECData(a);o.dataIndex=r,o.dataType=t,o.seriesIndex=n,o.ssrType="chart",a.type==="group"&&a.traverse(function(u){var s=getECData(u);s.seriesIndex=n,s.dataIndex=r,s.dataType=t,s.ssrType="chart"})}},_highlightNextDigit=1,_highlightKeyMap={},getSavedStates=makeInner(),getComponentStates=makeInner(),HOVER_STATE_NORMAL=0,HOVER_STATE_BLUR=1,HOVER_STATE_EMPHASIS=2,SPECIAL_STATES=["emphasis","blur","select"],DISPLAY_STATES=["normal","emphasis","blur","select"],Z2_EMPHASIS_LIFT=10,Z2_SELECT_LIFT=9,HIGHLIGHT_ACTION_TYPE="highlight",DOWNPLAY_ACTION_TYPE="downplay",SELECT_ACTION_TYPE="select",UNSELECT_ACTION_TYPE="unselect",TOGGLE_SELECT_ACTION_TYPE="toggleSelect";function hasFillOrStroke(n){return n!=null&&n!=="none"}function doChangeHoverState(n,t,r){n.onHoverStateChange&&(n.hoverState||0)!==r&&n.onHoverStateChange(t),n.hoverState=r}function singleEnterEmphasis(n){doChangeHoverState(n,"emphasis",HOVER_STATE_EMPHASIS)}function singleLeaveEmphasis(n){n.hoverState===HOVER_STATE_EMPHASIS&&doChangeHoverState(n,"normal",HOVER_STATE_NORMAL)}function singleEnterBlur(n){doChangeHoverState(n,"blur",HOVER_STATE_BLUR)}function singleLeaveBlur(n){n.hoverState===HOVER_STATE_BLUR&&doChangeHoverState(n,"normal",HOVER_STATE_NORMAL)}function singleEnterSelect(n){n.selected=!0}function singleLeaveSelect(n){n.selected=!1}function updateElementState(n,t,r){t(n,r)}function traverseUpdateState(n,t,r){updateElementState(n,t,r),n.isGroup&&n.traverse(function(a){updateElementState(a,t,r)})}function setStatesFlag(n,t){switch(t){case"emphasis":n.hoverState=HOVER_STATE_EMPHASIS;break;case"normal":n.hoverState=HOVER_STATE_NORMAL;break;case"blur":n.hoverState=HOVER_STATE_BLUR;break;case"select":n.selected=!0}}function getFromStateStyle(n,t,r,a){for(var o=n.style,u={},s=0;s<t.length;s++){var c=t[s],l=o[c];u[c]=l??(a&&a[c])}for(var s=0;s<n.animators.length;s++){var d=n.animators[s];d.__fromStateTransition&&d.__fromStateTransition.indexOf(r)<0&&d.targetName==="style"&&d.saveTo(u,t)}return u}function createEmphasisDefaultState(n,t,r,a){var o=r&&indexOf(r,"select")>=0,u=!1;if(n instanceof Path){var s=getSavedStates(n),c=o&&s.selectFill||s.normalFill,l=o&&s.selectStroke||s.normalStroke;if(hasFillOrStroke(c)||hasFillOrStroke(l)){a=a||{};var d=a.style||{};d.fill==="inherit"?(u=!0,a=extend$1({},a),d=extend$1({},d),d.fill=c):!hasFillOrStroke(d.fill)&&hasFillOrStroke(c)?(u=!0,a=extend$1({},a),d=extend$1({},d),d.fill=liftColor(c)):!hasFillOrStroke(d.stroke)&&hasFillOrStroke(l)&&(u||(a=extend$1({},a),d=extend$1({},d)),d.stroke=liftColor(l)),a.style=d}}if(a&&a.z2==null){u||(a=extend$1({},a));var f=n.z2EmphasisLift;a.z2=n.z2+(f??Z2_EMPHASIS_LIFT)}return a}function createSelectDefaultState(n,t,r){if(r&&r.z2==null){r=extend$1({},r);var a=n.z2SelectLift;r.z2=n.z2+(a??Z2_SELECT_LIFT)}return r}function createBlurDefaultState(n,t,r){var a=indexOf(n.currentStates,t)>=0,o=n.style.opacity,u=a?null:getFromStateStyle(n,["opacity"],t,{opacity:1});r=r||{};var s=r.style||{};return s.opacity==null&&(r=extend$1({},r),s=extend$1({opacity:a?o:u.opacity*.1},s),r.style=s),r}function elementStateProxy(n,t){var r=this.states[n];if(this.style){if(n==="emphasis")return createEmphasisDefaultState(this,n,t,r);if(n==="blur")return createBlurDefaultState(this,n,r);if(n==="select")return createSelectDefaultState(this,n,r)}return r}function setDefaultStateProxy(n){n.stateProxy=elementStateProxy;var t=n.getTextContent(),r=n.getTextGuideLine();t&&(t.stateProxy=elementStateProxy),r&&(r.stateProxy=elementStateProxy)}function enterEmphasisWhenMouseOver(n,t){!shouldSilent(n,t)&&!n.__highByOuter&&traverseUpdateState(n,singleEnterEmphasis)}function leaveEmphasisWhenMouseOut(n,t){!shouldSilent(n,t)&&!n.__highByOuter&&traverseUpdateState(n,singleLeaveEmphasis)}function enterEmphasis(n,t){n.__highByOuter|=1<<(t||0),traverseUpdateState(n,singleEnterEmphasis)}function leaveEmphasis(n,t){!(n.__highByOuter&=~(1<<(t||0)))&&traverseUpdateState(n,singleLeaveEmphasis)}function enterBlur(n){traverseUpdateState(n,singleEnterBlur)}function leaveBlur(n){traverseUpdateState(n,singleLeaveBlur)}function enterSelect(n){traverseUpdateState(n,singleEnterSelect)}function leaveSelect(n){traverseUpdateState(n,singleLeaveSelect)}function shouldSilent(n,t){return n.__highDownSilentOnTouch&&t.zrByTouch}function allLeaveBlur(n){var t=n.getModel(),r=[],a=[];t.eachComponent(function(o,u){var s=getComponentStates(u),c=o==="series",l=c?n.getViewOfSeriesModel(u):n.getViewOfComponentModel(u);!c&&a.push(l),s.isBlured&&(l.group.traverse(function(d){singleLeaveBlur(d)}),c&&r.push(u)),s.isBlured=!1}),each$f(a,function(o){o&&o.toggleBlurSeries&&o.toggleBlurSeries(r,!1,t)})}function blurSeries(n,t,r,a){var o=a.getModel();r=r||"coordinateSystem";function u(d,f){for(var h=0;h<f.length;h++){var v=d.getItemGraphicEl(f[h]);v&&leaveBlur(v)}}if(n!=null&&!(!t||t==="none")){var s=o.getSeriesByIndex(n),c=s.coordinateSystem;c&&c.master&&(c=c.master);var l=[];o.eachSeries(function(d){var f=s===d,h=d.coordinateSystem;h&&h.master&&(h=h.master);var v=h&&c?h===c:f;if(!(r==="series"&&!f||r==="coordinateSystem"&&!v||t==="series"&&f)){var g=a.getViewOfSeriesModel(d);if(g.group.traverse(function(S){S.__highByOuter&&f&&t==="self"||singleEnterBlur(S)}),isArrayLike$1(t))u(d.getData(),t);else if(isObject$4(t))for(var b=keys(t),_=0;_<b.length;_++)u(d.getData(b[_]),t[b[_]]);l.push(d),getComponentStates(d).isBlured=!0}}),o.eachComponent(function(d,f){if(d!=="series"){var h=a.getViewOfComponentModel(f);h&&h.toggleBlurSeries&&h.toggleBlurSeries(l,!0,o)}})}}function blurComponent(n,t,r){if(!(n==null||t==null)){var a=r.getModel().getComponent(n,t);if(a){getComponentStates(a).isBlured=!0;var o=r.getViewOfComponentModel(a);!o||!o.focusBlurEnabled||o.group.traverse(function(u){singleEnterBlur(u)})}}}function blurSeriesFromHighlightPayload(n,t,r){var a=n.seriesIndex,o=n.getData(t.dataType);if(o){var u=queryDataIndex(o,t);u=(isArray$2(u)?u[0]:u)||0;var s=o.getItemGraphicEl(u);if(!s)for(var c=o.count(),l=0;!s&&l<c;)s=o.getItemGraphicEl(l++);if(s){var d=getECData(s);blurSeries(a,d.focus,d.blurScope,r)}else{var f=n.get(["emphasis","focus"]),h=n.get(["emphasis","blurScope"]);f!=null&&blurSeries(a,f,h,r)}}}function findComponentHighDownDispatchers(n,t,r,a){var o={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||t==null||r==null)return o;var u=a.getModel().getComponent(n,t);if(!u)return o;var s=a.getViewOfComponentModel(u);if(!s||!s.findHighDownDispatchers)return o;for(var c=s.findHighDownDispatchers(r),l,d=0;d<c.length;d++)if(getECData(c[d]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:c}}function handleGlobalMouseOverForHighDown(n,t,r){var a=getECData(n),o=findComponentHighDownDispatchers(a.componentMainType,a.componentIndex,a.componentHighDownName,r),u=o.dispatchers,s=o.focusSelf;u?(s&&blurComponent(a.componentMainType,a.componentIndex,r),each$f(u,function(c){return enterEmphasisWhenMouseOver(c,t)})):(blurSeries(a.seriesIndex,a.focus,a.blurScope,r),a.focus==="self"&&blurComponent(a.componentMainType,a.componentIndex,r),enterEmphasisWhenMouseOver(n,t))}function handleGlobalMouseOutForHighDown(n,t,r){allLeaveBlur(r);var a=getECData(n),o=findComponentHighDownDispatchers(a.componentMainType,a.componentIndex,a.componentHighDownName,r).dispatchers;o?each$f(o,function(u){return leaveEmphasisWhenMouseOut(u,t)}):leaveEmphasisWhenMouseOut(n,t)}function toggleSelectionFromPayload(n,t,r){if(isSelectChangePayload(t)){var a=t.dataType,o=n.getData(a),u=queryDataIndex(o,t);isArray$2(u)||(u=[u]),n[t.type===TOGGLE_SELECT_ACTION_TYPE?"toggleSelect":t.type===SELECT_ACTION_TYPE?"select":"unselect"](u,a)}}function updateSeriesElementSelection(n){var t=n.getAllData();each$f(t,function(r){var a=r.data,o=r.type;a.eachItemGraphicEl(function(u,s){n.isSelected(s,o)?enterSelect(u):leaveSelect(u)})})}function getAllSelectedIndices(n){var t=[];return n.eachSeries(function(r){var a=r.getAllData();each$f(a,function(o){o.data;var u=o.type,s=r.getSelectedDataIndices();if(s.length>0){var c={dataIndex:s,seriesIndex:r.seriesIndex};u!=null&&(c.dataType=u),t.push(c)}})}),t}function enableHoverEmphasis(n,t,r){setAsHighDownDispatcher(n,!0),traverseUpdateState(n,setDefaultStateProxy),enableHoverFocus(n,t,r)}function disableHoverEmphasis(n){setAsHighDownDispatcher(n,!1)}function toggleHoverEmphasis(n,t,r,a){a?disableHoverEmphasis(n):enableHoverEmphasis(n,t,r)}function enableHoverFocus(n,t,r){var a=getECData(n);t!=null?(a.focus=t,a.blurScope=r):a.focus&&(a.focus=null)}var OTHER_STATES=["emphasis","blur","select"],defaultStyleGetterMap={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function setStatesStylesFromModel(n,t,r,a){r=r||"itemStyle";for(var o=0;o<OTHER_STATES.length;o++){var u=OTHER_STATES[o],s=t.getModel([u,r]),c=n.ensureState(u);c.style=a?a(s):s[defaultStyleGetterMap[r]]()}}function setAsHighDownDispatcher(n,t){var r=t===!1,a=n;n.highDownSilentOnTouch&&(a.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!r||a.__highDownDispatcher)&&(a.__highByOuter=a.__highByOuter||0,a.__highDownDispatcher=!r)}function isHighDownDispatcher(n){return!!(n&&n.__highDownDispatcher)}function enableComponentHighDownFeatures(n,t,r){var a=getECData(n);a.componentMainType=t.mainType,a.componentIndex=t.componentIndex,a.componentHighDownName=r}function getHighlightDigit(n){var t=_highlightKeyMap[n];return t==null&&_highlightNextDigit<=32&&(t=_highlightKeyMap[n]=_highlightNextDigit++),t}function isSelectChangePayload(n){var t=n.type;return t===SELECT_ACTION_TYPE||t===UNSELECT_ACTION_TYPE||t===TOGGLE_SELECT_ACTION_TYPE}function isHighDownPayload(n){var t=n.type;return t===HIGHLIGHT_ACTION_TYPE||t===DOWNPLAY_ACTION_TYPE}function savePathStates(n){var t=getSavedStates(n);t.normalFill=n.style.fill,t.normalStroke=n.style.stroke;var r=n.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var CMD$2=PathProxy.CMD,points$2=[[],[],[]],mathSqrt$2=Math.sqrt,mathAtan2=Math.atan2;function transformPath(n,t){if(t){var r=n.data,a=n.len(),o,u,s,c,l,d,f=CMD$2.M,h=CMD$2.C,v=CMD$2.L,g=CMD$2.R,b=CMD$2.A,_=CMD$2.Q;for(s=0,c=0;s<a;){switch(o=r[s++],c=s,u=0,o){case f:u=1;break;case v:u=1;break;case h:u=3;break;case _:u=2;break;case b:var S=t[4],T=t[5],w=mathSqrt$2(t[0]*t[0]+t[1]*t[1]),A=mathSqrt$2(t[2]*t[2]+t[3]*t[3]),R=mathAtan2(-t[1]/A,t[0]/w);r[s]*=w,r[s++]+=S,r[s]*=A,r[s++]+=T,r[s++]*=w,r[s++]*=A,r[s++]+=R,r[s++]+=R,s+=2,c=s;break;case g:d[0]=r[s++],d[1]=r[s++],applyTransform$1(d,d,t),r[c++]=d[0],r[c++]=d[1],d[0]+=r[s++],d[1]+=r[s++],applyTransform$1(d,d,t),r[c++]=d[0],r[c++]=d[1]}for(l=0;l<u;l++){var E=points$2[l];E[0]=r[s++],E[1]=r[s++],applyTransform$1(E,E,t),r[c++]=E[0],r[c++]=E[1]}}n.increaseVersion()}}var mathSqrt$1=Math.sqrt,mathSin$2=Math.sin,mathCos$2=Math.cos,PI$7=Math.PI;function vMag(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function vRatio(n,t){return(n[0]*t[0]+n[1]*t[1])/(vMag(n)*vMag(t))}function vAngle(n,t){return(n[0]*t[1]<n[1]*t[0]?-1:1)*Math.acos(vRatio(n,t))}function processArc(n,t,r,a,o,u,s,c,l,d,f){var h=l*(PI$7/180),v=mathCos$2(h)*(n-r)/2+mathSin$2(h)*(t-a)/2,g=-1*mathSin$2(h)*(n-r)/2+mathCos$2(h)*(t-a)/2,b=v*v/(s*s)+g*g/(c*c);b>1&&(s*=mathSqrt$1(b),c*=mathSqrt$1(b));var _=(o===u?-1:1)*mathSqrt$1((s*s*(c*c)-s*s*(g*g)-c*c*(v*v))/(s*s*(g*g)+c*c*(v*v)))||0,S=_*s*g/c,T=_*-c*v/s,w=(n+r)/2+mathCos$2(h)*S-mathSin$2(h)*T,A=(t+a)/2+mathSin$2(h)*S+mathCos$2(h)*T,R=vAngle([1,0],[(v-S)/s,(g-T)/c]),E=[(v-S)/s,(g-T)/c],I=[(-1*v-S)/s,(-1*g-T)/c],L=vAngle(E,I);if(vRatio(E,I)<=-1&&(L=PI$7),vRatio(E,I)>=1&&(L=0),L<0){var F=Math.round(L/PI$7*1e6)/1e6;L=PI$7*2+F%2*PI$7}f.addData(d,w,A,s,c,R,L,h,u)}var commandReg=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,numberReg$1=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function createPathProxyFromString(n){var t=new PathProxy;if(!n)return t;var r=0,a=0,o=r,u=a,s,c=PathProxy.CMD,l=n.match(commandReg);if(!l)return t;for(var d=0;d<l.length;d++){for(var f=l[d],h=f.charAt(0),v=void 0,g=f.match(numberReg$1)||[],b=g.length,_=0;_<b;_++)g[_]=parseFloat(g[_]);for(var S=0;S<b;){var T=void 0,w=void 0,A=void 0,R=void 0,E=void 0,I=void 0,L=void 0,F=r,D=a,$=void 0,O=void 0;switch(h){case"l":r+=g[S++],a+=g[S++],v=c.L,t.addData(v,r,a);break;case"L":r=g[S++],a=g[S++],v=c.L,t.addData(v,r,a);break;case"m":r+=g[S++],a+=g[S++],v=c.M,t.addData(v,r,a),o=r,u=a,h="l";break;case"M":r=g[S++],a=g[S++],v=c.M,t.addData(v,r,a),o=r,u=a,h="L";break;case"h":r+=g[S++],v=c.L,t.addData(v,r,a);break;case"H":r=g[S++],v=c.L,t.addData(v,r,a);break;case"v":a+=g[S++],v=c.L,t.addData(v,r,a);break;case"V":a=g[S++],v=c.L,t.addData(v,r,a);break;case"C":v=c.C,t.addData(v,g[S++],g[S++],g[S++],g[S++],g[S++],g[S++]),r=g[S-2],a=g[S-1];break;case"c":v=c.C,t.addData(v,g[S++]+r,g[S++]+a,g[S++]+r,g[S++]+a,g[S++]+r,g[S++]+a),r+=g[S-2],a+=g[S-1];break;case"S":T=r,w=a,$=t.len(),O=t.data,s===c.C&&(T+=r-O[$-4],w+=a-O[$-3]),v=c.C,F=g[S++],D=g[S++],r=g[S++],a=g[S++],t.addData(v,T,w,F,D,r,a);break;case"s":T=r,w=a,$=t.len(),O=t.data,s===c.C&&(T+=r-O[$-4],w+=a-O[$-3]),v=c.C,F=r+g[S++],D=a+g[S++],r+=g[S++],a+=g[S++],t.addData(v,T,w,F,D,r,a);break;case"Q":F=g[S++],D=g[S++],r=g[S++],a=g[S++],v=c.Q,t.addData(v,F,D,r,a);break;case"q":F=g[S++]+r,D=g[S++]+a,r+=g[S++],a+=g[S++],v=c.Q,t.addData(v,F,D,r,a);break;case"T":T=r,w=a,$=t.len(),O=t.data,s===c.Q&&(T+=r-O[$-4],w+=a-O[$-3]),r=g[S++],a=g[S++],v=c.Q,t.addData(v,T,w,r,a);break;case"t":T=r,w=a,$=t.len(),O=t.data,s===c.Q&&(T+=r-O[$-4],w+=a-O[$-3]),r+=g[S++],a+=g[S++],v=c.Q,t.addData(v,T,w,r,a);break;case"A":A=g[S++],R=g[S++],E=g[S++],I=g[S++],L=g[S++],F=r,D=a,r=g[S++],a=g[S++],v=c.A,processArc(F,D,r,a,I,L,A,R,E,v,t);break;case"a":A=g[S++],R=g[S++],E=g[S++],I=g[S++],L=g[S++],F=r,D=a,r+=g[S++],a+=g[S++],v=c.A,processArc(F,D,r,a,I,L,A,R,E,v,t);break}}(h==="z"||h==="Z")&&(v=c.Z,t.addData(v),r=o,a=u),s=v}return t.toStatic(),t}var SVGPath=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(Path);function isPathProxy(n){return n.setData!=null}function createPathOptions(n,t){var r=createPathProxyFromString(n),a=extend$1({},t);return a.buildPath=function(o){if(isPathProxy(o)){o.setData(r.data);var u=o.getContext();u&&o.rebuildPath(u,1)}else{var u=o;r.rebuildPath(u,1)}},a.applyTransform=function(o){transformPath(r,o),this.dirtyShape()},a}function createFromString(n,t){return new SVGPath(createPathOptions(n,t))}function extendFromString(n,t){var r=createPathOptions(n,t),a=function(o){__extends(u,o);function u(s){var c=o.call(this,s)||this;return c.applyTransform=r.applyTransform,c.buildPath=r.buildPath,c}return u}(SVGPath);return a}function mergePath$1(n,t){for(var r=[],a=n.length,o=0;o<a;o++){var u=n[o];r.push(u.getUpdatedPathProxy(!0))}var s=new Path(t);return s.createPathProxy(),s.buildPath=function(c){if(isPathProxy(c)){c.appendPath(r);var l=c.getContext();l&&c.rebuildPath(l,1)}},s}function clonePath(n,t){t=t||{};var r=new Path;return n.shape&&r.setShape(n.shape),r.setStyle(n.style),t.bakeTransform?transformPath(r.path,n.getComputedTransform()):t.toLocal?r.setLocalTransform(n.getComputedTransform()):r.copyTransform(n),r.buildPath=n.buildPath,r.applyTransform=r.applyTransform,r.z=n.z,r.z2=n.z2,r.zlevel=n.zlevel,r}var CircleShape=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),Circle=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new CircleShape},t.prototype.buildPath=function(r,a){r.moveTo(a.cx+a.r,a.cy),r.arc(a.cx,a.cy,a.r,0,Math.PI*2)},t}(Path);Circle.prototype.type="circle";var EllipseShape=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),Ellipse=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new EllipseShape},t.prototype.buildPath=function(r,a){var o=.5522848,u=a.cx,s=a.cy,c=a.rx,l=a.ry,d=c*o,f=l*o;r.moveTo(u-c,s),r.bezierCurveTo(u-c,s-f,u-d,s-l,u,s-l),r.bezierCurveTo(u+d,s-l,u+c,s-f,u+c,s),r.bezierCurveTo(u+c,s+f,u+d,s+l,u,s+l),r.bezierCurveTo(u-d,s+l,u-c,s+f,u-c,s),r.closePath()},t}(Path);Ellipse.prototype.type="ellipse";var PI$6=Math.PI,PI2$3=PI$6*2,mathSin$1=Math.sin,mathCos$1=Math.cos,mathACos=Math.acos,mathATan2=Math.atan2,mathAbs$1=Math.abs,mathSqrt=Math.sqrt,mathMax$7=Math.max,mathMin$7=Math.min,e=1e-4;function intersect$1(n,t,r,a,o,u,s,c){var l=r-n,d=a-t,f=s-o,h=c-u,v=h*l-f*d;if(!(v*v<e))return v=(f*(t-u)-h*(n-o))/v,[n+v*l,t+v*d]}function computeCornerTangents(n,t,r,a,o,u,s){var c=n-r,l=t-a,d=(s?u:-u)/mathSqrt(c*c+l*l),f=d*l,h=-d*c,v=n+f,g=t+h,b=r+f,_=a+h,S=(v+b)/2,T=(g+_)/2,w=b-v,A=_-g,R=w*w+A*A,E=o-u,I=v*_-b*g,L=(A<0?-1:1)*mathSqrt(mathMax$7(0,E*E*R-I*I)),F=(I*A-w*L)/R,D=(-I*w-A*L)/R,$=(I*A+w*L)/R,O=(-I*w+A*L)/R,P=F-S,C=D-T,q=$-S,M=O-T;return P*P+C*C>q*q+M*M&&(F=$,D=O),{cx:F,cy:D,x0:-f,y0:-h,x1:F*(o/E-1),y1:D*(o/E-1)}}function normalizeCornerRadius(n){var t;if(isArray$2(n)){var r=n.length;if(!r)return n;r===1?t=[n[0],n[0],0,0]:r===2?t=[n[0],n[0],n[1],n[1]]:r===3?t=n.concat(n[2]):t=n}else t=[n,n,n,n];return t}function buildPath$1(n,t){var r,a=mathMax$7(t.r,0),o=mathMax$7(t.r0||0,0),u=a>0,s=o>0;if(!(!u&&!s)){if(u||(a=o,o=0),o>a){var c=a;a=o,o=c}var l=t.startAngle,d=t.endAngle;if(!(isNaN(l)||isNaN(d))){var f=t.cx,h=t.cy,v=!!t.clockwise,g=mathAbs$1(d-l),b=g>PI2$3&&g%PI2$3;if(b>e&&(g=b),!(a>e))n.moveTo(f,h);else if(g>PI2$3-e)n.moveTo(f+a*mathCos$1(l),h+a*mathSin$1(l)),n.arc(f,h,a,l,d,!v),o>e&&(n.moveTo(f+o*mathCos$1(d),h+o*mathSin$1(d)),n.arc(f,h,o,d,l,v));else{var _=void 0,S=void 0,T=void 0,w=void 0,A=void 0,R=void 0,E=void 0,I=void 0,L=void 0,F=void 0,D=void 0,$=void 0,O=void 0,P=void 0,C=void 0,q=void 0,M=a*mathCos$1(l),N=a*mathSin$1(l),G=o*mathCos$1(d),X=o*mathSin$1(d),Y=g>e;if(Y){var W=t.cornerRadius;W&&(r=normalizeCornerRadius(W),_=r[0],S=r[1],T=r[2],w=r[3]);var te=mathAbs$1(a-o)/2;if(A=mathMin$7(te,T),R=mathMin$7(te,w),E=mathMin$7(te,_),I=mathMin$7(te,S),D=L=mathMax$7(A,R),$=F=mathMax$7(E,I),(L>e||F>e)&&(O=a*mathCos$1(d),P=a*mathSin$1(d),C=o*mathCos$1(l),q=o*mathSin$1(l),g<PI$6)){var ue=intersect$1(M,N,C,q,O,P,G,X);if(ue){var fe=M-ue[0],re=N-ue[1],ye=O-ue[0],Te=P-ue[1],Re=1/mathSin$1(mathACos((fe*ye+re*Te)/(mathSqrt(fe*fe+re*re)*mathSqrt(ye*ye+Te*Te)))/2),ve=mathSqrt(ue[0]*ue[0]+ue[1]*ue[1]);D=mathMin$7(L,(a-ve)/(Re+1)),$=mathMin$7(F,(o-ve)/(Re-1))}}}if(!Y)n.moveTo(f+M,h+N);else if(D>e){var ce=mathMin$7(T,D),J=mathMin$7(w,D),j=computeCornerTangents(C,q,M,N,a,ce,v),z=computeCornerTangents(O,P,G,X,a,J,v);n.moveTo(f+j.cx+j.x0,h+j.cy+j.y0),D<L&&ce===J?n.arc(f+j.cx,h+j.cy,D,mathATan2(j.y0,j.x0),mathATan2(z.y0,z.x0),!v):(ce>0&&n.arc(f+j.cx,h+j.cy,ce,mathATan2(j.y0,j.x0),mathATan2(j.y1,j.x1),!v),n.arc(f,h,a,mathATan2(j.cy+j.y1,j.cx+j.x1),mathATan2(z.cy+z.y1,z.cx+z.x1),!v),J>0&&n.arc(f+z.cx,h+z.cy,J,mathATan2(z.y1,z.x1),mathATan2(z.y0,z.x0),!v))}else n.moveTo(f+M,h+N),n.arc(f,h,a,l,d,!v);if(!(o>e)||!Y)n.lineTo(f+G,h+X);else if($>e){var ce=mathMin$7(_,$),J=mathMin$7(S,$),j=computeCornerTangents(G,X,O,P,o,-J,v),z=computeCornerTangents(M,N,C,q,o,-ce,v);n.lineTo(f+j.cx+j.x0,h+j.cy+j.y0),$<F&&ce===J?n.arc(f+j.cx,h+j.cy,$,mathATan2(j.y0,j.x0),mathATan2(z.y0,z.x0),!v):(J>0&&n.arc(f+j.cx,h+j.cy,J,mathATan2(j.y0,j.x0),mathATan2(j.y1,j.x1),!v),n.arc(f,h,o,mathATan2(j.cy+j.y1,j.cx+j.x1),mathATan2(z.cy+z.y1,z.cx+z.x1),v),ce>0&&n.arc(f+z.cx,h+z.cy,ce,mathATan2(z.y1,z.x1),mathATan2(z.y0,z.x0),!v))}else n.lineTo(f+G,h+X),n.arc(f,h,o,d,l,v)}n.closePath()}}}var SectorShape=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),Sector=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new SectorShape},t.prototype.buildPath=function(r,a){buildPath$1(r,a)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(Path);Sector.prototype.type="sector";var RingShape=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),Ring=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new RingShape},t.prototype.buildPath=function(r,a){var o=a.cx,u=a.cy,s=Math.PI*2;r.moveTo(o+a.r,u),r.arc(o,u,a.r,0,s,!1),r.moveTo(o+a.r0,u),r.arc(o,u,a.r0,0,s,!0)},t}(Path);Ring.prototype.type="ring";function smoothBezier(n,t,r,a){var o=[],u=[],s=[],c=[],l,d,f,h;if(a){f=[1/0,1/0],h=[-1/0,-1/0];for(var v=0,g=n.length;v<g;v++)min$2(f,f,n[v]),max$3(h,h,n[v]);min$2(f,f,a[0]),max$3(h,h,a[1])}for(var v=0,g=n.length;v<g;v++){var b=n[v];if(r)l=n[v?v-1:g-1],d=n[(v+1)%g];else if(v===0||v===g-1){o.push(clone$4(n[v]));continue}else l=n[v-1],d=n[v+1];sub(u,d,l),scale$3(u,u,t);var _=distance(b,l),S=distance(b,d),T=_+S;T!==0&&(_/=T,S/=T),scale$3(s,u,-_),scale$3(c,u,S);var w=add([],b,s),A=add([],b,c);a&&(max$3(w,w,f),min$2(w,w,h),max$3(A,A,f),min$2(A,A,h)),o.push(w),o.push(A)}return r&&o.push(o.shift()),o}function buildPath(n,t,r){var a=t.smooth,o=t.points;if(o&&o.length>=2){if(a){var u=smoothBezier(o,a,r,t.smoothConstraint);n.moveTo(o[0][0],o[0][1]);for(var s=o.length,c=0;c<(r?s:s-1);c++){var l=u[c*2],d=u[c*2+1],f=o[(c+1)%s];n.bezierCurveTo(l[0],l[1],d[0],d[1],f[0],f[1])}}else{n.moveTo(o[0][0],o[0][1]);for(var c=1,h=o.length;c<h;c++)n.lineTo(o[c][0],o[c][1])}r&&n.closePath()}}var PolygonShape=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),Polygon=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new PolygonShape},t.prototype.buildPath=function(r,a){buildPath(r,a,!0)},t}(Path);Polygon.prototype.type="polygon";var PolylineShape=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),Polyline$1=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new PolylineShape},t.prototype.buildPath=function(r,a){buildPath(r,a,!1)},t}(Path);Polyline$1.prototype.type="polyline";var subPixelOptimizeOutputShape={},LineShape=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),Line$1=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new LineShape},t.prototype.buildPath=function(r,a){var o,u,s,c;if(this.subPixelOptimize){var l=subPixelOptimizeLine$1(subPixelOptimizeOutputShape,a,this.style);o=l.x1,u=l.y1,s=l.x2,c=l.y2}else o=a.x1,u=a.y1,s=a.x2,c=a.y2;var d=a.percent;d!==0&&(r.moveTo(o,u),d<1&&(s=o*(1-d)+s*d,c=u*(1-d)+c*d),r.lineTo(s,c))},t.prototype.pointAt=function(r){var a=this.shape;return[a.x1*(1-r)+a.x2*r,a.y1*(1-r)+a.y2*r]},t}(Path);Line$1.prototype.type="line";var out=[],BezierCurveShape=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function someVectorAt(n,t,r){var a=n.cpx2,o=n.cpy2;return a!=null||o!=null?[(r?cubicDerivativeAt:cubicAt)(n.x1,n.cpx1,n.cpx2,n.x2,t),(r?cubicDerivativeAt:cubicAt)(n.y1,n.cpy1,n.cpy2,n.y2,t)]:[(r?quadraticDerivativeAt:quadraticAt$1)(n.x1,n.cpx1,n.x2,t),(r?quadraticDerivativeAt:quadraticAt$1)(n.y1,n.cpy1,n.y2,t)]}var BezierCurve=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new BezierCurveShape},t.prototype.buildPath=function(r,a){var o=a.x1,u=a.y1,s=a.x2,c=a.y2,l=a.cpx1,d=a.cpy1,f=a.cpx2,h=a.cpy2,v=a.percent;v!==0&&(r.moveTo(o,u),f==null||h==null?(v<1&&(quadraticSubdivide(o,l,s,v,out),l=out[1],s=out[2],quadraticSubdivide(u,d,c,v,out),d=out[1],c=out[2]),r.quadraticCurveTo(l,d,s,c)):(v<1&&(cubicSubdivide(o,l,f,s,v,out),l=out[1],f=out[2],s=out[3],cubicSubdivide(u,d,h,c,v,out),d=out[1],h=out[2],c=out[3]),r.bezierCurveTo(l,d,f,h,s,c)))},t.prototype.pointAt=function(r){return someVectorAt(this.shape,r,!1)},t.prototype.tangentAt=function(r){var a=someVectorAt(this.shape,r,!0);return normalize$4(a,a)},t}(Path);BezierCurve.prototype.type="bezier-curve";var ArcShape=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),Arc=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new ArcShape},t.prototype.buildPath=function(r,a){var o=a.cx,u=a.cy,s=Math.max(a.r,0),c=a.startAngle,l=a.endAngle,d=a.clockwise,f=Math.cos(c),h=Math.sin(c);r.moveTo(f*s+o,h*s+u),r.arc(o,u,s,c,l,!d)},t}(Path);Arc.prototype.type="arc";var CompoundPath=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,a=this.shapeChanged(),o=0;o<r.length;o++)a=a||r[o].shapeChanged();a&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],a=this.getGlobalScale(),o=0;o<r.length;o++)r[o].path||r[o].createPathProxy(),r[o].path.setScale(a[0],a[1],r[o].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,a){for(var o=a.paths||[],u=0;u<o.length;u++)o[u].buildPath(r,o[u].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],a=0;a<r.length;a++)r[a].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Path.prototype.getBoundingRect.call(this)},t}(Path),Gradient=function(){function n(t){this.colorStops=t||[]}return n.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},n}(),LinearGradient=function(n){__extends(t,n);function t(r,a,o,u,s,c){var l=n.call(this,s)||this;return l.x=r??0,l.y=a??0,l.x2=o??1,l.y2=u??0,l.type="linear",l.global=c||!1,l}return t}(Gradient),RadialGradient=function(n){__extends(t,n);function t(r,a,o,u,s){var c=n.call(this,u)||this;return c.x=r??.5,c.y=a??.5,c.r=o??.5,c.type="radial",c.global=s||!1,c}return t}(Gradient),extent=[0,0],extent2=[0,0],minTv=new Point,maxTv=new Point,OrientedBoundingRect=function(){function n(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var a=0;a<4;a++)this._corners[a]=new Point;for(var a=0;a<2;a++)this._axes[a]=new Point;t&&this.fromBoundingRect(t,r)}return n.prototype.fromBoundingRect=function(t,r){var a=this._corners,o=this._axes,u=t.x,s=t.y,c=u+t.width,l=s+t.height;if(a[0].set(u,s),a[1].set(c,s),a[2].set(c,l),a[3].set(u,l),r)for(var d=0;d<4;d++)a[d].transform(r);Point.sub(o[0],a[1],a[0]),Point.sub(o[1],a[3],a[0]),o[0].normalize(),o[1].normalize();for(var d=0;d<2;d++)this._origin[d]=o[d].dot(a[0])},n.prototype.intersect=function(t,r){var a=!0,o=!r;return minTv.set(1/0,1/0),maxTv.set(0,0),!this._intersectCheckOneSide(this,t,minTv,maxTv,o,1)&&(a=!1,o)||!this._intersectCheckOneSide(t,this,minTv,maxTv,o,-1)&&(a=!1,o)||o||Point.copy(r,a?minTv:maxTv),a},n.prototype._intersectCheckOneSide=function(t,r,a,o,u,s){for(var c=!0,l=0;l<2;l++){var d=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,extent),this._getProjMinMaxOnAxis(l,r._corners,extent2),extent[1]<extent2[0]||extent[0]>extent2[1]){if(c=!1,u)return c;var f=Math.abs(extent2[0]-extent[1]),h=Math.abs(extent[0]-extent2[1]);Math.min(f,h)>o.len()&&(f<h?Point.scale(o,d,-f*s):Point.scale(o,d,h*s))}else if(a){var f=Math.abs(extent2[0]-extent[1]),h=Math.abs(extent[0]-extent2[1]);Math.min(f,h)<a.len()&&(f<h?Point.scale(a,d,f*s):Point.scale(a,d,-h*s))}}return c},n.prototype._getProjMinMaxOnAxis=function(t,r,a){for(var o=this._axes[t],u=this._origin,s=r[0].dot(o)+u[t],c=s,l=s,d=1;d<r.length;d++){var f=r[d].dot(o)+u[t];c=Math.min(f,c),l=Math.max(f,l)}a[0]=c,a[1]=l},n}(),m=[],IncrementalDisplayable=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,a){r.call(a,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,a){a?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,a){a=a||!1;for(var o=0;o<r.length;o++)this.addDisplayable(r[o],a)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var a=this._cursor;a<this._displayables.length;a++)r&&r(this._displayables[a]);for(var a=0;a<this._temporaryDisplayables.length;a++)r&&r(this._temporaryDisplayables[a])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var a=this._displayables[r];a.parent=this,a.update(),a.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var a=this._temporaryDisplayables[r];a.parent=this,a.update(),a.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new BoundingRect(1/0,1/0,-1/0,-1/0),a=0;a<this._displayables.length;a++){var o=this._displayables[a],u=o.getBoundingRect().clone();o.needLocalTransform()&&u.applyTransform(o.getLocalTransform(m)),r.union(u)}this._rect=r}return this._rect},t.prototype.contain=function(r,a){var o=this.transformCoordToLocal(r,a),u=this.getBoundingRect();if(u.contain(o[0],o[1]))for(var s=0;s<this._displayables.length;s++){var c=this._displayables[s];if(c.contain(r,a))return!0}return!1},t}(Displayable),transitionStore=makeInner();function getAnimationConfig(n,t,r,a,o){var u;if(t&&t.ecModel){var s=t.ecModel.getUpdatePayload();u=s&&s.animation}var c=t&&t.isAnimationEnabled(),l=n==="update";if(c){var d=void 0,f=void 0,h=void 0;a?(d=retrieve2(a.duration,200),f=retrieve2(a.easing,"cubicOut"),h=0):(d=t.getShallow(l?"animationDurationUpdate":"animationDuration"),f=t.getShallow(l?"animationEasingUpdate":"animationEasing"),h=t.getShallow(l?"animationDelayUpdate":"animationDelay")),u&&(u.duration!=null&&(d=u.duration),u.easing!=null&&(f=u.easing),u.delay!=null&&(h=u.delay)),isFunction$1(h)&&(h=h(r,o)),isFunction$1(d)&&(d=d(r));var v={duration:d||0,delay:h,easing:f};return v}else return null}function animateOrSetProps(n,t,r,a,o,u,s){var c=!1,l;isFunction$1(o)?(s=u,u=o,o=null):isObject$4(o)&&(u=o.cb,s=o.during,c=o.isFrom,l=o.removeOpt,o=o.dataIndex);var d=n==="leave";d||t.stopAnimation("leave");var f=getAnimationConfig(n,a,o,d?l||{}:null,a&&a.getAnimationDelayParams?a.getAnimationDelayParams(t,o):null);if(f&&f.duration>0){var h=f.duration,v=f.delay,g=f.easing,b={duration:h,delay:v||0,easing:g,done:u,force:!!u||!!s,setToFinal:!d,scope:n,during:s};c?t.animateFrom(r,b):t.animateTo(r,b)}else t.stopAnimation(),!c&&t.attr(r),s&&s(1),u&&u()}function updateProps$1(n,t,r,a,o,u){animateOrSetProps("update",n,t,r,a,o,u)}function initProps(n,t,r,a,o,u){animateOrSetProps("enter",n,t,r,a,o,u)}function isElementRemoved(n){if(!n.__zr)return!0;for(var t=0;t<n.animators.length;t++){var r=n.animators[t];if(r.scope==="leave")return!0}return!1}function removeElement(n,t,r,a,o,u){isElementRemoved(n)||animateOrSetProps("leave",n,t,r,a,o,u)}function fadeOutDisplayable(n,t,r,a){n.removeTextContent(),n.removeTextGuideLine(),removeElement(n,{style:{opacity:0}},t,r,a)}function removeElementWithFadeOut(n,t,r){function a(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(o){o.isGroup||fadeOutDisplayable(o,t,r,a)}):fadeOutDisplayable(n,t,r,a)}function saveOldStyle(n){transitionStore(n).oldStyle=n.style}function getOldStyle(n){return transitionStore(n).oldStyle}var mathMax$6=Math.max,mathMin$6=Math.min,_customShapeMap={};function extendShape(n){return Path.extend(n)}var extendPathFromString=extendFromString;function extendPath(n,t){return extendPathFromString(n,t)}function registerShape(n,t){_customShapeMap[n]=t}function getShapeClass(n){if(_customShapeMap.hasOwnProperty(n))return _customShapeMap[n]}function makePath(n,t,r,a){var o=createFromString(n,t);return r&&(a==="center"&&(r=centerGraphic(r,o.getBoundingRect())),resizePath(o,r)),o}function makeImage(n,t,r){var a=new ZRImage({style:{image:n,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(o){if(r==="center"){var u={width:o.width,height:o.height};a.setStyle(centerGraphic(t,u))}}});return a}function centerGraphic(n,t){var r=t.width/t.height,a=n.height*r,o;a<=n.width?o=n.height:(a=n.width,o=a/r);var u=n.x+n.width/2,s=n.y+n.height/2;return{x:u-a/2,y:s-o/2,width:a,height:o}}var mergePath=mergePath$1;function resizePath(n,t){if(n.applyTransform){var r=n.getBoundingRect(),a=r.calculateTransform(t);n.applyTransform(a)}}function subPixelOptimizeLine(n,t){return subPixelOptimizeLine$1(n,n,{lineWidth:t}),n}function subPixelOptimizeRect(n){return subPixelOptimizeRect$1(n.shape,n.shape,n.style),n}var subPixelOptimize=subPixelOptimize$1;function getTransform$1(n,t){for(var r=identity$2([]);n&&n!==t;)mul(r,n.getLocalTransform(),r),n=n.parent;return r}function applyTransform(n,t,r){return t&&!isArrayLike$1(t)&&(t=Transformable.getLocalTransform(t)),r&&(t=invert([],t)),applyTransform$1([],n,t)}function transformDirection(n,t,r){var a=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),o=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),u=[n==="left"?-a:n==="right"?a:0,n==="top"?-o:n==="bottom"?o:0];return u=applyTransform(u,t,r),Math.abs(u[0])>Math.abs(u[1])?u[0]>0?"right":"left":u[1]>0?"bottom":"top"}function isNotGroup(n){return!n.isGroup}function isPath$1(n){return n.shape!=null}function groupTransition(n,t,r){if(!n||!t)return;function a(s){var c={};return s.traverse(function(l){isNotGroup(l)&&l.anid&&(c[l.anid]=l)}),c}function o(s){var c={x:s.x,y:s.y,rotation:s.rotation};return isPath$1(s)&&(c.shape=extend$1({},s.shape)),c}var u=a(n);t.traverse(function(s){if(isNotGroup(s)&&s.anid){var c=u[s.anid];if(c){var l=o(s);s.attr(o(c)),updateProps$1(s,l,r,getECData(s).dataIndex)}}})}function clipPointsByRect(n,t){return map$1(n,function(r){var a=r[0];a=mathMax$6(a,t.x),a=mathMin$6(a,t.x+t.width);var o=r[1];return o=mathMax$6(o,t.y),o=mathMin$6(o,t.y+t.height),[a,o]})}function clipRectByRect(n,t){var r=mathMax$6(n.x,t.x),a=mathMin$6(n.x+n.width,t.x+t.width),o=mathMax$6(n.y,t.y),u=mathMin$6(n.y+n.height,t.y+t.height);if(a>=r&&u>=o)return{x:r,y:o,width:a-r,height:u-o}}function createIcon(n,t,r){var a=extend$1({rectHover:!0},t),o=a.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(o.image=n.slice(8),defaults$h(o,r),new ZRImage(a)):makePath(n.replace("path://",""),a,r,"center")}function linePolygonIntersect(n,t,r,a,o){for(var u=0,s=o[o.length-1];u<o.length;u++){var c=o[u];if(lineLineIntersect$1(n,t,r,a,c[0],c[1],s[0],s[1]))return!0;s=c}}function lineLineIntersect$1(n,t,r,a,o,u,s,c){var l=r-n,d=a-t,f=s-o,h=c-u,v=crossProduct2d$1(f,h,l,d);if(nearZero(v))return!1;var g=n-o,b=t-u,_=crossProduct2d$1(g,b,l,d)/v;if(_<0||_>1)return!1;var S=crossProduct2d$1(g,b,f,h)/v;return!(S<0||S>1)}function crossProduct2d$1(n,t,r,a){return n*a-r*t}function nearZero(n){return n<=1e-6&&n>=-1e-6}function setTooltipConfig(n){var t=n.itemTooltipOption,r=n.componentModel,a=n.itemName,o=isString(t)?{formatter:t}:t,u=r.mainType,s=r.componentIndex,c={componentType:u,name:a,$vars:["name"]};c[u+"Index"]=s;var l=n.formatterParamsExtra;l&&each$f(keys(l),function(f){hasOwn(c,f)||(c[f]=l[f],c.$vars.push(f))});var d=getECData(n.el);d.componentMainType=u,d.componentIndex=s,d.tooltipConfig={name:a,option:defaults$h({content:a,encodeHTMLContent:!0,formatterParams:c},o)}}function traverseElement(n,t){var r;n.isGroup&&(r=t(n)),r||n.traverse(t)}function traverseElements(n,t){if(n)if(isArray$2(n))for(var r=0;r<n.length;r++)traverseElement(n[r],t);else traverseElement(n,t)}registerShape("circle",Circle);registerShape("ellipse",Ellipse);registerShape("sector",Sector);registerShape("ring",Ring);registerShape("polygon",Polygon);registerShape("polyline",Polyline$1);registerShape("rect",Rect$2);registerShape("line",Line$1);registerShape("bezierCurve",BezierCurve);registerShape("arc",Arc);const graphic=Object.freeze(Object.defineProperty({__proto__:null,Arc,BezierCurve,BoundingRect,Circle,CompoundPath,Ellipse,Group:Group$3,Image:ZRImage,IncrementalDisplayable,Line:Line$1,LinearGradient,OrientedBoundingRect,Path,Point,Polygon,Polyline:Polyline$1,RadialGradient,Rect:Rect$2,Ring,Sector,Text:ZRText,applyTransform,clipPointsByRect,clipRectByRect,createIcon,extendPath,extendShape,getShapeClass,getTransform:getTransform$1,groupTransition,initProps,isElementRemoved,lineLineIntersect:lineLineIntersect$1,linePolygonIntersect,makeImage,makePath,mergePath,registerShape,removeElement,removeElementWithFadeOut,resizePath,setTooltipConfig,subPixelOptimize,subPixelOptimizeLine,subPixelOptimizeRect,transformDirection,traverseElements,updateProps:updateProps$1},Symbol.toStringTag,{value:"Module"}));var EMPTY_OBJ={};function setLabelText(n,t){for(var r=0;r<SPECIAL_STATES.length;r++){var a=SPECIAL_STATES[r],o=t[a],u=n.ensureState(a);u.style=u.style||{},u.style.text=o}var s=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:t.normal}),n.useStates(s,!0)}function getLabelText(n,t,r){var a=n.labelFetcher,o=n.labelDataIndex,u=n.labelDimIndex,s=t.normal,c;a&&(c=a.getFormattedLabel(o,"normal",null,u,s&&s.get("formatter"),r!=null?{interpolatedValue:r}:null)),c==null&&(c=isFunction$1(n.defaultText)?n.defaultText(o,n,r):n.defaultText);for(var l={normal:c},d=0;d<SPECIAL_STATES.length;d++){var f=SPECIAL_STATES[d],h=t[f];l[f]=retrieve2(a?a.getFormattedLabel(o,f,null,u,h&&h.get("formatter")):null,c)}return l}function setLabelStyle(n,t,r,a){r=r||EMPTY_OBJ;for(var o=n instanceof ZRText,u=!1,s=0;s<DISPLAY_STATES.length;s++){var c=t[DISPLAY_STATES[s]];if(c&&c.getShallow("show")){u=!0;break}}var l=o?n:n.getTextContent();if(u){o||(l||(l=new ZRText,n.setTextContent(l)),n.stateProxy&&(l.stateProxy=n.stateProxy));var d=getLabelText(r,t),f=t.normal,h=!!f.getShallow("show"),v=createTextStyle(f,a&&a.normal,r,!1,!o);v.text=d.normal,o||n.setTextConfig(createTextConfig(f,r,!1));for(var s=0;s<SPECIAL_STATES.length;s++){var g=SPECIAL_STATES[s],c=t[g];if(c){var b=l.ensureState(g),_=!!retrieve2(c.getShallow("show"),h);if(_!==h&&(b.ignore=!_),b.style=createTextStyle(c,a&&a[g],r,!0,!o),b.style.text=d[g],!o){var S=n.ensureState(g);S.textConfig=createTextConfig(c,r,!0)}}}l.silent=!!f.getShallow("silent"),l.style.x!=null&&(v.x=l.style.x),l.style.y!=null&&(v.y=l.style.y),l.ignore=!h,l.useStyle(v),l.dirty(),r.enableTextSetter&&(labelInner(l).setLabelText=function(T){var w=getLabelText(r,t,T);setLabelText(l,w)})}else l&&(l.ignore=!0);n.dirty()}function getLabelStatesModels(n,t){t=t||"label";for(var r={normal:n.getModel(t)},a=0;a<SPECIAL_STATES.length;a++){var o=SPECIAL_STATES[a];r[o]=n.getModel([o,t])}return r}function createTextStyle(n,t,r,a,o){var u={};return setTextStyleCommon(u,n,r,a,o),t&&extend$1(u,t),u}function createTextConfig(n,t,r){t=t||{};var a={},o,u=n.getShallow("rotate"),s=retrieve2(n.getShallow("distance"),r?null:5),c=n.getShallow("offset");return o=n.getShallow("position")||(r?null:"inside"),o==="outside"&&(o=t.defaultOutsidePosition||"top"),o!=null&&(a.position=o),c!=null&&(a.offset=c),u!=null&&(u*=Math.PI/180,a.rotation=u),s!=null&&(a.distance=s),a.outsideFill=n.get("color")==="inherit"?t.inheritColor||null:"auto",a}function setTextStyleCommon(n,t,r,a,o){r=r||EMPTY_OBJ;var u=t.ecModel,s=u&&u.option.textStyle,c=getRichItemNames(t),l;if(c){l={};for(var d in c)if(c.hasOwnProperty(d)){var f=t.getModel(["rich",d]);setTokenTextStyle(l[d]={},f,s,r,a,o,!1,!0)}}l&&(n.rich=l);var h=t.get("overflow");h&&(n.overflow=h);var v=t.get("minMargin");v!=null&&(n.margin=v),setTokenTextStyle(n,t,s,r,a,o,!0,!1)}function getRichItemNames(n){for(var t;n&&n!==n.ecModel;){var r=(n.option||EMPTY_OBJ).rich;if(r){t=t||{};for(var a=keys(r),o=0;o<a.length;o++){var u=a[o];t[u]=1}}n=n.parentModel}return t}var TEXT_PROPS_WITH_GLOBAL=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],TEXT_PROPS_SELF=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],TEXT_PROPS_BOX=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function setTokenTextStyle(n,t,r,a,o,u,s,c){r=!o&&r||EMPTY_OBJ;var l=a&&a.inheritColor,d=t.getShallow("color"),f=t.getShallow("textBorderColor"),h=retrieve2(t.getShallow("opacity"),r.opacity);(d==="inherit"||d==="auto")&&(l?d=l:d=null),(f==="inherit"||f==="auto")&&(l?f=l:f=null),u||(d=d||r.color,f=f||r.textBorderColor),d!=null&&(n.fill=d),f!=null&&(n.stroke=f);var v=retrieve2(t.getShallow("textBorderWidth"),r.textBorderWidth);v!=null&&(n.lineWidth=v);var g=retrieve2(t.getShallow("textBorderType"),r.textBorderType);g!=null&&(n.lineDash=g);var b=retrieve2(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);b!=null&&(n.lineDashOffset=b),!o&&h==null&&!c&&(h=a&&a.defaultOpacity),h!=null&&(n.opacity=h),!o&&!u&&n.fill==null&&a.inheritColor&&(n.fill=a.inheritColor);for(var _=0;_<TEXT_PROPS_WITH_GLOBAL.length;_++){var S=TEXT_PROPS_WITH_GLOBAL[_],T=retrieve2(t.getShallow(S),r[S]);T!=null&&(n[S]=T)}for(var _=0;_<TEXT_PROPS_SELF.length;_++){var S=TEXT_PROPS_SELF[_],T=t.getShallow(S);T!=null&&(n[S]=T)}if(n.verticalAlign==null){var w=t.getShallow("baseline");w!=null&&(n.verticalAlign=w)}if(!s||!a.disableBox){for(var _=0;_<TEXT_PROPS_BOX.length;_++){var S=TEXT_PROPS_BOX[_],T=t.getShallow(S);T!=null&&(n[S]=T)}var A=t.getShallow("borderType");A!=null&&(n.borderDash=A),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&l&&(n.backgroundColor=l),(n.borderColor==="auto"||n.borderColor==="inherit")&&l&&(n.borderColor=l)}}function getFont(n,t){var r=t&&t.getModel("textStyle");return trim$1([n.fontStyle||r&&r.getShallow("fontStyle")||"",n.fontWeight||r&&r.getShallow("fontWeight")||"",(n.fontSize||r&&r.getShallow("fontSize")||12)+"px",n.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var labelInner=makeInner();function setLabelValueAnimation(n,t,r,a){if(n){var o=labelInner(n);o.prevValue=o.value,o.value=r;var u=t.normal;o.valueAnimation=u.get("valueAnimation"),o.valueAnimation&&(o.precision=u.get("precision"),o.defaultInterpolatedText=a,o.statesModels=t)}}function animateLabelValue(n,t,r,a,o){var u=labelInner(n);if(!u.valueAnimation||u.prevValue===u.value)return;var s=u.defaultInterpolatedText,c=retrieve2(u.interpolatedValue,u.prevValue),l=u.value;function d(f){var h=interpolateRawValues(r,u.precision,c,l,f);u.interpolatedValue=f===1?null:h;var v=getLabelText({labelDataIndex:t,labelFetcher:o,defaultText:s?s(h):h+""},u.statesModels,h);setLabelText(n,v)}n.percent=0,(u.prevValue==null?initProps:updateProps$1)(n,{percent:1},a,t,null,d)}var PATH_COLOR=["textStyle","color"],textStyleParams=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],tmpText=new ZRText,TextStyleMixin=function(){function n(){}return n.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(PATH_COLOR):null)},n.prototype.getFont=function(){return getFont({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},a=0;a<textStyleParams.length;a++)r[textStyleParams[a]]=this.getShallow(textStyleParams[a]);return tmpText.useStyle(r),tmpText.update(),tmpText.getBoundingRect()},n}(),LINE_STYLE_KEY_MAP=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],getLineStyle=makeStyleMapper(LINE_STYLE_KEY_MAP),LineStyleMixin=function(){function n(){}return n.prototype.getLineStyle=function(t){return getLineStyle(this,t)},n}(),ITEM_STYLE_KEY_MAP=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],getItemStyle=makeStyleMapper(ITEM_STYLE_KEY_MAP),ItemStyleMixin=function(){function n(){}return n.prototype.getItemStyle=function(t,r){return getItemStyle(this,t,r)},n}(),Model=function(){function n(t,r,a){this.parentModel=r,this.ecModel=a,this.option=t}return n.prototype.init=function(t,r,a){},n.prototype.mergeOption=function(t,r){merge$3(this.option,t,!0)},n.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},n.prototype.getShallow=function(t,r){var a=this.option,o=a==null?a:a[t];if(o==null&&!r){var u=this.parentModel;u&&(o=u.getShallow(t))}return o},n.prototype.getModel=function(t,r){var a=t!=null,o=a?this.parsePath(t):null,u=a?this._doGet(o):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(o)),new n(u,r,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var t=this.constructor;return new t(clone$5(this.option))},n.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},n.prototype.resolveParentPath=function(t){return t},n.prototype.isAnimationEnabled=function(){if(!env.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(t,r){var a=this.option;if(!t)return a;for(var o=0;o<t.length&&!(t[o]&&(a=a&&typeof a=="object"?a[t[o]]:null,a==null));o++);return a==null&&r&&(a=r._doGet(this.resolveParentPath(t),r.parentModel)),a},n}();enableClassExtend(Model);enableClassCheck(Model);mixin$1(Model,LineStyleMixin);mixin$1(Model,ItemStyleMixin);mixin$1(Model,AreaStyleMixin);mixin$1(Model,TextStyleMixin);var base=Math.round(Math.random()*10);function getUID(n){return[n||"",base++].join("_")}function enableSubTypeDefaulter(n){var t={};n.registerSubTypeDefaulter=function(r,a){var o=parseClassType(r);t[o.main]=a},n.determineSubType=function(r,a){var o=a.type;if(!o){var u=parseClassType(r).main;n.hasSubTypes(r)&&t[u]&&(o=t[u](a))}return o}}function enableTopologicalTravel(n,t){n.topologicalTravel=function(u,s,c,l){if(!u.length)return;var d=r(s),f=d.graph,h=d.noEntryList,v={};for(each$f(u,function(w){v[w]=!0});h.length;){var g=h.pop(),b=f[g],_=!!v[g];_&&(c.call(l,g,b.originalDeps.slice()),delete v[g]),each$f(b.successor,_?T:S)}each$f(v,function(){var w="";throw new Error(w)});function S(w){f[w].entryCount--,f[w].entryCount===0&&h.push(w)}function T(w){v[w]=!0,S(w)}};function r(u){var s={},c=[];return each$f(u,function(l){var d=a(s,l),f=d.originalDeps=t(l),h=o(f,u);d.entryCount=h.length,d.entryCount===0&&c.push(l),each$f(h,function(v){indexOf(d.predecessor,v)<0&&d.predecessor.push(v);var g=a(s,v);indexOf(g.successor,v)<0&&g.successor.push(l)})}),{graph:s,noEntryList:c}}function a(u,s){return u[s]||(u[s]={predecessor:[],successor:[]}),u[s]}function o(u,s){var c=[];return each$f(u,function(l){indexOf(s,l)>=0&&c.push(l)}),c}}function inheritDefaultOption(n,t){return merge$3(merge$3({},n,!0),t,!0)}const langEN={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},langZH={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var LOCALE_ZH="ZH",LOCALE_EN="EN",DEFAULT_LOCALE=LOCALE_EN,localeStorage={},localeModels={},SYSTEM_LANG=env.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage||DEFAULT_LOCALE).toUpperCase();return n.indexOf(LOCALE_ZH)>-1?LOCALE_ZH:DEFAULT_LOCALE}():DEFAULT_LOCALE;function registerLocale(n,t){n=n.toUpperCase(),localeModels[n]=new Model(t),localeStorage[n]=t}function createLocaleObject(n){if(isString(n)){var t=localeStorage[n.toUpperCase()]||{};return n===LOCALE_ZH||n===LOCALE_EN?clone$5(t):merge$3(clone$5(t),clone$5(localeStorage[DEFAULT_LOCALE]),!1)}else return merge$3(clone$5(n),clone$5(localeStorage[DEFAULT_LOCALE]),!1)}function getLocaleModel(n){return localeModels[n]}function getDefaultLocaleModel(){return localeModels[DEFAULT_LOCALE]}registerLocale(LOCALE_EN,langEN);registerLocale(LOCALE_ZH,langZH);var ONE_SECOND=1e3,ONE_MINUTE=ONE_SECOND*60,ONE_HOUR=ONE_MINUTE*60,ONE_DAY=ONE_HOUR*24,ONE_YEAR=ONE_DAY*365,defaultLeveledFormatter={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},fullDayFormatter="{yyyy}-{MM}-{dd}",fullLeveledFormatter={year:"{yyyy}",month:"{yyyy}-{MM}",day:fullDayFormatter,hour:fullDayFormatter+" "+defaultLeveledFormatter.hour,minute:fullDayFormatter+" "+defaultLeveledFormatter.minute,second:fullDayFormatter+" "+defaultLeveledFormatter.second,millisecond:defaultLeveledFormatter.none},primaryTimeUnits=["year","month","day","hour","minute","second","millisecond"],timeUnits=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function pad(n,t){return n+="","0000".substr(0,t-n.length)+n}function getPrimaryTimeUnit(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function isPrimaryTimeUnit(n){return n===getPrimaryTimeUnit(n)}function getDefaultFormatPrecisionOfInterval(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function format(n,t,r,a){var o=parseDate(n),u=o[fullYearGetterName(r)](),s=o[monthGetterName(r)]()+1,c=Math.floor((s-1)/3)+1,l=o[dateGetterName(r)](),d=o["get"+(r?"UTC":"")+"Day"](),f=o[hoursGetterName(r)](),h=(f-1)%12+1,v=o[minutesGetterName(r)](),g=o[secondsGetterName(r)](),b=o[millisecondsGetterName(r)](),_=f>=12?"pm":"am",S=_.toUpperCase(),T=a instanceof Model?a:getLocaleModel(a||SYSTEM_LANG)||getDefaultLocaleModel(),w=T.getModel("time"),A=w.get("month"),R=w.get("monthAbbr"),E=w.get("dayOfWeek"),I=w.get("dayOfWeekAbbr");return(t||"").replace(/{a}/g,_+"").replace(/{A}/g,S+"").replace(/{yyyy}/g,u+"").replace(/{yy}/g,pad(u%100+"",2)).replace(/{Q}/g,c+"").replace(/{MMMM}/g,A[s-1]).replace(/{MMM}/g,R[s-1]).replace(/{MM}/g,pad(s,2)).replace(/{M}/g,s+"").replace(/{dd}/g,pad(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,E[d]).replace(/{ee}/g,I[d]).replace(/{e}/g,d+"").replace(/{HH}/g,pad(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,pad(h+"",2)).replace(/{h}/g,h+"").replace(/{mm}/g,pad(v,2)).replace(/{m}/g,v+"").replace(/{ss}/g,pad(g,2)).replace(/{s}/g,g+"").replace(/{SSS}/g,pad(b,3)).replace(/{S}/g,b+"")}function leveledFormat(n,t,r,a,o){var u=null;if(isString(r))u=r;else if(isFunction$1(r))u=r(n.value,t,{level:n.level});else{var s=extend$1({},defaultLeveledFormatter);if(n.level>0)for(var c=0;c<primaryTimeUnits.length;++c)s[primaryTimeUnits[c]]="{primary|"+s[primaryTimeUnits[c]]+"}";var l=r?r.inherit===!1?r:defaults$h(r,s):s,d=getUnitFromValue(n.value,o);if(l[d])u=l[d];else if(l.inherit){for(var f=timeUnits.indexOf(d),c=f-1;c>=0;--c)if(l[d]){u=l[d];break}u=u||s.none}if(isArray$2(u)){var h=n.level==null?0:n.level>=0?n.level:u.length+n.level;h=Math.min(h,u.length-1),u=u[h]}}return format(new Date(n.value),u,o,a)}function getUnitFromValue(n,t){var r=parseDate(n),a=r[monthGetterName(t)]()+1,o=r[dateGetterName(t)](),u=r[hoursGetterName(t)](),s=r[minutesGetterName(t)](),c=r[secondsGetterName(t)](),l=r[millisecondsGetterName(t)](),d=l===0,f=d&&c===0,h=f&&s===0,v=h&&u===0,g=v&&o===1,b=g&&a===1;return b?"year":g?"month":v?"day":h?"hour":f?"minute":d?"second":"millisecond"}function getUnitValue(n,t,r){var a=isNumber(n)?parseDate(n):n;switch(t=t||getUnitFromValue(n,r),t){case"year":return a[fullYearGetterName(r)]();case"half-year":return a[monthGetterName(r)]()>=6?1:0;case"quarter":return Math.floor((a[monthGetterName(r)]()+1)/4);case"month":return a[monthGetterName(r)]();case"day":return a[dateGetterName(r)]();case"half-day":return a[hoursGetterName(r)]()/24;case"hour":return a[hoursGetterName(r)]();case"minute":return a[minutesGetterName(r)]();case"second":return a[secondsGetterName(r)]();case"millisecond":return a[millisecondsGetterName(r)]()}}function fullYearGetterName(n){return n?"getUTCFullYear":"getFullYear"}function monthGetterName(n){return n?"getUTCMonth":"getMonth"}function dateGetterName(n){return n?"getUTCDate":"getDate"}function hoursGetterName(n){return n?"getUTCHours":"getHours"}function minutesGetterName(n){return n?"getUTCMinutes":"getMinutes"}function secondsGetterName(n){return n?"getUTCSeconds":"getSeconds"}function millisecondsGetterName(n){return n?"getUTCMilliseconds":"getMilliseconds"}function fullYearSetterName(n){return n?"setUTCFullYear":"setFullYear"}function monthSetterName(n){return n?"setUTCMonth":"setMonth"}function dateSetterName(n){return n?"setUTCDate":"setDate"}function hoursSetterName(n){return n?"setUTCHours":"setHours"}function minutesSetterName(n){return n?"setUTCMinutes":"setMinutes"}function secondsSetterName(n){return n?"setUTCSeconds":"setSeconds"}function millisecondsSetterName(n){return n?"setUTCMilliseconds":"setMilliseconds"}function addCommas(n){if(!isNumeric(n))return isString(n)?n:"-";var t=(n+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function toCamelCase(n,t){return n=(n||"").toLowerCase().replace(/-(.)/g,function(r,a){return a.toUpperCase()}),t&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var normalizeCssArray=normalizeCssArray$1;function makeValueReadable(n,t,r){var a="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function o(f){return f&&trim$1(f)?f:"-"}function u(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var s=t==="time",c=n instanceof Date;if(s||c){var l=s?parseDate(n):n;if(isNaN(+l)){if(c)return"-"}else return format(l,a,r)}if(t==="ordinal")return isStringSafe(n)?o(n):isNumber(n)&&u(n)?n+"":"-";var d=numericToNumber(n);return u(d)?addCommas(d):isStringSafe(n)?o(n):typeof n=="boolean"?n+"":"-"}var TPL_VAR_ALIAS=["a","b","c","d","e","f","g"],wrapVar=function(n,t){return"{"+n+(t??"")+"}"};function formatTpl(n,t,r){isArray$2(t)||(t=[t]);var a=t.length;if(!a)return"";for(var o=t[0].$vars||[],u=0;u<o.length;u++){var s=TPL_VAR_ALIAS[u];n=n.replace(wrapVar(s),wrapVar(s,0))}for(var c=0;c<a;c++)for(var l=0;l<o.length;l++){var d=t[c][o[l]];n=n.replace(wrapVar(TPL_VAR_ALIAS[l],c),r?encodeHTML(d):d)}return n}function formatTplSimple(n,t,r){return each$f(t,function(a,o){n=n.replace("{"+o+"}",a)}),n}function getTooltipMarker(n,t){var r=isString(n)?{color:n,extraCssText:t}:n||{},a=r.color,o=r.type;t=r.extraCssText;var u=r.renderMode||"html";if(!a)return"";if(u==="html")return o==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+encodeHTML(a)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+encodeHTML(a)+";"+(t||"")+'"></span>';var s=r.markerId||"markerX";return{renderMode:u,content:"{"+s+"|}  ",style:o==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:a}:{width:10,height:10,borderRadius:5,backgroundColor:a}}}function convertToColorString(n,t){return t=t||"transparent",isString(n)?n:isObject$4(n)&&n.colorStops&&(n.colorStops[0]||{}).color||t}function windowOpen(n,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=n}else window.open(n,t)}var each$e=each$f,LOCATION_PARAMS=["left","right","top","bottom","width","height"],HV_NAMES=[["width","left","right"],["height","top","bottom"]];function boxLayout(n,t,r,a,o){var u=0,s=0;a==null&&(a=1/0),o==null&&(o=1/0);var c=0;t.eachChild(function(l,d){var f=l.getBoundingRect(),h=t.childAt(d+1),v=h&&h.getBoundingRect(),g,b;if(n==="horizontal"){var _=f.width+(v?-v.x+f.x:0);g=u+_,g>a||l.newline?(u=0,g=_,s+=c+r,c=f.height):c=Math.max(c,f.height)}else{var S=f.height+(v?-v.y+f.y:0);b=s+S,b>o||l.newline?(u+=c+r,s=0,b=S,c=f.width):c=Math.max(c,f.width)}l.newline||(l.x=u,l.y=s,l.markRedraw(),n==="horizontal"?u=g+r:s=b+r)})}var box=boxLayout;curry$1(boxLayout,"vertical");curry$1(boxLayout,"horizontal");function getAvailableSize(n,t,r){var a=t.width,o=t.height,u=parsePercent(n.left,a),s=parsePercent(n.top,o),c=parsePercent(n.right,a),l=parsePercent(n.bottom,o);return(isNaN(u)||isNaN(parseFloat(n.left)))&&(u=0),(isNaN(c)||isNaN(parseFloat(n.right)))&&(c=a),(isNaN(s)||isNaN(parseFloat(n.top)))&&(s=0),(isNaN(l)||isNaN(parseFloat(n.bottom)))&&(l=o),r=normalizeCssArray(r||0),{width:Math.max(c-u-r[1]-r[3],0),height:Math.max(l-s-r[0]-r[2],0)}}function getLayoutRect(n,t,r){r=normalizeCssArray(r||0);var a=t.width,o=t.height,u=parsePercent(n.left,a),s=parsePercent(n.top,o),c=parsePercent(n.right,a),l=parsePercent(n.bottom,o),d=parsePercent(n.width,a),f=parsePercent(n.height,o),h=r[2]+r[0],v=r[1]+r[3],g=n.aspect;switch(isNaN(d)&&(d=a-c-v-u),isNaN(f)&&(f=o-l-h-s),g!=null&&(isNaN(d)&&isNaN(f)&&(g>a/o?d=a*.8:f=o*.8),isNaN(d)&&(d=g*f),isNaN(f)&&(f=d/g)),isNaN(u)&&(u=a-c-d-v),isNaN(s)&&(s=o-l-f-h),n.left||n.right){case"center":u=a/2-d/2-r[3];break;case"right":u=a-d-v;break}switch(n.top||n.bottom){case"middle":case"center":s=o/2-f/2-r[0];break;case"bottom":s=o-f-h;break}u=u||0,s=s||0,isNaN(d)&&(d=a-v-u-(c||0)),isNaN(f)&&(f=o-h-s-(l||0));var b=new BoundingRect(u+r[3],s+r[0],d,f);return b.margin=r,b}function positionElement(n,t,r,a,o,u){var s=!o||!o.hv||o.hv[0],c=!o||!o.hv||o.hv[1],l=o&&o.boundingMode||"all";if(u=u||n,u.x=n.x,u.y=n.y,!s&&!c)return!1;var d;if(l==="raw")d=n.type==="group"?new BoundingRect(0,0,+t.width||0,+t.height||0):n.getBoundingRect();else if(d=n.getBoundingRect(),n.needLocalTransform()){var f=n.getLocalTransform();d=d.clone(),d.applyTransform(f)}var h=getLayoutRect(defaults$h({width:d.width,height:d.height},t),r,a),v=s?h.x-d.x:0,g=c?h.y-d.y:0;return l==="raw"?(u.x=v,u.y=g):(u.x+=v,u.y+=g),u===n&&n.markRedraw(),!0}function sizeCalculable(n,t){return n[HV_NAMES[t][0]]!=null||n[HV_NAMES[t][1]]!=null&&n[HV_NAMES[t][2]]!=null}function fetchLayoutMode(n){var t=n.layoutMode||n.constructor.layoutMode;return isObject$4(t)?t:t?{type:t}:null}function mergeLayoutParam(n,t,r){var a=r&&r.ignoreSize;!isArray$2(a)&&(a=[a,a]);var o=s(HV_NAMES[0],0),u=s(HV_NAMES[1],1);d(HV_NAMES[0],n,o),d(HV_NAMES[1],n,u);function s(f,h){var v={},g=0,b={},_=0,S=2;if(each$e(f,function(A){b[A]=n[A]}),each$e(f,function(A){c(t,A)&&(v[A]=b[A]=t[A]),l(v,A)&&g++,l(b,A)&&_++}),a[h])return l(t,f[1])?b[f[2]]=null:l(t,f[2])&&(b[f[1]]=null),b;if(_===S||!g)return b;if(g>=S)return v;for(var T=0;T<f.length;T++){var w=f[T];if(!c(v,w)&&c(n,w)){v[w]=n[w];break}}return v}function c(f,h){return f.hasOwnProperty(h)}function l(f,h){return f[h]!=null&&f[h]!=="auto"}function d(f,h,v){each$e(f,function(g){h[g]=v[g]})}}function getLayoutParams(n){return copyLayoutParams({},n)}function copyLayoutParams(n,t){return t&&n&&each$e(LOCATION_PARAMS,function(r){t.hasOwnProperty(r)&&(n[r]=t[r])}),n}var inner$l=makeInner(),ComponentModel=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this,r,a,o)||this;return u.uid=getUID("ec_cpt_model"),u}return t.prototype.init=function(r,a,o){this.mergeDefaultAndTheme(r,o)},t.prototype.mergeDefaultAndTheme=function(r,a){var o=fetchLayoutMode(this),u=o?getLayoutParams(r):{},s=a.getTheme();merge$3(r,s.get(this.mainType)),merge$3(r,this.getDefaultOption()),o&&mergeLayoutParam(r,u,o)},t.prototype.mergeOption=function(r,a){merge$3(this.option,r,!0);var o=fetchLayoutMode(this);o&&mergeLayoutParam(this.option,r,o)},t.prototype.optionUpdated=function(r,a){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!isExtendedClass(r))return r.defaultOption;var a=inner$l(this);if(!a.defaultOption){for(var o=[],u=r;u;){var s=u.prototype.defaultOption;s&&o.push(s),u=u.superClass}for(var c={},l=o.length-1;l>=0;l--)c=merge$3(c,o[l],!0);a.defaultOption=c}return a.defaultOption},t.prototype.getReferringComponents=function(r,a){var o=r+"Index",u=r+"Id";return queryReferringComponents(this.ecModel,r,{index:this.get(o,!0),id:this.get(u,!0)},a)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Model);mountExtend(ComponentModel,Model);enableClassManagement(ComponentModel);enableSubTypeDefaulter(ComponentModel);enableTopologicalTravel(ComponentModel,getDependencies);function getDependencies(n){var t=[];return each$f(ComponentModel.getClassesByMainType(n),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=map$1(t,function(r){return parseClassType(r).main}),n!=="dataset"&&indexOf(t,"dataset")<=0&&t.unshift("dataset"),t}var platform="";typeof navigator<"u"&&(platform=navigator.platform||"");var decalColor="rgba(0, 0, 0, 0.2)";const globalDefault={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:decalColor,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:decalColor,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:decalColor,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:decalColor,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:decalColor,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:decalColor,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:platform.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var VISUAL_DIMENSIONS=createHashMap(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),SOURCE_FORMAT_ORIGINAL="original",SOURCE_FORMAT_ARRAY_ROWS="arrayRows",SOURCE_FORMAT_OBJECT_ROWS="objectRows",SOURCE_FORMAT_KEYED_COLUMNS="keyedColumns",SOURCE_FORMAT_TYPED_ARRAY="typedArray",SOURCE_FORMAT_UNKNOWN="unknown",SERIES_LAYOUT_BY_COLUMN="column",SERIES_LAYOUT_BY_ROW="row",BE_ORDINAL={Must:1,Might:2,Not:3},innerGlobalModel=makeInner();function resetSourceDefaulter(n){innerGlobalModel(n).datasetMap=createHashMap()}function makeSeriesEncodeForAxisCoordSys(n,t,r){var a={},o=querySeriesUpstreamDatasetModel(t);if(!o||!n)return a;var u=[],s=[],c=t.ecModel,l=innerGlobalModel(c).datasetMap,d=o.uid+"_"+r.seriesLayoutBy,f,h;n=n.slice(),each$f(n,function(_,S){var T=isObject$4(_)?_:n[S]={name:_};T.type==="ordinal"&&f==null&&(f=S,h=b(T)),a[T.name]=[]});var v=l.get(d)||l.set(d,{categoryWayDim:h,valueWayDim:0});each$f(n,function(_,S){var T=_.name,w=b(_);if(f==null){var A=v.valueWayDim;g(a[T],A,w),g(s,A,w),v.valueWayDim+=w}else if(f===S)g(a[T],0,w),g(u,0,w);else{var A=v.categoryWayDim;g(a[T],A,w),g(s,A,w),v.categoryWayDim+=w}});function g(_,S,T){for(var w=0;w<T;w++)_.push(S+w)}function b(_){var S=_.dimsDef;return S?S.length:1}return u.length&&(a.itemName=u),s.length&&(a.seriesName=s),a}function makeSeriesEncodeForNameBased(n,t,r){var a={},o=querySeriesUpstreamDatasetModel(n);if(!o)return a;var u=t.sourceFormat,s=t.dimensionsDefine,c;(u===SOURCE_FORMAT_OBJECT_ROWS||u===SOURCE_FORMAT_KEYED_COLUMNS)&&each$f(s,function(f,h){(isObject$4(f)?f.name:f)==="name"&&(c=h)});var l=function(){for(var f={},h={},v=[],g=0,b=Math.min(5,r);g<b;g++){var _=doGuessOrdinal(t.data,u,t.seriesLayoutBy,s,t.startIndex,g);v.push(_);var S=_===BE_ORDINAL.Not;if(S&&f.v==null&&g!==c&&(f.v=g),(f.n==null||f.n===f.v||!S&&v[f.n]===BE_ORDINAL.Not)&&(f.n=g),T(f)&&v[f.n]!==BE_ORDINAL.Not)return f;S||(_===BE_ORDINAL.Might&&h.v==null&&g!==c&&(h.v=g),(h.n==null||h.n===h.v)&&(h.n=g))}function T(w){return w.v!=null&&w.n!=null}return T(f)?f:T(h)?h:null}();if(l){a.value=[l.v];var d=c??l.n;a.itemName=[d],a.seriesName=[d]}return a}function querySeriesUpstreamDatasetModel(n){var t=n.get("data",!0);if(!t)return queryReferringComponents(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},SINGLE_REFERRING).models[0]}function queryDatasetUpstreamDatasetModels(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:queryReferringComponents(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},SINGLE_REFERRING).models}function guessOrdinal(n,t){return doGuessOrdinal(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,t)}function doGuessOrdinal(n,t,r,a,o,u){var s,c=5;if(isTypedArray(n))return BE_ORDINAL.Not;var l,d;if(a){var f=a[u];isObject$4(f)?(l=f.name,d=f.type):isString(f)&&(l=f)}if(d!=null)return d==="ordinal"?BE_ORDINAL.Must:BE_ORDINAL.Not;if(t===SOURCE_FORMAT_ARRAY_ROWS){var h=n;if(r===SERIES_LAYOUT_BY_ROW){for(var v=h[u],g=0;g<(v||[]).length&&g<c;g++)if((s=R(v[o+g]))!=null)return s}else for(var g=0;g<h.length&&g<c;g++){var b=h[o+g];if(b&&(s=R(b[u]))!=null)return s}}else if(t===SOURCE_FORMAT_OBJECT_ROWS){var _=n;if(!l)return BE_ORDINAL.Not;for(var g=0;g<_.length&&g<c;g++){var S=_[g];if(S&&(s=R(S[l]))!=null)return s}}else if(t===SOURCE_FORMAT_KEYED_COLUMNS){var T=n;if(!l)return BE_ORDINAL.Not;var v=T[l];if(!v||isTypedArray(v))return BE_ORDINAL.Not;for(var g=0;g<v.length&&g<c;g++)if((s=R(v[g]))!=null)return s}else if(t===SOURCE_FORMAT_ORIGINAL)for(var w=n,g=0;g<w.length&&g<c;g++){var S=w[g],A=getDataItemValue(S);if(!isArray$2(A))return BE_ORDINAL.Not;if((s=R(A[u]))!=null)return s}function R(E){var I=isString(E);if(E!=null&&Number.isFinite(Number(E))&&E!=="")return I?BE_ORDINAL.Might:BE_ORDINAL.Not;if(I&&E!=="-")return BE_ORDINAL.Must}return BE_ORDINAL.Not}var internalOptionCreatorMap=createHashMap();function registerInternalOptionCreator(n,t){assert(internalOptionCreatorMap.get(n)==null&&t),internalOptionCreatorMap.set(n,t)}function concatInternalOptions(n,t,r){var a=internalOptionCreatorMap.get(t);if(!a)return r;var o=a(n);return o?r.concat(o):r}var innerColor=makeInner(),innerDecal=makeInner(),PaletteMixin=function(){function n(){}return n.prototype.getColorFromPalette=function(t,r,a){var o=normalizeToArray(this.get("color",!0)),u=this.get("colorLayer",!0);return getFromPalette(this,innerColor,o,u,t,r,a)},n.prototype.clearColorPalette=function(){clearPalette(this,innerColor)},n}();function getDecalFromPalette(n,t,r,a){var o=normalizeToArray(n.get(["aria","decal","decals"]));return getFromPalette(n,innerDecal,o,null,t,r,a)}function getNearestPalette(n,t){for(var r=n.length,a=0;a<r;a++)if(n[a].length>t)return n[a];return n[r-1]}function getFromPalette(n,t,r,a,o,u,s){u=u||n;var c=t(u),l=c.paletteIdx||0,d=c.paletteNameMap=c.paletteNameMap||{};if(d.hasOwnProperty(o))return d[o];var f=s==null||!a?r:getNearestPalette(a,s);if(f=f||r,!(!f||!f.length)){var h=f[l];return o&&(d[o]=h),c.paletteIdx=(l+1)%f.length,h}}function clearPalette(n,t){t(n).paletteIdx=0,t(n).paletteNameMap={}}var reCreateSeriesIndices,assertSeriesInitialized,initBase,OPTION_INNER_KEY="\0_ec_inner",OPTION_INNER_VALUE=1,GlobalModel=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(r,a,o,u,s,c){u=u||{},this.option=null,this._theme=new Model(u),this._locale=new Model(s),this._optionManager=c},t.prototype.setOption=function(r,a,o){var u=normalizeSetOptionInput(a);this._optionManager.setOption(r,o,u),this._resetOption(null,u)},t.prototype.resetOption=function(r,a){return this._resetOption(r,normalizeSetOptionInput(a))},t.prototype._resetOption=function(r,a){var o=!1,u=this._optionManager;if(!r||r==="recreate"){var s=u.mountOption(r==="recreate");!this.option||r==="recreate"?initBase(this,s):(this.restoreData(),this._mergeOption(s,a)),o=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var c=u.getTimelineOption(this);c&&(o=!0,this._mergeOption(c,a))}if(!r||r==="recreate"||r==="media"){var l=u.getMediaOption(this);l.length&&each$f(l,function(d){o=!0,this._mergeOption(d,a)},this)}return o},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,a){var o=this.option,u=this._componentsMap,s=this._componentsCount,c=[],l=createHashMap(),d=a&&a.replaceMergeMainTypeMap;resetSourceDefaulter(this),each$f(r,function(h,v){h!=null&&(ComponentModel.hasClass(v)?v&&(c.push(v),l.set(v,!0)):o[v]=o[v]==null?clone$5(h):merge$3(o[v],h,!0))}),d&&d.each(function(h,v){ComponentModel.hasClass(v)&&!l.get(v)&&(c.push(v),l.set(v,!0))}),ComponentModel.topologicalTravel(c,ComponentModel.getAllClassMainTypes(),f,this);function f(h){var v=concatInternalOptions(this,h,normalizeToArray(r[h])),g=u.get(h),b=g?d&&d.get(h)?"replaceMerge":"normalMerge":"replaceAll",_=mappingToExists(g,v,b);setComponentTypeToKeyInfo(_,h,ComponentModel),o[h]=null,u.set(h,null),s.set(h,0);var S=[],T=[],w=0,A;each$f(_,function(R,E){var I=R.existing,L=R.newOption;if(!L)I&&(I.mergeOption({},this),I.optionUpdated({},!1));else{var F=h==="series",D=ComponentModel.getClass(h,R.keyInfo.subType,!F);if(!D)return;if(h==="tooltip"){if(A)return;A=!0}if(I&&I.constructor===D)I.name=R.keyInfo.name,I.mergeOption(L,this),I.optionUpdated(L,!1);else{var $=extend$1({componentIndex:E},R.keyInfo);I=new D(L,this,this,$),extend$1(I,$),R.brandNew&&(I.__requireNewView=!0),I.init(L,this,this),I.optionUpdated(null,!0)}}I?(S.push(I.option),T.push(I),w++):(S.push(void 0),T.push(void 0))},this),o[h]=S,u.set(h,T),s.set(h,w),h==="series"&&reCreateSeriesIndices(this)}this._seriesIndices||reCreateSeriesIndices(this)},t.prototype.getOption=function(){var r=clone$5(this.option);return each$f(r,function(a,o){if(ComponentModel.hasClass(o)){for(var u=normalizeToArray(a),s=u.length,c=!1,l=s-1;l>=0;l--)u[l]&&!isComponentIdInternal(u[l])?c=!0:(u[l]=null,!c&&s--);u.length=s,r[o]=u}}),delete r[OPTION_INNER_KEY],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,a){var o=this._componentsMap.get(r);if(o){var u=o[a||0];if(u)return u;if(a==null){for(var s=0;s<o.length;s++)if(o[s])return o[s]}}},t.prototype.queryComponents=function(r){var a=r.mainType;if(!a)return[];var o=r.index,u=r.id,s=r.name,c=this._componentsMap.get(a);if(!c||!c.length)return[];var l;return o!=null?(l=[],each$f(normalizeToArray(o),function(d){c[d]&&l.push(c[d])})):u!=null?l=queryByIdOrName("id",u,c):s!=null?l=queryByIdOrName("name",s,c):l=filter$1(c,function(d){return!!d}),filterBySubType(l,r)},t.prototype.findComponents=function(r){var a=r.query,o=r.mainType,u=c(a),s=u?this.queryComponents(u):filter$1(this._componentsMap.get(o),function(d){return!!d});return l(filterBySubType(s,r));function c(d){var f=o+"Index",h=o+"Id",v=o+"Name";return d&&(d[f]!=null||d[h]!=null||d[v]!=null)?{mainType:o,index:d[f],id:d[h],name:d[v]}:null}function l(d){return r.filter?filter$1(d,r.filter):d}},t.prototype.eachComponent=function(r,a,o){var u=this._componentsMap;if(isFunction$1(r)){var s=a,c=r;u.each(function(h,v){for(var g=0;h&&g<h.length;g++){var b=h[g];b&&c.call(s,v,b,b.componentIndex)}})}else for(var l=isString(r)?u.get(r):isObject$4(r)?this.findComponents(r):null,d=0;l&&d<l.length;d++){var f=l[d];f&&a.call(o,f,f.componentIndex)}},t.prototype.getSeriesByName=function(r){var a=convertOptionIdName(r,null);return filter$1(this._componentsMap.get("series"),function(o){return!!o&&a!=null&&o.name===a})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return filter$1(this._componentsMap.get("series"),function(a){return!!a&&a.subType===r})},t.prototype.getSeries=function(){return filter$1(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,a){assertSeriesInitialized(this),each$f(this._seriesIndices,function(o){var u=this._componentsMap.get("series")[o];r.call(a,u,o)},this)},t.prototype.eachRawSeries=function(r,a){each$f(this._componentsMap.get("series"),function(o){o&&r.call(a,o,o.componentIndex)})},t.prototype.eachSeriesByType=function(r,a,o){assertSeriesInitialized(this),each$f(this._seriesIndices,function(u){var s=this._componentsMap.get("series")[u];s.subType===r&&a.call(o,s,u)},this)},t.prototype.eachRawSeriesByType=function(r,a,o){return each$f(this.getSeriesByType(r),a,o)},t.prototype.isSeriesFiltered=function(r){return assertSeriesInitialized(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,a){assertSeriesInitialized(this);var o=[];each$f(this._seriesIndices,function(u){var s=this._componentsMap.get("series")[u];r.call(a,s,u)&&o.push(u)},this),this._seriesIndices=o,this._seriesIndicesMap=createHashMap(o)},t.prototype.restoreData=function(r){reCreateSeriesIndices(this);var a=this._componentsMap,o=[];a.each(function(u,s){ComponentModel.hasClass(s)&&o.push(s)}),ComponentModel.topologicalTravel(o,ComponentModel.getAllClassMainTypes(),function(u){each$f(a.get(u),function(s){s&&(u!=="series"||!isNotTargetSeries(s,r))&&s.restoreData()})})},t.internalField=function(){reCreateSeriesIndices=function(r){var a=r._seriesIndices=[];each$f(r._componentsMap.get("series"),function(o){o&&a.push(o.componentIndex)}),r._seriesIndicesMap=createHashMap(a)},assertSeriesInitialized=function(r){},initBase=function(r,a){r.option={},r.option[OPTION_INNER_KEY]=OPTION_INNER_VALUE,r._componentsMap=createHashMap({series:[]}),r._componentsCount=createHashMap();var o=a.aria;isObject$4(o)&&o.enabled==null&&(o.enabled=!0),mergeTheme(a,r._theme.option),merge$3(a,globalDefault,!1),r._mergeOption(a,null)}}(),t}(Model);function isNotTargetSeries(n,t){if(t){var r=t.seriesIndex,a=t.seriesId,o=t.seriesName;return r!=null&&n.componentIndex!==r||a!=null&&n.id!==a||o!=null&&n.name!==o}}function mergeTheme(n,t){var r=n.color&&!n.colorLayer;each$f(t,function(a,o){o==="colorLayer"&&r||ComponentModel.hasClass(o)||(typeof a=="object"?n[o]=n[o]?merge$3(n[o],a,!1):clone$5(a):n[o]==null&&(n[o]=a))})}function queryByIdOrName(n,t,r){if(isArray$2(t)){var a=createHashMap();return each$f(t,function(u){if(u!=null){var s=convertOptionIdName(u,null);s!=null&&a.set(u,!0)}}),filter$1(r,function(u){return u&&a.get(u[n])})}else{var o=convertOptionIdName(t,null);return filter$1(r,function(u){return u&&o!=null&&u[n]===o})}}function filterBySubType(n,t){return t.hasOwnProperty("subType")?filter$1(n,function(r){return r&&r.subType===t.subType}):n}function normalizeSetOptionInput(n){var t=createHashMap();return n&&each$f(normalizeToArray(n.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}mixin$1(GlobalModel,PaletteMixin);var availableMethods=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],ExtensionAPI=function(){function n(t){each$f(availableMethods,function(r){this[r]=bind$1(t[r],t)},this)}return n}(),coordinateSystemCreators={},CoordinateSystemManager=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(t,r){var a=[];each$f(coordinateSystemCreators,function(o,u){var s=o.create(t,r);a=a.concat(s||[])}),this._coordinateSystems=a},n.prototype.update=function(t,r){each$f(this._coordinateSystems,function(a){a.update&&a.update(t,r)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(t,r){coordinateSystemCreators[t]=r},n.get=function(t){return coordinateSystemCreators[t]},n}(),QUERY_REG=/^(min|max)?(.+)$/,OptionManager=function(){function n(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return n.prototype.setOption=function(t,r,a){t&&(each$f(normalizeToArray(t.series),function(s){s&&s.data&&isTypedArray(s.data)&&setAsPrimitive(s.data)}),each$f(normalizeToArray(t.dataset),function(s){s&&s.source&&isTypedArray(s.source)&&setAsPrimitive(s.source)})),t=clone$5(t);var o=this._optionBackup,u=parseRawOption(t,r,!o);this._newBaseOption=u.baseOption,o?(u.timelineOptions.length&&(o.timelineOptions=u.timelineOptions),u.mediaList.length&&(o.mediaList=u.mediaList),u.mediaDefault&&(o.mediaDefault=u.mediaDefault)):this._optionBackup=u},n.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],clone$5(t?r.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(t){var r,a=this._timelineOptions;if(a.length){var o=t.getComponent("timeline");o&&(r=clone$5(a[o.getCurrentIndex()]))}return r},n.prototype.getMediaOption=function(t){var r=this._api.getWidth(),a=this._api.getHeight(),o=this._mediaList,u=this._mediaDefault,s=[],c=[];if(!o.length&&!u)return c;for(var l=0,d=o.length;l<d;l++)applyMediaQuery(o[l].query,r,a)&&s.push(l);return!s.length&&u&&(s=[-1]),s.length&&!indicesEquals(s,this._currentMediaIndices)&&(c=map$1(s,function(f){return clone$5(f===-1?u.option:o[f].option)})),this._currentMediaIndices=s,c},n}();function parseRawOption(n,t,r){var a=[],o,u,s=n.baseOption,c=n.timeline,l=n.options,d=n.media,f=!!n.media,h=!!(l||c||s&&s.timeline);s?(u=s,u.timeline||(u.timeline=c)):((h||f)&&(n.options=n.media=null),u=n),f&&isArray$2(d)&&each$f(d,function(g){g&&g.option&&(g.query?a.push(g):o||(o=g))}),v(u),each$f(l,function(g){return v(g)}),each$f(a,function(g){return v(g.option)});function v(g){each$f(t,function(b){b(g,r)})}return{baseOption:u,timelineOptions:l||[],mediaDefault:o,mediaList:a}}function applyMediaQuery(n,t,r){var a={width:t,height:r,aspectratio:t/r},o=!0;return each$f(n,function(u,s){var c=s.match(QUERY_REG);if(!(!c||!c[1]||!c[2])){var l=c[1],d=c[2].toLowerCase();compare(a[d],u,l)||(o=!1)}}),o}function compare(n,t,r){return r==="min"?n>=t:r==="max"?n<=t:n===t}function indicesEquals(n,t){return n.join(",")===t.join(",")}var each$d=each$f,isObject$3=isObject$4,POSSIBLE_STYLES=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function compatEC2ItemStyle(n){var t=n&&n.itemStyle;if(t)for(var r=0,a=POSSIBLE_STYLES.length;r<a;r++){var o=POSSIBLE_STYLES[r],u=t.normal,s=t.emphasis;u&&u[o]&&(n[o]=n[o]||{},n[o].normal?merge$3(n[o].normal,u[o]):n[o].normal=u[o],u[o]=null),s&&s[o]&&(n[o]=n[o]||{},n[o].emphasis?merge$3(n[o].emphasis,s[o]):n[o].emphasis=s[o],s[o]=null)}}function convertNormalEmphasis(n,t,r){if(n&&n[t]&&(n[t].normal||n[t].emphasis)){var a=n[t].normal,o=n[t].emphasis;a&&(r?(n[t].normal=n[t].emphasis=null,defaults$h(n[t],a)):n[t]=a),o&&(n.emphasis=n.emphasis||{},n.emphasis[t]=o,o.focus&&(n.emphasis.focus=o.focus),o.blurScope&&(n.emphasis.blurScope=o.blurScope))}}function removeEC3NormalStatus(n){convertNormalEmphasis(n,"itemStyle"),convertNormalEmphasis(n,"lineStyle"),convertNormalEmphasis(n,"areaStyle"),convertNormalEmphasis(n,"label"),convertNormalEmphasis(n,"labelLine"),convertNormalEmphasis(n,"upperLabel"),convertNormalEmphasis(n,"edgeLabel")}function compatTextStyle(n,t){var r=isObject$3(n)&&n[t],a=isObject$3(r)&&r.textStyle;if(a)for(var o=0,u=TEXT_STYLE_OPTIONS.length;o<u;o++){var s=TEXT_STYLE_OPTIONS[o];a.hasOwnProperty(s)&&(r[s]=a[s])}}function compatEC3CommonStyles(n){n&&(removeEC3NormalStatus(n),compatTextStyle(n,"label"),n.emphasis&&compatTextStyle(n.emphasis,"label"))}function processSeries(n){if(isObject$3(n)){compatEC2ItemStyle(n),removeEC3NormalStatus(n),compatTextStyle(n,"label"),compatTextStyle(n,"upperLabel"),compatTextStyle(n,"edgeLabel"),n.emphasis&&(compatTextStyle(n.emphasis,"label"),compatTextStyle(n.emphasis,"upperLabel"),compatTextStyle(n.emphasis,"edgeLabel"));var t=n.markPoint;t&&(compatEC2ItemStyle(t),compatEC3CommonStyles(t));var r=n.markLine;r&&(compatEC2ItemStyle(r),compatEC3CommonStyles(r));var a=n.markArea;a&&compatEC3CommonStyles(a);var o=n.data;if(n.type==="graph"){o=o||n.nodes;var u=n.links||n.edges;if(u&&!isTypedArray(u))for(var s=0;s<u.length;s++)compatEC3CommonStyles(u[s]);each$f(n.categories,function(d){removeEC3NormalStatus(d)})}if(o&&!isTypedArray(o))for(var s=0;s<o.length;s++)compatEC3CommonStyles(o[s]);if(t=n.markPoint,t&&t.data)for(var c=t.data,s=0;s<c.length;s++)compatEC3CommonStyles(c[s]);if(r=n.markLine,r&&r.data)for(var l=r.data,s=0;s<l.length;s++)isArray$2(l[s])?(compatEC3CommonStyles(l[s][0]),compatEC3CommonStyles(l[s][1])):compatEC3CommonStyles(l[s]);n.type==="gauge"?(compatTextStyle(n,"axisLabel"),compatTextStyle(n,"title"),compatTextStyle(n,"detail")):n.type==="treemap"?(convertNormalEmphasis(n.breadcrumb,"itemStyle"),each$f(n.levels,function(d){removeEC3NormalStatus(d)})):n.type==="tree"&&removeEC3NormalStatus(n.leaves)}}function toArr(n){return isArray$2(n)?n:n?[n]:[]}function toObj(n){return(isArray$2(n)?n[0]:n)||{}}function globalCompatStyle(n,t){each$d(toArr(n.series),function(a){isObject$3(a)&&processSeries(a)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),each$d(r,function(a){each$d(toArr(n[a]),function(o){o&&(compatTextStyle(o,"axisLabel"),compatTextStyle(o.axisPointer,"label"))})}),each$d(toArr(n.parallel),function(a){var o=a&&a.parallelAxisDefault;compatTextStyle(o,"axisLabel"),compatTextStyle(o&&o.axisPointer,"label")}),each$d(toArr(n.calendar),function(a){convertNormalEmphasis(a,"itemStyle"),compatTextStyle(a,"dayLabel"),compatTextStyle(a,"monthLabel"),compatTextStyle(a,"yearLabel")}),each$d(toArr(n.radar),function(a){compatTextStyle(a,"name"),a.name&&a.axisName==null&&(a.axisName=a.name,delete a.name),a.nameGap!=null&&a.axisNameGap==null&&(a.axisNameGap=a.nameGap,delete a.nameGap)}),each$d(toArr(n.geo),function(a){isObject$3(a)&&(compatEC3CommonStyles(a),each$d(toArr(a.regions),function(o){compatEC3CommonStyles(o)}))}),each$d(toArr(n.timeline),function(a){compatEC3CommonStyles(a),convertNormalEmphasis(a,"label"),convertNormalEmphasis(a,"itemStyle"),convertNormalEmphasis(a,"controlStyle",!0);var o=a.data;isArray$2(o)&&each$f(o,function(u){isObject$4(u)&&(convertNormalEmphasis(u,"label"),convertNormalEmphasis(u,"itemStyle"))})}),each$d(toArr(n.toolbox),function(a){convertNormalEmphasis(a,"iconStyle"),each$d(a.feature,function(o){convertNormalEmphasis(o,"iconStyle")})}),compatTextStyle(toObj(n.axisPointer),"label"),compatTextStyle(toObj(n.tooltip).axisPointer,"label")}function get$2(n,t){for(var r=t.split(","),a=n,o=0;o<r.length&&(a=a&&a[r[o]],a!=null);o++);return a}function set$2(n,t,r,a){for(var o=t.split(","),u=n,s,c=0;c<o.length-1;c++)s=o[c],u[s]==null&&(u[s]={}),u=u[s];u[o[c]]==null&&(u[o[c]]=r)}function compatLayoutProperties(n){n&&each$f(LAYOUT_PROPERTIES,function(t){t[0]in n&&!(t[1]in n)&&(n[t[1]]=n[t[0]])})}var LAYOUT_PROPERTIES=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],COMPATITABLE_COMPONENTS=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],BAR_ITEM_STYLE_MAP=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function compatBarItemStyle(n){var t=n&&n.itemStyle;if(t)for(var r=0;r<BAR_ITEM_STYLE_MAP.length;r++){var a=BAR_ITEM_STYLE_MAP[r][1],o=BAR_ITEM_STYLE_MAP[r][0];t[a]!=null&&(t[o]=t[a])}}function compatPieLabel(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function compatSunburstState(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function compatGraphFocus(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function traverseTree(n,t){if(n)for(var r=0;r<n.length;r++)t(n[r]),n[r]&&traverseTree(n[r].children,t)}function globalBackwardCompat(n,t){globalCompatStyle(n,t),n.series=normalizeToArray(n.series),each$f(n.series,function(r){if(isObject$4(r)){var a=r.type;if(a==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(a==="pie"||a==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),compatPieLabel(r.label);var o=r.data;if(o&&!isTypedArray(o))for(var u=0;u<o.length;u++)compatPieLabel(o[u]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(a==="gauge"){var s=get$2(r,"pointer.color");s!=null&&set$2(r,"itemStyle.color",s)}else if(a==="bar"){compatBarItemStyle(r),compatBarItemStyle(r.backgroundStyle),compatBarItemStyle(r.emphasis);var o=r.data;if(o&&!isTypedArray(o))for(var u=0;u<o.length;u++)typeof o[u]=="object"&&(compatBarItemStyle(o[u]),compatBarItemStyle(o[u]&&o[u].emphasis))}else if(a==="sunburst"){var c=r.highlightPolicy;c&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=c)),compatSunburstState(r),traverseTree(r.data,compatSunburstState)}else a==="graph"||a==="sankey"?compatGraphFocus(r):a==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&defaults$h(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),compatLayoutProperties(r)}}),n.dataRange&&(n.visualMap=n.dataRange),each$f(COMPATITABLE_COMPONENTS,function(r){var a=n[r];a&&(isArray$2(a)||(a=[a]),each$f(a,function(o){compatLayoutProperties(o)}))})}function dataStack(n){var t=createHashMap();n.eachSeries(function(r){var a=r.get("stack");if(a){var o=t.get(a)||t.set(a,[]),u=r.getData(),s={stackResultDimension:u.getCalculationInfo("stackResultDimension"),stackedOverDimension:u.getCalculationInfo("stackedOverDimension"),stackedDimension:u.getCalculationInfo("stackedDimension"),stackedByDimension:u.getCalculationInfo("stackedByDimension"),isStackedByIndex:u.getCalculationInfo("isStackedByIndex"),data:u,seriesModel:r};if(!s.stackedDimension||!(s.isStackedByIndex||s.stackedByDimension))return;o.length&&u.setCalculationInfo("stackedOnSeries",o[o.length-1].seriesModel),o.push(s)}}),t.each(calculateStack)}function calculateStack(n){each$f(n,function(t,r){var a=[],o=[NaN,NaN],u=[t.stackResultDimension,t.stackedOverDimension],s=t.data,c=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";s.modify(u,function(d,f,h){var v=s.get(t.stackedDimension,h);if(isNaN(v))return o;var g,b;c?b=s.getRawIndex(h):g=s.get(t.stackedByDimension,h);for(var _=NaN,S=r-1;S>=0;S--){var T=n[S];if(c||(b=T.data.rawIndexOf(T.stackedByDimension,g)),b>=0){var w=T.data.getByRawIndex(T.stackResultDimension,b);if(l==="all"||l==="positive"&&w>0||l==="negative"&&w<0||l==="samesign"&&v>=0&&w>0||l==="samesign"&&v<=0&&w<0){v=addSafe(v,w),_=w;break}}}return a[0]=v,a[1]=_,a})})}var SourceImpl=function(){function n(t){this.data=t.data||(t.sourceFormat===SOURCE_FORMAT_KEYED_COLUMNS?{}:[]),this.sourceFormat=t.sourceFormat||SOURCE_FORMAT_UNKNOWN,this.seriesLayoutBy=t.seriesLayoutBy||SERIES_LAYOUT_BY_COLUMN,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var a=0;a<r.length;a++){var o=r[a];o.type==null&&guessOrdinal(this,a)===BE_ORDINAL.Must&&(o.type="ordinal")}}return n}();function isSourceInstance(n){return n instanceof SourceImpl}function createSource(n,t,r){r=r||detectSourceFormat(n);var a=t.seriesLayoutBy,o=determineSourceDimensions(n,r,a,t.sourceHeader,t.dimensions),u=new SourceImpl({data:n,sourceFormat:r,seriesLayoutBy:a,dimensionsDefine:o.dimensionsDefine,startIndex:o.startIndex,dimensionsDetectedCount:o.dimensionsDetectedCount,metaRawOption:clone$5(t)});return u}function createSourceFromSeriesDataOption(n){return new SourceImpl({data:n,sourceFormat:isTypedArray(n)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL})}function cloneSourceShallow(n){return new SourceImpl({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:clone$5(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function detectSourceFormat(n){var t=SOURCE_FORMAT_UNKNOWN;if(isTypedArray(n))t=SOURCE_FORMAT_TYPED_ARRAY;else if(isArray$2(n)){n.length===0&&(t=SOURCE_FORMAT_ARRAY_ROWS);for(var r=0,a=n.length;r<a;r++){var o=n[r];if(o!=null){if(isArray$2(o)||isTypedArray(o)){t=SOURCE_FORMAT_ARRAY_ROWS;break}else if(isObject$4(o)){t=SOURCE_FORMAT_OBJECT_ROWS;break}}}}else if(isObject$4(n)){for(var u in n)if(hasOwn(n,u)&&isArrayLike$1(n[u])){t=SOURCE_FORMAT_KEYED_COLUMNS;break}}return t}function determineSourceDimensions(n,t,r,a,o){var u,s;if(!n)return{dimensionsDefine:normalizeDimensionsOption(o),startIndex:s,dimensionsDetectedCount:u};if(t===SOURCE_FORMAT_ARRAY_ROWS){var c=n;a==="auto"||a==null?arrayRowsTravelFirst(function(d){d!=null&&d!=="-"&&(isString(d)?s==null&&(s=1):s=0)},r,c,10):s=isNumber(a)?a:a?1:0,!o&&s===1&&(o=[],arrayRowsTravelFirst(function(d,f){o[f]=d!=null?d+"":""},r,c,1/0)),u=o?o.length:r===SERIES_LAYOUT_BY_ROW?c.length:c[0]?c[0].length:null}else if(t===SOURCE_FORMAT_OBJECT_ROWS)o||(o=objectRowsCollectDimensions(n));else if(t===SOURCE_FORMAT_KEYED_COLUMNS)o||(o=[],each$f(n,function(d,f){o.push(f)}));else if(t===SOURCE_FORMAT_ORIGINAL){var l=getDataItemValue(n[0]);u=isArray$2(l)&&l.length||1}return{startIndex:s,dimensionsDefine:normalizeDimensionsOption(o),dimensionsDetectedCount:u}}function objectRowsCollectDimensions(n){for(var t=0,r;t<n.length&&!(r=n[t++]););if(r)return keys(r)}function normalizeDimensionsOption(n){if(n){var t=createHashMap();return map$1(n,function(r,a){r=isObject$4(r)?r:{name:r};var o={name:r.name,displayName:r.displayName,type:r.type};if(o.name==null)return o;o.name+="",o.displayName==null&&(o.displayName=o.name);var u=t.get(o.name);return u?o.name+="-"+u.count++:t.set(o.name,{count:1}),o})}}function arrayRowsTravelFirst(n,t,r,a){if(t===SERIES_LAYOUT_BY_ROW)for(var o=0;o<r.length&&o<a;o++)n(r[o]?r[o][0]:null,o);else for(var u=r[0]||[],o=0;o<u.length&&o<a;o++)n(u[o],o)}function shouldRetrieveDataByName(n){var t=n.sourceFormat;return t===SOURCE_FORMAT_OBJECT_ROWS||t===SOURCE_FORMAT_KEYED_COLUMNS}var _a,_b,_c,providerMethods,mountMethods,DefaultDataProvider=function(){function n(t,r){var a=isSourceInstance(t)?t:createSourceFromSeriesDataOption(t);this._source=a;var o=this._data=a.data;a.sourceFormat===SOURCE_FORMAT_TYPED_ARRAY&&(this._offset=0,this._dimSize=r,this._data=o),mountMethods(this,o,a)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(t,r){},n.prototype.appendData=function(t){},n.prototype.clean=function(){},n.protoInitialize=function(){var t=n.prototype;t.pure=!1,t.persistent=!0}(),n.internalField=function(){var t;mountMethods=function(s,c,l){var d=l.sourceFormat,f=l.seriesLayoutBy,h=l.startIndex,v=l.dimensionsDefine,g=providerMethods[getMethodMapKey(d,f)];if(extend$1(s,g),d===SOURCE_FORMAT_TYPED_ARRAY)s.getItem=r,s.count=o,s.fillStorage=a;else{var b=getRawSourceItemGetter(d,f);s.getItem=bind$1(b,null,c,h,v);var _=getRawSourceDataCounter(d,f);s.count=bind$1(_,null,c,h,v)}};var r=function(s,c){s=s-this._offset,c=c||[];for(var l=this._data,d=this._dimSize,f=d*s,h=0;h<d;h++)c[h]=l[f+h];return c},a=function(s,c,l,d){for(var f=this._data,h=this._dimSize,v=0;v<h;v++){for(var g=d[v],b=g[0]==null?1/0:g[0],_=g[1]==null?-1/0:g[1],S=c-s,T=l[v],w=0;w<S;w++){var A=f[w*h+v];T[s+w]=A,A<b&&(b=A),A>_&&(_=A)}g[0]=b,g[1]=_}},o=function(){return this._data?this._data.length/this._dimSize:0};providerMethods=(t={},t[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]={pure:!0,appendData:u},t[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[SOURCE_FORMAT_OBJECT_ROWS]={pure:!0,appendData:u},t[SOURCE_FORMAT_KEYED_COLUMNS]={pure:!0,appendData:function(s){var c=this._data;each$f(s,function(l,d){for(var f=c[d]||(c[d]=[]),h=0;h<(l||[]).length;h++)f.push(l[h])})}},t[SOURCE_FORMAT_ORIGINAL]={appendData:u},t[SOURCE_FORMAT_TYPED_ARRAY]={persistent:!1,pure:!0,appendData:function(s){this._data=s},clean:function(){this._offset+=this.count(),this._data=null}},t);function u(s){for(var c=0;c<s.length;c++)this._data.push(s[c])}}(),n}(),getItemSimply=function(n,t,r,a){return n[a]},rawSourceItemGetterMap=(_a={},_a[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(n,t,r,a){return n[a+t]},_a[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(n,t,r,a,o){a+=t;for(var u=o||[],s=n,c=0;c<s.length;c++){var l=s[c];u[c]=l?l[a]:null}return u},_a[SOURCE_FORMAT_OBJECT_ROWS]=getItemSimply,_a[SOURCE_FORMAT_KEYED_COLUMNS]=function(n,t,r,a,o){for(var u=o||[],s=0;s<r.length;s++){var c=r[s].name,l=n[c];u[s]=l?l[a]:null}return u},_a[SOURCE_FORMAT_ORIGINAL]=getItemSimply,_a);function getRawSourceItemGetter(n,t){var r=rawSourceItemGetterMap[getMethodMapKey(n,t)];return r}var countSimply=function(n,t,r){return n.length},rawSourceDataCounterMap=(_b={},_b[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_COLUMN]=function(n,t,r){return Math.max(0,n.length-t)},_b[SOURCE_FORMAT_ARRAY_ROWS+"_"+SERIES_LAYOUT_BY_ROW]=function(n,t,r){var a=n[0];return a?Math.max(0,a.length-t):0},_b[SOURCE_FORMAT_OBJECT_ROWS]=countSimply,_b[SOURCE_FORMAT_KEYED_COLUMNS]=function(n,t,r){var a=r[0].name,o=n[a];return o?o.length:0},_b[SOURCE_FORMAT_ORIGINAL]=countSimply,_b);function getRawSourceDataCounter(n,t){var r=rawSourceDataCounterMap[getMethodMapKey(n,t)];return r}var getRawValueSimply=function(n,t,r){return n[t]},rawSourceValueGetterMap=(_c={},_c[SOURCE_FORMAT_ARRAY_ROWS]=getRawValueSimply,_c[SOURCE_FORMAT_OBJECT_ROWS]=function(n,t,r){return n[r]},_c[SOURCE_FORMAT_KEYED_COLUMNS]=getRawValueSimply,_c[SOURCE_FORMAT_ORIGINAL]=function(n,t,r){var a=getDataItemValue(n);return a instanceof Array?a[t]:a},_c[SOURCE_FORMAT_TYPED_ARRAY]=getRawValueSimply,_c);function getRawSourceValueGetter(n){var t=rawSourceValueGetterMap[n];return t}function getMethodMapKey(n,t){return n===SOURCE_FORMAT_ARRAY_ROWS?n+"_"+t:n}function retrieveRawValue(n,t,r){if(n){var a=n.getRawDataItem(t);if(a!=null){var o=n.getStore(),u=o.getSource().sourceFormat;if(r!=null){var s=n.getDimensionIndex(r),c=o.getDimensionProperty(s);return getRawSourceValueGetter(u)(a,s,c)}else{var l=a;return u===SOURCE_FORMAT_ORIGINAL&&(l=getDataItemValue(a)),l}}}}var DIMENSION_LABEL_REG=/\{@(.+?)\}/g,DataFormatMixin=function(){function n(){}return n.prototype.getDataParams=function(t,r){var a=this.getData(r),o=this.getRawValue(t,r),u=a.getRawIndex(t),s=a.getName(t),c=a.getRawDataItem(t),l=a.getItemVisual(t,"style"),d=l&&l[a.getItemVisual(t,"drawType")||"fill"],f=l&&l.stroke,h=this.mainType,v=h==="series",g=a.userOutput&&a.userOutput.get();return{componentType:h,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:v?this.subType:null,seriesIndex:this.seriesIndex,seriesId:v?this.id:null,seriesName:v?this.name:null,name:s,dataIndex:u,data:c,dataType:r,value:o,color:d,borderColor:f,dimensionNames:g?g.fullDimensions:null,encode:g?g.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(t,r,a,o,u,s){r=r||"normal";var c=this.getData(a),l=this.getDataParams(t,a);if(s&&(l.value=s.interpolatedValue),o!=null&&isArray$2(l.value)&&(l.value=l.value[o]),!u){var d=c.getItemModel(t);u=d.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(isFunction$1(u))return l.status=r,l.dimensionIndex=o,u(l);if(isString(u)){var f=formatTpl(u,l);return f.replace(DIMENSION_LABEL_REG,function(h,v){var g=v.length,b=v;b.charAt(0)==="["&&b.charAt(g-1)==="]"&&(b=+b.slice(1,g-1));var _=retrieveRawValue(c,t,b);if(s&&isArray$2(s.interpolatedValue)){var S=c.getDimensionIndex(b);S>=0&&(_=s.interpolatedValue[S])}return _!=null?_+"":""})}},n.prototype.getRawValue=function(t,r){return retrieveRawValue(this.getData(r),t)},n.prototype.formatTooltip=function(t,r,a){},n}();function normalizeTooltipFormatResult(n){var t,r;return isObject$4(n)?n.type&&(r=n):t=n,{text:t,frag:r}}function createTask(n){return new Task(n)}var Task=function(){function n(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return n.prototype.perform=function(t){var r=this._upstream,a=t&&t.skip;if(this._dirty&&r){var o=this.context;o.data=o.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var u;this._plan&&!a&&(u=this._plan(this.context));var s=f(this._modBy),c=this._modDataCount||0,l=f(t&&t.modBy),d=t&&t.modDataCount||0;(s!==l||c!==d)&&(u="reset");function f(w){return!(w>=1)&&(w=1),w}var h;(this._dirty||u==="reset")&&(this._dirty=!1,h=this._doReset(a)),this._modBy=l,this._modDataCount=d;var v=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var g=this._dueIndex,b=Math.min(v!=null?this._dueIndex+v:1/0,this._dueEnd);if(!a&&(h||g<b)){var _=this._progress;if(isArray$2(_))for(var S=0;S<_.length;S++)this._doProgress(_[S],g,b,l,d);else this._doProgress(_,g,b,l,d)}this._dueIndex=b;var T=this._settedOutputEnd!=null?this._settedOutputEnd:b;this._outputDueEnd=T}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(t,r,a,o,u){iterator.reset(r,a,o,u),this._callingProgress=t,this._callingProgress({start:r,end:a,count:a-r,next:iterator.next},this.context)},n.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,a;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(a=r.forceFirstProgress,r=r.progress),isArray$2(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var o=this._downstream;return o&&o.dirty(),a},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},n}(),iterator=function(){var n,t,r,a,o,u={reset:function(l,d,f,h){t=l,n=d,r=f,a=h,o=Math.ceil(a/r),u.next=r>1&&a>0?c:s}};return u;function s(){return t<n?t++:null}function c(){var l=t%o*r+Math.ceil(t/o),d=t>=n?null:l<a?l:t;return t++,d}}();function parseDataValue(n,t){var r=t&&t.type;return r==="ordinal"?n:(r==="time"&&!isNumber(n)&&n!=null&&n!=="-"&&(n=+parseDate(n)),n==null||n===""?NaN:Number(n))}var valueParserMap=createHashMap({number:function(n){return parseFloat(n)},time:function(n){return+parseDate(n)},trim:function(n){return isString(n)?trim$1(n):n}});function getRawValueParser(n){return valueParserMap.get(n)}var ORDER_COMPARISON_OP_MAP={lt:function(n,t){return n<t},lte:function(n,t){return n<=t},gt:function(n,t){return n>t},gte:function(n,t){return n>=t}},FilterOrderComparator=function(){function n(t,r){if(!isNumber(r)){var a="";throwError(a)}this._opFn=ORDER_COMPARISON_OP_MAP[t],this._rvalFloat=numericToNumber(r)}return n.prototype.evaluate=function(t){return isNumber(t)?this._opFn(t,this._rvalFloat):this._opFn(numericToNumber(t),this._rvalFloat)},n}(),SortOrderComparator=function(){function n(t,r){var a=t==="desc";this._resultLT=a?1:-1,r==null&&(r=a?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return n.prototype.evaluate=function(t,r){var a=isNumber(t)?t:numericToNumber(t),o=isNumber(r)?r:numericToNumber(r),u=isNaN(a),s=isNaN(o);if(u&&(a=this._incomparable),s&&(o=this._incomparable),u&&s){var c=isString(t),l=isString(r);c&&(a=l?t:0),l&&(o=c?r:0)}return a<o?this._resultLT:a>o?-this._resultLT:0},n}(),FilterEqualityComparator=function(){function n(t,r){this._rval=r,this._isEQ=t,this._rvalTypeof=typeof r,this._rvalFloat=numericToNumber(r)}return n.prototype.evaluate=function(t){var r=t===this._rval;if(!r){var a=typeof t;a!==this._rvalTypeof&&(a==="number"||this._rvalTypeof==="number")&&(r=numericToNumber(t)===this._rvalFloat)}return this._isEQ?r:!r},n}();function createFilterComparator(n,t){return n==="eq"||n==="ne"?new FilterEqualityComparator(n==="eq",t):hasOwn(ORDER_COMPARISON_OP_MAP,n)?new FilterOrderComparator(n,t):null}var ExternalSource=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(t){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(t){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(t,r){},n.prototype.retrieveValueFromItem=function(t,r){},n.prototype.convertValue=function(t,r){return parseDataValue(t,r)},n}();function createExternalSource(n,t){var r=new ExternalSource,a=n.data,o=r.sourceFormat=n.sourceFormat,u=n.startIndex,s="";n.seriesLayoutBy!==SERIES_LAYOUT_BY_COLUMN&&throwError(s);var c=[],l={},d=n.dimensionsDefine;if(d)each$f(d,function(_,S){var T=_.name,w={index:S,name:T,displayName:_.displayName};if(c.push(w),T!=null){var A="";hasOwn(l,T)&&throwError(A),l[T]=w}});else for(var f=0;f<n.dimensionsDetectedCount;f++)c.push({index:f});var h=getRawSourceItemGetter(o,SERIES_LAYOUT_BY_COLUMN);t.__isBuiltIn&&(r.getRawDataItem=function(_){return h(a,u,c,_)},r.getRawData=bind$1(getRawData,null,n)),r.cloneRawData=bind$1(cloneRawData,null,n);var v=getRawSourceDataCounter(o,SERIES_LAYOUT_BY_COLUMN);r.count=bind$1(v,null,a,u,c);var g=getRawSourceValueGetter(o);r.retrieveValue=function(_,S){var T=h(a,u,c,_);return b(T,S)};var b=r.retrieveValueFromItem=function(_,S){if(_!=null){var T=c[S];if(T)return g(_,S,T.name)}};return r.getDimensionInfo=bind$1(getDimensionInfo,null,c,l),r.cloneAllDimensionInfo=bind$1(cloneAllDimensionInfo,null,c),r}function getRawData(n){var t=n.sourceFormat;if(!isSupportedSourceFormat(t)){var r="";throwError(r)}return n.data}function cloneRawData(n){var t=n.sourceFormat,r=n.data;if(!isSupportedSourceFormat(t)){var a="";throwError(a)}if(t===SOURCE_FORMAT_ARRAY_ROWS){for(var o=[],u=0,s=r.length;u<s;u++)o.push(r[u].slice());return o}else if(t===SOURCE_FORMAT_OBJECT_ROWS){for(var o=[],u=0,s=r.length;u<s;u++)o.push(extend$1({},r[u]));return o}}function getDimensionInfo(n,t,r){if(r!=null){if(isNumber(r)||!isNaN(r)&&!hasOwn(t,r))return n[r];if(hasOwn(t,r))return t[r]}}function cloneAllDimensionInfo(n){return clone$5(n)}var externalTransformMap=createHashMap();function registerExternalTransform(n){n=clone$5(n);var t=n.type,r="";t||throwError(r);var a=t.split(":");a.length!==2&&throwError(r);var o=!1;a[0]==="echarts"&&(t=a[1],o=!0),n.__isBuiltIn=o,externalTransformMap.set(t,n)}function applyDataTransform(n,t,r){var a=normalizeToArray(n),o=a.length,u="";o||throwError(u);for(var s=0,c=o;s<c;s++){var l=a[s];t=applySingleDataTransform(l,t),s!==c-1&&(t.length=Math.max(t.length,1))}return t}function applySingleDataTransform(n,t,r,a){var o="";t.length||throwError(o),isObject$4(n)||throwError(o);var u=n.type,s=externalTransformMap.get(u);s||throwError(o);var c=map$1(t,function(d){return createExternalSource(d,s)}),l=normalizeToArray(s.transform({upstream:c[0],upstreamList:c,config:clone$5(n.config)}));return map$1(l,function(d,f){var h="";isObject$4(d)||throwError(h),d.data||throwError(h);var v=detectSourceFormat(d.data);isSupportedSourceFormat(v)||throwError(h);var g,b=t[0];if(b&&f===0&&!d.dimensions){var _=b.startIndex;_&&(d.data=b.data.slice(0,_).concat(d.data)),g={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:_,dimensions:b.metaRawOption.dimensions}}else g={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN,sourceHeader:0,dimensions:d.dimensions};return createSource(d.data,g,null)})}function isSupportedSourceFormat(n){return n===SOURCE_FORMAT_ARRAY_ROWS||n===SOURCE_FORMAT_OBJECT_ROWS}var UNDEFINED="undefined",CtorUint32Array=typeof Uint32Array===UNDEFINED?Array:Uint32Array,CtorUint16Array=typeof Uint16Array===UNDEFINED?Array:Uint16Array,CtorInt32Array$1=typeof Int32Array===UNDEFINED?Array:Int32Array,CtorFloat64Array=typeof Float64Array===UNDEFINED?Array:Float64Array,dataCtors={float:CtorFloat64Array,int:CtorInt32Array$1,ordinal:Array,number:Array,time:CtorFloat64Array},defaultDimValueGetters;function getIndicesCtor(n){return n>65535?CtorUint32Array:CtorUint16Array}function getInitialExtent(){return[1/0,-1/0]}function cloneChunk(n){var t=n.constructor;return t===Array?n.slice():new t(n)}function prepareStore(n,t,r,a,o){var u=dataCtors[r||"float"];if(o){var s=n[t],c=s&&s.length;if(c!==a){for(var l=new u(a),d=0;d<c;d++)l[d]=s[d];n[t]=l}}else n[t]=new u(a)}var DataStore=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=createHashMap()}return n.prototype.initData=function(t,r,a){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var o=t.getSource(),u=this.defaultDimValueGetter=defaultDimValueGetters[o.sourceFormat];this._dimValueGetter=a||u,this._rawExtent=[],shouldRetrieveDataByName(o),this._dimensions=map$1(r,function(s){return{type:s.type,property:s.property}}),this._initDataFromProvider(0,t.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(t,r){var a=this._calcDimNameToIdx,o=this._dimensions,u=a.get(t);if(u!=null){if(o[u].type===r)return u}else u=o.length;return o[u]={type:r},a.set(t,u),this._chunks[u]=new dataCtors[r||"float"](this._rawCount),this._rawExtent[u]=getInitialExtent(),u},n.prototype.collectOrdinalMeta=function(t,r){var a=this._chunks[t],o=this._dimensions[t],u=this._rawExtent,s=o.ordinalOffset||0,c=a.length;s===0&&(u[t]=getInitialExtent());for(var l=u[t],d=s;d<c;d++){var f=a[d]=r.parseAndCollect(a[d]);isNaN(f)||(l[0]=Math.min(f,l[0]),l[1]=Math.max(f,l[1]))}o.ordinalMeta=r,o.ordinalOffset=c,o.type="ordinal"},n.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],a=r.ordinalMeta;return a},n.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},n.prototype.appendData=function(t){var r=this._provider,a=this.count();r.appendData(t);var o=r.count();return r.persistent||(o+=a),a<o&&this._initDataFromProvider(a,o,!0),[a,o]},n.prototype.appendValues=function(t,r){for(var a=this._chunks,o=this._dimensions,u=o.length,s=this._rawExtent,c=this.count(),l=c+Math.max(t.length,r||0),d=0;d<u;d++){var f=o[d];prepareStore(a,d,f.type,l,!0)}for(var h=[],v=c;v<l;v++)for(var g=v-c,b=0;b<u;b++){var f=o[b],_=defaultDimValueGetters.arrayRows.call(this,t[g]||h,f.property,g,b);a[b][v]=_;var S=s[b];_<S[0]&&(S[0]=_),_>S[1]&&(S[1]=_)}return this._rawCount=this._count=l,{start:c,end:l}},n.prototype._initDataFromProvider=function(t,r,a){for(var o=this._provider,u=this._chunks,s=this._dimensions,c=s.length,l=this._rawExtent,d=map$1(s,function(w){return w.property}),f=0;f<c;f++){var h=s[f];l[f]||(l[f]=getInitialExtent()),prepareStore(u,f,h.type,r,a)}if(o.fillStorage)o.fillStorage(t,r,u,l);else for(var v=[],g=t;g<r;g++){v=o.getItem(g,v);for(var b=0;b<c;b++){var _=u[b],S=this._dimValueGetter(v,d[b],g,b);_[g]=S;var T=l[b];S<T[0]&&(T[0]=S),S>T[1]&&(T[1]=S)}}!o.persistent&&o.clean&&o.clean(),this._rawCount=this._count=r,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var a=this._chunks[t];return a?a[this.getRawIndex(r)]:NaN},n.prototype.getValues=function(t,r){var a=[],o=[];if(r==null){r=t,t=[];for(var u=0;u<this._dimensions.length;u++)o.push(u)}else o=t;for(var u=0,s=o.length;u<s;u++)a.push(this.get(o[u],r));return a},n.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var a=this._chunks[t];return a?a[r]:NaN},n.prototype.getSum=function(t){var r=this._chunks[t],a=0;if(r)for(var o=0,u=this.count();o<u;o++){var s=this.get(t,o);isNaN(s)||(a+=s)}return a},n.prototype.getMedian=function(t){var r=[];this.each([t],function(u){isNaN(u)||r.push(u)});var a=r.sort(function(u,s){return u-s}),o=this.count();return o===0?0:o%2===1?a[(o-1)/2]:(a[o/2]+a[o/2-1])/2},n.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,a=r[t];if(a!=null&&a<this._count&&a===t)return t;for(var o=0,u=this._count-1;o<=u;){var s=(o+u)/2|0;if(r[s]<t)o=s+1;else if(r[s]>t)u=s-1;else return s}return-1},n.prototype.indicesOfNearest=function(t,r,a){var o=this._chunks,u=o[t],s=[];if(!u)return s;a==null&&(a=1/0);for(var c=1/0,l=-1,d=0,f=0,h=this.count();f<h;f++){var v=this.getRawIndex(f),g=r-u[v],b=Math.abs(g);b<=a&&((b<c||b===c&&g>=0&&l<0)&&(c=b,l=g,d=0),g===l&&(s[d++]=f))}return s.length=d,s},n.prototype.getIndices=function(){var t,r=this._indices;if(r){var a=r.constructor,o=this._count;if(a===Array){t=new a(o);for(var u=0;u<o;u++)t[u]=r[u]}else t=new a(r.buffer,0,o)}else{var a=getIndicesCtor(this._rawCount);t=new a(this.count());for(var u=0;u<t.length;u++)t[u]=u}return t},n.prototype.filter=function(t,r){if(!this._count)return this;for(var a=this.clone(),o=a.count(),u=getIndicesCtor(a._rawCount),s=new u(o),c=[],l=t.length,d=0,f=t[0],h=a._chunks,v=0;v<o;v++){var g=void 0,b=a.getRawIndex(v);if(l===0)g=r(v);else if(l===1){var _=h[f][b];g=r(_,v)}else{for(var S=0;S<l;S++)c[S]=h[t[S]][b];c[S]=v,g=r.apply(null,c)}g&&(s[d++]=b)}return d<o&&(a._indices=s),a._count=d,a._extent=[],a._updateGetRawIdx(),a},n.prototype.selectRange=function(t){var r=this.clone(),a=r._count;if(!a)return this;var o=keys(t),u=o.length;if(!u)return this;var s=r.count(),c=getIndicesCtor(r._rawCount),l=new c(s),d=0,f=o[0],h=t[f][0],v=t[f][1],g=r._chunks,b=!1;if(!r._indices){var _=0;if(u===1){for(var S=g[o[0]],T=0;T<a;T++){var w=S[T];(w>=h&&w<=v||isNaN(w))&&(l[d++]=_),_++}b=!0}else if(u===2){for(var S=g[o[0]],A=g[o[1]],R=t[o[1]][0],E=t[o[1]][1],T=0;T<a;T++){var w=S[T],I=A[T];(w>=h&&w<=v||isNaN(w))&&(I>=R&&I<=E||isNaN(I))&&(l[d++]=_),_++}b=!0}}if(!b)if(u===1)for(var T=0;T<s;T++){var L=r.getRawIndex(T),w=g[o[0]][L];(w>=h&&w<=v||isNaN(w))&&(l[d++]=L)}else for(var T=0;T<s;T++){for(var F=!0,L=r.getRawIndex(T),D=0;D<u;D++){var $=o[D],w=g[$][L];(w<t[$][0]||w>t[$][1])&&(F=!1)}F&&(l[d++]=r.getRawIndex(T))}return d<s&&(r._indices=l),r._count=d,r._extent=[],r._updateGetRawIdx(),r},n.prototype.map=function(t,r){var a=this.clone(t);return this._updateDims(a,t,r),a},n.prototype.modify=function(t,r){this._updateDims(this,t,r)},n.prototype._updateDims=function(t,r,a){for(var o=t._chunks,u=[],s=r.length,c=t.count(),l=[],d=t._rawExtent,f=0;f<r.length;f++)d[r[f]]=getInitialExtent();for(var h=0;h<c;h++){for(var v=t.getRawIndex(h),g=0;g<s;g++)l[g]=o[r[g]][v];l[s]=h;var b=a&&a.apply(null,l);if(b!=null){typeof b!="object"&&(u[0]=b,b=u);for(var f=0;f<b.length;f++){var _=r[f],S=b[f],T=d[_],w=o[_];w&&(w[v]=S),S<T[0]&&(T[0]=S),S>T[1]&&(T[1]=S)}}}},n.prototype.lttbDownSample=function(t,r){var a=this.clone([t],!0),o=a._chunks,u=o[t],s=this.count(),c=0,l=Math.floor(1/r),d=this.getRawIndex(0),f,h,v,g=new(getIndicesCtor(this._rawCount))(Math.min((Math.ceil(s/l)+2)*2,s));g[c++]=d;for(var b=1;b<s-1;b+=l){for(var _=Math.min(b+l,s-1),S=Math.min(b+l*2,s),T=(S+_)/2,w=0,A=_;A<S;A++){var R=this.getRawIndex(A),E=u[R];isNaN(E)||(w+=E)}w/=S-_;var I=b,L=Math.min(b+l,s),F=b-1,D=u[d];f=-1,v=I;for(var $=-1,O=0,A=I;A<L;A++){var R=this.getRawIndex(A),E=u[R];if(isNaN(E)){O++,$<0&&($=R);continue}h=Math.abs((F-T)*(E-D)-(F-A)*(w-D)),h>f&&(f=h,v=R)}O>0&&O<L-I&&(g[c++]=Math.min($,v),v=Math.max($,v)),g[c++]=v,d=v}return g[c++]=this.getRawIndex(s-1),a._count=c,a._indices=g,a.getRawIndex=this._getRawIdx,a},n.prototype.minmaxDownSample=function(t,r){for(var a=this.clone([t],!0),o=a._chunks,u=Math.floor(1/r),s=o[t],c=this.count(),l=new(getIndicesCtor(this._rawCount))(Math.ceil(c/u)*2),d=0,f=0;f<c;f+=u){var h=f,v=s[this.getRawIndex(h)],g=f,b=s[this.getRawIndex(g)],_=u;f+u>c&&(_=c-f);for(var S=0;S<_;S++){var T=this.getRawIndex(f+S),w=s[T];w<v&&(v=w,h=f+S),w>b&&(b=w,g=f+S)}var A=this.getRawIndex(h),R=this.getRawIndex(g);h<g?(l[d++]=A,l[d++]=R):(l[d++]=R,l[d++]=A)}return a._count=d,a._indices=l,a._updateGetRawIdx(),a},n.prototype.downSample=function(t,r,a,o){for(var u=this.clone([t],!0),s=u._chunks,c=[],l=Math.floor(1/r),d=s[t],f=this.count(),h=u._rawExtent[t]=getInitialExtent(),v=new(getIndicesCtor(this._rawCount))(Math.ceil(f/l)),g=0,b=0;b<f;b+=l){l>f-b&&(l=f-b,c.length=l);for(var _=0;_<l;_++){var S=this.getRawIndex(b+_);c[_]=d[S]}var T=a(c),w=this.getRawIndex(Math.min(b+o(c,T)||0,f-1));d[w]=T,T<h[0]&&(h[0]=T),T>h[1]&&(h[1]=T),v[g++]=w}return u._count=g,u._indices=v,u._updateGetRawIdx(),u},n.prototype.each=function(t,r){if(this._count)for(var a=t.length,o=this._chunks,u=0,s=this.count();u<s;u++){var c=this.getRawIndex(u);switch(a){case 0:r(u);break;case 1:r(o[t[0]][c],u);break;case 2:r(o[t[0]][c],o[t[1]][c],u);break;default:for(var l=0,d=[];l<a;l++)d[l]=o[t[l]][c];d[l]=u,r.apply(null,d)}}},n.prototype.getDataExtent=function(t){var r=this._chunks[t],a=getInitialExtent();if(!r)return a;var o=this.count(),u=!this._indices,s;if(u)return this._rawExtent[t].slice();if(s=this._extent[t],s)return s.slice();s=a;for(var c=s[0],l=s[1],d=0;d<o;d++){var f=this.getRawIndex(d),h=r[f];h<c&&(c=h),h>l&&(l=h)}return s=[c,l],this._extent[t]=s,s},n.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var a=[],o=this._chunks,u=0;u<o.length;u++)a.push(o[u][r]);return a},n.prototype.clone=function(t,r){var a=new n,o=this._chunks,u=t&&reduce$1(t,function(c,l){return c[l]=!0,c},{});if(u)for(var s=0;s<o.length;s++)a._chunks[s]=u[s]?cloneChunk(o[s]):o[s];else a._chunks=o;return this._copyCommonProps(a),r||(a._indices=this._cloneIndices()),a._updateGetRawIdx(),a},n.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=clone$5(this._extent),t._rawExtent=clone$5(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var a=this._indices.length;r=new t(a);for(var o=0;o<a;o++)r[o]=this._indices[o]}else r=new t(this._indices);return r}return null},n.prototype._getRawIdxIdentity=function(t){return t},n.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function t(r,a,o,u){return parseDataValue(r[u],this._dimensions[u])}defaultDimValueGetters={arrayRows:t,objectRows:function(r,a,o,u){return parseDataValue(r[a],this._dimensions[u])},keyedColumns:t,original:function(r,a,o,u){var s=r&&(r.value==null?r:r.value);return parseDataValue(s instanceof Array?s[u]:s,this._dimensions[u])},typedArray:function(r,a,o,u){return r[u]}}}(),n}(),SourceManager=function(){function n(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),a=!!r.length,o,u;if(isSeries(t)){var s=t,c=void 0,l=void 0,d=void 0;if(a){var f=r[0];f.prepareSource(),d=f.getSource(),c=d.data,l=d.sourceFormat,u=[f._getVersionSign()]}else c=s.get("data",!0),l=isTypedArray(c)?SOURCE_FORMAT_TYPED_ARRAY:SOURCE_FORMAT_ORIGINAL,u=[];var h=this._getSourceMetaRawOption()||{},v=d&&d.metaRawOption||{},g=retrieve2(h.seriesLayoutBy,v.seriesLayoutBy)||null,b=retrieve2(h.sourceHeader,v.sourceHeader),_=retrieve2(h.dimensions,v.dimensions),S=g!==v.seriesLayoutBy||!!b!=!!v.sourceHeader||_;o=S?[createSource(c,{seriesLayoutBy:g,sourceHeader:b,dimensions:_},l)]:[]}else{var T=t;if(a){var w=this._applyTransform(r);o=w.sourceList,u=w.upstreamSignList}else{var A=T.get("source",!0);o=[createSource(A,this._getSourceMetaRawOption(),null)],u=[]}}this._setLocalSource(o,u)},n.prototype._applyTransform=function(t){var r=this._sourceHost,a=r.get("transform",!0),o=r.get("fromTransformResult",!0);if(o!=null){var u="";t.length!==1&&doThrow(u)}var s,c=[],l=[];return each$f(t,function(d){d.prepareSource();var f=d.getSource(o||0),h="";o!=null&&!f&&doThrow(h),c.push(f),l.push(d._getVersionSign())}),a?s=applyDataTransform(a,c,{datasetIndex:r.componentIndex}):o!=null&&(s=[cloneSourceShallow(c[0])]),{sourceList:s,upstreamSignList:l}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var a=t[r];if(a._isDirty()||this._upstreamSignList[r]!==a._getVersionSign())return!0}},n.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var a=this._getUpstreamSourceManagers();return a[0]&&a[0].getSource(t)}return r},n.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},n.prototype._innerGetDataStore=function(t,r,a){var o=0,u=this._storeList,s=u[o];s||(s=u[o]={});var c=s[a];if(!c){var l=this._getUpstreamSourceManagers()[0];isSeries(this._sourceHost)&&l?c=l._innerGetDataStore(t,r,a):(c=new DataStore,c.initData(new DefaultDataProvider(r,t.length),t)),s[a]=c}return c},n.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(isSeries(t)){var r=querySeriesUpstreamDatasetModel(t);return r?[r.getSourceManager()]:[]}else return map$1(queryDatasetUpstreamDatasetModels(t),function(a){return a.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,a,o;if(isSeries(t))r=t.get("seriesLayoutBy",!0),a=t.get("sourceHeader",!0),o=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var u=t;r=u.get("seriesLayoutBy",!0),a=u.get("sourceHeader",!0),o=u.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:a,dimensions:o}},n}();function disableTransformOptionMerge(n){var t=n.option.transform;t&&setAsPrimitive(n.option.transform)}function isSeries(n){return n.mainType==="series"}function doThrow(n){throw new Error(n)}var TOOLTIP_LINE_HEIGHT_CSS="line-height:1";function getTooltipLineHeight(n){var t=n.lineHeight;return t==null?TOOLTIP_LINE_HEIGHT_CSS:"line-height:"+encodeHTML(t+"")+"px"}function getTooltipTextStyle(n,t){var r=n.color||"#6e7079",a=n.fontSize||12,o=n.fontWeight||"400",u=n.color||"#464646",s=n.fontSize||14,c=n.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+encodeHTML(a+"")+"px;color:"+encodeHTML(r)+";font-weight:"+encodeHTML(o+""),valueStyle:"font-size:"+encodeHTML(s+"")+"px;color:"+encodeHTML(u)+";font-weight:"+encodeHTML(c+"")}:{nameStyle:{fontSize:a,fill:r,fontWeight:o},valueStyle:{fontSize:s,fill:u,fontWeight:c}}}var HTML_GAPS=[0,10,20,30],RICH_TEXT_GAPS=["",`
`,`

`,`


`];function createTooltipMarkup(n,t){return t.type=n,t}function isSectionFragment(n){return n.type==="section"}function getBuilder(n){return isSectionFragment(n)?buildSection:buildNameValue}function getBlockGapLevel(n){if(isSectionFragment(n)){var t=0,r=n.blocks.length,a=r>1||r>0&&!n.noHeader;return each$f(n.blocks,function(o){var u=getBlockGapLevel(o);u>=t&&(t=u+ +(a&&(!u||isSectionFragment(o)&&!o.noHeader)))}),t}return 0}function buildSection(n,t,r,a){var o=t.noHeader,u=getGap(getBlockGapLevel(t)),s=[],c=t.blocks||[];assert(!c||isArray$2(c)),c=c||[];var l=n.orderMode;if(t.sortBlocks&&l){c=c.slice();var d={valueAsc:"asc",valueDesc:"desc"};if(hasOwn(d,l)){var f=new SortOrderComparator(d[l],null);c.sort(function(_,S){return f.evaluate(_.sortParam,S.sortParam)})}else l==="seriesDesc"&&c.reverse()}each$f(c,function(_,S){var T=t.valueFormatter,w=getBuilder(_)(T?extend$1(extend$1({},n),{valueFormatter:T}):n,_,S>0?u.html:0,a);w!=null&&s.push(w)});var h=n.renderMode==="richText"?s.join(u.richText):wrapBlockHTML(a,s.join(""),o?r:u.html);if(o)return h;var v=makeValueReadable(t.header,"ordinal",n.useUTC),g=getTooltipTextStyle(a,n.renderMode).nameStyle,b=getTooltipLineHeight(a);return n.renderMode==="richText"?wrapInlineNameRichText(n,v,g)+u.richText+h:wrapBlockHTML(a,'<div style="'+g+";"+b+';">'+encodeHTML(v)+"</div>"+h,r)}function buildNameValue(n,t,r,a){var o=n.renderMode,u=t.noName,s=t.noValue,c=!t.markerType,l=t.name,d=n.useUTC,f=t.valueFormatter||n.valueFormatter||function(R){return R=isArray$2(R)?R:[R],map$1(R,function(E,I){return makeValueReadable(E,isArray$2(g)?g[I]:g,d)})};if(!(u&&s)){var h=c?"":n.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",o),v=u?"":makeValueReadable(l,"ordinal",d),g=t.valueType,b=s?[]:f(t.value,t.dataIndex),_=!c||!u,S=!c&&u,T=getTooltipTextStyle(a,o),w=T.nameStyle,A=T.valueStyle;return o==="richText"?(c?"":h)+(u?"":wrapInlineNameRichText(n,v,w))+(s?"":wrapInlineValueRichText(n,b,_,S,A)):wrapBlockHTML(a,(c?"":h)+(u?"":wrapInlineNameHTML(v,!c,w))+(s?"":wrapInlineValueHTML(b,_,S,A)),r)}}function buildTooltipMarkup(n,t,r,a,o,u){if(n){var s=getBuilder(n),c={useUTC:o,renderMode:r,orderMode:a,markupStyleCreator:t,valueFormatter:n.valueFormatter};return s(c,n,0,u)}}function getGap(n){return{html:HTML_GAPS[n],richText:RICH_TEXT_GAPS[n]}}function wrapBlockHTML(n,t,r){var a='<div style="clear:both"></div>',o="margin: "+r+"px 0 0",u=getTooltipLineHeight(n);return'<div style="'+o+";"+u+';">'+t+a+"</div>"}function wrapInlineNameHTML(n,t,r){var a=t?"margin-left:2px":"";return'<span style="'+r+";"+a+'">'+encodeHTML(n)+"</span>"}function wrapInlineValueHTML(n,t,r,a){var o=r?"10px":"20px",u=t?"float:right;margin-left:"+o:"";return n=isArray$2(n)?n:[n],'<span style="'+u+";"+a+'">'+map$1(n,function(s){return encodeHTML(s)}).join("&nbsp;&nbsp;")+"</span>"}function wrapInlineNameRichText(n,t,r){return n.markupStyleCreator.wrapRichTextStyle(t,r)}function wrapInlineValueRichText(n,t,r,a,o){var u=[o],s=a?10:20;return r&&u.push({padding:[0,0,0,s],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(isArray$2(t)?t.join("  "):t,u)}function retrieveVisualColorForTooltipMarker(n,t){var r=n.getData().getItemVisual(t,"style"),a=r[n.visualDrawType];return convertToColorString(a)}function getPaddingFromTooltipModel(n,t){var r=n.get("padding");return r??(t==="richText"?[8,10]:10)}var TooltipMarkupStyleCreator=function(){function n(){this.richTextStyles={},this._nextStyleNameId=getRandomIdBase()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(t,r,a){var o=a==="richText"?this._generateStyleName():null,u=getTooltipMarker({color:r,type:t,renderMode:a,markerId:o});return isString(u)?u:(this.richTextStyles[o]=u.style,u.content)},n.prototype.wrapRichTextStyle=function(t,r){var a={};isArray$2(r)?each$f(r,function(u){return extend$1(a,u)}):extend$1(a,r);var o=this._generateStyleName();return this.richTextStyles[o]=a,"{"+o+"|"+t+"}"},n}();function defaultSeriesFormatTooltip(n){var t=n.series,r=n.dataIndex,a=n.multipleSeries,o=t.getData(),u=o.mapDimensionsAll("defaultedTooltip"),s=u.length,c=t.getRawValue(r),l=isArray$2(c),d=retrieveVisualColorForTooltipMarker(t,r),f,h,v,g;if(s>1||l&&!s){var b=formatTooltipArrayValue(c,t,r,u,d);f=b.inlineValues,h=b.inlineValueTypes,v=b.blocks,g=b.inlineValues[0]}else if(s){var _=o.getDimensionInfo(u[0]);g=f=retrieveRawValue(o,r,u[0]),h=_.type}else g=f=l?c[0]:c;var S=isNameSpecified(t),T=S&&t.name||"",w=o.getName(r),A=a?T:w;return createTooltipMarkup("section",{header:T,noHeader:a||!S,sortParam:g,blocks:[createTooltipMarkup("nameValue",{markerType:"item",markerColor:d,name:A,noName:!trim$1(A),value:f,valueType:h,dataIndex:r})].concat(v||[])})}function formatTooltipArrayValue(n,t,r,a,o){var u=t.getData(),s=reduce$1(n,function(h,v,g){var b=u.getDimensionInfo(g);return h=h||b&&b.tooltip!==!1&&b.displayName!=null},!1),c=[],l=[],d=[];a.length?each$f(a,function(h){f(retrieveRawValue(u,r,h),h)}):each$f(n,f);function f(h,v){var g=u.getDimensionInfo(v);!g||g.otherDims.tooltip===!1||(s?d.push(createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:o,name:g.displayName,value:h,valueType:g.type})):(c.push(h),l.push(g.type)))}return{inlineValues:c,inlineValueTypes:l,blocks:d}}var inner$k=makeInner();function getSelectionKey(n,t){return n.getName(t)||n.getId(t)}var SERIES_UNIVERSAL_TRANSITION_PROP="__universalTransitionEnabled",SeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,a,o){this.seriesIndex=this.componentIndex,this.dataTask=createTask({count:dataTaskCount,reset:dataTaskReset}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,o);var u=inner$k(this).sourceManager=new SourceManager(this);u.prepareSource();var s=this.getInitialData(r,o);wrapData(s,this),this.dataTask.context.data=s,inner$k(this).dataBeforeProcessed=s,autoSeriesName(this),this._initSelectedMapFromData(s)},t.prototype.mergeDefaultAndTheme=function(r,a){var o=fetchLayoutMode(this),u=o?getLayoutParams(r):{},s=this.subType;ComponentModel.hasClass(s)&&(s+="Series"),merge$3(r,a.getTheme().get(this.subType)),merge$3(r,this.getDefaultOption()),defaultEmphasis(r,"label",["show"]),this.fillDataTextStyle(r.data),o&&mergeLayoutParam(r,u,o)},t.prototype.mergeOption=function(r,a){r=merge$3(this.option,r,!0),this.fillDataTextStyle(r.data);var o=fetchLayoutMode(this);o&&mergeLayoutParam(this.option,r,o);var u=inner$k(this).sourceManager;u.dirty(),u.prepareSource();var s=this.getInitialData(r,a);wrapData(s,this),this.dataTask.dirty(),this.dataTask.context.data=s,inner$k(this).dataBeforeProcessed=s,autoSeriesName(this),this._initSelectedMapFromData(s)},t.prototype.fillDataTextStyle=function(r){if(r&&!isTypedArray(r))for(var a=["show"],o=0;o<r.length;o++)r[o]&&r[o].label&&defaultEmphasis(r[o],"label",a)},t.prototype.getInitialData=function(r,a){},t.prototype.appendData=function(r){var a=this.getRawData();a.appendData(r.data)},t.prototype.getData=function(r){var a=getCurrentTask(this);if(a){var o=a.context.data;return r==null||!o.getLinkedData?o:o.getLinkedData(r)}else return inner$k(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var a=getCurrentTask(this);if(a){var o=a.context;o.outputData=r,a!==this.dataTask&&(o.data=r)}inner$k(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return createHashMap(r)},t.prototype.getSourceManager=function(){return inner$k(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return inner$k(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,a,o){return defaultSeriesFormatTooltip({series:this,dataIndex:r,multipleSeries:a})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(env.node&&!(r&&r.ssr))return!1;var a=this.getShallow("animation");return a&&this.getData().count()>this.getShallow("animationThreshold")&&(a=!1),!!a},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,a,o){var u=this.ecModel,s=PaletteMixin.prototype.getColorFromPalette.call(this,r,a,o);return s||(s=u.getColorFromPalette(r,a,o)),s},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,a){this._innerSelect(this.getData(a),r)},t.prototype.unselect=function(r,a){var o=this.option.selectedMap;if(o){var u=this.option.selectedMode,s=this.getData(a);if(u==="series"||o==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var c=0;c<r.length;c++){var l=r[c],d=getSelectionKey(s,l);o[d]=!1,this._selectedDataIndicesMap[d]=-1}}},t.prototype.toggleSelect=function(r,a){for(var o=[],u=0;u<r.length;u++)o[0]=r[u],this.isSelected(r[u],a)?this.unselect(o,a):this.select(o,a)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,a=keys(r),o=[],u=0;u<a.length;u++){var s=r[a[u]];s>=0&&o.push(s)}return o},t.prototype.isSelected=function(r,a){var o=this.option.selectedMap;if(!o)return!1;var u=this.getData(a);return(o==="all"||o[getSelectionKey(u,r)])&&!u.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[SERIES_UNIVERSAL_TRANSITION_PROP])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,a){var o,u,s=this.option,c=s.selectedMode,l=a.length;if(!(!c||!l)){if(c==="series")s.selectedMap="all";else if(c==="multiple"){isObject$4(s.selectedMap)||(s.selectedMap={});for(var d=s.selectedMap,f=0;f<l;f++){var h=a[f],v=getSelectionKey(r,h);d[v]=!0,this._selectedDataIndicesMap[v]=r.getRawIndex(h)}}else if(c==="single"||c===!0){var g=a[l-1],v=getSelectionKey(r,g);s.selectedMap=(o={},o[v]=!0,o),this._selectedDataIndicesMap=(u={},u[v]=r.getRawIndex(g),u)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var a=[];r.hasItemOption&&r.each(function(o){var u=r.getRawDataItem(o);u&&u.selected&&a.push(o)}),a.length>0&&this._innerSelect(r,a)}},t.registerClass=function(r){return ComponentModel.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(ComponentModel);mixin$1(SeriesModel,DataFormatMixin);mixin$1(SeriesModel,PaletteMixin);mountExtend(SeriesModel,ComponentModel);function autoSeriesName(n){var t=n.name;isNameSpecified(n)||(n.name=getSeriesAutoName(n)||t)}function getSeriesAutoName(n){var t=n.getRawData(),r=t.mapDimensionsAll("seriesName"),a=[];return each$f(r,function(o){var u=t.getDimensionInfo(o);u.displayName&&a.push(u.displayName)}),a.join(" ")}function dataTaskCount(n){return n.model.getRawData().count()}function dataTaskReset(n){var t=n.model;return t.setData(t.getRawData().cloneShallow()),dataTaskProgress}function dataTaskProgress(n,t){t.outputData&&n.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function wrapData(n,t){each$f(concatArray(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(r){n.wrapMethod(r,curry$1(onDataChange,t))})}function onDataChange(n,t){var r=getCurrentTask(n);return r&&r.setOutputEnd((t||this).count()),t}function getCurrentTask(n){var t=(n.ecModel||{}).scheduler,r=t&&t.getPipeline(n.uid);if(r){var a=r.currentTask;if(a){var o=a.agentStubMap;o&&(a=o.get(n.uid))}return a}}var ComponentView=function(){function n(){this.group=new Group$3,this.uid=getUID("viewComponent")}return n.prototype.init=function(t,r){},n.prototype.render=function(t,r,a,o){},n.prototype.dispose=function(t,r){},n.prototype.updateView=function(t,r,a,o){},n.prototype.updateLayout=function(t,r,a,o){},n.prototype.updateVisual=function(t,r,a,o){},n.prototype.toggleBlurSeries=function(t,r,a){},n.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},n}();enableClassExtend(ComponentView);enableClassManagement(ComponentView);function createRenderPlanner(){var n=makeInner();return function(t){var r=n(t),a=t.pipelineContext,o=!!r.large,u=!!r.progressiveRender,s=r.large=!!(a&&a.large),c=r.progressiveRender=!!(a&&a.progressiveRender);return(o!==s||u!==c)&&"reset"}}var inner$j=makeInner(),renderPlanner=createRenderPlanner(),ChartView=function(){function n(){this.group=new Group$3,this.uid=getUID("viewChart"),this.renderTask=createTask({plan:renderTaskPlan,reset:renderTaskReset}),this.renderTask.context={view:this}}return n.prototype.init=function(t,r){},n.prototype.render=function(t,r,a,o){},n.prototype.highlight=function(t,r,a,o){var u=t.getData(o&&o.dataType);u&&toggleHighlight(u,o,"emphasis")},n.prototype.downplay=function(t,r,a,o){var u=t.getData(o&&o.dataType);u&&toggleHighlight(u,o,"normal")},n.prototype.remove=function(t,r){this.group.removeAll()},n.prototype.dispose=function(t,r){},n.prototype.updateView=function(t,r,a,o){this.render(t,r,a,o)},n.prototype.updateLayout=function(t,r,a,o){this.render(t,r,a,o)},n.prototype.updateVisual=function(t,r,a,o){this.render(t,r,a,o)},n.prototype.eachRendered=function(t){traverseElements(this.group,t)},n.markUpdateMethod=function(t,r){inner$j(t).updateMethod=r},n.protoInitialize=function(){var t=n.prototype;t.type="chart"}(),n}();function elSetState(n,t,r){n&&isHighDownDispatcher(n)&&(t==="emphasis"?enterEmphasis:leaveEmphasis)(n,r)}function toggleHighlight(n,t,r){var a=queryDataIndex(n,t),o=t&&t.highlightKey!=null?getHighlightDigit(t.highlightKey):null;a!=null?each$f(normalizeToArray(a),function(u){elSetState(n.getItemGraphicEl(u),r,o)}):n.eachItemGraphicEl(function(u){elSetState(u,r,o)})}enableClassExtend(ChartView);enableClassManagement(ChartView);function renderTaskPlan(n){return renderPlanner(n.model)}function renderTaskReset(n){var t=n.model,r=n.ecModel,a=n.api,o=n.payload,u=t.pipelineContext.progressiveRender,s=n.view,c=o&&inner$j(o).updateMethod,l=u?"incrementalPrepareRender":c&&s[c]?c:"render";return l!=="render"&&s[l](t,r,a,o),progressMethodMap[l]}var progressMethodMap={incrementalPrepareRender:{progress:function(n,t){t.view.incrementalRender(n,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(n,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},ORIGIN_METHOD="\0__throttleOriginMethod",RATE="\0__throttleRate",THROTTLE_TYPE="\0__throttleType";function throttle(n,t,r){var a,o=0,u=0,s=null,c,l,d,f;t=t||0;function h(){u=new Date().getTime(),s=null,n.apply(l,d||[])}var v=function(){for(var g=[],b=0;b<arguments.length;b++)g[b]=arguments[b];a=new Date().getTime(),l=this,d=g;var _=f||t,S=f||r;f=null,c=a-(S?o:u)-_,clearTimeout(s),S?s=setTimeout(h,_):c>=0?h():s=setTimeout(h,-c),o=a};return v.clear=function(){s&&(clearTimeout(s),s=null)},v.debounceNextCall=function(g){f=g},v}function createOrUpdate(n,t,r,a){var o=n[t];if(o){var u=o[ORIGIN_METHOD]||o,s=o[THROTTLE_TYPE],c=o[RATE];if(c!==r||s!==a){if(r==null||!a)return n[t]=u;o=n[t]=throttle(u,r,a==="debounce"),o[ORIGIN_METHOD]=u,o[THROTTLE_TYPE]=a,o[RATE]=r}return o}}function clear$1(n,t){var r=n[t];r&&r[ORIGIN_METHOD]&&(r.clear&&r.clear(),n[t]=r[ORIGIN_METHOD])}var inner$i=makeInner(),defaultStyleMappers={itemStyle:makeStyleMapper(ITEM_STYLE_KEY_MAP,!0),lineStyle:makeStyleMapper(LINE_STYLE_KEY_MAP,!0)},defaultColorKey={lineStyle:"stroke",itemStyle:"fill"};function getStyleMapper(n,t){var r=n.visualStyleMapper||defaultStyleMappers[t];return r||(console.warn("Unknown style type '"+t+"'."),defaultStyleMappers.itemStyle)}function getDefaultColorKey(n,t){var r=n.visualDrawType||defaultColorKey[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var seriesStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){var r=n.getData(),a=n.visualStyleAccessPath||"itemStyle",o=n.getModel(a),u=getStyleMapper(n,a),s=u(o),c=o.getShallow("decal");c&&(r.setVisual("decal",c),c.dirty=!0);var l=getDefaultColorKey(n,a),d=s[l],f=isFunction$1(d)?d:null,h=s.fill==="auto"||s.stroke==="auto";if(!s[l]||f||h){var v=n.getColorFromPalette(n.name,null,t.getSeriesCount());s[l]||(s[l]=v,r.setVisual("colorFromPalette",!0)),s.fill=s.fill==="auto"||isFunction$1(s.fill)?v:s.fill,s.stroke=s.stroke==="auto"||isFunction$1(s.stroke)?v:s.stroke}if(r.setVisual("style",s),r.setVisual("drawType",l),!t.isSeriesFiltered(n)&&f)return r.setVisual("colorFromPalette",!1),{dataEach:function(g,b){var _=n.getDataParams(b),S=extend$1({},s);S[l]=f(_),g.setItemVisual(b,"style",S)}}}},sharedModel=new Model,dataStyleTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){if(!(n.ignoreStyleOnData||t.isSeriesFiltered(n))){var r=n.getData(),a=n.visualStyleAccessPath||"itemStyle",o=getStyleMapper(n,a),u=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(s,c){var l=s.getRawDataItem(c);if(l&&l[a]){sharedModel.option=l[a];var d=o(sharedModel),f=s.ensureUniqueItemVisual(c,"style");extend$1(f,d),sharedModel.option.decal&&(s.setItemVisual(c,"decal",sharedModel.option.decal),sharedModel.option.decal.dirty=!0),u in d&&s.setItemVisual(c,"colorFromPalette",!1)}}:null}}}},dataColorPaletteTask={performRawSeries:!0,overallReset:function(n){var t=createHashMap();n.eachSeries(function(r){var a=r.getColorBy();if(!r.isColorBySeries()){var o=r.type+"-"+a,u=t.get(o);u||(u={},t.set(o,u)),inner$i(r).scope=u}}),n.eachSeries(function(r){if(!(r.isColorBySeries()||n.isSeriesFiltered(r))){var a=r.getRawData(),o={},u=r.getData(),s=inner$i(r).scope,c=r.visualStyleAccessPath||"itemStyle",l=getDefaultColorKey(r,c);u.each(function(d){var f=u.getRawIndex(d);o[f]=d}),a.each(function(d){var f=o[d],h=u.getItemVisual(f,"colorFromPalette");if(h){var v=u.ensureUniqueItemVisual(f,"style"),g=a.getName(d)||d+"",b=a.count();v[l]=r.getColorFromPalette(g,s,b)}})}})}},PI$5=Math.PI;function defaultLoading(n,t){t=t||{},defaults$h(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new Group$3,a=new Rect$2({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(a);var o=new ZRText({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),u=new Rect$2({style:{fill:"none"},textContent:o,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(u);var s;return t.showSpinner&&(s=new Arc({shape:{startAngle:-PI$5/2,endAngle:-PI$5/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),s.animateShape(!0).when(1e3,{endAngle:PI$5*3/2}).start("circularInOut"),s.animateShape(!0).when(1e3,{startAngle:PI$5*3/2}).delay(300).start("circularInOut"),r.add(s)),r.resize=function(){var c=o.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,d=(n.getWidth()-l*2-(t.showSpinner&&c?10:0)-c)/2-(t.showSpinner&&c?0:5+c/2)+(t.showSpinner?0:c/2)+(c?0:l),f=n.getHeight()/2;t.showSpinner&&s.setShape({cx:d,cy:f}),u.setShape({x:d-l,y:f-l,width:l*2,height:l*2}),a.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},r.resize(),r}var Scheduler=function(){function n(t,r,a,o){this._stageTaskMap=createHashMap(),this.ecInstance=t,this.api=r,a=this._dataProcessorHandlers=a.slice(),o=this._visualHandlers=o.slice(),this._allHandlers=a.concat(o)}return n.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(a){var o=a.overallTask;o&&o.dirty()})},n.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var a=this._pipelineMap.get(t.__pipeline.id),o=a.context,u=!r&&a.progressiveEnabled&&(!o||o.progressiveRender)&&t.__idxInPipeline>a.blockIndex,s=u?a.step:null,c=o&&o.modDataCount,l=c!=null?Math.ceil(c/s):null;return{step:s,modBy:l,modDataCount:c}}},n.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},n.prototype.updateStreamModes=function(t,r){var a=this._pipelineMap.get(t.uid),o=t.getData(),u=o.count(),s=a.progressiveEnabled&&r.incrementalPrepareRender&&u>=a.threshold,c=t.get("large")&&u>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?u:null;t.pipelineContext=a.context={progressiveRender:s,modDataCount:l,large:c}},n.prototype.restorePipelines=function(t){var r=this,a=r._pipelineMap=createHashMap();t.eachSeries(function(o){var u=o.getProgressive(),s=o.uid;a.set(s,{id:s,head:null,tail:null,threshold:o.getProgressiveThreshold(),progressiveEnabled:u&&!(o.preventIncremental&&o.preventIncremental()),blockIndex:-1,step:Math.round(u||700),count:0}),r._pipe(o,o.dataTask)})},n.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),a=this.api;each$f(this._allHandlers,function(o){var u=t.get(o.uid)||t.set(o.uid,{}),s="";assert(!(o.reset&&o.overallReset),s),o.reset&&this._createSeriesStageTask(o,u,r,a),o.overallReset&&this._createOverallStageTask(o,u,r,a)},this)},n.prototype.prepareView=function(t,r,a,o){var u=t.renderTask,s=u.context;s.model=r,s.ecModel=a,s.api=o,u.__block=!t.incrementalPrepareRender,this._pipe(r,u)},n.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},n.prototype.performVisualTasks=function(t,r,a){this._performStageTasks(this._visualHandlers,t,r,a)},n.prototype._performStageTasks=function(t,r,a,o){o=o||{};var u=!1,s=this;each$f(t,function(l,d){if(!(o.visualType&&o.visualType!==l.visualType)){var f=s._stageTaskMap.get(l.uid),h=f.seriesTaskMap,v=f.overallTask;if(v){var g,b=v.agentStubMap;b.each(function(S){c(o,S)&&(S.dirty(),g=!0)}),g&&v.dirty(),s.updatePayload(v,a);var _=s.getPerformArgs(v,o.block);b.each(function(S){S.perform(_)}),v.perform(_)&&(u=!0)}else h&&h.each(function(S,T){c(o,S)&&S.dirty();var w=s.getPerformArgs(S,o.block);w.skip=!l.performRawSeries&&r.isSeriesFiltered(S.context.model),s.updatePayload(S,a),S.perform(w)&&(u=!0)})}});function c(l,d){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(d.__pipeline.id))}this.unfinished=u||this.unfinished},n.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(a){r=a.dataTask.perform()||r}),this.unfinished=r||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},n.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},n.prototype._createSeriesStageTask=function(t,r,a,o){var u=this,s=r.seriesTaskMap,c=r.seriesTaskMap=createHashMap(),l=t.seriesType,d=t.getTargetSeries;t.createOnAllSeries?a.eachRawSeries(f):l?a.eachRawSeriesByType(l,f):d&&d(a,o).each(f);function f(h){var v=h.uid,g=c.set(v,s&&s.get(v)||createTask({plan:seriesTaskPlan,reset:seriesTaskReset,count:seriesTaskCount}));g.context={model:h,ecModel:a,api:o,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:u},u._pipe(h,g)}},n.prototype._createOverallStageTask=function(t,r,a,o){var u=this,s=r.overallTask=r.overallTask||createTask({reset:overallTaskReset});s.context={ecModel:a,api:o,overallReset:t.overallReset,scheduler:u};var c=s.agentStubMap,l=s.agentStubMap=createHashMap(),d=t.seriesType,f=t.getTargetSeries,h=!0,v=!1,g="";assert(!t.createOnAllSeries,g),d?a.eachRawSeriesByType(d,b):f?f(a,o).each(b):(h=!1,each$f(a.getSeries(),b));function b(_){var S=_.uid,T=l.set(S,c&&c.get(S)||(v=!0,createTask({reset:stubReset,onDirty:stubOnDirty})));T.context={model:_,overallProgress:h},T.agent=s,T.__block=h,u._pipe(_,T)}v&&s.dirty()},n.prototype._pipe=function(t,r){var a=t.uid,o=this._pipelineMap.get(a);!o.head&&(o.head=r),o.tail&&o.tail.pipe(r),o.tail=r,r.__idxInPipeline=o.count++,r.__pipeline=o},n.wrapStageHandler=function(t,r){return isFunction$1(t)&&(t={overallReset:t,seriesType:detectSeriseType(t)}),t.uid=getUID("stageHandler"),r&&(t.visualType=r),t},n}();function overallTaskReset(n){n.overallReset(n.ecModel,n.api,n.payload)}function stubReset(n){return n.overallProgress&&stubProgress}function stubProgress(){this.agent.dirty(),this.getDownstream().dirty()}function stubOnDirty(){this.agent&&this.agent.dirty()}function seriesTaskPlan(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function seriesTaskReset(n){n.useClearVisual&&n.data.clearAllVisual();var t=n.resetDefines=normalizeToArray(n.reset(n.model,n.ecModel,n.api,n.payload));return t.length>1?map$1(t,function(r,a){return makeSeriesTaskProgress(a)}):singleSeriesTaskProgress}var singleSeriesTaskProgress=makeSeriesTaskProgress(0);function makeSeriesTaskProgress(n){return function(t,r){var a=r.data,o=r.resetDefines[n];if(o&&o.dataEach)for(var u=t.start;u<t.end;u++)o.dataEach(a,u);else o&&o.progress&&o.progress(t,a)}}function seriesTaskCount(n){return n.data.count()}function detectSeriseType(n){seriesType=null;try{n(ecModelMock,apiMock)}catch{}return seriesType}var ecModelMock={},apiMock={},seriesType;mockMethods(ecModelMock,GlobalModel);mockMethods(apiMock,ExtensionAPI);ecModelMock.eachSeriesByType=ecModelMock.eachRawSeriesByType=function(n){seriesType=n};ecModelMock.eachComponent=function(n){n.mainType==="series"&&n.subType&&(seriesType=n.subType)};function mockMethods(n,t){for(var r in t.prototype)n[r]=noop$3}var colorAll=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const lightTheme={color:colorAll,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],colorAll]};var contrastColor="#B9B8CE",backgroundColor="#100C2A",axisCommon=function(){return{axisLine:{lineStyle:{color:contrastColor}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},colorPalette=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],theme={darkMode:!0,color:colorPalette,backgroundColor,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:contrastColor},pageTextStyle:{color:contrastColor}},textStyle:{color:contrastColor},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:contrastColor}},dataZoom:{borderColor:"#71708A",textStyle:{color:contrastColor},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:contrastColor}},timeline:{lineStyle:{color:contrastColor},label:{color:contrastColor},controlStyle:{color:contrastColor,borderColor:contrastColor}},calendar:{itemStyle:{color:backgroundColor},dayLabel:{color:contrastColor},monthLabel:{color:contrastColor},yearLabel:{color:contrastColor}},timeAxis:axisCommon(),logAxis:axisCommon(),valueAxis:axisCommon(),categoryAxis:axisCommon(),line:{symbol:"circle"},graph:{color:colorPalette},gauge:{title:{color:contrastColor},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:contrastColor},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};theme.categoryAxis.splitLine.show=!1;var ECEventProcessor=function(){function n(){}return n.prototype.normalizeQuery=function(t){var r={},a={},o={};if(isString(t)){var u=parseClassType(t);r.mainType=u.main||null,r.subType=u.sub||null}else{var s=["Index","Name","Id"],c={name:1,dataIndex:1,dataType:1};each$f(t,function(l,d){for(var f=!1,h=0;h<s.length;h++){var v=s[h],g=d.lastIndexOf(v);if(g>0&&g===d.length-v.length){var b=d.slice(0,g);b!=="data"&&(r.mainType=b,r[v.toLowerCase()]=l,f=!0)}}c.hasOwnProperty(d)&&(a[d]=l,f=!0),f||(o[d]=l)})}return{cptQuery:r,dataQuery:a,otherQuery:o}},n.prototype.filter=function(t,r){var a=this.eventInfo;if(!a)return!0;var o=a.targetEl,u=a.packedEvent,s=a.model,c=a.view;if(!s||!c)return!0;var l=r.cptQuery,d=r.dataQuery;return f(l,s,"mainType")&&f(l,s,"subType")&&f(l,s,"index","componentIndex")&&f(l,s,"name")&&f(l,s,"id")&&f(d,u,"name")&&f(d,u,"dataIndex")&&f(d,u,"dataType")&&(!c.filterForExposedEvent||c.filterForExposedEvent(t,r.otherQuery,o,u));function f(h,v,g,b){return h[g]==null||v[b||g]===h[g]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),SYMBOL_PROPS_WITH_CB=["symbol","symbolSize","symbolRotate","symbolOffset"],SYMBOL_PROPS=SYMBOL_PROPS_WITH_CB.concat(["symbolKeepAspect"]),seriesSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){var r=n.getData();if(n.legendIcon&&r.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var a={},o={},u=!1,s=0;s<SYMBOL_PROPS_WITH_CB.length;s++){var c=SYMBOL_PROPS_WITH_CB[s],l=n.get(c);isFunction$1(l)?(u=!0,o[c]=l):a[c]=l}if(a.symbol=a.symbol||n.defaultSymbol,r.setVisual(extend$1({legendIcon:n.legendIcon||a.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},a)),t.isSeriesFiltered(n))return;var d=keys(o);function f(h,v){for(var g=n.getRawValue(v),b=n.getDataParams(v),_=0;_<d.length;_++){var S=d[_];h.setItemVisual(v,S,o[S](g,b))}}return{dataEach:u?f:null}}},dataSymbolTask={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){if(!n.hasSymbolVisual||t.isSeriesFiltered(n))return;var r=n.getData();function a(o,u){for(var s=o.getItemModel(u),c=0;c<SYMBOL_PROPS.length;c++){var l=SYMBOL_PROPS[c],d=s.getShallow(l,!0);d!=null&&o.setItemVisual(u,l,d)}}return{dataEach:r.hasItemOption?a:null}}};function getItemVisualFromData(n,t,r){switch(r){case"color":var a=n.getItemVisual(t,"style");return a[n.getVisual("drawType")];case"opacity":return n.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(t,r)}}function getVisualFromData(n,t){switch(t){case"color":var r=n.getVisual("style");return r[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(t)}}function setItemVisualFromData(n,t,r,a){switch(r){case"color":var o=n.ensureUniqueItemVisual(t,"style");o[n.getVisual("drawType")]=a,n.setItemVisual(t,"colorFromPalette",!1);break;case"opacity":n.ensureUniqueItemVisual(t,"style").opacity=a;break;case"symbol":case"symbolSize":case"liftZ":n.setItemVisual(t,r,a);break}}function createLegacyDataSelectAction(n,t){function r(a,o){var u=[];return a.eachComponent({mainType:"series",subType:n,query:o},function(s){u.push(s.seriesIndex)}),u}each$f([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(a){t(a[0],function(o,u,s){o=extend$1({},o),s.dispatchAction(extend$1(o,{type:a[1],seriesIndex:r(u,o)}))})})}function handleSeriesLegacySelectEvents(n,t,r,a,o){var u=n+t;r.isSilent(u)||a.eachComponent({mainType:"series",subType:"pie"},function(s){for(var c=s.seriesIndex,l=s.option.selectedMap,d=o.selected,f=0;f<d.length;f++)if(d[f].seriesIndex===c){var h=s.getData(),v=queryDataIndex(h,o.fromActionPayload);r.trigger(u,{type:u,seriesId:s.id,name:isArray$2(v)?h.getName(v[0]):h.getName(v),selected:isString(l)?l:extend$1({},l)})}})}function handleLegacySelectEvents(n,t,r){n.on("selectchanged",function(a){var o=r.getModel();a.isFromClick?(handleSeriesLegacySelectEvents("map","selectchanged",t,o,a),handleSeriesLegacySelectEvents("pie","selectchanged",t,o,a)):a.fromAction==="select"?(handleSeriesLegacySelectEvents("map","selected",t,o,a),handleSeriesLegacySelectEvents("pie","selected",t,o,a)):a.fromAction==="unselect"&&(handleSeriesLegacySelectEvents("map","unselected",t,o,a),handleSeriesLegacySelectEvents("pie","unselected",t,o,a))})}function findEventDispatcher(n,t,r){for(var a;n&&!(t(n)&&(a=n,r));)n=n.__hostTarget||n.parent;return a}var wmUniqueIndex=Math.round(Math.random()*9),supportDefineProperty=typeof Object.defineProperty=="function",WeakMap$1=function(){function n(){this._id="__ec_inner_"+wmUniqueIndex++}return n.prototype.get=function(t){return this._guard(t)[this._id]},n.prototype.set=function(t,r){var a=this._guard(t);return supportDefineProperty?Object.defineProperty(a,this._id,{value:r,enumerable:!1,configurable:!0}):a[this._id]=r,this},n.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},n.prototype.has=function(t){return!!this._guard(t)[this._id]},n.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},n}(),Triangle=Path.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,t){var r=t.cx,a=t.cy,o=t.width/2,u=t.height/2;n.moveTo(r,a-u),n.lineTo(r+o,a+u),n.lineTo(r-o,a+u),n.closePath()}}),Diamond=Path.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,t){var r=t.cx,a=t.cy,o=t.width/2,u=t.height/2;n.moveTo(r,a-u),n.lineTo(r+o,a),n.lineTo(r,a+u),n.lineTo(r-o,a),n.closePath()}}),Pin=Path.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,t){var r=t.x,a=t.y,o=t.width/5*3,u=Math.max(o,t.height),s=o/2,c=s*s/(u-s),l=a-u+s+c,d=Math.asin(c/s),f=Math.cos(d)*s,h=Math.sin(d),v=Math.cos(d),g=s*.6,b=s*.7;n.moveTo(r-f,l+c),n.arc(r,l,s,Math.PI-d,Math.PI*2+d),n.bezierCurveTo(r+f-h*g,l+c+v*g,r,a-b,r,a),n.bezierCurveTo(r,a-b,r-f+h*g,l+c+v*g,r-f,l+c),n.closePath()}}),Arrow=Path.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,t){var r=t.height,a=t.width,o=t.x,u=t.y,s=a/3*2;n.moveTo(o,u),n.lineTo(o+s,u+r),n.lineTo(o,u+r/4*3),n.lineTo(o-s,u+r),n.lineTo(o,u),n.closePath()}}),symbolCtors={line:Line$1,rect:Rect$2,roundRect:Rect$2,square:Rect$2,circle:Circle,diamond:Diamond,pin:Pin,arrow:Arrow,triangle:Triangle},symbolShapeMakers={line:function(n,t,r,a,o){o.x1=n,o.y1=t+a/2,o.x2=n+r,o.y2=t+a/2},rect:function(n,t,r,a,o){o.x=n,o.y=t,o.width=r,o.height=a},roundRect:function(n,t,r,a,o){o.x=n,o.y=t,o.width=r,o.height=a,o.r=Math.min(r,a)/4},square:function(n,t,r,a,o){var u=Math.min(r,a);o.x=n,o.y=t,o.width=u,o.height=u},circle:function(n,t,r,a,o){o.cx=n+r/2,o.cy=t+a/2,o.r=Math.min(r,a)/2},diamond:function(n,t,r,a,o){o.cx=n+r/2,o.cy=t+a/2,o.width=r,o.height=a},pin:function(n,t,r,a,o){o.x=n+r/2,o.y=t+a/2,o.width=r,o.height=a},arrow:function(n,t,r,a,o){o.x=n+r/2,o.y=t+a/2,o.width=r,o.height=a},triangle:function(n,t,r,a,o){o.cx=n+r/2,o.cy=t+a/2,o.width=r,o.height=a}},symbolBuildProxies={};each$f(symbolCtors,function(n,t){symbolBuildProxies[t]=new n});var SymbolClz=Path.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,t,r){var a=calculateTextPosition(n,t,r),o=this.shape;return o&&o.symbolType==="pin"&&t.position==="inside"&&(a.y=r.y+r.height*.4),a},buildPath:function(n,t,r){var a=t.symbolType;if(a!=="none"){var o=symbolBuildProxies[a];o||(a="rect",o=symbolBuildProxies[a]),symbolShapeMakers[a](t.x,t.y,t.width,t.height,o.shape),o.buildPath(n,o.shape,r)}}});function symbolPathSetColor(n,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=n,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=n:r.fill=n,this.markRedraw()}}function createSymbol$1(n,t,r,a,o,u,s){var c=n.indexOf("empty")===0;c&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var l;return n.indexOf("image://")===0?l=makeImage(n.slice(8),new BoundingRect(t,r,a,o),s?"center":"cover"):n.indexOf("path://")===0?l=makePath(n.slice(7),{},new BoundingRect(t,r,a,o),s?"center":"cover"):l=new SymbolClz({shape:{symbolType:n,x:t,y:r,width:a,height:o}}),l.__isEmptyBrush=c,l.setColor=symbolPathSetColor,u&&l.setColor(u),l}function normalizeSymbolSize(n){return isArray$2(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function normalizeSymbolOffset(n,t){if(n!=null)return isArray$2(n)||(n=[n,n]),[parsePercent(n[0],t[0])||0,parsePercent(retrieve2(n[1],n[0]),t[1])||0]}function isSafeNum(n){return isFinite(n)}function createLinearGradient(n,t,r){var a=t.x==null?0:t.x,o=t.x2==null?1:t.x2,u=t.y==null?0:t.y,s=t.y2==null?0:t.y2;t.global||(a=a*r.width+r.x,o=o*r.width+r.x,u=u*r.height+r.y,s=s*r.height+r.y),a=isSafeNum(a)?a:0,o=isSafeNum(o)?o:1,u=isSafeNum(u)?u:0,s=isSafeNum(s)?s:0;var c=n.createLinearGradient(a,u,o,s);return c}function createRadialGradient(n,t,r){var a=r.width,o=r.height,u=Math.min(a,o),s=t.x==null?.5:t.x,c=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(s=s*a+r.x,c=c*o+r.y,l=l*u),s=isSafeNum(s)?s:.5,c=isSafeNum(c)?c:.5,l=l>=0&&isSafeNum(l)?l:.5;var d=n.createRadialGradient(s,c,0,s,c,l);return d}function getCanvasGradient(n,t,r){for(var a=t.type==="radial"?createRadialGradient(n,t,r):createLinearGradient(n,t,r),o=t.colorStops,u=0;u<o.length;u++)a.addColorStop(o[u].offset,o[u].color);return a}function isClipPathChanged(n,t){if(n===t||!n&&!t)return!1;if(!n||!t||n.length!==t.length)return!0;for(var r=0;r<n.length;r++)if(n[r]!==t[r])return!0;return!1}function parseInt10(n){return parseInt(n,10)}function getSize$1(n,t,r){var a=["width","height"][t],o=["clientWidth","clientHeight"][t],u=["paddingLeft","paddingTop"][t],s=["paddingRight","paddingBottom"][t];if(r[a]!=null&&r[a]!=="auto")return parseFloat(r[a]);var c=document.defaultView.getComputedStyle(n);return(n[o]||parseInt10(c[a])||parseInt10(n.style[a]))-(parseInt10(c[u])||0)-(parseInt10(c[s])||0)|0}function normalizeLineDash(n,t){return!n||n==="solid"||!(t>0)?null:n==="dashed"?[4*t,2*t]:n==="dotted"?[t]:isNumber(n)?[n]:isArray$2(n)?n:null}function getLineDash(n){var t=n.style,r=t.lineDash&&t.lineWidth>0&&normalizeLineDash(t.lineDash,t.lineWidth),a=t.lineDashOffset;if(r){var o=t.strokeNoScale&&n.getLineScale?n.getLineScale():1;o&&o!==1&&(r=map$1(r,function(u){return u/o}),a/=o)}return[r,a]}var pathProxyForDraw=new PathProxy(!0);function styleHasStroke(n){var t=n.stroke;return!(t==null||t==="none"||!(n.lineWidth>0))}function isValidStrokeFillStyle(n){return typeof n=="string"&&n!=="none"}function styleHasFill(n){var t=n.fill;return t!=null&&t!=="none"}function doFillPath(n,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=n.globalAlpha;n.globalAlpha=t.fillOpacity*t.opacity,n.fill(),n.globalAlpha=r}else n.fill()}function doStrokePath(n,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=n.globalAlpha;n.globalAlpha=t.strokeOpacity*t.opacity,n.stroke(),n.globalAlpha=r}else n.stroke()}function createCanvasPattern(n,t,r){var a=createOrUpdateImage(t.image,t.__image,r);if(isImageReady(a)){var o=n.createPattern(a,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&o&&o.setTransform){var u=new DOMMatrix;u.translateSelf(t.x||0,t.y||0),u.rotateSelf(0,0,(t.rotation||0)*RADIAN_TO_DEGREE),u.scaleSelf(t.scaleX||1,t.scaleY||1),o.setTransform(u)}return o}}function brushPath(n,t,r,a){var o,u=styleHasStroke(r),s=styleHasFill(r),c=r.strokePercent,l=c<1,d=!t.path;(!t.silent||l)&&d&&t.createPathProxy();var f=t.path||pathProxyForDraw,h=t.__dirty;if(!a){var v=r.fill,g=r.stroke,b=s&&!!v.colorStops,_=u&&!!g.colorStops,S=s&&!!v.image,T=u&&!!g.image,w=void 0,A=void 0,R=void 0,E=void 0,I=void 0;(b||_)&&(I=t.getBoundingRect()),b&&(w=h?getCanvasGradient(n,v,I):t.__canvasFillGradient,t.__canvasFillGradient=w),_&&(A=h?getCanvasGradient(n,g,I):t.__canvasStrokeGradient,t.__canvasStrokeGradient=A),S&&(R=h||!t.__canvasFillPattern?createCanvasPattern(n,v,t):t.__canvasFillPattern,t.__canvasFillPattern=R),T&&(E=h||!t.__canvasStrokePattern?createCanvasPattern(n,g,t):t.__canvasStrokePattern,t.__canvasStrokePattern=R),b?n.fillStyle=w:S&&(R?n.fillStyle=R:s=!1),_?n.strokeStyle=A:T&&(E?n.strokeStyle=E:u=!1)}var L=t.getGlobalScale();f.setScale(L[0],L[1],t.segmentIgnoreThreshold);var F,D;n.setLineDash&&r.lineDash&&(o=getLineDash(t),F=o[0],D=o[1]);var $=!0;(d||h&SHAPE_CHANGED_BIT)&&(f.setDPR(n.dpr),l?f.setContext(null):(f.setContext(n),$=!1),f.reset(),t.buildPath(f,t.shape,a),f.toStatic(),t.pathUpdated()),$&&f.rebuildPath(n,l?c:1),F&&(n.setLineDash(F),n.lineDashOffset=D),a||(r.strokeFirst?(u&&doStrokePath(n,r),s&&doFillPath(n,r)):(s&&doFillPath(n,r),u&&doStrokePath(n,r))),F&&n.setLineDash([])}function brushImage(n,t,r){var a=t.__image=createOrUpdateImage(r.image,t.__image,t,t.onload);if(!(!a||!isImageReady(a))){var o=r.x||0,u=r.y||0,s=t.getWidth(),c=t.getHeight(),l=a.width/a.height;if(s==null&&c!=null?s=c*l:c==null&&s!=null?c=s/l:s==null&&c==null&&(s=a.width,c=a.height),r.sWidth&&r.sHeight){var d=r.sx||0,f=r.sy||0;n.drawImage(a,d,f,r.sWidth,r.sHeight,o,u,s,c)}else if(r.sx&&r.sy){var d=r.sx,f=r.sy,h=s-d,v=c-f;n.drawImage(a,d,f,h,v,o,u,s,c)}else n.drawImage(a,o,u,s,c)}}function brushText(n,t,r){var a,o=r.text;if(o!=null&&(o+=""),o){n.font=r.font||DEFAULT_FONT,n.textAlign=r.textAlign,n.textBaseline=r.textBaseline;var u=void 0,s=void 0;n.setLineDash&&r.lineDash&&(a=getLineDash(t),u=a[0],s=a[1]),u&&(n.setLineDash(u),n.lineDashOffset=s),r.strokeFirst?(styleHasStroke(r)&&n.strokeText(o,r.x,r.y),styleHasFill(r)&&n.fillText(o,r.x,r.y)):(styleHasFill(r)&&n.fillText(o,r.x,r.y),styleHasStroke(r)&&n.strokeText(o,r.x,r.y)),u&&n.setLineDash([])}}var SHADOW_NUMBER_PROPS=["shadowBlur","shadowOffsetX","shadowOffsetY"],STROKE_PROPS=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function bindCommonProps(n,t,r,a,o){var u=!1;if(!a&&(r=r||{},t===r))return!1;if(a||t.opacity!==r.opacity){flushPathDrawn(n,o),u=!0;var s=Math.max(Math.min(t.opacity,1),0);n.globalAlpha=isNaN(s)?DEFAULT_COMMON_STYLE.opacity:s}(a||t.blend!==r.blend)&&(u||(flushPathDrawn(n,o),u=!0),n.globalCompositeOperation=t.blend||DEFAULT_COMMON_STYLE.blend);for(var c=0;c<SHADOW_NUMBER_PROPS.length;c++){var l=SHADOW_NUMBER_PROPS[c];(a||t[l]!==r[l])&&(u||(flushPathDrawn(n,o),u=!0),n[l]=n.dpr*(t[l]||0))}return(a||t.shadowColor!==r.shadowColor)&&(u||(flushPathDrawn(n,o),u=!0),n.shadowColor=t.shadowColor||DEFAULT_COMMON_STYLE.shadowColor),u}function bindPathAndTextCommonStyle(n,t,r,a,o){var u=getStyle(t,o.inHover),s=a?null:r&&getStyle(r,o.inHover)||{};if(u===s)return!1;var c=bindCommonProps(n,u,s,a,o);if((a||u.fill!==s.fill)&&(c||(flushPathDrawn(n,o),c=!0),isValidStrokeFillStyle(u.fill)&&(n.fillStyle=u.fill)),(a||u.stroke!==s.stroke)&&(c||(flushPathDrawn(n,o),c=!0),isValidStrokeFillStyle(u.stroke)&&(n.strokeStyle=u.stroke)),(a||u.opacity!==s.opacity)&&(c||(flushPathDrawn(n,o),c=!0),n.globalAlpha=u.opacity==null?1:u.opacity),t.hasStroke()){var l=u.lineWidth,d=l/(u.strokeNoScale&&t.getLineScale?t.getLineScale():1);n.lineWidth!==d&&(c||(flushPathDrawn(n,o),c=!0),n.lineWidth=d)}for(var f=0;f<STROKE_PROPS.length;f++){var h=STROKE_PROPS[f],v=h[0];(a||u[v]!==s[v])&&(c||(flushPathDrawn(n,o),c=!0),n[v]=u[v]||h[1])}return c}function bindImageStyle(n,t,r,a,o){return bindCommonProps(n,getStyle(t,o.inHover),r&&getStyle(r,o.inHover),a,o)}function setContextTransform$1(n,t){var r=t.transform,a=n.dpr||1;r?n.setTransform(a*r[0],a*r[1],a*r[2],a*r[3],a*r[4],a*r[5]):n.setTransform(a,0,0,a,0,0)}function updateClipStatus(n,t,r){for(var a=!1,o=0;o<n.length;o++){var u=n[o];a=a||u.isZeroArea(),setContextTransform$1(t,u),t.beginPath(),u.buildPath(t,u.shape),t.clip()}r.allClipped=a}function isTransformChanged(n,t){return n&&t?n[0]!==t[0]||n[1]!==t[1]||n[2]!==t[2]||n[3]!==t[3]||n[4]!==t[4]||n[5]!==t[5]:!(!n&&!t)}var DRAW_TYPE_PATH=1,DRAW_TYPE_IMAGE=2,DRAW_TYPE_TEXT=3,DRAW_TYPE_INCREMENTAL=4;function canPathBatch(n){var t=styleHasFill(n),r=styleHasStroke(n);return!(n.lineDash||!(+t^+r)||t&&typeof n.fill!="string"||r&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function flushPathDrawn(n,t){t.batchFill&&n.fill(),t.batchStroke&&n.stroke(),t.batchFill="",t.batchStroke=""}function getStyle(n,t){return t&&n.__hoverStyle||n.style}function brushSingle(n,t){brush$1(n,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function brush$1(n,t,r,a){var o=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=-2,t.__isRendered=!1;return}var u=t.__clipPaths,s=r.prevElClipPaths,c=!1,l=!1;if((!s||isClipPathChanged(u,s))&&(s&&s.length&&(flushPathDrawn(n,r),n.restore(),l=c=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),u&&u.length&&(flushPathDrawn(n,r),n.save(),updateClipStatus(u,n,r),c=!0),r.prevElClipPaths=u),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var d=r.prevEl;d||(l=c=!0);var f=t instanceof Path&&t.autoBatch&&canPathBatch(t.style);c||isTransformChanged(o,d.transform)?(flushPathDrawn(n,r),setContextTransform$1(n,t)):f||flushPathDrawn(n,r);var h=getStyle(t,r.inHover);t instanceof Path?(r.lastDrawType!==DRAW_TYPE_PATH&&(l=!0,r.lastDrawType=DRAW_TYPE_PATH),bindPathAndTextCommonStyle(n,t,d,l,r),(!f||!r.batchFill&&!r.batchStroke)&&n.beginPath(),brushPath(n,t,h,f),f&&(r.batchFill=h.fill||"",r.batchStroke=h.stroke||"")):t instanceof TSpan?(r.lastDrawType!==DRAW_TYPE_TEXT&&(l=!0,r.lastDrawType=DRAW_TYPE_TEXT),bindPathAndTextCommonStyle(n,t,d,l,r),brushText(n,t,h)):t instanceof ZRImage?(r.lastDrawType!==DRAW_TYPE_IMAGE&&(l=!0,r.lastDrawType=DRAW_TYPE_IMAGE),bindImageStyle(n,t,d,l,r),brushImage(n,t,h)):t.getTemporalDisplayables&&(r.lastDrawType!==DRAW_TYPE_INCREMENTAL&&(l=!0,r.lastDrawType=DRAW_TYPE_INCREMENTAL),brushIncremental(n,t,r)),f&&a&&flushPathDrawn(n,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function brushIncremental(n,t,r){var a=t.getDisplayables(),o=t.getTemporalDisplayables();n.save();var u={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},s,c;for(s=t.getCursor(),c=a.length;s<c;s++){var l=a[s];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),brush$1(n,l,u,s===c-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),u.prevEl=l}for(var d=0,f=o.length;d<f;d++){var l=o[d];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),brush$1(n,l,u,d===f-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),u.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,n.restore()}var decalMap=new WeakMap$1,decalCache=new LRU(100),decalKeys=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function createOrUpdatePatternFromDecal(n,t){if(n==="none")return null;var r=t.getDevicePixelRatio(),a=t.getZr(),o=a.painter.type==="svg";n.dirty&&decalMap.delete(n);var u=decalMap.get(n);if(u)return u;var s=defaults$h(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});s.backgroundColor==="none"&&(s.backgroundColor=null);var c={repeat:"repeat"};return l(c),c.rotation=s.rotation,c.scaleX=c.scaleY=o?1:1/r,decalMap.set(n,c),n.dirty=!1,c;function l(d){for(var f=[r],h=!0,v=0;v<decalKeys.length;++v){var g=s[decalKeys[v]];if(g!=null&&!isArray$2(g)&&!isString(g)&&!isNumber(g)&&typeof g!="boolean"){h=!1;break}f.push(g)}var b;if(h){b=f.join(",")+(o?"-svg":"");var _=decalCache.get(b);_&&(o?d.svgElement=_:d.image=_)}var S=normalizeDashArrayX(s.dashArrayX),T=normalizeDashArrayY(s.dashArrayY),w=normalizeSymbolArray(s.symbol),A=getLineBlockLengthX(S),R=getLineBlockLengthY(T),E=!o&&platformApi.createCanvas(),I=o&&{tag:"g",attrs:{},key:"dcl",children:[]},L=D(),F;E&&(E.width=L.width*r,E.height=L.height*r,F=E.getContext("2d")),$(),h&&decalCache.put(b,E||I),d.image=E,d.svgElement=I,d.svgWidth=L.width,d.svgHeight=L.height;function D(){for(var O=1,P=0,C=A.length;P<C;++P)O=getLeastCommonMultiple(O,A[P]);for(var q=1,P=0,C=w.length;P<C;++P)q=getLeastCommonMultiple(q,w[P].length);O*=q;var M=R*A.length*w.length;return{width:Math.max(1,Math.min(O,s.maxTileWidth)),height:Math.max(1,Math.min(M,s.maxTileHeight))}}function $(){F&&(F.clearRect(0,0,E.width,E.height),s.backgroundColor&&(F.fillStyle=s.backgroundColor,F.fillRect(0,0,E.width,E.height)));for(var O=0,P=0;P<T.length;++P)O+=T[P];if(O<=0)return;for(var C=-R,q=0,M=0,N=0;C<L.height;){if(q%2===0){for(var G=M/2%w.length,X=0,Y=0,W=0;X<L.width*2;){for(var te=0,P=0;P<S[N].length;++P)te+=S[N][P];if(te<=0)break;if(Y%2===0){var ue=(1-s.symbolSize)*.5,fe=X+S[N][Y]*ue,re=C+T[q]*ue,ye=S[N][Y]*s.symbolSize,Te=T[q]*s.symbolSize,Re=W/2%w[G].length;ve(fe,re,ye,Te,w[G][Re])}X+=S[N][Y],++W,++Y,Y===S[N].length&&(Y=0)}++N,N===S.length&&(N=0)}C+=T[q],++M,++q,q===T.length&&(q=0)}function ve(ce,J,j,z,B){var U=o?1:r,Z=createSymbol$1(B,ce*U,J*U,j*U,z*U,s.color,s.symbolKeepAspect);if(o){var oe=a.painter.renderOneToVNode(Z);oe&&I.children.push(oe)}else brushSingle(F,Z)}}}}function normalizeSymbolArray(n){if(!n||n.length===0)return[["rect"]];if(isString(n))return[[n]];for(var t=!0,r=0;r<n.length;++r)if(!isString(n[r])){t=!1;break}if(t)return normalizeSymbolArray([n]);for(var a=[],r=0;r<n.length;++r)isString(n[r])?a.push([n[r]]):a.push(n[r]);return a}function normalizeDashArrayX(n){if(!n||n.length===0)return[[0,0]];if(isNumber(n)){var t=Math.ceil(n);return[[t,t]]}for(var r=!0,a=0;a<n.length;++a)if(!isNumber(n[a])){r=!1;break}if(r)return normalizeDashArrayX([n]);for(var o=[],a=0;a<n.length;++a)if(isNumber(n[a])){var t=Math.ceil(n[a]);o.push([t,t])}else{var t=map$1(n[a],function(c){return Math.ceil(c)});t.length%2===1?o.push(t.concat(t)):o.push(t)}return o}function normalizeDashArrayY(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(isNumber(n)){var t=Math.ceil(n);return[t,t]}var r=map$1(n,function(a){return Math.ceil(a)});return n.length%2?r.concat(r):r}function getLineBlockLengthX(n){return map$1(n,function(t){return getLineBlockLengthY(t)})}function getLineBlockLengthY(n){for(var t=0,r=0;r<n.length;++r)t+=n[r];return n.length%2===1?t*2:t}function decalVisual(n,t){n.eachRawSeries(function(r){if(!n.isSeriesFiltered(r)){var a=r.getData();a.hasItemVisual()&&a.each(function(s){var c=a.getItemVisual(s,"decal");if(c){var l=a.ensureUniqueItemVisual(s,"style");l.decal=createOrUpdatePatternFromDecal(c,t)}});var o=a.getVisual("decal");if(o){var u=a.getVisual("style");u.decal=createOrUpdatePatternFromDecal(o,t)}}})}var lifecycle=new Eventful,implsStore={};function registerImpl(n,t){implsStore[n]=t}function getImpl(n){return implsStore[n]}var TEST_FRAME_REMAIN_TIME=1,PRIORITY_PROCESSOR_SERIES_FILTER=800,PRIORITY_PROCESSOR_DATASTACK=900,PRIORITY_PROCESSOR_FILTER=1e3,PRIORITY_PROCESSOR_DEFAULT=2e3,PRIORITY_PROCESSOR_STATISTIC=5e3,PRIORITY_VISUAL_LAYOUT=1e3,PRIORITY_VISUAL_PROGRESSIVE_LAYOUT=1100,PRIORITY_VISUAL_GLOBAL=2e3,PRIORITY_VISUAL_CHART=3e3,PRIORITY_VISUAL_COMPONENT=4e3,PRIORITY_VISUAL_CHART_DATA_CUSTOM=4500,PRIORITY_VISUAL_POST_CHART_LAYOUT=4600,PRIORITY_VISUAL_BRUSH=5e3,PRIORITY_VISUAL_ARIA=6e3,PRIORITY_VISUAL_DECAL=7e3,PRIORITY={PROCESSOR:{FILTER:PRIORITY_PROCESSOR_FILTER,SERIES_FILTER:PRIORITY_PROCESSOR_SERIES_FILTER,STATISTIC:PRIORITY_PROCESSOR_STATISTIC},VISUAL:{LAYOUT:PRIORITY_VISUAL_LAYOUT,PROGRESSIVE_LAYOUT:PRIORITY_VISUAL_PROGRESSIVE_LAYOUT,GLOBAL:PRIORITY_VISUAL_GLOBAL,CHART:PRIORITY_VISUAL_CHART,POST_CHART_LAYOUT:PRIORITY_VISUAL_POST_CHART_LAYOUT,COMPONENT:PRIORITY_VISUAL_COMPONENT,BRUSH:PRIORITY_VISUAL_BRUSH,CHART_ITEM:PRIORITY_VISUAL_CHART_DATA_CUSTOM,ARIA:PRIORITY_VISUAL_ARIA,DECAL:PRIORITY_VISUAL_DECAL}},IN_MAIN_PROCESS_KEY="__flagInMainProcess",PENDING_UPDATE="__pendingUpdate",STATUS_NEEDS_UPDATE_KEY="__needsUpdateStatus",ACTION_REG=/^[a-zA-Z0-9_]+$/;function createRegisterEventWithLowercaseECharts(n){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return toLowercaseNameAndCallEventful(this,n,t)}}function createRegisterEventWithLowercaseMessageCenter(n){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return toLowercaseNameAndCallEventful(this,n,t)}}function toLowercaseNameAndCallEventful(n,t,r){return r[0]=r[0]&&r[0].toLowerCase(),Eventful.prototype[t].apply(n,r)}var MessageCenter=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(Eventful),messageCenterProto=MessageCenter.prototype;messageCenterProto.on=createRegisterEventWithLowercaseMessageCenter("on");messageCenterProto.off=createRegisterEventWithLowercaseMessageCenter("off");var prepare,prepareView,updateDirectly,updateMethods,doConvertPixel,updateStreamModes,doDispatchAction,flushPendingActions,triggerUpdatedEvent,bindRenderedEvent,bindMouseEvent,render,renderComponents,renderSeries,createExtensionAPI,markStatusToUpdate,applyChangedStates,ECharts=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this,new ECEventProcessor)||this;u._chartsViews=[],u._chartsMap={},u._componentsViews=[],u._componentsMap={},u._pendingActions=[],o=o||{},isString(a)&&(a=themeStorage[a]),u._dom=r;var s="canvas",c="auto",l=!1;o.ssr&&registerSSRDataGetter(function(v){var g=getECData(v),b=g.dataIndex;if(b!=null){var _=createHashMap();return _.set("series_index",g.seriesIndex),_.set("data_index",b),g.ssrType&&_.set("ssr_type",g.ssrType),_}});var d=u._zr=init$1(r,{renderer:o.renderer||s,devicePixelRatio:o.devicePixelRatio,width:o.width,height:o.height,ssr:o.ssr,useDirtyRect:retrieve2(o.useDirtyRect,l),useCoarsePointer:retrieve2(o.useCoarsePointer,c),pointerSize:o.pointerSize});u._ssr=o.ssr,u._throttledZrFlush=throttle(bind$1(d.flush,d),17),a=clone$5(a),a&&globalBackwardCompat(a,!0),u._theme=a,u._locale=createLocaleObject(o.locale||SYSTEM_LANG),u._coordSysMgr=new CoordinateSystemManager;var f=u._api=createExtensionAPI(u);function h(v,g){return v.__prio-g.__prio}return sort$2(visualFuncs,h),sort$2(dataProcessorFuncs,h),u._scheduler=new Scheduler(u,f,dataProcessorFuncs,visualFuncs),u._messageCenter=new MessageCenter,u._initEvents(),u.resize=bind$1(u.resize,u),d.animation.on("frame",u._onframe,u),bindRenderedEvent(d,u),bindMouseEvent(d,u),setAsPrimitive(u),u}return t.prototype._onframe=function(){if(!this._disposed){applyChangedStates(this);var r=this._scheduler;if(this[PENDING_UPDATE]){var a=this[PENDING_UPDATE].silent;this[IN_MAIN_PROCESS_KEY]=!0;try{prepare(this),updateMethods.update.call(this,null,this[PENDING_UPDATE].updateParams)}catch(l){throw this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,l}this._zr.flush(),this[IN_MAIN_PROCESS_KEY]=!1,this[PENDING_UPDATE]=null,flushPendingActions.call(this,a),triggerUpdatedEvent.call(this,a)}else if(r.unfinished){var o=TEST_FRAME_REMAIN_TIME,u=this._model,s=this._api;r.unfinished=!1;do{var c=+new Date;r.performSeriesTasks(u),r.performDataProcessorTasks(u),updateStreamModes(this,u),r.performVisualTasks(u),renderSeries(this,this._model,s,"remain",{}),o-=+new Date-c}while(o>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,a,o){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}var u,s,c;if(isObject$4(a)&&(o=a.lazyUpdate,u=a.silent,s=a.replaceMerge,c=a.transition,a=a.notMerge),this[IN_MAIN_PROCESS_KEY]=!0,!this._model||a){var l=new OptionManager(this._api),d=this._theme,f=this._model=new GlobalModel;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,d,this._locale,l)}this._model.setOption(r,{replaceMerge:s},optionPreprocessorFuncs);var h={seriesTransition:c,optionChanged:!0};if(o)this[PENDING_UPDATE]={silent:u,updateParams:h},this[IN_MAIN_PROCESS_KEY]=!1,this.getZr().wakeUp();else{try{prepare(this),updateMethods.update.call(this,null,h)}catch(v){throw this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,v}this._ssr||this._zr.flush(),this[PENDING_UPDATE]=null,this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,u),triggerUpdatedEvent.call(this,u)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||env.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var a=this._zr.painter;return a.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var a=this._zr.painter;return a.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(env.svgSupported){var r=this._zr,a=r.storage.getDisplayList();return each$f(a,function(o){o.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var a=r.excludeComponents,o=this._model,u=[],s=this;each$f(a,function(l){o.eachComponent({mainType:l},function(d){var f=s._componentsMap[d.__viewId];f.group.ignore||(u.push(f),f.group.ignore=!0)})});var c=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return each$f(u,function(l){l.group.ignore=!1}),c},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var a=r.type==="svg",o=this.group,u=Math.min,s=Math.max,c=1/0;if(connectedGroups[o]){var l=c,d=c,f=-c,h=-c,v=[],g=r&&r.pixelRatio||this.getDevicePixelRatio();each$f(instances,function(A,R){if(A.group===o){var E=a?A.getZr().painter.getSvgDom().innerHTML:A.renderToCanvas(clone$5(r)),I=A.getDom().getBoundingClientRect();l=u(I.left,l),d=u(I.top,d),f=s(I.right,f),h=s(I.bottom,h),v.push({dom:E,left:I.left,top:I.top})}}),l*=g,d*=g,f*=g,h*=g;var b=f-l,_=h-d,S=platformApi.createCanvas(),T=init$1(S,{renderer:a?"svg":"canvas"});if(T.resize({width:b,height:_}),a){var w="";return each$f(v,function(A){var R=A.left-l,E=A.top-d;w+='<g transform="translate('+R+","+E+')">'+A.dom+"</g>"}),T.painter.getSvgRoot().innerHTML=w,r.connectedBackgroundColor&&T.painter.setBackgroundColor(r.connectedBackgroundColor),T.refreshImmediately(),T.painter.toDataURL()}else return r.connectedBackgroundColor&&T.add(new Rect$2({shape:{x:0,y:0,width:b,height:_},style:{fill:r.connectedBackgroundColor}})),each$f(v,function(A){var R=new ZRImage({style:{x:A.left*g-l,y:A.top*g-d,image:A.dom}});T.add(R)}),T.refreshImmediately(),S.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,a){return doConvertPixel(this,"convertToPixel",r,a)},t.prototype.convertFromPixel=function(r,a){return doConvertPixel(this,"convertFromPixel",r,a)},t.prototype.containPixel=function(r,a){if(this._disposed){this.id;return}var o=this._model,u,s=parseFinder$1(o,r);return each$f(s,function(c,l){l.indexOf("Models")>=0&&each$f(c,function(d){var f=d.coordinateSystem;if(f&&f.containPoint)u=u||!!f.containPoint(a);else if(l==="seriesModels"){var h=this._chartsMap[d.__viewId];h&&h.containPoint&&(u=u||h.containPoint(a,d))}},this)},this),!!u},t.prototype.getVisual=function(r,a){var o=this._model,u=parseFinder$1(o,r,{defaultMainType:"series"}),s=u.seriesModel,c=s.getData(),l=u.hasOwnProperty("dataIndexInside")?u.dataIndexInside:u.hasOwnProperty("dataIndex")?c.indexOfRawIndex(u.dataIndex):null;return l!=null?getItemVisualFromData(c,l,a):getVisualFromData(c,a)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;each$f(MOUSE_EVENT_NAMES,function(a){var o=function(u){var s=r.getModel(),c=u.target,l,d=a==="globalout";if(d?l={}:c&&findEventDispatcher(c,function(b){var _=getECData(b);if(_&&_.dataIndex!=null){var S=_.dataModel||s.getSeriesByIndex(_.seriesIndex);return l=S&&S.getDataParams(_.dataIndex,_.dataType,c)||{},!0}else if(_.eventData)return l=extend$1({},_.eventData),!0},!0),l){var f=l.componentType,h=l.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",h=l.seriesIndex);var v=f&&h!=null&&s.getComponent(f,h),g=v&&r[v.mainType==="series"?"_chartsMap":"_componentsMap"][v.__viewId];l.event=u,l.type=a,r._$eventProcessor.eventInfo={targetEl:c,packedEvent:l,model:v,view:g},r.trigger(a,l)}};o.zrEventfulCallAtLast=!0,r._zr.on(a,o,r)}),each$f(eventActionMap,function(a,o){r._messageCenter.on(o,function(u){this.trigger(o,u)},r)}),each$f(["selectchanged"],function(a){r._messageCenter.on(a,function(o){this.trigger(a,o)},r)}),handleLegacySelectEvents(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&setAttribute(this.getDom(),DOM_ATTRIBUTE_KEY,"");var a=this,o=a._api,u=a._model;each$f(a._componentsViews,function(s){s.dispose(u,o)}),each$f(a._chartsViews,function(s){s.dispose(u,o)}),a._zr.dispose(),a._dom=a._model=a._chartsMap=a._componentsMap=a._chartsViews=a._componentsViews=a._scheduler=a._api=a._zr=a._throttledZrFlush=a._theme=a._coordSysMgr=a._messageCenter=null,delete instances[a.id]},t.prototype.resize=function(r){if(!this[IN_MAIN_PROCESS_KEY]){if(this._disposed){this.id;return}this._zr.resize(r);var a=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!a){var o=a.resetOption("media"),u=r&&r.silent;this[PENDING_UPDATE]&&(u==null&&(u=this[PENDING_UPDATE].silent),o=!0,this[PENDING_UPDATE]=null),this[IN_MAIN_PROCESS_KEY]=!0;try{o&&prepare(this),updateMethods.update.call(this,{type:"resize",animation:extend$1({duration:0},r&&r.animation)})}catch(s){throw this[IN_MAIN_PROCESS_KEY]=!1,s}this[IN_MAIN_PROCESS_KEY]=!1,flushPendingActions.call(this,u),triggerUpdatedEvent.call(this,u)}}},t.prototype.showLoading=function(r,a){if(this._disposed){this.id;return}if(isObject$4(r)&&(a=r,r=""),r=r||"default",this.hideLoading(),!!loadingEffects[r]){var o=loadingEffects[r](this._api,a),u=this._zr;this._loadingFX=o,u.add(o)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var a=extend$1({},r);return a.type=eventActionMap[r.type],a},t.prototype.dispatchAction=function(r,a){if(this._disposed){this.id;return}if(isObject$4(a)||(a={silent:!!a}),!!actions[r.type]&&this._model){if(this[IN_MAIN_PROCESS_KEY]){this._pendingActions.push(r);return}var o=a.silent;doDispatchAction.call(this,r,o);var u=a.flush;u?this._zr.flush():u!==!1&&env.browser.weChat&&this._throttledZrFlush(),flushPendingActions.call(this,o),triggerUpdatedEvent.call(this,o)}},t.prototype.updateLabelLayout=function(){lifecycle.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var a=r.seriesIndex,o=this.getModel(),u=o.getSeriesByIndex(a);u.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){prepare=function(h){var v=h._scheduler;v.restorePipelines(h._model),v.prepareStageTasks(),prepareView(h,!0),prepareView(h,!1),v.plan()},prepareView=function(h,v){for(var g=h._model,b=h._scheduler,_=v?h._componentsViews:h._chartsViews,S=v?h._componentsMap:h._chartsMap,T=h._zr,w=h._api,A=0;A<_.length;A++)_[A].__alive=!1;v?g.eachComponent(function(I,L){I!=="series"&&R(L)}):g.eachSeries(R);function R(I){var L=I.__requireNewView;I.__requireNewView=!1;var F="_ec_"+I.id+"_"+I.type,D=!L&&S[F];if(!D){var $=parseClassType(I.type),O=v?ComponentView.getClass($.main,$.sub):ChartView.getClass($.sub);D=new O,D.init(g,w),S[F]=D,_.push(D),T.add(D.group)}I.__viewId=D.__id=F,D.__alive=!0,D.__model=I,D.group.__ecComponentInfo={mainType:I.mainType,index:I.componentIndex},!v&&b.prepareView(D,I,g,w)}for(var A=0;A<_.length;){var E=_[A];E.__alive?A++:(!v&&E.renderTask.dispose(),T.remove(E.group),E.dispose(g,w),_.splice(A,1),S[E.__id]===E&&delete S[E.__id],E.__id=E.group.__ecComponentInfo=null)}},updateDirectly=function(h,v,g,b,_){var S=h._model;if(S.setUpdatePayload(g),!b){each$f([].concat(h._componentsViews).concat(h._chartsViews),E);return}var T={};T[b+"Id"]=g[b+"Id"],T[b+"Index"]=g[b+"Index"],T[b+"Name"]=g[b+"Name"];var w={mainType:b,query:T};_&&(w.subType=_);var A=g.excludeSeriesId,R;A!=null&&(R=createHashMap(),each$f(normalizeToArray(A),function(I){var L=convertOptionIdName(I,null);L!=null&&R.set(L,!0)})),S&&S.eachComponent(w,function(I){var L=R&&R.get(I.id)!=null;if(!L)if(isHighDownPayload(g))if(I instanceof SeriesModel)g.type===HIGHLIGHT_ACTION_TYPE&&!g.notBlur&&!I.get(["emphasis","disabled"])&&blurSeriesFromHighlightPayload(I,g,h._api);else{var F=findComponentHighDownDispatchers(I.mainType,I.componentIndex,g.name,h._api),D=F.focusSelf,$=F.dispatchers;g.type===HIGHLIGHT_ACTION_TYPE&&D&&!g.notBlur&&blurComponent(I.mainType,I.componentIndex,h._api),$&&each$f($,function(O){g.type===HIGHLIGHT_ACTION_TYPE?enterEmphasis(O):leaveEmphasis(O)})}else isSelectChangePayload(g)&&I instanceof SeriesModel&&(toggleSelectionFromPayload(I,g,h._api),updateSeriesElementSelection(I),markStatusToUpdate(h))},h),S&&S.eachComponent(w,function(I){var L=R&&R.get(I.id)!=null;L||E(h[b==="series"?"_chartsMap":"_componentsMap"][I.__viewId])},h);function E(I){I&&I.__alive&&I[v]&&I[v](I.__model,S,h._api,g)}},updateMethods={prepareAndUpdate:function(h){prepare(this),updateMethods.update.call(this,h,{optionChanged:h.newOption!=null})},update:function(h,v){var g=this._model,b=this._api,_=this._zr,S=this._coordSysMgr,T=this._scheduler;if(g){g.setUpdatePayload(h),T.restoreData(g,h),T.performSeriesTasks(g),S.create(g,b),T.performDataProcessorTasks(g,h),updateStreamModes(this,g),S.update(g,b),r(g),T.performVisualTasks(g,h),render(this,g,b,h,v);var w=g.get("backgroundColor")||"transparent",A=g.get("darkMode");_.setBackgroundColor(w),A!=null&&A!=="auto"&&_.setDarkMode(A),lifecycle.trigger("afterupdate",g,b)}},updateTransform:function(h){var v=this,g=this._model,b=this._api;if(g){g.setUpdatePayload(h);var _=[];g.eachComponent(function(T,w){if(T!=="series"){var A=v.getViewOfComponentModel(w);if(A&&A.__alive)if(A.updateTransform){var R=A.updateTransform(w,g,b,h);R&&R.update&&_.push(A)}else _.push(A)}});var S=createHashMap();g.eachSeries(function(T){var w=v._chartsMap[T.__viewId];if(w.updateTransform){var A=w.updateTransform(T,g,b,h);A&&A.update&&S.set(T.uid,1)}else S.set(T.uid,1)}),r(g),this._scheduler.performVisualTasks(g,h,{setDirty:!0,dirtyMap:S}),renderSeries(this,g,b,h,{},S),lifecycle.trigger("afterupdate",g,b)}},updateView:function(h){var v=this._model;v&&(v.setUpdatePayload(h),ChartView.markUpdateMethod(h,"updateView"),r(v),this._scheduler.performVisualTasks(v,h,{setDirty:!0}),render(this,v,this._api,h,{}),lifecycle.trigger("afterupdate",v,this._api))},updateVisual:function(h){var v=this,g=this._model;g&&(g.setUpdatePayload(h),g.eachSeries(function(b){b.getData().clearAllVisual()}),ChartView.markUpdateMethod(h,"updateVisual"),r(g),this._scheduler.performVisualTasks(g,h,{visualType:"visual",setDirty:!0}),g.eachComponent(function(b,_){if(b!=="series"){var S=v.getViewOfComponentModel(_);S&&S.__alive&&S.updateVisual(_,g,v._api,h)}}),g.eachSeries(function(b){var _=v._chartsMap[b.__viewId];_.updateVisual(b,g,v._api,h)}),lifecycle.trigger("afterupdate",g,this._api))},updateLayout:function(h){updateMethods.update.call(this,h)}},doConvertPixel=function(h,v,g,b){if(h._disposed){h.id;return}for(var _=h._model,S=h._coordSysMgr.getCoordinateSystems(),T,w=parseFinder$1(_,g),A=0;A<S.length;A++){var R=S[A];if(R[v]&&(T=R[v](_,w,b))!=null)return T}},updateStreamModes=function(h,v){var g=h._chartsMap,b=h._scheduler;v.eachSeries(function(_){b.updateStreamModes(_,g[_.__viewId])})},doDispatchAction=function(h,v){var g=this,b=this.getModel(),_=h.type,S=h.escapeConnect,T=actions[_],w=T.actionInfo,A=(w.update||"update").split(":"),R=A.pop(),E=A[0]!=null&&parseClassType(A[0]);this[IN_MAIN_PROCESS_KEY]=!0;var I=[h],L=!1;h.batch&&(L=!0,I=map$1(h.batch,function(q){return q=defaults$h(extend$1({},q),h),q.batch=null,q}));var F=[],D,$=isSelectChangePayload(h),O=isHighDownPayload(h);if(O&&allLeaveBlur(this._api),each$f(I,function(q){if(D=T.action(q,g._model,g._api),D=D||extend$1({},q),D.type=w.event||D.type,F.push(D),O){var M=preParseFinder(h),N=M.queryOptionMap,G=M.mainTypeSpecified,X=G?N.keys()[0]:"series";updateDirectly(g,R,q,X),markStatusToUpdate(g)}else $?(updateDirectly(g,R,q,"series"),markStatusToUpdate(g)):E&&updateDirectly(g,R,q,E.main,E.sub)}),R!=="none"&&!O&&!$&&!E)try{this[PENDING_UPDATE]?(prepare(this),updateMethods.update.call(this,h),this[PENDING_UPDATE]=null):updateMethods[R].call(this,h)}catch(q){throw this[IN_MAIN_PROCESS_KEY]=!1,q}if(L?D={type:w.event||_,escapeConnect:S,batch:F}:D=F[0],this[IN_MAIN_PROCESS_KEY]=!1,!v){var P=this._messageCenter;if(P.trigger(D.type,D),$){var C={type:"selectchanged",escapeConnect:S,selected:getAllSelectedIndices(b),isFromClick:h.isFromClick||!1,fromAction:h.type,fromActionPayload:h};P.trigger(C.type,C)}}},flushPendingActions=function(h){for(var v=this._pendingActions;v.length;){var g=v.shift();doDispatchAction.call(this,g,h)}},triggerUpdatedEvent=function(h){!h&&this.trigger("updated")},bindRenderedEvent=function(h,v){h.on("rendered",function(g){v.trigger("rendered",g),h.animation.isFinished()&&!v[PENDING_UPDATE]&&!v._scheduler.unfinished&&!v._pendingActions.length&&v.trigger("finished")})},bindMouseEvent=function(h,v){h.on("mouseover",function(g){var b=g.target,_=findEventDispatcher(b,isHighDownDispatcher);_&&(handleGlobalMouseOverForHighDown(_,g,v._api),markStatusToUpdate(v))}).on("mouseout",function(g){var b=g.target,_=findEventDispatcher(b,isHighDownDispatcher);_&&(handleGlobalMouseOutForHighDown(_,g,v._api),markStatusToUpdate(v))}).on("click",function(g){var b=g.target,_=findEventDispatcher(b,function(w){return getECData(w).dataIndex!=null},!0);if(_){var S=_.selected?"unselect":"select",T=getECData(_);v._api.dispatchAction({type:S,dataType:T.dataType,dataIndexInside:T.dataIndex,seriesIndex:T.seriesIndex,isFromClick:!0})}})};function r(h){h.clearColorPalette(),h.eachSeries(function(v){v.clearColorPalette()})}function a(h){var v=[],g=[],b=!1;if(h.eachComponent(function(w,A){var R=A.get("zlevel")||0,E=A.get("z")||0,I=A.getZLevelKey();b=b||!!I,(w==="series"?g:v).push({zlevel:R,z:E,idx:A.componentIndex,type:w,key:I})}),b){var _=v.concat(g),S,T;sort$2(_,function(w,A){return w.zlevel===A.zlevel?w.z-A.z:w.zlevel-A.zlevel}),each$f(_,function(w){var A=h.getComponent(w.type,w.idx),R=w.zlevel,E=w.key;S!=null&&(R=Math.max(S,R)),E?(R===S&&E!==T&&R++,T=E):T&&(R===S&&R++,T=""),S=R,A.setZLevel(R)})}}render=function(h,v,g,b,_){a(v),renderComponents(h,v,g,b,_),each$f(h._chartsViews,function(S){S.__alive=!1}),renderSeries(h,v,g,b,_),each$f(h._chartsViews,function(S){S.__alive||S.remove(v,g)})},renderComponents=function(h,v,g,b,_,S){each$f(S||h._componentsViews,function(T){var w=T.__model;d(w,T),T.render(w,v,g,b),c(w,T),f(w,T)})},renderSeries=function(h,v,g,b,_,S){var T=h._scheduler;_=extend$1(_||{},{updatedSeries:v.getSeries()}),lifecycle.trigger("series:beforeupdate",v,g,_);var w=!1;v.eachSeries(function(A){var R=h._chartsMap[A.__viewId];R.__alive=!0;var E=R.renderTask;T.updatePayload(E,b),d(A,R),S&&S.get(A.uid)&&E.dirty(),E.perform(T.getPerformArgs(E))&&(w=!0),R.group.silent=!!A.get("silent"),s(A,R),updateSeriesElementSelection(A)}),T.unfinished=w||T.unfinished,lifecycle.trigger("series:layoutlabels",v,g,_),lifecycle.trigger("series:transition",v,g,_),v.eachSeries(function(A){var R=h._chartsMap[A.__viewId];c(A,R),f(A,R)}),u(h,v),lifecycle.trigger("series:afterupdate",v,g,_)},markStatusToUpdate=function(h){h[STATUS_NEEDS_UPDATE_KEY]=!0,h.getZr().wakeUp()},applyChangedStates=function(h){h[STATUS_NEEDS_UPDATE_KEY]&&(h.getZr().storage.traverse(function(v){isElementRemoved(v)||o(v)}),h[STATUS_NEEDS_UPDATE_KEY]=!1)};function o(h){for(var v=[],g=h.currentStates,b=0;b<g.length;b++){var _=g[b];_==="emphasis"||_==="blur"||_==="select"||v.push(_)}h.selected&&h.states.select&&v.push("select"),h.hoverState===HOVER_STATE_EMPHASIS&&h.states.emphasis?v.push("emphasis"):h.hoverState===HOVER_STATE_BLUR&&h.states.blur&&v.push("blur"),h.useStates(v)}function u(h,v){var g=h._zr,b=g.storage,_=0;b.traverse(function(S){S.isGroup||_++}),_>v.get("hoverLayerThreshold")&&!env.node&&!env.worker&&v.eachSeries(function(S){if(!S.preventUsingHoverLayer){var T=h._chartsMap[S.__viewId];T.__alive&&T.eachRendered(function(w){w.states.emphasis&&(w.states.emphasis.hoverLayer=!0)})}})}function s(h,v){var g=h.get("blendMode")||null;v.eachRendered(function(b){b.isGroup||(b.style.blend=g)})}function c(h,v){if(!h.preventAutoZ){var g=h.get("z")||0,b=h.get("zlevel")||0;v.eachRendered(function(_){return l(_,g,b,-1/0),!0})}}function l(h,v,g,b){var _=h.getTextContent(),S=h.getTextGuideLine(),T=h.isGroup;if(T)for(var w=h.childrenRef(),A=0;A<w.length;A++)b=Math.max(l(w[A],v,g,b),b);else h.z=v,h.zlevel=g,b=Math.max(h.z2,b);if(_&&(_.z=v,_.zlevel=g,isFinite(b)&&(_.z2=b+2)),S){var R=h.textGuideLineConfig;S.z=v,S.zlevel=g,isFinite(b)&&(S.z2=b+(R&&R.showAbove?1:-1))}return b}function d(h,v){v.eachRendered(function(g){if(!isElementRemoved(g)){var b=g.getTextContent(),_=g.getTextGuideLine();g.stateTransition&&(g.stateTransition=null),b&&b.stateTransition&&(b.stateTransition=null),_&&_.stateTransition&&(_.stateTransition=null),g.hasState()?(g.prevStates=g.currentStates,g.clearStates()):g.prevStates&&(g.prevStates=null)}})}function f(h,v){var g=h.getModel("stateAnimation"),b=h.isAnimationEnabled(),_=g.get("duration"),S=_>0?{duration:_,delay:g.get("delay"),easing:g.get("easing")}:null;v.eachRendered(function(T){if(T.states&&T.states.emphasis){if(isElementRemoved(T))return;if(T instanceof Path&&savePathStates(T),T.__dirty){var w=T.prevStates;w&&T.useStates(w)}if(b){T.stateTransition=S;var A=T.getTextContent(),R=T.getTextGuideLine();A&&(A.stateTransition=S),R&&(R.stateTransition=S)}T.__dirty&&o(T)}})}createExtensionAPI=function(h){return new(function(v){__extends(g,v);function g(){return v!==null&&v.apply(this,arguments)||this}return g.prototype.getCoordinateSystems=function(){return h._coordSysMgr.getCoordinateSystems()},g.prototype.getComponentByElement=function(b){for(;b;){var _=b.__ecComponentInfo;if(_!=null)return h._model.getComponent(_.mainType,_.index);b=b.parent}},g.prototype.enterEmphasis=function(b,_){enterEmphasis(b,_),markStatusToUpdate(h)},g.prototype.leaveEmphasis=function(b,_){leaveEmphasis(b,_),markStatusToUpdate(h)},g.prototype.enterBlur=function(b){enterBlur(b),markStatusToUpdate(h)},g.prototype.leaveBlur=function(b){leaveBlur(b),markStatusToUpdate(h)},g.prototype.enterSelect=function(b){enterSelect(b),markStatusToUpdate(h)},g.prototype.leaveSelect=function(b){leaveSelect(b),markStatusToUpdate(h)},g.prototype.getModel=function(){return h.getModel()},g.prototype.getViewOfComponentModel=function(b){return h.getViewOfComponentModel(b)},g.prototype.getViewOfSeriesModel=function(b){return h.getViewOfSeriesModel(b)},g}(ExtensionAPI))(h)}}(),t}(Eventful),echartsProto=ECharts.prototype;echartsProto.on=createRegisterEventWithLowercaseECharts("on");echartsProto.off=createRegisterEventWithLowercaseECharts("off");echartsProto.one=function(n,t,r){var a=this;function o(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];t&&t.apply&&t.apply(this,u),a.off(n,o)}this.on.call(this,n,o,r)};var MOUSE_EVENT_NAMES=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function disposedWarning(n){}var actions={},eventActionMap={},dataProcessorFuncs=[],optionPreprocessorFuncs=[],visualFuncs=[],themeStorage={},loadingEffects={},instances={},connectedGroups={},DOM_ATTRIBUTE_KEY="_echarts_instance_";function registerTheme(n,t){themeStorage[n]=t}function registerPreprocessor(n){indexOf(optionPreprocessorFuncs,n)<0&&optionPreprocessorFuncs.push(n)}function registerProcessor(n,t){normalizeRegister(dataProcessorFuncs,n,t,PRIORITY_PROCESSOR_DEFAULT)}function registerPostInit(n){registerUpdateLifecycle("afterinit",n)}function registerPostUpdate(n){registerUpdateLifecycle("afterupdate",n)}function registerUpdateLifecycle(n,t){lifecycle.on(n,t)}function registerAction(n,t,r){isFunction$1(t)&&(r=t,t="");var a=isObject$4(n)?n.type:[n,n={event:t}][0];n.event=(n.event||a).toLowerCase(),t=n.event,!eventActionMap[t]&&(assert(ACTION_REG.test(a)&&ACTION_REG.test(t)),actions[a]||(actions[a]={action:r,actionInfo:n}),eventActionMap[t]=a)}function registerCoordinateSystem(n,t){CoordinateSystemManager.register(n,t)}function registerLayout(n,t){normalizeRegister(visualFuncs,n,t,PRIORITY_VISUAL_LAYOUT,"layout")}function registerVisual(n,t){normalizeRegister(visualFuncs,n,t,PRIORITY_VISUAL_CHART,"visual")}var registeredTasks=[];function normalizeRegister(n,t,r,a,o){if((isFunction$1(t)||isObject$4(t))&&(r=t,t=a),!(indexOf(registeredTasks,r)>=0)){registeredTasks.push(r);var u=Scheduler.wrapStageHandler(r,o);u.__prio=t,u.__raw=r,n.push(u)}}function registerLoading(n,t){loadingEffects[n]=t}function registerMap$1(n,t,r){var a=getImpl("registerMap");a&&a(n,t,r)}var registerTransform=registerExternalTransform;registerVisual(PRIORITY_VISUAL_GLOBAL,seriesStyleTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataStyleTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataColorPaletteTask);registerVisual(PRIORITY_VISUAL_GLOBAL,seriesSymbolTask);registerVisual(PRIORITY_VISUAL_CHART_DATA_CUSTOM,dataSymbolTask);registerVisual(PRIORITY_VISUAL_DECAL,decalVisual);registerPreprocessor(globalBackwardCompat);registerProcessor(PRIORITY_PROCESSOR_DATASTACK,dataStack);registerLoading("default",defaultLoading);registerAction({type:HIGHLIGHT_ACTION_TYPE,event:HIGHLIGHT_ACTION_TYPE,update:HIGHLIGHT_ACTION_TYPE},noop$3);registerAction({type:DOWNPLAY_ACTION_TYPE,event:DOWNPLAY_ACTION_TYPE,update:DOWNPLAY_ACTION_TYPE},noop$3);registerAction({type:SELECT_ACTION_TYPE,event:SELECT_ACTION_TYPE,update:SELECT_ACTION_TYPE},noop$3);registerAction({type:UNSELECT_ACTION_TYPE,event:UNSELECT_ACTION_TYPE,update:UNSELECT_ACTION_TYPE},noop$3);registerAction({type:TOGGLE_SELECT_ACTION_TYPE,event:TOGGLE_SELECT_ACTION_TYPE,update:TOGGLE_SELECT_ACTION_TYPE},noop$3);registerTheme("light",lightTheme);registerTheme("dark",theme);var extensions$1=[],extensionRegisters={registerPreprocessor,registerProcessor,registerPostInit,registerPostUpdate,registerUpdateLifecycle,registerAction,registerCoordinateSystem,registerLayout,registerVisual,registerTransform,registerLoading,registerMap:registerMap$1,registerImpl,PRIORITY,ComponentModel,ComponentView,SeriesModel,ChartView,registerComponentModel:function(n){ComponentModel.registerClass(n)},registerComponentView:function(n){ComponentView.registerClass(n)},registerSeriesModel:function(n){SeriesModel.registerClass(n)},registerChartView:function(n){ChartView.registerClass(n)},registerSubTypeDefaulter:function(n,t){ComponentModel.registerSubTypeDefaulter(n,t)},registerPainter:function(n,t){registerPainter(n,t)}};function use(n){if(isArray$2(n)){each$f(n,function(t){use(t)});return}indexOf(extensions$1,n)>=0||(extensions$1.push(n),isFunction$1(n)&&(n={install:n}),n.install(extensionRegisters))}function dataIndexMapValueLength(n){return n==null?0:n.length||1}function defaultKeyGetter(n){return n}var DataDiffer=function(){function n(t,r,a,o,u,s){this._old=t,this._new=r,this._oldKeyGetter=a||defaultKeyGetter,this._newKeyGetter=o||defaultKeyGetter,this.context=u,this._diffModeMultiple=s==="multiple"}return n.prototype.add=function(t){return this._add=t,this},n.prototype.update=function(t){return this._update=t,this},n.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},n.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},n.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},n.prototype.remove=function(t){return this._remove=t,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var t=this._old,r=this._new,a={},o=new Array(t.length),u=new Array(r.length);this._initIndexMap(t,null,o,"_oldKeyGetter"),this._initIndexMap(r,a,u,"_newKeyGetter");for(var s=0;s<t.length;s++){var c=o[s],l=a[c],d=dataIndexMapValueLength(l);if(d>1){var f=l.shift();l.length===1&&(a[c]=l[0]),this._update&&this._update(f,s)}else d===1?(a[c]=null,this._update&&this._update(l,s)):this._remove&&this._remove(s)}this._performRestAdd(u,a)},n.prototype._executeMultiple=function(){var t=this._old,r=this._new,a={},o={},u=[],s=[];this._initIndexMap(t,a,u,"_oldKeyGetter"),this._initIndexMap(r,o,s,"_newKeyGetter");for(var c=0;c<u.length;c++){var l=u[c],d=a[l],f=o[l],h=dataIndexMapValueLength(d),v=dataIndexMapValueLength(f);if(h>1&&v===1)this._updateManyToOne&&this._updateManyToOne(f,d),o[l]=null;else if(h===1&&v>1)this._updateOneToMany&&this._updateOneToMany(f,d),o[l]=null;else if(h===1&&v===1)this._update&&this._update(f,d),o[l]=null;else if(h>1&&v>1)this._updateManyToMany&&this._updateManyToMany(f,d),o[l]=null;else if(h>1)for(var g=0;g<h;g++)this._remove&&this._remove(d[g]);else this._remove&&this._remove(d)}this._performRestAdd(s,o)},n.prototype._performRestAdd=function(t,r){for(var a=0;a<t.length;a++){var o=t[a],u=r[o],s=dataIndexMapValueLength(u);if(s>1)for(var c=0;c<s;c++)this._add&&this._add(u[c]);else s===1&&this._add&&this._add(u);r[o]=null}},n.prototype._initIndexMap=function(t,r,a,o){for(var u=this._diffModeMultiple,s=0;s<t.length;s++){var c="_ec_"+this[o](t[s],s);if(u||(a[s]=c),!!r){var l=r[c],d=dataIndexMapValueLength(l);d===0?(r[c]=s,u&&a.push(c)):d===1?r[c]=[l,s]:l.push(s)}}},n}(),DimensionUserOuput=function(){function n(t,r){this._encode=t,this._schema=r}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function summarizeDimensions(n,t){var r={},a=r.encode={},o=createHashMap(),u=[],s=[],c={};each$f(n.dimensions,function(v){var g=n.getDimensionInfo(v),b=g.coordDim;if(b){var _=g.coordDimIndex;getOrCreateEncodeArr(a,b)[_]=v,g.isExtraCoord||(o.set(b,1),mayLabelDimType(g.type)&&(u[0]=v),getOrCreateEncodeArr(c,b)[_]=n.getDimensionIndex(g.name)),g.defaultTooltip&&s.push(v)}VISUAL_DIMENSIONS.each(function(S,T){var w=getOrCreateEncodeArr(a,T),A=g.otherDims[T];A!=null&&A!==!1&&(w[A]=g.name)})});var l=[],d={};o.each(function(v,g){var b=a[g];d[g]=b[0],l=l.concat(b)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=map$1(l,function(v){return n.getDimensionInfo(v).storeDimIndex}),r.encodeFirstDimNotExtra=d;var f=a.label;f&&f.length&&(u=f.slice());var h=a.tooltip;return h&&h.length?s=h.slice():s.length||(s=u.slice()),a.defaultedLabel=u,a.defaultedTooltip=s,r.userOutput=new DimensionUserOuput(c,t),r}function getOrCreateEncodeArr(n,t){return n.hasOwnProperty(t)||(n[t]=[]),n[t]}function getDimensionTypeByAxis(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function mayLabelDimType(n){return!(n==="ordinal"||n==="time")}var SeriesDimensionDefine=function(){function n(t){this.otherDims={},t!=null&&extend$1(this,t)}return n}(),inner$h=makeInner(),dimTypeShort={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},SeriesDataSchema=function(){function n(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=ensureSourceDimNameMap(this.source)))},n.prototype.getSourceDimensionIndex=function(t){return retrieve2(this._dimNameMap.get(t),-1)},n.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},n.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=shouldRetrieveDataByName(this.source),a=!shouldOmitUnusedDimensions(t),o="",u=[],s=0,c=0;s<t;s++){var l=void 0,d=void 0,f=void 0,h=this.dimensions[c];if(h&&h.storeDimIndex===s)l=r?h.name:null,d=h.type,f=h.ordinalMeta,c++;else{var v=this.getSourceDimension(s);v&&(l=r?v.name:null,d=v.type)}u.push({property:l,type:d,ordinalMeta:f}),r&&l!=null&&(!h||!h.isCalculationCoord)&&(o+=a?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),o+="$",o+=dimTypeShort[d]||"f",f&&(o+=f.uid),o+="$"}var g=this.source,b=[g.seriesLayoutBy,g.startIndex,o].join("$$");return{dimensions:u,hash:b}},n.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,a=0;r<this._fullDimCount;r++){var o=void 0,u=this.dimensions[a];if(u&&u.storeDimIndex===r)u.isCalculationCoord||(o=u.name),a++;else{var s=this.getSourceDimension(r);s&&(o=s.name)}t.push(o)}return t},n.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function isSeriesDataSchema(n){return n instanceof SeriesDataSchema}function createDimNameMap(n){for(var t=createHashMap(),r=0;r<(n||[]).length;r++){var a=n[r],o=isObject$4(a)?a.name:a;o!=null&&t.get(o)==null&&t.set(o,r)}return t}function ensureSourceDimNameMap(n){var t=inner$h(n);return t.dimNameMap||(t.dimNameMap=createDimNameMap(n.dimensionsDefine))}function shouldOmitUnusedDimensions(n){return n>30}var isObject$2=isObject$4,map=map$1,CtorInt32Array=typeof Int32Array>"u"?Array:Int32Array,ID_PREFIX="e\0\0",INDEX_NOT_FOUND=-1,TRANSFERABLE_PROPERTIES=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],CLONE_PROPERTIES=["_approximateExtent"],prepareInvertedIndex,getId,getIdNameFromStore,normalizeDimensions,transferProperties,cloneListForMapAndSample,makeIdFromName,SeriesData=function(){function n(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var a,o=!1;isSeriesDataSchema(t)?(a=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(o=!0,a=t),a=a||["x","y"];for(var u={},s=[],c={},l=!1,d={},f=0;f<a.length;f++){var h=a[f],v=isString(h)?new SeriesDimensionDefine({name:h}):h instanceof SeriesDimensionDefine?h:new SeriesDimensionDefine(h),g=v.name;v.type=v.type||"float",v.coordDim||(v.coordDim=g,v.coordDimIndex=0);var b=v.otherDims=v.otherDims||{};s.push(g),u[g]=v,d[g]!=null&&(l=!0),v.createInvertedIndices&&(c[g]=[]),b.itemName===0&&(this._nameDimIdx=f),b.itemId===0&&(this._idDimIdx=f),o&&(v.storeDimIndex=f)}if(this.dimensions=s,this._dimInfos=u,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=c,this._dimOmitted){var _=this._dimIdxToName=createHashMap();each$f(s,function(S){_.set(u[S].storeDimIndex,S)})}}return n.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var a=this._dimIdxToName.get(r);if(a!=null)return a;var o=this._schema.getSourceDimension(r);if(o)return o.name},n.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var a=this._getDimInfo(t);return a?a.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},n.prototype._recognizeDimIndex=function(t){if(isNumber(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},n.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},n.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},n.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(a){return r.hasOwnProperty(a)?r[a]:void 0}:function(a){return r[a]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(t,r){var a=this._dimSummary;if(r==null)return a.encodeFirstDimNotExtra[t];var o=a.encode[t];return o?o[r]:null},n.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,a=r.encode[t];return(a||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(t,r,a){var o=this,u;if(t instanceof DataStore&&(u=t),!u){var s=this.dimensions,c=isSourceInstance(t)||isArrayLike$1(t)?new DefaultDataProvider(t,s.length):t;u=new DataStore;var l=map(s,function(d){return{type:o._dimInfos[d].type,property:d}});u.initData(c,l,a)}this._store=u,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,u.count()),this._dimSummary=summarizeDimensions(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},n.prototype.appendValues=function(t,r){var a=this._store.appendValues(t,r&&r.length),o=a.start,u=a.end,s=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var c=o;c<u;c++){var l=c-o;this._nameList[c]=r[l],s&&makeIdFromName(this,c)}},n.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,a=0;a<r.length;a++){var o=this._dimInfos[r[a]];o.ordinalMeta&&t.collectOrdinalMeta(o.storeDimIndex,o.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==SOURCE_FORMAT_TYPED_ARRAY&&!t.fillStorage},n.prototype._doInit=function(t,r){if(!(t>=r)){var a=this._store,o=a.getProvider();this._updateOrdinalMeta();var u=this._nameList,s=this._idList,c=o.getSource().sourceFormat,l=c===SOURCE_FORMAT_ORIGINAL;if(l&&!o.pure)for(var d=[],f=t;f<r;f++){var h=o.getItem(f,d);if(!this.hasItemOption&&isDataItemOption(h)&&(this.hasItemOption=!0),h){var v=h.name;u[f]==null&&v!=null&&(u[f]=convertOptionIdName(v,null));var g=h.id;s[f]==null&&g!=null&&(s[f]=convertOptionIdName(g,null))}}if(this._shouldMakeIdFromName())for(var f=t;f<r;f++)makeIdFromName(this,f);prepareInvertedIndex(this)}},n.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},n.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},n.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},n.prototype.setCalculationInfo=function(t,r){isObject$2(t)?extend$1(this._calculationInfo,t):this._calculationInfo[t]=r},n.prototype.getName=function(t){var r=this.getRawIndex(t),a=this._nameList[r];return a==null&&this._nameDimIdx!=null&&(a=getIdNameFromStore(this,this._nameDimIdx,r)),a==null&&(a=""),a},n.prototype._getCategory=function(t,r){var a=this._store.get(t,r),o=this._store.getOrdinalMeta(t);return o?o.categories[a]:a},n.prototype.getId=function(t){return getId(this,this.getRawIndex(t))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(t,r){var a=this._store,o=this._dimInfos[t];if(o)return a.get(o.storeDimIndex,r)},n.prototype.getByRawIndex=function(t,r){var a=this._store,o=this._dimInfos[t];if(o)return a.getByRawIndex(o.storeDimIndex,r)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},n.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},n.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},n.prototype.getValues=function(t,r){var a=this,o=this._store;return isArray$2(t)?o.getValues(map(t,function(u){return a._getStoreDimIndex(u)}),r):o.getValues(t)},n.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,a=0,o=r.length;a<o;a++)if(isNaN(this._store.get(r[a],t)))return!1;return!0},n.prototype.indexOfName=function(t){for(var r=0,a=this._store.count();r<a;r++)if(this.getName(r)===t)return r;return-1},n.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},n.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},n.prototype.rawIndexOf=function(t,r){var a=t&&this._invertedIndicesMap[t],o=a&&a[r];return o==null||isNaN(o)?INDEX_NOT_FOUND:o},n.prototype.indicesOfNearest=function(t,r,a){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,a)},n.prototype.each=function(t,r,a){isFunction$1(t)&&(a=r,r=t,t=[]);var o=a||this,u=map(normalizeDimensions(t),this._getStoreDimIndex,this);this._store.each(u,o?bind$1(r,o):r)},n.prototype.filterSelf=function(t,r,a){isFunction$1(t)&&(a=r,r=t,t=[]);var o=a||this,u=map(normalizeDimensions(t),this._getStoreDimIndex,this);return this._store=this._store.filter(u,o?bind$1(r,o):r),this},n.prototype.selectRange=function(t){var r=this,a={},o=keys(t);return each$f(o,function(u){var s=r._getStoreDimIndex(u);a[s]=t[u]}),this._store=this._store.selectRange(a),this},n.prototype.mapArray=function(t,r,a){isFunction$1(t)&&(a=r,r=t,t=[]),a=a||this;var o=[];return this.each(t,function(){o.push(r&&r.apply(this,arguments))},a),o},n.prototype.map=function(t,r,a,o){var u=a||o||this,s=map(normalizeDimensions(t),this._getStoreDimIndex,this),c=cloneListForMapAndSample(this);return c._store=this._store.map(s,u?bind$1(r,u):r),c},n.prototype.modify=function(t,r,a,o){var u=a||o||this,s=map(normalizeDimensions(t),this._getStoreDimIndex,this);this._store.modify(s,u?bind$1(r,u):r)},n.prototype.downSample=function(t,r,a,o){var u=cloneListForMapAndSample(this);return u._store=this._store.downSample(this._getStoreDimIndex(t),r,a,o),u},n.prototype.minmaxDownSample=function(t,r){var a=cloneListForMapAndSample(this);return a._store=this._store.minmaxDownSample(this._getStoreDimIndex(t),r),a},n.prototype.lttbDownSample=function(t,r){var a=cloneListForMapAndSample(this);return a._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),a},n.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},n.prototype.getItemModel=function(t){var r=this.hostModel,a=this.getRawDataItem(t);return new Model(a,r,r&&r.ecModel)},n.prototype.diff=function(t){var r=this;return new DataDiffer(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(a){return getId(t,a)},function(a){return getId(r,a)})},n.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},n.prototype.setVisual=function(t,r){this._visual=this._visual||{},isObject$2(t)?extend$1(this._visual,t):this._visual[t]=r},n.prototype.getItemVisual=function(t,r){var a=this._itemVisuals[t],o=a&&a[r];return o??this.getVisual(r)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(t,r){var a=this._itemVisuals,o=a[t];o||(o=a[t]={});var u=o[r];return u==null&&(u=this.getVisual(r),isArray$2(u)?u=u.slice():isObject$2(u)&&(u=extend$1({},u)),o[r]=u),u},n.prototype.setItemVisual=function(t,r,a){var o=this._itemVisuals[t]||{};this._itemVisuals[t]=o,isObject$2(r)?extend$1(o,r):o[r]=a},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(t,r){isObject$2(t)?extend$1(this._layout,t):this._layout[t]=r},n.prototype.getLayout=function(t){return this._layout[t]},n.prototype.getItemLayout=function(t){return this._itemLayouts[t]},n.prototype.setItemLayout=function(t,r,a){this._itemLayouts[t]=a?extend$1(this._itemLayouts[t]||{},r):r},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(t,r){var a=this.hostModel&&this.hostModel.seriesIndex;setCommonECData(a,this.dataType,t,r),this._graphicEls[t]=r},n.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},n.prototype.eachItemGraphicEl=function(t,r){each$f(this._graphicEls,function(a,o){a&&t&&t.call(r,a,o)})},n.prototype.cloneShallow=function(t){return t||(t=new n(this._schema?this._schema:map(this.dimensions,this._getDimInfo,this),this.hostModel)),transferProperties(t,this),t._store=this._store,t},n.prototype.wrapMethod=function(t,r){var a=this[t];isFunction$1(a)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var o=a.apply(this,arguments);return r.apply(this,[o].concat(slice(arguments)))})},n.internalField=function(){prepareInvertedIndex=function(t){var r=t._invertedIndicesMap;each$f(r,function(a,o){var u=t._dimInfos[o],s=u.ordinalMeta,c=t._store;if(s){a=r[o]=new CtorInt32Array(s.categories.length);for(var l=0;l<a.length;l++)a[l]=INDEX_NOT_FOUND;for(var l=0;l<c.count();l++)a[c.get(u.storeDimIndex,l)]=l}})},getIdNameFromStore=function(t,r,a){return convertOptionIdName(t._getCategory(r,a),null)},getId=function(t,r){var a=t._idList[r];return a==null&&t._idDimIdx!=null&&(a=getIdNameFromStore(t,t._idDimIdx,r)),a==null&&(a=ID_PREFIX+r),a},normalizeDimensions=function(t){return isArray$2(t)||(t=t!=null?[t]:[]),t},cloneListForMapAndSample=function(t){var r=new n(t._schema?t._schema:map(t.dimensions,t._getDimInfo,t),t.hostModel);return transferProperties(r,t),r},transferProperties=function(t,r){each$f(TRANSFERABLE_PROPERTIES.concat(r.__wrappedMethods||[]),function(a){r.hasOwnProperty(a)&&(t[a]=r[a])}),t.__wrappedMethods=r.__wrappedMethods,each$f(CLONE_PROPERTIES,function(a){t[a]=clone$5(r[a])}),t._calculationInfo=extend$1({},r._calculationInfo)},makeIdFromName=function(t,r){var a=t._nameList,o=t._idList,u=t._nameDimIdx,s=t._idDimIdx,c=a[r],l=o[r];if(c==null&&u!=null&&(a[r]=c=getIdNameFromStore(t,u,r)),l==null&&s!=null&&(o[r]=l=getIdNameFromStore(t,s,r)),l==null&&c!=null){var d=t._nameRepeatCount,f=d[c]=(d[c]||0)+1;l=c,f>1&&(l+="__ec__"+f),o[r]=l}}}(),n}();function prepareSeriesDataSchema(n,t){isSourceInstance(n)||(n=createSourceFromSeriesDataOption(n)),t=t||{};var r=t.coordDimensions||[],a=t.dimensionsDefine||n.dimensionsDefine||[],o=createHashMap(),u=[],s=getDimCount(n,r,a,t.dimensionsCount),c=t.canOmitUnusedDimensions&&shouldOmitUnusedDimensions(s),l=a===n.dimensionsDefine,d=l?ensureSourceDimNameMap(n):createDimNameMap(a),f=t.encodeDefine;!f&&t.encodeDefaulter&&(f=t.encodeDefaulter(n,s));for(var h=createHashMap(f),v=new CtorInt32Array$1(s),g=0;g<v.length;g++)v[g]=-1;function b(D){var $=v[D];if($<0){var O=a[D],P=isObject$4(O)?O:{name:O},C=new SeriesDimensionDefine,q=P.name;q!=null&&d.get(q)!=null&&(C.name=C.displayName=q),P.type!=null&&(C.type=P.type),P.displayName!=null&&(C.displayName=P.displayName);var M=u.length;return v[D]=M,C.storeDimIndex=D,u.push(C),C}return u[$]}if(!c)for(var g=0;g<s;g++)b(g);h.each(function(D,$){var O=normalizeToArray(D).slice();if(O.length===1&&!isString(O[0])&&O[0]<0){h.set($,!1);return}var P=h.set($,[]);each$f(O,function(C,q){var M=isString(C)?d.get(C):C;M!=null&&M<s&&(P[q]=M,S(b(M),$,q))})});var _=0;each$f(r,function(D){var $,O,P,C;if(isString(D))$=D,C={};else{C=D,$=C.name;var q=C.ordinalMeta;C.ordinalMeta=null,C=extend$1({},C),C.ordinalMeta=q,O=C.dimsDef,P=C.otherDims,C.name=C.coordDim=C.coordDimIndex=C.dimsDef=C.otherDims=null}var M=h.get($);if(M!==!1){if(M=normalizeToArray(M),!M.length)for(var N=0;N<(O&&O.length||1);N++){for(;_<s&&b(_).coordDim!=null;)_++;_<s&&M.push(_++)}each$f(M,function(G,X){var Y=b(G);if(l&&C.type!=null&&(Y.type=C.type),S(defaults$h(Y,C),$,X),Y.name==null&&O){var W=O[X];!isObject$4(W)&&(W={name:W}),Y.name=Y.displayName=W.name,Y.defaultTooltip=W.defaultTooltip}P&&defaults$h(Y.otherDims,P)})}});function S(D,$,O){VISUAL_DIMENSIONS.get($)!=null?D.otherDims[$]=O:(D.coordDim=$,D.coordDimIndex=O,o.set($,!0))}var T=t.generateCoord,w=t.generateCoordCount,A=w!=null;w=T?w||1:0;var R=T||"value";function E(D){D.name==null&&(D.name=D.coordDim)}if(c)each$f(u,function(D){E(D)}),u.sort(function(D,$){return D.storeDimIndex-$.storeDimIndex});else for(var I=0;I<s;I++){var L=b(I),F=L.coordDim;F==null&&(L.coordDim=genCoordDimName(R,o,A),L.coordDimIndex=0,(!T||w<=0)&&(L.isExtraCoord=!0),w--),E(L),L.type==null&&(guessOrdinal(n,I)===BE_ORDINAL.Must||L.isExtraCoord&&(L.otherDims.itemName!=null||L.otherDims.seriesName!=null))&&(L.type="ordinal")}return removeDuplication(u),new SeriesDataSchema({source:n,dimensions:u,fullDimensionCount:s,dimensionOmitted:c})}function removeDuplication(n){for(var t=createHashMap(),r=0;r<n.length;r++){var a=n[r],o=a.name,u=t.get(o)||0;u>0&&(a.name=o+(u-1)),u++,t.set(o,u)}}function getDimCount(n,t,r,a){var o=Math.max(n.dimensionsDetectedCount||1,t.length,r.length,a||0);return each$f(t,function(u){var s;isObject$4(u)&&(s=u.dimsDef)&&(o=Math.max(o,s.length))}),o}function genCoordDimName(n,t,r){if(r||t.hasKey(n)){for(var a=0;t.hasKey(n+a);)a++;n+=a}return t.set(n,!0),n}var CoordSysInfo=function(){function n(t){this.coordSysDims=[],this.axisMap=createHashMap(),this.categoryAxisMap=createHashMap(),this.coordSysName=t}return n}();function getCoordSysInfoBySeries(n){var t=n.get("coordinateSystem"),r=new CoordSysInfo(t),a=fetchers[t];if(a)return a(n,r,r.axisMap,r.categoryAxisMap),r}var fetchers={cartesian2d:function(n,t,r,a){var o=n.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],u=n.getReferringComponents("yAxis",SINGLE_REFERRING).models[0];t.coordSysDims=["x","y"],r.set("x",o),r.set("y",u),isCategory(o)&&(a.set("x",o),t.firstCategoryDimIndex=0),isCategory(u)&&(a.set("y",u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(n,t,r,a){var o=n.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];t.coordSysDims=["single"],r.set("single",o),isCategory(o)&&(a.set("single",o),t.firstCategoryDimIndex=0)},polar:function(n,t,r,a){var o=n.getReferringComponents("polar",SINGLE_REFERRING).models[0],u=o.findAxisModel("radiusAxis"),s=o.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",u),r.set("angle",s),isCategory(u)&&(a.set("radius",u),t.firstCategoryDimIndex=0),isCategory(s)&&(a.set("angle",s),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(n,t,r,a){t.coordSysDims=["lng","lat"]},parallel:function(n,t,r,a){var o=n.ecModel,u=o.getComponent("parallel",n.get("parallelIndex")),s=t.coordSysDims=u.dimensions.slice();each$f(u.parallelAxisIndex,function(c,l){var d=o.getComponent("parallelAxis",c),f=s[l];r.set(f,d),isCategory(d)&&(a.set(f,d),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function isCategory(n){return n.get("type")==="category"}function enableDataStack(n,t,r){r=r||{};var a=r.byIndex,o=r.stackedCoordDimension,u,s,c;isLegacyDimensionsInput(t)?u=t:(s=t.schema,u=s.dimensions,c=t.store);var l=!!(n&&n.get("stack")),d,f,h,v;if(each$f(u,function(w,A){isString(w)&&(u[A]=w={name:w}),l&&!w.isExtraCoord&&(!a&&!d&&w.ordinalMeta&&(d=w),!f&&w.type!=="ordinal"&&w.type!=="time"&&(!o||o===w.coordDim)&&(f=w))}),f&&!a&&!d&&(a=!0),f){h="__\0ecstackresult_"+n.id,v="__\0ecstackedover_"+n.id,d&&(d.createInvertedIndices=!0);var g=f.coordDim,b=f.type,_=0;each$f(u,function(w){w.coordDim===g&&_++});var S={name:h,coordDim:g,coordDimIndex:_,type:b,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:u.length},T={name:v,coordDim:v,coordDimIndex:_+1,type:b,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:u.length+1};s?(c&&(S.storeDimIndex=c.ensureCalculationDimension(v,b),T.storeDimIndex=c.ensureCalculationDimension(h,b)),s.appendCalculationDimension(S),s.appendCalculationDimension(T)):(u.push(S),u.push(T))}return{stackedDimension:f&&f.name,stackedByDimension:d&&d.name,isStackedByIndex:a,stackedOverDimension:v,stackResultDimension:h}}function isLegacyDimensionsInput(n){return!isSeriesDataSchema(n.schema)}function isDimensionStacked(n,t){return!!t&&t===n.getCalculationInfo("stackedDimension")}function getStackedDimension(n,t){return isDimensionStacked(n,t)?n.getCalculationInfo("stackResultDimension"):t}function getCoordSysDimDefs(n,t){var r=n.get("coordinateSystem"),a=CoordinateSystemManager.get(r),o;return t&&t.coordSysDims&&(o=map$1(t.coordSysDims,function(u){var s={name:u},c=t.axisMap.get(u);if(c){var l=c.get("type");s.type=getDimensionTypeByAxis(l)}return s})),o||(o=a&&(a.getDimensionsInfo?a.getDimensionsInfo():a.dimensions.slice())||["x","y"]),o}function injectOrdinalMeta(n,t,r){var a,o;return r&&each$f(n,function(u,s){var c=u.coordDim,l=r.categoryAxisMap.get(c);l&&(a==null&&(a=s),u.ordinalMeta=l.getOrdinalMeta(),t&&(u.createInvertedIndices=!0)),u.otherDims.itemName!=null&&(o=!0)}),!o&&a!=null&&(n[a].otherDims.itemName=0),a}function createSeriesData(n,t,r){r=r||{};var a=t.getSourceManager(),o,u=!1;n?(u=!0,o=createSourceFromSeriesDataOption(n)):(o=a.getSource(),u=o.sourceFormat===SOURCE_FORMAT_ORIGINAL);var s=getCoordSysInfoBySeries(t),c=getCoordSysDimDefs(t,s),l=r.useEncodeDefaulter,d=isFunction$1(l)?l:l?curry$1(makeSeriesEncodeForAxisCoordSys,c,t):null,f={coordDimensions:c,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:d,canOmitUnusedDimensions:!u},h=prepareSeriesDataSchema(o,f),v=injectOrdinalMeta(h.dimensions,r.createInvertedIndices,s),g=u?null:a.getSharedDataStore(h),b=enableDataStack(t,{schema:h,store:g}),_=new SeriesData(h,t);_.setCalculationInfo(b);var S=v!=null&&isNeedCompleteOrdinalData(o)?function(T,w,A,R){return R===v?A:this.defaultDimValueGetter(T,w,A,R)}:null;return _.hasItemOption=!1,_.initData(u?o:g,null,S),_}function isNeedCompleteOrdinalData(n){if(n.sourceFormat===SOURCE_FORMAT_ORIGINAL){var t=firstDataNotNull(n.data||[]);return!isArray$2(getDataItemValue(t))}}function firstDataNotNull(n){for(var t=0;t<n.length&&n[t]==null;)t++;return n[t]}var Scale=function(){function n(t){this._setting=t||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(t){return this._setting[t]},n.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},n.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(t,r){var a=this._extent;isNaN(t)||(a[0]=t),isNaN(r)||(a[1]=r)},n.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(t){this._isBlank=t},n}();enableClassManagement(Scale);var uidBase=0,OrdinalMeta=function(){function n(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++uidBase}return n.createByAxisModel=function(t){var r=t.option,a=r.data,o=a&&map$1(a,getName);return new n({categories:o,needCollect:!o,deduplication:r.dedplication!==!1})},n.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},n.prototype.parseAndCollect=function(t){var r,a=this._needCollect;if(!isString(t)&&!a)return t;if(a&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var o=this._getOrCreateMap();return r=o.get(t),r==null&&(a?(r=this.categories.length,this.categories[r]=t,o.set(t,r)):r=NaN),r},n.prototype._getOrCreateMap=function(){return this._map||(this._map=createHashMap(this.categories))},n}();function getName(n){return isObject$4(n)&&n.value!=null?n.value:n+""}function isIntervalOrLogScale(n){return n.type==="interval"||n.type==="log"}function intervalScaleNiceTicks(n,t,r,a){var o={},u=n[1]-n[0],s=o.interval=nice(u/t);r!=null&&s<r&&(s=o.interval=r),a!=null&&s>a&&(s=o.interval=a);var c=o.intervalPrecision=getIntervalPrecision(s),l=o.niceTickExtent=[round$3(Math.ceil(n[0]/s)*s,c),round$3(Math.floor(n[1]/s)*s,c)];return fixExtent(l,n),o}function increaseInterval(n){var t=Math.pow(10,quantityExponent(n)),r=n/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,round$3(r*t)}function getIntervalPrecision(n){return getPrecision(n)+2}function clamp(n,t,r){n[t]=Math.max(Math.min(n[t],r[1]),r[0])}function fixExtent(n,t){!isFinite(n[0])&&(n[0]=t[0]),!isFinite(n[1])&&(n[1]=t[1]),clamp(n,0,t),clamp(n,1,t),n[0]>n[1]&&(n[0]=n[1])}function contain$1(n,t){return n>=t[0]&&n<=t[1]}function normalize$3(n,t){return t[1]===t[0]?.5:(n-t[0])/(t[1]-t[0])}function scale$1(n,t){return n*(t[1]-t[0])+t[0]}var OrdinalScale=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;a.type="ordinal";var o=a.getSetting("ordinalMeta");return o||(o=new OrdinalMeta({})),isArray$2(o)&&(o=new OrdinalMeta({categories:map$1(o,function(u){return isObject$4(u)?u.value:u})})),a._ordinalMeta=o,a._extent=a.getSetting("extent")||[0,o.categories.length-1],a}return t.prototype.parse=function(r){return r==null?NaN:isString(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),contain$1(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),normalize$3(r,this._extent)},t.prototype.scale=function(r){return r=Math.round(scale$1(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],a=this._extent,o=a[0];o<=a[1];)r.push({value:o}),o++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var a=r.ordinalNumbers,o=this._ordinalNumbersByTick=[],u=this._ticksByOrdinalNumber=[],s=0,c=this._ordinalMeta.categories.length,l=Math.min(c,a.length);s<l;++s){var d=a[s];o[s]=d,u[d]=s}for(var f=0;s<c;++s){for(;u[f]!=null;)f++;o.push(f),u[f]=s}},t.prototype._getTickNumber=function(r){var a=this._ticksByOrdinalNumber;return a&&r>=0&&r<a.length?a[r]:r},t.prototype.getRawOrdinalNumber=function(r){var a=this._ordinalNumbersByTick;return a&&r>=0&&r<a.length?a[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var a=this.getRawOrdinalNumber(r.value),o=this._ordinalMeta.categories[a];return o==null?"":o+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,a){this.unionExtent(r.getApproximateExtent(a))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(Scale);Scale.registerClass(OrdinalScale);var roundNumber=round$3,IntervalScale=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return contain$1(r,this._extent)},t.prototype.normalize=function(r){return normalize$3(r,this._extent)},t.prototype.scale=function(r){return scale$1(r,this._extent)},t.prototype.setExtent=function(r,a){var o=this._extent;isNaN(r)||(o[0]=parseFloat(r)),isNaN(a)||(o[1]=parseFloat(a))},t.prototype.unionExtent=function(r){var a=this._extent;r[0]<a[0]&&(a[0]=r[0]),r[1]>a[1]&&(a[1]=r[1]),this.setExtent(a[0],a[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=getIntervalPrecision(r)},t.prototype.getTicks=function(r){var a=this._interval,o=this._extent,u=this._niceExtent,s=this._intervalPrecision,c=[];if(!a)return c;var l=1e4;o[0]<u[0]&&(r?c.push({value:roundNumber(u[0]-a,s)}):c.push({value:o[0]}));for(var d=u[0];d<=u[1]&&(c.push({value:d}),d=roundNumber(d+a,s),d!==c[c.length-1].value);)if(c.length>l)return[];var f=c.length?c[c.length-1].value:u[1];return o[1]>f&&(r?c.push({value:roundNumber(f+a,s)}):c.push({value:o[1]})),c},t.prototype.getMinorTicks=function(r){for(var a=this.getTicks(!0),o=[],u=this.getExtent(),s=1;s<a.length;s++){for(var c=a[s],l=a[s-1],d=0,f=[],h=c.value-l.value,v=h/r;d<r-1;){var g=roundNumber(l.value+(d+1)*v);g>u[0]&&g<u[1]&&f.push(g),d++}o.push(f)}return o},t.prototype.getLabel=function(r,a){if(r==null)return"";var o=a&&a.precision;o==null?o=getPrecision(r.value)||0:o==="auto"&&(o=this._intervalPrecision);var u=roundNumber(r.value,o,!0);return addCommas(u)},t.prototype.calcNiceTicks=function(r,a,o){r=r||5;var u=this._extent,s=u[1]-u[0];if(isFinite(s)){s<0&&(s=-s,u.reverse());var c=intervalScaleNiceTicks(u,r,a,o);this._intervalPrecision=c.intervalPrecision,this._interval=c.interval,this._niceExtent=c.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var a=this._extent;if(a[0]===a[1])if(a[0]!==0){var o=Math.abs(a[0]);r.fixMax||(a[1]+=o/2),a[0]-=o/2}else a[1]=1;var u=a[1]-a[0];isFinite(u)||(a[0]=0,a[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var s=this._interval;r.fixMin||(a[0]=roundNumber(Math.floor(a[0]/s)*s)),r.fixMax||(a[1]=roundNumber(Math.ceil(a[1]/s)*s))},t.prototype.setNiceExtent=function(r,a){this._niceExtent=[r,a]},t.type="interval",t}(Scale);Scale.registerClass(IntervalScale);var supportFloat32Array=typeof Float32Array<"u",Float32ArrayCtor=supportFloat32Array?Float32Array:Array;function createFloat32Array(n){return isArray$2(n)?supportFloat32Array?new Float32Array(n):n:new Float32ArrayCtor(n)}var STACK_PREFIX="__ec_stack_";function getSeriesStackId$1(n){return n.get("stack")||STACK_PREFIX+n.seriesIndex}function getAxisKey$1(n){return n.dim+n.index}function getLayoutOnAxis(n){var t=[],r=n.axis,a="axis0";if(r.type==="category"){for(var o=r.getBandWidth(),u=0;u<n.count;u++)t.push(defaults$h({bandWidth:o,axisKey:a,stackId:STACK_PREFIX+u},n));for(var s=doCalBarWidthAndOffset(t),c=[],u=0;u<n.count;u++){var l=s[a][STACK_PREFIX+u];l.offsetCenter=l.offset+l.width/2,c.push(l)}return c}}function prepareLayoutBarSeries(n,t){var r=[];return t.eachSeriesByType(n,function(a){isOnCartesian(a)&&r.push(a)}),r}function getValueAxesMinGaps(n){var t={};each$f(n,function(l){var d=l.coordinateSystem,f=d.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var h=l.getData(),v=f.dim+"_"+f.index,g=h.getDimensionIndex(h.mapDimension(f.dim)),b=h.getStore(),_=0,S=b.count();_<S;++_){var T=b.get(g,_);t[v]?t[v].push(T):t[v]=[T]}});var r={};for(var a in t)if(t.hasOwnProperty(a)){var o=t[a];if(o){o.sort(function(l,d){return l-d});for(var u=null,s=1;s<o.length;++s){var c=o[s]-o[s-1];c>0&&(u=u===null?c:Math.min(u,c))}r[a]=u}}return r}function makeColumnLayout(n){var t=getValueAxesMinGaps(n),r=[];return each$f(n,function(a){var o=a.coordinateSystem,u=o.getBaseAxis(),s=u.getExtent(),c;if(u.type==="category")c=u.getBandWidth();else if(u.type==="value"||u.type==="time"){var l=u.dim+"_"+u.index,d=t[l],f=Math.abs(s[1]-s[0]),h=u.scale.getExtent(),v=Math.abs(h[1]-h[0]);c=d?f/v*d:f}else{var g=a.getData();c=Math.abs(s[1]-s[0])/g.count()}var b=parsePercent(a.get("barWidth"),c),_=parsePercent(a.get("barMaxWidth"),c),S=parsePercent(a.get("barMinWidth")||(isInLargeMode(a)?.5:1),c),T=a.get("barGap"),w=a.get("barCategoryGap");r.push({bandWidth:c,barWidth:b,barMaxWidth:_,barMinWidth:S,barGap:T,barCategoryGap:w,axisKey:getAxisKey$1(u),stackId:getSeriesStackId$1(a)})}),doCalBarWidthAndOffset(r)}function doCalBarWidthAndOffset(n){var t={};each$f(n,function(a,o){var u=a.axisKey,s=a.bandWidth,c=t[u]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=c.stacks;t[u]=c;var d=a.stackId;l[d]||c.autoWidthCount++,l[d]=l[d]||{width:0,maxWidth:0};var f=a.barWidth;f&&!l[d].width&&(l[d].width=f,f=Math.min(c.remainedWidth,f),c.remainedWidth-=f);var h=a.barMaxWidth;h&&(l[d].maxWidth=h);var v=a.barMinWidth;v&&(l[d].minWidth=v);var g=a.barGap;g!=null&&(c.gap=g);var b=a.barCategoryGap;b!=null&&(c.categoryGap=b)});var r={};return each$f(t,function(a,o){r[o]={};var u=a.stacks,s=a.bandWidth,c=a.categoryGap;if(c==null){var l=keys(u).length;c=Math.max(35-l*4,15)+"%"}var d=parsePercent(c,s),f=parsePercent(a.gap,1),h=a.remainedWidth,v=a.autoWidthCount,g=(h-d)/(v+(v-1)*f);g=Math.max(g,0),each$f(u,function(T){var w=T.maxWidth,A=T.minWidth;if(T.width){var R=T.width;w&&(R=Math.min(R,w)),A&&(R=Math.max(R,A)),T.width=R,h-=R+f*R,v--}else{var R=g;w&&w<R&&(R=Math.min(w,h)),A&&A>R&&(R=A),R!==g&&(T.width=R,h-=R+f*R,v--)}}),g=(h-d)/(v+(v-1)*f),g=Math.max(g,0);var b=0,_;each$f(u,function(T,w){T.width||(T.width=g),_=T,b+=T.width*(1+f)}),_&&(b-=_.width*f);var S=-b/2;each$f(u,function(T,w){r[o][w]=r[o][w]||{bandWidth:s,offset:S,width:T.width},S+=T.width*(1+f)})}),r}function retrieveColumnLayout(n,t,r){if(n&&t){var a=n[getAxisKey$1(t)];return a}}function layout$5(n,t){var r=prepareLayoutBarSeries(n,t),a=makeColumnLayout(r);each$f(r,function(o){var u=o.getData(),s=o.coordinateSystem,c=s.getBaseAxis(),l=getSeriesStackId$1(o),d=a[getAxisKey$1(c)][l],f=d.offset,h=d.width;u.setLayout({bandWidth:d.bandWidth,offset:f,size:h})})}function createProgressiveLayout(n){return{seriesType:n,plan:createRenderPlanner(),reset:function(t){if(isOnCartesian(t)){var r=t.getData(),a=t.coordinateSystem,o=a.getBaseAxis(),u=a.getOtherAxis(o),s=r.getDimensionIndex(r.mapDimension(u.dim)),c=r.getDimensionIndex(r.mapDimension(o.dim)),l=t.get("showBackground",!0),d=r.mapDimension(u.dim),f=r.getCalculationInfo("stackResultDimension"),h=isDimensionStacked(r,d)&&!!r.getCalculationInfo("stackedOnSeries"),v=u.isHorizontal(),g=getValueAxisStart(o,u),b=isInLargeMode(t),_=t.get("barMinHeight")||0,S=f&&r.getDimensionIndex(f),T=r.getLayout("size"),w=r.getLayout("offset");return{progress:function(A,R){for(var E=A.count,I=b&&createFloat32Array(E*3),L=b&&l&&createFloat32Array(E*3),F=b&&createFloat32Array(E),D=a.master.getRect(),$=v?D.width:D.height,O,P=R.getStore(),C=0;(O=A.next())!=null;){var q=P.get(h?S:s,O),M=P.get(c,O),N=g,G=void 0;h&&(G=+q-P.get(s,O));var X=void 0,Y=void 0,W=void 0,te=void 0;if(v){var ue=a.dataToPoint([q,M]);if(h){var fe=a.dataToPoint([G,M]);N=fe[0]}X=N,Y=ue[1]+w,W=ue[0]-N,te=T,Math.abs(W)<_&&(W=(W<0?-1:1)*_)}else{var ue=a.dataToPoint([M,q]);if(h){var fe=a.dataToPoint([M,G]);N=fe[1]}X=ue[0]+w,Y=N,W=T,te=ue[1]-N,Math.abs(te)<_&&(te=(te<=0?-1:1)*_)}b?(I[C]=X,I[C+1]=Y,I[C+2]=v?W:te,L&&(L[C]=v?D.x:X,L[C+1]=v?Y:D.y,L[C+2]=$),F[O]=O):R.setItemLayout(O,{x:X,y:Y,width:W,height:te}),C+=3}b&&R.setLayout({largePoints:I,largeDataIndices:F,largeBackgroundPoints:L,valueAxisHorizontal:v})}}}}}}function isOnCartesian(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function isInLargeMode(n){return n.pipelineContext&&n.pipelineContext.large}function getValueAxisStart(n,t){var r=t.model.get("startValue");return r||(r=0),t.toGlobalCoord(t.dataToCoord(t.type==="log"?r>0?r:1:r))}var bisect=function(n,t,r,a){for(;r<a;){var o=r+a>>>1;n[o][1]<t?r=o+1:a=o}return r},TimeScale=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="time",a}return t.prototype.getLabel=function(r){var a=this.getSetting("useUTC");return format(r.value,fullLeveledFormatter[getDefaultFormatPrecisionOfInterval(getPrimaryTimeUnit(this._minLevelUnit))]||fullLeveledFormatter.second,a,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,a,o){var u=this.getSetting("useUTC"),s=this.getSetting("locale");return leveledFormat(r,a,o,s,u)},t.prototype.getTicks=function(){var r=this._interval,a=this._extent,o=[];if(!r)return o;o.push({value:a[0],level:0});var u=this.getSetting("useUTC"),s=getIntervalTicks(this._minLevelUnit,this._approxInterval,u,a);return o=o.concat(s),o.push({value:a[1],level:0}),o},t.prototype.calcNiceExtent=function(r){var a=this._extent;if(a[0]===a[1]&&(a[0]-=ONE_DAY,a[1]+=ONE_DAY),a[1]===-1/0&&a[0]===1/0){var o=new Date;a[1]=+new Date(o.getFullYear(),o.getMonth(),o.getDate()),a[0]=a[1]-ONE_DAY}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,a,o){r=r||10;var u=this._extent,s=u[1]-u[0];this._approxInterval=s/r,a!=null&&this._approxInterval<a&&(this._approxInterval=a),o!=null&&this._approxInterval>o&&(this._approxInterval=o);var c=scaleIntervals.length,l=Math.min(bisect(scaleIntervals,this._approxInterval,0,c),c-1);this._interval=scaleIntervals[l][1],this._minLevelUnit=scaleIntervals[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return isNumber(r)?r:+parseDate(r)},t.prototype.contain=function(r){return contain$1(this.parse(r),this._extent)},t.prototype.normalize=function(r){return normalize$3(this.parse(r),this._extent)},t.prototype.scale=function(r){return scale$1(r,this._extent)},t.type="time",t}(IntervalScale),scaleIntervals=[["second",ONE_SECOND],["minute",ONE_MINUTE],["hour",ONE_HOUR],["quarter-day",ONE_HOUR*6],["half-day",ONE_HOUR*12],["day",ONE_DAY*1.2],["half-week",ONE_DAY*3.5],["week",ONE_DAY*7],["month",ONE_DAY*31],["quarter",ONE_DAY*95],["half-year",ONE_YEAR/2],["year",ONE_YEAR]];function isUnitValueSame(n,t,r,a){var o=parseDate(t),u=parseDate(r),s=function(b){return getUnitValue(o,b,a)===getUnitValue(u,b,a)},c=function(){return s("year")},l=function(){return c()&&s("month")},d=function(){return l()&&s("day")},f=function(){return d()&&s("hour")},h=function(){return f()&&s("minute")},v=function(){return h()&&s("second")},g=function(){return v()&&s("millisecond")};switch(n){case"year":return c();case"month":return l();case"day":return d();case"hour":return f();case"minute":return h();case"second":return v();case"millisecond":return g()}}function getDateInterval(n,t){return n/=ONE_DAY,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function getMonthInterval(n){var t=30*ONE_DAY;return n/=t,n>6?6:n>3?3:n>2?2:1}function getHourInterval(n){return n/=ONE_HOUR,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function getMinutesAndSecondsInterval(n,t){return n/=t?ONE_MINUTE:ONE_SECOND,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function getMillisecondsInterval(n){return nice(n)}function getFirstTimestampOfUnit(n,t,r){var a=new Date(n);switch(getPrimaryTimeUnit(t)){case"year":case"month":a[monthSetterName(r)](0);case"day":a[dateSetterName(r)](1);case"hour":a[hoursSetterName(r)](0);case"minute":a[minutesSetterName(r)](0);case"second":a[secondsSetterName(r)](0),a[millisecondsSetterName(r)](0)}return a.getTime()}function getIntervalTicks(n,t,r,a){var o=1e4,u=timeUnits,s=0;function c($,O,P,C,q,M,N){for(var G=new Date(O),X=O,Y=G[C]();X<P&&X<=a[1];)N.push({value:X}),Y+=$,G[q](Y),X=G.getTime();N.push({value:X,notAdd:!0})}function l($,O,P){var C=[],q=!O.length;if(!isUnitValueSame(getPrimaryTimeUnit($),a[0],a[1],r)){q&&(O=[{value:getFirstTimestampOfUnit(new Date(a[0]),$,r)},{value:a[1]}]);for(var M=0;M<O.length-1;M++){var N=O[M].value,G=O[M+1].value;if(N!==G){var X=void 0,Y=void 0,W=void 0,te=!1;switch($){case"year":X=Math.max(1,Math.round(t/ONE_DAY/365)),Y=fullYearGetterName(r),W=fullYearSetterName(r);break;case"half-year":case"quarter":case"month":X=getMonthInterval(t),Y=monthGetterName(r),W=monthSetterName(r);break;case"week":case"half-week":case"day":X=getDateInterval(t),Y=dateGetterName(r),W=dateSetterName(r),te=!0;break;case"half-day":case"quarter-day":case"hour":X=getHourInterval(t),Y=hoursGetterName(r),W=hoursSetterName(r);break;case"minute":X=getMinutesAndSecondsInterval(t,!0),Y=minutesGetterName(r),W=minutesSetterName(r);break;case"second":X=getMinutesAndSecondsInterval(t,!1),Y=secondsGetterName(r),W=secondsSetterName(r);break;case"millisecond":X=getMillisecondsInterval(t),Y=millisecondsGetterName(r),W=millisecondsSetterName(r);break}c(X,N,G,Y,W,te,C),$==="year"&&P.length>1&&M===0&&P.unshift({value:P[0].value-X})}}for(var M=0;M<C.length;M++)P.push(C[M]);return C}}for(var d=[],f=[],h=0,v=0,g=0;g<u.length&&s++<o;++g){var b=getPrimaryTimeUnit(u[g]);if(isPrimaryTimeUnit(u[g])){l(u[g],d[d.length-1]||[],f);var _=u[g+1]?getPrimaryTimeUnit(u[g+1]):null;if(b!==_){if(f.length){v=h,f.sort(function($,O){return $.value-O.value});for(var S=[],T=0;T<f.length;++T){var w=f[T].value;(T===0||f[T-1].value!==w)&&(S.push(f[T]),w>=a[0]&&w<=a[1]&&h++)}var A=(a[1]-a[0])/t;if(h>A*1.5&&v>A/1.5||(d.push(S),h>A||n===u[g]))break}f=[]}}}for(var R=filter$1(map$1(d,function($){return filter$1($,function(O){return O.value>=a[0]&&O.value<=a[1]&&!O.notAdd})}),function($){return $.length>0}),E=[],I=R.length-1,g=0;g<R.length;++g)for(var L=R[g],F=0;F<L.length;++F)E.push({value:L[F].value,level:I-g});E.sort(function($,O){return $.value-O.value});for(var D=[],g=0;g<E.length;++g)(g===0||E[g].value!==E[g-1].value)&&D.push(E[g]);return D}Scale.registerClass(TimeScale);var scaleProto=Scale.prototype,intervalScaleProto=IntervalScale.prototype,roundingErrorFix=round$3,mathFloor$1=Math.floor,mathCeil$1=Math.ceil,mathPow$1=Math.pow,mathLog$1=Math.log,LogScale=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new IntervalScale,r._interval=0,r}return t.prototype.getTicks=function(r){var a=this._originalScale,o=this._extent,u=a.getExtent(),s=intervalScaleProto.getTicks.call(this,r);return map$1(s,function(c){var l=c.value,d=round$3(mathPow$1(this.base,l));return d=l===o[0]&&this._fixMin?fixRoundingError(d,u[0]):d,d=l===o[1]&&this._fixMax?fixRoundingError(d,u[1]):d,{value:d}},this)},t.prototype.setExtent=function(r,a){var o=mathLog$1(this.base);r=mathLog$1(Math.max(0,r))/o,a=mathLog$1(Math.max(0,a))/o,intervalScaleProto.setExtent.call(this,r,a)},t.prototype.getExtent=function(){var r=this.base,a=scaleProto.getExtent.call(this);a[0]=mathPow$1(r,a[0]),a[1]=mathPow$1(r,a[1]);var o=this._originalScale,u=o.getExtent();return this._fixMin&&(a[0]=fixRoundingError(a[0],u[0])),this._fixMax&&(a[1]=fixRoundingError(a[1],u[1])),a},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var a=this.base;r[0]=mathLog$1(r[0])/mathLog$1(a),r[1]=mathLog$1(r[1])/mathLog$1(a),scaleProto.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,a){this.unionExtent(r.getApproximateExtent(a))},t.prototype.calcNiceTicks=function(r){r=r||10;var a=this._extent,o=a[1]-a[0];if(!(o===1/0||o<=0)){var u=quantity(o),s=r/o*u;for(s<=.5&&(u*=10);!isNaN(u)&&Math.abs(u)<1&&Math.abs(u)>0;)u*=10;var c=[round$3(mathCeil$1(a[0]/u)*u),round$3(mathFloor$1(a[1]/u)*u)];this._interval=u,this._niceExtent=c}},t.prototype.calcNiceExtent=function(r){intervalScaleProto.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=mathLog$1(r)/mathLog$1(this.base),contain$1(r,this._extent)},t.prototype.normalize=function(r){return r=mathLog$1(r)/mathLog$1(this.base),normalize$3(r,this._extent)},t.prototype.scale=function(r){return r=scale$1(r,this._extent),mathPow$1(this.base,r)},t.type="log",t}(Scale),proto=LogScale.prototype;proto.getMinorTicks=intervalScaleProto.getMinorTicks;proto.getLabel=intervalScaleProto.getLabel;function fixRoundingError(n,t){return roundingErrorFix(n,getPrecision(t))}Scale.registerClass(LogScale);var ScaleRawExtentInfo=function(){function n(t,r,a){this._prepareParams(t,r,a)}return n.prototype._prepareParams=function(t,r,a){a[1]<a[0]&&(a=[NaN,NaN]),this._dataMin=a[0],this._dataMax=a[1];var o=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var u=r.get("min",!0);u==null&&(u=r.get("startValue",!0));var s=this._modelMinRaw=u;isFunction$1(s)?this._modelMinNum=parseAxisModelMinMax(t,s({min:a[0],max:a[1]})):s!=="dataMin"&&(this._modelMinNum=parseAxisModelMinMax(t,s));var c=this._modelMaxRaw=r.get("max",!0);if(isFunction$1(c)?this._modelMaxNum=parseAxisModelMinMax(t,c({min:a[0],max:a[1]})):c!=="dataMax"&&(this._modelMaxNum=parseAxisModelMinMax(t,c)),o)this._axisDataLen=r.getCategories().length;else{var l=r.get("boundaryGap"),d=isArray$2(l)?l:[l||0,l||0];typeof d[0]=="boolean"||typeof d[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[parsePercent$1(d[0],1),parsePercent$1(d[1],1)]}},n.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,a=this._dataMax,o=this._axisDataLen,u=this._boundaryGapInner,s=t?null:a-r||Math.abs(r),c=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?a:this._modelMaxNum,d=c!=null,f=l!=null;c==null&&(c=t?o?0:NaN:r-u[0]*s),l==null&&(l=t?o?o-1:NaN:a+u[1]*s),(c==null||!isFinite(c))&&(c=NaN),(l==null||!isFinite(l))&&(l=NaN);var h=eqNaN(c)||eqNaN(l)||t&&!o;this._needCrossZero&&(c>0&&l>0&&!d&&(c=0),c<0&&l<0&&!f&&(l=0));var v=this._determinedMin,g=this._determinedMax;return v!=null&&(c=v,d=!0),g!=null&&(l=g,f=!0),{min:c,max:l,minFixed:d,maxFixed:f,isBlank:h}},n.prototype.modifyDataMinMax=function(t,r){this[DATA_MIN_MAX_ATTR[t]]=r},n.prototype.setDeterminedMinMax=function(t,r){var a=DETERMINED_MIN_MAX_ATTR[t];this[a]=r},n.prototype.freeze=function(){this.frozen=!0},n}(),DETERMINED_MIN_MAX_ATTR={min:"_determinedMin",max:"_determinedMax"},DATA_MIN_MAX_ATTR={min:"_dataMin",max:"_dataMax"};function ensureScaleRawExtentInfo(n,t,r){var a=n.rawExtentInfo;return a||(a=new ScaleRawExtentInfo(n,t,r),n.rawExtentInfo=a,a)}function parseAxisModelMinMax(n,t){return t==null?null:eqNaN(t)?NaN:n.parse(t)}function getScaleExtent(n,t){var r=n.type,a=ensureScaleRawExtentInfo(n,t,n.getExtent()).calculate();n.setBlank(a.isBlank);var o=a.min,u=a.max,s=t.ecModel;if(s&&r==="time"){var c=prepareLayoutBarSeries("bar",s),l=!1;if(each$f(c,function(h){l=l||h.getBaseAxis()===t.axis}),l){var d=makeColumnLayout(c),f=adjustScaleForOverflow(o,u,t,d);o=f.min,u=f.max}}return{extent:[o,u],fixMin:a.minFixed,fixMax:a.maxFixed}}function adjustScaleForOverflow(n,t,r,a){var o=r.axis.getExtent(),u=Math.abs(o[1]-o[0]),s=retrieveColumnLayout(a,r.axis);if(s===void 0)return{min:n,max:t};var c=1/0;each$f(s,function(g){c=Math.min(g.offset,c)});var l=-1/0;each$f(s,function(g){l=Math.max(g.offset+g.width,l)}),c=Math.abs(c),l=Math.abs(l);var d=c+l,f=t-n,h=1-(c+l)/u,v=f/h-f;return t+=v*(l/d),n-=v*(c/d),{min:n,max:t}}function niceScaleExtent(n,t){var r=t,a=getScaleExtent(n,r),o=a.extent,u=r.get("splitNumber");n instanceof LogScale&&(n.base=r.get("logBase"));var s=n.type,c=r.get("interval"),l=s==="interval"||s==="time";n.setExtent(o[0],o[1]),n.calcNiceExtent({splitNumber:u,fixMin:a.fixMin,fixMax:a.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),c!=null&&n.setInterval&&n.setInterval(c)}function createScaleByModel$1(n,t){if(t=t||n.get("type"),t)switch(t){case"category":return new OrdinalScale({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new TimeScale({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(Scale.getClass(t)||IntervalScale)}}function ifAxisCrossZero(n){var t=n.scale.getExtent(),r=t[0],a=t[1];return!(r>0&&a>0||r<0&&a<0)}function makeLabelFormatter(n){var t=n.getLabelModel().get("formatter"),r=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(a){return function(o,u){return n.scale.getFormattedLabel(o,u,a)}}(t):isString(t)?function(a){return function(o){var u=n.scale.getLabel(o),s=a.replace("{value}",u??"");return s}}(t):isFunction$1(t)?function(a){return function(o,u){return r!=null&&(u=o.value-r),a(getAxisRawValue(n,o),u,o.level!=null?{level:o.level}:null)}}(t):function(a){return n.scale.getLabel(a)}}function getAxisRawValue(n,t){return n.type==="category"?n.scale.getLabel(t):t.value}function estimateLabelUnionRect(n){var t=n.model,r=n.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var a,o,u=r.getExtent();r instanceof OrdinalScale?o=r.count():(a=r.getTicks(),o=a.length);var s=n.getLabelModel(),c=makeLabelFormatter(n),l,d=1;o>40&&(d=Math.ceil(o/40));for(var f=0;f<o;f+=d){var h=a?a[f]:{value:u[0]+f},v=c(h,f),g=s.getTextRect(v),b=rotateTextRect(g,s.get("rotate")||0);l?l.union(b):l=b}return l}}function rotateTextRect(n,t){var r=t*Math.PI/180,a=n.width,o=n.height,u=a*Math.abs(Math.cos(r))+Math.abs(o*Math.sin(r)),s=a*Math.abs(Math.sin(r))+Math.abs(o*Math.cos(r)),c=new BoundingRect(n.x,n.y,u,s);return c}function getOptionCategoryInterval(n){var t=n.get("interval");return t??"auto"}function shouldShowAllLabels(n){return n.type==="category"&&getOptionCategoryInterval(n.getLabelModel())===0}function getDataDimensionsOnAxis(n,t){var r={};return each$f(n.mapDimensionsAll(t),function(a){r[getStackedDimension(n,a)]=!0}),keys(r)}function unionAxisExtentFromData(n,t,r){t&&each$f(getDataDimensionsOnAxis(t,r),function(a){var o=t.getApproximateExtent(a);o[0]<n[0]&&(n[0]=o[0]),o[1]>n[1]&&(n[1]=o[1])})}var AxisModelCommonMixin=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},n.prototype.getCoordSysModel=function(){},n}(),EPSILON=1e-8;function isAroundEqual(n,t){return Math.abs(n-t)<EPSILON}function contain(n,t,r){var a=0,o=n[0];if(!o)return!1;for(var u=1;u<n.length;u++){var s=n[u];a+=windingLine(o[0],o[1],s[0],s[1],t,r),o=s}var c=n[0];return(!isAroundEqual(o[0],c[0])||!isAroundEqual(o[1],c[1]))&&(a+=windingLine(o[0],o[1],c[0],c[1],t,r)),a!==0}var TMP_TRANSFORM=[];function transformPoints(n,t){for(var r=0;r<n.length;r++)applyTransform$1(n[r],n[r],t)}function updateBBoxFromPoints(n,t,r,a){for(var o=0;o<n.length;o++){var u=n[o];a&&(u=a.project(u)),u&&isFinite(u[0])&&isFinite(u[1])&&(min$2(t,t,u),max$3(r,r,u))}}function centroid$1(n){for(var t=0,r=0,a=0,o=n.length,u=n[o-1][0],s=n[o-1][1],c=0;c<o;c++){var l=n[c][0],d=n[c][1],f=u*d-l*s;t+=f,r+=(u+l)*f,a+=(s+d)*f,u=l,s=d}return t?[r/t/3,a/t/3,t]:[n[0][0]||0,n[0][1]||0]}var Region=function(){function n(t){this.name=t}return n.prototype.setCenter=function(t){this._center=t},n.prototype.getCenter=function(){var t=this._center;return t||(t=this._center=this.calcCenter()),t},n}(),GeoJSONPolygonGeometry=function(){function n(t,r){this.type="polygon",this.exterior=t,this.interiors=r}return n}(),GeoJSONLineStringGeometry=function(){function n(t){this.type="linestring",this.points=t}return n}(),GeoJSONRegion=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this,r)||this;return u.type="geoJSON",u.geometries=a,u._center=o&&[o[0],o[1]],u}return t.prototype.calcCenter=function(){for(var r=this.geometries,a,o=0,u=0;u<r.length;u++){var s=r[u],c=s.exterior,l=c&&c.length;l>o&&(a=s,o=l)}if(a)return centroid$1(a.exterior);var d=this.getBoundingRect();return[d.x+d.width/2,d.y+d.height/2]},t.prototype.getBoundingRect=function(r){var a=this._rect;if(a&&!r)return a;var o=[1/0,1/0],u=[-1/0,-1/0],s=this.geometries;return each$f(s,function(c){c.type==="polygon"?updateBBoxFromPoints(c.exterior,o,u,r):each$f(c.points,function(l){updateBBoxFromPoints(l,o,u,r)})}),isFinite(o[0])&&isFinite(o[1])&&isFinite(u[0])&&isFinite(u[1])||(o[0]=o[1]=u[0]=u[1]=0),a=new BoundingRect(o[0],o[1],u[0]-o[0],u[1]-o[1]),r||(this._rect=a),a},t.prototype.contain=function(r){var a=this.getBoundingRect(),o=this.geometries;if(!a.contain(r[0],r[1]))return!1;e:for(var u=0,s=o.length;u<s;u++){var c=o[u];if(c.type==="polygon"){var l=c.exterior,d=c.interiors;if(contain(l,r[0],r[1])){for(var f=0;f<(d?d.length:0);f++)if(contain(d[f],r[0],r[1]))continue e;return!0}}}return!1},t.prototype.transformTo=function(r,a,o,u){var s=this.getBoundingRect(),c=s.width/s.height;o?u||(u=o/c):o=c*u;for(var l=new BoundingRect(r,a,o,u),d=s.calculateTransform(l),f=this.geometries,h=0;h<f.length;h++){var v=f[h];v.type==="polygon"?(transformPoints(v.exterior,d),each$f(v.interiors,function(g){transformPoints(g,d)})):each$f(v.points,function(g){transformPoints(g,d)})}s=this._rect,s.copy(l),this._center=[s.x+s.width/2,s.y+s.height/2]},t.prototype.cloneShallow=function(r){r==null&&(r=this.name);var a=new t(r,this.geometries,this._center);return a._rect=this._rect,a.transformTo=null,a},t}(Region),GeoSVGRegion=function(n){__extends(t,n);function t(r,a){var o=n.call(this,r)||this;return o.type="geoSVG",o._elOnlyForCalculate=a,o}return t.prototype.calcCenter=function(){for(var r=this._elOnlyForCalculate,a=r.getBoundingRect(),o=[a.x+a.width/2,a.y+a.height/2],u=identity$2(TMP_TRANSFORM),s=r;s&&!s.isGeoSVGGraphicRoot;)mul(u,s.getLocalTransform(),u),s=s.parent;return invert(u,u),applyTransform$1(o,o,u),o},t}(Region);function decode$4(n){if(!n.UTF8Encoding)return n;var t=n,r=t.UTF8Scale;r==null&&(r=1024);var a=t.features;return each$f(a,function(o){var u=o.geometry,s=u.encodeOffsets,c=u.coordinates;if(s)switch(u.type){case"LineString":u.coordinates=decodeRing(c,s,r);break;case"Polygon":decodeRings(c,s,r);break;case"MultiLineString":decodeRings(c,s,r);break;case"MultiPolygon":each$f(c,function(l,d){return decodeRings(l,s[d],r)})}}),t.UTF8Encoding=!1,t}function decodeRings(n,t,r){for(var a=0;a<n.length;a++)n[a]=decodeRing(n[a],t[a],r)}function decodeRing(n,t,r){for(var a=[],o=t[0],u=t[1],s=0;s<n.length;s+=2){var c=n.charCodeAt(s)-64,l=n.charCodeAt(s+1)-64;c=c>>1^-(c&1),l=l>>1^-(l&1),c+=o,l+=u,o=c,u=l,a.push([c/r,l/r])}return a}function parseGeoJSON(n,t){return n=decode$4(n),map$1(filter$1(n.features,function(r){return r.geometry&&r.properties&&r.geometry.coordinates.length>0}),function(r){var a=r.properties,o=r.geometry,u=[];switch(o.type){case"Polygon":var s=o.coordinates;u.push(new GeoJSONPolygonGeometry(s[0],s.slice(1)));break;case"MultiPolygon":each$f(o.coordinates,function(l){l[0]&&u.push(new GeoJSONPolygonGeometry(l[0],l.slice(1)))});break;case"LineString":u.push(new GeoJSONLineStringGeometry([o.coordinates]));break;case"MultiLineString":u.push(new GeoJSONLineStringGeometry(o.coordinates))}var c=new GeoJSONRegion(a[t||"name"],u,a.cp);return c.properties=a,c})}var inner$g=makeInner();function tickValuesToNumbers(n,t){var r=map$1(t,function(a){return n.scale.parse(a)});return n.type==="time"&&r.length>0&&(r.sort(),r.unshift(r[0]),r.push(r[r.length-1])),r}function createAxisLabels(n){var t=n.getLabelModel().get("customValues");if(t){var r=makeLabelFormatter(n),a=n.scale.getExtent(),o=tickValuesToNumbers(n,t),u=filter$1(o,function(s){return s>=a[0]&&s<=a[1]});return{labels:map$1(u,function(s){var c={value:s};return{formattedLabel:r(c),rawLabel:n.scale.getLabel(c),tickValue:s}})}}return n.type==="category"?makeCategoryLabels(n):makeRealNumberLabels(n)}function createAxisTicks(n,t){var r=n.getTickModel().get("customValues");if(r){var a=n.scale.getExtent(),o=tickValuesToNumbers(n,r);return{ticks:filter$1(o,function(u){return u>=a[0]&&u<=a[1]})}}return n.type==="category"?makeCategoryTicks(n,t):{ticks:map$1(n.scale.getTicks(),function(u){return u.value})}}function makeCategoryLabels(n){var t=n.getLabelModel(),r=makeCategoryLabelsActually(n,t);return!t.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function makeCategoryLabelsActually(n,t){var r=getListCache(n,"labels"),a=getOptionCategoryInterval(t),o=listCacheGet$1(r,a);if(o)return o;var u,s;return isFunction$1(a)?u=makeLabelsByCustomizedCategoryInterval(n,a):(s=a==="auto"?makeAutoCategoryInterval(n):a,u=makeLabelsByNumericCategoryInterval(n,s)),listCacheSet$1(r,a,{labels:u,labelCategoryInterval:s})}function makeCategoryTicks(n,t){var r=getListCache(n,"ticks"),a=getOptionCategoryInterval(t),o=listCacheGet$1(r,a);if(o)return o;var u,s;if((!t.get("show")||n.scale.isBlank())&&(u=[]),isFunction$1(a))u=makeLabelsByCustomizedCategoryInterval(n,a,!0);else if(a==="auto"){var c=makeCategoryLabelsActually(n,n.getLabelModel());s=c.labelCategoryInterval,u=map$1(c.labels,function(l){return l.tickValue})}else s=a,u=makeLabelsByNumericCategoryInterval(n,s,!0);return listCacheSet$1(r,a,{ticks:u,tickCategoryInterval:s})}function makeRealNumberLabels(n){var t=n.scale.getTicks(),r=makeLabelFormatter(n);return{labels:map$1(t,function(a,o){return{level:a.level,formattedLabel:r(a,o),rawLabel:n.scale.getLabel(a),tickValue:a.value}})}}function getListCache(n,t){return inner$g(n)[t]||(inner$g(n)[t]=[])}function listCacheGet$1(n,t){for(var r=0;r<n.length;r++)if(n[r].key===t)return n[r].value}function listCacheSet$1(n,t,r){return n.push({key:t,value:r}),r}function makeAutoCategoryInterval(n){var t=inner$g(n).autoInterval;return t??(inner$g(n).autoInterval=n.calculateCategoryInterval())}function calculateCategoryInterval(n){var t=fetchAutoCategoryIntervalCalculationParams(n),r=makeLabelFormatter(n),a=(t.axisRotate-t.labelRotate)/180*Math.PI,o=n.scale,u=o.getExtent(),s=o.count();if(u[1]-u[0]<1)return 0;var c=1;s>40&&(c=Math.max(1,Math.floor(s/40)));for(var l=u[0],d=n.dataToCoord(l+1)-n.dataToCoord(l),f=Math.abs(d*Math.cos(a)),h=Math.abs(d*Math.sin(a)),v=0,g=0;l<=u[1];l+=c){var b=0,_=0,S=getBoundingRect(r({value:l}),t.font,"center","top");b=S.width*1.3,_=S.height*1.3,v=Math.max(v,b,7),g=Math.max(g,_,7)}var T=v/f,w=g/h;isNaN(T)&&(T=1/0),isNaN(w)&&(w=1/0);var A=Math.max(0,Math.floor(Math.min(T,w))),R=inner$g(n.model),E=n.getExtent(),I=R.lastAutoInterval,L=R.lastTickCount;return I!=null&&L!=null&&Math.abs(I-A)<=1&&Math.abs(L-s)<=1&&I>A&&R.axisExtent0===E[0]&&R.axisExtent1===E[1]?A=I:(R.lastTickCount=s,R.lastAutoInterval=A,R.axisExtent0=E[0],R.axisExtent1=E[1]),A}function fetchAutoCategoryIntervalCalculationParams(n){var t=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function makeLabelsByNumericCategoryInterval(n,t,r){var a=makeLabelFormatter(n),o=n.scale,u=o.getExtent(),s=n.getLabelModel(),c=[],l=Math.max((t||0)+1,1),d=u[0],f=o.count();d!==0&&l>1&&f/l>2&&(d=Math.round(Math.ceil(d/l)*l));var h=shouldShowAllLabels(n),v=s.get("showMinLabel")||h,g=s.get("showMaxLabel")||h;v&&d!==u[0]&&_(u[0]);for(var b=d;b<=u[1];b+=l)_(b);g&&b-l!==u[1]&&_(u[1]);function _(S){var T={value:S};c.push(r?S:{formattedLabel:a(T),rawLabel:o.getLabel(T),tickValue:S})}return c}function makeLabelsByCustomizedCategoryInterval(n,t,r){var a=n.scale,o=makeLabelFormatter(n),u=[];return each$f(a.getTicks(),function(s){var c=a.getLabel(s),l=s.value;t(s.value,c)&&u.push(r?l:{formattedLabel:o(s),rawLabel:c,tickValue:l})}),u}var NORMALIZED_EXTENT=[0,1],Axis=function(){function n(t,r,a){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=a||[0,0]}return n.prototype.contain=function(t){var r=this._extent,a=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]);return t>=a&&t<=o},n.prototype.containData=function(t){return this.scale.contain(t)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(t){return getPixelPrecision(t||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(t,r){var a=this._extent;a[0]=t,a[1]=r},n.prototype.dataToCoord=function(t,r){var a=this._extent,o=this.scale;return t=o.normalize(t),this.onBand&&o.type==="ordinal"&&(a=a.slice(),fixExtentWithBands(a,o.count())),linearMap$2(t,NORMALIZED_EXTENT,a,r)},n.prototype.coordToData=function(t,r){var a=this._extent,o=this.scale;this.onBand&&o.type==="ordinal"&&(a=a.slice(),fixExtentWithBands(a,o.count()));var u=linearMap$2(t,a,NORMALIZED_EXTENT,r);return this.scale.scale(u)},n.prototype.pointToData=function(t,r){},n.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),a=createAxisTicks(this,r),o=a.ticks,u=map$1(o,function(c){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(c):c),tickValue:c}},this),s=r.get("alignWithLabel");return fixOnBandTicksCoords(this,u,s,t.clamp),u},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var a=this.scale.getMinorTicks(r),o=map$1(a,function(u){return map$1(u,function(s){return{coord:this.dataToCoord(s),tickValue:s}},this)},this);return o},n.prototype.getViewLabels=function(){return createAxisLabels(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),a=r[1]-r[0]+(this.onBand?1:0);a===0&&(a=1);var o=Math.abs(t[1]-t[0]);return Math.abs(o)/a},n.prototype.calculateCategoryInterval=function(){return calculateCategoryInterval(this)},n}();function fixExtentWithBands(n,t){var r=n[1]-n[0],a=t,o=r/a/2;n[0]+=o,n[1]-=o}function fixOnBandTicksCoords(n,t,r,a){var o=t.length;if(!n.onBand||r||!o)return;var u=n.getExtent(),s,c;if(o===1)t[0].coord=u[0],s=t[1]={coord:u[1],tickValue:t[0].tickValue};else{var l=t[o-1].tickValue-t[0].tickValue,d=(t[o-1].coord-t[0].coord)/l;each$f(t,function(g){g.coord-=d/2});var f=n.scale.getExtent();c=1+f[1]-t[o-1].tickValue,s={coord:t[o-1].coord+d*c,tickValue:f[1]+1},t.push(s)}var h=u[0]>u[1];v(t[0].coord,u[0])&&(a?t[0].coord=u[0]:t.shift()),a&&v(u[0],t[0].coord)&&t.unshift({coord:u[0]}),v(u[1],s.coord)&&(a?s.coord=u[1]:t.pop()),a&&v(s.coord,u[1])&&t.push({coord:u[1]});function v(g,b){return g=round$3(g),b=round$3(b),h?g>b:g<b}}var PI2$2=Math.PI*2,CMD$1=PathProxy.CMD,DEFAULT_SEARCH_SPACE=["top","right","bottom","left"];function getCandidateAnchor(n,t,r,a,o){var u=r.width,s=r.height;switch(n){case"top":a.set(r.x+u/2,r.y-t),o.set(0,-1);break;case"bottom":a.set(r.x+u/2,r.y+s+t),o.set(0,1);break;case"left":a.set(r.x-t,r.y+s/2),o.set(-1,0);break;case"right":a.set(r.x+u+t,r.y+s/2),o.set(1,0);break}}function projectPointToArc(n,t,r,a,o,u,s,c,l){s-=n,c-=t;var d=Math.sqrt(s*s+c*c);s/=d,c/=d;var f=s*r+n,h=c*r+t;if(Math.abs(a-o)%PI2$2<1e-4)return l[0]=f,l[1]=h,d-r;if(u){var v=a;a=normalizeRadian(o),o=normalizeRadian(v)}else a=normalizeRadian(a),o=normalizeRadian(o);a>o&&(o+=PI2$2);var g=Math.atan2(c,s);if(g<0&&(g+=PI2$2),g>=a&&g<=o||g+PI2$2>=a&&g+PI2$2<=o)return l[0]=f,l[1]=h,d-r;var b=r*Math.cos(a)+n,_=r*Math.sin(a)+t,S=r*Math.cos(o)+n,T=r*Math.sin(o)+t,w=(b-s)*(b-s)+(_-c)*(_-c),A=(S-s)*(S-s)+(T-c)*(T-c);return w<A?(l[0]=b,l[1]=_,Math.sqrt(w)):(l[0]=S,l[1]=T,Math.sqrt(A))}function projectPointToLine(n,t,r,a,o,u,s,c){var l=o-n,d=u-t,f=r-n,h=a-t,v=Math.sqrt(f*f+h*h);f/=v,h/=v;var g=l*f+d*h,b=g/v;c&&(b=Math.min(Math.max(b,0),1)),b*=v;var _=s[0]=n+b*f,S=s[1]=t+b*h;return Math.sqrt((_-o)*(_-o)+(S-u)*(S-u))}function projectPointToRect(n,t,r,a,o,u,s){r<0&&(n=n+r,r=-r),a<0&&(t=t+a,a=-a);var c=n+r,l=t+a,d=s[0]=Math.min(Math.max(o,n),c),f=s[1]=Math.min(Math.max(u,t),l);return Math.sqrt((d-o)*(d-o)+(f-u)*(f-u))}var tmpPt=[];function nearestPointOnRect(n,t,r){var a=projectPointToRect(t.x,t.y,t.width,t.height,n.x,n.y,tmpPt);return r.set(tmpPt[0],tmpPt[1]),a}function nearestPointOnPath(n,t,r){for(var a=0,o=0,u=0,s=0,c,l,d=1/0,f=t.data,h=n.x,v=n.y,g=0;g<f.length;){var b=f[g++];g===1&&(a=f[g],o=f[g+1],u=a,s=o);var _=d;switch(b){case CMD$1.M:u=f[g++],s=f[g++],a=u,o=s;break;case CMD$1.L:_=projectPointToLine(a,o,f[g],f[g+1],h,v,tmpPt,!0),a=f[g++],o=f[g++];break;case CMD$1.C:_=cubicProjectPoint(a,o,f[g++],f[g++],f[g++],f[g++],f[g],f[g+1],h,v,tmpPt),a=f[g++],o=f[g++];break;case CMD$1.Q:_=quadraticProjectPoint(a,o,f[g++],f[g++],f[g],f[g+1],h,v,tmpPt),a=f[g++],o=f[g++];break;case CMD$1.A:var S=f[g++],T=f[g++],w=f[g++],A=f[g++],R=f[g++],E=f[g++];g+=1;var I=!!(1-f[g++]);c=Math.cos(R)*w+S,l=Math.sin(R)*A+T,g<=1&&(u=c,s=l);var L=(h-S)*A/w+S;_=projectPointToArc(S,T,A,R,R+E,I,L,v,tmpPt),a=Math.cos(R+E)*w+S,o=Math.sin(R+E)*A+T;break;case CMD$1.R:u=a=f[g++],s=o=f[g++];var F=f[g++],D=f[g++];_=projectPointToRect(u,s,F,D,h,v,tmpPt);break;case CMD$1.Z:_=projectPointToLine(a,o,u,s,h,v,tmpPt,!0),a=u,o=s;break}_<d&&(d=_,r.set(tmpPt[0],tmpPt[1]))}return d}var pt0=new Point,pt1=new Point,pt2=new Point,dir=new Point,dir2=new Point;function updateLabelLinePoints(n,t){if(n){var r=n.getTextGuideLine(),a=n.getTextContent();if(a&&r){var o=n.textGuideLineConfig||{},u=[[0,0],[0,0],[0,0]],s=o.candidates||DEFAULT_SEARCH_SPACE,c=a.getBoundingRect().clone();c.applyTransform(a.getComputedTransform());var l=1/0,d=o.anchor,f=n.getComputedTransform(),h=f&&invert([],f),v=t.get("length2")||0;d&&pt2.copy(d);for(var g=0;g<s.length;g++){var b=s[g];getCandidateAnchor(b,0,c,pt0,dir),Point.scaleAndAdd(pt1,pt0,dir,v),pt1.transform(h);var _=n.getBoundingRect(),S=d?d.distance(pt1):n instanceof Path?nearestPointOnPath(pt1,n.path,pt2):nearestPointOnRect(pt1,_,pt2);S<l&&(l=S,pt1.transform(f),pt2.transform(f),pt2.toArray(u[0]),pt1.toArray(u[1]),pt0.toArray(u[2]))}limitTurnAngle(u,t.get("minTurnAngle")),r.setShape({points:u})}}}var tmpArr=[],tmpProjPoint=new Point;function limitTurnAngle(n,t){if(t<=180&&t>0){t=t/180*Math.PI,pt0.fromArray(n[0]),pt1.fromArray(n[1]),pt2.fromArray(n[2]),Point.sub(dir,pt0,pt1),Point.sub(dir2,pt2,pt1);var r=dir.len(),a=dir2.len();if(!(r<.001||a<.001)){dir.scale(1/r),dir2.scale(1/a);var o=dir.dot(dir2),u=Math.cos(t);if(u<o){var s=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr,!1);tmpProjPoint.fromArray(tmpArr),tmpProjPoint.scaleAndAdd(dir2,s/Math.tan(Math.PI-t));var c=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(c))return;c<0?Point.copy(tmpProjPoint,pt1):c>1&&Point.copy(tmpProjPoint,pt2),tmpProjPoint.toArray(n[1])}}}}function limitSurfaceAngle(n,t,r){if(r<=180&&r>0){r=r/180*Math.PI,pt0.fromArray(n[0]),pt1.fromArray(n[1]),pt2.fromArray(n[2]),Point.sub(dir,pt1,pt0),Point.sub(dir2,pt2,pt1);var a=dir.len(),o=dir2.len();if(!(a<.001||o<.001)){dir.scale(1/a),dir2.scale(1/o);var u=dir.dot(t),s=Math.cos(r);if(u<s){var c=projectPointToLine(pt1.x,pt1.y,pt2.x,pt2.y,pt0.x,pt0.y,tmpArr,!1);tmpProjPoint.fromArray(tmpArr);var l=Math.PI/2,d=Math.acos(dir2.dot(t)),f=l+d-r;if(f>=l)Point.copy(tmpProjPoint,pt2);else{tmpProjPoint.scaleAndAdd(dir2,c/Math.tan(Math.PI/2-f));var h=pt2.x!==pt1.x?(tmpProjPoint.x-pt1.x)/(pt2.x-pt1.x):(tmpProjPoint.y-pt1.y)/(pt2.y-pt1.y);if(isNaN(h))return;h<0?Point.copy(tmpProjPoint,pt1):h>1&&Point.copy(tmpProjPoint,pt2)}tmpProjPoint.toArray(n[1])}}}}function setLabelLineState(n,t,r,a){var o=r==="normal",u=o?n:n.ensureState(r);u.ignore=t;var s=a.get("smooth");s&&s===!0&&(s=.3),u.shape=u.shape||{},s>0&&(u.shape.smooth=s);var c=a.getModel("lineStyle").getLineStyle();o?n.useStyle(c):u.style=c}function buildLabelLinePath(n,t){var r=t.smooth,a=t.points;if(a)if(n.moveTo(a[0][0],a[0][1]),r>0&&a.length>=3){var o=dist$7(a[0],a[1]),u=dist$7(a[1],a[2]);if(!o||!u){n.lineTo(a[1][0],a[1][1]),n.lineTo(a[2][0],a[2][1]);return}var s=Math.min(o,u)*r,c=lerp$1([],a[1],a[0],s/o),l=lerp$1([],a[1],a[2],s/u),d=lerp$1([],c,l,.5);n.bezierCurveTo(c[0],c[1],c[0],c[1],d[0],d[1]),n.bezierCurveTo(l[0],l[1],l[0],l[1],a[2][0],a[2][1])}else for(var f=1;f<a.length;f++)n.lineTo(a[f][0],a[f][1])}function setLabelLineStyle(n,t,r){var a=n.getTextGuideLine(),o=n.getTextContent();if(!o){a&&n.removeTextGuideLine();return}for(var u=t.normal,s=u.get("show"),c=o.ignore,l=0;l<DISPLAY_STATES.length;l++){var d=DISPLAY_STATES[l],f=t[d],h=d==="normal";if(f){var v=f.get("show"),g=h?c:retrieve2(o.states[d]&&o.states[d].ignore,c);if(g||!retrieve2(v,s)){var b=h?a:a&&a.states[d];b&&(b.ignore=!0),a&&setLabelLineState(a,!0,d,f);continue}a||(a=new Polyline$1,n.setTextGuideLine(a),!h&&(c||!s)&&setLabelLineState(a,!0,"normal",t.normal),n.stateProxy&&(a.stateProxy=n.stateProxy)),setLabelLineState(a,!1,d,f)}}if(a){defaults$h(a.style,r),a.style.fill=null;var _=u.get("showAbove"),S=n.textGuideLineConfig=n.textGuideLineConfig||{};S.showAbove=_||!1,a.buildPath=buildLabelLinePath}}function getLabelLineStatesModels(n,t){t=t||"labelLine";for(var r={normal:n.getModel(t)},a=0;a<SPECIAL_STATES.length;a++){var o=SPECIAL_STATES[a];r[o]=n.getModel([o,t])}return r}function prepareLayoutList(n){for(var t=[],r=0;r<n.length;r++){var a=n[r];if(!a.defaultAttr.ignore){var o=a.label,u=o.getComputedTransform(),s=o.getBoundingRect(),c=!u||u[1]<1e-5&&u[2]<1e-5,l=o.style.margin||0,d=s.clone();d.applyTransform(u),d.x-=l/2,d.y-=l/2,d.width+=l,d.height+=l;var f=c?new OrientedBoundingRect(s,u):null;t.push({label:o,labelLine:a.labelLine,rect:d,localRect:s,obb:f,priority:a.priority,defaultAttr:a.defaultAttr,layoutOption:a.computedLayoutOption,axisAligned:c,transform:u})}}return t}function shiftLayout(n,t,r,a,o,u){var s=n.length;if(s<2)return;n.sort(function(I,L){return I.rect[t]-L.rect[t]});for(var c=0,l,d=!1,f=0;f<s;f++){var h=n[f],v=h.rect;l=v[t]-c,l<0&&(v[t]-=l,h.label[t]-=l,d=!0),c=v[t]+v[r]}var g=n[0],b=n[s-1],_,S;T(),_<0&&R(-_,.8),S<0&&R(S,.8),T(),w(_,S,1),w(S,_,-1),T(),_<0&&E(-_),S<0&&E(S);function T(){_=g.rect[t]-a,S=o-b.rect[t]-b.rect[r]}function w(I,L,F){if(I<0){var D=Math.min(L,-I);if(D>0){A(D*F,0,s);var $=D+I;$<0&&R(-$*F,1)}else R(-I*F,1)}}function A(I,L,F){I!==0&&(d=!0);for(var D=L;D<F;D++){var $=n[D],O=$.rect;O[t]+=I,$.label[t]+=I}}function R(I,L){for(var F=[],D=0,$=1;$<s;$++){var O=n[$-1].rect,P=Math.max(n[$].rect[t]-O[t]-O[r],0);F.push(P),D+=P}if(D){var C=Math.min(Math.abs(I)/D,L);if(I>0)for(var $=0;$<s-1;$++){var q=F[$]*C;A(q,0,$+1)}else for(var $=s-1;$>0;$--){var q=F[$-1]*C;A(-q,$,s)}}}function E(I){var L=I<0?-1:1;I=Math.abs(I);for(var F=Math.ceil(I/(s-1)),D=0;D<s-1;D++)if(L>0?A(F,0,D+1):A(-F,s-D-1,s),I-=F,I<=0)return}return d}function shiftLayoutOnX(n,t,r,a){return shiftLayout(n,"x","width",t,r)}function shiftLayoutOnY(n,t,r,a){return shiftLayout(n,"y","height",t,r)}function hideOverlap(n){var t=[];n.sort(function(_,S){return S.priority-_.priority});var r=new BoundingRect(0,0,0,0);function a(_){if(!_.ignore){var S=_.ensureState("emphasis");S.ignore==null&&(S.ignore=!1)}_.ignore=!0}for(var o=0;o<n.length;o++){var u=n[o],s=u.axisAligned,c=u.localRect,l=u.transform,d=u.label,f=u.labelLine;r.copy(u.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var h=u.obb,v=!1,g=0;g<t.length;g++){var b=t[g];if(r.intersect(b.rect)){if(s&&b.axisAligned){v=!0;break}if(b.obb||(b.obb=new OrientedBoundingRect(b.localRect,b.transform)),h||(h=new OrientedBoundingRect(c,l)),h.intersect(b.obb)){v=!0;break}}}v?(a(d),f&&a(f)):(d.attr("ignore",u.defaultAttr.ignore),f&&f.attr("ignore",u.defaultAttr.labelGuideIgnore),t.push(u))}}function cloneArr(n){if(n){for(var t=[],r=0;r<n.length;r++)t.push(n[r].slice());return t}}function prepareLayoutCallbackParams(n,t){var r=n.label,a=t&&t.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:r.style.align,verticalAlign:r.style.verticalAlign,labelLinePoints:cloneArr(a&&a.shape.points)}}var LABEL_OPTION_TO_STYLE_KEYS=["align","verticalAlign","width","height","fontSize"],dummyTransformable=new Transformable,labelLayoutInnerStore=makeInner(),labelLineAnimationStore=makeInner();function extendWithKeys(n,t,r){for(var a=0;a<r.length;a++){var o=r[a];t[o]!=null&&(n[o]=t[o])}}var LABEL_LAYOUT_PROPS=["x","y","rotation"],LabelManager=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(t,r,a,o,u){var s=o.style,c=o.__hostTarget,l=c.textConfig||{},d=o.getComputedTransform(),f=o.getBoundingRect().plain();BoundingRect.applyTransform(f,f,d),d?dummyTransformable.setLocalTransform(d):(dummyTransformable.x=dummyTransformable.y=dummyTransformable.rotation=dummyTransformable.originX=dummyTransformable.originY=0,dummyTransformable.scaleX=dummyTransformable.scaleY=1),dummyTransformable.rotation=normalizeRadian(dummyTransformable.rotation);var h=o.__hostTarget,v;if(h){v=h.getBoundingRect().plain();var g=h.getComputedTransform();BoundingRect.applyTransform(v,v,g)}var b=v&&h.getTextGuideLine();this._labelList.push({label:o,labelLine:b,seriesModel:a,dataIndex:t,dataType:r,layoutOption:u,computedLayoutOption:null,rect:f,hostRect:v,priority:v?v.width*v.height:0,defaultAttr:{ignore:o.ignore,labelGuideIgnore:b&&b.ignore,x:dummyTransformable.x,y:dummyTransformable.y,scaleX:dummyTransformable.scaleX,scaleY:dummyTransformable.scaleY,rotation:dummyTransformable.rotation,style:{x:s.x,y:s.y,align:s.align,verticalAlign:s.verticalAlign,width:s.width,height:s.height,fontSize:s.fontSize},cursor:o.cursor,attachedPos:l.position,attachedRot:l.rotation}})},n.prototype.addLabelsOfSeries=function(t){var r=this;this._chartViewList.push(t);var a=t.__model,o=a.get("labelLayout");(isFunction$1(o)||keys(o).length)&&t.group.traverse(function(u){if(u.ignore)return!0;var s=u.getTextContent(),c=getECData(u);s&&!s.disableLabelLayout&&r._addLabel(c.dataIndex,c.dataType,a,s,o)})},n.prototype.updateLayoutConfig=function(t){var r=t.getWidth(),a=t.getHeight();function o(A,R){return function(){updateLabelLinePoints(A,R)}}for(var u=0;u<this._labelList.length;u++){var s=this._labelList[u],c=s.label,l=c.__hostTarget,d=s.defaultAttr,f=void 0;isFunction$1(s.layoutOption)?f=s.layoutOption(prepareLayoutCallbackParams(s,l)):f=s.layoutOption,f=f||{},s.computedLayoutOption=f;var h=Math.PI/180;l&&l.setTextConfig({local:!1,position:f.x!=null||f.y!=null?null:d.attachedPos,rotation:f.rotate!=null?f.rotate*h:d.attachedRot,offset:[f.dx||0,f.dy||0]});var v=!1;if(f.x!=null?(c.x=parsePercent(f.x,r),c.setStyle("x",0),v=!0):(c.x=d.x,c.setStyle("x",d.style.x)),f.y!=null?(c.y=parsePercent(f.y,a),c.setStyle("y",0),v=!0):(c.y=d.y,c.setStyle("y",d.style.y)),f.labelLinePoints){var g=l.getTextGuideLine();g&&(g.setShape({points:f.labelLinePoints}),v=!1)}var b=labelLayoutInnerStore(c);b.needsUpdateLabelLine=v,c.rotation=f.rotate!=null?f.rotate*h:d.rotation,c.scaleX=d.scaleX,c.scaleY=d.scaleY;for(var _=0;_<LABEL_OPTION_TO_STYLE_KEYS.length;_++){var S=LABEL_OPTION_TO_STYLE_KEYS[_];c.setStyle(S,f[S]!=null?f[S]:d.style[S])}if(f.draggable){if(c.draggable=!0,c.cursor="move",l){var T=s.seriesModel;if(s.dataIndex!=null){var w=s.seriesModel.getData(s.dataType);T=w.getItemModel(s.dataIndex)}c.on("drag",o(l,T.getModel("labelLine")))}}else c.off("drag"),c.cursor=d.cursor}},n.prototype.layout=function(t){var r=t.getWidth(),a=t.getHeight(),o=prepareLayoutList(this._labelList),u=filter$1(o,function(l){return l.layoutOption.moveOverlap==="shiftX"}),s=filter$1(o,function(l){return l.layoutOption.moveOverlap==="shiftY"});shiftLayoutOnX(u,0,r),shiftLayoutOnY(s,0,a);var c=filter$1(o,function(l){return l.layoutOption.hideOverlap});hideOverlap(c)},n.prototype.processLabelsOverall=function(){var t=this;each$f(this._chartViewList,function(r){var a=r.__model,o=r.ignoreLabelLineUpdate,u=a.isAnimationEnabled();r.group.traverse(function(s){if(s.ignore&&!s.forceLabelAnimation)return!0;var c=!o,l=s.getTextContent();!c&&l&&(c=labelLayoutInnerStore(l).needsUpdateLabelLine),c&&t._updateLabelLine(s,a),u&&t._animateLabels(s,a)})})},n.prototype._updateLabelLine=function(t,r){var a=t.getTextContent(),o=getECData(t),u=o.dataIndex;if(a&&u!=null){var s=r.getData(o.dataType),c=s.getItemModel(u),l={},d=s.getItemVisual(u,"style");if(d){var f=s.getVisual("drawType");l.stroke=d[f]}var h=c.getModel("labelLine");setLabelLineStyle(t,getLabelLineStatesModels(c),l),updateLabelLinePoints(t,h)}},n.prototype._animateLabels=function(t,r){var a=t.getTextContent(),o=t.getTextGuideLine();if(a&&(t.forceLabelAnimation||!a.ignore&&!a.invisible&&!t.disableLabelAnimation&&!isElementRemoved(t))){var u=labelLayoutInnerStore(a),s=u.oldLayout,c=getECData(t),l=c.dataIndex,d={x:a.x,y:a.y,rotation:a.rotation},f=r.getData(c.dataType);if(s){a.attr(s);var v=t.prevStates;v&&(indexOf(v,"select")>=0&&a.attr(u.oldLayoutSelect),indexOf(v,"emphasis")>=0&&a.attr(u.oldLayoutEmphasis)),updateProps$1(a,d,r,l)}else if(a.attr(d),!labelInner(a).valueAnimation){var h=retrieve2(a.style.opacity,1);a.style.opacity=0,initProps(a,{style:{opacity:h}},r,l)}if(u.oldLayout=d,a.states.select){var g=u.oldLayoutSelect={};extendWithKeys(g,d,LABEL_LAYOUT_PROPS),extendWithKeys(g,a.states.select,LABEL_LAYOUT_PROPS)}if(a.states.emphasis){var b=u.oldLayoutEmphasis={};extendWithKeys(b,d,LABEL_LAYOUT_PROPS),extendWithKeys(b,a.states.emphasis,LABEL_LAYOUT_PROPS)}animateLabelValue(a,l,f,r,r)}if(o&&!o.ignore&&!o.invisible){var u=labelLineAnimationStore(o),s=u.oldLayout,_={points:o.shape.points};s?(o.attr({shape:s}),updateProps$1(o,{shape:_},r)):(o.setShape(_),o.style.strokePercent=0,initProps(o,{style:{strokePercent:1}},r)),u.oldLayout=_}},n}(),getLabelManager=makeInner();function installLabelLayout(n){n.registerUpdateLifecycle("series:beforeupdate",function(t,r,a){var o=getLabelManager(r).labelManager;o||(o=getLabelManager(r).labelManager=new LabelManager),o.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(t,r,a){var o=getLabelManager(r).labelManager;a.updatedSeries.forEach(function(u){o.addLabelsOfSeries(r.getViewOfSeriesModel(u))}),o.updateLayoutConfig(r),o.layout(r),o.processLabelsOverall()})}var mathSin=Math.sin,mathCos=Math.cos,PI$4=Math.PI,PI2$1=Math.PI*2,degree=180/PI$4,SVGPathRebuilder=function(){function n(){}return n.prototype.reset=function(t){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,t||4)},n.prototype.moveTo=function(t,r){this._add("M",t,r)},n.prototype.lineTo=function(t,r){this._add("L",t,r)},n.prototype.bezierCurveTo=function(t,r,a,o,u,s){this._add("C",t,r,a,o,u,s)},n.prototype.quadraticCurveTo=function(t,r,a,o){this._add("Q",t,r,a,o)},n.prototype.arc=function(t,r,a,o,u,s){this.ellipse(t,r,a,a,0,o,u,s)},n.prototype.ellipse=function(t,r,a,o,u,s,c,l){var d=c-s,f=!l,h=Math.abs(d),v=isAroundZero(h-PI2$1)||(f?d>=PI2$1:-d>=PI2$1),g=d>0?d%PI2$1:d%PI2$1+PI2$1,b=!1;v?b=!0:isAroundZero(h)?b=!1:b=g>=PI$4==!!f;var _=t+a*mathCos(s),S=r+o*mathSin(s);this._start&&this._add("M",_,S);var T=Math.round(u*degree);if(v){var w=1/this._p,A=(f?1:-1)*(PI2$1-w);this._add("A",a,o,T,1,+f,t+a*mathCos(s+A),r+o*mathSin(s+A)),w>.01&&this._add("A",a,o,T,0,+f,_,S)}else{var R=t+a*mathCos(c),E=r+o*mathSin(c);this._add("A",a,o,T,+b,+f,R,E)}},n.prototype.rect=function(t,r,a,o){this._add("M",t,r),this._add("l",a,0),this._add("l",0,o),this._add("l",-a,0),this._add("Z")},n.prototype.closePath=function(){this._d.length>0&&this._add("Z")},n.prototype._add=function(t,r,a,o,u,s,c,l,d){for(var f=[],h=this._p,v=1;v<arguments.length;v++){var g=arguments[v];if(isNaN(g)){this._invalid=!0;return}f.push(Math.round(g*h)/h)}this._d.push(t+f.join(" ")),this._start=t==="Z"},n.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},n.prototype.getStr=function(){return this._str},n}(),NONE="none",mathRound=Math.round;function pathHasFill(n){var t=n.fill;return t!=null&&t!==NONE}function pathHasStroke(n){var t=n.stroke;return t!=null&&t!==NONE}var strokeProps=["lineCap","miterLimit","lineJoin"],svgStrokeProps=map$1(strokeProps,function(n){return"stroke-"+n.toLowerCase()});function mapStyleToAttrs(n,t,r,a){var o=t.opacity==null?1:t.opacity;if(r instanceof ZRImage){n("opacity",o);return}if(pathHasFill(t)){var u=normalizeColor(t.fill);n("fill",u.color);var s=t.fillOpacity!=null?t.fillOpacity*u.opacity*o:u.opacity*o;s<1&&n("fill-opacity",s)}else n("fill",NONE);if(pathHasStroke(t)){var c=normalizeColor(t.stroke);n("stroke",c.color);var l=t.strokeNoScale?r.getLineScale():1,d=l?(t.lineWidth||0)/l:0,f=t.strokeOpacity!=null?t.strokeOpacity*c.opacity*o:c.opacity*o,h=t.strokeFirst;if(d!==1&&n("stroke-width",d),h&&n("paint-order",h?"stroke":"fill"),f<1&&n("stroke-opacity",f),t.lineDash){var v=getLineDash(r),g=v[0],b=v[1];g&&(b=mathRound(b||0),n("stroke-dasharray",g.join(",")),(b||a)&&n("stroke-dashoffset",b))}for(var _=0;_<strokeProps.length;_++){var S=strokeProps[_];if(t[S]!==DEFAULT_PATH_STYLE[S]){var T=t[S]||DEFAULT_PATH_STYLE[S];T&&n(svgStrokeProps[_],T)}}}}var SVGNS="http://www.w3.org/2000/svg",XLINKNS="http://www.w3.org/1999/xlink",XMLNS="http://www.w3.org/2000/xmlns/",XML_NAMESPACE="http://www.w3.org/XML/1998/namespace",META_DATA_PREFIX="ecmeta_";function createElement(n){return document.createElementNS(SVGNS,n)}function createVNode(n,t,r,a,o){return{tag:n,attrs:r||{},children:a,text:o,key:t}}function createElementOpen(n,t){var r=[];if(t)for(var a in t){var o=t[a],u=a;o!==!1&&(o!==!0&&o!=null&&(u+='="'+o+'"'),r.push(u))}return"<"+n+" "+r.join(" ")+">"}function createElementClose(n){return"</"+n+">"}function vNodeToString(n,t){t=t||{};var r=t.newline?`
`:"";function a(o){var u=o.children,s=o.tag,c=o.attrs,l=o.text;return createElementOpen(s,c)+(s!=="style"?encodeHTML(l):l||"")+(u?""+r+map$1(u,function(d){return a(d)}).join(r)+r:"")+createElementClose(s)}return a(n)}function getCssString(n,t,r){r=r||{};var a=r.newline?`
`:"",o=" {"+a,u=a+"}",s=map$1(keys(n),function(l){return l+o+map$1(keys(n[l]),function(d){return d+":"+n[l][d]+";"}).join(a)+u}).join(a),c=map$1(keys(t),function(l){return"@keyframes "+l+o+map$1(keys(t[l]),function(d){return d+o+map$1(keys(t[l][d]),function(f){var h=t[l][d][f];return f==="d"&&(h='path("'+h+'")'),f+":"+h+";"}).join(a)+u}).join(a)+u}).join(a);return!s&&!c?"":["<![CDATA[",s,c,"]]>"].join(a)}function createBrushScope(n){return{zrId:n,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function createSVGVNode(n,t,r,a){return createVNode("svg","root",{width:n,height:t,xmlns:SVGNS,"xmlns:xlink":XLINKNS,version:"1.1",baseProfile:"full",viewBox:a?"0 0 "+n+" "+t:!1},r)}var cssClassIdx=0;function getClassId(){return cssClassIdx++}var EASING_MAP={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},transformOriginKey="transform-origin";function buildPathString(n,t,r){var a=extend$1({},n.shape);extend$1(a,t),n.buildPath(r,a);var o=new SVGPathRebuilder;return o.reset(getPathPrecision(n)),r.rebuildPath(o,1),o.generateStr(),o.getStr()}function setTransformOrigin(n,t){var r=t.originX,a=t.originY;(r||a)&&(n[transformOriginKey]=r+"px "+a+"px")}var ANIMATE_STYLE_MAP={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function addAnimation(n,t){var r=t.zrId+"-ani-"+t.cssAnimIdx++;return t.cssAnims[r]=n,r}function createCompoundPathCSSAnimation(n,t,r){var a=n.shape.paths,o={},u,s;if(each$f(a,function(l){var d=createBrushScope(r.zrId);d.animation=!0,createCSSAnimation(l,{},d,!0);var f=d.cssAnims,h=d.cssNodes,v=keys(f),g=v.length;if(g){s=v[g-1];var b=f[s];for(var _ in b){var S=b[_];o[_]=o[_]||{d:""},o[_].d+=S.d||""}for(var T in h){var w=h[T].animation;w.indexOf(s)>=0&&(u=w)}}}),!!u){t.d=!1;var c=addAnimation(o,r);return u.replace(s,c)}}function getEasingFunc(n){return isString(n)?EASING_MAP[n]?"cubic-bezier("+EASING_MAP[n]+")":createCubicEasingFunc(n)?n:"":""}function createCSSAnimation(n,t,r,a){var o=n.animators,u=o.length,s=[];if(n instanceof CompoundPath){var c=createCompoundPathCSSAnimation(n,t,r);if(c)s.push(c);else if(!u)return}else if(!u)return;for(var l={},d=0;d<u;d++){var f=o[d],h=[f.getMaxTime()/1e3+"s"],v=getEasingFunc(f.getClip().easing),g=f.getDelay();v?h.push(v):h.push("linear"),g&&h.push(g/1e3+"s"),f.getLoop()&&h.push("infinite");var b=h.join(" ");l[b]=l[b]||[b,[]],l[b][1].push(f)}function _(w){var A=w[1],R=A.length,E={},I={},L={},F="animation-timing-function";function D(ve,ce,J){for(var j=ve.getTracks(),z=ve.getMaxTime(),B=0;B<j.length;B++){var U=j[B];if(U.needsAnimate()){var Z=U.keyframes,oe=U.propName;if(J&&(oe=J(oe)),oe)for(var ie=0;ie<Z.length;ie++){var se=Z[ie],ne=Math.round(se.time/z*100)+"%",he=getEasingFunc(se.easing),xe=se.rawValue;(isString(xe)||isNumber(xe))&&(ce[ne]=ce[ne]||{},ce[ne][oe]=se.rawValue,he&&(ce[ne][F]=he))}}}}for(var $=0;$<R;$++){var O=A[$],P=O.targetName;P?P==="shape"&&D(O,I):!a&&D(O,E)}for(var C in E){var q={};copyTransform(q,n),extend$1(q,E[C]);var M=getSRTTransformString(q),N=E[C][F];L[C]=M?{transform:M}:{},setTransformOrigin(L[C],q),N&&(L[C][F]=N)}var G,X=!0;for(var C in I){L[C]=L[C]||{};var Y=!G,N=I[C][F];Y&&(G=new PathProxy);var W=G.len();G.reset(),L[C].d=buildPathString(n,I[C],G);var te=G.len();if(!Y&&W!==te){X=!1;break}N&&(L[C][F]=N)}if(!X)for(var C in L)delete L[C].d;if(!a)for(var $=0;$<R;$++){var O=A[$],P=O.targetName;P==="style"&&D(O,L,function(j){return ANIMATE_STYLE_MAP[j]})}for(var ue=keys(L),fe=!0,re,$=1;$<ue.length;$++){var ye=ue[$-1],Te=ue[$];if(L[ye][transformOriginKey]!==L[Te][transformOriginKey]){fe=!1;break}re=L[ye][transformOriginKey]}if(fe&&re){for(var C in L)L[C][transformOriginKey]&&delete L[C][transformOriginKey];t[transformOriginKey]=re}if(filter$1(ue,function(ve){return keys(L[ve]).length>0}).length){var Re=addAnimation(L,r);return Re+" "+w[0]+" both"}}for(var S in l){var c=_(l[S]);c&&s.push(c)}if(s.length){var T=r.zrId+"-cls-"+getClassId();r.cssNodes["."+T]={animation:s.join(",")},t.class=T}}function createCSSEmphasis(n,t,r){if(!n.ignore)if(n.isSilent()){var a={"pointer-events":"none"};setClassAttribute(a,t,r)}else{var o=n.states.emphasis&&n.states.emphasis.style?n.states.emphasis.style:{},u=o.fill;if(!u){var s=n.style&&n.style.fill,c=n.states.select&&n.states.select.style&&n.states.select.style.fill,l=n.currentStates.indexOf("select")>=0&&c||s;l&&(u=liftColor(l))}var d=o.lineWidth;if(d){var f=!o.strokeNoScale&&n.transform?n.transform[0]:1;d=d/f}var a={cursor:"pointer"};u&&(a.fill=u),o.stroke&&(a.stroke=o.stroke),d&&(a["stroke-width"]=d),setClassAttribute(a,t,r)}}function setClassAttribute(n,t,r,a){var o=JSON.stringify(n),u=r.cssStyleCache[o];u||(u=r.zrId+"-cls-"+getClassId(),r.cssStyleCache[o]=u,r.cssNodes["."+u+":hover"]=n),t.class=t.class?t.class+" "+u:u}var round$1=Math.round;function isImageLike(n){return n&&isString(n.src)}function isCanvasLike(n){return n&&isFunction$1(n.toDataURL)}function setStyleAttrs(n,t,r,a){mapStyleToAttrs(function(o,u){var s=o==="fill"||o==="stroke";s&&isGradient(u)?setGradient(t,n,o,a):s&&isPattern(u)?setPattern(r,n,o,a):n[o]=u,s&&a.ssr&&u==="none"&&(n["pointer-events"]="visible")},t,r,!1),setShadow(r,n,a)}function setMetaData(n,t){var r=getElementSSRData(t);r&&(r.each(function(a,o){a!=null&&(n[(META_DATA_PREFIX+o).toLowerCase()]=a+"")}),t.isSilent()&&(n[META_DATA_PREFIX+"silent"]="true"))}function noRotateScale(n){return isAroundZero(n[0]-1)&&isAroundZero(n[1])&&isAroundZero(n[2])&&isAroundZero(n[3]-1)}function noTranslate(n){return isAroundZero(n[4])&&isAroundZero(n[5])}function setTransform(n,t,r){if(t&&!(noTranslate(t)&&noRotateScale(t))){var a=1e4;n.transform=noRotateScale(t)?"translate("+round$1(t[4]*a)/a+" "+round$1(t[5]*a)/a+")":getMatrixStr(t)}}function convertPolyShape(n,t,r){for(var a=n.points,o=[],u=0;u<a.length;u++)o.push(round$1(a[u][0]*r)/r),o.push(round$1(a[u][1]*r)/r);t.points=o.join(" ")}function validatePolyShape(n){return!n.smooth}function createAttrsConvert(n){var t=map$1(n,function(r){return typeof r=="string"?[r,r]:r});return function(r,a,o){for(var u=0;u<t.length;u++){var s=t[u],c=r[s[0]];c!=null&&(a[s[1]]=round$1(c*o)/o)}}}var builtinShapesDef={circle:[createAttrsConvert(["cx","cy","r"])],polyline:[convertPolyShape,validatePolyShape],polygon:[convertPolyShape,validatePolyShape]};function hasShapeAnimation(n){for(var t=n.animators,r=0;r<t.length;r++)if(t[r].targetName==="shape")return!0;return!1}function brushSVGPath(n,t){var r=n.style,a=n.shape,o=builtinShapesDef[n.type],u={},s=t.animation,c="path",l=n.style.strokePercent,d=t.compress&&getPathPrecision(n)||4;if(o&&!t.willUpdate&&!(o[1]&&!o[1](a))&&!(s&&hasShapeAnimation(n))&&!(l<1)){c=n.type;var f=Math.pow(10,d);o[0](a,u,f)}else{var h=!n.path||n.shapeChanged();n.path||n.createPathProxy();var v=n.path;h&&(v.beginPath(),n.buildPath(v,n.shape),n.pathUpdated());var g=v.getVersion(),b=n,_=b.__svgPathBuilder;(b.__svgPathVersion!==g||!_||l!==b.__svgPathStrokePercent)&&(_||(_=b.__svgPathBuilder=new SVGPathRebuilder),_.reset(d),v.rebuildPath(_,l),_.generateStr(),b.__svgPathVersion=g,b.__svgPathStrokePercent=l),u.d=_.getStr()}return setTransform(u,n.transform),setStyleAttrs(u,r,n,t),setMetaData(u,n),t.animation&&createCSSAnimation(n,u,t),t.emphasis&&createCSSEmphasis(n,u,t),createVNode(c,n.id+"",u)}function brushSVGImage(n,t){var r=n.style,a=r.image;if(a&&!isString(a)&&(isImageLike(a)?a=a.src:isCanvasLike(a)&&(a=a.toDataURL())),!!a){var o=r.x||0,u=r.y||0,s=r.width,c=r.height,l={href:a,width:s,height:c};return o&&(l.x=o),u&&(l.y=u),setTransform(l,n.transform),setStyleAttrs(l,r,n,t),setMetaData(l,n),t.animation&&createCSSAnimation(n,l,t),createVNode("image",n.id+"",l)}}function brushSVGTSpan(n,t){var r=n.style,a=r.text;if(a!=null&&(a+=""),!(!a||isNaN(r.x)||isNaN(r.y))){var o=r.font||DEFAULT_FONT,u=r.x||0,s=adjustTextY$1(r.y||0,getLineHeight(o),r.textBaseline),c=TEXT_ALIGN_TO_ANCHOR[r.textAlign]||r.textAlign,l={"dominant-baseline":"central","text-anchor":c};if(hasSeparateFont(r)){var d="",f=r.fontStyle,h=parseFontSize(r.fontSize);if(!parseFloat(h))return;var v=r.fontFamily||DEFAULT_FONT_FAMILY,g=r.fontWeight;d+="font-size:"+h+";font-family:"+v+";",f&&f!=="normal"&&(d+="font-style:"+f+";"),g&&g!=="normal"&&(d+="font-weight:"+g+";"),l.style=d}else l.style="font: "+o;return a.match(/\s/)&&(l["xml:space"]="preserve"),u&&(l.x=u),s&&(l.y=s),setTransform(l,n.transform),setStyleAttrs(l,r,n,t),setMetaData(l,n),t.animation&&createCSSAnimation(n,l,t),createVNode("text",n.id+"",l,void 0,a)}}function brush(n,t){if(n instanceof Path)return brushSVGPath(n,t);if(n instanceof ZRImage)return brushSVGImage(n,t);if(n instanceof TSpan)return brushSVGTSpan(n,t)}function setShadow(n,t,r){var a=n.style;if(hasShadow(a)){var o=getShadowKey(n),u=r.shadowCache,s=u[o];if(!s){var c=n.getGlobalScale(),l=c[0],d=c[1];if(!l||!d)return;var f=a.shadowOffsetX||0,h=a.shadowOffsetY||0,v=a.shadowBlur,g=normalizeColor(a.shadowColor),b=g.opacity,_=g.color,S=v/2/l,T=v/2/d,w=S+" "+T;s=r.zrId+"-s"+r.shadowIdx++,r.defs[s]=createVNode("filter",s,{id:s,x:"-100%",y:"-100%",width:"300%",height:"300%"},[createVNode("feDropShadow","",{dx:f/l,dy:h/d,stdDeviation:w,"flood-color":_,"flood-opacity":b})]),u[o]=s}t.filter=getIdURL(s)}}function setGradient(n,t,r,a){var o=n[r],u,s={gradientUnits:o.global?"userSpaceOnUse":"objectBoundingBox"};if(isLinearGradient(o))u="linearGradient",s.x1=o.x,s.y1=o.y,s.x2=o.x2,s.y2=o.y2;else if(isRadialGradient(o))u="radialGradient",s.cx=retrieve2(o.x,.5),s.cy=retrieve2(o.y,.5),s.r=retrieve2(o.r,.5);else return;for(var c=o.colorStops,l=[],d=0,f=c.length;d<f;++d){var h=round4(c[d].offset)*100+"%",v=c[d].color,g=normalizeColor(v),b=g.color,_=g.opacity,S={offset:h};S["stop-color"]=b,_<1&&(S["stop-opacity"]=_),l.push(createVNode("stop",d+"",S))}var T=createVNode(u,"",s,l),w=vNodeToString(T),A=a.gradientCache,R=A[w];R||(R=a.zrId+"-g"+a.gradientIdx++,A[w]=R,s.id=R,a.defs[R]=createVNode(u,R,s,l)),t[r]=getIdURL(R)}function setPattern(n,t,r,a){var o=n.style[r],u=n.getBoundingRect(),s={},c=o.repeat,l=c==="no-repeat",d=c==="repeat-x",f=c==="repeat-y",h;if(isImagePattern(o)){var v=o.imageWidth,g=o.imageHeight,b=void 0,_=o.image;if(isString(_)?b=_:isImageLike(_)?b=_.src:isCanvasLike(_)&&(b=_.toDataURL()),typeof Image>"u"){var S="Image width/height must been given explictly in svg-ssr renderer.";assert(v,S),assert(g,S)}else if(v==null||g==null){var T=function($,O){if($){var P=$.elm,C=v||O.width,q=g||O.height;$.tag==="pattern"&&(d?(q=1,C/=u.width):f&&(C=1,q/=u.height)),$.attrs.width=C,$.attrs.height=q,P&&(P.setAttribute("width",C),P.setAttribute("height",q))}},w=createOrUpdateImage(b,null,n,function($){l||T(I,$),T(h,$)});w&&w.width&&w.height&&(v=v||w.width,g=g||w.height)}h=createVNode("image","img",{href:b,width:v,height:g}),s.width=v,s.height=g}else o.svgElement&&(h=clone$5(o.svgElement),s.width=o.svgWidth,s.height=o.svgHeight);if(h){var A,R;l?A=R=1:d?(R=1,A=s.width/u.width):f?(A=1,R=s.height/u.height):s.patternUnits="userSpaceOnUse",A!=null&&!isNaN(A)&&(s.width=A),R!=null&&!isNaN(R)&&(s.height=R);var E=getSRTTransformString(o);E&&(s.patternTransform=E);var I=createVNode("pattern","",s,[h]),L=vNodeToString(I),F=a.patternCache,D=F[L];D||(D=a.zrId+"-p"+a.patternIdx++,F[L]=D,s.id=D,I=a.defs[D]=createVNode("pattern",D,s,[h])),t[r]=getIdURL(D)}}function setClipPath(n,t,r){var a=r.clipPathCache,o=r.defs,u=a[n.id];if(!u){u=r.zrId+"-c"+r.clipPathIdx++;var s={id:u};a[n.id]=u,o[u]=createVNode("clipPath",u,s,[brushSVGPath(n,r)])}t["clip-path"]=getIdURL(u)}function createTextNode(n){return document.createTextNode(n)}function insertBefore(n,t,r){n.insertBefore(t,r)}function removeChild(n,t){n.removeChild(t)}function appendChild(n,t){n.appendChild(t)}function parentNode(n){return n.parentNode}function nextSibling(n){return n.nextSibling}function setTextContent(n,t){n.textContent=t}var colonChar=58,xChar=120,emptyNode=createVNode("","");function isUndef(n){return n===void 0}function isDef(n){return n!==void 0}function createKeyToOldIdx(n,t,r){for(var a={},o=t;o<=r;++o){var u=n[o].key;u!==void 0&&(a[u]=o)}return a}function sameVnode(n,t){var r=n.key===t.key,a=n.tag===t.tag;return a&&r}function createElm(n){var t,r=n.children,a=n.tag;if(isDef(a)){var o=n.elm=createElement(a);if(updateAttrs(emptyNode,n),isArray$2(r))for(t=0;t<r.length;++t){var u=r[t];u!=null&&appendChild(o,createElm(u))}else isDef(n.text)&&!isObject$4(n.text)&&appendChild(o,createTextNode(n.text))}else n.elm=createTextNode(n.text);return n.elm}function addVnodes(n,t,r,a,o){for(;a<=o;++a){var u=r[a];u!=null&&insertBefore(n,createElm(u),t)}}function removeVnodes(n,t,r,a){for(;r<=a;++r){var o=t[r];if(o!=null)if(isDef(o.tag)){var u=parentNode(o.elm);removeChild(u,o.elm)}else removeChild(n,o.elm)}}function updateAttrs(n,t){var r,a=t.elm,o=n&&n.attrs||{},u=t.attrs||{};if(o!==u){for(r in u){var s=u[r],c=o[r];c!==s&&(s===!0?a.setAttribute(r,""):s===!1?a.removeAttribute(r):r==="style"?a.style.cssText=s:r.charCodeAt(0)!==xChar?a.setAttribute(r,s):r==="xmlns:xlink"||r==="xmlns"?a.setAttributeNS(XMLNS,r,s):r.charCodeAt(3)===colonChar?a.setAttributeNS(XML_NAMESPACE,r,s):r.charCodeAt(5)===colonChar?a.setAttributeNS(XLINKNS,r,s):a.setAttribute(r,s))}for(r in o)r in u||a.removeAttribute(r)}}function updateChildren(n,t,r){for(var a=0,o=0,u=t.length-1,s=t[0],c=t[u],l=r.length-1,d=r[0],f=r[l],h,v,g,b;a<=u&&o<=l;)s==null?s=t[++a]:c==null?c=t[--u]:d==null?d=r[++o]:f==null?f=r[--l]:sameVnode(s,d)?(patchVnode(s,d),s=t[++a],d=r[++o]):sameVnode(c,f)?(patchVnode(c,f),c=t[--u],f=r[--l]):sameVnode(s,f)?(patchVnode(s,f),insertBefore(n,s.elm,nextSibling(c.elm)),s=t[++a],f=r[--l]):sameVnode(c,d)?(patchVnode(c,d),insertBefore(n,c.elm,s.elm),c=t[--u],d=r[++o]):(isUndef(h)&&(h=createKeyToOldIdx(t,a,u)),v=h[d.key],isUndef(v)?insertBefore(n,createElm(d),s.elm):(g=t[v],g.tag!==d.tag?insertBefore(n,createElm(d),s.elm):(patchVnode(g,d),t[v]=void 0,insertBefore(n,g.elm,s.elm))),d=r[++o]);(a<=u||o<=l)&&(a>u?(b=r[l+1]==null?null:r[l+1].elm,addVnodes(n,b,r,o,l)):removeVnodes(n,t,a,u))}function patchVnode(n,t){var r=t.elm=n.elm,a=n.children,o=t.children;n!==t&&(updateAttrs(n,t),isUndef(t.text)?isDef(a)&&isDef(o)?a!==o&&updateChildren(r,a,o):isDef(o)?(isDef(n.text)&&setTextContent(r,""),addVnodes(r,null,o,0,o.length-1)):isDef(a)?removeVnodes(r,a,0,a.length-1):isDef(n.text)&&setTextContent(r,""):n.text!==t.text&&(isDef(a)&&removeVnodes(r,a,0,a.length-1),setTextContent(r,t.text)))}function patch(n,t){if(sameVnode(n,t))patchVnode(n,t);else{var r=n.elm,a=parentNode(r);createElm(t),a!==null&&(insertBefore(a,t.elm,nextSibling(r)),removeVnodes(a,[n],0,0))}return t}var svgId=0,SVGPainter=function(){function n(t,r,a){if(this.type="svg",this.refreshHover=createMethodNotSupport(),this.configLayer=createMethodNotSupport(),this.storage=r,this._opts=a=extend$1({},a),this.root=t,this._id="zr"+svgId++,this._oldVNode=createSVGVNode(a.width,a.height),t&&!a.ssr){var o=this._viewport=document.createElement("div");o.style.cssText="position:relative;overflow:hidden";var u=this._svgDom=this._oldVNode.elm=createElement("svg");updateAttrs(null,this._oldVNode),o.appendChild(u),t.appendChild(o)}this.resize(a.width,a.height)}return n.prototype.getType=function(){return this.type},n.prototype.getViewportRoot=function(){return this._viewport},n.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},n.prototype.getSvgDom=function(){return this._svgDom},n.prototype.refresh=function(){if(this.root){var t=this.renderToVNode({willUpdate:!0});t.attrs.style="position:absolute;left:0;top:0;user-select:none",patch(this._oldVNode,t),this._oldVNode=t}},n.prototype.renderOneToVNode=function(t){return brush(t,createBrushScope(this._id))},n.prototype.renderToVNode=function(t){t=t||{};var r=this.storage.getDisplayList(!0),a=this._width,o=this._height,u=createBrushScope(this._id);u.animation=t.animation,u.willUpdate=t.willUpdate,u.compress=t.compress,u.emphasis=t.emphasis,u.ssr=this._opts.ssr;var s=[],c=this._bgVNode=createBackgroundVNode(a,o,this._backgroundColor,u);c&&s.push(c);var l=t.compress?null:this._mainVNode=createVNode("g","main",{},[]);this._paintList(r,u,l?l.children:s),l&&s.push(l);var d=map$1(keys(u.defs),function(v){return u.defs[v]});if(d.length&&s.push(createVNode("defs","defs",{},d)),t.animation){var f=getCssString(u.cssNodes,u.cssAnims,{newline:!0});if(f){var h=createVNode("style","stl",{},[],f);s.push(h)}}return createSVGVNode(a,o,s,t.useViewBox)},n.prototype.renderToString=function(t){return t=t||{},vNodeToString(this.renderToVNode({animation:retrieve2(t.cssAnimation,!0),emphasis:retrieve2(t.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:retrieve2(t.useViewBox,!0)}),{newline:!0})},n.prototype.setBackgroundColor=function(t){this._backgroundColor=t},n.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},n.prototype._paintList=function(t,r,a){for(var o=t.length,u=[],s=0,c,l,d=0,f=0;f<o;f++){var h=t[f];if(!h.invisible){var v=h.__clipPaths,g=v&&v.length||0,b=l&&l.length||0,_=void 0;for(_=Math.max(g-1,b-1);_>=0&&!(v&&l&&v[_]===l[_]);_--);for(var S=b-1;S>_;S--)s--,c=u[s-1];for(var T=_+1;T<g;T++){var w={};setClipPath(v[T],w,r);var A=createVNode("g","clip-g-"+d++,w,[]);(c?c.children:a).push(A),u[s++]=A,c=A}l=v;var R=brush(h,r);R&&(c?c.children:a).push(R)}}},n.prototype.resize=function(t,r){var a=this._opts,o=this.root,u=this._viewport;if(t!=null&&(a.width=t),r!=null&&(a.height=r),o&&u&&(u.style.display="none",t=getSize$1(o,0,a),r=getSize$1(o,1,a),u.style.display=""),this._width!==t||this._height!==r){if(this._width=t,this._height=r,u){var s=u.style;s.width=t+"px",s.height=r+"px"}if(isPattern(this._backgroundColor))this.refresh();else{var c=this._svgDom;c&&(c.setAttribute("width",t),c.setAttribute("height",r));var l=this._bgVNode&&this._bgVNode.elm;l&&(l.setAttribute("width",t),l.setAttribute("height",r))}}},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},n.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},n.prototype.toDataURL=function(t){var r=this.renderToString(),a="data:image/svg+xml;";return t?(r=encodeBase64(r),r&&a+"base64,"+r):a+"charset=UTF-8,"+encodeURIComponent(r)},n}();function createMethodNotSupport(n){return function(){}}function createBackgroundVNode(n,t,r,a){var o;if(r&&r!=="none")if(o=createVNode("rect","bg",{width:n,height:t,x:"0",y:"0"}),isGradient(r))setGradient({fill:r},o.attrs,"fill",a);else if(isPattern(r))setPattern({style:{fill:r},dirty:noop$3,getBoundingRect:function(){return{width:n,height:t}}},o.attrs,"fill",a);else{var u=normalizeColor(r),s=u.color,c=u.opacity;o.attrs.fill=s,c<1&&(o.attrs["fill-opacity"]=c)}return o}function install$S(n){n.registerPainter("svg",SVGPainter)}function createDom(n,t,r){var a=platformApi.createCanvas(),o=t.getWidth(),u=t.getHeight(),s=a.style;return s&&(s.position="absolute",s.left="0",s.top="0",s.width=o+"px",s.height=u+"px",a.setAttribute("data-zr-dom-id",n)),a.width=o*r,a.height=u*r,a}var Layer=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this)||this;u.motionBlur=!1,u.lastFrameAlpha=.7,u.dpr=1,u.virtual=!1,u.config={},u.incremental=!1,u.zlevel=0,u.maxRepaintRectCount=5,u.__dirty=!0,u.__firstTimePaint=!0,u.__used=!1,u.__drawIndex=0,u.__startIndex=0,u.__endIndex=0,u.__prevStartIndex=null,u.__prevEndIndex=null;var s;o=o||devicePixelRatio,typeof r=="string"?s=createDom(r,a,o):isObject$4(r)&&(s=r,r=s.id),u.id=r,u.dom=s;var c=s.style;return c&&(disableUserSelect(s),s.onselectstart=function(){return!1},c.padding="0",c.margin="0",c.borderWidth="0"),u.painter=a,u.dpr=o,u}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=createDom("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,a,o,u){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var s=[],c=this.maxRepaintRectCount,l=!1,d=new BoundingRect(0,0,0,0);function f(w){if(!(!w.isFinite()||w.isZero()))if(s.length===0){var A=new BoundingRect(0,0,0,0);A.copy(w),s.push(A)}else{for(var R=!1,E=1/0,I=0,L=0;L<s.length;++L){var F=s[L];if(F.intersect(w)){var D=new BoundingRect(0,0,0,0);D.copy(F),D.union(w),s[L]=D,R=!0;break}else if(l){d.copy(w),d.union(F);var $=w.width*w.height,O=F.width*F.height,P=d.width*d.height,C=P-$-O;C<E&&(E=C,I=L)}}if(l&&(s[I].union(w),R=!0),!R){var A=new BoundingRect(0,0,0,0);A.copy(w),s.push(A)}l||(l=s.length>=c)}}for(var h=this.__startIndex;h<this.__endIndex;++h){var v=r[h];if(v){var g=v.shouldBePainted(o,u,!0,!0),b=v.__isRendered&&(v.__dirty&REDRAW_BIT||!g)?v.getPrevPaintRect():null;b&&f(b);var _=g&&(v.__dirty&REDRAW_BIT||!v.__isRendered)?v.getPaintRect():null;_&&f(_)}}for(var h=this.__prevStartIndex;h<this.__prevEndIndex;++h){var v=a[h],g=v&&v.shouldBePainted(o,u,!0,!0);if(v&&(!g||!v.__zr)&&v.__isRendered){var b=v.getPrevPaintRect();b&&f(b)}}var S;do{S=!1;for(var h=0;h<s.length;){if(s[h].isZero()){s.splice(h,1);continue}for(var T=h+1;T<s.length;)s[h].intersect(s[T])?(S=!0,s[h].union(s[T]),s.splice(T,1)):T++;h++}}while(S);return this._paintRects=s,s},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,a){var o=this.dpr,u=this.dom,s=u.style,c=this.domBack;s&&(s.width=r+"px",s.height=a+"px"),u.width=r*o,u.height=a*o,c&&(c.width=r*o,c.height=a*o,o!==1&&this.ctxBack.scale(o,o))},t.prototype.clear=function(r,a,o){var u=this.dom,s=this.ctx,c=u.width,l=u.height;a=a||this.clearColor;var d=this.motionBlur&&!r,f=this.lastFrameAlpha,h=this.dpr,v=this;d&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(u,0,0,c/h,l/h));var g=this.domBack;function b(_,S,T,w){if(s.clearRect(_,S,T,w),a&&a!=="transparent"){var A=void 0;if(isGradientObject(a)){var R=a.global||a.__width===T&&a.__height===w;A=R&&a.__canvasGradient||getCanvasGradient(s,a,{x:0,y:0,width:T,height:w}),a.__canvasGradient=A,a.__width=T,a.__height=w}else isImagePatternObject(a)&&(a.scaleX=a.scaleX||h,a.scaleY=a.scaleY||h,A=createCanvasPattern(s,a,{dirty:function(){v.setUnpainted(),v.painter.refresh()}}));s.save(),s.fillStyle=A||a,s.fillRect(_,S,T,w),s.restore()}d&&(s.save(),s.globalAlpha=f,s.drawImage(g,_,S,T,w),s.restore())}!o||d?b(0,0,c,l):o.length&&each$f(o,function(_){b(_.x*h,_.y*h,_.width*h,_.height*h)})},t}(Eventful),HOVER_LAYER_ZLEVEL=1e5,CANVAS_ZLEVEL=314159,EL_AFTER_INCREMENTAL_INC=.01,INCREMENTAL_INC=.001;function isLayerValid(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function createRoot(n,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+n+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var CanvasPainter=function(){function n(t,r,a,o){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var u=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=a=extend$1({},a||{}),this.dpr=a.devicePixelRatio||devicePixelRatio,this._singleCanvas=u,this.root=t;var s=t.style;s&&(disableUserSelect(t),t.innerHTML=""),this.storage=r;var c=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(u){var f=t,h=f.width,v=f.height;a.width!=null&&(h=a.width),a.height!=null&&(v=a.height),this.dpr=a.devicePixelRatio||1,f.width=h*this.dpr,f.height=v*this.dpr,this._width=h,this._height=v;var g=new Layer(f,this,this.dpr);g.__builtin__=!0,g.initContext(),l[CANVAS_ZLEVEL]=g,g.zlevel=CANVAS_ZLEVEL,c.push(CANVAS_ZLEVEL),this._domRoot=t}else{this._width=getSize$1(t,0,a),this._height=getSize$1(t,1,a);var d=this._domRoot=createRoot(this._width,this._height);t.appendChild(d)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},n.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),a=this._prevDisplayList,o=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,a,t,this._redrawId);for(var u=0;u<o.length;u++){var s=o[u],c=this._layers[s];if(!c.__builtin__&&c.refresh){var l=u===0?this._backgroundColor:null;c.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(t){var r=t.length,a=this._hoverlayer;if(a&&a.clear(),!!r){for(var o={inHover:!0,viewWidth:this._width,viewHeight:this._height},u,s=0;s<r;s++){var c=t[s];c.__inHover&&(a||(a=this._hoverlayer=this.getLayer(HOVER_LAYER_ZLEVEL)),u||(u=a.ctx,u.save()),brush$1(u,c,o,s===r-1))}u&&u.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(HOVER_LAYER_ZLEVEL)},n.prototype.paintOne=function(t,r){brushSingle(t,r)},n.prototype._paintList=function(t,r,a,o){if(this._redrawId===o){a=a||!1,this._updateLayerStatus(t);var u=this._doPaintList(t,r,a),s=u.finished,c=u.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),c&&this._paintHoverList(t),s)this.eachLayer(function(d){d.afterBrush&&d.afterBrush()});else{var l=this;requestAnimationFrame$1(function(){l._paintList(t,r,a,o)})}}},n.prototype._compositeManually=function(){var t=this.getLayer(CANVAS_ZLEVEL).ctx,r=this._domRoot.width,a=this._domRoot.height;t.clearRect(0,0,r,a),this.eachBuiltinLayer(function(o){o.virtual&&t.drawImage(o.dom,0,0,r,a)})},n.prototype._doPaintList=function(t,r,a){for(var o=this,u=[],s=this._opts.useDirtyRect,c=0;c<this._zlevelList.length;c++){var l=this._zlevelList[c],d=this._layers[l];d.__builtin__&&d!==this._hoverlayer&&(d.__dirty||a)&&u.push(d)}for(var f=!0,h=!1,v=function(_){var S=u[_],T=S.ctx,w=s&&S.createRepaintRects(t,r,g._width,g._height),A=a?S.__startIndex:S.__drawIndex,R=!a&&S.incremental&&Date.now,E=R&&Date.now(),I=S.zlevel===g._zlevelList[0]?g._backgroundColor:null;if(S.__startIndex===S.__endIndex)S.clear(!1,I,w);else if(A===S.__startIndex){var L=t[A];(!L.incremental||!L.notClear||a)&&S.clear(!1,I,w)}A===-1&&(console.error("For some unknown reason. drawIndex is -1"),A=S.__startIndex);var F,D=function(C){var q={inHover:!1,allClipped:!1,prevEl:null,viewWidth:o._width,viewHeight:o._height};for(F=A;F<S.__endIndex;F++){var M=t[F];if(M.__inHover&&(h=!0),o._doPaintEl(M,S,s,C,q,F===S.__endIndex-1),R){var N=Date.now()-E;if(N>15)break}}q.prevElClipPaths&&T.restore()};if(w)if(w.length===0)F=S.__endIndex;else for(var $=g.dpr,O=0;O<w.length;++O){var P=w[O];T.save(),T.beginPath(),T.rect(P.x*$,P.y*$,P.width*$,P.height*$),T.clip(),D(P),T.restore()}else T.save(),D(),T.restore();S.__drawIndex=F,S.__drawIndex<S.__endIndex&&(f=!1)},g=this,b=0;b<u.length;b++)v(b);return env.wxa&&each$f(this._layers,function(_){_&&_.ctx&&_.ctx.draw&&_.ctx.draw()}),{finished:f,needsRefreshHover:h}},n.prototype._doPaintEl=function(t,r,a,o,u,s){var c=r.ctx;if(a){var l=t.getPaintRect();(!o||l&&l.intersect(o))&&(brush$1(c,t,u,s),t.setPrevPaintRect(l))}else brush$1(c,t,u,s)},n.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=CANVAS_ZLEVEL);var a=this._layers[t];return a||(a=new Layer("zr_"+t,this,this.dpr),a.zlevel=t,a.__builtin__=!0,this._layerConfig[t]?merge$3(a,this._layerConfig[t],!0):this._layerConfig[t-EL_AFTER_INCREMENTAL_INC]&&merge$3(a,this._layerConfig[t-EL_AFTER_INCREMENTAL_INC],!0),r&&(a.virtual=r),this.insertLayer(t,a),a.initContext()),a},n.prototype.insertLayer=function(t,r){var a=this._layers,o=this._zlevelList,u=o.length,s=this._domRoot,c=null,l=-1;if(!a[t]&&isLayerValid(r)){if(u>0&&t>o[0]){for(l=0;l<u-1&&!(o[l]<t&&o[l+1]>t);l++);c=a[o[l]]}if(o.splice(l+1,0,t),a[t]=r,!r.virtual)if(c){var d=c.dom;d.nextSibling?s.insertBefore(r.dom,d.nextSibling):s.appendChild(r.dom)}else s.firstChild?s.insertBefore(r.dom,s.firstChild):s.appendChild(r.dom);r.painter||(r.painter=this)}},n.prototype.eachLayer=function(t,r){for(var a=this._zlevelList,o=0;o<a.length;o++){var u=a[o];t.call(r,this._layers[u],u)}},n.prototype.eachBuiltinLayer=function(t,r){for(var a=this._zlevelList,o=0;o<a.length;o++){var u=a[o],s=this._layers[u];s.__builtin__&&t.call(r,s,u)}},n.prototype.eachOtherLayer=function(t,r){for(var a=this._zlevelList,o=0;o<a.length;o++){var u=a[o],s=this._layers[u];s.__builtin__||t.call(r,s,u)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(h,v){h.__dirty=h.__used=!1});function r(h){u&&(u.__endIndex!==h&&(u.__dirty=!0),u.__endIndex=h)}if(this._singleCanvas)for(var a=1;a<t.length;a++){var o=t[a];if(o.zlevel!==t[a-1].zlevel||o.incremental){this._needsManuallyCompositing=!0;break}}var u=null,s=0,c,l;for(l=0;l<t.length;l++){var o=t[l],d=o.zlevel,f=void 0;c!==d&&(c=d,s=0),o.incremental?(f=this.getLayer(d+INCREMENTAL_INC,this._needsManuallyCompositing),f.incremental=!0,s=1):f=this.getLayer(d+(s>0?EL_AFTER_INCREMENTAL_INC:0),this._needsManuallyCompositing),f.__builtin__||logError("ZLevel "+d+" has been used by unkown layer "+f.id),f!==u&&(f.__used=!0,f.__startIndex!==l&&(f.__dirty=!0),f.__startIndex=l,f.incremental?f.__drawIndex=-1:f.__drawIndex=l,r(l),u=f),o.__dirty&REDRAW_BIT&&!o.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(h,v){!h.__used&&h.getElementCount()>0&&(h.__dirty=!0,h.__startIndex=h.__endIndex=h.__drawIndex=0),h.__dirty&&h.__drawIndex<0&&(h.__drawIndex=h.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(t){t.clear()},n.prototype.setBackgroundColor=function(t){this._backgroundColor=t,each$f(this._layers,function(r){r.setUnpainted()})},n.prototype.configLayer=function(t,r){if(r){var a=this._layerConfig;a[t]?merge$3(a[t],r,!0):a[t]=r;for(var o=0;o<this._zlevelList.length;o++){var u=this._zlevelList[o];if(u===t||u===t+EL_AFTER_INCREMENTAL_INC){var s=this._layers[u];merge$3(s,a[t],!0)}}}},n.prototype.delLayer=function(t){var r=this._layers,a=this._zlevelList,o=r[t];o&&(o.dom.parentNode.removeChild(o.dom),delete r[t],a.splice(indexOf(a,t),1))},n.prototype.resize=function(t,r){if(this._domRoot.style){var a=this._domRoot;a.style.display="none";var o=this._opts,u=this.root;if(t!=null&&(o.width=t),r!=null&&(o.height=r),t=getSize$1(u,0,o),r=getSize$1(u,1,o),a.style.display="",this._width!==t||r!==this._height){a.style.width=t+"px",a.style.height=r+"px";for(var s in this._layers)this._layers.hasOwnProperty(s)&&this._layers[s].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(CANVAS_ZLEVEL).resize(t,r)}return this},n.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[CANVAS_ZLEVEL].dom;var r=new Layer("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var a=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var o=r.dom.width,u=r.dom.height;this.eachLayer(function(h){h.__builtin__?a.drawImage(h.dom,0,0,o,u):h.renderToCanvas&&(a.save(),h.renderToCanvas(a),a.restore())})}else for(var s={inHover:!1,viewWidth:this._width,viewHeight:this._height},c=this.storage.getDisplayList(!0),l=0,d=c.length;l<d;l++){var f=c[l];brush$1(a,f,s,l===d-1)}return r.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();function install$R(n){n.registerPainter("canvas",CanvasPainter)}var LineSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return createSeriesData(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var a=new Group$3,o=createSymbol$1("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);a.add(o),o.setStyle(r.lineStyle);var u=this.getData().getVisual("symbol"),s=this.getData().getVisual("symbolRotate"),c=u==="none"?"circle":u,l=r.itemHeight*.8,d=createSymbol$1(c,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);a.add(d),d.setStyle(r.itemStyle);var f=r.iconRotate==="inherit"?s:r.iconRotate||0;return d.rotation=f*Math.PI/180,d.setOrigin([r.itemWidth/2,r.itemHeight/2]),c.indexOf("empty")>-1&&(d.style.stroke=d.style.fill,d.style.fill="#fff",d.style.lineWidth=2),a},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(SeriesModel);function getDefaultLabel(n,t){var r=n.mapDimensionsAll("defaultedLabel"),a=r.length;if(a===1){var o=retrieveRawValue(n,t,r[0]);return o!=null?o+"":null}else if(a){for(var u=[],s=0;s<r.length;s++)u.push(retrieveRawValue(n,t,r[s]));return u.join(" ")}}function getDefaultInterpolatedLabel(n,t){var r=n.mapDimensionsAll("defaultedLabel");if(!isArray$2(t))return t+"";for(var a=[],o=0;o<r.length;o++){var u=n.getDimensionIndex(r[o]);u>=0&&a.push(t[u])}return a.join(" ")}var Symbol$2=function(n){__extends(t,n);function t(r,a,o,u){var s=n.call(this)||this;return s.updateData(r,a,o,u),s}return t.prototype._createSymbol=function(r,a,o,u,s){this.removeAll();var c=createSymbol$1(r,-1,-1,2,2,null,s);c.attr({z2:100,culling:!0,scaleX:u[0]/2,scaleY:u[1]/2}),c.drift=driftSymbol,this._symbolType=r,this.add(c)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){enterEmphasis(this.childAt(0))},t.prototype.downplay=function(){leaveEmphasis(this.childAt(0))},t.prototype.setZ=function(r,a){var o=this.childAt(0);o.zlevel=r,o.z=a},t.prototype.setDraggable=function(r,a){var o=this.childAt(0);o.draggable=r,o.cursor=!a&&r?"move":o.cursor},t.prototype.updateData=function(r,a,o,u){this.silent=!1;var s=r.getItemVisual(a,"symbol")||"circle",c=r.hostModel,l=t.getSymbolSize(r,a),d=s!==this._symbolType,f=u&&u.disableAnimation;if(d){var h=r.getItemVisual(a,"symbolKeepAspect");this._createSymbol(s,r,a,l,h)}else{var v=this.childAt(0);v.silent=!1;var g={scaleX:l[0]/2,scaleY:l[1]/2};f?v.attr(g):updateProps$1(v,g,c,a),saveOldStyle(v)}if(this._updateCommon(r,a,l,o,u),d){var v=this.childAt(0);if(!f){var g={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:v.style.opacity}};v.scaleX=v.scaleY=0,v.style.opacity=0,initProps(v,g,c,a)}}f&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,a,o,u,s){var c=this.childAt(0),l=r.hostModel,d,f,h,v,g,b,_,S,T;if(u&&(d=u.emphasisItemStyle,f=u.blurItemStyle,h=u.selectItemStyle,v=u.focus,g=u.blurScope,_=u.labelStatesModels,S=u.hoverScale,T=u.cursorStyle,b=u.emphasisDisabled),!u||r.hasItemOption){var w=u&&u.itemModel?u.itemModel:r.getItemModel(a),A=w.getModel("emphasis");d=A.getModel("itemStyle").getItemStyle(),h=w.getModel(["select","itemStyle"]).getItemStyle(),f=w.getModel(["blur","itemStyle"]).getItemStyle(),v=A.get("focus"),g=A.get("blurScope"),b=A.get("disabled"),_=getLabelStatesModels(w),S=A.getShallow("scale"),T=w.getShallow("cursor")}var R=r.getItemVisual(a,"symbolRotate");c.attr("rotation",(R||0)*Math.PI/180||0);var E=normalizeSymbolOffset(r.getItemVisual(a,"symbolOffset"),o);E&&(c.x=E[0],c.y=E[1]),T&&c.attr("cursor",T);var I=r.getItemVisual(a,"style"),L=I.fill;if(c instanceof ZRImage){var F=c.style;c.useStyle(extend$1({image:F.image,x:F.x,y:F.y,width:F.width,height:F.height},I))}else c.__isEmptyBrush?c.useStyle(extend$1({},I)):c.useStyle(I),c.style.decal=null,c.setColor(L,s&&s.symbolInnerColor),c.style.strokeNoScale=!0;var D=r.getItemVisual(a,"liftZ"),$=this._z2;D!=null?$==null&&(this._z2=c.z2,c.z2+=D):$!=null&&(c.z2=$,this._z2=null);var O=s&&s.useNameLabel;setLabelStyle(c,_,{labelFetcher:l,labelDataIndex:a,defaultText:P,inheritColor:L,defaultOpacity:I.opacity});function P(M){return O?r.getName(M):getDefaultLabel(r,M)}this._sizeX=o[0]/2,this._sizeY=o[1]/2;var C=c.ensureState("emphasis");C.style=d,c.ensureState("select").style=h,c.ensureState("blur").style=f;var q=S==null||S===!0?Math.max(1.1,3/this._sizeY):isFinite(S)&&S>0?+S:1;C.scaleX=this._sizeX*q,C.scaleY=this._sizeY*q,this.setSymbolScale(1),toggleHoverEmphasis(this,v,g,b)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,a,o){var u=this.childAt(0),s=getECData(this).dataIndex,c=o&&o.animation;if(this.silent=u.silent=!0,o&&o.fadeLabel){var l=u.getTextContent();l&&removeElement(l,{style:{opacity:0}},a,{dataIndex:s,removeOpt:c,cb:function(){u.removeTextContent()}})}else u.removeTextContent();removeElement(u,{style:{opacity:0},scaleX:0,scaleY:0},a,{dataIndex:s,cb:r,removeOpt:c})},t.getSymbolSize=function(r,a){return normalizeSymbolSize(r.getItemVisual(a,"symbolSize"))},t}(Group$3);function driftSymbol(n,t){this.parent.drift(n,t)}function symbolNeedsDraw$1(n,t,r,a){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(a.isIgnore&&a.isIgnore(r))&&!(a.clipShape&&!a.clipShape.contain(t[0],t[1]))&&n.getItemVisual(r,"symbol")!=="none"}function normalizeUpdateOpt(n){return n!=null&&!isObject$4(n)&&(n={isIgnore:n}),n||{}}function makeSeriesScope$2(n){var t=n.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:getLabelStatesModels(t),cursorStyle:t.get("cursor")}}var SymbolDraw=function(){function n(t){this.group=new Group$3,this._SymbolCtor=t||Symbol$2}return n.prototype.updateData=function(t,r){this._progressiveEls=null,r=normalizeUpdateOpt(r);var a=this.group,o=t.hostModel,u=this._data,s=this._SymbolCtor,c=r.disableAnimation,l=makeSeriesScope$2(t),d={disableAnimation:c},f=r.getSymbolPoint||function(h){return t.getItemLayout(h)};u||a.removeAll(),t.diff(u).add(function(h){var v=f(h);if(symbolNeedsDraw$1(t,v,h,r)){var g=new s(t,h,l,d);g.setPosition(v),t.setItemGraphicEl(h,g),a.add(g)}}).update(function(h,v){var g=u.getItemGraphicEl(v),b=f(h);if(!symbolNeedsDraw$1(t,b,h,r)){a.remove(g);return}var _=t.getItemVisual(h,"symbol")||"circle",S=g&&g.getSymbolType&&g.getSymbolType();if(!g||S&&S!==_)a.remove(g),g=new s(t,h,l,d),g.setPosition(b);else{g.updateData(t,h,l,d);var T={x:b[0],y:b[1]};c?g.attr(T):updateProps$1(g,T,o)}a.add(g),t.setItemGraphicEl(h,g)}).remove(function(h){var v=u.getItemGraphicEl(h);v&&v.fadeOut(function(){a.remove(v)},o)}).execute(),this._getSymbolPoint=f,this._data=t},n.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(a,o){var u=t._getSymbolPoint(o);a.setPosition(u),a.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=makeSeriesScope$2(t),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(t,r,a){this._progressiveEls=[],a=normalizeUpdateOpt(a);function o(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var u=t.start;u<t.end;u++){var s=r.getItemLayout(u);if(symbolNeedsDraw$1(r,s,u,a)){var c=new this._SymbolCtor(r,u,this._seriesScope);c.traverse(o),c.setPosition(s),this.group.add(c),r.setItemGraphicEl(u,c),this._progressiveEls.push(c)}}},n.prototype.eachRendered=function(t){traverseElements(this._progressiveEls||this.group,t)},n.prototype.remove=function(t){var r=this.group,a=this._data;a&&t?a.eachItemGraphicEl(function(o){o.fadeOut(function(){r.remove(o)},a.hostModel)}):r.removeAll()},n}();function prepareDataCoordInfo(n,t,r){var a=n.getBaseAxis(),o=n.getOtherAxis(a),u=getValueStart(o,r),s=a.dim,c=o.dim,l=t.mapDimension(c),d=t.mapDimension(s),f=c==="x"||c==="radius"?1:0,h=map$1(n.dimensions,function(b){return t.mapDimension(b)}),v=!1,g=t.getCalculationInfo("stackResultDimension");return isDimensionStacked(t,h[0])&&(v=!0,h[0]=g),isDimensionStacked(t,h[1])&&(v=!0,h[1]=g),{dataDimsForPoint:h,valueStart:u,valueAxisDim:c,baseAxisDim:s,stacked:!!v,valueDim:l,baseDim:d,baseDataOffset:f,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function getValueStart(n,t){var r=0,a=n.scale.getExtent();return t==="start"?r=a[0]:t==="end"?r=a[1]:isNumber(t)&&!isNaN(t)?r=t:a[0]>0?r=a[0]:a[1]<0&&(r=a[1]),r}function getStackedOnPoint(n,t,r,a){var o=NaN;n.stacked&&(o=r.get(r.getCalculationInfo("stackedOverDimension"),a)),isNaN(o)&&(o=n.valueStart);var u=n.baseDataOffset,s=[];return s[u]=r.get(n.baseDim,a),s[1-u]=o,t.dataToPoint(s)}function diffData(n,t){var r=[];return t.diff(n).add(function(a){r.push({cmd:"+",idx:a})}).update(function(a,o){r.push({cmd:"=",idx:o,idx1:a})}).remove(function(a){r.push({cmd:"-",idx:a})}).execute(),r}function lineAnimationDiff(n,t,r,a,o,u,s,c){for(var l=diffData(n,t),d=[],f=[],h=[],v=[],g=[],b=[],_=[],S=prepareDataCoordInfo(o,t,s),T=n.getLayout("points")||[],w=t.getLayout("points")||[],A=0;A<l.length;A++){var R=l[A],E=!0,I=void 0,L=void 0;switch(R.cmd){case"=":I=R.idx*2,L=R.idx1*2;var F=T[I],D=T[I+1],$=w[L],O=w[L+1];(isNaN(F)||isNaN(D))&&(F=$,D=O),d.push(F,D),f.push($,O),h.push(r[I],r[I+1]),v.push(a[L],a[L+1]),_.push(t.getRawIndex(R.idx1));break;case"+":var P=R.idx,C=S.dataDimsForPoint,q=o.dataToPoint([t.get(C[0],P),t.get(C[1],P)]);L=P*2,d.push(q[0],q[1]),f.push(w[L],w[L+1]);var M=getStackedOnPoint(S,o,t,P);h.push(M[0],M[1]),v.push(a[L],a[L+1]),_.push(t.getRawIndex(P));break;case"-":E=!1}E&&(g.push(R),b.push(b.length))}b.sort(function(ye,Te){return _[ye]-_[Te]});for(var N=d.length,G=createFloat32Array(N),X=createFloat32Array(N),Y=createFloat32Array(N),W=createFloat32Array(N),te=[],A=0;A<b.length;A++){var ue=b[A],fe=A*2,re=ue*2;G[fe]=d[re],G[fe+1]=d[re+1],X[fe]=f[re],X[fe+1]=f[re+1],Y[fe]=h[re],Y[fe+1]=h[re+1],W[fe]=v[re],W[fe+1]=v[re+1],te[A]=g[ue]}return{current:G,next:X,stackedOnCurrent:Y,stackedOnNext:W,status:te}}var mathMin$5=Math.min,mathMax$5=Math.max;function isPointNull$1(n,t){return isNaN(n)||isNaN(t)}function drawSegment(n,t,r,a,o,u,s,c,l){for(var d,f,h,v,g,b,_=r,S=0;S<a;S++){var T=t[_*2],w=t[_*2+1];if(_>=o||_<0)break;if(isPointNull$1(T,w)){if(l){_+=u;continue}break}if(_===r)n[u>0?"moveTo":"lineTo"](T,w),h=T,v=w;else{var A=T-d,R=w-f;if(A*A+R*R<.5){_+=u;continue}if(s>0){for(var E=_+u,I=t[E*2],L=t[E*2+1];I===T&&L===w&&S<a;)S++,E+=u,_+=u,I=t[E*2],L=t[E*2+1],T=t[_*2],w=t[_*2+1],A=T-d,R=w-f;var F=S+1;if(l)for(;isPointNull$1(I,L)&&F<a;)F++,E+=u,I=t[E*2],L=t[E*2+1];var D=.5,$=0,O=0,P=void 0,C=void 0;if(F>=a||isPointNull$1(I,L))g=T,b=w;else{$=I-d,O=L-f;var q=T-d,M=I-T,N=w-f,G=L-w,X=void 0,Y=void 0;if(c==="x"){X=Math.abs(q),Y=Math.abs(M);var W=$>0?1:-1;g=T-W*X*s,b=w,P=T+W*Y*s,C=w}else if(c==="y"){X=Math.abs(N),Y=Math.abs(G);var te=O>0?1:-1;g=T,b=w-te*X*s,P=T,C=w+te*Y*s}else X=Math.sqrt(q*q+N*N),Y=Math.sqrt(M*M+G*G),D=Y/(Y+X),g=T-$*s*(1-D),b=w-O*s*(1-D),P=T+$*s*D,C=w+O*s*D,P=mathMin$5(P,mathMax$5(I,T)),C=mathMin$5(C,mathMax$5(L,w)),P=mathMax$5(P,mathMin$5(I,T)),C=mathMax$5(C,mathMin$5(L,w)),$=P-T,O=C-w,g=T-$*X/Y,b=w-O*X/Y,g=mathMin$5(g,mathMax$5(d,T)),b=mathMin$5(b,mathMax$5(f,w)),g=mathMax$5(g,mathMin$5(d,T)),b=mathMax$5(b,mathMin$5(f,w)),$=T-g,O=w-b,P=T+$*Y/X,C=w+O*Y/X}n.bezierCurveTo(h,v,g,b,T,w),h=P,v=C}else n.lineTo(T,w)}d=T,f=w,_+=u}return S}var ECPolylineShape=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),ECPolyline=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="ec-polyline",a}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new ECPolylineShape},t.prototype.buildPath=function(r,a){var o=a.points,u=0,s=o.length/2;if(a.connectNulls){for(;s>0&&isPointNull$1(o[s*2-2],o[s*2-1]);s--);for(;u<s&&isPointNull$1(o[u*2],o[u*2+1]);u++);}for(;u<s;)u+=drawSegment(r,o,u,s,s,1,a.smooth,a.smoothMonotone,a.connectNulls)+1},t.prototype.getPointOn=function(r,a){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var o=this.path,u=o.data,s=PathProxy.CMD,c,l,d=a==="x",f=[],h=0;h<u.length;){var v=u[h++],g=void 0,b=void 0,_=void 0,S=void 0,T=void 0,w=void 0,A=void 0;switch(v){case s.M:c=u[h++],l=u[h++];break;case s.L:if(g=u[h++],b=u[h++],A=d?(r-c)/(g-c):(r-l)/(b-l),A<=1&&A>=0){var R=d?(b-l)*A+l:(g-c)*A+c;return d?[r,R]:[R,r]}c=g,l=b;break;case s.C:g=u[h++],b=u[h++],_=u[h++],S=u[h++],T=u[h++],w=u[h++];var E=d?cubicRootAt(c,g,_,T,r,f):cubicRootAt(l,b,S,w,r,f);if(E>0)for(var I=0;I<E;I++){var L=f[I];if(L<=1&&L>=0){var R=d?cubicAt(l,b,S,w,L):cubicAt(c,g,_,T,L);return d?[r,R]:[R,r]}}c=T,l=w;break}}},t}(Path),ECPolygonShape=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(ECPolylineShape),ECPolygon=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="ec-polygon",a}return t.prototype.getDefaultShape=function(){return new ECPolygonShape},t.prototype.buildPath=function(r,a){var o=a.points,u=a.stackedOnPoints,s=0,c=o.length/2,l=a.smoothMonotone;if(a.connectNulls){for(;c>0&&isPointNull$1(o[c*2-2],o[c*2-1]);c--);for(;s<c&&isPointNull$1(o[s*2],o[s*2+1]);s++);}for(;s<c;){var d=drawSegment(r,o,s,c,c,1,a.smooth,l,a.connectNulls);drawSegment(r,u,s+d-1,d,c,-1,a.stackedOnSmooth,l,a.connectNulls),s+=d+1,r.closePath()}},t}(Path);function createGridClipPath(n,t,r,a,o){var u=n.getArea(),s=u.x,c=u.y,l=u.width,d=u.height,f=r.get(["lineStyle","width"])||0;s-=f/2,c-=f/2,l+=f,d+=f,l=Math.ceil(l),s!==Math.floor(s)&&(s=Math.floor(s),l++);var h=new Rect$2({shape:{x:s,y:c,width:l,height:d}});if(t){var v=n.getBaseAxis(),g=v.isHorizontal(),b=v.inverse;g?(b&&(h.shape.x+=l),h.shape.width=0):(b||(h.shape.y+=d),h.shape.height=0);var _=isFunction$1(o)?function(S){o(S,h)}:null;initProps(h,{shape:{width:l,height:d,x:s,y:c}},r,null,a,_)}return h}function createPolarClipPath(n,t,r){var a=n.getArea(),o=round$3(a.r0,1),u=round$3(a.r,1),s=new Sector({shape:{cx:round$3(n.cx,1),cy:round$3(n.cy,1),r0:o,r:u,startAngle:a.startAngle,endAngle:a.endAngle,clockwise:a.clockwise}});if(t){var c=n.getBaseAxis().dim==="angle";c?s.shape.endAngle=a.startAngle:s.shape.r=o,initProps(s,{shape:{endAngle:a.endAngle,r:u}},r)}return s}function createClipPath(n,t,r,a,o){if(n){if(n.type==="polar")return createPolarClipPath(n,t,r);if(n.type==="cartesian2d")return createGridClipPath(n,t,r,a,o)}else return null;return null}function isCoordinateSystemType(n,t){return n.type===t}function isPointsSame(n,t){if(n.length===t.length){for(var r=0;r<n.length;r++)if(n[r]!==t[r])return;return!0}}function bboxFromPoints(n){for(var t=1/0,r=1/0,a=-1/0,o=-1/0,u=0;u<n.length;){var s=n[u++],c=n[u++];isNaN(s)||(t=Math.min(s,t),a=Math.max(s,a)),isNaN(c)||(r=Math.min(c,r),o=Math.max(c,o))}return[[t,r],[a,o]]}function getBoundingDiff(n,t){var r=bboxFromPoints(n),a=r[0],o=r[1],u=bboxFromPoints(t),s=u[0],c=u[1];return Math.max(Math.abs(a[0]-s[0]),Math.abs(a[1]-s[1]),Math.abs(o[0]-c[0]),Math.abs(o[1]-c[1]))}function getSmooth(n){return isNumber(n)?n:n?.5:0}function getStackedOnPoints(n,t,r){if(!r.valueDim)return[];for(var a=t.count(),o=createFloat32Array(a*2),u=0;u<a;u++){var s=getStackedOnPoint(r,n,t,u);o[u*2]=s[0],o[u*2+1]=s[1]}return o}function turnPointsIntoStep(n,t,r,a,o){var u=r.getBaseAxis(),s=u.dim==="x"||u.dim==="radius"?0:1,c=[],l=0,d=[],f=[],h=[],v=[];if(o){for(l=0;l<n.length;l+=2){var g=t||n;!isNaN(g[l])&&!isNaN(g[l+1])&&v.push(n[l],n[l+1])}n=v}for(l=0;l<n.length-2;l+=2)switch(h[0]=n[l+2],h[1]=n[l+3],f[0]=n[l],f[1]=n[l+1],c.push(f[0],f[1]),a){case"end":d[s]=h[s],d[1-s]=f[1-s],c.push(d[0],d[1]);break;case"middle":var b=(f[s]+h[s])/2,_=[];d[s]=_[s]=b,d[1-s]=f[1-s],_[1-s]=h[1-s],c.push(d[0],d[1]),c.push(_[0],_[1]);break;default:d[s]=f[s],d[1-s]=h[1-s],c.push(d[0],d[1])}return c.push(n[l++],n[l++]),c}function clipColorStops(n,t){var r=[],a=n.length,o,u;function s(f,h,v){var g=f.coord,b=(v-g)/(h.coord-g),_=lerp(b,[f.color,h.color]);return{coord:v,color:_}}for(var c=0;c<a;c++){var l=n[c],d=l.coord;if(d<0)o=l;else if(d>t){u?r.push(s(u,l,t)):o&&r.push(s(o,l,0),s(o,l,t));break}else o&&(r.push(s(o,l,0)),o=null),r.push(l),u=l}return r}function getVisualGradient(n,t,r){var a=n.getVisual("visualMeta");if(!(!a||!a.length||!n.count())&&t.type==="cartesian2d"){for(var o,u,s=a.length-1;s>=0;s--){var c=n.getDimensionInfo(a[s].dimension);if(o=c&&c.coordDim,o==="x"||o==="y"){u=a[s];break}}if(u){var l=t.getAxis(o),d=map$1(u.stops,function(A){return{coord:l.toGlobalCoord(l.dataToCoord(A.value)),color:A.color}}),f=d.length,h=u.outerColors.slice();f&&d[0].coord>d[f-1].coord&&(d.reverse(),h.reverse());var v=clipColorStops(d,o==="x"?r.getWidth():r.getHeight()),g=v.length;if(!g&&f)return d[0].coord<0?h[1]?h[1]:d[f-1].color:h[0]?h[0]:d[0].color;var b=10,_=v[0].coord-b,S=v[g-1].coord+b,T=S-_;if(T<.001)return"transparent";each$f(v,function(A){A.offset=(A.coord-_)/T}),v.push({offset:g?v[g-1].offset:.5,color:h[1]||"transparent"}),v.unshift({offset:g?v[0].offset:.5,color:h[0]||"transparent"});var w=new LinearGradient(0,0,0,0,v,!0);return w[o]=_,w[o+"2"]=S,w}}}function getIsIgnoreFunc(n,t,r){var a=n.get("showAllSymbol"),o=a==="auto";if(!(a&&!o)){var u=r.getAxesByScale("ordinal")[0];if(u&&!(o&&canShowAllSymbolForCategory(u,t))){var s=t.mapDimension(u.dim),c={};return each$f(u.getViewLabels(),function(l){var d=u.scale.getRawOrdinalNumber(l.tickValue);c[d]=1}),function(l){return!c.hasOwnProperty(t.get(s,l))}}}}function canShowAllSymbolForCategory(n,t){var r=n.getExtent(),a=Math.abs(r[1]-r[0])/n.scale.count();isNaN(a)&&(a=0);for(var o=t.count(),u=Math.max(1,Math.round(o/5)),s=0;s<o;s+=u)if(Symbol$2.getSymbolSize(t,s)[n.isHorizontal()?1:0]*1.5>a)return!1;return!0}function isPointNull(n,t){return isNaN(n)||isNaN(t)}function getLastIndexNotNull(n){for(var t=n.length/2;t>0&&isPointNull(n[t*2-2],n[t*2-1]);t--);return t-1}function getPointAtIndex(n,t){return[n[t*2],n[t*2+1]]}function getIndexRange(n,t,r){for(var a=n.length/2,o=r==="x"?0:1,u,s,c=0,l=-1,d=0;d<a;d++)if(s=n[d*2+o],!(isNaN(s)||isNaN(n[d*2+1-o]))){if(d===0){u=s;continue}if(u<=t&&s>=t||u>=t&&s<=t){l=d;break}c=d,u=s}return{range:[c,l],t:(t-u)/(s-u)}}function anyStateShowEndLabel(n){if(n.get(["endLabel","show"]))return!0;for(var t=0;t<SPECIAL_STATES.length;t++)if(n.get([SPECIAL_STATES[t],"endLabel","show"]))return!0;return!1}function createLineClipPath(n,t,r,a){if(isCoordinateSystemType(t,"cartesian2d")){var o=a.getModel("endLabel"),u=o.get("valueAnimation"),s=a.getData(),c={lastFrameIndex:0},l=anyStateShowEndLabel(a)?function(g,b){n._endLabelOnDuring(g,b,s,c,u,o,t)}:null,d=t.getBaseAxis().isHorizontal(),f=createGridClipPath(t,r,a,function(){var g=n._endLabel;g&&r&&c.originalX!=null&&g.attr({x:c.originalX,y:c.originalY})},l);if(!a.get("clip",!0)){var h=f.shape,v=Math.max(h.width,h.height);d?(h.y-=v,h.height+=v*2):(h.x-=v,h.width+=v*2)}return l&&l(1,f),f}else return createPolarClipPath(t,r,a)}function getEndLabelStateSpecified(n,t){var r=t.getBaseAxis(),a=r.isHorizontal(),o=r.inverse,u=a?o?"right":"left":"center",s=a?"middle":o?"top":"bottom";return{normal:{align:n.get("align")||u,verticalAlign:n.get("verticalAlign")||s}}}var LineView=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(){var r=new Group$3,a=new SymbolDraw;this.group.add(a.group),this._symbolDraw=a,this._lineGroup=r,this._changePolyState=bind$1(this._changePolyState,this)},t.prototype.render=function(r,a,o){var u=r.coordinateSystem,s=this.group,c=r.getData(),l=r.getModel("lineStyle"),d=r.getModel("areaStyle"),f=c.getLayout("points")||[],h=u.type==="polar",v=this._coordSys,g=this._symbolDraw,b=this._polyline,_=this._polygon,S=this._lineGroup,T=!a.ssr&&r.get("animation"),w=!d.isEmpty(),A=d.get("origin"),R=prepareDataCoordInfo(u,c,A),E=w&&getStackedOnPoints(u,c,R),I=r.get("showSymbol"),L=r.get("connectNulls"),F=I&&!h&&getIsIgnoreFunc(r,c,u),D=this._data;D&&D.eachItemGraphicEl(function(ye,Te){ye.__temp&&(s.remove(ye),D.setItemGraphicEl(Te,null))}),I||g.remove(),s.add(S);var $=h?!1:r.get("step"),O;u&&u.getArea&&r.get("clip",!0)&&(O=u.getArea(),O.width!=null?(O.x-=.1,O.y-=.1,O.width+=.2,O.height+=.2):O.r0&&(O.r0-=.5,O.r+=.5)),this._clipShapeForSymbol=O;var P=getVisualGradient(c,u,o)||c.getVisual("style")[c.getVisual("drawType")];if(!(b&&v.type===u.type&&$===this._step))I&&g.updateData(c,{isIgnore:F,clipShape:O,disableAnimation:!0,getSymbolPoint:function(ye){return[f[ye*2],f[ye*2+1]]}}),T&&this._initSymbolLabelAnimation(c,u,O),$&&(E&&(E=turnPointsIntoStep(E,f,u,$,L)),f=turnPointsIntoStep(f,null,u,$,L)),b=this._newPolyline(f),w?_=this._newPolygon(f,E):_&&(S.remove(_),_=this._polygon=null),h||this._initOrUpdateEndLabel(r,u,convertToColorString(P)),S.setClipPath(createLineClipPath(this,u,!0,r));else{w&&!_?_=this._newPolygon(f,E):_&&!w&&(S.remove(_),_=this._polygon=null),h||this._initOrUpdateEndLabel(r,u,convertToColorString(P));var C=S.getClipPath();if(C){var q=createLineClipPath(this,u,!1,r);initProps(C,{shape:q.shape},r)}else S.setClipPath(createLineClipPath(this,u,!0,r));I&&g.updateData(c,{isIgnore:F,clipShape:O,disableAnimation:!0,getSymbolPoint:function(ye){return[f[ye*2],f[ye*2+1]]}}),(!isPointsSame(this._stackedOnPoints,E)||!isPointsSame(this._points,f))&&(T?this._doUpdateAnimation(c,E,u,o,$,A,L):($&&(E&&(E=turnPointsIntoStep(E,f,u,$,L)),f=turnPointsIntoStep(f,null,u,$,L)),b.setShape({points:f}),_&&_.setShape({points:f,stackedOnPoints:E})))}var M=r.getModel("emphasis"),N=M.get("focus"),G=M.get("blurScope"),X=M.get("disabled");if(b.useStyle(defaults$h(l.getLineStyle(),{fill:"none",stroke:P,lineJoin:"bevel"})),setStatesStylesFromModel(b,r,"lineStyle"),b.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var Y=b.getState("emphasis").style;Y.lineWidth=+b.style.lineWidth+1}getECData(b).seriesIndex=r.seriesIndex,toggleHoverEmphasis(b,N,G,X);var W=getSmooth(r.get("smooth")),te=r.get("smoothMonotone");if(b.setShape({smooth:W,smoothMonotone:te,connectNulls:L}),_){var ue=c.getCalculationInfo("stackedOnSeries"),fe=0;_.useStyle(defaults$h(d.getAreaStyle(),{fill:P,opacity:.7,lineJoin:"bevel",decal:c.getVisual("style").decal})),ue&&(fe=getSmooth(ue.get("smooth"))),_.setShape({smooth:W,stackedOnSmooth:fe,smoothMonotone:te,connectNulls:L}),setStatesStylesFromModel(_,r,"areaStyle"),getECData(_).seriesIndex=r.seriesIndex,toggleHoverEmphasis(_,N,G,X)}var re=this._changePolyState;c.eachItemGraphicEl(function(ye){ye&&(ye.onHoverStateChange=re)}),this._polyline.onHoverStateChange=re,this._data=c,this._coordSys=u,this._stackedOnPoints=E,this._points=f,this._step=$,this._valueOrigin=A,r.get("triggerLineEvent")&&(this.packEventData(r,b),_&&this.packEventData(r,_))},t.prototype.packEventData=function(r,a){getECData(a).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,a,o,u){var s=r.getData(),c=queryDataIndex(s,u);if(this._changePolyState("emphasis"),!(c instanceof Array)&&c!=null&&c>=0){var l=s.getLayout("points"),d=s.getItemGraphicEl(c);if(!d){var f=l[c*2],h=l[c*2+1];if(isNaN(f)||isNaN(h)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,h))return;var v=r.get("zlevel")||0,g=r.get("z")||0;d=new Symbol$2(s,c),d.x=f,d.y=h,d.setZ(v,g);var b=d.getSymbolPath().getTextContent();b&&(b.zlevel=v,b.z=g,b.z2=this._polyline.z2+1),d.__temp=!0,s.setItemGraphicEl(c,d),d.stopSymbolAnimation(!0),this.group.add(d)}d.highlight()}else ChartView.prototype.highlight.call(this,r,a,o,u)},t.prototype.downplay=function(r,a,o,u){var s=r.getData(),c=queryDataIndex(s,u);if(this._changePolyState("normal"),c!=null&&c>=0){var l=s.getItemGraphicEl(c);l&&(l.__temp?(s.setItemGraphicEl(c,null),this.group.remove(l)):l.downplay())}else ChartView.prototype.downplay.call(this,r,a,o,u)},t.prototype._changePolyState=function(r){var a=this._polygon;setStatesFlag(this._polyline,r),a&&setStatesFlag(a,r)},t.prototype._newPolyline=function(r){var a=this._polyline;return a&&this._lineGroup.remove(a),a=new ECPolyline({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(a),this._polyline=a,a},t.prototype._newPolygon=function(r,a){var o=this._polygon;return o&&this._lineGroup.remove(o),o=new ECPolygon({shape:{points:r,stackedOnPoints:a},segmentIgnoreThreshold:2}),this._lineGroup.add(o),this._polygon=o,o},t.prototype._initSymbolLabelAnimation=function(r,a,o){var u,s,c=a.getBaseAxis(),l=c.inverse;a.type==="cartesian2d"?(u=c.isHorizontal(),s=!1):a.type==="polar"&&(u=c.dim==="angle",s=!0);var d=r.hostModel,f=d.get("animationDuration");isFunction$1(f)&&(f=f(null));var h=d.get("animationDelay")||0,v=isFunction$1(h)?h(null):h;r.eachItemGraphicEl(function(g,b){var _=g;if(_){var S=[g.x,g.y],T=void 0,w=void 0,A=void 0;if(o)if(s){var R=o,E=a.pointToCoord(S);u?(T=R.startAngle,w=R.endAngle,A=-E[1]/180*Math.PI):(T=R.r0,w=R.r,A=E[0])}else{var I=o;u?(T=I.x,w=I.x+I.width,A=g.x):(T=I.y+I.height,w=I.y,A=g.y)}var L=w===T?0:(A-T)/(w-T);l&&(L=1-L);var F=isFunction$1(h)?h(b):f*L+v,D=_.getSymbolPath(),$=D.getTextContent();_.attr({scaleX:0,scaleY:0}),_.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:F}),$&&$.animateFrom({style:{opacity:0}},{duration:300,delay:F}),D.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,a,o){var u=r.getModel("endLabel");if(anyStateShowEndLabel(r)){var s=r.getData(),c=this._polyline,l=s.getLayout("points");if(!l){c.removeTextContent(),this._endLabel=null;return}var d=this._endLabel;d||(d=this._endLabel=new ZRText({z2:200}),d.ignoreClip=!0,c.setTextContent(this._endLabel),c.disableLabelAnimation=!0);var f=getLastIndexNotNull(l);f>=0&&(setLabelStyle(c,getLabelStatesModels(r,"endLabel"),{inheritColor:o,labelFetcher:r,labelDataIndex:f,defaultText:function(h,v,g){return g!=null?getDefaultInterpolatedLabel(s,g):getDefaultLabel(s,h)},enableTextSetter:!0},getEndLabelStateSpecified(u,a)),c.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,a,o,u,s,c,l){var d=this._endLabel,f=this._polyline;if(d){r<1&&u.originalX==null&&(u.originalX=d.x,u.originalY=d.y);var h=o.getLayout("points"),v=o.hostModel,g=v.get("connectNulls"),b=c.get("precision"),_=c.get("distance")||0,S=l.getBaseAxis(),T=S.isHorizontal(),w=S.inverse,A=a.shape,R=w?T?A.x:A.y+A.height:T?A.x+A.width:A.y,E=(T?_:0)*(w?-1:1),I=(T?0:-_)*(w?-1:1),L=T?"x":"y",F=getIndexRange(h,R,L),D=F.range,$=D[1]-D[0],O=void 0;if($>=1){if($>1&&!g){var P=getPointAtIndex(h,D[0]);d.attr({x:P[0]+E,y:P[1]+I}),s&&(O=v.getRawValue(D[0]))}else{var P=f.getPointOn(R,L);P&&d.attr({x:P[0]+E,y:P[1]+I});var C=v.getRawValue(D[0]),q=v.getRawValue(D[1]);s&&(O=interpolateRawValues(o,b,C,q,F.t))}u.lastFrameIndex=D[0]}else{var M=r===1||u.lastFrameIndex>0?D[0]:0,P=getPointAtIndex(h,M);s&&(O=v.getRawValue(M)),d.attr({x:P[0]+E,y:P[1]+I})}if(s){var N=labelInner(d);typeof N.setLabelText=="function"&&N.setLabelText(O)}}},t.prototype._doUpdateAnimation=function(r,a,o,u,s,c,l){var d=this._polyline,f=this._polygon,h=r.hostModel,v=lineAnimationDiff(this._data,r,this._stackedOnPoints,a,this._coordSys,o,this._valueOrigin),g=v.current,b=v.stackedOnCurrent,_=v.next,S=v.stackedOnNext;if(s&&(b=turnPointsIntoStep(v.stackedOnCurrent,v.current,o,s,l),g=turnPointsIntoStep(v.current,null,o,s,l),S=turnPointsIntoStep(v.stackedOnNext,v.next,o,s,l),_=turnPointsIntoStep(v.next,null,o,s,l)),getBoundingDiff(g,_)>3e3||f&&getBoundingDiff(b,S)>3e3){d.stopAnimation(),d.setShape({points:_}),f&&(f.stopAnimation(),f.setShape({points:_,stackedOnPoints:S}));return}d.shape.__points=v.current,d.shape.points=g;var T={shape:{points:_}};v.current!==g&&(T.shape.__points=v.next),d.stopAnimation(),updateProps$1(d,T,h),f&&(f.setShape({points:g,stackedOnPoints:b}),f.stopAnimation(),updateProps$1(f,{shape:{stackedOnPoints:S}},h),d.shape.points!==f.shape.points&&(f.shape.points=d.shape.points));for(var w=[],A=v.status,R=0;R<A.length;R++){var E=A[R].cmd;if(E==="="){var I=r.getItemGraphicEl(A[R].idx1);I&&w.push({el:I,ptIdx:R})}}d.animators&&d.animators.length&&d.animators[0].during(function(){f&&f.dirtyShape();for(var L=d.shape.__points,F=0;F<w.length;F++){var D=w[F].el,$=w[F].ptIdx*2;D.x=L[$],D.y=L[$+1],D.markRedraw()}})},t.prototype.remove=function(r){var a=this.group,o=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),o&&o.eachItemGraphicEl(function(u,s){u.__temp&&(a.remove(u),o.setItemGraphicEl(s,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(ChartView);function pointsLayout(n,t){return{seriesType:n,plan:createRenderPlanner(),reset:function(r){var a=r.getData(),o=r.coordinateSystem,u=r.pipelineContext,s=t||u.large;if(o){var c=map$1(o.dimensions,function(g){return a.mapDimension(g)}).slice(0,2),l=c.length,d=a.getCalculationInfo("stackResultDimension");isDimensionStacked(a,c[0])&&(c[0]=d),isDimensionStacked(a,c[1])&&(c[1]=d);var f=a.getStore(),h=a.getDimensionIndex(c[0]),v=a.getDimensionIndex(c[1]);return l&&{progress:function(g,b){for(var _=g.end-g.start,S=s&&createFloat32Array(_*l),T=[],w=[],A=g.start,R=0;A<g.end;A++){var E=void 0;if(l===1){var I=f.get(h,A);E=o.dataToPoint(I,null,w)}else T[0]=f.get(h,A),T[1]=f.get(v,A),E=o.dataToPoint(T,null,w);s?(S[R++]=E[0],S[R++]=E[1]):b.setItemLayout(A,E.slice())}s&&b.setLayout("points",S)}}}}}}var samplers={average:function(n){for(var t=0,r=0,a=0;a<n.length;a++)isNaN(n[a])||(t+=n[a],r++);return r===0?NaN:t/r},sum:function(n){for(var t=0,r=0;r<n.length;r++)t+=n[r]||0;return t},max:function(n){for(var t=-1/0,r=0;r<n.length;r++)n[r]>t&&(t=n[r]);return isFinite(t)?t:NaN},min:function(n){for(var t=1/0,r=0;r<n.length;r++)n[r]<t&&(t=n[r]);return isFinite(t)?t:NaN},nearest:function(n){return n[0]}},indexSampler=function(n){return Math.round(n.length/2)};function dataSample(n){return{seriesType:n,reset:function(t,r,a){var o=t.getData(),u=t.get("sampling"),s=t.coordinateSystem,c=o.count();if(c>10&&s.type==="cartesian2d"&&u){var l=s.getBaseAxis(),d=s.getOtherAxis(l),f=l.getExtent(),h=a.getDevicePixelRatio(),v=Math.abs(f[1]-f[0])*(h||1),g=Math.round(c/v);if(isFinite(g)&&g>1){u==="lttb"?t.setData(o.lttbDownSample(o.mapDimension(d.dim),1/g)):u==="minmax"&&t.setData(o.minmaxDownSample(o.mapDimension(d.dim),1/g));var b=void 0;isString(u)?b=samplers[u]:isFunction$1(u)&&(b=u),b&&t.setData(o.downSample(o.mapDimension(d.dim),1/g,b,indexSampler))}}}}}function install$Q(n){n.registerChartView(LineView),n.registerSeriesModel(LineSeriesModel),n.registerLayout(pointsLayout("line",!0)),n.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),a=t.getModel("lineStyle").getLineStyle();a&&!a.stroke&&(a.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",a)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,dataSample("line"))}var BaseBarSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,a){return createSeriesData(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,a,o){var u=this.coordinateSystem;if(u&&u.clampData){var s=u.clampData(r),c=u.dataToPoint(s);if(o)each$f(u.getAxes(),function(v,g){if(v.type==="category"&&a!=null){var b=v.getTicksCoords(),_=v.getTickModel().get("alignWithLabel"),S=s[g],T=a[g]==="x1"||a[g]==="y1";if(T&&!_&&(S+=1),b.length<2)return;if(b.length===2){c[g]=v.toGlobalCoord(v.getExtent()[T?1:0]);return}for(var w=void 0,A=void 0,R=1,E=0;E<b.length;E++){var I=b[E].coord,L=E===b.length-1?b[E-1].tickValue+R:b[E].tickValue;if(L===S){A=I;break}else if(L<S)w=I;else if(w!=null&&L>S){A=(I+w)/2;break}E===1&&(R=L-b[0].tickValue)}A==null&&(w?w&&(A=b[b.length-1].coord):A=b[0].coord),c[g]=v.toGlobalCoord(A)}});else{var l=this.getData(),d=l.getLayout("offset"),f=l.getLayout("size"),h=u.getBaseAxis().isHorizontal()?0:1;c[h]+=d+f/2}return c}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(SeriesModel);SeriesModel.registerClass(BaseBarSeriesModel);var BarSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return createSeriesData(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),a=this.get("largeThreshold");return a>r&&(r=a),r},t.prototype.brushSelector=function(r,a,o){return o.rect(a.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(BaseBarSeriesModel),SausageShape=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),SausagePath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="sausage",a}return t.prototype.getDefaultShape=function(){return new SausageShape},t.prototype.buildPath=function(r,a){var o=a.cx,u=a.cy,s=Math.max(a.r0||0,0),c=Math.max(a.r,0),l=(c-s)*.5,d=s+l,f=a.startAngle,h=a.endAngle,v=a.clockwise,g=Math.PI*2,b=v?h-f<g:f-h<g;b||(f=h-(v?g:-g));var _=Math.cos(f),S=Math.sin(f),T=Math.cos(h),w=Math.sin(h);b?(r.moveTo(_*s+o,S*s+u),r.arc(_*d+o,S*d+u,l,-Math.PI+f,f,!v)):r.moveTo(_*c+o,S*c+u),r.arc(o,u,c,f,h,!v),r.arc(T*d+o,w*d+u,l,h-Math.PI*2,h-Math.PI,!v),s!==0&&r.arc(o,u,s,h,f,v)},t}(Path);function createSectorCalculateTextPosition(n,t){t=t||{};var r=t.isRoundCap;return function(a,o,u){var s=o.position;if(!s||s instanceof Array)return calculateTextPosition(a,o,u);var c=n(s),l=o.distance!=null?o.distance:5,d=this.shape,f=d.cx,h=d.cy,v=d.r,g=d.r0,b=(v+g)/2,_=d.startAngle,S=d.endAngle,T=(_+S)/2,w=r?Math.abs(v-g)/2:0,A=Math.cos,R=Math.sin,E=f+v*A(_),I=h+v*R(_),L="left",F="top";switch(c){case"startArc":E=f+(g-l)*A(T),I=h+(g-l)*R(T),L="center",F="top";break;case"insideStartArc":E=f+(g+l)*A(T),I=h+(g+l)*R(T),L="center",F="bottom";break;case"startAngle":E=f+b*A(_)+adjustAngleDistanceX(_,l+w,!1),I=h+b*R(_)+adjustAngleDistanceY(_,l+w,!1),L="right",F="middle";break;case"insideStartAngle":E=f+b*A(_)+adjustAngleDistanceX(_,-l+w,!1),I=h+b*R(_)+adjustAngleDistanceY(_,-l+w,!1),L="left",F="middle";break;case"middle":E=f+b*A(T),I=h+b*R(T),L="center",F="middle";break;case"endArc":E=f+(v+l)*A(T),I=h+(v+l)*R(T),L="center",F="bottom";break;case"insideEndArc":E=f+(v-l)*A(T),I=h+(v-l)*R(T),L="center",F="top";break;case"endAngle":E=f+b*A(S)+adjustAngleDistanceX(S,l+w,!0),I=h+b*R(S)+adjustAngleDistanceY(S,l+w,!0),L="left",F="middle";break;case"insideEndAngle":E=f+b*A(S)+adjustAngleDistanceX(S,-l+w,!0),I=h+b*R(S)+adjustAngleDistanceY(S,-l+w,!0),L="right",F="middle";break;default:return calculateTextPosition(a,o,u)}return a=a||{},a.x=E,a.y=I,a.align=L,a.verticalAlign=F,a}}function setSectorTextRotation(n,t,r,a){if(isNumber(a)){n.setTextConfig({rotation:a});return}else if(isArray$2(t)){n.setTextConfig({rotation:0});return}var o=n.shape,u=o.clockwise?o.startAngle:o.endAngle,s=o.clockwise?o.endAngle:o.startAngle,c=(u+s)/2,l,d=r(t);switch(d){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=c;break;case"startAngle":case"insideStartAngle":l=u;break;case"endAngle":case"insideEndAngle":l=s;break;default:n.setTextConfig({rotation:0});return}var f=Math.PI*1.5-l;d==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),n.setTextConfig({rotation:f})}function adjustAngleDistanceX(n,t,r){return t*Math.sin(n)*(r?-1:1)}function adjustAngleDistanceY(n,t,r){return t*Math.cos(n)*(r?1:-1)}function getSectorCornerRadius(n,t,r){var a=n.get("borderRadius");if(a==null)return r?{cornerRadius:0}:null;isArray$2(a)||(a=[a,a,a,a]);var o=Math.abs(t.r||0-t.r0||0);return{cornerRadius:map$1(a,function(u){return parsePercent$1(u,o)})}}var mathMax$4=Math.max,mathMin$4=Math.min;function getClipArea(n,t){var r=n.getArea&&n.getArea();if(isCoordinateSystemType(n,"cartesian2d")){var a=n.getBaseAxis();if(a.type!=="category"||!a.onBand){var o=t.getLayout("bandWidth");a.isHorizontal()?(r.x-=o,r.width+=o*2):(r.y-=o,r.height+=o*2)}}return r}var BarView=function(n){__extends(t,n);function t(){var r=n.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,a,o,u){this._model=r,this._removeOnRenderedListener(o),this._updateDrawMode(r);var s=r.get("coordinateSystem");(s==="cartesian2d"||s==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,a,o):this._renderNormal(r,a,o,u))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,a){this._progressiveEls=[],this._incrementalRenderLarge(r,a)},t.prototype.eachRendered=function(r){traverseElements(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var a=r.pipelineContext.large;(this._isLargeDraw==null||a!==this._isLargeDraw)&&(this._isLargeDraw=a,this._clear())},t.prototype._renderNormal=function(r,a,o,u){var s=this.group,c=r.getData(),l=this._data,d=r.coordinateSystem,f=d.getBaseAxis(),h;d.type==="cartesian2d"?h=f.isHorizontal():d.type==="polar"&&(h=f.dim==="angle");var v=r.isAnimationEnabled()?r:null,g=shouldRealtimeSort(r,d);g&&this._enableRealtimeSort(g,c,o);var b=r.get("clip",!0)||g,_=getClipArea(d,c);s.removeClipPath();var S=r.get("roundCap",!0),T=r.get("showBackground",!0),w=r.getModel("backgroundStyle"),A=w.get("borderRadius")||0,R=[],E=this._backgroundEls,I=u&&u.isInitSort,L=u&&u.type==="changeAxisOrder";function F(O){var P=getLayout[d.type](c,O),C=createBackgroundEl(d,h,P);return C.useStyle(w.getItemStyle()),d.type==="cartesian2d"?C.setShape("r",A):C.setShape("cornerRadius",A),R[O]=C,C}c.diff(l).add(function(O){var P=c.getItemModel(O),C=getLayout[d.type](c,O,P);if(T&&F(O),!(!c.hasValue(O)||!isValidLayout[d.type](C))){var q=!1;b&&(q=clip[d.type](_,C));var M=elementCreator[d.type](r,c,O,C,h,v,f.model,!1,S);g&&(M.forceLabelAnimation=!0),updateStyle(M,c,O,P,C,r,h,d.type==="polar"),I?M.attr({shape:C}):g?updateRealtimeAnimation(g,v,M,C,O,h,!1,!1):initProps(M,{shape:C},r,O),c.setItemGraphicEl(O,M),s.add(M),M.ignore=q}}).update(function(O,P){var C=c.getItemModel(O),q=getLayout[d.type](c,O,C);if(T){var M=void 0;E.length===0?M=F(P):(M=E[P],M.useStyle(w.getItemStyle()),d.type==="cartesian2d"?M.setShape("r",A):M.setShape("cornerRadius",A),R[O]=M);var N=getLayout[d.type](c,O),G=createBackgroundShape(h,N,d);updateProps$1(M,{shape:G},v,O)}var X=l.getItemGraphicEl(P);if(!c.hasValue(O)||!isValidLayout[d.type](q)){s.remove(X);return}var Y=!1;if(b&&(Y=clip[d.type](_,q),Y&&s.remove(X)),X?saveOldStyle(X):X=elementCreator[d.type](r,c,O,q,h,v,f.model,!!X,S),g&&(X.forceLabelAnimation=!0),L){var W=X.getTextContent();if(W){var te=labelInner(W);te.prevValue!=null&&(te.prevValue=te.value)}}else updateStyle(X,c,O,C,q,r,h,d.type==="polar");I?X.attr({shape:q}):g?updateRealtimeAnimation(g,v,X,q,O,h,!0,L):updateProps$1(X,{shape:q},r,O,null),c.setItemGraphicEl(O,X),X.ignore=Y,s.add(X)}).remove(function(O){var P=l.getItemGraphicEl(O);P&&removeElementWithFadeOut(P,r,O)}).execute();var D=this._backgroundGroup||(this._backgroundGroup=new Group$3);D.removeAll();for(var $=0;$<R.length;++$)D.add(R[$]);s.add(D),this._backgroundEls=R,this._data=c},t.prototype._renderLarge=function(r,a,o){this._clear(),createLarge$1(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,a){this._removeBackground(),createLarge$1(a,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var a=r.get("clip",!0)&&createClipPath(r.coordinateSystem,!1,r),o=this.group;a?o.setClipPath(a):o.removeClipPath()},t.prototype._enableRealtimeSort=function(r,a,o){var u=this;if(a.count()){var s=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(a,r,o),this._isFirstFrame=!1;else{var c=function(l){var d=a.getItemGraphicEl(l),f=d&&d.shape;return f&&Math.abs(s.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){u._updateSortWithinSameData(a,c,s,o)},o.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,a,o){var u=[];return r.each(r.mapDimension(a.dim),function(s,c){var l=o(c);l=l??NaN,u.push({dataIndex:c,mappedValue:l,ordinalNumber:s})}),u.sort(function(s,c){return c.mappedValue-s.mappedValue}),{ordinalNumbers:map$1(u,function(s){return s.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,a,o){for(var u=o.scale,s=r.mapDimension(o.dim),c=Number.MAX_VALUE,l=0,d=u.getOrdinalMeta().categories.length;l<d;++l){var f=r.rawIndexOf(s,u.getRawOrdinalNumber(l)),h=f<0?Number.MIN_VALUE:a(r.indexOfRawIndex(f));if(h>c)return!0;c=h}return!1},t.prototype._isOrderDifferentInView=function(r,a){for(var o=a.scale,u=o.getExtent(),s=Math.max(0,u[0]),c=Math.min(u[1],o.getOrdinalMeta().categories.length-1);s<=c;++s)if(r.ordinalNumbers[s]!==o.getRawOrdinalNumber(s))return!0},t.prototype._updateSortWithinSameData=function(r,a,o,u){if(this._isOrderChangedWithinSameData(r,a,o)){var s=this._dataSort(r,o,a);this._isOrderDifferentInView(s,o)&&(this._removeOnRenderedListener(u),u.dispatchAction({type:"changeAxisOrder",componentType:o.dim+"Axis",axisId:o.index,sortInfo:s}))}},t.prototype._dispatchInitSort=function(r,a,o){var u=a.baseAxis,s=this._dataSort(r,u,function(c){return r.get(r.mapDimension(a.otherAxis.dim),c)});o.dispatchAction({type:"changeAxisOrder",componentType:u.dim+"Axis",isInitSort:!0,axisId:u.index,sortInfo:s})},t.prototype.remove=function(r,a){this._clear(this._model),this._removeOnRenderedListener(a)},t.prototype.dispose=function(r,a){this._removeOnRenderedListener(a)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var a=this.group,o=this._data;r&&r.isAnimationEnabled()&&o&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],o.eachItemGraphicEl(function(u){removeElementWithFadeOut(u,r,getECData(u).dataIndex)})):a.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(ChartView),clip={cartesian2d:function(n,t){var r=t.width<0?-1:1,a=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),a<0&&(t.y+=t.height,t.height=-t.height);var o=n.x+n.width,u=n.y+n.height,s=mathMax$4(t.x,n.x),c=mathMin$4(t.x+t.width,o),l=mathMax$4(t.y,n.y),d=mathMin$4(t.y+t.height,u),f=c<s,h=d<l;return t.x=f&&s>o?c:s,t.y=h&&l>u?d:l,t.width=f?0:c-s,t.height=h?0:d-l,r<0&&(t.x+=t.width,t.width=-t.width),a<0&&(t.y+=t.height,t.height=-t.height),f||h},polar:function(n,t){var r=t.r0<=t.r?1:-1;if(r<0){var a=t.r;t.r=t.r0,t.r0=a}var o=mathMin$4(t.r,n.r),u=mathMax$4(t.r0,n.r0);t.r=o,t.r0=u;var s=o-u<0;if(r<0){var a=t.r;t.r=t.r0,t.r0=a}return s}},elementCreator={cartesian2d:function(n,t,r,a,o,u,s,c,l){var d=new Rect$2({shape:extend$1({},a),z2:1});if(d.__dataIndex=r,d.name="item",u){var f=d.shape,h=o?"height":"width";f[h]=0}return d},polar:function(n,t,r,a,o,u,s,c,l){var d=!o&&l?SausagePath:Sector,f=new d({shape:a,z2:1});f.name="item";var h=createPolarPositionMapping(o);if(f.calculateTextPosition=createSectorCalculateTextPosition(h,{isRoundCap:d===SausagePath}),u){var v=f.shape,g=o?"r":"endAngle",b={};v[g]=o?a.r0:a.startAngle,b[g]=a[g],(c?updateProps$1:initProps)(f,{shape:b},u)}return f}};function shouldRealtimeSort(n,t){var r=n.get("realtimeSort",!0),a=t.getBaseAxis();if(r&&a.type==="category"&&t.type==="cartesian2d")return{baseAxis:a,otherAxis:t.getOtherAxis(a)}}function updateRealtimeAnimation(n,t,r,a,o,u,s,c){var l,d;u?(d={x:a.x,width:a.width},l={y:a.y,height:a.height}):(d={y:a.y,height:a.height},l={x:a.x,width:a.width}),c||(s?updateProps$1:initProps)(r,{shape:l},t,o,null);var f=t?n.baseAxis.model:null;(s?updateProps$1:initProps)(r,{shape:d},f,o)}function checkPropertiesNotValid(n,t){for(var r=0;r<t.length;r++)if(!isFinite(n[t[r]]))return!0;return!1}var rectPropties=["x","y","width","height"],polarPropties=["cx","cy","r","startAngle","endAngle"],isValidLayout={cartesian2d:function(n){return!checkPropertiesNotValid(n,rectPropties)},polar:function(n){return!checkPropertiesNotValid(n,polarPropties)}},getLayout={cartesian2d:function(n,t,r){var a=n.getItemLayout(t),o=r?getLineWidth(r,a):0,u=a.width>0?1:-1,s=a.height>0?1:-1;return{x:a.x+u*o/2,y:a.y+s*o/2,width:a.width-u*o,height:a.height-s*o}},polar:function(n,t,r){var a=n.getItemLayout(t);return{cx:a.cx,cy:a.cy,r0:a.r0,r:a.r,startAngle:a.startAngle,endAngle:a.endAngle,clockwise:a.clockwise}}};function isZeroOnPolar(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function createPolarPositionMapping(n){return function(t){var r=t?"Arc":"Angle";return function(a){switch(a){case"start":case"insideStart":case"end":case"insideEnd":return a+r;default:return a}}}(n)}function updateStyle(n,t,r,a,o,u,s,c){var l=t.getItemVisual(r,"style");if(c){if(!u.get("roundCap")){var f=n.shape,h=getSectorCornerRadius(a.getModel("itemStyle"),f,!0);extend$1(f,h),n.setShape(f)}}else{var d=a.get(["itemStyle","borderRadius"])||0;n.setShape("r",d)}n.useStyle(l);var v=a.getShallow("cursor");v&&n.attr("cursor",v);var g=c?s?o.r>=o.r0?"endArc":"startArc":o.endAngle>=o.startAngle?"endAngle":"startAngle":s?o.height>=0?"bottom":"top":o.width>=0?"right":"left",b=getLabelStatesModels(a);setLabelStyle(n,b,{labelFetcher:u,labelDataIndex:r,defaultText:getDefaultLabel(u.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:g});var _=n.getTextContent();if(c&&_){var S=a.get(["label","position"]);n.textConfig.inside=S==="middle"?!0:null,setSectorTextRotation(n,S==="outside"?g:S,createPolarPositionMapping(s),a.get(["label","rotate"]))}setLabelValueAnimation(_,b,u.getRawValue(r),function(w){return getDefaultInterpolatedLabel(t,w)});var T=a.getModel(["emphasis"]);toggleHoverEmphasis(n,T.get("focus"),T.get("blurScope"),T.get("disabled")),setStatesStylesFromModel(n,a),isZeroOnPolar(o)&&(n.style.fill="none",n.style.stroke="none",each$f(n.states,function(w){w.style&&(w.style.fill=w.style.stroke="none")}))}function getLineWidth(n,t){var r=n.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var a=n.get(["itemStyle","borderWidth"])||0,o=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),u=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(a,o,u)}var LagePathShape=function(){function n(){}return n}(),LargePath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="largeBar",a}return t.prototype.getDefaultShape=function(){return new LagePathShape},t.prototype.buildPath=function(r,a){for(var o=a.points,u=this.baseDimIdx,s=1-this.baseDimIdx,c=[],l=[],d=this.barWidth,f=0;f<o.length;f+=3)l[u]=d,l[s]=o[f+2],c[u]=o[f+u],c[s]=o[f+s],r.rect(c[0],c[1],l[0],l[1])},t}(Path);function createLarge$1(n,t,r,a){var o=n.getData(),u=o.getLayout("valueAxisHorizontal")?1:0,s=o.getLayout("largeDataIndices"),c=o.getLayout("size"),l=n.getModel("backgroundStyle"),d=o.getLayout("largeBackgroundPoints");if(d){var f=new LargePath({shape:{points:d},incremental:!!a,silent:!0,z2:0});f.baseDimIdx=u,f.largeDataIndices=s,f.barWidth=c,f.useStyle(l.getItemStyle()),t.add(f),r&&r.push(f)}var h=new LargePath({shape:{points:o.getLayout("largePoints")},incremental:!!a,ignoreCoarsePointer:!0,z2:1});h.baseDimIdx=u,h.largeDataIndices=s,h.barWidth=c,t.add(h),h.useStyle(o.getVisual("style")),h.style.stroke=null,getECData(h).seriesIndex=n.seriesIndex,n.get("silent")||(h.on("mousedown",largePathUpdateDataIndex),h.on("mousemove",largePathUpdateDataIndex)),r&&r.push(h)}var largePathUpdateDataIndex=throttle(function(n){var t=this,r=largePathFindDataIndex(t,n.offsetX,n.offsetY);getECData(t).dataIndex=r>=0?r:null},30,!1);function largePathFindDataIndex(n,t,r){for(var a=n.baseDimIdx,o=1-a,u=n.shape.points,s=n.largeDataIndices,c=[],l=[],d=n.barWidth,f=0,h=u.length/3;f<h;f++){var v=f*3;if(l[a]=d,l[o]=u[v+2],c[a]=u[v+a],c[o]=u[v+o],l[o]<0&&(c[o]+=l[o],l[o]=-l[o]),t>=c[0]&&t<=c[0]+l[0]&&r>=c[1]&&r<=c[1]+l[1])return s[f]}return-1}function createBackgroundShape(n,t,r){if(isCoordinateSystemType(r,"cartesian2d")){var a=t,o=r.getArea();return{x:n?a.x:o.x,y:n?o.y:a.y,width:n?a.width:o.width,height:n?o.height:a.height}}else{var o=r.getArea(),u=t;return{cx:o.cx,cy:o.cy,r0:n?o.r0:u.r0,r:n?o.r:u.r,startAngle:n?u.startAngle:0,endAngle:n?u.endAngle:Math.PI*2}}}function createBackgroundEl(n,t,r){var a=n.type==="polar"?Sector:Rect$2;return new a({shape:createBackgroundShape(t,r,n),silent:!0,z2:0})}function install$P(n){n.registerChartView(BarView),n.registerSeriesModel(BarSeriesModel),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,curry$1(layout$5,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,dataSample("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var a=t.componentType||"series";r.eachComponent({mainType:a,query:t},function(o){t.sortInfo&&o.axis.setCategorySortInfo(t.sortInfo)})})}var PI2=Math.PI*2,RADIAN$2=Math.PI/180;function getViewRect$5(n,t){return getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function getBasicPieLayout(n,t){var r=getViewRect$5(n,t),a=n.get("center"),o=n.get("radius");isArray$2(o)||(o=[0,o]);var u=parsePercent(r.width,t.getWidth()),s=parsePercent(r.height,t.getHeight()),c=Math.min(u,s),l=parsePercent(o[0],c/2),d=parsePercent(o[1],c/2),f,h,v=n.coordinateSystem;if(v){var g=v.dataToPoint(a);f=g[0]||0,h=g[1]||0}else isArray$2(a)||(a=[a,a]),f=parsePercent(a[0],u)+r.x,h=parsePercent(a[1],s)+r.y;return{cx:f,cy:h,r0:l,r:d}}function pieLayout(n,t,r){t.eachSeriesByType(n,function(a){var o=a.getData(),u=o.mapDimension("value"),s=getViewRect$5(a,r),c=getBasicPieLayout(a,r),l=c.cx,d=c.cy,f=c.r,h=c.r0,v=-a.get("startAngle")*RADIAN$2,g=a.get("endAngle"),b=a.get("padAngle")*RADIAN$2;g=g==="auto"?v-PI2:-g*RADIAN$2;var _=a.get("minAngle")*RADIAN$2,S=_+b,T=0;o.each(u,function(G){!isNaN(G)&&T++});var w=o.getSum(u),A=Math.PI/(w||T)*2,R=a.get("clockwise"),E=a.get("roseType"),I=a.get("stillShowZeroSum"),L=o.getDataExtent(u);L[0]=0;var F=R?1:-1,D=[v,g],$=F*b/2;normalizeArcAngles(D,!R),v=D[0],g=D[1];var O=getSeriesLayoutData(a);O.startAngle=v,O.endAngle=g,O.clockwise=R;var P=Math.abs(g-v),C=P,q=0,M=v;if(o.setLayout({viewRect:s,r:f}),o.each(u,function(G,X){var Y;if(isNaN(G)){o.setItemLayout(X,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:R,cx:l,cy:d,r0:h,r:E?NaN:f});return}E!=="area"?Y=w===0&&I?A:G*A:Y=P/T,Y<S?(Y=S,C-=S):q+=G;var W=M+F*Y,te=0,ue=0;b>Y?(te=M+F*Y/2,ue=te):(te=M+$,ue=W-$),o.setItemLayout(X,{angle:Y,startAngle:te,endAngle:ue,clockwise:R,cx:l,cy:d,r0:h,r:E?linearMap$2(G,L,[h,f]):f}),M=W}),C<PI2&&T)if(C<=.001){var N=P/T;o.each(u,function(G,X){if(!isNaN(G)){var Y=o.getItemLayout(X);Y.angle=N;var W=0,te=0;N<b?(W=v+F*(X+1/2)*N,te=W):(W=v+F*X*N+$,te=v+F*(X+1)*N-$),Y.startAngle=W,Y.endAngle=te}})}else A=C/q,M=v,o.each(u,function(G,X){if(!isNaN(G)){var Y=o.getItemLayout(X),W=Y.angle===S?S:G*A,te=0,ue=0;W<b?(te=M+F*W/2,ue=te):(te=M+$,ue=M+F*W-$),Y.startAngle=te,Y.endAngle=ue,M+=F*W}})})}var getSeriesLayoutData=makeInner();function dataFilter$1(n){return{seriesType:n,reset:function(t,r){var a=r.findComponents({mainType:"legend"});if(!(!a||!a.length)){var o=t.getData();o.filterSelf(function(u){for(var s=o.getName(u),c=0;c<a.length;c++)if(!a[c].isSelected(s))return!1;return!0})}}}}var RADIAN$1=Math.PI/180;function adjustSingleSide(n,t,r,a,o,u,s,c,l,d){if(n.length<2)return;function f(_){for(var S=_.rB,T=S*S,w=0;w<_.list.length;w++){var A=_.list[w],R=Math.abs(A.label.y-r),E=a+A.len,I=E*E,L=Math.sqrt(Math.abs((1-R*R/T)*I)),F=t+(L+A.len2)*o,D=F-A.label.x,$=A.targetTextWidth-D*o;constrainTextWidth(A,$,!0),A.label.x=F}}function h(_){for(var S={list:[],maxY:0},T={list:[],maxY:0},w=0;w<_.length;w++)if(_[w].labelAlignTo==="none"){var A=_[w],R=A.label.y>r?T:S,E=Math.abs(A.label.y-r);if(E>=R.maxY){var I=A.label.x-t-A.len2*o,L=a+A.len,F=Math.abs(I)<L?Math.sqrt(E*E/(1-I*I/L/L)):L;R.rB=F,R.maxY=E}R.list.push(A)}f(S),f(T)}for(var v=n.length,g=0;g<v;g++)if(n[g].position==="outer"&&n[g].labelAlignTo==="labelLine"){var b=n[g].label.x-d;n[g].linePoints[1][0]+=b,n[g].label.x=d}shiftLayoutOnY(n,l,l+s)&&h(n)}function avoidOverlap(n,t,r,a,o,u,s,c){for(var l=[],d=[],f=Number.MAX_VALUE,h=-Number.MAX_VALUE,v=0;v<n.length;v++){var g=n[v].label;isPositionCenter(n[v])||(g.x<t?(f=Math.min(f,g.x),l.push(n[v])):(h=Math.max(h,g.x),d.push(n[v])))}for(var v=0;v<n.length;v++){var b=n[v];if(!isPositionCenter(b)&&b.linePoints){if(b.labelStyleWidth!=null)continue;var g=b.label,_=b.linePoints,S=void 0;b.labelAlignTo==="edge"?g.x<t?S=_[2][0]-b.labelDistance-s-b.edgeDistance:S=s+o-b.edgeDistance-_[2][0]-b.labelDistance:b.labelAlignTo==="labelLine"?g.x<t?S=f-s-b.bleedMargin:S=s+o-h-b.bleedMargin:g.x<t?S=g.x-s-b.bleedMargin:S=s+o-g.x-b.bleedMargin,b.targetTextWidth=S,constrainTextWidth(b,S)}}adjustSingleSide(d,t,r,a,1,o,u,s,c,h),adjustSingleSide(l,t,r,a,-1,o,u,s,c,f);for(var v=0;v<n.length;v++){var b=n[v];if(!isPositionCenter(b)&&b.linePoints){var g=b.label,_=b.linePoints,T=b.labelAlignTo==="edge",w=g.style.padding,A=w?w[1]+w[3]:0,R=g.style.backgroundColor?0:A,E=b.rect.width+R,I=_[1][0]-_[2][0];T?g.x<t?_[2][0]=s+b.edgeDistance+E+b.labelDistance:_[2][0]=s+o-b.edgeDistance-E-b.labelDistance:(g.x<t?_[2][0]=g.x+b.labelDistance:_[2][0]=g.x-b.labelDistance,_[1][0]=_[2][0]+I),_[1][1]=_[2][1]=g.y}}}function constrainTextWidth(n,t,r){if(r===void 0&&(r=!1),n.labelStyleWidth==null){var a=n.label,o=a.style,u=n.rect,s=o.backgroundColor,c=o.padding,l=c?c[1]+c[3]:0,d=o.overflow,f=u.width+(s?0:l);if(t<f||r){var h=u.height;if(d&&d.match("break")){a.setStyle("backgroundColor",null),a.setStyle("width",t-l);var v=a.getBoundingRect();a.setStyle("width",Math.ceil(v.width)),a.setStyle("backgroundColor",s)}else{var g=t-l,b=t<f?g:r?g>n.unconstrainedWidth?null:g:null;a.setStyle("width",b)}var _=a.getBoundingRect();u.width=_.width;var S=(a.style.margin||0)+2.1;u.height=_.height+S,u.y-=(u.height-h)/2}}}function isPositionCenter(n){return n.position==="center"}function pieLabelLayout(n){var t=n.getData(),r=[],a,o,u=!1,s=(n.get("minShowLabelAngle")||0)*RADIAN$1,c=t.getLayout("viewRect"),l=t.getLayout("r"),d=c.width,f=c.x,h=c.y,v=c.height;function g(I){I.ignore=!0}function b(I){if(!I.ignore)return!0;for(var L in I.states)if(I.states[L].ignore===!1)return!0;return!1}t.each(function(I){var L=t.getItemGraphicEl(I),F=L.shape,D=L.getTextContent(),$=L.getTextGuideLine(),O=t.getItemModel(I),P=O.getModel("label"),C=P.get("position")||O.get(["emphasis","label","position"]),q=P.get("distanceToLabelLine"),M=P.get("alignTo"),N=parsePercent(P.get("edgeDistance"),d),G=P.get("bleedMargin"),X=O.getModel("labelLine"),Y=X.get("length");Y=parsePercent(Y,d);var W=X.get("length2");if(W=parsePercent(W,d),Math.abs(F.endAngle-F.startAngle)<s){each$f(D.states,g),D.ignore=!0,$&&(each$f($.states,g),$.ignore=!0);return}if(b(D)){var te=(F.startAngle+F.endAngle)/2,ue=Math.cos(te),fe=Math.sin(te),re,ye,Te,Re;a=F.cx,o=F.cy;var ve=C==="inside"||C==="inner";if(C==="center")re=F.cx,ye=F.cy,Re="center";else{var ce=(ve?(F.r+F.r0)/2*ue:F.r*ue)+a,J=(ve?(F.r+F.r0)/2*fe:F.r*fe)+o;if(re=ce+ue*3,ye=J+fe*3,!ve){var j=ce+ue*(Y+l-F.r),z=J+fe*(Y+l-F.r),B=j+(ue<0?-1:1)*W,U=z;M==="edge"?re=ue<0?f+N:f+d-N:re=B+(ue<0?-q:q),ye=U,Te=[[ce,J],[j,z],[B,U]]}Re=ve?"center":M==="edge"?ue>0?"right":"left":ue>0?"left":"right"}var Z=Math.PI,oe=0,ie=P.get("rotate");if(isNumber(ie))oe=ie*(Z/180);else if(C==="center")oe=0;else if(ie==="radial"||ie===!0){var se=ue<0?-te+Z:-te;oe=se}else if(ie==="tangential"&&C!=="outside"&&C!=="outer"){var ne=Math.atan2(ue,fe);ne<0&&(ne=Z*2+ne);var he=fe>0;he&&(ne=Z+ne),oe=ne-Z}if(u=!!oe,D.x=re,D.y=ye,D.rotation=oe,D.setStyle({verticalAlign:"middle"}),ve){D.setStyle({align:Re});var Ie=D.states.select;Ie&&(Ie.x+=D.x,Ie.y+=D.y)}else{var xe=D.getBoundingRect().clone();xe.applyTransform(D.getComputedTransform());var me=(D.style.margin||0)+2.1;xe.y-=me/2,xe.height+=me,r.push({label:D,labelLine:$,position:C,len:Y,len2:W,minTurnAngle:X.get("minTurnAngle"),maxSurfaceAngle:X.get("maxSurfaceAngle"),surfaceNormal:new Point(ue,fe),linePoints:Te,textAlign:Re,labelDistance:q,labelAlignTo:M,edgeDistance:N,bleedMargin:G,rect:xe,unconstrainedWidth:xe.width,labelStyleWidth:D.style.width})}L.setTextConfig({inside:ve})}}),!u&&n.get("avoidLabelOverlap")&&avoidOverlap(r,a,o,l,d,v,f,h);for(var _=0;_<r.length;_++){var S=r[_],T=S.label,w=S.labelLine,A=isNaN(T.x)||isNaN(T.y);if(T){T.setStyle({align:S.textAlign}),A&&(each$f(T.states,g),T.ignore=!0);var R=T.states.select;R&&(R.x+=T.x,R.y+=T.y)}if(w){var E=S.linePoints;A||!E?(each$f(w.states,g),w.ignore=!0):(limitTurnAngle(E,S.minTurnAngle),limitSurfaceAngle(E,S.surfaceNormal,S.maxSurfaceAngle),w.setShape({points:E}),T.__hostTarget.textGuideLineConfig={anchor:new Point(E[0][0],E[0][1])})}}}var PiePiece=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this)||this;u.z2=2;var s=new ZRText;return u.setTextContent(s),u.updateData(r,a,o,!0),u}return t.prototype.updateData=function(r,a,o,u){var s=this,c=r.hostModel,l=r.getItemModel(a),d=l.getModel("emphasis"),f=r.getItemLayout(a),h=extend$1(getSectorCornerRadius(l.getModel("itemStyle"),f,!0),f);if(isNaN(h.startAngle)){s.setShape(h);return}if(u){s.setShape(h);var v=c.getShallow("animationType");c.ecModel.ssr?(initProps(s,{scaleX:0,scaleY:0},c,{dataIndex:a,isFrom:!0}),s.originX=h.cx,s.originY=h.cy):v==="scale"?(s.shape.r=f.r0,initProps(s,{shape:{r:f.r}},c,a)):o!=null?(s.setShape({startAngle:o,endAngle:o}),initProps(s,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},c,a)):(s.shape.endAngle=f.startAngle,updateProps$1(s,{shape:{endAngle:f.endAngle}},c,a))}else saveOldStyle(s),updateProps$1(s,{shape:h},c,a);s.useStyle(r.getItemVisual(a,"style")),setStatesStylesFromModel(s,l);var g=(f.startAngle+f.endAngle)/2,b=c.get("selectedOffset"),_=Math.cos(g)*b,S=Math.sin(g)*b,T=l.getShallow("cursor");T&&s.attr("cursor",T),this._updateLabel(c,r,a),s.ensureState("emphasis").shape=extend$1({r:f.r+(d.get("scale")&&d.get("scaleSize")||0)},getSectorCornerRadius(d.getModel("itemStyle"),f)),extend$1(s.ensureState("select"),{x:_,y:S,shape:getSectorCornerRadius(l.getModel(["select","itemStyle"]),f)}),extend$1(s.ensureState("blur"),{shape:getSectorCornerRadius(l.getModel(["blur","itemStyle"]),f)});var w=s.getTextGuideLine(),A=s.getTextContent();w&&extend$1(w.ensureState("select"),{x:_,y:S}),extend$1(A.ensureState("select"),{x:_,y:S}),toggleHoverEmphasis(this,d.get("focus"),d.get("blurScope"),d.get("disabled"))},t.prototype._updateLabel=function(r,a,o){var u=this,s=a.getItemModel(o),c=s.getModel("labelLine"),l=a.getItemVisual(o,"style"),d=l&&l.fill,f=l&&l.opacity;setLabelStyle(u,getLabelStatesModels(s),{labelFetcher:a.hostModel,labelDataIndex:o,inheritColor:d,defaultOpacity:f,defaultText:r.getFormattedLabel(o,"normal")||a.getName(o)});var h=u.getTextContent();u.setTextConfig({position:null,rotation:null}),h.attr({z2:10});var v=r.get(["label","position"]);if(v!=="outside"&&v!=="outer")u.removeTextGuideLine();else{var g=this.getTextGuideLine();g||(g=new Polyline$1,this.setTextGuideLine(g)),setLabelLineStyle(this,getLabelLineStatesModels(s),{stroke:d,opacity:retrieve3(c.get(["lineStyle","opacity"]),f,1)})}},t}(Sector),PieView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,a,o,u){var s=r.getData(),c=this._data,l=this.group,d;if(!c&&s.count()>0){for(var f=s.getItemLayout(0),h=1;isNaN(f&&f.startAngle)&&h<s.count();++h)f=s.getItemLayout(h);f&&(d=f.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),s.count()===0&&r.get("showEmptyCircle")){var v=getSeriesLayoutData(r),g=new Sector({shape:extend$1(getBasicPieLayout(r,o),v)});g.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=g,l.add(g)}s.diff(c).add(function(b){var _=new PiePiece(s,b,d);s.setItemGraphicEl(b,_),l.add(_)}).update(function(b,_){var S=c.getItemGraphicEl(_);S.updateData(s,b,d),S.off("click"),l.add(S),s.setItemGraphicEl(b,S)}).remove(function(b){var _=c.getItemGraphicEl(b);removeElementWithFadeOut(_,r,b)}).execute(),pieLabelLayout(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=s)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,a){var o=a.getData(),u=o.getItemLayout(0);if(u){var s=r[0]-u.cx,c=r[1]-u.cy,l=Math.sqrt(s*s+c*c);return l<=u.r&&l>=u.r0}},t.type="pie",t}(ChartView);function createSeriesDataSimply(n,t,r){t=isArray$2(t)&&{coordDimensions:t}||extend$1({encodeDefine:n.getEncode()},t);var a=n.getSource(),o=prepareSeriesDataSchema(a,t).dimensions,u=new SeriesData(o,n);return u.initData(a,r),u}var LegendVisualProvider=function(){function n(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return n.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},n.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},n.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},n.prototype.getItemVisual=function(t,r){var a=this._getDataWithEncodedVisual();return a.getItemVisual(t,r)},n}(),innerData=makeInner(),PieSeriesModel=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(r){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)})},t.prototype.getDataParams=function(r){var a=this.getData(),o=innerData(a),u=o.seats;if(!u){var s=[];a.each(a.mapDimension("value"),function(l){s.push(l)}),u=o.seats=getPercentSeats(s,a.hostModel.get("percentPrecision"))}var c=n.prototype.getDataParams.call(this,r);return c.percent=u[r]||0,c.$vars.push("percent"),c},t.prototype._defaultLabelLine=function(r){defaultEmphasis(r,"labelLine",["show"]);var a=r.labelLine,o=r.emphasis.labelLine;a.show=a.show&&r.label.show,o.show=o.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(SeriesModel);function negativeDataFilter(n){return{seriesType:n,reset:function(t,r){var a=t.getData();a.filterSelf(function(o){var u=a.mapDimension("value"),s=a.get(u,o);return!(isNumber(s)&&!isNaN(s)&&s<0)})}}}function install$O(n){n.registerChartView(PieView),n.registerSeriesModel(PieSeriesModel),createLegacyDataSelectAction("pie",n.registerAction),n.registerLayout(curry$1(pieLayout,"pie")),n.registerProcessor(dataFilter$1("pie")),n.registerProcessor(negativeDataFilter("pie"))}var ScatterSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r,a){return createSeriesData(null,this,{useEncodeDefaulter:!0})},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?5e3:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?1e4:this.get("progressiveThreshold"))},t.prototype.brushSelector=function(r,a,o){return o.point(a.getItemLayout(r))},t.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},t.type="series.scatter",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},t}(SeriesModel),BOOST_SIZE_THRESHOLD=4,LargeSymbolPathShape=function(){function n(){}return n}(),LargeSymbolPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a._off=0,a.hoverDataIdx=-1,a}return t.prototype.getDefaultShape=function(){return new LargeSymbolPathShape},t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.buildPath=function(r,a){var o=a.points,u=a.size,s=this.symbolProxy,c=s.shape,l=r.getContext?r.getContext():r,d=l&&u[0]<BOOST_SIZE_THRESHOLD,f=this.softClipShape,h;if(d){this._ctx=l;return}for(this._ctx=null,h=this._off;h<o.length;){var v=o[h++],g=o[h++];isNaN(v)||isNaN(g)||f&&!f.contain(v,g)||(c.x=v-u[0]/2,c.y=g-u[1]/2,c.width=u[0],c.height=u[1],s.buildPath(r,c,!0))}this.incremental&&(this._off=h,this.notClear=!0)},t.prototype.afterBrush=function(){var r=this.shape,a=r.points,o=r.size,u=this._ctx,s=this.softClipShape,c;if(u){for(c=this._off;c<a.length;){var l=a[c++],d=a[c++];isNaN(l)||isNaN(d)||s&&!s.contain(l,d)||u.fillRect(l-o[0]/2,d-o[1]/2,o[0],o[1])}this.incremental&&(this._off=c,this.notClear=!0)}},t.prototype.findDataIndex=function(r,a){for(var o=this.shape,u=o.points,s=o.size,c=Math.max(s[0],4),l=Math.max(s[1],4),d=u.length/2-1;d>=0;d--){var f=d*2,h=u[f]-c/2,v=u[f+1]-l/2;if(r>=h&&a>=v&&r<=h+c&&a<=v+l)return d}return-1},t.prototype.contain=function(r,a){var o=this.transformCoordToLocal(r,a),u=this.getBoundingRect();if(r=o[0],a=o[1],u.contain(r,a)){var s=this.hoverDataIdx=this.findDataIndex(r,a);return s>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var a=this.shape,o=a.points,u=a.size,s=u[0],c=u[1],l=1/0,d=1/0,f=-1/0,h=-1/0,v=0;v<o.length;){var g=o[v++],b=o[v++];l=Math.min(g,l),f=Math.max(g,f),d=Math.min(b,d),h=Math.max(b,h)}r=this._rect=new BoundingRect(l-s/2,d-c/2,f-l+s,h-d+c)}return r},t}(Path),LargeSymbolDraw=function(){function n(){this.group=new Group$3}return n.prototype.updateData=function(t,r){this._clear();var a=this._create();a.setShape({points:t.getLayout("points")}),this._setCommon(a,t,r)},n.prototype.updateLayout=function(t){var r=t.getLayout("points");this.group.eachChild(function(a){if(a.startIndex!=null){var o=(a.endIndex-a.startIndex)*2,u=a.startIndex*4*2;r=new Float32Array(r.buffer,u,o)}a.setShape("points",r),a.reset()})},n.prototype.incrementalPrepareUpdate=function(t){this._clear()},n.prototype.incrementalUpdate=function(t,r,a){var o=this._newAdded[0],u=r.getLayout("points"),s=o&&o.shape.points;if(s&&s.length<2e4){var c=s.length,l=new Float32Array(c+u.length);l.set(s),l.set(u,c),o.endIndex=t.end,o.setShape({points:l})}else{this._newAdded=[];var d=this._create();d.startIndex=t.start,d.endIndex=t.end,d.incremental=!0,d.setShape({points:u}),this._setCommon(d,r,a)}},n.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},n.prototype._create=function(){var t=new LargeSymbolPath({cursor:"default"});return t.ignoreCoarsePointer=!0,this.group.add(t),this._newAdded.push(t),t},n.prototype._setCommon=function(t,r,a){var o=r.hostModel;a=a||{};var u=r.getVisual("symbolSize");t.setShape("size",u instanceof Array?u:[u,u]),t.softClipShape=a.clipShape||null,t.symbolProxy=createSymbol$1(r.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var s=t.shape.size[0]<BOOST_SIZE_THRESHOLD;t.useStyle(o.getModel("itemStyle").getItemStyle(s?["color","shadowBlur","shadowColor"]:["color"]));var c=r.getVisual("style"),l=c&&c.fill;l&&t.setColor(l);var d=getECData(t);d.seriesIndex=o.seriesIndex,t.on("mousemove",function(f){d.dataIndex=null;var h=t.hoverDataIdx;h>=0&&(d.dataIndex=h+(t.startIndex||0))})},n.prototype.remove=function(){this._clear()},n.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},n}(),ScatterView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=r.getData(),s=this._updateSymbolDraw(u,r);s.updateData(u,{clipShape:this._getClipShape(r)}),this._finished=!0},t.prototype.incrementalPrepareRender=function(r,a,o){var u=r.getData(),s=this._updateSymbolDraw(u,r);s.incrementalPrepareUpdate(u),this._finished=!1},t.prototype.incrementalRender=function(r,a,o){this._symbolDraw.incrementalUpdate(r,a.getData(),{clipShape:this._getClipShape(a)}),this._finished=r.end===a.getData().count()},t.prototype.updateTransform=function(r,a,o){var u=r.getData();if(this.group.dirty(),!this._finished||u.count()>1e4)return{update:!0};var s=pointsLayout("").reset(r,a,o);s.progress&&s.progress({start:0,end:u.count(),count:u.count()},u),this._symbolDraw.updateLayout(u)},t.prototype.eachRendered=function(r){this._symbolDraw&&this._symbolDraw.eachRendered(r)},t.prototype._getClipShape=function(r){if(r.get("clip",!0)){var a=r.coordinateSystem;return a&&a.getArea&&a.getArea(.1)}},t.prototype._updateSymbolDraw=function(r,a){var o=this._symbolDraw,u=a.pipelineContext,s=u.large;return(!o||s!==this._isLargeDraw)&&(o&&o.remove(),o=this._symbolDraw=s?new LargeSymbolDraw:new SymbolDraw,this._isLargeDraw=s,this.group.removeAll()),this.group.add(o.group),o},t.prototype.remove=function(r,a){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},t.prototype.dispose=function(){},t.type="scatter",t}(ChartView),GridModel=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(ComponentModel),CartesianAxisModel=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",SINGLE_REFERRING).models[0]},t.type="cartesian2dAxis",t}(ComponentModel);mixin$1(CartesianAxisModel,AxisModelCommonMixin);var defaultOption$1={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},categoryAxis=merge$3({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},defaultOption$1),valueAxis=merge$3({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},defaultOption$1),timeAxis=merge$3({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},valueAxis),logAxis=defaults$h({logBase:10},valueAxis);const axisDefault={category:categoryAxis,value:valueAxis,time:timeAxis,log:logAxis};var AXIS_TYPES={value:1,category:1,time:1,log:1};function axisModelCreator(n,t,r,a){each$f(AXIS_TYPES,function(o,u){var s=merge$3(merge$3({},axisDefault[u],!0),a,!0),c=function(l){__extends(d,l);function d(){var f=l!==null&&l.apply(this,arguments)||this;return f.type=t+"Axis."+u,f}return d.prototype.mergeDefaultAndTheme=function(f,h){var v=fetchLayoutMode(this),g=v?getLayoutParams(f):{},b=h.getTheme();merge$3(f,b.get(u+"Axis")),merge$3(f,this.getDefaultOption()),f.type=getAxisType(f),v&&mergeLayoutParam(f,g,v)},d.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=OrdinalMeta.createByAxisModel(this))},d.prototype.getCategories=function(f){var h=this.option;if(h.type==="category")return f?h.data:this.__ordinalMeta.categories},d.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},d.type=t+"Axis."+u,d.defaultOption=s,d}(r);n.registerComponentModel(c)}),n.registerSubTypeDefaulter(t+"Axis",getAxisType)}function getAxisType(n){return n.type||(n.data?"category":"value")}var Cartesian=function(){function n(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return n.prototype.getAxis=function(t){return this._axes[t]},n.prototype.getAxes=function(){return map$1(this._dimList,function(t){return this._axes[t]},this)},n.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),filter$1(this.getAxes(),function(r){return r.scale.type===t})},n.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},n}(),cartesian2DDimensions=["x","y"];function canCalculateAffineTransform(n){return n.type==="interval"||n.type==="time"}var Cartesian2D=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=cartesian2DDimensions,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,a=this.getAxis("y").scale;if(!(!canCalculateAffineTransform(r)||!canCalculateAffineTransform(a))){var o=r.getExtent(),u=a.getExtent(),s=this.dataToPoint([o[0],u[0]]),c=this.dataToPoint([o[1],u[1]]),l=o[1]-o[0],d=u[1]-u[0];if(!(!l||!d)){var f=(c[0]-s[0])/l,h=(c[1]-s[1])/d,v=s[0]-o[0]*f,g=s[1]-u[0]*h,b=this._transform=[f,0,0,h,v,g];this._invTransform=invert([],b)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var a=this.getAxis("x"),o=this.getAxis("y");return a.contain(a.toLocalCoord(r[0]))&&o.contain(o.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,a){var o=this.dataToPoint(r),u=this.dataToPoint(a),s=this.getArea(),c=new BoundingRect(o[0],o[1],u[0]-o[0],u[1]-o[1]);return s.intersect(c)},t.prototype.dataToPoint=function(r,a,o){o=o||[];var u=r[0],s=r[1];if(this._transform&&u!=null&&isFinite(u)&&s!=null&&isFinite(s))return applyTransform$1(o,r,this._transform);var c=this.getAxis("x"),l=this.getAxis("y");return o[0]=c.toGlobalCoord(c.dataToCoord(u,a)),o[1]=l.toGlobalCoord(l.dataToCoord(s,a)),o},t.prototype.clampData=function(r,a){var o=this.getAxis("x").scale,u=this.getAxis("y").scale,s=o.getExtent(),c=u.getExtent(),l=o.parse(r[0]),d=u.parse(r[1]);return a=a||[],a[0]=Math.min(Math.max(Math.min(s[0],s[1]),l),Math.max(s[0],s[1])),a[1]=Math.min(Math.max(Math.min(c[0],c[1]),d),Math.max(c[0],c[1])),a},t.prototype.pointToData=function(r,a){var o=[];if(this._invTransform)return applyTransform$1(o,r,this._invTransform);var u=this.getAxis("x"),s=this.getAxis("y");return o[0]=u.coordToData(u.toLocalCoord(r[0]),a),o[1]=s.coordToData(s.toLocalCoord(r[1]),a),o},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(r){r=r||0;var a=this.getAxis("x").getGlobalExtent(),o=this.getAxis("y").getGlobalExtent(),u=Math.min(a[0],a[1])-r,s=Math.min(o[0],o[1])-r,c=Math.max(a[0],a[1])-u+r,l=Math.max(o[0],o[1])-s+r;return new BoundingRect(u,s,c,l)},t}(Cartesian),Axis2D=function(n){__extends(t,n);function t(r,a,o,u,s){var c=n.call(this,r,a,o)||this;return c.index=0,c.type=u||"value",c.position=s||"bottom",c}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var a=this.getExtent();return a[0]=this.toGlobalCoord(a[0]),a[1]=this.toGlobalCoord(a[1]),r&&a[0]>a[1]&&a.reverse(),a},t.prototype.pointToData=function(r,a){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),a)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(Axis);function layout$4(n,t,r){r=r||{};var a=n.coordinateSystem,o=t.axis,u={},s=o.getAxesOnZeroOf()[0],c=o.position,l=s?"onZero":c,d=o.dim,f=a.getRect(),h=[f.x,f.x+f.width,f.y,f.y+f.height],v={left:0,right:1,top:0,bottom:1,onZero:2},g=t.get("offset")||0,b=d==="x"?[h[2]-g,h[3]+g]:[h[0]-g,h[1]+g];if(s){var _=s.toGlobalCoord(s.dataToCoord(0));b[v.onZero]=Math.max(Math.min(_,b[1]),b[0])}u.position=[d==="y"?b[v[l]]:h[0],d==="x"?b[v[l]]:h[3]],u.rotation=Math.PI/2*(d==="x"?0:1);var S={top:-1,bottom:1,left:-1,right:1};u.labelDirection=u.tickDirection=u.nameDirection=S[c],u.labelOffset=s?b[v[c]]-b[v.onZero]:0,t.get(["axisTick","inside"])&&(u.tickDirection=-u.tickDirection),retrieve(r.labelInside,t.get(["axisLabel","inside"]))&&(u.labelDirection=-u.labelDirection);var T=t.get(["axisLabel","rotate"]);return u.labelRotate=l==="top"?-T:T,u.z2=1,u}function isCartesian2DSeries(n){return n.get("coordinateSystem")==="cartesian2d"}function findAxisModels(n){var t={xAxisModel:null,yAxisModel:null};return each$f(t,function(r,a){var o=a.replace(/Model$/,""),u=n.getReferringComponents(o,SINGLE_REFERRING).models[0];t[a]=u}),t}var mathLog=Math.log;function alignScaleTicks(n,t,r){var a=IntervalScale.prototype,o=a.getTicks.call(r),u=a.getTicks.call(r,!0),s=o.length-1,c=a.getInterval.call(r),l=getScaleExtent(n,t),d=l.extent,f=l.fixMin,h=l.fixMax;if(n.type==="log"){var v=mathLog(n.base);d=[mathLog(d[0])/v,mathLog(d[1])/v]}n.setExtent(d[0],d[1]),n.calcNiceExtent({splitNumber:s,fixMin:f,fixMax:h});var g=a.getExtent.call(n);f&&(d[0]=g[0]),h&&(d[1]=g[1]);var b=a.getInterval.call(n),_=d[0],S=d[1];if(f&&h)b=(S-_)/s;else if(f)for(S=d[0]+b*s;S<d[1]&&isFinite(S)&&isFinite(d[1]);)b=increaseInterval(b),S=d[0]+b*s;else if(h)for(_=d[1]-b*s;_>d[0]&&isFinite(_)&&isFinite(d[0]);)b=increaseInterval(b),_=d[1]-b*s;else{var T=n.getTicks().length-1;T>s&&(b=increaseInterval(b));var w=b*s;S=Math.ceil(d[1]/b)*b,_=round$3(S-w),_<0&&d[0]>=0?(_=0,S=round$3(w)):S>0&&d[1]<=0&&(S=0,_=-round$3(w))}var A=(o[0].value-u[0].value)/c,R=(o[s].value-u[s].value)/c;a.setExtent.call(n,_+b*A,S+b*R),a.setInterval.call(n,b),(A||R)&&a.setNiceExtent.call(n,_+b,S-b)}var Grid=function(){function n(t,r,a){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=cartesian2DDimensions,this._initCartesian(t,r,a),this.model=t}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(t,r){var a=this._axesMap;this._updateScale(t,this.model);function o(s){var c,l=keys(s),d=l.length;if(d){for(var f=[],h=d-1;h>=0;h--){var v=+l[h],g=s[v],b=g.model,_=g.scale;isIntervalOrLogScale(_)&&b.get("alignTicks")&&b.get("interval")==null?f.push(g):(niceScaleExtent(_,b),isIntervalOrLogScale(_)&&(c=g))}f.length&&(c||(c=f.pop(),niceScaleExtent(c.scale,c.model)),each$f(f,function(S){alignScaleTicks(S.scale,S.model,c.scale)}))}}o(a.x),o(a.y);var u={};each$f(a.x,function(s){fixAxisOnZero(a,"y",s,u)}),each$f(a.y,function(s){fixAxisOnZero(a,"x",s,u)}),this.resize(this.model,r)},n.prototype.resize=function(t,r,a){var o=t.getBoxLayoutParams(),u=!a&&t.get("containLabel"),s=getLayoutRect(o,{width:r.getWidth(),height:r.getHeight()});this._rect=s;var c=this._axesList;l(),u&&(each$f(c,function(d){if(!d.model.get(["axisLabel","inside"])){var f=estimateLabelUnionRect(d);if(f){var h=d.isHorizontal()?"height":"width",v=d.model.get(["axisLabel","margin"]);s[h]-=f[h]+v,d.position==="top"?s.y+=f.height+v:d.position==="left"&&(s.x+=f.width+v)}}}),l()),each$f(this._coordsList,function(d){d.calcAffineTransform()});function l(){each$f(c,function(d){var f=d.isHorizontal(),h=f?[0,s.width]:[0,s.height],v=d.inverse?1:0;d.setExtent(h[v],h[1-v]),updateAxisTransform(d,f?s.x:s.y)})}},n.prototype.getAxis=function(t,r){var a=this._axesMap[t];if(a!=null)return a[r||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var a="x"+t+"y"+r;return this._coordsMap[a]}isObject$4(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var o=0,u=this._coordsList;o<u.length;o++)if(u[o].getAxis("x").index===t||u[o].getAxis("y").index===r)return u[o]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(t,r,a){var o=this._findConvertTarget(r);return o.cartesian?o.cartesian.dataToPoint(a):o.axis?o.axis.toGlobalCoord(o.axis.dataToCoord(a)):null},n.prototype.convertFromPixel=function(t,r,a){var o=this._findConvertTarget(r);return o.cartesian?o.cartesian.pointToData(a):o.axis?o.axis.coordToData(o.axis.toLocalCoord(a)):null},n.prototype._findConvertTarget=function(t){var r=t.seriesModel,a=t.xAxisModel||r&&r.getReferringComponents("xAxis",SINGLE_REFERRING).models[0],o=t.yAxisModel||r&&r.getReferringComponents("yAxis",SINGLE_REFERRING).models[0],u=t.gridModel,s=this._coordsList,c,l;if(r)c=r.coordinateSystem,indexOf(s,c)<0&&(c=null);else if(a&&o)c=this.getCartesian(a.componentIndex,o.componentIndex);else if(a)l=this.getAxis("x",a.componentIndex);else if(o)l=this.getAxis("y",o.componentIndex);else if(u){var d=u.coordinateSystem;d===this&&(c=this._coordsList[0])}return{cartesian:c,axis:l}},n.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},n.prototype._initCartesian=function(t,r,a){var o=this,u=this,s={left:!1,right:!1,top:!1,bottom:!1},c={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",d("x"),this),r.eachComponent("yAxis",d("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=c,each$f(c.x,function(f,h){each$f(c.y,function(v,g){var b="x"+h+"y"+g,_=new Cartesian2D(b);_.master=o,_.model=t,o._coordsMap[b]=_,o._coordsList.push(_),_.addAxis(f),_.addAxis(v)})});function d(f){return function(h,v){if(isAxisUsedInTheGrid(h,t)){var g=h.get("position");f==="x"?g!=="top"&&g!=="bottom"&&(g=s.bottom?"top":"bottom"):g!=="left"&&g!=="right"&&(g=s.left?"right":"left"),s[g]=!0;var b=new Axis2D(f,createScaleByModel$1(h),[0,0],h.get("type"),g),_=b.type==="category";b.onBand=_&&h.get("boundaryGap"),b.inverse=h.get("inverse"),h.axis=b,b.model=h,b.grid=u,b.index=v,u._axesList.push(b),c[f][v]=b,l[f]++}}}},n.prototype._updateScale=function(t,r){each$f(this._axesList,function(o){if(o.scale.setExtent(1/0,-1/0),o.type==="category"){var u=o.model.get("categorySortInfo");o.scale.setSortInfo(u)}}),t.eachSeries(function(o){if(isCartesian2DSeries(o)){var u=findAxisModels(o),s=u.xAxisModel,c=u.yAxisModel;if(!isAxisUsedInTheGrid(s,r)||!isAxisUsedInTheGrid(c,r))return;var l=this.getCartesian(s.componentIndex,c.componentIndex),d=o.getData(),f=l.getAxis("x"),h=l.getAxis("y");a(d,f),a(d,h)}},this);function a(o,u){each$f(getDataDimensionsOnAxis(o,u.dim),function(s){u.scale.unionExtentFromData(o,s)})}},n.prototype.getTooltipAxes=function(t){var r=[],a=[];return each$f(this.getCartesians(),function(o){var u=t!=null&&t!=="auto"?o.getAxis(t):o.getBaseAxis(),s=o.getOtherAxis(u);indexOf(r,u)<0&&r.push(u),indexOf(a,s)<0&&a.push(s)}),{baseAxes:r,otherAxes:a}},n.create=function(t,r){var a=[];return t.eachComponent("grid",function(o,u){var s=new n(o,t,r);s.name="grid_"+u,s.resize(o,r,!0),o.coordinateSystem=s,a.push(s)}),t.eachSeries(function(o){if(isCartesian2DSeries(o)){var u=findAxisModels(o),s=u.xAxisModel,c=u.yAxisModel,l=s.getCoordSysModel(),d=l.coordinateSystem;o.coordinateSystem=d.getCartesian(s.componentIndex,c.componentIndex)}}),a},n.dimensions=cartesian2DDimensions,n}();function isAxisUsedInTheGrid(n,t){return n.getCoordSysModel()===t}function fixAxisOnZero(n,t,r,a){r.getAxesOnZeroOf=function(){return u?[u]:[]};var o=n[t],u,s=r.model,c=s.get(["axisLine","onZero"]),l=s.get(["axisLine","onZeroAxisIndex"]);if(!c)return;if(l!=null)canOnZeroToAxis(o[l])&&(u=o[l]);else for(var d in o)if(o.hasOwnProperty(d)&&canOnZeroToAxis(o[d])&&!a[f(o[d])]){u=o[d];break}u&&(a[f(u)]=!0);function f(h){return h.dim+"_"+h.index}}function canOnZeroToAxis(n){return n&&n.type!=="category"&&n.type!=="time"&&ifAxisCrossZero(n)}function updateAxisTransform(n,t){var r=n.getExtent(),a=r[0]+r[1];n.toGlobalCoord=n.dim==="x"?function(o){return o+t}:function(o){return a-o+t},n.toLocalCoord=n.dim==="x"?function(o){return o-t}:function(o){return a-o+t}}var PI$3=Math.PI,AxisBuilder=function(){function n(t,r){this.group=new Group$3,this.opt=r,this.axisModel=t,defaults$h(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var a=new Group$3({x:r.position[0],y:r.position[1],rotation:r.rotation});a.updateTransform(),this._transformGroup=a}return n.prototype.hasBuilder=function(t){return!!builders[t]},n.prototype.add=function(t){builders[t](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(t,r,a){var o=remRadian(r-t),u,s;return isRadianAroundZero(o)?(s=a>0?"top":"bottom",u="center"):isRadianAroundZero(o-PI$3)?(s=a>0?"bottom":"top",u="center"):(s="middle",o>0&&o<PI$3?u=a>0?"right":"left":u=a>0?"left":"right"),{rotation:o,textAlign:u,textVerticalAlign:s}},n.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},n.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},n}(),builders={axisLine:function(n,t,r,a){var o=t.get(["axisLine","show"]);if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisLine")),!!o){var u=t.axis.getExtent(),s=a.transform,c=[u[0],0],l=[u[1],0],d=c[0]>l[0];s&&(applyTransform$1(c,c,s),applyTransform$1(l,l,s));var f=extend$1({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),h=new Line$1({shape:{x1:c[0],y1:c[1],x2:l[0],y2:l[1]},style:f,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});subPixelOptimizeLine(h.shape,h.style.lineWidth),h.anid="line",r.add(h);var v=t.get(["axisLine","symbol"]);if(v!=null){var g=t.get(["axisLine","symbolSize"]);isString(v)&&(v=[v,v]),(isString(g)||isNumber(g))&&(g=[g,g]);var b=normalizeSymbolOffset(t.get(["axisLine","symbolOffset"])||0,g),_=g[0],S=g[1];each$f([{rotate:n.rotation+Math.PI/2,offset:b[0],r:0},{rotate:n.rotation-Math.PI/2,offset:b[1],r:Math.sqrt((c[0]-l[0])*(c[0]-l[0])+(c[1]-l[1])*(c[1]-l[1]))}],function(T,w){if(v[w]!=="none"&&v[w]!=null){var A=createSymbol$1(v[w],-_/2,-S/2,_,S,f.stroke,!0),R=T.r+T.offset,E=d?l:c;A.attr({rotation:T.rotate,x:E[0]+R*Math.cos(n.rotation),y:E[1]-R*Math.sin(n.rotation),silent:!0,z2:11}),r.add(A)}})}}},axisTickLabel:function(n,t,r,a){var o=buildAxisMajorTicks(r,a,t,n),u=buildAxisLabel(r,a,t,n);if(fixMinMaxLabelShow(t,u,o),buildAxisMinorTicks(r,a,t,n.tickDirection),t.get(["axisLabel","hideOverlap"])){var s=prepareLayoutList(map$1(u,function(c){return{label:c,priority:c.z2,defaultAttr:{ignore:c.ignore}}}));hideOverlap(s)}},axisName:function(n,t,r,a){var o=retrieve(n.axisName,t.get("name"));if(o){var u=t.get("nameLocation"),s=n.nameDirection,c=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,d=t.axis.getExtent(),f=d[0]>d[1]?-1:1,h=[u==="start"?d[0]-f*l:u==="end"?d[1]+f*l:(d[0]+d[1])/2,isNameLocationCenter(u)?n.labelOffset+s*l:0],v,g=t.get("nameRotate");g!=null&&(g=g*PI$3/180);var b;isNameLocationCenter(u)?v=AxisBuilder.innerTextLayout(n.rotation,g??n.rotation,s):(v=endTextLayout(n.rotation,u,g||0,d),b=n.axisNameAvailableWidth,b!=null&&(b=Math.abs(b/Math.sin(v.rotation)),!isFinite(b)&&(b=null)));var _=c.getFont(),S=t.get("nameTruncate",!0)||{},T=S.ellipsis,w=retrieve(n.nameTruncateMaxWidth,S.maxWidth,b),A=new ZRText({x:h[0],y:h[1],rotation:v.rotation,silent:AxisBuilder.isLabelSilent(t),style:createTextStyle(c,{text:o,font:_,overflow:"truncate",width:w,ellipsis:T,fill:c.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:c.get("align")||v.textAlign,verticalAlign:c.get("verticalAlign")||v.textVerticalAlign}),z2:1});if(setTooltipConfig({el:A,componentModel:t,itemName:o}),A.__fullText=o,A.anid="name",t.get("triggerEvent")){var R=AxisBuilder.makeAxisEventDataBase(t);R.targetType="axisName",R.name=o,getECData(A).eventData=R}a.add(A),A.updateTransform(),r.add(A),A.decomposeTransform()}}};function endTextLayout(n,t,r,a){var o=remRadian(r-n),u,s,c=a[0]>a[1],l=t==="start"&&!c||t!=="start"&&c;return isRadianAroundZero(o-PI$3/2)?(s=l?"bottom":"top",u="center"):isRadianAroundZero(o-PI$3*1.5)?(s=l?"top":"bottom",u="center"):(s="middle",o<PI$3*1.5&&o>PI$3/2?u=l?"left":"right":u=l?"right":"left"),{rotation:o,textAlign:u,textVerticalAlign:s}}function fixMinMaxLabelShow(n,t,r){if(!shouldShowAllLabels(n.axis)){var a=n.get(["axisLabel","showMinLabel"]),o=n.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var u=t[0],s=t[1],c=t[t.length-1],l=t[t.length-2],d=r[0],f=r[1],h=r[r.length-1],v=r[r.length-2];a===!1?(ignoreEl(u),ignoreEl(d)):isTwoLabelOverlapped(u,s)&&(a?(ignoreEl(s),ignoreEl(f)):(ignoreEl(u),ignoreEl(d))),o===!1?(ignoreEl(c),ignoreEl(h)):isTwoLabelOverlapped(l,c)&&(o?(ignoreEl(l),ignoreEl(v)):(ignoreEl(c),ignoreEl(h)))}}function ignoreEl(n){n&&(n.ignore=!0)}function isTwoLabelOverlapped(n,t){var r=n&&n.getBoundingRect().clone(),a=t&&t.getBoundingRect().clone();if(!(!r||!a)){var o=identity$2([]);return rotate$1(o,o,-n.rotation),r.applyTransform(mul([],o,n.getLocalTransform())),a.applyTransform(mul([],o,t.getLocalTransform())),r.intersect(a)}}function isNameLocationCenter(n){return n==="middle"||n==="center"}function createTicks(n,t,r,a,o){for(var u=[],s=[],c=[],l=0;l<n.length;l++){var d=n[l].coord;s[0]=d,s[1]=0,c[0]=d,c[1]=r,t&&(applyTransform$1(s,s,t),applyTransform$1(c,c,t));var f=new Line$1({shape:{x1:s[0],y1:s[1],x2:c[0],y2:c[1]},style:a,z2:2,autoBatch:!0,silent:!0});subPixelOptimizeLine(f.shape,f.style.lineWidth),f.anid=o+"_"+n[l].tickValue,u.push(f)}return u}function buildAxisMajorTicks(n,t,r,a){var o=r.axis,u=r.getModel("axisTick"),s=u.get("show");if(s==="auto"&&a.handleAutoShown&&(s=a.handleAutoShown("axisTick")),!(!s||o.scale.isBlank())){for(var c=u.getModel("lineStyle"),l=a.tickDirection*u.get("length"),d=o.getTicksCoords(),f=createTicks(d,t.transform,l,defaults$h(c.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),h=0;h<f.length;h++)n.add(f[h]);return f}}function buildAxisMinorTicks(n,t,r,a){var o=r.axis,u=r.getModel("minorTick");if(!(!u.get("show")||o.scale.isBlank())){var s=o.getMinorTicksCoords();if(s.length)for(var c=u.getModel("lineStyle"),l=a*u.get("length"),d=defaults$h(c.getLineStyle(),defaults$h(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),f=0;f<s.length;f++)for(var h=createTicks(s[f],t.transform,l,d,"minorticks_"+f),v=0;v<h.length;v++)n.add(h[v])}}function buildAxisLabel(n,t,r,a){var o=r.axis,u=retrieve(a.axisLabelShow,r.get(["axisLabel","show"]));if(!(!u||o.scale.isBlank())){var s=r.getModel("axisLabel"),c=s.get("margin"),l=o.getViewLabels(),d=(retrieve(a.labelRotate,s.get("rotate"))||0)*PI$3/180,f=AxisBuilder.innerTextLayout(a.rotation,d,a.labelDirection),h=r.getCategories&&r.getCategories(!0),v=[],g=AxisBuilder.isLabelSilent(r),b=r.get("triggerEvent");return each$f(l,function(_,S){var T=o.scale.type==="ordinal"?o.scale.getRawOrdinalNumber(_.tickValue):_.tickValue,w=_.formattedLabel,A=_.rawLabel,R=s;if(h&&h[T]){var E=h[T];isObject$4(E)&&E.textStyle&&(R=new Model(E.textStyle,s,r.ecModel))}var I=R.getTextColor()||r.get(["axisLine","lineStyle","color"]),L=o.dataToCoord(T),F=R.getShallow("align",!0)||f.textAlign,D=retrieve2(R.getShallow("alignMinLabel",!0),F),$=retrieve2(R.getShallow("alignMaxLabel",!0),F),O=R.getShallow("verticalAlign",!0)||R.getShallow("baseline",!0)||f.textVerticalAlign,P=retrieve2(R.getShallow("verticalAlignMinLabel",!0),O),C=retrieve2(R.getShallow("verticalAlignMaxLabel",!0),O),q=new ZRText({x:L,y:a.labelOffset+a.labelDirection*c,rotation:f.rotation,silent:g,z2:10+(_.level||0),style:createTextStyle(R,{text:w,align:S===0?D:S===l.length-1?$:F,verticalAlign:S===0?P:S===l.length-1?C:O,fill:isFunction$1(I)?I(o.type==="category"?A:o.type==="value"?T+"":T,S):I})});if(q.anid="label_"+T,setTooltipConfig({el:q,componentModel:r,itemName:w,formatterParamsExtra:{isTruncated:function(){return q.isTruncated},value:A,tickIndex:S}}),b){var M=AxisBuilder.makeAxisEventDataBase(r);M.targetType="axisLabel",M.value=A,M.tickIndex=S,o.type==="category"&&(M.dataIndex=T),getECData(q).eventData=M}t.add(q),q.updateTransform(),v.push(q),n.add(q),q.decomposeTransform()}),v}}function collect(n,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return collectAxesInfo(r,n,t),r.seriesInvolved&&collectSeriesInfo(r,n),r}function collectAxesInfo(n,t,r){var a=t.getComponent("tooltip"),o=t.getComponent("axisPointer"),u=o.get("link",!0)||[],s=[];each$f(r.getCoordinateSystems(),function(c){if(!c.axisPointerEnabled)return;var l=makeKey(c.model),d=n.coordSysAxesInfo[l]={};n.coordSysMap[l]=c;var f=c.model,h=f.getModel("tooltip",a);if(each$f(c.getAxes(),curry$1(_,!1,null)),c.getTooltipAxes&&a&&h.get("show")){var v=h.get("trigger")==="axis",g=h.get(["axisPointer","type"])==="cross",b=c.getTooltipAxes(h.get(["axisPointer","axis"]));(v||g)&&each$f(b.baseAxes,curry$1(_,g?"cross":!0,v)),g&&each$f(b.otherAxes,curry$1(_,"cross",!1))}function _(S,T,w){var A=w.model.getModel("axisPointer",o),R=A.get("show");if(!(!R||R==="auto"&&!S&&!isHandleTrigger(A))){T==null&&(T=A.get("triggerTooltip")),A=S?makeAxisPointerModel(w,h,o,t,S,T):A;var E=A.get("snap"),I=A.get("triggerEmphasis"),L=makeKey(w.model),F=T||E||w.type==="category",D=n.axesInfo[L]={key:L,axis:w,coordSys:c,axisPointerModel:A,triggerTooltip:T,triggerEmphasis:I,involveSeries:F,snap:E,useHandle:isHandleTrigger(A),seriesModels:[],linkGroup:null};d[L]=D,n.seriesInvolved=n.seriesInvolved||F;var $=getLinkGroupIndex(u,w);if($!=null){var O=s[$]||(s[$]={axesInfo:{}});O.axesInfo[L]=D,O.mapper=u[$].mapper,D.linkGroup=O}}}})}function makeAxisPointerModel(n,t,r,a,o,u){var s=t.getModel("axisPointer"),c=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};each$f(c,function(v){l[v]=clone$5(s.get(v))}),l.snap=n.type!=="category"&&!!u,s.get("type")==="cross"&&(l.type="line");var d=l.label||(l.label={});if(d.show==null&&(d.show=!1),o==="cross"){var f=s.get(["label","show"]);if(d.show=f??!0,!u){var h=l.lineStyle=s.get("crossStyle");h&&defaults$h(d,h.textStyle)}}return n.model.getModel("axisPointer",new Model(l,r,a))}function collectSeriesInfo(n,t){t.eachSeries(function(r){var a=r.coordinateSystem,o=r.get(["tooltip","trigger"],!0),u=r.get(["tooltip","show"],!0);!a||o==="none"||o===!1||o==="item"||u===!1||r.get(["axisPointer","show"],!0)===!1||each$f(n.coordSysAxesInfo[makeKey(a.model)],function(s){var c=s.axis;a.getAxis(c.dim)===c&&(s.seriesModels.push(r),s.seriesDataCount==null&&(s.seriesDataCount=0),s.seriesDataCount+=r.getData().count())})})}function getLinkGroupIndex(n,t){for(var r=t.model,a=t.dim,o=0;o<n.length;o++){var u=n[o]||{};if(checkPropInLink(u[a+"AxisId"],r.id)||checkPropInLink(u[a+"AxisIndex"],r.componentIndex)||checkPropInLink(u[a+"AxisName"],r.name))return o}}function checkPropInLink(n,t){return n==="all"||isArray$2(n)&&indexOf(n,t)>=0||n===t}function fixValue(n){var t=getAxisInfo$1(n);if(t){var r=t.axisPointerModel,a=t.axis.scale,o=r.option,u=r.get("status"),s=r.get("value");s!=null&&(s=a.parse(s));var c=isHandleTrigger(r);u==null&&(o.status=c?"show":"hide");var l=a.getExtent().slice();l[0]>l[1]&&l.reverse(),(s==null||s>l[1])&&(s=l[1]),s<l[0]&&(s=l[0]),o.value=s,c&&(o.status=t.axis.scale.isBlank()?"hide":"show")}}function getAxisInfo$1(n){var t=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[makeKey(n)]}function getAxisPointerModel(n){var t=getAxisInfo$1(n);return t&&t.axisPointerModel}function isHandleTrigger(n){return!!n.get(["handle","show"])}function makeKey(n){return n.type+"||"+n.id}var axisPointerClazz={},AxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o,u){this.axisPointerClass&&fixValue(r),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,o,!0)},t.prototype.updateAxisPointer=function(r,a,o,u){this._doUpdateAxisPointerClass(r,o,!1)},t.prototype.remove=function(r,a){var o=this._axisPointer;o&&o.remove(a)},t.prototype.dispose=function(r,a){this._disposeAxisPointer(a),n.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,a,o){var u=t.getAxisPointerClass(this.axisPointerClass);if(u){var s=getAxisPointerModel(r);s?(this._axisPointer||(this._axisPointer=new u)).render(r,s,a,o):this._disposeAxisPointer(a)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,a){axisPointerClazz[r]=a},t.getAxisPointerClass=function(r){return r&&axisPointerClazz[r]},t.type="axis",t}(ComponentView),inner$f=makeInner();function rectCoordAxisBuildSplitArea(n,t,r,a){var o=r.axis;if(!o.scale.isBlank()){var u=r.getModel("splitArea"),s=u.getModel("areaStyle"),c=s.get("color"),l=a.coordinateSystem.getRect(),d=o.getTicksCoords({tickModel:u,clamp:!0});if(d.length){var f=c.length,h=inner$f(n).splitAreaColors,v=createHashMap(),g=0;if(h)for(var b=0;b<d.length;b++){var _=h.get(d[b].tickValue);if(_!=null){g=(_+(f-1)*b)%f;break}}var S=o.toGlobalCoord(d[0].coord),T=s.getAreaStyle();c=isArray$2(c)?c:[c];for(var b=1;b<d.length;b++){var w=o.toGlobalCoord(d[b].coord),A=void 0,R=void 0,E=void 0,I=void 0;o.isHorizontal()?(A=S,R=l.y,E=w-A,I=l.height,S=A+E):(A=l.x,R=S,E=l.width,I=w-R,S=R+I);var L=d[b-1].tickValue;L!=null&&v.set(L,g),t.add(new Rect$2({anid:L!=null?"area_"+L:null,shape:{x:A,y:R,width:E,height:I},style:defaults$h({fill:c[g]},T),autoBatch:!0,silent:!0})),g=(g+1)%f}inner$f(n).splitAreaColors=v}}}function rectCoordAxisHandleRemove(n){inner$f(n).splitAreaColors=null}var axisBuilderAttrs$3=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs$2=["splitArea","splitLine","minorSplitLine"],CartesianAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,a,o,u){this.group.removeAll();var s=this._axisGroup;if(this._axisGroup=new Group$3,this.group.add(this._axisGroup),!!r.get("show")){var c=r.getCoordSysModel(),l=layout$4(c,r),d=new AxisBuilder(r,extend$1({handleAutoShown:function(h){for(var v=c.coordinateSystem.getCartesians(),g=0;g<v.length;g++)if(isIntervalOrLogScale(v[g].getOtherAxis(r.axis).scale))return!0;return!1}},l));each$f(axisBuilderAttrs$3,d.add,d),this._axisGroup.add(d.getGroup()),each$f(selfBuilderAttrs$2,function(h){r.get([h,"show"])&&axisElementBuilders$2[h](this,this._axisGroup,r,c)},this);var f=u&&u.type==="changeAxisOrder"&&u.isInitSort;f||groupTransition(s,this._axisGroup,r),n.prototype.render.call(this,r,a,o,u)}},t.prototype.remove=function(){rectCoordAxisHandleRemove(this)},t.type="cartesianAxis",t}(AxisView),axisElementBuilders$2={splitLine:function(n,t,r,a){var o=r.axis;if(!o.scale.isBlank()){var u=r.getModel("splitLine"),s=u.getModel("lineStyle"),c=s.get("color"),l=u.get("showMinLine")!==!1,d=u.get("showMaxLine")!==!1;c=isArray$2(c)?c:[c];for(var f=a.coordinateSystem.getRect(),h=o.isHorizontal(),v=0,g=o.getTicksCoords({tickModel:u}),b=[],_=[],S=s.getLineStyle(),T=0;T<g.length;T++){var w=o.toGlobalCoord(g[T].coord);if(!(T===0&&!l||T===g.length-1&&!d)){var A=g[T].tickValue;h?(b[0]=w,b[1]=f.y,_[0]=w,_[1]=f.y+f.height):(b[0]=f.x,b[1]=w,_[0]=f.x+f.width,_[1]=w);var R=v++%c.length,E=new Line$1({anid:A!=null?"line_"+A:null,autoBatch:!0,shape:{x1:b[0],y1:b[1],x2:_[0],y2:_[1]},style:defaults$h({stroke:c[R]},S),silent:!0});subPixelOptimizeLine(E.shape,S.lineWidth),t.add(E)}}}},minorSplitLine:function(n,t,r,a){var o=r.axis,u=r.getModel("minorSplitLine"),s=u.getModel("lineStyle"),c=a.coordinateSystem.getRect(),l=o.isHorizontal(),d=o.getMinorTicksCoords();if(d.length)for(var f=[],h=[],v=s.getLineStyle(),g=0;g<d.length;g++)for(var b=0;b<d[g].length;b++){var _=o.toGlobalCoord(d[g][b].coord);l?(f[0]=_,f[1]=c.y,h[0]=_,h[1]=c.y+c.height):(f[0]=c.x,f[1]=_,h[0]=c.x+c.width,h[1]=_);var S=new Line$1({anid:"minor_line_"+d[g][b].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:h[0],y2:h[1]},style:v,silent:!0});subPixelOptimizeLine(S.shape,v.lineWidth),t.add(S)}},splitArea:function(n,t,r,a){rectCoordAxisBuildSplitArea(n,t,r,a)}},CartesianXAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(CartesianAxisView),CartesianYAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=CartesianXAxisView.type,r}return t.type="yAxis",t}(CartesianAxisView),GridView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,a){this.group.removeAll(),r.get("show")&&this.group.add(new Rect$2({shape:r.coordinateSystem.getRect(),style:defaults$h({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(ComponentView),extraOption={offset:0};function install$N(n){n.registerComponentView(GridView),n.registerComponentModel(GridModel),n.registerCoordinateSystem("cartesian2d",Grid),axisModelCreator(n,"x",CartesianAxisModel,extraOption),axisModelCreator(n,"y",CartesianAxisModel,extraOption),n.registerComponentView(CartesianXAxisView),n.registerComponentView(CartesianYAxisView),n.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}function install$M(n){use(install$N),n.registerSeriesModel(ScatterSeriesModel),n.registerChartView(ScatterView),n.registerLayout(pointsLayout("scatter"))}function radarLayout(n){n.eachSeriesByType("radar",function(t){var r=t.getData(),a=[],o=t.coordinateSystem;if(o){var u=o.getIndicatorAxes();each$f(u,function(s,c){r.each(r.mapDimension(u[c].dim),function(l,d){a[d]=a[d]||[];var f=o.dataToPoint(l,c);a[d][c]=isValidPoint(f)?f:getValueMissingPoint(o)})}),r.each(function(s){var c=find(a[s],function(l){return isValidPoint(l)})||getValueMissingPoint(o);a[s].push(c.slice()),r.setItemLayout(s,a[s])})}})}function isValidPoint(n){return!isNaN(n[0])&&!isNaN(n[1])}function getValueMissingPoint(n){return[n.cx,n.cy]}function radarBackwardCompat(n){var t=n.polar;if(t){isArray$2(t)||(t=[t]);var r=[];each$f(t,function(a,o){a.indicator?(a.type&&!a.shape&&(a.shape=a.type),n.radar=n.radar||[],isArray$2(n.radar)||(n.radar=[n.radar]),n.radar.push(a)):r.push(a)}),n.polar=r}each$f(n.series,function(a){a&&a.type==="radar"&&a.polarIndex&&(a.radarIndex=a.polarIndex)})}var RadarView$1=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=r.coordinateSystem,s=this.group,c=r.getData(),l=this._data;function d(v,g){var b=v.getItemVisual(g,"symbol")||"circle";if(b!=="none"){var _=normalizeSymbolSize(v.getItemVisual(g,"symbolSize")),S=createSymbol$1(b,-1,-1,2,2),T=v.getItemVisual(g,"symbolRotate")||0;return S.attr({style:{strokeNoScale:!0},z2:100,scaleX:_[0]/2,scaleY:_[1]/2,rotation:T*Math.PI/180||0}),S}}function f(v,g,b,_,S,T){b.removeAll();for(var w=0;w<g.length-1;w++){var A=d(_,S);A&&(A.__dimIdx=w,v[w]?(A.setPosition(v[w]),graphic[T?"initProps":"updateProps"](A,{x:g[w][0],y:g[w][1]},r,S)):A.setPosition(g[w]),b.add(A))}}function h(v){return map$1(v,function(g){return[u.cx,u.cy]})}c.diff(l).add(function(v){var g=c.getItemLayout(v);if(g){var b=new Polygon,_=new Polyline$1,S={shape:{points:g}};b.shape.points=h(g),_.shape.points=h(g),initProps(b,S,r,v),initProps(_,S,r,v);var T=new Group$3,w=new Group$3;T.add(_),T.add(b),T.add(w),f(_.shape.points,g,w,c,v,!0),c.setItemGraphicEl(v,T)}}).update(function(v,g){var b=l.getItemGraphicEl(g),_=b.childAt(0),S=b.childAt(1),T=b.childAt(2),w={shape:{points:c.getItemLayout(v)}};w.shape.points&&(f(_.shape.points,w.shape.points,T,c,v,!1),saveOldStyle(S),saveOldStyle(_),updateProps$1(_,w,r),updateProps$1(S,w,r),c.setItemGraphicEl(v,b))}).remove(function(v){s.remove(l.getItemGraphicEl(v))}).execute(),c.eachItemGraphicEl(function(v,g){var b=c.getItemModel(g),_=v.childAt(0),S=v.childAt(1),T=v.childAt(2),w=c.getItemVisual(g,"style"),A=w.fill;s.add(v),_.useStyle(defaults$h(b.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:A})),setStatesStylesFromModel(_,b,"lineStyle"),setStatesStylesFromModel(S,b,"areaStyle");var R=b.getModel("areaStyle"),E=R.isEmpty()&&R.parentModel.isEmpty();S.ignore=E,each$f(["emphasis","select","blur"],function(F){var D=b.getModel([F,"areaStyle"]),$=D.isEmpty()&&D.parentModel.isEmpty();S.ensureState(F).ignore=$&&E}),S.useStyle(defaults$h(R.getAreaStyle(),{fill:A,opacity:.7,decal:w.decal}));var I=b.getModel("emphasis"),L=I.getModel("itemStyle").getItemStyle();T.eachChild(function(F){if(F instanceof ZRImage){var D=F.style;F.useStyle(extend$1({image:D.image,x:D.x,y:D.y,width:D.width,height:D.height},w))}else F.useStyle(w),F.setColor(A),F.style.strokeNoScale=!0;var $=F.ensureState("emphasis");$.style=clone$5(L);var O=c.getStore().get(c.getDimensionIndex(F.__dimIdx),g);(O==null||isNaN(O))&&(O=""),setLabelStyle(F,getLabelStatesModels(b),{labelFetcher:c.hostModel,labelDataIndex:g,labelDimIndex:F.__dimIdx,defaultText:O,inheritColor:A,defaultOpacity:w.opacity})}),toggleHoverEmphasis(v,I.get("focus"),I.get("blurScope"),I.get("disabled"))}),this._data=c},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.type="radar",t}(ChartView),RadarSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this))},t.prototype.getInitialData=function(r,a){return createSeriesDataSimply(this,{generateCoord:"indicator_",generateCoordCount:1/0})},t.prototype.formatTooltip=function(r,a,o){var u=this.getData(),s=this.coordinateSystem,c=s.getIndicatorAxes(),l=this.getData().getName(r),d=l===""?this.name:l,f=retrieveVisualColorForTooltipMarker(this,r);return createTooltipMarkup("section",{header:d,sortBlocks:!0,blocks:map$1(c,function(h){var v=u.get(u.mapDimension(h.dim),r);return createTooltipMarkup("nameValue",{markerType:"subItem",markerColor:f,name:h.name,value:v,sortParam:v})})})},t.prototype.getTooltipPosition=function(r){if(r!=null){for(var a=this.getData(),o=this.coordinateSystem,u=a.getValues(map$1(o.dimensions,function(d){return a.mapDimension(d)}),r),s=0,c=u.length;s<c;s++)if(!isNaN(u[s])){var l=o.getIndicatorAxes();return o.coordToPoint(l[s].dataToCoord(u[s]),s)}}},t.type="series.radar",t.dependencies=["radar"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},t}(SeriesModel),valueAxisDefault=axisDefault.value;function defaultsShow(n,t){return defaults$h({show:t},n)}var RadarModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){var r=this.get("boundaryGap"),a=this.get("splitNumber"),o=this.get("scale"),u=this.get("axisLine"),s=this.get("axisTick"),c=this.get("axisLabel"),l=this.get("axisName"),d=this.get(["axisName","show"]),f=this.get(["axisName","formatter"]),h=this.get("axisNameGap"),v=this.get("triggerEvent"),g=map$1(this.get("indicator")||[],function(b){b.max!=null&&b.max>0&&!b.min?b.min=0:b.min!=null&&b.min<0&&!b.max&&(b.max=0);var _=l;b.color!=null&&(_=defaults$h({color:b.color},l));var S=merge$3(clone$5(b),{boundaryGap:r,splitNumber:a,scale:o,axisLine:u,axisTick:s,axisLabel:c,name:b.text,showName:d,nameLocation:"end",nameGap:h,nameTextStyle:_,triggerEvent:v},!1);if(isString(f)){var T=S.name;S.name=f.replace("{value}",T??"")}else isFunction$1(f)&&(S.name=f(S.name,S));var w=new Model(S,null,this.ecModel);return mixin$1(w,AxisModelCommonMixin.prototype),w.mainType="radar",w.componentIndex=this.componentIndex,w},this);this._indicatorModels=g},t.prototype.getIndicatorModels=function(){return this._indicatorModels},t.type="radar",t.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:merge$3({lineStyle:{color:"#bbb"}},valueAxisDefault.axisLine),axisLabel:defaultsShow(valueAxisDefault.axisLabel,!1),axisTick:defaultsShow(valueAxisDefault.axisTick,!1),splitLine:defaultsShow(valueAxisDefault.splitLine,!0),splitArea:defaultsShow(valueAxisDefault.splitArea,!0),indicator:[]},t}(ComponentModel),axisBuilderAttrs$2=["axisLine","axisTickLabel","axisName"],RadarView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=this.group;u.removeAll(),this._buildAxes(r),this._buildSplitLineAndArea(r)},t.prototype._buildAxes=function(r){var a=r.coordinateSystem,o=a.getIndicatorAxes(),u=map$1(o,function(s){var c=s.model.get("showName")?s.name:"",l=new AxisBuilder(s.model,{axisName:c,position:[a.cx,a.cy],rotation:s.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return l});each$f(u,function(s){each$f(axisBuilderAttrs$2,s.add,s),this.group.add(s.getGroup())},this)},t.prototype._buildSplitLineAndArea=function(r){var a=r.coordinateSystem,o=a.getIndicatorAxes();if(!o.length)return;var u=r.get("shape"),s=r.getModel("splitLine"),c=r.getModel("splitArea"),l=s.getModel("lineStyle"),d=c.getModel("areaStyle"),f=s.get("show"),h=c.get("show"),v=l.get("color"),g=d.get("color"),b=isArray$2(v)?v:[v],_=isArray$2(g)?g:[g],S=[],T=[];function w(M,N,G){var X=G%N.length;return M[X]=M[X]||[],X}if(u==="circle")for(var A=o[0].getTicksCoords(),R=a.cx,E=a.cy,I=0;I<A.length;I++){if(f){var L=w(S,b,I);S[L].push(new Circle({shape:{cx:R,cy:E,r:A[I].coord}}))}if(h&&I<A.length-1){var L=w(T,_,I);T[L].push(new Ring({shape:{cx:R,cy:E,r0:A[I].coord,r:A[I+1].coord}}))}}else for(var F,D=map$1(o,function(M,N){var G=M.getTicksCoords();return F=F==null?G.length-1:Math.min(G.length-1,F),map$1(G,function(X){return a.coordToPoint(X.coord,N)})}),$=[],I=0;I<=F;I++){for(var O=[],P=0;P<o.length;P++)O.push(D[P][I]);if(O[0]&&O.push(O[0].slice()),f){var L=w(S,b,I);S[L].push(new Polyline$1({shape:{points:O}}))}if(h&&$){var L=w(T,_,I-1);T[L].push(new Polygon({shape:{points:O.concat($)}}))}$=O.slice().reverse()}var C=l.getLineStyle(),q=d.getAreaStyle();each$f(T,function(M,N){this.group.add(mergePath(M,{style:defaults$h({stroke:"none",fill:_[N%_.length]},q),silent:!0}))},this),each$f(S,function(M,N){this.group.add(mergePath(M,{style:defaults$h({fill:"none",stroke:b[N%b.length]},C),silent:!0}))},this)},t.type="radar",t}(ComponentView),IndicatorAxis=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this,r,a,o)||this;return u.type="value",u.angle=0,u.name="",u}return t}(Axis),Radar=function(){function n(t,r,a){this.dimensions=[],this._model=t,this._indicatorAxes=map$1(t.getIndicatorModels(),function(o,u){var s="indicator_"+u,c=new IndicatorAxis(s,new IntervalScale);return c.name=o.get("name"),c.model=o,o.axis=c,this.dimensions.push(s),c},this),this.resize(t,a)}return n.prototype.getIndicatorAxes=function(){return this._indicatorAxes},n.prototype.dataToPoint=function(t,r){var a=this._indicatorAxes[r];return this.coordToPoint(a.dataToCoord(t),r)},n.prototype.coordToPoint=function(t,r){var a=this._indicatorAxes[r],o=a.angle,u=this.cx+t*Math.cos(o),s=this.cy-t*Math.sin(o);return[u,s]},n.prototype.pointToData=function(t){var r=t[0]-this.cx,a=t[1]-this.cy,o=Math.sqrt(r*r+a*a);r/=o,a/=o;for(var u=Math.atan2(-a,r),s=1/0,c,l=-1,d=0;d<this._indicatorAxes.length;d++){var f=this._indicatorAxes[d],h=Math.abs(u-f.angle);h<s&&(c=f,l=d,s=h)}return[l,+(c&&c.coordToData(o))]},n.prototype.resize=function(t,r){var a=t.get("center"),o=r.getWidth(),u=r.getHeight(),s=Math.min(o,u)/2;this.cx=parsePercent(a[0],o),this.cy=parsePercent(a[1],u),this.startAngle=t.get("startAngle")*Math.PI/180;var c=t.get("radius");(isString(c)||isNumber(c))&&(c=[0,c]),this.r0=parsePercent(c[0],s),this.r=parsePercent(c[1],s),each$f(this._indicatorAxes,function(l,d){l.setExtent(this.r0,this.r);var f=this.startAngle+d*Math.PI*2/this._indicatorAxes.length;f=Math.atan2(Math.sin(f),Math.cos(f)),l.angle=f},this)},n.prototype.update=function(t,r){var a=this._indicatorAxes,o=this._model;each$f(a,function(c){c.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(c,l){if(!(c.get("coordinateSystem")!=="radar"||t.getComponent("radar",c.get("radarIndex"))!==o)){var d=c.getData();each$f(a,function(f){f.scale.unionExtentFromData(d,d.mapDimension(f.dim))})}},this);var u=o.get("splitNumber"),s=new IntervalScale;s.setExtent(0,u),s.setInterval(1),each$f(a,function(c,l){alignScaleTicks(c.scale,c.model,s)})},n.prototype.convertToPixel=function(t,r,a){return console.warn("Not implemented."),null},n.prototype.convertFromPixel=function(t,r,a){return console.warn("Not implemented."),null},n.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},n.create=function(t,r){var a=[];return t.eachComponent("radar",function(o){var u=new n(o,t,r);a.push(u),o.coordinateSystem=u}),t.eachSeriesByType("radar",function(o){o.get("coordinateSystem")==="radar"&&(o.coordinateSystem=a[o.get("radarIndex")||0])}),a},n.dimensions=[],n}();function install$L(n){n.registerCoordinateSystem("radar",Radar),n.registerComponentModel(RadarModel),n.registerComponentView(RadarView),n.registerVisual({seriesType:"radar",reset:function(t){var r=t.getData();r.each(function(a){r.setItemVisual(a,"legendIcon","roundRect")}),r.setVisual("legendIcon","roundRect")}})}function install$K(n){use(install$L),n.registerChartView(RadarView$1),n.registerSeriesModel(RadarSeriesModel),n.registerLayout(radarLayout),n.registerProcessor(dataFilter$1("radar")),n.registerPreprocessor(radarBackwardCompat)}var ATTR="\0_ec_interaction_mutex";function take(n,t,r){var a=getStore(n);a[t]=r}function release(n,t,r){var a=getStore(n),o=a[t];o===r&&(a[t]=null)}function isTaken(n,t){return!!getStore(n)[t]}function getStore(n){return n[ATTR]||(n[ATTR]={})}registerAction({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},noop$3);var RoamController=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;a._zr=r;var o=bind$1(a._mousedownHandler,a),u=bind$1(a._mousemoveHandler,a),s=bind$1(a._mouseupHandler,a),c=bind$1(a._mousewheelHandler,a),l=bind$1(a._pinchHandler,a);return a.enable=function(d,f){this.disable(),this._opt=defaults$h(clone$5(f)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),d==null&&(d=!0),(d===!0||d==="move"||d==="pan")&&(r.on("mousedown",o),r.on("mousemove",u),r.on("mouseup",s)),(d===!0||d==="scale"||d==="zoom")&&(r.on("mousewheel",c),r.on("pinch",l))},a.disable=function(){r.off("mousedown",o),r.off("mousemove",u),r.off("mouseup",s),r.off("mousewheel",c),r.off("pinch",l)},a}return t.prototype.isDragging=function(){return this._dragging},t.prototype.isPinching=function(){return this._pinching},t.prototype.setPointerChecker=function(r){this.pointerChecker=r},t.prototype.dispose=function(){this.disable()},t.prototype._mousedownHandler=function(r){if(!isMiddleOrRightButtonOnMouseUpDown(r)){for(var a=r.target;a;){if(a.draggable)return;a=a.__hostTarget||a.parent}var o=r.offsetX,u=r.offsetY;this.pointerChecker&&this.pointerChecker(r,o,u)&&(this._x=o,this._y=u,this._dragging=!0)}},t.prototype._mousemoveHandler=function(r){if(!(!this._dragging||!isAvailableBehavior("moveOnMouseMove",r,this._opt)||r.gestureEvent==="pinch"||isTaken(this._zr,"globalPan"))){var a=r.offsetX,o=r.offsetY,u=this._x,s=this._y,c=a-u,l=o-s;this._x=a,this._y=o,this._opt.preventDefaultMouseMove&&stop(r.event),trigger$1(this,"pan","moveOnMouseMove",r,{dx:c,dy:l,oldX:u,oldY:s,newX:a,newY:o,isAvailableBehavior:null})}},t.prototype._mouseupHandler=function(r){isMiddleOrRightButtonOnMouseUpDown(r)||(this._dragging=!1)},t.prototype._mousewheelHandler=function(r){var a=isAvailableBehavior("zoomOnMouseWheel",r,this._opt),o=isAvailableBehavior("moveOnMouseWheel",r,this._opt),u=r.wheelDelta,s=Math.abs(u),c=r.offsetX,l=r.offsetY;if(!(u===0||!a&&!o)){if(a){var d=s>3?1.4:s>1?1.2:1.1,f=u>0?d:1/d;checkPointerAndTrigger(this,"zoom","zoomOnMouseWheel",r,{scale:f,originX:c,originY:l,isAvailableBehavior:null})}if(o){var h=Math.abs(u),v=(u>0?1:-1)*(h>3?.4:h>1?.15:.05);checkPointerAndTrigger(this,"scrollMove","moveOnMouseWheel",r,{scrollDelta:v,originX:c,originY:l,isAvailableBehavior:null})}}},t.prototype._pinchHandler=function(r){if(!isTaken(this._zr,"globalPan")){var a=r.pinchScale>1?1.1:1/1.1;checkPointerAndTrigger(this,"zoom",null,r,{scale:a,originX:r.pinchX,originY:r.pinchY,isAvailableBehavior:null})}},t}(Eventful);function checkPointerAndTrigger(n,t,r,a,o){n.pointerChecker&&n.pointerChecker(a,o.originX,o.originY)&&(stop(a.event),trigger$1(n,t,r,a,o))}function trigger$1(n,t,r,a,o){o.isAvailableBehavior=bind$1(isAvailableBehavior,null,r,a),n.trigger(t,o)}function isAvailableBehavior(n,t,r){var a=r[n];return!n||a&&(!isString(a)||t.event[a+"Key"])}function updateViewOnPan(n,t,r){var a=n.target;a.x+=t,a.y+=r,a.dirty()}function updateViewOnZoom(n,t,r,a){var o=n.target,u=n.zoomLimit,s=n.zoom=n.zoom||1;if(s*=t,u){var c=u.min||0,l=u.max||1/0;s=Math.max(Math.min(l,s),c)}var d=s/n.zoom;n.zoom=s,o.x-=(r-o.x)*(d-1),o.y-=(a-o.y)*(d-1),o.scaleX*=d,o.scaleY*=d,o.dirty()}var IRRELEVANT_EXCLUDES={axisPointer:1,tooltip:1,brush:1};function onIrrelevantElement(n,t,r){var a=t.getComponentByElement(n.topTarget),o=a&&a.coordinateSystem;return a&&a!==r&&!IRRELEVANT_EXCLUDES.hasOwnProperty(a.mainType)&&o&&o.model!==r}function parseXML(n){if(isString(n)){var t=new DOMParser;n=t.parseFromString(n,"text/xml")}var r=n;for(r.nodeType===9&&(r=r.firstChild);r.nodeName.toLowerCase()!=="svg"||r.nodeType!==1;)r=r.nextSibling;return r}var nodeParsers,INHERITABLE_STYLE_ATTRIBUTES_MAP={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS=keys(INHERITABLE_STYLE_ATTRIBUTES_MAP),SELF_STYLE_ATTRIBUTES_MAP={"alignment-baseline":"textBaseline","stop-color":"stopColor"},SELF_STYLE_ATTRIBUTES_MAP_KEYS=keys(SELF_STYLE_ATTRIBUTES_MAP),SVGParser=function(){function n(){this._defs={},this._root=null}return n.prototype.parse=function(t,r){r=r||{};var a=parseXML(t);this._defsUsePending=[];var o=new Group$3;this._root=o;var u=[],s=a.getAttribute("viewBox")||"",c=parseFloat(a.getAttribute("width")||r.width),l=parseFloat(a.getAttribute("height")||r.height);isNaN(c)&&(c=null),isNaN(l)&&(l=null),parseAttributes(a,o,null,!0,!1);for(var d=a.firstChild;d;)this._parseNode(d,o,u,null,!1,!1),d=d.nextSibling;applyDefs(this._defs,this._defsUsePending),this._defsUsePending=[];var f,h;if(s){var v=splitNumberSequence(s);v.length>=4&&(f={x:parseFloat(v[0]||0),y:parseFloat(v[1]||0),width:parseFloat(v[2]),height:parseFloat(v[3])})}if(f&&c!=null&&l!=null&&(h=makeViewBoxTransform(f,{x:0,y:0,width:c,height:l}),!r.ignoreViewBox)){var g=o;o=new Group$3,o.add(g),g.scaleX=g.scaleY=h.scale,g.x=h.x,g.y=h.y}return!r.ignoreRootClip&&c!=null&&l!=null&&o.setClipPath(new Rect$2({shape:{x:0,y:0,width:c,height:l}})),{root:o,width:c,height:l,viewBoxRect:f,viewBoxTransform:h,named:u}},n.prototype._parseNode=function(t,r,a,o,u,s){var c=t.nodeName.toLowerCase(),l,d=o;if(c==="defs"&&(u=!0),c==="text"&&(s=!0),c==="defs"||c==="switch")l=r;else{if(!u){var f=nodeParsers[c];if(f&&hasOwn(nodeParsers,c)){l=f.call(this,t,r);var h=t.getAttribute("name");if(h){var v={name:h,namedFrom:null,svgNodeTagLower:c,el:l};a.push(v),c==="g"&&(d=v)}else o&&a.push({name:o.name,namedFrom:o,svgNodeTagLower:c,el:l});r.add(l)}}var g=paintServerParsers[c];if(g&&hasOwn(paintServerParsers,c)){var b=g.call(this,t),_=t.getAttribute("id");_&&(this._defs[_]=b)}}if(l&&l.isGroup)for(var S=t.firstChild;S;)S.nodeType===1?this._parseNode(S,l,a,d,u,s):S.nodeType===3&&s&&this._parseText(S,l),S=S.nextSibling},n.prototype._parseText=function(t,r){var a=new TSpan({style:{text:t.textContent},silent:!0,x:this._textX||0,y:this._textY||0});inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),applyTextAlignment(a,r);var o=a.style,u=o.fontSize;u&&u<9&&(o.fontSize=9,a.scaleX*=u/9,a.scaleY*=u/9);var s=(o.fontSize||o.fontFamily)&&[o.fontStyle,o.fontWeight,(o.fontSize||12)+"px",o.fontFamily||"sans-serif"].join(" ");o.font=s;var c=a.getBoundingRect();return this._textX+=c.width,r.add(a),a},n.internalField=function(){nodeParsers={g:function(t,r){var a=new Group$3;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a},rect:function(t,r){var a=new Rect$2;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a.setShape({x:parseFloat(t.getAttribute("x")||"0"),y:parseFloat(t.getAttribute("y")||"0"),width:parseFloat(t.getAttribute("width")||"0"),height:parseFloat(t.getAttribute("height")||"0")}),a.silent=!0,a},circle:function(t,r){var a=new Circle;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),r:parseFloat(t.getAttribute("r")||"0")}),a.silent=!0,a},line:function(t,r){var a=new Line$1;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a.setShape({x1:parseFloat(t.getAttribute("x1")||"0"),y1:parseFloat(t.getAttribute("y1")||"0"),x2:parseFloat(t.getAttribute("x2")||"0"),y2:parseFloat(t.getAttribute("y2")||"0")}),a.silent=!0,a},ellipse:function(t,r){var a=new Ellipse;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),rx:parseFloat(t.getAttribute("rx")||"0"),ry:parseFloat(t.getAttribute("ry")||"0")}),a.silent=!0,a},polygon:function(t,r){var a=t.getAttribute("points"),o;a&&(o=parsePoints(a));var u=new Polygon({shape:{points:o||[]},silent:!0});return inheritStyle(r,u),parseAttributes(t,u,this._defsUsePending,!1,!1),u},polyline:function(t,r){var a=t.getAttribute("points"),o;a&&(o=parsePoints(a));var u=new Polyline$1({shape:{points:o||[]},silent:!0});return inheritStyle(r,u),parseAttributes(t,u,this._defsUsePending,!1,!1),u},image:function(t,r){var a=new ZRImage;return inheritStyle(r,a),parseAttributes(t,a,this._defsUsePending,!1,!1),a.setStyle({image:t.getAttribute("xlink:href")||t.getAttribute("href"),x:+t.getAttribute("x"),y:+t.getAttribute("y"),width:+t.getAttribute("width"),height:+t.getAttribute("height")}),a.silent=!0,a},text:function(t,r){var a=t.getAttribute("x")||"0",o=t.getAttribute("y")||"0",u=t.getAttribute("dx")||"0",s=t.getAttribute("dy")||"0";this._textX=parseFloat(a)+parseFloat(u),this._textY=parseFloat(o)+parseFloat(s);var c=new Group$3;return inheritStyle(r,c),parseAttributes(t,c,this._defsUsePending,!1,!0),c},tspan:function(t,r){var a=t.getAttribute("x"),o=t.getAttribute("y");a!=null&&(this._textX=parseFloat(a)),o!=null&&(this._textY=parseFloat(o));var u=t.getAttribute("dx")||"0",s=t.getAttribute("dy")||"0",c=new Group$3;return inheritStyle(r,c),parseAttributes(t,c,this._defsUsePending,!1,!0),this._textX+=parseFloat(u),this._textY+=parseFloat(s),c},path:function(t,r){var a=t.getAttribute("d")||"",o=createFromString(a);return inheritStyle(r,o),parseAttributes(t,o,this._defsUsePending,!1,!1),o.silent=!0,o}}}(),n}(),paintServerParsers={lineargradient:function(n){var t=parseInt(n.getAttribute("x1")||"0",10),r=parseInt(n.getAttribute("y1")||"0",10),a=parseInt(n.getAttribute("x2")||"10",10),o=parseInt(n.getAttribute("y2")||"0",10),u=new LinearGradient(t,r,a,o);return parsePaintServerUnit(n,u),parseGradientColorStops(n,u),u},radialgradient:function(n){var t=parseInt(n.getAttribute("cx")||"0",10),r=parseInt(n.getAttribute("cy")||"0",10),a=parseInt(n.getAttribute("r")||"0",10),o=new RadialGradient(t,r,a);return parsePaintServerUnit(n,o),parseGradientColorStops(n,o),o}};function parsePaintServerUnit(n,t){var r=n.getAttribute("gradientUnits");r==="userSpaceOnUse"&&(t.global=!0)}function parseGradientColorStops(n,t){for(var r=n.firstChild;r;){if(r.nodeType===1&&r.nodeName.toLocaleLowerCase()==="stop"){var a=r.getAttribute("offset"),o=void 0;a&&a.indexOf("%")>0?o=parseInt(a,10)/100:a?o=parseFloat(a):o=0;var u={};parseInlineStyle(r,u,u);var s=u.stopColor||r.getAttribute("stop-color")||"#000000";t.colorStops.push({offset:o,color:s})}r=r.nextSibling}}function inheritStyle(n,t){n&&n.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),defaults$h(t.__inheritedStyle,n.__inheritedStyle))}function parsePoints(n){for(var t=splitNumberSequence(n),r=[],a=0;a<t.length;a+=2){var o=parseFloat(t[a]),u=parseFloat(t[a+1]);r.push([o,u])}return r}function parseAttributes(n,t,r,a,o){var u=t,s=u.__inheritedStyle=u.__inheritedStyle||{},c={};n.nodeType===1&&(parseTransformAttribute(n,t),parseInlineStyle(n,s,c),a||parseAttributeStyle(n,s,c)),u.style=u.style||{},s.fill!=null&&(u.style.fill=getFillStrokeStyle(u,"fill",s.fill,r)),s.stroke!=null&&(u.style.stroke=getFillStrokeStyle(u,"stroke",s.stroke,r)),each$f(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(l){s[l]!=null&&(u.style[l]=parseFloat(s[l]))}),each$f(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(l){s[l]!=null&&(u.style[l]=s[l])}),o&&(u.__selfStyle=c),s.lineDash&&(u.style.lineDash=map$1(splitNumberSequence(s.lineDash),function(l){return parseFloat(l)})),(s.visibility==="hidden"||s.visibility==="collapse")&&(u.invisible=!0),s.display==="none"&&(u.ignore=!0)}function applyTextAlignment(n,t){var r=t.__selfStyle;if(r){var a=r.textBaseline,o=a;!a||a==="auto"||a==="baseline"?o="alphabetic":a==="before-edge"||a==="text-before-edge"?o="top":a==="after-edge"||a==="text-after-edge"?o="bottom":(a==="central"||a==="mathematical")&&(o="middle"),n.style.textBaseline=o}var u=t.__inheritedStyle;if(u){var s=u.textAlign,c=s;s&&(s==="middle"&&(c="center"),n.style.textAlign=c)}}var urlRegex=/^url\(\s*#(.*?)\)/;function getFillStrokeStyle(n,t,r,a){var o=r&&r.match(urlRegex);if(o){var u=trim$1(o[1]);a.push([n,t,u]);return}return r==="none"&&(r=null),r}function applyDefs(n,t){for(var r=0;r<t.length;r++){var a=t[r];a[0].style[a[1]]=n[a[2]]}}var numberReg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function splitNumberSequence(n){return n.match(numberReg)||[]}var transformRegex=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,DEGREE_TO_ANGLE=Math.PI/180;function parseTransformAttribute(n,t){var r=n.getAttribute("transform");if(r){r=r.replace(/,/g," ");var a=[],o=null;r.replace(transformRegex,function(h,v,g){return a.push(v,g),""});for(var u=a.length-1;u>0;u-=2){var s=a[u],c=a[u-1],l=splitNumberSequence(s);switch(o=o||create$2(),c){case"translate":translate$1(o,o,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":scale$2(o,o,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":rotate$1(o,o,-parseFloat(l[0])*DEGREE_TO_ANGLE,[parseFloat(l[1]||"0"),parseFloat(l[2]||"0")]);break;case"skewX":var d=Math.tan(parseFloat(l[0])*DEGREE_TO_ANGLE);mul(o,[1,0,d,1,0,0],o);break;case"skewY":var f=Math.tan(parseFloat(l[0])*DEGREE_TO_ANGLE);mul(o,[1,f,0,1,0,0],o);break;case"matrix":o[0]=parseFloat(l[0]),o[1]=parseFloat(l[1]),o[2]=parseFloat(l[2]),o[3]=parseFloat(l[3]),o[4]=parseFloat(l[4]),o[5]=parseFloat(l[5]);break}}t.setLocalTransform(o)}}var styleRegex=/([^\s:;]+)\s*:\s*([^:;]+)/g;function parseInlineStyle(n,t,r){var a=n.getAttribute("style");if(a){styleRegex.lastIndex=0;for(var o;(o=styleRegex.exec(a))!=null;){var u=o[1],s=hasOwn(INHERITABLE_STYLE_ATTRIBUTES_MAP,u)?INHERITABLE_STYLE_ATTRIBUTES_MAP[u]:null;s&&(t[s]=o[2]);var c=hasOwn(SELF_STYLE_ATTRIBUTES_MAP,u)?SELF_STYLE_ATTRIBUTES_MAP[u]:null;c&&(r[c]=o[2])}}}function parseAttributeStyle(n,t,r){for(var a=0;a<INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS.length;a++){var o=INHERITABLE_STYLE_ATTRIBUTES_MAP_KEYS[a],u=n.getAttribute(o);u!=null&&(t[INHERITABLE_STYLE_ATTRIBUTES_MAP[o]]=u)}for(var a=0;a<SELF_STYLE_ATTRIBUTES_MAP_KEYS.length;a++){var o=SELF_STYLE_ATTRIBUTES_MAP_KEYS[a],u=n.getAttribute(o);u!=null&&(r[SELF_STYLE_ATTRIBUTES_MAP[o]]=u)}}function makeViewBoxTransform(n,t){var r=t.width/n.width,a=t.height/n.height,o=Math.min(r,a);return{scale:o,x:-(n.x+n.width/2)*o+(t.x+t.width/2),y:-(n.y+n.height/2)*o+(t.y+t.height/2)}}function parseSVG(n,t){var r=new SVGParser;return r.parse(n,t)}var REGION_AVAILABLE_SVG_TAG_MAP=createHashMap(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),GeoSVGResource=function(){function n(t,r){this.type="geoSVG",this._usedGraphicMap=createHashMap(),this._freedGraphics=[],this._mapName=t,this._parsedXML=parseXML(r)}return n.prototype.load=function(){var t=this._firstGraphic;if(!t){t=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(t),this._boundingRect=this._firstGraphic.boundingRect.clone();var r=createRegions(t.named),a=r.regions,o=r.regionsMap;this._regions=a,this._regionsMap=o}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},n.prototype._buildGraphic=function(t){var r,a;try{r=t&&parseSVG(t,{ignoreViewBox:!0,ignoreRootClip:!0})||{},a=r.root,assert(a!=null)}catch(S){throw new Error(`Invalid svg format
`+S.message)}var o=new Group$3;o.add(a),o.isGeoSVGGraphicRoot=!0;var u=r.width,s=r.height,c=r.viewBoxRect,l=this._boundingRect;if(!l){var d=void 0,f=void 0,h=void 0,v=void 0;if(u!=null?(d=0,h=u):c&&(d=c.x,h=c.width),s!=null?(f=0,v=s):c&&(f=c.y,v=c.height),d==null||f==null){var g=a.getBoundingRect();d==null&&(d=g.x,h=g.width),f==null&&(f=g.y,v=g.height)}l=this._boundingRect=new BoundingRect(d,f,h,v)}if(c){var b=makeViewBoxTransform(c,l);a.scaleX=a.scaleY=b.scale,a.x=b.x,a.y=b.y}o.setClipPath(new Rect$2({shape:l.plain()}));var _=[];return each$f(r.named,function(S){REGION_AVAILABLE_SVG_TAG_MAP.get(S.svgNodeTagLower)!=null&&(_.push(S),setSilent(S.el))}),{root:o,boundingRect:l,named:_}},n.prototype.useGraphic=function(t){var r=this._usedGraphicMap,a=r.get(t);return a||(a=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),r.set(t,a),a)},n.prototype.freeGraphic=function(t){var r=this._usedGraphicMap,a=r.get(t);a&&(r.removeKey(t),this._freedGraphics.push(a))},n}();function setSilent(n){n.silent=!1,n.isGroup&&n.traverse(function(t){t.silent=!1})}function createRegions(n){var t=[],r=createHashMap();return each$f(n,function(a){if(a.namedFrom==null){var o=new GeoSVGRegion(a.name,a.el);t.push(o),r.set(a.name,o)}}),{regions:t,regionsMap:r}}var geoCoord=[126,25],nanhaiName="",points$1=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]];for(var i$1=0;i$1<points$1.length;i$1++)for(var k=0;k<points$1[i$1].length;k++)points$1[i$1][k][0]/=10.5,points$1[i$1][k][1]/=-10.5/.75,points$1[i$1][k][0]+=geoCoord[0],points$1[i$1][k][1]+=geoCoord[1];function fixNanhai(n,t){if(n==="china"){for(var r=0;r<t.length;r++)if(t[r].name===nanhaiName)return;t.push(new GeoJSONRegion(nanhaiName,map$1(points$1,function(a){return{type:"polygon",exterior:a}}),geoCoord))}}var coordsOffsetMap={:[32,80],:[0,-10],:[10,5],:[-10,10],:[5,5]};function fixTextCoords(n,t){if(n==="china"){var r=coordsOffsetMap[t.name];if(r){var a=t.getCenter();a[0]+=r[0]/10.5,a[1]+=-r[1]/(10.5/.75),t.setCenter(a)}}}var points=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];function fixDiaoyuIsland(n,t){n==="china"&&t.name===""&&t.geometries.push({type:"polygon",exterior:points[0]})}var DEFAULT_NAME_PROPERTY="name",GeoJSONResource=function(){function n(t,r,a){this.type="geoJSON",this._parsedMap=createHashMap(),this._mapName=t,this._specialAreas=a,this._geoJSON=parseInput(r)}return n.prototype.load=function(t,r){r=r||DEFAULT_NAME_PROPERTY;var a=this._parsedMap.get(r);if(!a){var o=this._parseToRegions(r);a=this._parsedMap.set(r,{regions:o,boundingRect:calculateBoundingRect(o)})}var u=createHashMap(),s=[];return each$f(a.regions,function(c){var l=c.name;t&&hasOwn(t,l)&&(c=c.cloneShallow(l=t[l])),s.push(c),u.set(l,c)}),{regions:s,boundingRect:a.boundingRect||new BoundingRect(0,0,0,0),regionsMap:u}},n.prototype._parseToRegions=function(t){var r=this._mapName,a=this._geoJSON,o;try{o=a?parseGeoJSON(a,t):[]}catch(u){throw new Error(`Invalid geoJson format
`+u.message)}return fixNanhai(r,o),each$f(o,function(u){var s=u.name;fixTextCoords(r,u),fixDiaoyuIsland(r,u);var c=this._specialAreas&&this._specialAreas[s];c&&u.transformTo(c.left,c.top,c.width,c.height)},this),o},n.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},n}();function calculateBoundingRect(n){for(var t,r=0;r<n.length;r++){var a=n[r].getBoundingRect();t=t||a.clone(),t.union(a)}return t}function parseInput(n){return isString(n)?typeof JSON<"u"&&JSON.parse?JSON.parse(n):new Function("return ("+n+");")():n}var storage=createHashMap();const geoSourceManager={registerMap:function(n,t,r){if(t.svg){var a=new GeoSVGResource(n,t.svg);storage.set(n,a)}else{var o=t.geoJson||t.geoJSON;o&&!t.features?r=t.specialAreas:o=t;var a=new GeoJSONResource(n,o,r);storage.set(n,a)}},getGeoResource:function(n){return storage.get(n)},getMapForUser:function(n){var t=storage.get(n);return t&&t.type==="geoJSON"&&t.getMapForUser()},load:function(n,t,r){var a=storage.get(n);if(a)return a.load(t,r)}};var OPTION_STYLE_ENABLED_TAGS=["rect","circle","line","ellipse","polygon","polyline","path"],OPTION_STYLE_ENABLED_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS),STATE_TRIGGER_TAG_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),LABEL_HOST_MAP=createHashMap(OPTION_STYLE_ENABLED_TAGS.concat(["g"])),mapLabelRaw=makeInner();function getFixedItemStyle(n){var t=n.getItemStyle(),r=n.get("areaColor");return r!=null&&(t.fill=r),t}function fixLineStyle(n){var t=n.style;t&&(t.stroke=t.stroke||t.fill,t.fill=null)}var MapDraw=function(){function n(t){var r=new Group$3;this.uid=getUID("ec_map_draw"),this._controller=new RoamController(t.getZr()),this._controllerHost={target:r},this.group=r,r.add(this._regionsGroup=new Group$3),r.add(this._svgGroup=new Group$3)}return n.prototype.draw=function(t,r,a,o,u){var s=t.mainType==="geo",c=t.getData&&t.getData();s&&r.eachComponent({mainType:"series",subType:"map"},function(T){!c&&T.getHostGeoModel()===t&&(c=T.getData())});var l=t.coordinateSystem,d=this._regionsGroup,f=this.group,h=l.getTransformInfo(),v=h.raw,g=h.roam,b=!d.childAt(0)||u;b?(f.x=g.x,f.y=g.y,f.scaleX=g.scaleX,f.scaleY=g.scaleY,f.dirty()):updateProps$1(f,g,t);var _=c&&c.getVisual("visualMeta")&&c.getVisual("visualMeta").length>0,S={api:a,geo:l,mapOrGeoModel:t,data:c,isVisualEncodedByVisualMap:_,isGeo:s,transformInfoRaw:v};l.resourceType==="geoJSON"?this._buildGeoJSON(S):l.resourceType==="geoSVG"&&this._buildSVG(S),this._updateController(t,r,a),this._updateMapSelectHandler(t,d,a,o)},n.prototype._buildGeoJSON=function(t){var r=this._regionsGroupByName=createHashMap(),a=createHashMap(),o=this._regionsGroup,u=t.transformInfoRaw,s=t.mapOrGeoModel,c=t.data,l=t.geo.projection,d=l&&l.stream;function f(g,b){return b&&(g=b(g)),g&&[g[0]*u.scaleX+u.x,g[1]*u.scaleY+u.y]}function h(g){for(var b=[],_=!d&&l&&l.project,S=0;S<g.length;++S){var T=f(g[S],_);T&&b.push(T)}return b}function v(g){return{shape:{points:h(g)}}}o.removeAll(),each$f(t.geo.regions,function(g){var b=g.name,_=r.get(b),S=a.get(b)||{},T=S.dataIdx,w=S.regionModel;if(!_){_=r.set(b,new Group$3),o.add(_),T=c?c.indexOfName(b):null,w=t.isGeo?s.getRegionModel(b):c?c.getItemModel(T):null;var A=w.get("silent",!0);A!=null&&(_.silent=A),a.set(b,{dataIdx:T,regionModel:w})}var R=[],E=[];each$f(g.geometries,function(F){if(F.type==="polygon"){var D=[F.exterior].concat(F.interiors||[]);d&&(D=projectPolys(D,d)),each$f(D,function(O){R.push(new Polygon(v(O)))})}else{var $=F.points;d&&($=projectPolys($,d,!0)),each$f($,function(O){E.push(new Polyline$1(v(O)))})}});var I=f(g.getCenter(),l&&l.project);function L(F,D){if(F.length){var $=new CompoundPath({culling:!0,segmentIgnoreThreshold:1,shape:{paths:F}});_.add($),applyOptionStyleForRegion(t,$,T,w),resetLabelForRegion(t,$,b,w,s,T,I),D&&(fixLineStyle($),each$f($.states,fixLineStyle))}}L(R),L(E,!0)}),r.each(function(g,b){var _=a.get(b),S=_.dataIdx,T=_.regionModel;resetEventTriggerForRegion(t,g,b,T,s,S),resetTooltipForRegion(t,g,b,T,s),resetStateTriggerForRegion(t,g,b,T,s)},this)},n.prototype._buildSVG=function(t){var r=t.geo.map,a=t.transformInfoRaw;this._svgGroup.x=a.x,this._svgGroup.y=a.y,this._svgGroup.scaleX=a.scaleX,this._svgGroup.scaleY=a.scaleY,this._svgResourceChanged(r)&&(this._freeSVG(),this._useSVG(r));var o=this._svgDispatcherMap=createHashMap(),u=!1;each$f(this._svgGraphicRecord.named,function(s){var c=s.name,l=t.mapOrGeoModel,d=t.data,f=s.svgNodeTagLower,h=s.el,v=d?d.indexOfName(c):null,g=l.getRegionModel(c);OPTION_STYLE_ENABLED_TAG_MAP.get(f)!=null&&h instanceof Displayable&&applyOptionStyleForRegion(t,h,v,g),h instanceof Displayable&&(h.culling=!0);var b=g.get("silent",!0);if(b!=null&&(h.silent=b),h.z2EmphasisLift=0,!s.namedFrom&&(LABEL_HOST_MAP.get(f)!=null&&resetLabelForRegion(t,h,c,g,l,v,null),resetEventTriggerForRegion(t,h,c,g,l,v),resetTooltipForRegion(t,h,c,g,l),STATE_TRIGGER_TAG_MAP.get(f)!=null)){var _=resetStateTriggerForRegion(t,h,c,g,l);_==="self"&&(u=!0);var S=o.get(c)||o.set(c,[]);S.push(h)}},this),this._enableBlurEntireSVG(u,t)},n.prototype._enableBlurEntireSVG=function(t,r){if(t&&r.isGeo){var a=r.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle(),o=a.opacity;this._svgGraphicRecord.root.traverse(function(u){if(!u.isGroup){setDefaultStateProxy(u);var s=u.ensureState("blur").style||{};s.opacity==null&&o!=null&&(s.opacity=o),u.ensureState("emphasis")}})}},n.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},n.prototype.findHighDownDispatchers=function(t,r){if(t==null)return[];var a=r.coordinateSystem;if(a.resourceType==="geoJSON"){var o=this._regionsGroupByName;if(o){var u=o.get(t);return u?[u]:[]}}else if(a.resourceType==="geoSVG")return this._svgDispatcherMap&&this._svgDispatcherMap.get(t)||[]},n.prototype._svgResourceChanged=function(t){return this._svgMapName!==t},n.prototype._useSVG=function(t){var r=geoSourceManager.getGeoResource(t);if(r&&r.type==="geoSVG"){var a=r.useGraphic(this.uid);this._svgGroup.add(a.root),this._svgGraphicRecord=a,this._svgMapName=t}},n.prototype._freeSVG=function(){var t=this._svgMapName;if(t!=null){var r=geoSourceManager.getGeoResource(t);r&&r.type==="geoSVG"&&r.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},n.prototype._updateController=function(t,r,a){var o=t.coordinateSystem,u=this._controller,s=this._controllerHost;s.zoomLimit=t.get("scaleLimit"),s.zoom=o.getZoom(),u.enable(t.get("roam")||!1);var c=t.mainType;function l(){var d={type:"geoRoam",componentType:c};return d[c+"Id"]=t.id,d}u.off("pan").on("pan",function(d){this._mouseDownFlag=!1,updateViewOnPan(s,d.dx,d.dy),a.dispatchAction(extend$1(l(),{dx:d.dx,dy:d.dy,animation:{duration:0}}))},this),u.off("zoom").on("zoom",function(d){this._mouseDownFlag=!1,updateViewOnZoom(s,d.scale,d.originX,d.originY),a.dispatchAction(extend$1(l(),{totalZoom:s.zoom,zoom:d.scale,originX:d.originX,originY:d.originY,animation:{duration:0}}))},this),u.setPointerChecker(function(d,f,h){return o.containPoint([f,h])&&!onIrrelevantElement(d,a,t)})},n.prototype.resetForLabelLayout=function(){this.group.traverse(function(t){var r=t.getTextContent();r&&(r.ignore=mapLabelRaw(r).ignore)})},n.prototype._updateMapSelectHandler=function(t,r,a,o){var u=this;r.off("mousedown"),r.off("click"),t.get("selectedMode")&&(r.on("mousedown",function(){u._mouseDownFlag=!0}),r.on("click",function(s){u._mouseDownFlag&&(u._mouseDownFlag=!1)}))},n}();function applyOptionStyleForRegion(n,t,r,a){var o=a.getModel("itemStyle"),u=a.getModel(["emphasis","itemStyle"]),s=a.getModel(["blur","itemStyle"]),c=a.getModel(["select","itemStyle"]),l=getFixedItemStyle(o),d=getFixedItemStyle(u),f=getFixedItemStyle(c),h=getFixedItemStyle(s),v=n.data;if(v){var g=v.getItemVisual(r,"style"),b=v.getItemVisual(r,"decal");n.isVisualEncodedByVisualMap&&g.fill&&(l.fill=g.fill),b&&(l.decal=createOrUpdatePatternFromDecal(b,n.api))}t.setStyle(l),t.style.strokeNoScale=!0,t.ensureState("emphasis").style=d,t.ensureState("select").style=f,t.ensureState("blur").style=h,setDefaultStateProxy(t)}function resetLabelForRegion(n,t,r,a,o,u,s){var c=n.data,l=n.isGeo,d=c&&isNaN(c.get(c.mapDimension("value"),u)),f=c&&c.getItemLayout(u);if(l||d||f&&f.showLabel){var h=l?r:u,v=void 0;(!c||u>=0)&&(v=o);var g=s?{normal:{align:"center",verticalAlign:"middle"}}:null;setLabelStyle(t,getLabelStatesModels(a),{labelFetcher:v,labelDataIndex:h,defaultText:r},g);var b=t.getTextContent();if(b&&(mapLabelRaw(b).ignore=b.ignore,t.textConfig&&s)){var _=t.getBoundingRect().clone();t.textConfig.layoutRect=_,t.textConfig.position=[(s[0]-_.x)/_.width*100+"%",(s[1]-_.y)/_.height*100+"%"]}t.disableLabelAnimation=!0}else t.removeTextContent(),t.removeTextConfig(),t.disableLabelAnimation=null}function resetEventTriggerForRegion(n,t,r,a,o,u){n.data?n.data.setItemGraphicEl(u,t):getECData(t).eventData={componentType:"geo",componentIndex:o.componentIndex,geoIndex:o.componentIndex,name:r,region:a&&a.option||{}}}function resetTooltipForRegion(n,t,r,a,o){n.data||setTooltipConfig({el:t,componentModel:o,itemName:r,itemTooltipOption:a.get("tooltip")})}function resetStateTriggerForRegion(n,t,r,a,o){t.highDownSilentOnTouch=!!o.get("selectedMode");var u=a.getModel("emphasis"),s=u.get("focus");return toggleHoverEmphasis(t,s,u.get("blurScope"),u.get("disabled")),n.isGeo&&enableComponentHighDownFeatures(t,o,r),s}function projectPolys(n,t,r){var a=[],o;function u(){o=[]}function s(){o.length&&(a.push(o),o=[])}var c=t({polygonStart:u,polygonEnd:s,lineStart:u,lineEnd:s,point:function(l,d){isFinite(l)&&isFinite(d)&&o.push([l,d])},sphere:function(){}});return!r&&c.polygonStart(),each$f(n,function(l){c.lineStart();for(var d=0;d<l.length;d++)c.point(l[d][0],l[d][1]);c.lineEnd()}),!r&&c.polygonEnd(),a}var MapView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o,u){if(!(u&&u.type==="mapToggleSelect"&&u.from===this.uid)){var s=this.group;if(s.removeAll(),!r.getHostGeoModel()){if(this._mapDraw&&u&&u.type==="geoRoam"&&this._mapDraw.resetForLabelLayout(),u&&u.type==="geoRoam"&&u.componentType==="series"&&u.seriesId===r.id){var c=this._mapDraw;c&&s.add(c.group)}else if(r.needsDrawMap){var c=this._mapDraw||new MapDraw(o);s.add(c.group),c.draw(r,a,o,this,u),this._mapDraw=c}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;r.get("showLegendSymbol")&&a.getComponent("legend")&&this._renderSymbols(r,a,o)}}},t.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},t.prototype._renderSymbols=function(r,a,o){var u=r.originalData,s=this.group;u.each(u.mapDimension("value"),function(c,l){if(!isNaN(c)){var d=u.getItemLayout(l);if(!(!d||!d.point)){var f=d.point,h=d.offset,v=new Circle({style:{fill:r.getData().getVisual("style").fill},shape:{cx:f[0]+h*9,cy:f[1],r:3},silent:!0,z2:8+(h?0:Z2_EMPHASIS_LIFT+1)});if(!h){var g=r.mainSeries.getData(),b=u.getName(l),_=g.indexOfName(b),S=u.getItemModel(l),T=S.getModel("label"),w=g.getItemGraphicEl(_);setLabelStyle(v,getLabelStatesModels(S),{labelFetcher:{getFormattedLabel:function(A,R){return r.getFormattedLabel(_,R)}},defaultText:b}),v.disableLabelAnimation=!0,T.get("position")||v.setTextConfig({position:"bottom"}),w.onHoverStateChange=function(A){setStatesFlag(v,A)}}s.add(v)}}})},t.type="map",t}(ChartView),MapSeries=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.needsDrawMap=!1,r.seriesGroup=[],r.getTooltipPosition=function(a){if(a!=null){var o=this.getData().getName(a),u=this.coordinateSystem,s=u.getRegion(o);return s&&u.dataToPoint(s.getCenter())}},r}return t.prototype.getInitialData=function(r){for(var a=createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)}),o=createHashMap(),u=[],s=0,c=a.count();s<c;s++){var l=a.getName(s);o.set(l,s)}var d=geoSourceManager.load(this.getMapType(),this.option.nameMap,this.option.nameProperty);return each$f(d.regions,function(f){var h=f.name,v=o.get(h),g=f.properties&&f.properties.echartsStyle,b;v==null?(b={name:h},u.push(b)):b=a.getRawDataItem(v),g&&merge$3(b,g)}),a.appendData(u),a},t.prototype.getHostGeoModel=function(){var r=this.option.geoIndex;return r!=null?this.ecModel.getComponent("geo",r):null},t.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},t.prototype.getRawValue=function(r){var a=this.getData();return a.get(a.mapDimension("value"),r)},t.prototype.getRegionModel=function(r){var a=this.getData();return a.getItemModel(a.indexOfName(r))},t.prototype.formatTooltip=function(r,a,o){for(var u=this.getData(),s=this.getRawValue(r),c=u.getName(r),l=this.seriesGroup,d=[],f=0;f<l.length;f++){var h=l[f].originalData.indexOfName(c),v=u.mapDimension("value");isNaN(l[f].originalData.get(v,h))||d.push(l[f].name)}return createTooltipMarkup("section",{header:d.join(", "),noHeader:!d.length,blocks:[createTooltipMarkup("nameValue",{name:c,value:s})]})},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.getLegendIcon=function(r){var a=r.icon||"roundRect",o=createSymbol$1(a,0,0,r.itemWidth,r.itemHeight,r.itemStyle.fill);return o.setStyle(r.itemStyle),o.style.stroke="none",a.indexOf("empty")>-1&&(o.style.stroke=o.style.fill,o.style.fill="#fff",o.style.lineWidth=2),o},t.type="series.map",t.dependencies=["geo"],t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},t}(SeriesModel);function dataStatistics(n,t){var r={};return each$f(n,function(a){a.each(a.mapDimension("value"),function(o,u){var s="ec-"+a.getName(u);r[s]=r[s]||[],isNaN(o)||r[s].push(o)})}),n[0].map(n[0].mapDimension("value"),function(a,o){for(var u="ec-"+n[0].getName(o),s=0,c=1/0,l=-1/0,d=r[u].length,f=0;f<d;f++)c=Math.min(c,r[u][f]),l=Math.max(l,r[u][f]),s+=r[u][f];var h;return t==="min"?h=c:t==="max"?h=l:t==="average"?h=s/d:h=s,d===0?NaN:h})}function mapDataStatistic(n){var t={};n.eachSeriesByType("map",function(r){var a=r.getHostGeoModel(),o=a?"o"+a.id:"i"+r.getMapType();(t[o]=t[o]||[]).push(r)}),each$f(t,function(r,a){for(var o=dataStatistics(map$1(r,function(s){return s.getData()}),r[0].get("mapValueCalculation")),u=0;u<r.length;u++)r[u].originalData=r[u].getData();for(var u=0;u<r.length;u++)r[u].seriesGroup=r,r[u].needsDrawMap=u===0&&!r[u].getHostGeoModel(),r[u].setData(o.cloneShallow()),r[u].mainSeries=r[0]})}function mapSymbolLayout(n){var t={};n.eachSeriesByType("map",function(r){var a=r.getMapType();if(!(r.getHostGeoModel()||t[a])){var o={};each$f(r.seriesGroup,function(s){var c=s.coordinateSystem,l=s.originalData;s.get("showLegendSymbol")&&n.getComponent("legend")&&l.each(l.mapDimension("value"),function(d,f){var h=l.getName(f),v=c.getRegion(h);if(!(!v||isNaN(d))){var g=o[h]||0,b=c.dataToPoint(v.getCenter());o[h]=g+1,l.setItemLayout(f,{point:b,offset:g})}})});var u=r.getData();u.each(function(s){var c=u.getName(s),l=u.getItemLayout(s)||{};l.showLabel=!o[c],u.setItemLayout(s,l)}),t[a]=!0}})}var v2ApplyTransform=applyTransform$1,View=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;return a.type="view",a.dimensions=["x","y"],a._roamTransformable=new Transformable,a._rawTransformable=new Transformable,a.name=r,a}return t.prototype.setBoundingRect=function(r,a,o,u){return this._rect=new BoundingRect(r,a,o,u),this._rect},t.prototype.getBoundingRect=function(){return this._rect},t.prototype.setViewRect=function(r,a,o,u){this._transformTo(r,a,o,u),this._viewRect=new BoundingRect(r,a,o,u)},t.prototype._transformTo=function(r,a,o,u){var s=this.getBoundingRect(),c=this._rawTransformable;c.transform=s.calculateTransform(new BoundingRect(r,a,o,u));var l=c.parent;c.parent=null,c.decomposeTransform(),c.parent=l,this._updateTransform()},t.prototype.setCenter=function(r,a){r&&(this._center=[parsePercent(r[0],a.getWidth()),parsePercent(r[1],a.getHeight())],this._updateCenterAndZoom())},t.prototype.setZoom=function(r){r=r||1;var a=this.zoomLimit;a&&(a.max!=null&&(r=Math.min(a.max,r)),a.min!=null&&(r=Math.max(a.min,r))),this._zoom=r,this._updateCenterAndZoom()},t.prototype.getDefaultCenter=function(){var r=this.getBoundingRect(),a=r.x+r.width/2,o=r.y+r.height/2;return[a,o]},t.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},t.prototype.getZoom=function(){return this._zoom||1},t.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},t.prototype._updateCenterAndZoom=function(){var r=this._rawTransformable.getLocalTransform(),a=this._roamTransformable,o=this.getDefaultCenter(),u=this.getCenter(),s=this.getZoom();u=applyTransform$1([],u,r),o=applyTransform$1([],o,r),a.originX=u[0],a.originY=u[1],a.x=o[0]-u[0],a.y=o[1]-u[1],a.scaleX=a.scaleY=s,this._updateTransform()},t.prototype._updateTransform=function(){var r=this._roamTransformable,a=this._rawTransformable;a.parent=r,r.updateTransform(),a.updateTransform(),copy$1(this.transform||(this.transform=[]),a.transform||create$2()),this._rawTransform=a.getLocalTransform(),this.invTransform=this.invTransform||[],invert(this.invTransform,this.transform),this.decomposeTransform()},t.prototype.getTransformInfo=function(){var r=this._rawTransformable,a=this._roamTransformable,o=new Transformable;return o.transform=a.transform,o.decomposeTransform(),{roam:{x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY},raw:{x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY}}},t.prototype.getViewRect=function(){return this._viewRect},t.prototype.getViewRectAfterRoam=function(){var r=this.getBoundingRect().clone();return r.applyTransform(this.transform),r},t.prototype.dataToPoint=function(r,a,o){var u=a?this._rawTransform:this.transform;return o=o||[],u?v2ApplyTransform(o,r,u):copy$2(o,r)},t.prototype.pointToData=function(r){var a=this.invTransform;return a?v2ApplyTransform([],r,a):[r[0],r[1]]},t.prototype.convertToPixel=function(r,a,o){var u=getCoordSys$4(a);return u===this?u.dataToPoint(o):null},t.prototype.convertFromPixel=function(r,a,o){var u=getCoordSys$4(a);return u===this?u.pointToData(o):null},t.prototype.containPoint=function(r){return this.getViewRectAfterRoam().contain(r[0],r[1])},t.dimensions=["x","y"],t}(Transformable);function getCoordSys$4(n){var t=n.seriesModel;return t?t.coordinateSystem:null}var GEO_DEFAULT_PARAMS={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},geo2DDimensions=["lng","lat"],Geo=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this,r)||this;u.dimensions=geo2DDimensions,u.type="geo",u._nameCoordMap=createHashMap(),u.map=a;var s=o.projection,c=geoSourceManager.load(a,o.nameMap,o.nameProperty),l=geoSourceManager.getGeoResource(a);u.resourceType=l?l.type:null;var d=u.regions=c.regions,f=GEO_DEFAULT_PARAMS[l.type];u._regionsMap=c.regionsMap,u.regions=c.regions,u.projection=s;var h;if(s)for(var v=0;v<d.length;v++){var g=d[v].getBoundingRect(s);h=h||g.clone(),h.union(g)}else h=c.boundingRect;return u.setBoundingRect(h.x,h.y,h.width,h.height),u.aspectScale=s?1:retrieve2(o.aspectScale,f.aspectScale),u._invertLongitute=s?!1:f.invertLongitute,u}return t.prototype._transformTo=function(r,a,o,u){var s=this.getBoundingRect(),c=this._invertLongitute;s=s.clone(),c&&(s.y=-s.y-s.height);var l=this._rawTransformable;l.transform=s.calculateTransform(new BoundingRect(r,a,o,u));var d=l.parent;l.parent=null,l.decomposeTransform(),l.parent=d,c&&(l.scaleY=-l.scaleY),this._updateTransform()},t.prototype.getRegion=function(r){return this._regionsMap.get(r)},t.prototype.getRegionByCoord=function(r){for(var a=this.regions,o=0;o<a.length;o++){var u=a[o];if(u.type==="geoJSON"&&u.contain(r))return a[o]}},t.prototype.addGeoCoord=function(r,a){this._nameCoordMap.set(r,a)},t.prototype.getGeoCoord=function(r){var a=this._regionsMap.get(r);return this._nameCoordMap.get(r)||a&&a.getCenter()},t.prototype.dataToPoint=function(r,a,o){if(isString(r)&&(r=this.getGeoCoord(r)),r){var u=this.projection;return u&&(r=u.project(r)),r&&this.projectedToPoint(r,a,o)}},t.prototype.pointToData=function(r){var a=this.projection;return a&&(r=a.unproject(r)),r&&this.pointToProjected(r)},t.prototype.pointToProjected=function(r){return n.prototype.pointToData.call(this,r)},t.prototype.projectedToPoint=function(r,a,o){return n.prototype.dataToPoint.call(this,r,a,o)},t.prototype.convertToPixel=function(r,a,o){var u=getCoordSys$3(a);return u===this?u.dataToPoint(o):null},t.prototype.convertFromPixel=function(r,a,o){var u=getCoordSys$3(a);return u===this?u.pointToData(o):null},t}(View);mixin$1(Geo,View);function getCoordSys$3(n){var t=n.geoModel,r=n.seriesModel;return t?t.coordinateSystem:r?r.coordinateSystem||(r.getReferringComponents("geo",SINGLE_REFERRING).models[0]||{}).coordinateSystem:null}function resizeGeo(n,t){var r=n.get("boundingCoords");if(r!=null){var a=r[0],o=r[1];if(isFinite(a[0])&&isFinite(a[1])&&isFinite(o[0])&&isFinite(o[1])){var u=this.projection;if(u){var s=a[0],c=a[1],l=o[0],d=o[1];a=[1/0,1/0],o=[-1/0,-1/0];var f=function(I,L,F,D){for(var $=F-I,O=D-L,P=0;P<=100;P++){var C=P/100,q=u.project([I+$*C,L+O*C]);min$2(a,a,q),max$3(o,o,q)}};f(s,c,l,c),f(l,c,l,d),f(l,d,s,d),f(s,d,l,c)}this.setBoundingRect(a[0],a[1],o[0]-a[0],o[1]-a[1])}}var h=this.getBoundingRect(),v=n.get("layoutCenter"),g=n.get("layoutSize"),b=t.getWidth(),_=t.getHeight(),S=h.width/h.height*this.aspectScale,T=!1,w,A;v&&g&&(w=[parsePercent(v[0],b),parsePercent(v[1],_)],A=parsePercent(g,Math.min(b,_)),!isNaN(w[0])&&!isNaN(w[1])&&!isNaN(A)&&(T=!0));var R;if(T)R={},S>1?(R.width=A,R.height=A/S):(R.height=A,R.width=A*S),R.y=w[1]-R.height/2,R.x=w[0]-R.width/2;else{var E=n.getBoxLayoutParams();E.aspect=S,R=getLayoutRect(E,{width:b,height:_})}this.setViewRect(R.x,R.y,R.width,R.height),this.setCenter(n.get("center"),t),this.setZoom(n.get("zoom"))}function setGeoCoords(n,t){each$f(t.get("geoCoord"),function(r,a){n.addGeoCoord(a,r)})}var GeoCreator=function(){function n(){this.dimensions=geo2DDimensions}return n.prototype.create=function(t,r){var a=[];function o(s){return{nameProperty:s.get("nameProperty"),aspectScale:s.get("aspectScale"),projection:s.get("projection")}}t.eachComponent("geo",function(s,c){var l=s.get("map"),d=new Geo(l+c,l,extend$1({nameMap:s.get("nameMap")},o(s)));d.zoomLimit=s.get("scaleLimit"),a.push(d),s.coordinateSystem=d,d.model=s,d.resize=resizeGeo,d.resize(s,r)}),t.eachSeries(function(s){var c=s.get("coordinateSystem");if(c==="geo"){var l=s.get("geoIndex")||0;s.coordinateSystem=a[l]}});var u={};return t.eachSeriesByType("map",function(s){if(!s.getHostGeoModel()){var c=s.getMapType();u[c]=u[c]||[],u[c].push(s)}}),each$f(u,function(s,c){var l=map$1(s,function(f){return f.get("nameMap")}),d=new Geo(c,c,extend$1({nameMap:mergeAll(l)},o(s[0])));d.zoomLimit=retrieve.apply(null,map$1(s,function(f){return f.get("scaleLimit")})),a.push(d),d.resize=resizeGeo,d.resize(s[0],r),each$f(s,function(f){f.coordinateSystem=d,setGeoCoords(d,f)})}),a},n.prototype.getFilledRegions=function(t,r,a,o){for(var u=(t||[]).slice(),s=createHashMap(),c=0;c<u.length;c++)s.set(u[c].name,u[c]);var l=geoSourceManager.load(r,a,o);return each$f(l.regions,function(d){var f=d.name,h=s.get(f),v=d.properties&&d.properties.echartsStyle;h||(h={name:f},u.push(h)),v&&merge$3(h,v)}),u},n}(),geoCreator=new GeoCreator,GeoModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a,o){var u=geoSourceManager.getGeoResource(r.map);if(u&&u.type==="geoJSON"){var s=r.itemStyle=r.itemStyle||{};"color"in s||(s.color="#eee")}this.mergeDefaultAndTheme(r,o),defaultEmphasis(r,"label",["show"])},t.prototype.optionUpdated=function(){var r=this,a=this.option;a.regions=geoCreator.getFilledRegions(a.regions,a.map,a.nameMap,a.nameProperty);var o={};this._optionModelMap=reduce$1(a.regions||[],function(u,s){var c=s.name;return c&&(u.set(c,new Model(s,r,r.ecModel)),s.selected&&(o[c]=!0)),u},createHashMap()),a.selectedMap||(a.selectedMap=o)},t.prototype.getRegionModel=function(r){return this._optionModelMap.get(r)||new Model(null,this,this.ecModel)},t.prototype.getFormattedLabel=function(r,a){var o=this.getRegionModel(r),u=a==="normal"?o.get(["label","formatter"]):o.get(["emphasis","label","formatter"]),s={name:r};if(isFunction$1(u))return s.status=a,u(s);if(isString(u))return u.replace("{a}",r??"")},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.select=function(r){var a=this.option,o=a.selectedMode;if(o){o!=="multiple"&&(a.selectedMap=null);var u=a.selectedMap||(a.selectedMap={});u[r]=!0}},t.prototype.unSelect=function(r){var a=this.option.selectedMap;a&&(a[r]=!1)},t.prototype.toggleSelected=function(r){this[this.isSelected(r)?"unSelect":"select"](r)},t.prototype.isSelected=function(r){var a=this.option.selectedMap;return!!(a&&a[r])},t.type="geo",t.layoutMode="box",t.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},t}(ComponentModel);function getCenterCoord(n,t){return n.pointToProjected?n.pointToProjected(t):n.pointToData(t)}function updateCenterAndZoom(n,t,r,a){var o=n.getZoom(),u=n.getCenter(),s=t.zoom,c=n.projectedToPoint?n.projectedToPoint(u):n.dataToPoint(u);if(t.dx!=null&&t.dy!=null&&(c[0]-=t.dx,c[1]-=t.dy,n.setCenter(getCenterCoord(n,c),a)),s!=null){if(r){var l=r.min||0,d=r.max||1/0;s=Math.max(Math.min(o*s,d),l)/o}n.scaleX*=s,n.scaleY*=s;var f=(t.originX-n.x)*(s-1),h=(t.originY-n.y)*(s-1);n.x-=f,n.y-=h,n.updateTransform(),n.setCenter(getCenterCoord(n,c),a),n.setZoom(s*o)}return{center:n.getCenter(),zoom:n.getZoom()}}var GeoView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.focusBlurEnabled=!0,r}return t.prototype.init=function(r,a){this._api=a},t.prototype.render=function(r,a,o,u){if(this._model=r,!r.get("show")){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;return}this._mapDraw||(this._mapDraw=new MapDraw(o));var s=this._mapDraw;s.draw(r,a,o,this,u),s.group.on("click",this._handleRegionClick,this),s.group.silent=r.get("silent"),this.group.add(s.group),this.updateSelectStatus(r,a,o)},t.prototype._handleRegionClick=function(r){var a;findEventDispatcher(r.target,function(o){return(a=getECData(o).eventData)!=null},!0),a&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:a.name})},t.prototype.updateSelectStatus=function(r,a,o){var u=this;this._mapDraw.group.traverse(function(s){var c=getECData(s).eventData;if(c)return u._model.isSelected(c.name)?o.enterSelect(s):o.leaveSelect(s),!0})},t.prototype.findHighDownDispatchers=function(r){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(r,this._model)},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},t.type="geo",t}(ComponentView);function registerMap(n,t,r){geoSourceManager.registerMap(n,t,r)}function install$J(n){n.registerCoordinateSystem("geo",geoCreator),n.registerComponentModel(GeoModel),n.registerComponentView(GeoView),n.registerImpl("registerMap",registerMap),n.registerImpl("getMap",function(r){return geoSourceManager.getMapForUser(r)});function t(r,a){a.update="geo:updateSelectStatus",n.registerAction(a,function(o,u){var s={},c=[];return u.eachComponent({mainType:"geo",query:o},function(l){l[r](o.name);var d=l.coordinateSystem;each$f(d.regions,function(h){s[h.name]=l.isSelected(h.name)||!1});var f=[];each$f(s,function(h,v){s[v]&&f.push(v)}),c.push({geoIndex:l.componentIndex,name:f})}),{selected:s,allSelected:c,name:o.name}})}t("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),t("select",{type:"geoSelect",event:"geoselected"}),t("unSelect",{type:"geoUnSelect",event:"geounselected"}),n.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(r,a,o){var u=r.componentType||"series";a.eachComponent({mainType:u,query:r},function(s){var c=s.coordinateSystem;if(c.type==="geo"){var l=updateCenterAndZoom(c,r,s.get("scaleLimit"),o);s.setCenter&&s.setCenter(l.center),s.setZoom&&s.setZoom(l.zoom),u==="series"&&each$f(s.seriesGroup,function(d){d.setCenter(l.center),d.setZoom(l.zoom)})}})})}function install$I(n){use(install$J),n.registerChartView(MapView),n.registerSeriesModel(MapSeries),n.registerLayout(mapSymbolLayout),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,mapDataStatistic),createLegacyDataSelectAction("map",n.registerAction)}function init(n){var t=n;t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var r=[t],a,o;a=r.pop();)if(o=a.children,a.isExpand&&o.length)for(var u=o.length,s=u-1;s>=0;s--){var c=o[s];c.hierNode={defaultAncestor:null,ancestor:c,prelim:0,modifier:0,change:0,shift:0,i:s,thread:null},r.push(c)}}function firstWalk(n,t){var r=n.isExpand?n.children:[],a=n.parentNode.children,o=n.hierNode.i?a[n.hierNode.i-1]:null;if(r.length){executeShifts(n);var u=(r[0].hierNode.prelim+r[r.length-1].hierNode.prelim)/2;o?(n.hierNode.prelim=o.hierNode.prelim+t(n,o),n.hierNode.modifier=n.hierNode.prelim-u):n.hierNode.prelim=u}else o&&(n.hierNode.prelim=o.hierNode.prelim+t(n,o));n.parentNode.hierNode.defaultAncestor=apportion(n,o,n.parentNode.hierNode.defaultAncestor||a[0],t)}function secondWalk(n){var t=n.hierNode.prelim+n.parentNode.hierNode.modifier;n.setLayout({x:t},!0),n.hierNode.modifier+=n.parentNode.hierNode.modifier}function separation(n){return arguments.length?n:defaultSeparation}function radialCoordinate(n,t){return n-=Math.PI/2,{x:t*Math.cos(n),y:t*Math.sin(n)}}function getViewRect$4(n,t){return getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function executeShifts(n){for(var t=n.children,r=t.length,a=0,o=0;--r>=0;){var u=t[r];u.hierNode.prelim+=a,u.hierNode.modifier+=a,o+=u.hierNode.change,a+=u.hierNode.shift+o}}function apportion(n,t,r,a){if(t){for(var o=n,u=n,s=u.parentNode.children[0],c=t,l=o.hierNode.modifier,d=u.hierNode.modifier,f=s.hierNode.modifier,h=c.hierNode.modifier;c=nextRight(c),u=nextLeft(u),c&&u;){o=nextRight(o),s=nextLeft(s),o.hierNode.ancestor=n;var v=c.hierNode.prelim+h-u.hierNode.prelim-d+a(c,u);v>0&&(moveSubtree(nextAncestor(c,n,r),n,v),d+=v,l+=v),h+=c.hierNode.modifier,d+=u.hierNode.modifier,l+=o.hierNode.modifier,f+=s.hierNode.modifier}c&&!nextRight(o)&&(o.hierNode.thread=c,o.hierNode.modifier+=h-l),u&&!nextLeft(s)&&(s.hierNode.thread=u,s.hierNode.modifier+=d-f,r=n)}return r}function nextRight(n){var t=n.children;return t.length&&n.isExpand?t[t.length-1]:n.hierNode.thread}function nextLeft(n){var t=n.children;return t.length&&n.isExpand?t[0]:n.hierNode.thread}function nextAncestor(n,t,r){return n.hierNode.ancestor.parentNode===t.parentNode?n.hierNode.ancestor:r}function moveSubtree(n,t,r){var a=r/(t.hierNode.i-n.hierNode.i);t.hierNode.change-=a,t.hierNode.shift+=r,t.hierNode.modifier+=r,t.hierNode.prelim+=r,n.hierNode.change+=a}function defaultSeparation(n,t){return n.parentNode===t.parentNode?1:2}var TreeEdgeShape=function(){function n(){this.parentPoint=[],this.childPoints=[]}return n}(),TreePath=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new TreeEdgeShape},t.prototype.buildPath=function(r,a){var o=a.childPoints,u=o.length,s=a.parentPoint,c=o[0],l=o[u-1];if(u===1){r.moveTo(s[0],s[1]),r.lineTo(c[0],c[1]);return}var d=a.orient,f=d==="TB"||d==="BT"?0:1,h=1-f,v=parsePercent(a.forkPosition,1),g=[];g[f]=s[f],g[h]=s[h]+(l[h]-s[h])*v,r.moveTo(s[0],s[1]),r.lineTo(g[0],g[1]),r.moveTo(c[0],c[1]),g[f]=c[f],r.lineTo(g[0],g[1]),g[f]=l[f],r.lineTo(g[0],g[1]),r.lineTo(l[0],l[1]);for(var b=1;b<u-1;b++){var _=o[b];r.moveTo(_[0],_[1]),g[f]=_[f],r.lineTo(g[0],g[1])}},t}(Path),TreeView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._mainGroup=new Group$3,r}return t.prototype.init=function(r,a){this._controller=new RoamController(a.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(r,a,o){var u=r.getData(),s=r.layoutInfo,c=this._mainGroup,l=r.get("layout");l==="radial"?(c.x=s.x+s.width/2,c.y=s.y+s.height/2):(c.x=s.x,c.y=s.y),this._updateViewCoordSys(r,o),this._updateController(r,a,o);var d=this._data;u.diff(d).add(function(f){symbolNeedsDraw(u,f)&&updateNode$1(u,f,null,c,r)}).update(function(f,h){var v=d.getItemGraphicEl(h);if(!symbolNeedsDraw(u,f)){v&&removeNode(d,h,v,c,r);return}updateNode$1(u,f,v,c,r)}).remove(function(f){var h=d.getItemGraphicEl(f);h&&removeNode(d,f,h,c,r)}).execute(),this._nodeScaleRatio=r.get("nodeScaleRatio"),this._updateNodeAndLinkScale(r),r.get("expandAndCollapse")===!0&&u.eachItemGraphicEl(function(f,h){f.off("click").on("click",function(){o.dispatchAction({type:"treeExpandAndCollapse",seriesId:r.id,dataIndex:h})})}),this._data=u},t.prototype._updateViewCoordSys=function(r,a){var o=r.getData(),u=[];o.each(function(h){var v=o.getItemLayout(h);v&&!isNaN(v.x)&&!isNaN(v.y)&&u.push([+v.x,+v.y])});var s=[],c=[];fromPoints(u,s,c);var l=this._min,d=this._max;c[0]-s[0]===0&&(s[0]=l?l[0]:s[0]-1,c[0]=d?d[0]:c[0]+1),c[1]-s[1]===0&&(s[1]=l?l[1]:s[1]-1,c[1]=d?d[1]:c[1]+1);var f=r.coordinateSystem=new View;f.zoomLimit=r.get("scaleLimit"),f.setBoundingRect(s[0],s[1],c[0]-s[0],c[1]-s[1]),f.setCenter(r.get("center"),a),f.setZoom(r.get("zoom")),this.group.attr({x:f.x,y:f.y,scaleX:f.scaleX,scaleY:f.scaleY}),this._min=s,this._max=c},t.prototype._updateController=function(r,a,o){var u=this,s=this._controller,c=this._controllerHost,l=this.group;s.setPointerChecker(function(d,f,h){var v=l.getBoundingRect();return v.applyTransform(l.transform),v.contain(f,h)&&!onIrrelevantElement(d,o,r)}),s.enable(r.get("roam")),c.zoomLimit=r.get("scaleLimit"),c.zoom=r.coordinateSystem.getZoom(),s.off("pan").off("zoom").on("pan",function(d){updateViewOnPan(c,d.dx,d.dy),o.dispatchAction({seriesId:r.id,type:"treeRoam",dx:d.dx,dy:d.dy})}).on("zoom",function(d){updateViewOnZoom(c,d.scale,d.originX,d.originY),o.dispatchAction({seriesId:r.id,type:"treeRoam",zoom:d.scale,originX:d.originX,originY:d.originY}),u._updateNodeAndLinkScale(r),o.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(r){var a=r.getData(),o=this._getNodeGlobalScale(r);a.eachItemGraphicEl(function(u,s){u.setSymbolScale(o)})},t.prototype._getNodeGlobalScale=function(r){var a=r.coordinateSystem;if(a.type!=="view")return 1;var o=this._nodeScaleRatio,u=a.scaleX||1,s=a.getZoom(),c=(s-1)*o+1;return c/u},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},t.type="tree",t}(ChartView);function symbolNeedsDraw(n,t){var r=n.getItemLayout(t);return r&&!isNaN(r.x)&&!isNaN(r.y)}function updateNode$1(n,t,r,a,o){var u=!r,s=n.tree.getNodeByDataIndex(t),c=s.getModel(),l=s.getVisual("style").fill,d=s.isExpand===!1&&s.children.length!==0?l:"#fff",f=n.tree.root,h=s.parentNode===f?s:s.parentNode||s,v=n.getItemGraphicEl(h.dataIndex),g=h.getLayout(),b=v?{x:v.__oldX,y:v.__oldY,rawX:v.__radialOldRawX,rawY:v.__radialOldRawY}:g,_=s.getLayout();u?(r=new Symbol$2(n,t,null,{symbolInnerColor:d,useNameLabel:!0}),r.x=b.x,r.y=b.y):r.updateData(n,t,null,{symbolInnerColor:d,useNameLabel:!0}),r.__radialOldRawX=r.__radialRawX,r.__radialOldRawY=r.__radialRawY,r.__radialRawX=_.rawX,r.__radialRawY=_.rawY,a.add(r),n.setItemGraphicEl(t,r),r.__oldX=r.x,r.__oldY=r.y,updateProps$1(r,{x:_.x,y:_.y},o);var S=r.getSymbolPath();if(o.get("layout")==="radial"){var T=f.children[0],w=T.getLayout(),A=T.children.length,R=void 0,E=void 0;if(_.x===w.x&&s.isExpand===!0&&T.children.length){var I={x:(T.children[0].getLayout().x+T.children[A-1].getLayout().x)/2,y:(T.children[0].getLayout().y+T.children[A-1].getLayout().y)/2};R=Math.atan2(I.y-w.y,I.x-w.x),R<0&&(R=Math.PI*2+R),E=I.x<w.x,E&&(R=R-Math.PI)}else R=Math.atan2(_.y-w.y,_.x-w.x),R<0&&(R=Math.PI*2+R),s.children.length===0||s.children.length!==0&&s.isExpand===!1?(E=_.x<w.x,E&&(R=R-Math.PI)):(E=_.x>w.x,E||(R=R-Math.PI));var L=E?"left":"right",F=c.getModel("label"),D=F.get("rotate"),$=D*(Math.PI/180),O=S.getTextContent();O&&(S.setTextConfig({position:F.get("position")||L,rotation:D==null?-R:$,origin:"center"}),O.setStyle("verticalAlign","middle"))}var P=c.get(["emphasis","focus"]),C=P==="relative"?concatArray(s.getAncestorsIndices(),s.getDescendantIndices()):P==="ancestor"?s.getAncestorsIndices():P==="descendant"?s.getDescendantIndices():null;C&&(getECData(r).focus=C),drawEdge(o,s,f,r,b,g,_,a),r.__edge&&(r.onHoverStateChange=function(q){if(q!=="blur"){var M=s.parentNode&&n.getItemGraphicEl(s.parentNode.dataIndex);M&&M.hoverState===HOVER_STATE_BLUR||setStatesFlag(r.__edge,q)}})}function drawEdge(n,t,r,a,o,u,s,c){var l=t.getModel(),d=n.get("edgeShape"),f=n.get("layout"),h=n.getOrient(),v=n.get(["lineStyle","curveness"]),g=n.get("edgeForkPosition"),b=l.getModel("lineStyle").getLineStyle(),_=a.__edge;if(d==="curve")t.parentNode&&t.parentNode!==r&&(_||(_=a.__edge=new BezierCurve({shape:getEdgeShape(f,h,v,o,o)})),updateProps$1(_,{shape:getEdgeShape(f,h,v,u,s)},n));else if(d==="polyline"&&f==="orthogonal"&&t!==r&&t.children&&t.children.length!==0&&t.isExpand===!0){for(var S=t.children,T=[],w=0;w<S.length;w++){var A=S[w].getLayout();T.push([A.x,A.y])}_||(_=a.__edge=new TreePath({shape:{parentPoint:[s.x,s.y],childPoints:[[s.x,s.y]],orient:h,forkPosition:g}})),updateProps$1(_,{shape:{parentPoint:[s.x,s.y],childPoints:T}},n)}_&&!(d==="polyline"&&!t.isExpand)&&(_.useStyle(defaults$h({strokeNoScale:!0,fill:null},b)),setStatesStylesFromModel(_,l,"lineStyle"),setDefaultStateProxy(_),c.add(_))}function removeNodeEdge(n,t,r,a,o){var u=t.tree.root,s=getSourceNode(u,n),c=s.source,l=s.sourceLayout,d=t.getItemGraphicEl(n.dataIndex);if(d){var f=t.getItemGraphicEl(c.dataIndex),h=f.__edge,v=d.__edge||(c.isExpand===!1||c.children.length===1?h:void 0),g=a.get("edgeShape"),b=a.get("layout"),_=a.get("orient"),S=a.get(["lineStyle","curveness"]);v&&(g==="curve"?removeElement(v,{shape:getEdgeShape(b,_,S,l,l),style:{opacity:0}},a,{cb:function(){r.remove(v)},removeOpt:o}):g==="polyline"&&a.get("layout")==="orthogonal"&&removeElement(v,{shape:{parentPoint:[l.x,l.y],childPoints:[[l.x,l.y]]},style:{opacity:0}},a,{cb:function(){r.remove(v)},removeOpt:o}))}}function getSourceNode(n,t){for(var r=t.parentNode===n?t:t.parentNode||t,a;a=r.getLayout(),a==null;)r=r.parentNode===n?r:r.parentNode||r;return{source:r,sourceLayout:a}}function removeNode(n,t,r,a,o){var u=n.tree.getNodeByDataIndex(t),s=n.tree.root,c=getSourceNode(s,u).sourceLayout,l={duration:o.get("animationDurationUpdate"),easing:o.get("animationEasingUpdate")};removeElement(r,{x:c.x+1,y:c.y+1},o,{cb:function(){a.remove(r),n.setItemGraphicEl(t,null)},removeOpt:l}),r.fadeOut(null,n.hostModel,{fadeLabel:!0,animation:l}),u.children.forEach(function(d){removeNodeEdge(d,n,a,o,l)}),removeNodeEdge(u,n,a,o,l)}function getEdgeShape(n,t,r,a,o){var u,s,c,l,d,f,h,v;if(n==="radial"){d=a.rawX,h=a.rawY,f=o.rawX,v=o.rawY;var g=radialCoordinate(d,h),b=radialCoordinate(d,h+(v-h)*r),_=radialCoordinate(f,v+(h-v)*r),S=radialCoordinate(f,v);return{x1:g.x||0,y1:g.y||0,x2:S.x||0,y2:S.y||0,cpx1:b.x||0,cpy1:b.y||0,cpx2:_.x||0,cpy2:_.y||0}}else d=a.x,h=a.y,f=o.x,v=o.y,(t==="LR"||t==="RL")&&(u=d+(f-d)*r,s=h,c=f+(d-f)*r,l=v),(t==="TB"||t==="BT")&&(u=d,s=h+(v-h)*r,c=f,l=v+(h-v)*r);return{x1:d,y1:h,x2:f,y2:v,cpx1:u,cpy1:s,cpx2:c,cpy2:l}}var inner$e=makeInner();function linkSeriesData(n){var t=n.mainData,r=n.datas;r||(r={main:t},n.datasAttr={main:"data"}),n.datas=n.mainData=null,linkAll(t,r,n),each$f(r,function(a){each$f(t.TRANSFERABLE_METHODS,function(o){a.wrapMethod(o,curry$1(transferInjection,n))})}),t.wrapMethod("cloneShallow",curry$1(cloneShallowInjection,n)),each$f(t.CHANGABLE_METHODS,function(a){t.wrapMethod(a,curry$1(changeInjection,n))}),assert(r[t.dataType]===t)}function transferInjection(n,t){if(isMainData(this)){var r=extend$1({},inner$e(this).datas);r[this.dataType]=t,linkAll(t,r,n)}else linkSingle(t,this.dataType,inner$e(this).mainData,n);return t}function changeInjection(n,t){return n.struct&&n.struct.update(),t}function cloneShallowInjection(n,t){return each$f(inner$e(t).datas,function(r,a){r!==t&&linkSingle(r.cloneShallow(),a,t,n)}),t}function getLinkedData(n){var t=inner$e(this).mainData;return n==null||t==null?t:inner$e(t).datas[n]}function getLinkedDataAll(){var n=inner$e(this).mainData;return n==null?[{data:n}]:map$1(keys(inner$e(n).datas),function(t){return{type:t,data:inner$e(n).datas[t]}})}function isMainData(n){return inner$e(n).mainData===n}function linkAll(n,t,r){inner$e(n).datas={},each$f(t,function(a,o){linkSingle(a,o,n,r)})}function linkSingle(n,t,r,a){inner$e(r).datas[t]=n,inner$e(n).mainData=r,n.dataType=t,a.struct&&(n[a.structAttr]=a.struct,a.struct[a.datasAttr[t]]=n),n.getLinkedData=getLinkedData,n.getLinkedDataAll=getLinkedDataAll}var TreeNode=function(){function n(t,r){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=r}return n.prototype.isRemoved=function(){return this.dataIndex<0},n.prototype.eachNode=function(t,r,a){isFunction$1(t)&&(a=r,r=t,t=null),t=t||{},isString(t)&&(t={order:t});var o=t.order||"preorder",u=this[t.attr||"children"],s;o==="preorder"&&(s=r.call(a,this));for(var c=0;!s&&c<u.length;c++)u[c].eachNode(t,r,a);o==="postorder"&&r.call(a,this)},n.prototype.updateDepthAndHeight=function(t){var r=0;this.depth=t;for(var a=0;a<this.children.length;a++){var o=this.children[a];o.updateDepthAndHeight(t+1),o.height>r&&(r=o.height)}this.height=r+1},n.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var r=0,a=this.children,o=a.length;r<o;r++){var u=a[r].getNodeById(t);if(u)return u}},n.prototype.contains=function(t){if(t===this)return!0;for(var r=0,a=this.children,o=a.length;r<o;r++){var u=a[r].contains(t);if(u)return u}},n.prototype.getAncestors=function(t){for(var r=[],a=t?this:this.parentNode;a;)r.push(a),a=a.parentNode;return r.reverse(),r},n.prototype.getAncestorsIndices=function(){for(var t=[],r=this;r;)t.push(r.dataIndex),r=r.parentNode;return t.reverse(),t},n.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(r){t.push(r.dataIndex)}),t},n.prototype.getValue=function(t){var r=this.hostTree.data;return r.getStore().get(r.getDimensionIndex(t||"value"),this.dataIndex)},n.prototype.setLayout=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,r)},n.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostTree,a=r.data.getItemModel(this.dataIndex);return a.getModel(t)}},n.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},n.prototype.setVisual=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,r)},n.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},n.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},n.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},n.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,r=0;r<t.length;++r)if(t[r]===this)return r;return-1}return-1},n.prototype.isAncestorOf=function(t){for(var r=t.parentNode;r;){if(r===this)return!0;r=r.parentNode}return!1},n.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},n}(),Tree=function(){function n(t){this.type="tree",this._nodes=[],this.hostModel=t}return n.prototype.eachNode=function(t,r,a){this.root.eachNode(t,r,a)},n.prototype.getNodeByDataIndex=function(t){var r=this.data.getRawIndex(t);return this._nodes[r]},n.prototype.getNodeById=function(t){return this.root.getNodeById(t)},n.prototype.update=function(){for(var t=this.data,r=this._nodes,a=0,o=r.length;a<o;a++)r[a].dataIndex=-1;for(var a=0,o=t.count();a<o;a++)r[t.getRawIndex(a)].dataIndex=a},n.prototype.clearLayouts=function(){this.data.clearItemLayouts()},n.createTree=function(t,r,a){var o=new n(r),u=[],s=1;c(t);function c(f,h){var v=f.value;s=Math.max(s,isArray$2(v)?v.length:1),u.push(f);var g=new TreeNode(convertOptionIdName(f.name,""),o);h?addChild(g,h):o.root=g,o._nodes.push(g);var b=f.children;if(b)for(var _=0;_<b.length;_++)c(b[_],g)}o.root.updateDepthAndHeight(0);var l=prepareSeriesDataSchema(u,{coordDimensions:["value"],dimensionsCount:s}).dimensions,d=new SeriesData(l,r);return d.initData(u),a&&a(d),linkSeriesData({mainData:d,struct:o,structAttr:"tree"}),o.update(),o},n}();function addChild(n,t){var r=t.children;n.parentNode!==t&&(r.push(n),n.parentNode=t)}function retrieveTargetInfo(n,t,r){if(n&&indexOf(t,n.type)>=0){var a=r.getData().tree.root,o=n.targetNode;if(isString(o)&&(o=a.getNodeById(o)),o&&a.contains(o))return{node:o};var u=n.targetNodeId;if(u!=null&&(o=a.getNodeById(u)))return{node:o}}}function getPathToRoot(n){for(var t=[];n;)n=n.parentNode,n&&t.push(n);return t.reverse()}function aboveViewRoot(n,t){var r=getPathToRoot(n);return indexOf(r,t)>=0}function wrapTreePathInfo(n,t){for(var r=[];n;){var a=n.dataIndex;r.push({name:n.name,dataIndex:a,value:t.getRawValue(a)}),n=n.parentNode}return r.reverse(),r}var TreeSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.hasSymbolVisual=!0,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r){var a={name:r.name,children:r.data},o=r.leaves||{},u=new Model(o,this,this.ecModel),s=Tree.createTree(a,this,c);function c(h){h.wrapMethod("getItemModel",function(v,g){var b=s.getNodeByDataIndex(g);return b&&b.children.length&&b.isExpand||(v.parentModel=u),v})}var l=0;s.eachNode("preorder",function(h){h.depth>l&&(l=h.depth)});var d=r.expandAndCollapse,f=d&&r.initialTreeDepth>=0?r.initialTreeDepth:l;return s.root.eachNode("preorder",function(h){var v=h.hostTree.data.getRawDataItem(h.dataIndex);h.isExpand=v&&v.collapsed!=null?!v.collapsed:h.depth<=f}),s.data},t.prototype.getOrient=function(){var r=this.get("orient");return r==="horizontal"?r="LR":r==="vertical"&&(r="TB"),r},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.formatTooltip=function(r,a,o){for(var u=this.getData().tree,s=u.root.children[0],c=u.getNodeByDataIndex(r),l=c.getValue(),d=c.name;c&&c!==s;)d=c.parentNode.name+"."+d,c=c.parentNode;return createTooltipMarkup("nameValue",{name:d,value:l,noValue:isNaN(l)||l==null})},t.prototype.getDataParams=function(r){var a=n.prototype.getDataParams.apply(this,arguments),o=this.getData().tree.getNodeByDataIndex(r);return a.treeAncestors=wrapTreePathInfo(o,this),a.collapsed=!o.isExpand,a},t.type="series.tree",t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},t}(SeriesModel);function eachAfter(n,t,r){for(var a=[n],o=[],u;u=a.pop();)if(o.push(u),u.isExpand){var s=u.children;if(s.length)for(var c=0;c<s.length;c++)a.push(s[c])}for(;u=o.pop();)t(u,r)}function eachBefore(n,t){for(var r=[n],a;a=r.pop();)if(t(a),a.isExpand){var o=a.children;if(o.length)for(var u=o.length-1;u>=0;u--)r.push(o[u])}}function treeLayout(n,t){n.eachSeriesByType("tree",function(r){commonLayout(r,t)})}function commonLayout(n,t){var r=getViewRect$4(n,t);n.layoutInfo=r;var a=n.get("layout"),o=0,u=0,s=null;a==="radial"?(o=2*Math.PI,u=Math.min(r.height,r.width)/2,s=separation(function(A,R){return(A.parentNode===R.parentNode?1:2)/A.depth})):(o=r.width,u=r.height,s=separation());var c=n.getData().tree.root,l=c.children[0];if(l){init(c),eachAfter(l,firstWalk,s),c.hierNode.modifier=-l.hierNode.prelim,eachBefore(l,secondWalk);var d=l,f=l,h=l;eachBefore(l,function(A){var R=A.getLayout().x;R<d.getLayout().x&&(d=A),R>f.getLayout().x&&(f=A),A.depth>h.depth&&(h=A)});var v=d===f?1:s(d,f)/2,g=v-d.getLayout().x,b=0,_=0,S=0,T=0;if(a==="radial")b=o/(f.getLayout().x+v+g),_=u/(h.depth-1||1),eachBefore(l,function(A){S=(A.getLayout().x+g)*b,T=(A.depth-1)*_;var R=radialCoordinate(S,T);A.setLayout({x:R.x,y:R.y,rawX:S,rawY:T},!0)});else{var w=n.getOrient();w==="RL"||w==="LR"?(_=u/(f.getLayout().x+v+g),b=o/(h.depth-1||1),eachBefore(l,function(A){T=(A.getLayout().x+g)*_,S=w==="LR"?(A.depth-1)*b:o-(A.depth-1)*b,A.setLayout({x:S,y:T},!0)})):(w==="TB"||w==="BT")&&(b=o/(f.getLayout().x+v+g),_=u/(h.depth-1||1),eachBefore(l,function(A){S=(A.getLayout().x+g)*b,T=w==="TB"?(A.depth-1)*_:u-(A.depth-1)*_,A.setLayout({x:S,y:T},!0)}))}}}function treeVisual(n){n.eachSeriesByType("tree",function(t){var r=t.getData(),a=r.tree;a.eachNode(function(o){var u=o.getModel(),s=u.getModel("itemStyle").getItemStyle(),c=r.ensureUniqueItemVisual(o.dataIndex,"style");extend$1(c,s)})})}function installTreeAction(n){n.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"tree",query:t},function(a){var o=t.dataIndex,u=a.getData().tree,s=u.getNodeByDataIndex(o);s.isExpand=!s.isExpand})}),n.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(t,r,a){r.eachComponent({mainType:"series",subType:"tree",query:t},function(o){var u=o.coordinateSystem,s=updateCenterAndZoom(u,t,void 0,a);o.setCenter&&o.setCenter(s.center),o.setZoom&&o.setZoom(s.zoom)})})}function install$H(n){n.registerChartView(TreeView),n.registerSeriesModel(TreeSeriesModel),n.registerLayout(treeLayout),n.registerVisual(treeVisual),installTreeAction(n)}var actionTypes=["treemapZoomToNode","treemapRender","treemapMove"];function installTreemapAction(n){for(var t=0;t<actionTypes.length;t++)n.registerAction({type:actionTypes[t],update:"updateView"},noop$3);n.registerAction({type:"treemapRootToNode",update:"updateView"},function(r,a){a.eachComponent({mainType:"series",subType:"treemap",query:r},o);function o(u,s){var c=["treemapZoomToNode","treemapRootToNode"],l=retrieveTargetInfo(r,c,u);if(l){var d=u.getViewRoot();d&&(r.direction=aboveViewRoot(d,l.node)?"rollUp":"drillDown"),u.resetViewRoot(l.node)}}})}function enableAriaDecalForTree(n){var t=n.getData(),r=t.tree,a={};r.eachNode(function(o){for(var u=o;u&&u.depth>1;)u=u.parentNode;var s=getDecalFromPalette(n.ecModel,u.name||u.dataIndex+"",a);o.setVisual("decal",s)})}var TreemapSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.preventUsingHoverLayer=!0,r}return t.prototype.getInitialData=function(r,a){var o={name:r.name,children:r.data};completeTreeValue$1(o);var u=r.levels||[],s=this.designatedVisualItemStyle={},c=new Model({itemStyle:s},this,a);u=r.levels=setDefault(u,a);var l=map$1(u||[],function(h){return new Model(h,c,a)},this),d=Tree.createTree(o,this,f);function f(h){h.wrapMethod("getItemModel",function(v,g){var b=d.getNodeByDataIndex(g),_=b?l[b.depth]:null;return v.parentModel=_||c,v})}return d.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.formatTooltip=function(r,a,o){var u=this.getData(),s=this.getRawValue(r),c=u.getName(r);return createTooltipMarkup("nameValue",{name:c,value:s})},t.prototype.getDataParams=function(r){var a=n.prototype.getDataParams.apply(this,arguments),o=this.getData().tree.getNodeByDataIndex(r);return a.treeAncestors=wrapTreePathInfo(o,this),a.treePathInfo=a.treeAncestors,a},t.prototype.setLayoutInfo=function(r){this.layoutInfo=this.layoutInfo||{},extend$1(this.layoutInfo,r)},t.prototype.mapIdToIndex=function(r){var a=this._idIndexMap;a||(a=this._idIndexMap=createHashMap(),this._idIndexMapCount=0);var o=a.get(r);return o==null&&a.set(r,o=this._idIndexMapCount++),o},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var a=this.getRawData().tree.root;(!r||r!==a&&!a.contains(r))&&(this._viewRoot=a)},t.prototype.enableAriaDecal=function(){enableAriaDecalForTree(this)},t.type="series.treemap",t.layoutMode="box",t.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"",zoomToNodeRatio:.32*.32,scaleLimit:null,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},t}(SeriesModel);function completeTreeValue$1(n){var t=0;each$f(n.children,function(a){completeTreeValue$1(a);var o=a.value;isArray$2(o)&&(o=o[0]),t+=o});var r=n.value;isArray$2(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),isArray$2(n.value)?n.value[0]=r:n.value=r}function setDefault(n,t){var r=normalizeToArray(t.get("color")),a=normalizeToArray(t.get(["aria","decal","decals"]));if(r){n=n||[];var o,u;each$f(n,function(c){var l=new Model(c),d=l.get("color"),f=l.get("decal");(l.get(["itemStyle","color"])||d&&d!=="none")&&(o=!0),(l.get(["itemStyle","decal"])||f&&f!=="none")&&(u=!0)});var s=n[0]||(n[0]={});return o||(s.color=r.slice()),!u&&a&&(s.decal=a.slice()),n}}var TEXT_PADDING=8,ITEM_GAP=8,ARRAY_LENGTH=5,Breadcrumb=function(){function n(t){this.group=new Group$3,t.add(this.group)}return n.prototype.render=function(t,r,a,o){var u=t.getModel("breadcrumb"),s=this.group;if(s.removeAll(),!(!u.get("show")||!a)){var c=u.getModel("itemStyle"),l=u.getModel("emphasis"),d=c.getModel("textStyle"),f=l.getModel(["itemStyle","textStyle"]),h={pos:{left:u.get("left"),right:u.get("right"),top:u.get("top"),bottom:u.get("bottom")},box:{width:r.getWidth(),height:r.getHeight()},emptyItemWidth:u.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(a,h,d),this._renderContent(t,h,c,l,d,f,o),positionElement(s,h.pos,h.box)}},n.prototype._prepare=function(t,r,a){for(var o=t;o;o=o.parentNode){var u=convertOptionIdName(o.getModel().get("name"),""),s=a.getTextRect(u),c=Math.max(s.width+TEXT_PADDING*2,r.emptyItemWidth);r.totalWidth+=c+ITEM_GAP,r.renderList.push({node:o,text:u,width:c})}},n.prototype._renderContent=function(t,r,a,o,u,s,c){for(var l=0,d=r.emptyItemWidth,f=t.get(["breadcrumb","height"]),h=getAvailableSize(r.pos,r.box),v=r.totalWidth,g=r.renderList,b=o.getModel("itemStyle").getItemStyle(),_=g.length-1;_>=0;_--){var S=g[_],T=S.node,w=S.width,A=S.text;v>h.width&&(v-=w-d,w=d,A=null);var R=new Polygon({shape:{points:makeItemPoints(l,0,w,f,_===g.length-1,_===0)},style:defaults$h(a.getItemStyle(),{lineJoin:"bevel"}),textContent:new ZRText({style:createTextStyle(u,{text:A})}),textConfig:{position:"inside"},z2:Z2_EMPHASIS_LIFT*1e4,onclick:curry$1(c,T)});R.disableLabelAnimation=!0,R.getTextContent().ensureState("emphasis").style=createTextStyle(s,{text:A}),R.ensureState("emphasis").style=b,toggleHoverEmphasis(R,o.get("focus"),o.get("blurScope"),o.get("disabled")),this.group.add(R),packEventData(R,t,T),l+=w+ITEM_GAP}},n.prototype.remove=function(){this.group.removeAll()},n}();function makeItemPoints(n,t,r,a,o,u){var s=[[o?n:n-ARRAY_LENGTH,t],[n+r,t],[n+r,t+a],[o?n:n-ARRAY_LENGTH,t+a]];return!u&&s.splice(2,0,[n+r+ARRAY_LENGTH,t+a/2]),!o&&s.push([n,t+a/2]),s}function packEventData(n,t,r){getECData(n).eventData={componentType:"series",componentSubType:"treemap",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:r&&r.dataIndex,name:r&&r.name},treePathInfo:r&&wrapTreePathInfo(r,t)}}var AnimationWrap=function(){function n(){this._storage=[],this._elExistsMap={}}return n.prototype.add=function(t,r,a,o,u){return this._elExistsMap[t.id]?!1:(this._elExistsMap[t.id]=!0,this._storage.push({el:t,target:r,duration:a,delay:o,easing:u}),!0)},n.prototype.finished=function(t){return this._finishedCallback=t,this},n.prototype.start=function(){for(var t=this,r=this._storage.length,a=function(){r--,r<=0&&(t._storage.length=0,t._elExistsMap={},t._finishedCallback&&t._finishedCallback())},o=0,u=this._storage.length;o<u;o++){var s=this._storage[o];s.el.animateTo(s.target,{duration:s.duration,delay:s.delay,easing:s.easing,setToFinal:!0,done:a,aborted:a})}return this},n}();function createWrap(){return new AnimationWrap}var Group$2=Group$3,Rect$1=Rect$2,DRAG_THRESHOLD=3,PATH_LABEL_NOAMAL="label",PATH_UPPERLABEL_NORMAL="upperLabel",Z2_BASE=Z2_EMPHASIS_LIFT*10,Z2_BG=Z2_EMPHASIS_LIFT*2,Z2_CONTENT=Z2_EMPHASIS_LIFT*3,getStateItemStyle=makeStyleMapper([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),getItemStyleNormal=function(n){var t=getStateItemStyle(n);return t.stroke=t.fill=t.lineWidth=null,t},inner$d=makeInner(),TreemapView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._state="ready",r._storage=createStorage(),r}return t.prototype.render=function(r,a,o,u){var s=a.findComponents({mainType:"series",subType:"treemap",query:u});if(!(indexOf(s,r)<0)){this.seriesModel=r,this.api=o,this.ecModel=a;var c=["treemapZoomToNode","treemapRootToNode"],l=retrieveTargetInfo(u,c,r),d=u&&u.type,f=r.layoutInfo,h=!this._oldTree,v=this._storage,g=d==="treemapRootToNode"&&l&&v?{rootNodeGroup:v.nodeGroup[l.node.getRawIndex()],direction:u.direction}:null,b=this._giveContainerGroup(f),_=r.get("animation"),S=this._doRender(b,r,g);_&&!h&&(!d||d==="treemapZoomToNode"||d==="treemapRootToNode")?this._doAnimation(b,S,r,g):S.renderFinally(),this._resetController(o),this._renderBreadcrumb(r,o,l)}},t.prototype._giveContainerGroup=function(r){var a=this._containerGroup;return a||(a=this._containerGroup=new Group$2,this._initEvents(a),this.group.add(a)),a.x=r.x,a.y=r.y,a},t.prototype._doRender=function(r,a,o){var u=a.getData().tree,s=this._oldTree,c=createStorage(),l=createStorage(),d=this._storage,f=[];function h(w,A,R,E){return renderNode(a,l,d,o,c,f,w,A,R,E)}_(u.root?[u.root]:[],s&&s.root?[s.root]:[],r,u===s||!s,0);var v=S(d);if(this._oldTree=u,this._storage=l,this._controllerHost){var g=this.seriesModel.layoutInfo,b=u.root.getLayout();b.width===g.width&&b.height===g.height&&(this._controllerHost.zoom=1)}return{lastsForAnimation:c,willDeleteEls:v,renderFinally:T};function _(w,A,R,E,I){E?(A=w,each$f(w,function(D,$){!D.isRemoved()&&F($,$)})):new DataDiffer(A,w,L,L).add(F).update(F).remove(curry$1(F,null)).execute();function L(D){return D.getId()}function F(D,$){var O=D!=null?w[D]:null,P=$!=null?A[$]:null,C=h(O,P,R,I);C&&_(O&&O.viewChildren||[],P&&P.viewChildren||[],C,E,I+1)}}function S(w){var A=createStorage();return w&&each$f(w,function(R,E){var I=A[E];each$f(R,function(L){L&&(I.push(L),inner$d(L).willDelete=!0)})}),A}function T(){each$f(v,function(w){each$f(w,function(A){A.parent&&A.parent.remove(A)})}),each$f(f,function(w){w.invisible=!0,w.dirty()})}},t.prototype._doAnimation=function(r,a,o,u){var s=o.get("animationDurationUpdate"),c=o.get("animationEasing"),l=(isFunction$1(s)?0:s)||0,d=(isFunction$1(c)?null:c)||"cubicOut",f=createWrap();each$f(a.willDeleteEls,function(h,v){each$f(h,function(g,b){if(!g.invisible){var _=g.parent,S,T=inner$d(_);if(u&&u.direction==="drillDown")S=_===u.rootNodeGroup?{shape:{x:0,y:0,width:T.nodeWidth,height:T.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var w=0,A=0;T.willDelete||(w=T.nodeWidth/2,A=T.nodeHeight/2),S=v==="nodeGroup"?{x:w,y:A,style:{opacity:0}}:{shape:{x:w,y:A,width:0,height:0},style:{opacity:0}}}S&&f.add(g,S,l,0,d)}})}),each$f(this._storage,function(h,v){each$f(h,function(g,b){var _=a.lastsForAnimation[v][b],S={};_&&(g instanceof Group$3?_.oldX!=null&&(S.x=g.x,S.y=g.y,g.x=_.oldX,g.y=_.oldY):(_.oldShape&&(S.shape=extend$1({},g.shape),g.setShape(_.oldShape)),_.fadein?(g.setStyle("opacity",0),S.style={opacity:1}):g.style.opacity!==1&&(S.style={opacity:1})),f.add(g,S,l,0,d))})},this),this._state="animating",f.finished(bind$1(function(){this._state="ready",a.renderFinally()},this)).start()},t.prototype._resetController=function(r){var a=this._controller,o=this._controllerHost;o||(this._controllerHost={target:this.group},o=this._controllerHost),a||(a=this._controller=new RoamController(r.getZr()),a.enable(this.seriesModel.get("roam")),o.zoomLimit=this.seriesModel.get("scaleLimit"),o.zoom=this.seriesModel.get("zoom"),a.on("pan",bind$1(this._onPan,this)),a.on("zoom",bind$1(this._onZoom,this)));var u=new BoundingRect(0,0,r.getWidth(),r.getHeight());a.setPointerChecker(function(s,c,l){return u.contain(c,l)})},t.prototype._clearController=function(){var r=this._controller;this._controllerHost=null,r&&(r.dispose(),r=null)},t.prototype._onPan=function(r){if(this._state!=="animating"&&(Math.abs(r.dx)>DRAG_THRESHOLD||Math.abs(r.dy)>DRAG_THRESHOLD)){var a=this.seriesModel.getData().tree.root;if(!a)return;var o=a.getLayout();if(!o)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x+r.dx,y:o.y+r.dy,width:o.width,height:o.height}})}},t.prototype._onZoom=function(r){var a=r.originX,o=r.originY,u=r.scale;if(this._state!=="animating"){var s=this.seriesModel.getData().tree.root;if(!s)return;var c=s.getLayout();if(!c)return;var l=new BoundingRect(c.x,c.y,c.width,c.height),d=null,f=this._controllerHost;d=f.zoomLimit;var h=f.zoom=f.zoom||1;if(h*=u,d){var v=d.min||0,g=d.max||1/0;h=Math.max(Math.min(g,h),v)}var b=h/f.zoom;f.zoom=h;var _=this.seriesModel.layoutInfo;a-=_.x,o-=_.y;var S=create$2();translate$1(S,S,[-a,-o]),scale$2(S,S,[b,b]),translate$1(S,S,[a,o]),l.applyTransform(S),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:l.x,y:l.y,width:l.width,height:l.height}})}},t.prototype._initEvents=function(r){var a=this;r.on("click",function(o){if(a._state==="ready"){var u=a.seriesModel.get("nodeClick",!0);if(u){var s=a.findTarget(o.offsetX,o.offsetY);if(s){var c=s.node;if(c.getLayout().isLeafRoot)a._rootToNode(s);else if(u==="zoomToNode")a._zoomToNode(s);else if(u==="link"){var l=c.hostTree.data.getItemModel(c.dataIndex),d=l.get("link",!0),f=l.get("target",!0)||"blank";d&&windowOpen(d,f)}}}}},this)},t.prototype._renderBreadcrumb=function(r,a,o){var u=this;o||(o=r.get("leafDepth",!0)!=null?{node:r.getViewRoot()}:this.findTarget(a.getWidth()/2,a.getHeight()/2),o||(o={node:r.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new Breadcrumb(this.group))).render(r,a,o.node,function(s){u._state!=="animating"&&(aboveViewRoot(r.getViewRoot(),s)?u._rootToNode({node:s}):u._zoomToNode({node:s}))})},t.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=createStorage(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},t.prototype.dispose=function(){this._clearController()},t.prototype._zoomToNode=function(r){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype._rootToNode=function(r){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype.findTarget=function(r,a){var o,u=this.seriesModel.getViewRoot();return u.eachNode({attr:"viewChildren",order:"preorder"},function(s){var c=this._storage.background[s.getRawIndex()];if(c){var l=c.transformCoordToLocal(r,a),d=c.shape;if(d.x<=l[0]&&l[0]<=d.x+d.width&&d.y<=l[1]&&l[1]<=d.y+d.height)o={node:s,offsetX:l[0],offsetY:l[1]};else return!1}},this),o},t.type="treemap",t}(ChartView);function createStorage(){return{nodeGroup:[],background:[],content:[]}}function renderNode(n,t,r,a,o,u,s,c,l,d){if(!s)return;var f=s.getLayout(),h=n.getData(),v=s.getModel();if(h.setItemGraphicEl(s.dataIndex,null),!f||!f.isInView)return;var g=f.width,b=f.height,_=f.borderWidth,S=f.invisible,T=s.getRawIndex(),w=c&&c.getRawIndex(),A=s.viewChildren,R=f.upperHeight,E=A&&A.length,I=v.getModel("itemStyle"),L=v.getModel(["emphasis","itemStyle"]),F=v.getModel(["blur","itemStyle"]),D=v.getModel(["select","itemStyle"]),$=I.get("borderRadius")||0,O=ye("nodeGroup",Group$2);if(!O)return;if(l.add(O),O.x=f.x||0,O.y=f.y||0,O.markRedraw(),inner$d(O).nodeWidth=g,inner$d(O).nodeHeight=b,f.isAboveViewRoot)return O;var P=ye("background",Rect$1,d,Z2_BG);P&&W(O,P,E&&f.upperLabelHeight);var C=v.getModel("emphasis"),q=C.get("focus"),M=C.get("blurScope"),N=C.get("disabled"),G=q==="ancestor"?s.getAncestorsIndices():q==="descendant"?s.getDescendantIndices():q;if(E)isHighDownDispatcher(O)&&setAsHighDownDispatcher(O,!1),P&&(setAsHighDownDispatcher(P,!N),h.setItemGraphicEl(s.dataIndex,P),enableHoverFocus(P,G,M));else{var X=ye("content",Rect$1,d,Z2_CONTENT);X&&te(O,X),P.disableMorphing=!0,P&&isHighDownDispatcher(P)&&setAsHighDownDispatcher(P,!1),setAsHighDownDispatcher(O,!N),h.setItemGraphicEl(s.dataIndex,O);var Y=v.getShallow("cursor");Y&&X.attr("cursor",Y),enableHoverFocus(O,G,M)}return O;function W(ve,ce,J){var j=getECData(ce);if(j.dataIndex=s.dataIndex,j.seriesIndex=n.seriesIndex,ce.setShape({x:0,y:0,width:g,height:b,r:$}),S)ue(ce);else{ce.invisible=!1;var z=s.getVisual("style"),B=z.stroke,U=getItemStyleNormal(I);U.fill=B;var Z=getStateItemStyle(L);Z.fill=L.get("borderColor");var oe=getStateItemStyle(F);oe.fill=F.get("borderColor");var ie=getStateItemStyle(D);if(ie.fill=D.get("borderColor"),J){var se=g-2*_;fe(ce,B,z.opacity,{x:_,y:0,width:se,height:R})}else ce.removeTextContent();ce.setStyle(U),ce.ensureState("emphasis").style=Z,ce.ensureState("blur").style=oe,ce.ensureState("select").style=ie,setDefaultStateProxy(ce)}ve.add(ce)}function te(ve,ce){var J=getECData(ce);J.dataIndex=s.dataIndex,J.seriesIndex=n.seriesIndex;var j=Math.max(g-2*_,0),z=Math.max(b-2*_,0);if(ce.culling=!0,ce.setShape({x:_,y:_,width:j,height:z,r:$}),S)ue(ce);else{ce.invisible=!1;var B=s.getVisual("style"),U=B.fill,Z=getItemStyleNormal(I);Z.fill=U,Z.decal=B.decal;var oe=getStateItemStyle(L),ie=getStateItemStyle(F),se=getStateItemStyle(D);fe(ce,U,B.opacity,null),ce.setStyle(Z),ce.ensureState("emphasis").style=oe,ce.ensureState("blur").style=ie,ce.ensureState("select").style=se,setDefaultStateProxy(ce)}ve.add(ce)}function ue(ve){!ve.invisible&&u.push(ve)}function fe(ve,ce,J,j){var z=v.getModel(j?PATH_UPPERLABEL_NORMAL:PATH_LABEL_NOAMAL),B=convertOptionIdName(v.get("name"),null),U=z.getShallow("show");setLabelStyle(ve,getLabelStatesModels(v,j?PATH_UPPERLABEL_NORMAL:PATH_LABEL_NOAMAL),{defaultText:U?B:null,inheritColor:ce,defaultOpacity:J,labelFetcher:n,labelDataIndex:s.dataIndex});var Z=ve.getTextContent();if(Z){var oe=Z.style,ie=normalizeCssArray$1(oe.padding||0);j&&(ve.setTextConfig({layoutRect:j}),Z.disableLabelLayout=!0),Z.beforeUpdate=function(){var ne=Math.max((j?j.width:ve.shape.width)-ie[1]-ie[3],0),he=Math.max((j?j.height:ve.shape.height)-ie[0]-ie[2],0);(oe.width!==ne||oe.height!==he)&&Z.setStyle({width:ne,height:he})},oe.truncateMinChar=2,oe.lineOverflow="truncate",re(oe,j,f);var se=Z.getState("emphasis");re(se?se.style:null,j,f)}}function re(ve,ce,J){var j=ve?ve.text:null;if(!ce&&J.isLeafRoot&&j!=null){var z=n.get("drillDownIcon",!0);ve.text=z?z+" "+j:j}}function ye(ve,ce,J,j){var z=w!=null&&r[ve][w],B=o[ve];return z?(r[ve][w]=null,Te(B,z)):S||(z=new ce,z instanceof Displayable&&(z.z2=calculateZ2(J,j)),Re(B,z)),t[ve][T]=z}function Te(ve,ce){var J=ve[T]={};ce instanceof Group$2?(J.oldX=ce.x,J.oldY=ce.y):J.oldShape=extend$1({},ce.shape)}function Re(ve,ce){var J=ve[T]={},j=s.parentNode,z=ce instanceof Group$3;if(j&&(!a||a.direction==="drillDown")){var B=0,U=0,Z=o.background[j.getRawIndex()];!a&&Z&&Z.oldShape&&(B=Z.oldShape.width,U=Z.oldShape.height),z?(J.oldX=0,J.oldY=U):J.oldShape={x:B,y:U,width:0,height:0}}J.fadein=!z}}function calculateZ2(n,t){return n*Z2_BASE+t}var each$c=each$f,isObject$1=isObject$4,CATEGORY_DEFAULT_VISUAL_INDEX=-1,VisualMapping=function(){function n(t){var r=t.mappingMethod,a=t.type,o=this.option=clone$5(t);this.type=a,this.mappingMethod=r,this._normalizeData=normalizers[r];var u=n.visualHandlers[a];this.applyVisual=u.applyVisual,this.getColorMapper=u.getColorMapper,this._normalizedToVisual=u._normalizedToVisual[r],r==="piecewise"?(normalizeVisualRange(o),preprocessForPiecewise(o)):r==="category"?o.categories?preprocessForSpecifiedCategory(o):normalizeVisualRange(o,!0):(assert(r!=="linear"||o.dataExtent),normalizeVisualRange(o))}return n.prototype.mapValueToVisual=function(t){var r=this._normalizeData(t);return this._normalizedToVisual(r,t)},n.prototype.getNormalizer=function(){return bind$1(this._normalizeData,this)},n.listVisualTypes=function(){return keys(n.visualHandlers)},n.isValidType=function(t){return n.visualHandlers.hasOwnProperty(t)},n.eachVisual=function(t,r,a){isObject$4(t)?each$f(t,r,a):r.call(a,t)},n.mapVisual=function(t,r,a){var o,u=isArray$2(t)?[]:isObject$4(t)?{}:(o=!0,null);return n.eachVisual(t,function(s,c){var l=r.call(a,s,c);o?u=l:u[c]=l}),u},n.retrieveVisuals=function(t){var r={},a;return t&&each$c(n.visualHandlers,function(o,u){t.hasOwnProperty(u)&&(r[u]=t[u],a=!0)}),a?r:null},n.prepareVisualTypes=function(t){if(isArray$2(t))t=t.slice();else if(isObject$1(t)){var r=[];each$c(t,function(a,o){r.push(o)}),t=r}else return[];return t.sort(function(a,o){return o==="color"&&a!=="color"&&a.indexOf("color")===0?1:-1}),t},n.dependsOn=function(t,r){return r==="color"?!!(t&&t.indexOf(r)===0):t===r},n.findPieceIndex=function(t,r,a){for(var o,u=1/0,s=0,c=r.length;s<c;s++){var l=r[s].value;if(l!=null){if(l===t||isString(l)&&l===t+"")return s;a&&v(l,s)}}for(var s=0,c=r.length;s<c;s++){var d=r[s],f=d.interval,h=d.close;if(f){if(f[0]===-1/0){if(littleThan(h[1],t,f[1]))return s}else if(f[1]===1/0){if(littleThan(h[0],f[0],t))return s}else if(littleThan(h[0],f[0],t)&&littleThan(h[1],t,f[1]))return s;a&&v(f[0],s),a&&v(f[1],s)}}if(a)return t===1/0?r.length-1:t===-1/0?0:o;function v(g,b){var _=Math.abs(g-t);_<u&&(u=_,o=b)}},n.visualHandlers={color:{applyVisual:makeApplyVisual("color"),getColorMapper:function(){var t=this.option;return bind$1(t.mappingMethod==="category"?function(r,a){return!a&&(r=this._normalizeData(r)),doMapCategory.call(this,r)}:function(r,a,o){var u=!!o;return!a&&(r=this._normalizeData(r)),o=fastLerp(r,t.parsedVisual,o),u?o:stringify$2(o,"rgba")},this)},_normalizedToVisual:{linear:function(t){return stringify$2(fastLerp(t,this.option.parsedVisual),"rgba")},category:doMapCategory,piecewise:function(t,r){var a=getSpecifiedVisual.call(this,r);return a==null&&(a=stringify$2(fastLerp(t,this.option.parsedVisual),"rgba")),a},fixed:doMapFixed}},colorHue:makePartialColorVisualHandler(function(t,r){return modifyHSL(t,r)}),colorSaturation:makePartialColorVisualHandler(function(t,r){return modifyHSL(t,null,r)}),colorLightness:makePartialColorVisualHandler(function(t,r){return modifyHSL(t,null,null,r)}),colorAlpha:makePartialColorVisualHandler(function(t,r){return modifyAlpha(t,r)}),decal:{applyVisual:makeApplyVisual("decal"),_normalizedToVisual:{linear:null,category:doMapCategory,piecewise:null,fixed:null}},opacity:{applyVisual:makeApplyVisual("opacity"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])},liftZ:{applyVisual:makeApplyVisual("liftZ"),_normalizedToVisual:{linear:doMapFixed,category:doMapFixed,piecewise:doMapFixed,fixed:doMapFixed}},symbol:{applyVisual:function(t,r,a){var o=this.mapValueToVisual(t);a("symbol",o)},_normalizedToVisual:{linear:doMapToArray,category:doMapCategory,piecewise:function(t,r){var a=getSpecifiedVisual.call(this,r);return a==null&&(a=doMapToArray.call(this,t)),a},fixed:doMapFixed}},symbolSize:{applyVisual:makeApplyVisual("symbolSize"),_normalizedToVisual:createNormalizedToNumericVisual([0,1])}},n}();function preprocessForPiecewise(n){var t=n.pieceList;n.hasSpecialVisual=!1,each$f(t,function(r,a){r.originIndex=a,r.visual!=null&&(n.hasSpecialVisual=!0)})}function preprocessForSpecifiedCategory(n){var t=n.categories,r=n.categoryMap={},a=n.visual;if(each$c(t,function(s,c){r[s]=c}),!isArray$2(a)){var o=[];isObject$4(a)?each$c(a,function(s,c){var l=r[c];o[l??CATEGORY_DEFAULT_VISUAL_INDEX]=s}):o[CATEGORY_DEFAULT_VISUAL_INDEX]=a,a=setVisualToOption(n,o)}for(var u=t.length-1;u>=0;u--)a[u]==null&&(delete r[t[u]],t.pop())}function normalizeVisualRange(n,t){var r=n.visual,a=[];isObject$4(r)?each$c(r,function(u){a.push(u)}):r!=null&&a.push(r);var o={color:1,symbol:1};!t&&a.length===1&&!o.hasOwnProperty(n.type)&&(a[1]=a[0]),setVisualToOption(n,a)}function makePartialColorVisualHandler(n){return{applyVisual:function(t,r,a){var o=this.mapValueToVisual(t);a("color",n(r("color"),o))},_normalizedToVisual:createNormalizedToNumericVisual([0,1])}}function doMapToArray(n){var t=this.option.visual;return t[Math.round(linearMap$2(n,[0,1],[0,t.length-1],!0))]||{}}function makeApplyVisual(n){return function(t,r,a){a(n,this.mapValueToVisual(t))}}function doMapCategory(n){var t=this.option.visual;return t[this.option.loop&&n!==CATEGORY_DEFAULT_VISUAL_INDEX?n%t.length:n]}function doMapFixed(){return this.option.visual[0]}function createNormalizedToNumericVisual(n){return{linear:function(t){return linearMap$2(t,n,this.option.visual,!0)},category:doMapCategory,piecewise:function(t,r){var a=getSpecifiedVisual.call(this,r);return a==null&&(a=linearMap$2(t,n,this.option.visual,!0)),a},fixed:doMapFixed}}function getSpecifiedVisual(n){var t=this.option,r=t.pieceList;if(t.hasSpecialVisual){var a=VisualMapping.findPieceIndex(n,r),o=r[a];if(o&&o.visual)return o.visual[this.type]}}function setVisualToOption(n,t){return n.visual=t,n.type==="color"&&(n.parsedVisual=map$1(t,function(r){var a=parse$4(r);return a||[0,0,0,1]})),t}var normalizers={linear:function(n){return linearMap$2(n,this.option.dataExtent,[0,1],!0)},piecewise:function(n){var t=this.option.pieceList,r=VisualMapping.findPieceIndex(n,t,!0);if(r!=null)return linearMap$2(r,[0,t.length-1],[0,1],!0)},category:function(n){var t=this.option.categories?this.option.categoryMap[n]:n;return t??CATEGORY_DEFAULT_VISUAL_INDEX},fixed:noop$3};function littleThan(n,t,r){return n?t<=r:t<r}var ITEM_STYLE_NORMAL="itemStyle",inner$c=makeInner();const treemapVisual={seriesType:"treemap",reset:function(n){var t=n.getData().tree,r=t.root;r.isRemoved()||travelTree(r,{},n.getViewRoot().getAncestors(),n)}};function travelTree(n,t,r,a){var o=n.getModel(),u=n.getLayout(),s=n.hostTree.data;if(!(!u||u.invisible||!u.isInView)){var c=o.getModel(ITEM_STYLE_NORMAL),l=buildVisuals(c,t,a),d=s.ensureUniqueItemVisual(n.dataIndex,"style"),f=c.get("borderColor"),h=c.get("borderColorSaturation"),v;h!=null&&(v=calculateColor(l),f=calculateBorderColor(h,v)),d.stroke=f;var g=n.viewChildren;if(!g||!g.length)v=calculateColor(l),d.fill=v;else{var b=buildVisualMapping(n,o,u,c,l,g);each$f(g,function(_,S){if(_.depth>=r.length||_===r[_.depth]){var T=mapVisual$1(o,l,_,S,b,a);travelTree(_,T,r,a)}})}}}function buildVisuals(n,t,r){var a=extend$1({},t),o=r.designatedVisualItemStyle;return each$f(["color","colorAlpha","colorSaturation"],function(u){o[u]=t[u];var s=n.get(u);o[u]=null,s!=null&&(a[u]=s)}),a}function calculateColor(n){var t=getValueVisualDefine(n,"color");if(t){var r=getValueVisualDefine(n,"colorAlpha"),a=getValueVisualDefine(n,"colorSaturation");return a&&(t=modifyHSL(t,null,null,a)),r&&(t=modifyAlpha(t,r)),t}}function calculateBorderColor(n,t){return t!=null?modifyHSL(t,null,null,n):null}function getValueVisualDefine(n,t){var r=n[t];if(r!=null&&r!=="none")return r}function buildVisualMapping(n,t,r,a,o,u){if(!(!u||!u.length)){var s=getRangeVisual(t,"color")||o.color!=null&&o.color!=="none"&&(getRangeVisual(t,"colorAlpha")||getRangeVisual(t,"colorSaturation"));if(s){var c=t.get("visualMin"),l=t.get("visualMax"),d=r.dataExtent.slice();c!=null&&c<d[0]&&(d[0]=c),l!=null&&l>d[1]&&(d[1]=l);var f=t.get("colorMappingBy"),h={type:s.name,dataExtent:d,visual:s.range};h.type==="color"&&(f==="index"||f==="id")?(h.mappingMethod="category",h.loop=!0):h.mappingMethod="linear";var v=new VisualMapping(h);return inner$c(v).drColorMappingBy=f,v}}}function getRangeVisual(n,t){var r=n.get(t);return isArray$2(r)&&r.length?{name:t,range:r}:null}function mapVisual$1(n,t,r,a,o,u){var s=extend$1({},t);if(o){var c=o.type,l=c==="color"&&inner$c(o).drColorMappingBy,d=l==="index"?a:l==="id"?u.mapIdToIndex(r.getId()):r.getValue(n.get("visualDimension"));s[c]=o.mapValueToVisual(d)}return s}var mathMax$3=Math.max,mathMin$3=Math.min,retrieveValue=retrieve,each$b=each$f,PATH_BORDER_WIDTH=["itemStyle","borderWidth"],PATH_GAP_WIDTH=["itemStyle","gapWidth"],PATH_UPPER_LABEL_SHOW=["upperLabel","show"],PATH_UPPER_LABEL_HEIGHT=["upperLabel","height"];const treemapLayout={seriesType:"treemap",reset:function(n,t,r,a){var o=r.getWidth(),u=r.getHeight(),s=n.option,c=getLayoutRect(n.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),l=s.size||[],d=parsePercent(retrieveValue(c.width,l[0]),o),f=parsePercent(retrieveValue(c.height,l[1]),u),h=a&&a.type,v=["treemapZoomToNode","treemapRootToNode"],g=retrieveTargetInfo(a,v,n),b=h==="treemapRender"||h==="treemapMove"?a.rootRect:null,_=n.getViewRoot(),S=getPathToRoot(_);if(h!=="treemapMove"){var T=h==="treemapZoomToNode"?estimateRootSize(n,g,_,d,f):b?[b.width,b.height]:[d,f],w=s.sort;w&&w!=="asc"&&w!=="desc"&&(w="desc");var A={squareRatio:s.squareRatio,sort:w,leafDepth:s.leafDepth};_.hostTree.clearLayouts();var R={x:0,y:0,width:T[0],height:T[1],area:T[0]*T[1]};_.setLayout(R),squarify(_,A,!1,0),R=_.getLayout(),each$b(S,function(I,L){var F=(S[L+1]||_).getValue();I.setLayout(extend$1({dataExtent:[F,F],borderWidth:0,upperHeight:0},R))})}var E=n.getData().tree.root;E.setLayout(calculateRootPosition(c,b,g),!0),n.setLayoutInfo(c),prunning(E,new BoundingRect(-c.x,-c.y,o,u),S,_,0)}};function squarify(n,t,r,a){var o,u;if(!n.isRemoved()){var s=n.getLayout();o=s.width,u=s.height;var c=n.getModel(),l=c.get(PATH_BORDER_WIDTH),d=c.get(PATH_GAP_WIDTH)/2,f=getUpperLabelHeight(c),h=Math.max(l,f),v=l-d,g=h-d;n.setLayout({borderWidth:l,upperHeight:h,upperLabelHeight:f},!0),o=mathMax$3(o-2*v,0),u=mathMax$3(u-v-g,0);var b=o*u,_=initChildren$1(n,c,b,t,r,a);if(_.length){var S={x:v,y:g,width:o,height:u},T=mathMin$3(o,u),w=1/0,A=[];A.area=0;for(var R=0,E=_.length;R<E;){var I=_[R];A.push(I),A.area+=I.getLayout().area;var L=worst(A,T,t.squareRatio);L<=w?(R++,w=L):(A.area-=A.pop().getLayout().area,position$1(A,T,S,d,!1),T=mathMin$3(S.width,S.height),A.length=A.area=0,w=1/0)}if(A.length&&position$1(A,T,S,d,!0),!r){var F=c.get("childrenVisibleMin");F!=null&&b<F&&(r=!0)}for(var R=0,E=_.length;R<E;R++)squarify(_[R],t,r,a+1)}}}function initChildren$1(n,t,r,a,o,u){var s=n.children||[],c=a.sort;c!=="asc"&&c!=="desc"&&(c=null);var l=a.leafDepth!=null&&a.leafDepth<=u;if(o&&!l)return n.viewChildren=[];s=filter$1(s,function(g){return!g.isRemoved()}),sort$1(s,c);var d=statistic(t,s,c);if(d.sum===0)return n.viewChildren=[];if(d.sum=filterByThreshold(t,r,d.sum,c,s),d.sum===0)return n.viewChildren=[];for(var f=0,h=s.length;f<h;f++){var v=s[f].getValue()/d.sum*r;s[f].setLayout({area:v})}return l&&(s.length&&n.setLayout({isLeafRoot:!0},!0),s.length=0),n.viewChildren=s,n.setLayout({dataExtent:d.dataExtent},!0),s}function filterByThreshold(n,t,r,a,o){if(!a)return r;for(var u=n.get("visibleMin"),s=o.length,c=s,l=s-1;l>=0;l--){var d=o[a==="asc"?s-l-1:l].getValue();d/r*t<u&&(c=l,r-=d)}return a==="asc"?o.splice(0,s-c):o.splice(c,s-c),r}function sort$1(n,t){return t&&n.sort(function(r,a){var o=t==="asc"?r.getValue()-a.getValue():a.getValue()-r.getValue();return o===0?t==="asc"?r.dataIndex-a.dataIndex:a.dataIndex-r.dataIndex:o}),n}function statistic(n,t,r){for(var a=0,o=0,u=t.length;o<u;o++)a+=t[o].getValue();var s=n.get("visualDimension"),c;return!t||!t.length?c=[NaN,NaN]:s==="value"&&r?(c=[t[t.length-1].getValue(),t[0].getValue()],r==="asc"&&c.reverse()):(c=[1/0,-1/0],each$b(t,function(l){var d=l.getValue(s);d<c[0]&&(c[0]=d),d>c[1]&&(c[1]=d)})),{sum:a,dataExtent:c}}function worst(n,t,r){for(var a=0,o=1/0,u=0,s=void 0,c=n.length;u<c;u++)s=n[u].getLayout().area,s&&(s<o&&(o=s),s>a&&(a=s));var l=n.area*n.area,d=t*t*r;return l?mathMax$3(d*a/l,l/(d*o)):1/0}function position$1(n,t,r,a,o){var u=t===r.width?0:1,s=1-u,c=["x","y"],l=["width","height"],d=r[c[u]],f=t?n.area/t:0;(o||f>r[l[s]])&&(f=r[l[s]]);for(var h=0,v=n.length;h<v;h++){var g=n[h],b={},_=f?g.getLayout().area/f:0,S=b[l[s]]=mathMax$3(f-2*a,0),T=r[c[u]]+r[l[u]]-d,w=h===v-1||T<_?T:_,A=b[l[u]]=mathMax$3(w-2*a,0);b[c[s]]=r[c[s]]+mathMin$3(a,S/2),b[c[u]]=d+mathMin$3(a,A/2),d+=w,g.setLayout(b,!0)}r[c[s]]+=f,r[l[s]]-=f}function estimateRootSize(n,t,r,a,o){var u=(t||{}).node,s=[a,o];if(!u||u===r)return s;for(var c,l=a*o,d=l*n.option.zoomToNodeRatio;c=u.parentNode;){for(var f=0,h=c.children,v=0,g=h.length;v<g;v++)f+=h[v].getValue();var b=u.getValue();if(b===0)return s;d*=f/b;var _=c.getModel(),S=_.get(PATH_BORDER_WIDTH),T=Math.max(S,getUpperLabelHeight(_));d+=4*S*S+(3*S+T)*Math.pow(d,.5),d>MAX_SAFE_INTEGER$1&&(d=MAX_SAFE_INTEGER$1),u=c}d<l&&(d=l);var w=Math.pow(d/l,.5);return[a*w,o*w]}function calculateRootPosition(n,t,r){if(t)return{x:t.x,y:t.y};var a={x:0,y:0};if(!r)return a;var o=r.node,u=o.getLayout();if(!u)return a;for(var s=[u.width/2,u.height/2],c=o;c;){var l=c.getLayout();s[0]+=l.x,s[1]+=l.y,c=c.parentNode}return{x:n.width/2-s[0],y:n.height/2-s[1]}}function prunning(n,t,r,a,o){var u=n.getLayout(),s=r[o],c=s&&s===n;if(!(s&&!c||o===r.length&&n!==a)){n.setLayout({isInView:!0,invisible:!c&&!t.intersect(u),isAboveViewRoot:c},!0);var l=new BoundingRect(t.x-u.x,t.y-u.y,t.width,t.height);each$b(n.viewChildren||[],function(d){prunning(d,l,r,a,o+1)})}}function getUpperLabelHeight(n){return n.get(PATH_UPPER_LABEL_SHOW)?n.get(PATH_UPPER_LABEL_HEIGHT):0}function install$G(n){n.registerSeriesModel(TreemapSeriesModel),n.registerChartView(TreemapView),n.registerVisual(treemapVisual),n.registerLayout(treemapLayout),installTreemapAction(n)}function categoryFilter(n){var t=n.findComponents({mainType:"legend"});!t||!t.length||n.eachSeriesByType("graph",function(r){var a=r.getCategoriesData(),o=r.getGraph(),u=o.data,s=a.mapArray(a.getName);u.filterSelf(function(c){var l=u.getItemModel(c),d=l.getShallow("category");if(d!=null){isNumber(d)&&(d=s[d]);for(var f=0;f<t.length;f++)if(!t[f].isSelected(d))return!1}return!0})})}function categoryVisual(n){var t={};n.eachSeriesByType("graph",function(r){var a=r.getCategoriesData(),o=r.getData(),u={};a.each(function(s){var c=a.getName(s);u["ec-"+c]=s;var l=a.getItemModel(s),d=l.getModel("itemStyle").getItemStyle();d.fill||(d.fill=r.getColorFromPalette(c,t)),a.setItemVisual(s,"style",d);for(var f=["symbol","symbolSize","symbolKeepAspect"],h=0;h<f.length;h++){var v=l.getShallow(f[h],!0);v!=null&&a.setItemVisual(s,f[h],v)}}),a.count()&&o.each(function(s){var c=o.getItemModel(s),l=c.getShallow("category");if(l!=null){isString(l)&&(l=u["ec-"+l]);var d=a.getItemVisual(l,"style"),f=o.ensureUniqueItemVisual(s,"style");extend$1(f,d);for(var h=["symbol","symbolSize","symbolKeepAspect"],v=0;v<h.length;v++)o.setItemVisual(s,h[v],a.getItemVisual(l,h[v]))}})})}function normalize$2(n){return n instanceof Array||(n=[n,n]),n}function graphEdgeVisual(n){n.eachSeriesByType("graph",function(t){var r=t.getGraph(),a=t.getEdgeData(),o=normalize$2(t.get("edgeSymbol")),u=normalize$2(t.get("edgeSymbolSize"));a.setVisual("fromSymbol",o&&o[0]),a.setVisual("toSymbol",o&&o[1]),a.setVisual("fromSymbolSize",u&&u[0]),a.setVisual("toSymbolSize",u&&u[1]),a.setVisual("style",t.getModel("lineStyle").getLineStyle()),a.each(function(s){var c=a.getItemModel(s),l=r.getEdgeByIndex(s),d=normalize$2(c.getShallow("symbol",!0)),f=normalize$2(c.getShallow("symbolSize",!0)),h=c.getModel("lineStyle").getLineStyle(),v=a.ensureUniqueItemVisual(s,"style");switch(extend$1(v,h),v.stroke){case"source":{var g=l.node1.getVisual("style");v.stroke=g&&g.fill;break}case"target":{var g=l.node2.getVisual("style");v.stroke=g&&g.fill;break}}d[0]&&l.setVisual("fromSymbol",d[0]),d[1]&&l.setVisual("toSymbol",d[1]),f[0]&&l.setVisual("fromSymbolSize",f[0]),f[1]&&l.setVisual("toSymbolSize",f[1])})})}var KEY_DELIMITER="-->",getAutoCurvenessParams=function(n){return n.get("autoCurveness")||null},createCurveness=function(n,t){var r=getAutoCurvenessParams(n),a=20,o=[];if(isNumber(r))a=r;else if(isArray$2(r)){n.__curvenessList=r;return}t>a&&(a=t);var u=a%2?a+2:a+3;o=[];for(var s=0;s<u;s++)o.push((s%2?s+1:s)/10*(s%2?-1:1));n.__curvenessList=o},getKeyOfEdges=function(n,t,r){var a=[n.id,n.dataIndex].join("."),o=[t.id,t.dataIndex].join(".");return[r.uid,a,o].join(KEY_DELIMITER)},getOppositeKey=function(n){var t=n.split(KEY_DELIMITER);return[t[0],t[2],t[1]].join(KEY_DELIMITER)},getEdgeFromMap=function(n,t){var r=getKeyOfEdges(n.node1,n.node2,t);return t.__edgeMap[r]},getTotalLengthBetweenNodes=function(n,t){var r=getEdgeMapLengthWithKey(getKeyOfEdges(n.node1,n.node2,t),t),a=getEdgeMapLengthWithKey(getKeyOfEdges(n.node2,n.node1,t),t);return r+a},getEdgeMapLengthWithKey=function(n,t){var r=t.__edgeMap;return r[n]?r[n].length:0};function initCurvenessList(n){getAutoCurvenessParams(n)&&(n.__curvenessList=[],n.__edgeMap={},createCurveness(n))}function createEdgeMapForCurveness(n,t,r,a){if(getAutoCurvenessParams(r)){var o=getKeyOfEdges(n,t,r),u=r.__edgeMap,s=u[getOppositeKey(o)];u[o]&&!s?u[o].isForward=!0:s&&u[o]&&(s.isForward=!0,u[o].isForward=!1),u[o]=u[o]||[],u[o].push(a)}}function getCurvenessForEdge(n,t,r,a){var o=getAutoCurvenessParams(t),u=isArray$2(o);if(!o)return null;var s=getEdgeFromMap(n,t);if(!s)return null;for(var c=-1,l=0;l<s.length;l++)if(s[l]===r){c=l;break}var d=getTotalLengthBetweenNodes(n,t);createCurveness(t,d),n.lineStyle=n.lineStyle||{};var f=getKeyOfEdges(n.node1,n.node2,t),h=t.__curvenessList,v=u||d%2?0:1;if(s.isForward)return h[v+c];var g=getOppositeKey(f),b=getEdgeMapLengthWithKey(g,t),_=h[c+b+v];return a?u?o&&o[0]===0?(b+v)%2?_:-_:((b%2?0:1)+v)%2?_:-_:(b+v)%2?_:-_:h[c+b+v]}function simpleLayout(n){var t=n.coordinateSystem;if(!(t&&t.type!=="view")){var r=n.getGraph();r.eachNode(function(a){var o=a.getModel();a.setLayout([+o.get("x"),+o.get("y")])}),simpleLayoutEdge(r,n)}}function simpleLayoutEdge(n,t){n.eachEdge(function(r,a){var o=retrieve3(r.getModel().get(["lineStyle","curveness"]),-getCurvenessForEdge(r,t,a,!0),0),u=clone$4(r.node1.getLayout()),s=clone$4(r.node2.getLayout()),c=[u,s];+o&&c.push([(u[0]+s[0])/2-(u[1]-s[1])*o,(u[1]+s[1])/2-(s[0]-u[0])*o]),r.setLayout(c)})}function graphSimpleLayout(n,t){n.eachSeriesByType("graph",function(r){var a=r.get("layout"),o=r.coordinateSystem;if(o&&o.type!=="view"){var u=r.getData(),s=[];each$f(o.dimensions,function(v){s=s.concat(u.mapDimensionsAll(v))});for(var c=0;c<u.count();c++){for(var l=[],d=!1,f=0;f<s.length;f++){var h=u.get(s[f],c);isNaN(h)||(d=!0),l.push(h)}d?u.setItemLayout(c,o.dataToPoint(l)):u.setItemLayout(c,[NaN,NaN])}simpleLayoutEdge(u.graph,r)}else(!a||a==="none")&&simpleLayout(r)})}function getNodeGlobalScale(n){var t=n.coordinateSystem;if(t.type!=="view")return 1;var r=n.option.nodeScaleRatio,a=t.scaleX,o=t.getZoom(),u=(o-1)*r+1;return u/a}function getSymbolSize(n){var t=n.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}var PI$2=Math.PI,_symbolRadiansHalf=[];function circularLayout(n,t,r,a){var o=n.coordinateSystem;if(!(o&&o.type!=="view")){var u=o.getBoundingRect(),s=n.getData(),c=s.graph,l=u.width/2+u.x,d=u.height/2+u.y,f=Math.min(u.width,u.height)/2,h=s.count();if(s.setLayout({cx:l,cy:d}),!!h){if(r){var v=o.pointToData(a),g=v[0],b=v[1],_=[g-l,b-d];normalize$4(_,_),scale$3(_,_,f),r.setLayout([l+_[0],d+_[1]],!0);var S=n.get(["circular","rotateLabel"]);rotateNodeLabel(r,S,l,d)}_layoutNodesBasedOn[t](n,c,s,f,l,d,h),c.eachEdge(function(T,w){var A=retrieve3(T.getModel().get(["lineStyle","curveness"]),getCurvenessForEdge(T,n,w),0),R=clone$4(T.node1.getLayout()),E=clone$4(T.node2.getLayout()),I,L=(R[0]+E[0])/2,F=(R[1]+E[1])/2;+A&&(A*=3,I=[l*A+L*(1-A),d*A+F*(1-A)]),T.setLayout([R,E,I])})}}}var _layoutNodesBasedOn={value:function(n,t,r,a,o,u,s){var c=0,l=r.getSum("value"),d=Math.PI*2/(l||s);t.eachNode(function(f){var h=f.getValue("value"),v=d*(l?h:1)/2;c+=v,f.setLayout([a*Math.cos(c)+o,a*Math.sin(c)+u]),c+=v})},symbolSize:function(n,t,r,a,o,u,s){var c=0;_symbolRadiansHalf.length=s;var l=getNodeGlobalScale(n);t.eachNode(function(h){var v=getSymbolSize(h);isNaN(v)&&(v=2),v<0&&(v=0),v*=l;var g=Math.asin(v/2/a);isNaN(g)&&(g=PI$2/2),_symbolRadiansHalf[h.dataIndex]=g,c+=g*2});var d=(2*PI$2-c)/s/2,f=0;t.eachNode(function(h){var v=d+_symbolRadiansHalf[h.dataIndex];f+=v,(!h.getLayout()||!h.getLayout().fixed)&&h.setLayout([a*Math.cos(f)+o,a*Math.sin(f)+u]),f+=v})}};function rotateNodeLabel(n,t,r,a){var o=n.getGraphicEl();if(o){var u=n.getModel(),s=u.get(["label","rotate"])||0,c=o.getSymbolPath();if(t){var l=n.getLayout(),d=Math.atan2(l[1]-a,l[0]-r);d<0&&(d=Math.PI*2+d);var f=l[0]<r;f&&(d=d-Math.PI);var h=f?"left":"right";c.setTextConfig({rotation:-d,position:h,origin:"center"});var v=c.ensureState("emphasis");extend$1(v.textConfig||(v.textConfig={}),{position:h})}else c.setTextConfig({rotation:s*=Math.PI/180})}}function graphCircularLayout(n){n.eachSeriesByType("graph",function(t){t.get("layout")==="circular"&&circularLayout(t,"symbolSize")})}var scaleAndAdd=scaleAndAdd$1;function forceLayout(n,t,r){for(var a=n,o=t,u=r.rect,s=u.width,c=u.height,l=[u.x+s/2,u.y+c/2],d=r.gravity==null?.1:r.gravity,f=0;f<a.length;f++){var h=a[f];h.p||(h.p=create$3(s*(Math.random()-.5)+l[0],c*(Math.random()-.5)+l[1])),h.pp=clone$4(h.p),h.edges=null}var v=r.friction==null?.6:r.friction,g=v,b,_;return{warmUp:function(){g=v*.8},setFixed:function(S){a[S].fixed=!0},setUnfixed:function(S){a[S].fixed=!1},beforeStep:function(S){b=S},afterStep:function(S){_=S},step:function(S){b&&b(a,o);for(var T=[],w=a.length,A=0;A<o.length;A++){var R=o[A];if(!R.ignoreForceLayout){var E=R.n1,I=R.n2;sub(T,I.p,E.p);var L=len(T)-R.d,F=I.w/(E.w+I.w);isNaN(F)&&(F=0),normalize$4(T,T),!E.fixed&&scaleAndAdd(E.p,E.p,T,F*L*g),!I.fixed&&scaleAndAdd(I.p,I.p,T,-(1-F)*L*g)}}for(var A=0;A<w;A++){var D=a[A];D.fixed||(sub(T,l,D.p),scaleAndAdd(D.p,D.p,T,d*g))}for(var A=0;A<w;A++)for(var E=a[A],$=A+1;$<w;$++){var I=a[$];sub(T,I.p,E.p);var L=len(T);L===0&&(set$3(T,Math.random()-.5,Math.random()-.5),L=1);var O=(E.rep+I.rep)/L/L;!E.fixed&&scaleAndAdd(E.pp,E.pp,T,O),!I.fixed&&scaleAndAdd(I.pp,I.pp,T,-O)}for(var P=[],A=0;A<w;A++){var D=a[A];D.fixed||(sub(P,D.p,D.pp),scaleAndAdd(D.p,D.p,P,g),copy$2(D.pp,D.p))}g=g*.992;var C=g<.01;_&&_(a,o,C),S&&S(C)}}}function graphForceLayout(n){n.eachSeriesByType("graph",function(t){var r=t.coordinateSystem;if(!(r&&r.type!=="view"))if(t.get("layout")==="force"){var a=t.preservedPoints||{},o=t.getGraph(),u=o.data,s=o.edgeData,c=t.getModel("force"),l=c.get("initLayout");t.preservedPoints?u.each(function(A){var R=u.getId(A);u.setItemLayout(A,a[R]||[NaN,NaN])}):!l||l==="none"?simpleLayout(t):l==="circular"&&circularLayout(t,"value");var d=u.getDataExtent("value"),f=s.getDataExtent("value"),h=c.get("repulsion"),v=c.get("edgeLength"),g=isArray$2(h)?h:[h,h],b=isArray$2(v)?v:[v,v];b=[b[1],b[0]];var _=u.mapArray("value",function(A,R){var E=u.getItemLayout(R),I=linearMap$2(A,d,g);return isNaN(I)&&(I=(g[0]+g[1])/2),{w:I,rep:I,fixed:u.getItemModel(R).get("fixed"),p:!E||isNaN(E[0])||isNaN(E[1])?null:E}}),S=s.mapArray("value",function(A,R){var E=o.getEdgeByIndex(R),I=linearMap$2(A,f,b);isNaN(I)&&(I=(b[0]+b[1])/2);var L=E.getModel(),F=retrieve3(E.getModel().get(["lineStyle","curveness"]),-getCurvenessForEdge(E,t,R,!0),0);return{n1:_[E.node1.dataIndex],n2:_[E.node2.dataIndex],d:I,curveness:F,ignoreForceLayout:L.get("ignoreForceLayout")}}),T=r.getBoundingRect(),w=forceLayout(_,S,{rect:T,gravity:c.get("gravity"),friction:c.get("friction")});w.beforeStep(function(A,R){for(var E=0,I=A.length;E<I;E++)A[E].fixed&&copy$2(A[E].p,o.getNodeByIndex(E).getLayout())}),w.afterStep(function(A,R,E){for(var I=0,L=A.length;I<L;I++)A[I].fixed||o.getNodeByIndex(I).setLayout(A[I].p),a[u.getId(I)]=A[I].p;for(var I=0,L=R.length;I<L;I++){var F=R[I],D=o.getEdgeByIndex(I),$=F.n1.p,O=F.n2.p,P=D.getLayout();P=P?P.slice():[],P[0]=P[0]||[],P[1]=P[1]||[],copy$2(P[0],$),copy$2(P[1],O),+F.curveness&&(P[2]=[($[0]+O[0])/2-($[1]-O[1])*F.curveness,($[1]+O[1])/2-(O[0]-$[0])*F.curveness]),D.setLayout(P)}}),t.forceLayout=w,t.preservedPoints=a,w.step()}else t.forceLayout=null})}function getViewRect$3(n,t,r){var a=extend$1(n.getBoxLayoutParams(),{aspect:r});return getLayoutRect(a,{width:t.getWidth(),height:t.getHeight()})}function createViewCoordSys(n,t){var r=[];return n.eachSeriesByType("graph",function(a){var o=a.get("coordinateSystem");if(!o||o==="view"){var u=a.getData(),s=u.mapArray(function(S){var T=u.getItemModel(S);return[+T.get("x"),+T.get("y")]}),c=[],l=[];fromPoints(s,c,l),l[0]-c[0]===0&&(l[0]+=1,c[0]-=1),l[1]-c[1]===0&&(l[1]+=1,c[1]-=1);var d=(l[0]-c[0])/(l[1]-c[1]),f=getViewRect$3(a,t,d);isNaN(d)&&(c=[f.x,f.y],l=[f.x+f.width,f.y+f.height]);var h=l[0]-c[0],v=l[1]-c[1],g=f.width,b=f.height,_=a.coordinateSystem=new View;_.zoomLimit=a.get("scaleLimit"),_.setBoundingRect(c[0],c[1],h,v),_.setViewRect(f.x,f.y,g,b),_.setCenter(a.get("center"),t),_.setZoom(a.get("zoom")),r.push(_)}}),r}var straightLineProto=Line$1.prototype,bezierCurveProto=BezierCurve.prototype,StraightLineShape=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}();(function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t})(StraightLineShape);function isStraightLine(n){return isNaN(+n.cpx1)||isNaN(+n.cpy1)}var ECLinePath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="ec-line",a}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new StraightLineShape},t.prototype.buildPath=function(r,a){isStraightLine(a)?straightLineProto.buildPath.call(this,r,a):bezierCurveProto.buildPath.call(this,r,a)},t.prototype.pointAt=function(r){return isStraightLine(this.shape)?straightLineProto.pointAt.call(this,r):bezierCurveProto.pointAt.call(this,r)},t.prototype.tangentAt=function(r){var a=this.shape,o=isStraightLine(a)?[a.x2-a.x1,a.y2-a.y1]:bezierCurveProto.tangentAt.call(this,r);return normalize$4(o,o)},t}(Path),SYMBOL_CATEGORIES=["fromSymbol","toSymbol"];function makeSymbolTypeKey(n){return"_"+n+"Type"}function makeSymbolTypeValue(n,t,r){var a=t.getItemVisual(r,n);if(!a||a==="none")return a;var o=t.getItemVisual(r,n+"Size"),u=t.getItemVisual(r,n+"Rotate"),s=t.getItemVisual(r,n+"Offset"),c=t.getItemVisual(r,n+"KeepAspect"),l=normalizeSymbolSize(o),d=normalizeSymbolOffset(s||0,l);return a+l+d+(u||"")+(c||"")}function createSymbol(n,t,r){var a=t.getItemVisual(r,n);if(!(!a||a==="none")){var o=t.getItemVisual(r,n+"Size"),u=t.getItemVisual(r,n+"Rotate"),s=t.getItemVisual(r,n+"Offset"),c=t.getItemVisual(r,n+"KeepAspect"),l=normalizeSymbolSize(o),d=normalizeSymbolOffset(s||0,l),f=createSymbol$1(a,-l[0]/2+d[0],-l[1]/2+d[1],l[0],l[1],null,c);return f.__specifiedRotation=u==null||isNaN(u)?void 0:+u*Math.PI/180||0,f.name=n,f}}function createLine(n){var t=new ECLinePath({name:"line",subPixelOptimize:!0});return setLinePoints(t.shape,n),t}function setLinePoints(n,t){n.x1=t[0][0],n.y1=t[0][1],n.x2=t[1][0],n.y2=t[1][1],n.percent=1;var r=t[2];r?(n.cpx1=r[0],n.cpy1=r[1]):(n.cpx1=NaN,n.cpy1=NaN)}var Line=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this)||this;return u._createLine(r,a,o),u}return t.prototype._createLine=function(r,a,o){var u=r.hostModel,s=r.getItemLayout(a),c=createLine(s);c.shape.percent=0,initProps(c,{shape:{percent:1}},u,a),this.add(c),each$f(SYMBOL_CATEGORIES,function(l){var d=createSymbol(l,r,a);this.add(d),this[makeSymbolTypeKey(l)]=makeSymbolTypeValue(l,r,a)},this),this._updateCommonStl(r,a,o)},t.prototype.updateData=function(r,a,o){var u=r.hostModel,s=this.childOfName("line"),c=r.getItemLayout(a),l={shape:{}};setLinePoints(l.shape,c),updateProps$1(s,l,u,a),each$f(SYMBOL_CATEGORIES,function(d){var f=makeSymbolTypeValue(d,r,a),h=makeSymbolTypeKey(d);if(this[h]!==f){this.remove(this.childOfName(d));var v=createSymbol(d,r,a);this.add(v)}this[h]=f},this),this._updateCommonStl(r,a,o)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(r,a,o){var u=r.hostModel,s=this.childOfName("line"),c=o&&o.emphasisLineStyle,l=o&&o.blurLineStyle,d=o&&o.selectLineStyle,f=o&&o.labelStatesModels,h=o&&o.emphasisDisabled,v=o&&o.focus,g=o&&o.blurScope;if(!o||r.hasItemOption){var b=r.getItemModel(a),_=b.getModel("emphasis");c=_.getModel("lineStyle").getLineStyle(),l=b.getModel(["blur","lineStyle"]).getLineStyle(),d=b.getModel(["select","lineStyle"]).getLineStyle(),h=_.get("disabled"),v=_.get("focus"),g=_.get("blurScope"),f=getLabelStatesModels(b)}var S=r.getItemVisual(a,"style"),T=S.stroke;s.useStyle(S),s.style.fill=null,s.style.strokeNoScale=!0,s.ensureState("emphasis").style=c,s.ensureState("blur").style=l,s.ensureState("select").style=d,each$f(SYMBOL_CATEGORIES,function(I){var L=this.childOfName(I);if(L){L.setColor(T),L.style.opacity=S.opacity;for(var F=0;F<SPECIAL_STATES.length;F++){var D=SPECIAL_STATES[F],$=s.getState(D);if($){var O=$.style||{},P=L.ensureState(D),C=P.style||(P.style={});O.stroke!=null&&(C[L.__isEmptyBrush?"stroke":"fill"]=O.stroke),O.opacity!=null&&(C.opacity=O.opacity)}}L.markRedraw()}},this);var w=u.getRawValue(a);setLabelStyle(this,f,{labelDataIndex:a,labelFetcher:{getFormattedLabel:function(I,L){return u.getFormattedLabel(I,L,r.dataType)}},inheritColor:T||"#000",defaultOpacity:S.opacity,defaultText:(w==null?r.getName(a):isFinite(w)?round$3(w):w)+""});var A=this.getTextContent();if(A){var R=f.normal;A.__align=A.style.align,A.__verticalAlign=A.style.verticalAlign,A.__position=R.get("position")||"middle";var E=R.get("distance");isArray$2(E)||(E=[E,E]),A.__labelDistance=E}this.setTextConfig({position:null,local:!0,inside:!1}),toggleHoverEmphasis(this,v,g,h)},t.prototype.highlight=function(){enterEmphasis(this)},t.prototype.downplay=function(){leaveEmphasis(this)},t.prototype.updateLayout=function(r,a){this.setLinePoints(r.getItemLayout(a))},t.prototype.setLinePoints=function(r){var a=this.childOfName("line");setLinePoints(a.shape,r),a.dirty()},t.prototype.beforeUpdate=function(){var r=this,a=r.childOfName("fromSymbol"),o=r.childOfName("toSymbol"),u=r.getTextContent();if(!a&&!o&&(!u||u.ignore))return;for(var s=1,c=this.parent;c;)c.scaleX&&(s/=c.scaleX),c=c.parent;var l=r.childOfName("line");if(!this.__dirty&&!l.__dirty)return;var d=l.shape.percent,f=l.pointAt(0),h=l.pointAt(d),v=sub([],h,f);normalize$4(v,v);function g($,O){var P=$.__specifiedRotation;if(P==null){var C=l.tangentAt(O);$.attr("rotation",(O===1?-1:1)*Math.PI/2-Math.atan2(C[1],C[0]))}else $.attr("rotation",P)}if(a&&(a.setPosition(f),g(a,0),a.scaleX=a.scaleY=s*d,a.markRedraw()),o&&(o.setPosition(h),g(o,1),o.scaleX=o.scaleY=s*d,o.markRedraw()),u&&!u.ignore){u.x=u.y=0,u.originX=u.originY=0;var b=void 0,_=void 0,S=u.__labelDistance,T=S[0]*s,w=S[1]*s,A=d/2,R=l.tangentAt(A),E=[R[1],-R[0]],I=l.pointAt(A);E[1]>0&&(E[0]=-E[0],E[1]=-E[1]);var L=R[0]<0?-1:1;if(u.__position!=="start"&&u.__position!=="end"){var F=-Math.atan2(R[1],R[0]);h[0]<f[0]&&(F=Math.PI+F),u.rotation=F}var D=void 0;switch(u.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":D=-w,_="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":D=w,_="top";break;default:D=0,_="middle"}switch(u.__position){case"end":u.x=v[0]*T+h[0],u.y=v[1]*w+h[1],b=v[0]>.8?"left":v[0]<-.8?"right":"center",_=v[1]>.8?"top":v[1]<-.8?"bottom":"middle";break;case"start":u.x=-v[0]*T+f[0],u.y=-v[1]*w+f[1],b=v[0]>.8?"right":v[0]<-.8?"left":"center",_=v[1]>.8?"bottom":v[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":u.x=T*L+f[0],u.y=f[1]+D,b=R[0]<0?"right":"left",u.originX=-T*L,u.originY=-D;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":u.x=I[0],u.y=I[1]+D,b="center",u.originY=-D;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":u.x=-T*L+h[0],u.y=h[1]+D,b=R[0]>=0?"right":"left",u.originX=T*L,u.originY=-D;break}u.scaleX=u.scaleY=s,u.setStyle({verticalAlign:u.__verticalAlign||_,align:u.__align||b})}},t}(Group$3),LineDraw=function(){function n(t){this.group=new Group$3,this._LineCtor=t||Line}return n.prototype.updateData=function(t){var r=this;this._progressiveEls=null;var a=this,o=a.group,u=a._lineData;a._lineData=t,u||o.removeAll();var s=makeSeriesScope$1(t);t.diff(u).add(function(c){r._doAdd(t,c,s)}).update(function(c,l){r._doUpdate(u,t,l,c,s)}).remove(function(c){o.remove(u.getItemGraphicEl(c))}).execute()},n.prototype.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl(function(r,a){r.updateLayout(t,a)},this)},n.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=makeSeriesScope$1(t),this._lineData=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(t,r){this._progressiveEls=[];function a(c){!c.isGroup&&!isEffectObject(c)&&(c.incremental=!0,c.ensureState("emphasis").hoverLayer=!0)}for(var o=t.start;o<t.end;o++){var u=r.getItemLayout(o);if(lineNeedsDraw(u)){var s=new this._LineCtor(r,o,this._seriesScope);s.traverse(a),this.group.add(s),r.setItemGraphicEl(o,s),this._progressiveEls.push(s)}}},n.prototype.remove=function(){this.group.removeAll()},n.prototype.eachRendered=function(t){traverseElements(this._progressiveEls||this.group,t)},n.prototype._doAdd=function(t,r,a){var o=t.getItemLayout(r);if(lineNeedsDraw(o)){var u=new this._LineCtor(t,r,a);t.setItemGraphicEl(r,u),this.group.add(u)}},n.prototype._doUpdate=function(t,r,a,o,u){var s=t.getItemGraphicEl(a);if(!lineNeedsDraw(r.getItemLayout(o))){this.group.remove(s);return}s?s.updateData(r,o,u):s=new this._LineCtor(r,o,u),r.setItemGraphicEl(o,s),this.group.add(s)},n}();function isEffectObject(n){return n.animators&&n.animators.length>0}function makeSeriesScope$1(n){var t=n.hostModel,r=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:r.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:r.get("disabled"),blurScope:r.get("blurScope"),focus:r.get("focus"),labelStatesModels:getLabelStatesModels(t)}}function isPointNaN(n){return isNaN(n[0])||isNaN(n[1])}function lineNeedsDraw(n){return n&&!isPointNaN(n[0])&&!isPointNaN(n[1])}var v1$2=[],v2$1=[],v3$1=[],quadraticAt=quadraticAt$1,v2DistSquare=distSquare,mathAbs=Math.abs;function intersectCurveCircle(n,t,r){for(var a=n[0],o=n[1],u=n[2],s=1/0,c,l=r*r,d=.1,f=.1;f<=.9;f+=.1){v1$2[0]=quadraticAt(a[0],o[0],u[0],f),v1$2[1]=quadraticAt(a[1],o[1],u[1],f);var h=mathAbs(v2DistSquare(v1$2,t)-l);h<s&&(s=h,c=f)}for(var v=0;v<32;v++){var g=c+d;v2$1[0]=quadraticAt(a[0],o[0],u[0],c),v2$1[1]=quadraticAt(a[1],o[1],u[1],c),v3$1[0]=quadraticAt(a[0],o[0],u[0],g),v3$1[1]=quadraticAt(a[1],o[1],u[1],g);var h=v2DistSquare(v2$1,t)-l;if(mathAbs(h)<.01)break;var b=v2DistSquare(v3$1,t)-l;d/=2,h<0?b>=0?c=c+d:c=c-d:b>=0?c=c-d:c=c+d}return c}function adjustEdge(n,t){var r=[],a=quadraticSubdivide,o=[[],[],[]],u=[[],[]],s=[];t/=2,n.eachEdge(function(c,l){var d=c.getLayout(),f=c.getVisual("fromSymbol"),h=c.getVisual("toSymbol");d.__original||(d.__original=[clone$4(d[0]),clone$4(d[1])],d[2]&&d.__original.push(clone$4(d[2])));var v=d.__original;if(d[2]!=null){if(copy$2(o[0],v[0]),copy$2(o[1],v[2]),copy$2(o[2],v[1]),f&&f!=="none"){var g=getSymbolSize(c.node1),b=intersectCurveCircle(o,v[0],g*t);a(o[0][0],o[1][0],o[2][0],b,r),o[0][0]=r[3],o[1][0]=r[4],a(o[0][1],o[1][1],o[2][1],b,r),o[0][1]=r[3],o[1][1]=r[4]}if(h&&h!=="none"){var g=getSymbolSize(c.node2),b=intersectCurveCircle(o,v[1],g*t);a(o[0][0],o[1][0],o[2][0],b,r),o[1][0]=r[1],o[2][0]=r[2],a(o[0][1],o[1][1],o[2][1],b,r),o[1][1]=r[1],o[2][1]=r[2]}copy$2(d[0],o[0]),copy$2(d[1],o[2]),copy$2(d[2],o[1])}else{if(copy$2(u[0],v[0]),copy$2(u[1],v[1]),sub(s,u[1],u[0]),normalize$4(s,s),f&&f!=="none"){var g=getSymbolSize(c.node1);scaleAndAdd$1(u[0],u[0],s,g*t)}if(h&&h!=="none"){var g=getSymbolSize(c.node2);scaleAndAdd$1(u[1],u[1],s,-g*t)}copy$2(d[0],u[0]),copy$2(d[1],u[1])}})}function isViewCoordSys(n){return n.type==="view"}var GraphView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a){var o=new SymbolDraw,u=new LineDraw,s=this.group;this._controller=new RoamController(a.getZr()),this._controllerHost={target:s},s.add(o.group),s.add(u.group),this._symbolDraw=o,this._lineDraw=u,this._firstRender=!0},t.prototype.render=function(r,a,o){var u=this,s=r.coordinateSystem;this._model=r;var c=this._symbolDraw,l=this._lineDraw,d=this.group;if(isViewCoordSys(s)){var f={x:s.x,y:s.y,scaleX:s.scaleX,scaleY:s.scaleY};this._firstRender?d.attr(f):updateProps$1(d,f,r)}adjustEdge(r.getGraph(),getNodeGlobalScale(r));var h=r.getData();c.updateData(h);var v=r.getEdgeData();l.updateData(v),this._updateNodeAndLinkScale(),this._updateController(r,a,o),clearTimeout(this._layoutTimeout);var g=r.forceLayout,b=r.get(["force","layoutAnimation"]);g&&this._startForceLayoutIteration(g,b);var _=r.get("layout");h.graph.eachNode(function(A){var R=A.dataIndex,E=A.getGraphicEl(),I=A.getModel();if(E){E.off("drag").off("dragend");var L=I.get("draggable");L&&E.on("drag",function(D){switch(_){case"force":g.warmUp(),!u._layouting&&u._startForceLayoutIteration(g,b),g.setFixed(R),h.setItemLayout(R,[E.x,E.y]);break;case"circular":h.setItemLayout(R,[E.x,E.y]),A.setLayout({fixed:!0},!0),circularLayout(r,"symbolSize",A,[D.offsetX,D.offsetY]),u.updateLayout(r);break;case"none":default:h.setItemLayout(R,[E.x,E.y]),simpleLayoutEdge(r.getGraph(),r),u.updateLayout(r);break}}).on("dragend",function(){g&&g.setUnfixed(R)}),E.setDraggable(L,!!I.get("cursor"));var F=I.get(["emphasis","focus"]);F==="adjacency"&&(getECData(E).focus=A.getAdjacentDataIndices())}}),h.graph.eachEdge(function(A){var R=A.getGraphicEl(),E=A.getModel().get(["emphasis","focus"]);R&&E==="adjacency"&&(getECData(R).focus={edge:[A.dataIndex],node:[A.node1.dataIndex,A.node2.dataIndex]})});var S=r.get("layout")==="circular"&&r.get(["circular","rotateLabel"]),T=h.getLayout("cx"),w=h.getLayout("cy");h.graph.eachNode(function(A){rotateNodeLabel(A,S,T,w)}),this._firstRender=!1},t.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._startForceLayoutIteration=function(r,a){var o=this;(function u(){r.step(function(s){o.updateLayout(o._model),(o._layouting=!s)&&(a?o._layoutTimeout=setTimeout(u,16):u())})})()},t.prototype._updateController=function(r,a,o){var u=this,s=this._controller,c=this._controllerHost,l=this.group;if(s.setPointerChecker(function(d,f,h){var v=l.getBoundingRect();return v.applyTransform(l.transform),v.contain(f,h)&&!onIrrelevantElement(d,o,r)}),!isViewCoordSys(r.coordinateSystem)){s.disable();return}s.enable(r.get("roam")),c.zoomLimit=r.get("scaleLimit"),c.zoom=r.coordinateSystem.getZoom(),s.off("pan").off("zoom").on("pan",function(d){updateViewOnPan(c,d.dx,d.dy),o.dispatchAction({seriesId:r.id,type:"graphRoam",dx:d.dx,dy:d.dy})}).on("zoom",function(d){updateViewOnZoom(c,d.scale,d.originX,d.originY),o.dispatchAction({seriesId:r.id,type:"graphRoam",zoom:d.scale,originX:d.originX,originY:d.originY}),u._updateNodeAndLinkScale(),adjustEdge(r.getGraph(),getNodeGlobalScale(r)),u._lineDraw.updateLayout(),o.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(){var r=this._model,a=r.getData(),o=getNodeGlobalScale(r);a.eachItemGraphicEl(function(u,s){u&&u.setSymbolScale(o)})},t.prototype.updateLayout=function(r){adjustEdge(r.getGraph(),getNodeGlobalScale(r)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},t.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},t.type="graph",t}(ChartView);function generateNodeKey(n){return"_EC_"+n}var Graph=function(){function n(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return n.prototype.isDirected=function(){return this._directed},n.prototype.addNode=function(t,r){t=t==null?""+r:""+t;var a=this._nodesMap;if(!a[generateNodeKey(t)]){var o=new GraphNode(t,r);return o.hostGraph=this,this.nodes.push(o),a[generateNodeKey(t)]=o,o}},n.prototype.getNodeByIndex=function(t){var r=this.data.getRawIndex(t);return this.nodes[r]},n.prototype.getNodeById=function(t){return this._nodesMap[generateNodeKey(t)]},n.prototype.addEdge=function(t,r,a){var o=this._nodesMap,u=this._edgesMap;if(isNumber(t)&&(t=this.nodes[t]),isNumber(r)&&(r=this.nodes[r]),t instanceof GraphNode||(t=o[generateNodeKey(t)]),r instanceof GraphNode||(r=o[generateNodeKey(r)]),!(!t||!r)){var s=t.id+"-"+r.id,c=new GraphEdge(t,r,a);return c.hostGraph=this,this._directed&&(t.outEdges.push(c),r.inEdges.push(c)),t.edges.push(c),t!==r&&r.edges.push(c),this.edges.push(c),u[s]=c,c}},n.prototype.getEdgeByIndex=function(t){var r=this.edgeData.getRawIndex(t);return this.edges[r]},n.prototype.getEdge=function(t,r){t instanceof GraphNode&&(t=t.id),r instanceof GraphNode&&(r=r.id);var a=this._edgesMap;return this._directed?a[t+"-"+r]:a[t+"-"+r]||a[r+"-"+t]},n.prototype.eachNode=function(t,r){for(var a=this.nodes,o=a.length,u=0;u<o;u++)a[u].dataIndex>=0&&t.call(r,a[u],u)},n.prototype.eachEdge=function(t,r){for(var a=this.edges,o=a.length,u=0;u<o;u++)a[u].dataIndex>=0&&a[u].node1.dataIndex>=0&&a[u].node2.dataIndex>=0&&t.call(r,a[u],u)},n.prototype.breadthFirstTraverse=function(t,r,a,o){if(r instanceof GraphNode||(r=this._nodesMap[generateNodeKey(r)]),!!r){for(var u=a==="out"?"outEdges":a==="in"?"inEdges":"edges",s=0;s<this.nodes.length;s++)this.nodes[s].__visited=!1;if(!t.call(o,r,null))for(var c=[r];c.length;)for(var l=c.shift(),d=l[u],s=0;s<d.length;s++){var f=d[s],h=f.node1===l?f.node2:f.node1;if(!h.__visited){if(t.call(o,h,l))return;c.push(h),h.__visited=!0}}}},n.prototype.update=function(){for(var t=this.data,r=this.edgeData,a=this.nodes,o=this.edges,u=0,s=a.length;u<s;u++)a[u].dataIndex=-1;for(var u=0,s=t.count();u<s;u++)a[t.getRawIndex(u)].dataIndex=u;r.filterSelf(function(c){var l=o[r.getRawIndex(c)];return l.node1.dataIndex>=0&&l.node2.dataIndex>=0});for(var u=0,s=o.length;u<s;u++)o[u].dataIndex=-1;for(var u=0,s=r.count();u<s;u++)o[r.getRawIndex(u)].dataIndex=u},n.prototype.clone=function(){for(var t=new n(this._directed),r=this.nodes,a=this.edges,o=0;o<r.length;o++)t.addNode(r[o].id,r[o].dataIndex);for(var o=0;o<a.length;o++){var u=a[o];t.addEdge(u.node1.id,u.node2.id,u.dataIndex)}return t},n}(),GraphNode=function(){function n(t,r){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t??"",this.dataIndex=r??-1}return n.prototype.degree=function(){return this.edges.length},n.prototype.inDegree=function(){return this.inEdges.length},n.prototype.outDegree=function(){return this.outEdges.length},n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,a=r.data.getItemModel(this.dataIndex);return a.getModel(t)}},n.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},r=0;r<this.edges.length;r++){var a=this.edges[r];a.dataIndex<0||(t.edge.push(a.dataIndex),t.node.push(a.node1.dataIndex,a.node2.dataIndex))}return t},n.prototype.getTrajectoryDataIndices=function(){for(var t=createHashMap(),r=createHashMap(),a=0;a<this.edges.length;a++){var o=this.edges[a];if(!(o.dataIndex<0)){t.set(o.dataIndex,!0);for(var u=[o.node1],s=[o.node2],c=0;c<u.length;){var l=u[c];c++,r.set(l.dataIndex,!0);for(var d=0;d<l.inEdges.length;d++)t.set(l.inEdges[d].dataIndex,!0),u.push(l.inEdges[d].node1)}for(c=0;c<s.length;){var f=s[c];c++,r.set(f.dataIndex,!0);for(var d=0;d<f.outEdges.length;d++)t.set(f.outEdges[d].dataIndex,!0),s.push(f.outEdges[d].node2)}}}return{edge:t.keys(),node:r.keys()}},n}(),GraphEdge=function(){function n(t,r,a){this.dataIndex=-1,this.node1=t,this.node2=r,this.dataIndex=a??-1}return n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,a=r.edgeData.getItemModel(this.dataIndex);return a.getModel(t)}},n.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},n.prototype.getTrajectoryDataIndices=function(){var t=createHashMap(),r=createHashMap();t.set(this.dataIndex,!0);for(var a=[this.node1],o=[this.node2],u=0;u<a.length;){var s=a[u];u++,r.set(s.dataIndex,!0);for(var c=0;c<s.inEdges.length;c++)t.set(s.inEdges[c].dataIndex,!0),a.push(s.inEdges[c].node1)}for(u=0;u<o.length;){var l=o[u];u++,r.set(l.dataIndex,!0);for(var c=0;c<l.outEdges.length;c++)t.set(l.outEdges[c].dataIndex,!0),o.push(l.outEdges[c].node2)}return{edge:t.keys(),node:r.keys()}},n}();function createGraphDataProxyMixin(n,t){return{getValue:function(r){var a=this[n][t];return a.getStore().get(a.getDimensionIndex(r||"value"),this.dataIndex)},setVisual:function(r,a){this.dataIndex>=0&&this[n][t].setItemVisual(this.dataIndex,r,a)},getVisual:function(r){return this[n][t].getItemVisual(this.dataIndex,r)},setLayout:function(r,a){this.dataIndex>=0&&this[n][t].setItemLayout(this.dataIndex,r,a)},getLayout:function(){return this[n][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[n][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[n][t].getRawIndex(this.dataIndex)}}}mixin$1(GraphNode,createGraphDataProxyMixin("hostGraph","data"));mixin$1(GraphEdge,createGraphDataProxyMixin("hostGraph","edgeData"));function createGraphFromNodeEdge(n,t,r,a,o){for(var u=new Graph(a),s=0;s<n.length;s++)u.addNode(retrieve(n[s].id,n[s].name,s),s);for(var c=[],l=[],d=0,s=0;s<t.length;s++){var f=t[s],h=f.source,v=f.target;u.addEdge(h,v,d)&&(l.push(f),c.push(retrieve(convertOptionIdName(f.id,null),h+" > "+v)),d++)}var g=r.get("coordinateSystem"),b;if(g==="cartesian2d"||g==="polar")b=createSeriesData(n,r);else{var _=CoordinateSystemManager.get(g),S=_?_.dimensions||[]:[];indexOf(S,"value")<0&&S.concat(["value"]);var T=prepareSeriesDataSchema(n,{coordDimensions:S,encodeDefine:r.getEncode()}).dimensions;b=new SeriesData(T,r),b.initData(n)}var w=new SeriesData(["value"],r);return w.initData(l,c),o&&o(b,w),linkSeriesData({mainData:b,struct:u,structAttr:"graph",datas:{node:b,edge:w},datasAttr:{node:"data",edge:"edgeData"}}),u.update(),u}var GraphSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){n.prototype.init.apply(this,arguments);var a=this;function o(){return a._categoriesData}this.legendVisualProvider=new LegendVisualProvider(o,o),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeOption=function(r){n.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeDefaultAndTheme=function(r){n.prototype.mergeDefaultAndTheme.apply(this,arguments),defaultEmphasis(r,"edgeLabel",["show"])},t.prototype.getInitialData=function(r,a){var o=r.edges||r.links||[],u=r.data||r.nodes||[],s=this;if(u&&o){initCurvenessList(this);var c=createGraphFromNodeEdge(u,o,this,!0,l);return each$f(c.edges,function(d){createEdgeMapForCurveness(d.node1,d.node2,this,d.dataIndex)},this),c.data}function l(d,f){d.wrapMethod("getItemModel",function(b){var _=s._categoriesModels,S=b.getShallow("category"),T=_[S];return T&&(T.parentModel=b.parentModel,b.parentModel=T),b});var h=Model.prototype.getModel;function v(b,_){var S=h.call(this,b,_);return S.resolveParentPath=g,S}f.wrapMethod("getItemModel",function(b){return b.resolveParentPath=g,b.getModel=v,b});function g(b){if(b&&(b[0]==="label"||b[1]==="label")){var _=b.slice();return b[0]==="label"?_[0]="edgeLabel":b[1]==="label"&&(_[1]="edgeLabel"),_}return b}}},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.getCategoriesData=function(){return this._categoriesData},t.prototype.formatTooltip=function(r,a,o){if(o==="edge"){var u=this.getData(),s=this.getDataParams(r,o),c=u.graph.getEdgeByIndex(r),l=u.getName(c.node1.dataIndex),d=u.getName(c.node2.dataIndex),f=[];return l!=null&&f.push(l),d!=null&&f.push(d),createTooltipMarkup("nameValue",{name:f.join(" > "),value:s.value,noValue:s.value==null})}var h=defaultSeriesFormatTooltip({series:this,dataIndex:r,multipleSeries:a});return h},t.prototype._updateCategoriesData=function(){var r=map$1(this.option.categories||[],function(o){return o.value!=null?o:extend$1({value:0},o)}),a=new SeriesData(["value"],this);a.initData(r),this._categoriesData=a,this._categoriesModels=a.mapArray(function(o){return a.getItemModel(o)})},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.isAnimationEnabled=function(){return n.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},t.type="series.graph",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}(SeriesModel),actionInfo$1={type:"graphRoam",event:"graphRoam",update:"none"};function install$F(n){n.registerChartView(GraphView),n.registerSeriesModel(GraphSeriesModel),n.registerProcessor(categoryFilter),n.registerVisual(categoryVisual),n.registerVisual(graphEdgeVisual),n.registerLayout(graphSimpleLayout),n.registerLayout(n.PRIORITY.VISUAL.POST_CHART_LAYOUT,graphCircularLayout),n.registerLayout(graphForceLayout),n.registerCoordinateSystem("graphView",{dimensions:View.dimensions,create:createViewCoordSys}),n.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},noop$3),n.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},noop$3),n.registerAction(actionInfo$1,function(t,r,a){r.eachComponent({mainType:"series",query:t},function(o){var u=o.coordinateSystem,s=updateCenterAndZoom(u,t,void 0,a);o.setCenter&&o.setCenter(s.center),o.setZoom&&o.setZoom(s.zoom)})})}var PointerShape=function(){function n(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return n}(),PointerPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="pointer",a}return t.prototype.getDefaultShape=function(){return new PointerShape},t.prototype.buildPath=function(r,a){var o=Math.cos,u=Math.sin,s=a.r,c=a.width,l=a.angle,d=a.x-o(l)*c*(c>=s/3?1:2),f=a.y-u(l)*c*(c>=s/3?1:2);l=a.angle-Math.PI/2,r.moveTo(d,f),r.lineTo(a.x+o(l)*c,a.y+u(l)*c),r.lineTo(a.x+o(a.angle)*s,a.y+u(a.angle)*s),r.lineTo(a.x-o(l)*c,a.y-u(l)*c),r.lineTo(d,f)},t}(Path);function parsePosition(n,t){var r=n.get("center"),a=t.getWidth(),o=t.getHeight(),u=Math.min(a,o),s=parsePercent(r[0],t.getWidth()),c=parsePercent(r[1],t.getHeight()),l=parsePercent(n.get("radius"),u/2);return{cx:s,cy:c,r:l}}function formatLabel(n,t){var r=n==null?"":n+"";return t&&(isString(t)?r=t.replace("{value}",r):isFunction$1(t)&&(r=t(n))),r}var GaugeView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){this.group.removeAll();var u=r.get(["axisLine","lineStyle","color"]),s=parsePosition(r,o);this._renderMain(r,a,o,u,s),this._data=r.getData()},t.prototype.dispose=function(){},t.prototype._renderMain=function(r,a,o,u,s){var c=this.group,l=r.get("clockwise"),d=-r.get("startAngle")/180*Math.PI,f=-r.get("endAngle")/180*Math.PI,h=r.getModel("axisLine"),v=h.get("roundCap"),g=v?SausagePath:Sector,b=h.get("show"),_=h.getModel("lineStyle"),S=_.get("width"),T=[d,f];normalizeArcAngles(T,!l),d=T[0],f=T[1];for(var w=f-d,A=d,R=[],E=0;b&&E<u.length;E++){var I=Math.min(Math.max(u[E][0],0),1);f=d+w*I;var L=new g({shape:{startAngle:A,endAngle:f,cx:s.cx,cy:s.cy,clockwise:l,r0:s.r-S,r:s.r},silent:!0});L.setStyle({fill:u[E][1]}),L.setStyle(_.getLineStyle(["color","width"])),R.push(L),A=f}R.reverse(),each$f(R,function(D){return c.add(D)});var F=function(D){if(D<=0)return u[0][1];var $;for($=0;$<u.length;$++)if(u[$][0]>=D&&($===0?0:u[$-1][0])<D)return u[$][1];return u[$-1][1]};this._renderTicks(r,a,o,F,s,d,f,l,S),this._renderTitleAndDetail(r,a,o,F,s),this._renderAnchor(r,s),this._renderPointer(r,a,o,F,s,d,f,l,S)},t.prototype._renderTicks=function(r,a,o,u,s,c,l,d,f){for(var h=this.group,v=s.cx,g=s.cy,b=s.r,_=+r.get("min"),S=+r.get("max"),T=r.getModel("splitLine"),w=r.getModel("axisTick"),A=r.getModel("axisLabel"),R=r.get("splitNumber"),E=w.get("splitNumber"),I=parsePercent(T.get("length"),b),L=parsePercent(w.get("length"),b),F=c,D=(l-c)/R,$=D/E,O=T.getModel("lineStyle").getLineStyle(),P=w.getModel("lineStyle").getLineStyle(),C=T.get("distance"),q,M,N=0;N<=R;N++){if(q=Math.cos(F),M=Math.sin(F),T.get("show")){var G=C?C+f:f,X=new Line$1({shape:{x1:q*(b-G)+v,y1:M*(b-G)+g,x2:q*(b-I-G)+v,y2:M*(b-I-G)+g},style:O,silent:!0});O.stroke==="auto"&&X.setStyle({stroke:u(N/R)}),h.add(X)}if(A.get("show")){var G=A.get("distance")+C,Y=formatLabel(round$3(N/R*(S-_)+_),A.get("formatter")),W=u(N/R),te=q*(b-I-G)+v,ue=M*(b-I-G)+g,fe=A.get("rotate"),re=0;fe==="radial"?(re=-F+2*Math.PI,re>Math.PI/2&&(re+=Math.PI)):fe==="tangential"?re=-F-Math.PI/2:isNumber(fe)&&(re=fe*Math.PI/180),re===0?h.add(new ZRText({style:createTextStyle(A,{text:Y,x:te,y:ue,verticalAlign:M<-.8?"top":M>.8?"bottom":"middle",align:q<-.4?"left":q>.4?"right":"center"},{inheritColor:W}),silent:!0})):h.add(new ZRText({style:createTextStyle(A,{text:Y,x:te,y:ue,verticalAlign:"middle",align:"center"},{inheritColor:W}),silent:!0,originX:te,originY:ue,rotation:re}))}if(w.get("show")&&N!==R){var G=w.get("distance");G=G?G+f:f;for(var ye=0;ye<=E;ye++){q=Math.cos(F),M=Math.sin(F);var Te=new Line$1({shape:{x1:q*(b-G)+v,y1:M*(b-G)+g,x2:q*(b-L-G)+v,y2:M*(b-L-G)+g},silent:!0,style:P});P.stroke==="auto"&&Te.setStyle({stroke:u((N+ye/E)/R)}),h.add(Te),F+=$}F-=$}else F+=D}},t.prototype._renderPointer=function(r,a,o,u,s,c,l,d,f){var h=this.group,v=this._data,g=this._progressEls,b=[],_=r.get(["pointer","show"]),S=r.getModel("progress"),T=S.get("show"),w=r.getData(),A=w.mapDimension("value"),R=+r.get("min"),E=+r.get("max"),I=[R,E],L=[c,l];function F($,O){var P=w.getItemModel($),C=P.getModel("pointer"),q=parsePercent(C.get("width"),s.r),M=parsePercent(C.get("length"),s.r),N=r.get(["pointer","icon"]),G=C.get("offsetCenter"),X=parsePercent(G[0],s.r),Y=parsePercent(G[1],s.r),W=C.get("keepAspect"),te;return N?te=createSymbol$1(N,X-q/2,Y-M,q,M,null,W):te=new PointerPath({shape:{angle:-Math.PI/2,width:q,r:M,x:X,y:Y}}),te.rotation=-(O+Math.PI/2),te.x=s.cx,te.y=s.cy,te}function D($,O){var P=S.get("roundCap"),C=P?SausagePath:Sector,q=S.get("overlap"),M=q?S.get("width"):f/w.count(),N=q?s.r-M:s.r-($+1)*M,G=q?s.r:s.r-$*M,X=new C({shape:{startAngle:c,endAngle:O,cx:s.cx,cy:s.cy,clockwise:d,r0:N,r:G}});return q&&(X.z2=linearMap$2(w.get(A,$),[R,E],[100,0],!0)),X}(T||_)&&(w.diff(v).add(function($){var O=w.get(A,$);if(_){var P=F($,c);initProps(P,{rotation:-((isNaN(+O)?L[0]:linearMap$2(O,I,L,!0))+Math.PI/2)},r),h.add(P),w.setItemGraphicEl($,P)}if(T){var C=D($,c),q=S.get("clip");initProps(C,{shape:{endAngle:linearMap$2(O,I,L,q)}},r),h.add(C),setCommonECData(r.seriesIndex,w.dataType,$,C),b[$]=C}}).update(function($,O){var P=w.get(A,$);if(_){var C=v.getItemGraphicEl(O),q=C?C.rotation:c,M=F($,q);M.rotation=q,updateProps$1(M,{rotation:-((isNaN(+P)?L[0]:linearMap$2(P,I,L,!0))+Math.PI/2)},r),h.add(M),w.setItemGraphicEl($,M)}if(T){var N=g[O],G=N?N.shape.endAngle:c,X=D($,G),Y=S.get("clip");updateProps$1(X,{shape:{endAngle:linearMap$2(P,I,L,Y)}},r),h.add(X),setCommonECData(r.seriesIndex,w.dataType,$,X),b[$]=X}}).execute(),w.each(function($){var O=w.getItemModel($),P=O.getModel("emphasis"),C=P.get("focus"),q=P.get("blurScope"),M=P.get("disabled");if(_){var N=w.getItemGraphicEl($),G=w.getItemVisual($,"style"),X=G.fill;if(N instanceof ZRImage){var Y=N.style;N.useStyle(extend$1({image:Y.image,x:Y.x,y:Y.y,width:Y.width,height:Y.height},G))}else N.useStyle(G),N.type!=="pointer"&&N.setColor(X);N.setStyle(O.getModel(["pointer","itemStyle"]).getItemStyle()),N.style.fill==="auto"&&N.setStyle("fill",u(linearMap$2(w.get(A,$),I,[0,1],!0))),N.z2EmphasisLift=0,setStatesStylesFromModel(N,O),toggleHoverEmphasis(N,C,q,M)}if(T){var W=b[$];W.useStyle(w.getItemVisual($,"style")),W.setStyle(O.getModel(["progress","itemStyle"]).getItemStyle()),W.z2EmphasisLift=0,setStatesStylesFromModel(W,O),toggleHoverEmphasis(W,C,q,M)}}),this._progressEls=b)},t.prototype._renderAnchor=function(r,a){var o=r.getModel("anchor"),u=o.get("show");if(u){var s=o.get("size"),c=o.get("icon"),l=o.get("offsetCenter"),d=o.get("keepAspect"),f=createSymbol$1(c,a.cx-s/2+parsePercent(l[0],a.r),a.cy-s/2+parsePercent(l[1],a.r),s,s,null,d);f.z2=o.get("showAbove")?1:0,f.setStyle(o.getModel("itemStyle").getItemStyle()),this.group.add(f)}},t.prototype._renderTitleAndDetail=function(r,a,o,u,s){var c=this,l=r.getData(),d=l.mapDimension("value"),f=+r.get("min"),h=+r.get("max"),v=new Group$3,g=[],b=[],_=r.isAnimationEnabled(),S=r.get(["pointer","showAbove"]);l.diff(this._data).add(function(T){g[T]=new ZRText({silent:!0}),b[T]=new ZRText({silent:!0})}).update(function(T,w){g[T]=c._titleEls[w],b[T]=c._detailEls[w]}).execute(),l.each(function(T){var w=l.getItemModel(T),A=l.get(d,T),R=new Group$3,E=u(linearMap$2(A,[f,h],[0,1],!0)),I=w.getModel("title");if(I.get("show")){var L=I.get("offsetCenter"),F=s.cx+parsePercent(L[0],s.r),D=s.cy+parsePercent(L[1],s.r),$=g[T];$.attr({z2:S?0:2,style:createTextStyle(I,{x:F,y:D,text:l.getName(T),align:"center",verticalAlign:"middle"},{inheritColor:E})}),R.add($)}var O=w.getModel("detail");if(O.get("show")){var P=O.get("offsetCenter"),C=s.cx+parsePercent(P[0],s.r),q=s.cy+parsePercent(P[1],s.r),M=parsePercent(O.get("width"),s.r),N=parsePercent(O.get("height"),s.r),G=r.get(["progress","show"])?l.getItemVisual(T,"style").fill:E,$=b[T],X=O.get("formatter");$.attr({z2:S?0:2,style:createTextStyle(O,{x:C,y:q,text:formatLabel(A,X),width:isNaN(M)?null:M,height:isNaN(N)?null:N,align:"center",verticalAlign:"middle"},{inheritColor:G})}),setLabelValueAnimation($,{normal:O},A,function(W){return formatLabel(W,X)}),_&&animateLabelValue($,T,l,r,{getFormattedLabel:function(W,te,ue,fe,re,ye){return formatLabel(ye?ye.interpolatedValue:A,X)}}),R.add($)}v.add(R)}),this.group.add(v),this._titleEls=g,this._detailEls=b},t.type="gauge",t}(ChartView),GaugeSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="itemStyle",r}return t.prototype.getInitialData=function(r,a){return createSeriesDataSimply(this,["value"])},t.type="series.gauge",t.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},t}(SeriesModel);function install$E(n){n.registerChartView(GaugeView),n.registerSeriesModel(GaugeSeriesModel)}var opacityAccessPath$1=["itemStyle","opacity"],FunnelPiece=function(n){__extends(t,n);function t(r,a){var o=n.call(this)||this,u=o,s=new Polyline$1,c=new ZRText;return u.setTextContent(c),o.setTextGuideLine(s),o.updateData(r,a,!0),o}return t.prototype.updateData=function(r,a,o){var u=this,s=r.hostModel,c=r.getItemModel(a),l=r.getItemLayout(a),d=c.getModel("emphasis"),f=c.get(opacityAccessPath$1);f=f??1,o||saveOldStyle(u),u.useStyle(r.getItemVisual(a,"style")),u.style.lineJoin="round",o?(u.setShape({points:l.points}),u.style.opacity=0,initProps(u,{style:{opacity:f}},s,a)):updateProps$1(u,{style:{opacity:f},shape:{points:l.points}},s,a),setStatesStylesFromModel(u,c),this._updateLabel(r,a),toggleHoverEmphasis(this,d.get("focus"),d.get("blurScope"),d.get("disabled"))},t.prototype._updateLabel=function(r,a){var o=this,u=this.getTextGuideLine(),s=o.getTextContent(),c=r.hostModel,l=r.getItemModel(a),d=r.getItemLayout(a),f=d.label,h=r.getItemVisual(a,"style"),v=h.fill;setLabelStyle(s,getLabelStatesModels(l),{labelFetcher:r.hostModel,labelDataIndex:a,defaultOpacity:h.opacity,defaultText:r.getName(a)},{normal:{align:f.textAlign,verticalAlign:f.verticalAlign}}),o.setTextConfig({local:!0,inside:!!f.inside,insideStroke:v,outsideFill:v});var g=f.linePoints;u.setShape({points:g}),o.textGuideLineConfig={anchor:g?new Point(g[0][0],g[0][1]):null},updateProps$1(s,{style:{x:f.x,y:f.y}},c,a),s.attr({rotation:f.rotation,originX:f.x,originY:f.y,z2:10}),setLabelLineStyle(o,getLabelLineStatesModels(l),{stroke:v})},t}(Polygon),FunnelView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,a,o){var u=r.getData(),s=this._data,c=this.group;u.diff(s).add(function(l){var d=new FunnelPiece(u,l);u.setItemGraphicEl(l,d),c.add(d)}).update(function(l,d){var f=s.getItemGraphicEl(d);f.updateData(u,l),c.add(f),u.setItemGraphicEl(l,f)}).remove(function(l){var d=s.getItemGraphicEl(l);removeElementWithFadeOut(d,r,l)}).execute(),this._data=u},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.prototype.dispose=function(){},t.type="funnel",t}(ChartView),FunnelSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.getInitialData=function(r,a){return createSeriesDataSimply(this,{coordDimensions:["value"],encodeDefaulter:curry$1(makeSeriesEncodeForNameBased,this)})},t.prototype._defaultLabelLine=function(r){defaultEmphasis(r,"labelLine",["show"]);var a=r.labelLine,o=r.emphasis.labelLine;a.show=a.show&&r.label.show,o.show=o.show&&r.emphasis.label.show},t.prototype.getDataParams=function(r){var a=this.getData(),o=n.prototype.getDataParams.call(this,r),u=a.mapDimension("value"),s=a.getSum(u);return o.percent=s?+(a.get(u,r)/s*100).toFixed(2):0,o.$vars.push("percent"),o},t.type="series.funnel",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}(SeriesModel);function getViewRect$2(n,t){return getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function getSortedIndices(n,t){for(var r=n.mapDimension("value"),a=n.mapArray(r,function(l){return l}),o=[],u=t==="ascending",s=0,c=n.count();s<c;s++)o[s]=s;return isFunction$1(t)?o.sort(t):t!=="none"&&o.sort(function(l,d){return u?a[l]-a[d]:a[d]-a[l]}),o}function labelLayout(n){var t=n.hostModel,r=t.get("orient");n.each(function(a){var o=n.getItemModel(a),u=o.getModel("label"),s=u.get("position"),c=o.getModel("labelLine"),l=n.getItemLayout(a),d=l.points,f=s==="inner"||s==="inside"||s==="center"||s==="insideLeft"||s==="insideRight",h,v,g,b;if(f)s==="insideLeft"?(v=(d[0][0]+d[3][0])/2+5,g=(d[0][1]+d[3][1])/2,h="left"):s==="insideRight"?(v=(d[1][0]+d[2][0])/2-5,g=(d[1][1]+d[2][1])/2,h="right"):(v=(d[0][0]+d[1][0]+d[2][0]+d[3][0])/4,g=(d[0][1]+d[1][1]+d[2][1]+d[3][1])/4,h="center"),b=[[v,g],[v,g]];else{var _=void 0,S=void 0,T=void 0,w=void 0,A=c.get("length");s==="left"?(_=(d[3][0]+d[0][0])/2,S=(d[3][1]+d[0][1])/2,T=_-A,v=T-5,h="right"):s==="right"?(_=(d[1][0]+d[2][0])/2,S=(d[1][1]+d[2][1])/2,T=_+A,v=T+5,h="left"):s==="top"?(_=(d[3][0]+d[0][0])/2,S=(d[3][1]+d[0][1])/2,w=S-A,g=w-5,h="center"):s==="bottom"?(_=(d[1][0]+d[2][0])/2,S=(d[1][1]+d[2][1])/2,w=S+A,g=w+5,h="center"):s==="rightTop"?(_=r==="horizontal"?d[3][0]:d[1][0],S=r==="horizontal"?d[3][1]:d[1][1],r==="horizontal"?(w=S-A,g=w-5,h="center"):(T=_+A,v=T+5,h="top")):s==="rightBottom"?(_=d[2][0],S=d[2][1],r==="horizontal"?(w=S+A,g=w+5,h="center"):(T=_+A,v=T+5,h="bottom")):s==="leftTop"?(_=d[0][0],S=r==="horizontal"?d[0][1]:d[1][1],r==="horizontal"?(w=S-A,g=w-5,h="center"):(T=_-A,v=T-5,h="right")):s==="leftBottom"?(_=r==="horizontal"?d[1][0]:d[3][0],S=r==="horizontal"?d[1][1]:d[2][1],r==="horizontal"?(w=S+A,g=w+5,h="center"):(T=_-A,v=T-5,h="right")):(_=(d[1][0]+d[2][0])/2,S=(d[1][1]+d[2][1])/2,r==="horizontal"?(w=S+A,g=w+5,h="center"):(T=_+A,v=T+5,h="left")),r==="horizontal"?(T=_,v=T):(w=S,g=w),b=[[_,S],[T,w]]}l.label={linePoints:b,x:v,y:g,verticalAlign:"middle",textAlign:h,inside:f}})}function funnelLayout(n,t){n.eachSeriesByType("funnel",function(r){var a=r.getData(),o=a.mapDimension("value"),u=r.get("sort"),s=getViewRect$2(r,t),c=r.get("orient"),l=s.width,d=s.height,f=getSortedIndices(a,u),h=s.x,v=s.y,g=c==="horizontal"?[parsePercent(r.get("minSize"),d),parsePercent(r.get("maxSize"),d)]:[parsePercent(r.get("minSize"),l),parsePercent(r.get("maxSize"),l)],b=a.getDataExtent(o),_=r.get("min"),S=r.get("max");_==null&&(_=Math.min(b[0],0)),S==null&&(S=b[1]);var T=r.get("funnelAlign"),w=r.get("gap"),A=c==="horizontal"?l:d,R=(A-w*(a.count()-1))/a.count(),E=function(q,M){if(c==="horizontal"){var N=a.get(o,q)||0,G=linearMap$2(N,[_,S],g,!0),X=void 0;switch(T){case"top":X=v;break;case"center":X=v+(d-G)/2;break;case"bottom":X=v+(d-G);break}return[[M,X],[M,X+G]]}var Y=a.get(o,q)||0,W=linearMap$2(Y,[_,S],g,!0),te;switch(T){case"left":te=h;break;case"center":te=h+(l-W)/2;break;case"right":te=h+l-W;break}return[[te,M],[te+W,M]]};u==="ascending"&&(R=-R,w=-w,c==="horizontal"?h+=l:v+=d,f=f.reverse());for(var I=0;I<f.length;I++){var L=f[I],F=f[I+1],D=a.getItemModel(L);if(c==="horizontal"){var $=D.get(["itemStyle","width"]);$==null?$=R:($=parsePercent($,l),u==="ascending"&&($=-$));var O=E(L,h),P=E(F,h+$);h+=$+w,a.setItemLayout(L,{points:O.concat(P.slice().reverse())})}else{var C=D.get(["itemStyle","height"]);C==null?C=R:(C=parsePercent(C,d),u==="ascending"&&(C=-C));var O=E(L,v),P=E(F,v+C);v+=C+w,a.setItemLayout(L,{points:O.concat(P.slice().reverse())})}}labelLayout(a)})}function install$D(n){n.registerChartView(FunnelView),n.registerSeriesModel(FunnelSeriesModel),n.registerLayout(funnelLayout),n.registerProcessor(dataFilter$1("funnel"))}var DEFAULT_SMOOTH=.3,ParallelView$1=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._dataGroup=new Group$3,r._initialized=!1,r}return t.prototype.init=function(){this.group.add(this._dataGroup)},t.prototype.render=function(r,a,o,u){this._progressiveEls=null;var s=this._dataGroup,c=r.getData(),l=this._data,d=r.coordinateSystem,f=d.dimensions,h=makeSeriesScope(r);c.diff(l).add(v).update(g).remove(b).execute();function v(S){var T=addEl(c,s,S,f,d);updateElCommon(T,c,S,h)}function g(S,T){var w=l.getItemGraphicEl(T),A=createLinePoints(c,S,f,d);c.setItemGraphicEl(S,w),updateProps$1(w,{shape:{points:A}},r,S),saveOldStyle(w),updateElCommon(w,c,S,h)}function b(S){var T=l.getItemGraphicEl(S);s.remove(T)}if(!this._initialized){this._initialized=!0;var _=createGridClipShape$2(d,r,function(){setTimeout(function(){s.removeClipPath()})});s.setClipPath(_)}this._data=c},t.prototype.incrementalPrepareRender=function(r,a,o){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},t.prototype.incrementalRender=function(r,a,o){for(var u=a.getData(),s=a.coordinateSystem,c=s.dimensions,l=makeSeriesScope(a),d=this._progressiveEls=[],f=r.start;f<r.end;f++){var h=addEl(u,this._dataGroup,f,c,s);h.incremental=!0,updateElCommon(h,u,f,l),d.push(h)}},t.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},t.type="parallel",t}(ChartView);function createGridClipShape$2(n,t,r){var a=n.model,o=n.getRect(),u=new Rect$2({shape:{x:o.x,y:o.y,width:o.width,height:o.height}}),s=a.get("layout")==="horizontal"?"width":"height";return u.setShape(s,0),initProps(u,{shape:{width:o.width,height:o.height}},t,r),u}function createLinePoints(n,t,r,a){for(var o=[],u=0;u<r.length;u++){var s=r[u],c=n.get(n.mapDimension(s),t);isEmptyValue(c,a.getAxis(s).type)||o.push(a.dataToPoint(c,s))}return o}function addEl(n,t,r,a,o){var u=createLinePoints(n,r,a,o),s=new Polyline$1({shape:{points:u},z2:10});return t.add(s),n.setItemGraphicEl(r,s),s}function makeSeriesScope(n){var t=n.get("smooth",!0);return t===!0&&(t=DEFAULT_SMOOTH),t=numericToNumber(t),eqNaN(t)&&(t=0),{smooth:t}}function updateElCommon(n,t,r,a){n.useStyle(t.getItemVisual(r,"style")),n.style.fill=null,n.setShape("smooth",a.smooth);var o=t.getItemModel(r),u=o.getModel("emphasis");setStatesStylesFromModel(n,o,"lineStyle"),toggleHoverEmphasis(n,u.get("focus"),u.get("blurScope"),u.get("disabled"))}function isEmptyValue(n,t){return t==="category"?n==null:n==null||isNaN(n)}var ParallelSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.getInitialData=function(r,a){return createSeriesData(null,this,{useEncodeDefaulter:bind$1(makeDefaultEncode,null,this)})},t.prototype.getRawIndicesByActiveState=function(r){var a=this.coordinateSystem,o=this.getData(),u=[];return a.eachActiveState(o,function(s,c){r===s&&u.push(o.getRawIndex(c))}),u},t.type="series.parallel",t.dependencies=["parallel"],t.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},t}(SeriesModel);function makeDefaultEncode(n){var t=n.ecModel.getComponent("parallel",n.get("parallelIndex"));if(t){var r={};return each$f(t.dimensions,function(a){var o=convertDimNameToNumber(a);r[a]=o}),r}}function convertDimNameToNumber(n){return+n.replace("dim","")}var opacityAccessPath=["lineStyle","opacity"],parallelVisual={seriesType:"parallel",reset:function(n,t){var r=n.coordinateSystem,a={normal:n.get(["lineStyle","opacity"]),active:n.get("activeOpacity"),inactive:n.get("inactiveOpacity")};return{progress:function(o,u){r.eachActiveState(u,function(s,c){var l=a[s];if(s==="normal"&&u.hasItemOption){var d=u.getItemModel(c).get(opacityAccessPath,!0);d!=null&&(l=d)}var f=u.ensureUniqueItemVisual(c,"style");f.opacity=l},o.start,o.end)}}}};function parallelPreprocessor(n){createParallelIfNeeded(n),mergeAxisOptionFromParallel(n)}function createParallelIfNeeded(n){if(!n.parallel){var t=!1;each$f(n.series,function(r){r&&r.type==="parallel"&&(t=!0)}),t&&(n.parallel=[{}])}}function mergeAxisOptionFromParallel(n){var t=normalizeToArray(n.parallelAxis);each$f(t,function(r){if(isObject$4(r)){var a=r.parallelIndex||0,o=normalizeToArray(n.parallel)[a];o&&o.parallelAxisDefault&&merge$3(r,o.parallelAxisDefault,!1)}})}var CLICK_THRESHOLD=5,ParallelView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){this._model=r,this._api=o,this._handlers||(this._handlers={},each$f(handlers$1,function(u,s){o.getZr().on(s,this._handlers[s]=bind$1(u,this))},this)),createOrUpdate(this,"_throttledDispatchExpand",r.get("axisExpandRate"),"fixRate")},t.prototype.dispose=function(r,a){clear$1(this,"_throttledDispatchExpand"),each$f(this._handlers,function(o,u){a.getZr().off(u,o)}),this._handlers=null},t.prototype._throttledDispatchExpand=function(r){this._dispatchExpand(r)},t.prototype._dispatchExpand=function(r){r&&this._api.dispatchAction(extend$1({type:"parallelAxisExpand"},r))},t.type="parallel",t}(ComponentView),handlers$1={mousedown:function(n){checkTrigger(this,"click")&&(this._mouseDownPoint=[n.offsetX,n.offsetY])},mouseup:function(n){var t=this._mouseDownPoint;if(checkTrigger(this,"click")&&t){var r=[n.offsetX,n.offsetY],a=Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2);if(a>CLICK_THRESHOLD)return;var o=this._model.coordinateSystem.getSlidedAxisExpandWindow([n.offsetX,n.offsetY]);o.behavior!=="none"&&this._dispatchExpand({axisExpandWindow:o.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(n){if(!(this._mouseDownPoint||!checkTrigger(this,"mousemove"))){var t=this._model,r=t.coordinateSystem.getSlidedAxisExpandWindow([n.offsetX,n.offsetY]),a=r.behavior;a==="jump"&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand(a==="none"?null:{axisExpandWindow:r.axisExpandWindow,animation:a==="jump"?null:{duration:0}})}}};function checkTrigger(n,t){var r=n._model;return r.get("axisExpandable")&&r.get("axisExpandTriggerOn")===t}var ParallelModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){n.prototype.init.apply(this,arguments),this.mergeOption({})},t.prototype.mergeOption=function(r){var a=this.option;r&&merge$3(a,r,!0),this._initDimensions()},t.prototype.contains=function(r,a){var o=r.get("parallelIndex");return o!=null&&a.getComponent("parallel",o)===this},t.prototype.setAxisExpand=function(r){each$f(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(a){r.hasOwnProperty(a)&&(this.option[a]=r[a])},this)},t.prototype._initDimensions=function(){var r=this.dimensions=[],a=this.parallelAxisIndex=[],o=filter$1(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(u){return(u.get("parallelIndex")||0)===this.componentIndex},this);each$f(o,function(u){r.push("dim"+u.get("dim")),a.push(u.componentIndex)})},t.type="parallel",t.dependencies=["parallelAxis"],t.layoutMode="box",t.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},t}(ComponentModel),ParallelAxis=function(n){__extends(t,n);function t(r,a,o,u,s){var c=n.call(this,r,a,o)||this;return c.type=u||"value",c.axisIndex=s,c}return t.prototype.isHorizontal=function(){return this.coordinateSystem.getModel().get("layout")!=="horizontal"},t}(Axis);function sliderMove(n,t,r,a,o,u){n=n||0;var s=r[1]-r[0];if(o!=null&&(o=restrict$1(o,[0,s])),u!=null&&(u=Math.max(u,o??0)),a==="all"){var c=Math.abs(t[1]-t[0]);c=restrict$1(c,[0,s]),o=u=restrict$1(c,[o,u]),a=0}t[0]=restrict$1(t[0],r),t[1]=restrict$1(t[1],r);var l=getSpanSign(t,a);t[a]+=n;var d=o||0,f=r.slice();l.sign<0?f[0]+=d:f[1]-=d,t[a]=restrict$1(t[a],f);var h;return h=getSpanSign(t,a),o!=null&&(h.sign!==l.sign||h.span<o)&&(t[1-a]=t[a]+l.sign*o),h=getSpanSign(t,a),u!=null&&h.span>u&&(t[1-a]=t[a]+h.sign*u),t}function getSpanSign(n,t){var r=n[t]-n[1-t];return{span:Math.abs(r),sign:r>0?-1:r<0?1:t?-1:1}}function restrict$1(n,t){return Math.min(t[1]!=null?t[1]:1/0,Math.max(t[0]!=null?t[0]:-1/0,n))}var each$a=each$f,mathMin$2=Math.min,mathMax$2=Math.max,mathFloor=Math.floor,mathCeil=Math.ceil,round=round$3,PI$1=Math.PI,Parallel=function(){function n(t,r,a){this.type="parallel",this._axesMap=createHashMap(),this._axesLayout={},this.dimensions=t.dimensions,this._model=t,this._init(t,r,a)}return n.prototype._init=function(t,r,a){var o=t.dimensions,u=t.parallelAxisIndex;each$a(o,function(s,c){var l=u[c],d=r.getComponent("parallelAxis",l),f=this._axesMap.set(s,new ParallelAxis(s,createScaleByModel$1(d),[0,0],d.get("type"),l)),h=f.type==="category";f.onBand=h&&d.get("boundaryGap"),f.inverse=d.get("inverse"),d.axis=f,f.model=d,f.coordinateSystem=d.coordinateSystem=this},this)},n.prototype.update=function(t,r){this._updateAxesFromSeries(this._model,t)},n.prototype.containPoint=function(t){var r=this._makeLayoutInfo(),a=r.axisBase,o=r.layoutBase,u=r.pixelDimIndex,s=t[1-u],c=t[u];return s>=a&&s<=a+r.axisLength&&c>=o&&c<=o+r.layoutLength},n.prototype.getModel=function(){return this._model},n.prototype._updateAxesFromSeries=function(t,r){r.eachSeries(function(a){if(t.contains(a,r)){var o=a.getData();each$a(this.dimensions,function(u){var s=this._axesMap.get(u);s.scale.unionExtentFromData(o,o.mapDimension(u)),niceScaleExtent(s.scale,s.model)},this)}},this)},n.prototype.resize=function(t,r){this._rect=getLayoutRect(t.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),this._layoutAxes()},n.prototype.getRect=function(){return this._rect},n.prototype._makeLayoutInfo=function(){var t=this._model,r=this._rect,a=["x","y"],o=["width","height"],u=t.get("layout"),s=u==="horizontal"?0:1,c=r[o[s]],l=[0,c],d=this.dimensions.length,f=restrict(t.get("axisExpandWidth"),l),h=restrict(t.get("axisExpandCount")||0,[0,d]),v=t.get("axisExpandable")&&d>3&&d>h&&h>1&&f>0&&c>0,g=t.get("axisExpandWindow"),b;if(g)b=restrict(g[1]-g[0],l),g[1]=g[0]+b;else{b=restrict(f*(h-1),l);var _=t.get("axisExpandCenter")||mathFloor(d/2);g=[f*_-b/2],g[1]=g[0]+b}var S=(c-b)/(d-h);S<3&&(S=0);var T=[mathFloor(round(g[0]/f,1))+1,mathCeil(round(g[1]/f,1))-1],w=S/f*g[0];return{layout:u,pixelDimIndex:s,layoutBase:r[a[s]],layoutLength:c,axisBase:r[a[1-s]],axisLength:r[o[1-s]],axisExpandable:v,axisExpandWidth:f,axisCollapseWidth:S,axisExpandWindow:g,axisCount:d,winInnerIndices:T,axisExpandWindow0Pos:w}},n.prototype._layoutAxes=function(){var t=this._rect,r=this._axesMap,a=this.dimensions,o=this._makeLayoutInfo(),u=o.layout;r.each(function(s){var c=[0,o.axisLength],l=s.inverse?1:0;s.setExtent(c[l],c[1-l])}),each$a(a,function(s,c){var l=(o.axisExpandable?layoutAxisWithExpand:layoutAxisWithoutExpand)(c,o),d={horizontal:{x:l.position,y:o.axisLength},vertical:{x:0,y:l.position}},f={horizontal:PI$1/2,vertical:0},h=[d[u].x+t.x,d[u].y+t.y],v=f[u],g=create$2();rotate$1(g,g,v),translate$1(g,g,h),this._axesLayout[s]={position:h,rotation:v,transform:g,axisNameAvailableWidth:l.axisNameAvailableWidth,axisLabelShow:l.axisLabelShow,nameTruncateMaxWidth:l.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},n.prototype.getAxis=function(t){return this._axesMap.get(t)},n.prototype.dataToPoint=function(t,r){return this.axisCoordToPoint(this._axesMap.get(r).dataToCoord(t),r)},n.prototype.eachActiveState=function(t,r,a,o){a==null&&(a=0),o==null&&(o=t.count());var u=this._axesMap,s=this.dimensions,c=[],l=[];each$f(s,function(S){c.push(t.mapDimension(S)),l.push(u.get(S).model)});for(var d=this.hasAxisBrushed(),f=a;f<o;f++){var h=void 0;if(!d)h="normal";else{h="active";for(var v=t.getValues(c,f),g=0,b=s.length;g<b;g++){var _=l[g].getActiveState(v[g]);if(_==="inactive"){h="inactive";break}}}r(h,f)}},n.prototype.hasAxisBrushed=function(){for(var t=this.dimensions,r=this._axesMap,a=!1,o=0,u=t.length;o<u;o++)r.get(t[o]).model.getActiveState()!=="normal"&&(a=!0);return a},n.prototype.axisCoordToPoint=function(t,r){var a=this._axesLayout[r];return applyTransform([t,0],a.transform)},n.prototype.getAxisLayout=function(t){return clone$5(this._axesLayout[t])},n.prototype.getSlidedAxisExpandWindow=function(t){var r=this._makeLayoutInfo(),a=r.pixelDimIndex,o=r.axisExpandWindow.slice(),u=o[1]-o[0],s=[0,r.axisExpandWidth*(r.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:o};var c=t[a]-r.layoutBase-r.axisExpandWindow0Pos,l,d="slide",f=r.axisCollapseWidth,h=this._model.get("axisExpandSlideTriggerArea"),v=h[0]!=null;if(f)v&&f&&c<u*h[0]?(d="jump",l=c-u*h[2]):v&&f&&c>u*(1-h[0])?(d="jump",l=c-u*(1-h[2])):(l=c-u*h[1])>=0&&(l=c-u*(1-h[1]))<=0&&(l=0),l*=r.axisExpandWidth/f,l?sliderMove(l,o,s,"all"):d="none";else{var g=o[1]-o[0],b=s[1]*c/g;o=[mathMax$2(0,b-g/2)],o[1]=mathMin$2(s[1],o[0]+g),o[0]=o[1]-g}return{axisExpandWindow:o,behavior:d}},n}();function restrict(n,t){return mathMin$2(mathMax$2(n,t[0]),t[1])}function layoutAxisWithoutExpand(n,t){var r=t.layoutLength/(t.axisCount-1);return{position:r*n,axisNameAvailableWidth:r,axisLabelShow:!0}}function layoutAxisWithExpand(n,t){var r=t.layoutLength,a=t.axisExpandWidth,o=t.axisCount,u=t.axisCollapseWidth,s=t.winInnerIndices,c,l=u,d=!1,f;return n<s[0]?(c=n*u,f=u):n<=s[1]?(c=t.axisExpandWindow0Pos+n*a-t.axisExpandWindow[0],l=a,d=!0):(c=r-(o-1-n)*u,f=u),{position:c,axisNameAvailableWidth:l,axisLabelShow:d,nameTruncateMaxWidth:f}}function createParallelCoordSys(n,t){var r=[];return n.eachComponent("parallel",function(a,o){var u=new Parallel(a,n,t);u.name="parallel_"+o,u.resize(a,t),a.coordinateSystem=u,u.model=a,r.push(u)}),n.eachSeries(function(a){if(a.get("coordinateSystem")==="parallel"){var o=a.getReferringComponents("parallel",SINGLE_REFERRING).models[0];a.coordinateSystem=o.coordinateSystem}}),r}var parallelCoordSysCreator={create:createParallelCoordSys},ParallelAxisModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.activeIntervals=[],r}return t.prototype.getAreaSelectStyle=function(){return makeStyleMapper([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},t.prototype.setActiveIntervals=function(r){var a=this.activeIntervals=clone$5(r);if(a)for(var o=a.length-1;o>=0;o--)asc$2(a[o])},t.prototype.getActiveState=function(r){var a=this.activeIntervals;if(!a.length)return"normal";if(r==null||isNaN(+r))return"inactive";if(a.length===1){var o=a[0];if(o[0]<=r&&r<=o[1])return"active"}else for(var u=0,s=a.length;u<s;u++)if(a[u][0]<=r&&r<=a[u][1])return"active";return"inactive"},t}(ComponentModel);mixin$1(ParallelAxisModel,AxisModelCommonMixin);var BRUSH_PANEL_GLOBAL=!0,mathMin$1=Math.min,mathMax$1=Math.max,mathPow=Math.pow,COVER_Z=1e4,UNSELECT_THRESHOLD=6,MIN_RESIZE_LINE_WIDTH=6,MUTEX_RESOURCE_KEY="globalPan",DIRECTION_MAP={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},CURSOR_MAP={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},DEFAULT_BRUSH_OPT={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},baseUID=0,BrushController=function(n){__extends(t,n);function t(r){var a=n.call(this)||this;return a._track=[],a._covers=[],a._handlers={},a._zr=r,a.group=new Group$3,a._uid="brushController_"+baseUID++,each$f(pointerHandlers,function(o,u){this._handlers[u]=bind$1(o,this)},a),a}return t.prototype.enableBrush=function(r){return this._brushType&&this._doDisableBrush(),r.brushType&&this._doEnableBrush(r),this},t.prototype._doEnableBrush=function(r){var a=this._zr;this._enableGlobalPan||take(a,MUTEX_RESOURCE_KEY,this._uid),each$f(this._handlers,function(o,u){a.on(u,o)}),this._brushType=r.brushType,this._brushOption=merge$3(clone$5(DEFAULT_BRUSH_OPT),r,!0)},t.prototype._doDisableBrush=function(){var r=this._zr;release(r,MUTEX_RESOURCE_KEY,this._uid),each$f(this._handlers,function(a,o){r.off(o,a)}),this._brushType=this._brushOption=null},t.prototype.setPanels=function(r){if(r&&r.length){var a=this._panels={};each$f(r,function(o){a[o.panelId]=clone$5(o)})}else this._panels=null;return this},t.prototype.mount=function(r){r=r||{},this._enableGlobalPan=r.enableGlobalPan;var a=this.group;return this._zr.add(a),a.attr({x:r.x||0,y:r.y||0,rotation:r.rotation||0,scaleX:r.scaleX||1,scaleY:r.scaleY||1}),this._transform=a.getLocalTransform(),this},t.prototype.updateCovers=function(r){r=map$1(r,function(v){return merge$3(clone$5(DEFAULT_BRUSH_OPT),v,!0)});var a="\0-brush-index-",o=this._covers,u=this._covers=[],s=this,c=this._creatingCover;return new DataDiffer(o,r,d,l).add(f).update(f).remove(h).execute(),this;function l(v,g){return(v.id!=null?v.id:a+g)+"-"+v.brushType}function d(v,g){return l(v.__brushOption,g)}function f(v,g){var b=r[v];if(g!=null&&o[g]===c)u[v]=o[g];else{var _=u[v]=g!=null?(o[g].__brushOption=b,o[g]):endCreating(s,createCover(s,b));updateCoverAfterCreation(s,_)}}function h(v){o[v]!==c&&s.group.remove(o[v])}},t.prototype.unmount=function(){return this.enableBrush(!1),clearCovers(this),this._zr.remove(this.group),this},t.prototype.dispose=function(){this.unmount(),this.off()},t}(Eventful);function createCover(n,t){var r=coverRenderers[t.brushType].createCover(n,t);return r.__brushOption=t,updateZ$1(r,t),n.group.add(r),r}function endCreating(n,t){var r=getCoverRenderer(t);return r.endCreating&&(r.endCreating(n,t),updateZ$1(t,t.__brushOption)),t}function updateCoverShape(n,t){var r=t.__brushOption;getCoverRenderer(t).updateCoverShape(n,t,r.range,r)}function updateZ$1(n,t){var r=t.z;r==null&&(r=COVER_Z),n.traverse(function(a){a.z=r,a.z2=r})}function updateCoverAfterCreation(n,t){getCoverRenderer(t).updateCommon(n,t),updateCoverShape(n,t)}function getCoverRenderer(n){return coverRenderers[n.__brushOption.brushType]}function getPanelByPoint(n,t,r){var a=n._panels;if(!a)return BRUSH_PANEL_GLOBAL;var o,u=n._transform;return each$f(a,function(s){s.isTargetByCursor(t,r,u)&&(o=s)}),o}function getPanelByCover(n,t){var r=n._panels;if(!r)return BRUSH_PANEL_GLOBAL;var a=t.__brushOption.panelId;return a!=null?r[a]:BRUSH_PANEL_GLOBAL}function clearCovers(n){var t=n._covers,r=t.length;return each$f(t,function(a){n.group.remove(a)},n),t.length=0,!!r}function trigger(n,t){var r=map$1(n._covers,function(a){var o=a.__brushOption,u=clone$5(o.range);return{brushType:o.brushType,panelId:o.panelId,range:u}});n.trigger("brush",{areas:r,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function shouldShowCover(n){var t=n._track;if(!t.length)return!1;var r=t[t.length-1],a=t[0],o=r[0]-a[0],u=r[1]-a[1],s=mathPow(o*o+u*u,.5);return s>UNSELECT_THRESHOLD}function getTrackEnds(n){var t=n.length-1;return t<0&&(t=0),[n[0],n[t]]}function createBaseRectCover(n,t,r,a){var o=new Group$3;return o.add(new Rect$2({name:"main",style:makeStyle(r),silent:!0,draggable:!0,cursor:"move",drift:curry$1(driftRect,n,t,o,["n","s","w","e"]),ondragend:curry$1(trigger,t,{isEnd:!0})})),each$f(a,function(u){o.add(new Rect$2({name:u.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:curry$1(driftRect,n,t,o,u),ondragend:curry$1(trigger,t,{isEnd:!0})}))}),o}function updateBaseRect(n,t,r,a){var o=a.brushStyle.lineWidth||0,u=mathMax$1(o,MIN_RESIZE_LINE_WIDTH),s=r[0][0],c=r[1][0],l=s-o/2,d=c-o/2,f=r[0][1],h=r[1][1],v=f-u+o/2,g=h-u+o/2,b=f-s,_=h-c,S=b+o,T=_+o;updateRectShape(n,t,"main",s,c,b,_),a.transformable&&(updateRectShape(n,t,"w",l,d,u,T),updateRectShape(n,t,"e",v,d,u,T),updateRectShape(n,t,"n",l,d,S,u),updateRectShape(n,t,"s",l,g,S,u),updateRectShape(n,t,"nw",l,d,u,u),updateRectShape(n,t,"ne",v,d,u,u),updateRectShape(n,t,"sw",l,g,u,u),updateRectShape(n,t,"se",v,g,u,u))}function updateCommon$1(n,t){var r=t.__brushOption,a=r.transformable,o=t.childAt(0);o.useStyle(makeStyle(r)),o.attr({silent:!a,cursor:a?"move":"default"}),each$f([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(u){var s=t.childOfName(u.join("")),c=u.length===1?getGlobalDirection1(n,u[0]):getGlobalDirection2(n,u);s&&s.attr({silent:!a,invisible:!a,cursor:a?CURSOR_MAP[c]+"-resize":null})})}function updateRectShape(n,t,r,a,o,u,s){var c=t.childOfName(r);c&&c.setShape(pointsToRect(clipByPanel(n,t,[[a,o],[a+u,o+s]])))}function makeStyle(n){return defaults$h({strokeNoScale:!0},n.brushStyle)}function formatRectRange(n,t,r,a){var o=[mathMin$1(n,r),mathMin$1(t,a)],u=[mathMax$1(n,r),mathMax$1(t,a)];return[[o[0],u[0]],[o[1],u[1]]]}function getTransform(n){return getTransform$1(n.group)}function getGlobalDirection1(n,t){var r={w:"left",e:"right",n:"top",s:"bottom"},a={left:"w",right:"e",top:"n",bottom:"s"},o=transformDirection(r[t],getTransform(n));return a[o]}function getGlobalDirection2(n,t){var r=[getGlobalDirection1(n,t[0]),getGlobalDirection1(n,t[1])];return(r[0]==="e"||r[0]==="w")&&r.reverse(),r.join("")}function driftRect(n,t,r,a,o,u){var s=r.__brushOption,c=n.toRectRange(s.range),l=toLocalDelta(t,o,u);each$f(a,function(d){var f=DIRECTION_MAP[d];c[f[0]][f[1]]+=l[f[0]]}),s.range=n.fromRectRange(formatRectRange(c[0][0],c[1][0],c[0][1],c[1][1])),updateCoverAfterCreation(t,r),trigger(t,{isEnd:!1})}function driftPolygon(n,t,r,a){var o=t.__brushOption.range,u=toLocalDelta(n,r,a);each$f(o,function(s){s[0]+=u[0],s[1]+=u[1]}),updateCoverAfterCreation(n,t),trigger(n,{isEnd:!1})}function toLocalDelta(n,t,r){var a=n.group,o=a.transformCoordToLocal(t,r),u=a.transformCoordToLocal(0,0);return[o[0]-u[0],o[1]-u[1]]}function clipByPanel(n,t,r){var a=getPanelByCover(n,t);return a&&a!==BRUSH_PANEL_GLOBAL?a.clipPath(r,n._transform):clone$5(r)}function pointsToRect(n){var t=mathMin$1(n[0][0],n[1][0]),r=mathMin$1(n[0][1],n[1][1]),a=mathMax$1(n[0][0],n[1][0]),o=mathMax$1(n[0][1],n[1][1]);return{x:t,y:r,width:a-t,height:o-r}}function resetCursor(n,t,r){if(!(!n._brushType||isOutsideZrArea(n,t.offsetX,t.offsetY))){var a=n._zr,o=n._covers,u=getPanelByPoint(n,t,r);if(!n._dragging)for(var s=0;s<o.length;s++){var c=o[s].__brushOption;if(u&&(u===BRUSH_PANEL_GLOBAL||c.panelId===u.panelId)&&coverRenderers[c.brushType].contain(o[s],r[0],r[1]))return}u&&a.setCursorStyle("crosshair")}}function preventDefault(n){var t=n.event;t.preventDefault&&t.preventDefault()}function mainShapeContain(n,t,r){return n.childOfName("main").contain(t,r)}function updateCoverByMouse(n,t,r,a){var o=n._creatingCover,u=n._creatingPanel,s=n._brushOption,c;if(n._track.push(r.slice()),shouldShowCover(n)||o){if(u&&!o){s.brushMode==="single"&&clearCovers(n);var l=clone$5(s);l.brushType=determineBrushType(l.brushType,u),l.panelId=u===BRUSH_PANEL_GLOBAL?null:u.panelId,o=n._creatingCover=createCover(n,l),n._covers.push(o)}if(o){var d=coverRenderers[determineBrushType(n._brushType,u)],f=o.__brushOption;f.range=d.getCreatingRange(clipByPanel(n,o,n._track)),a&&(endCreating(n,o),d.updateCommon(n,o)),updateCoverShape(n,o),c={isEnd:a}}}else a&&s.brushMode==="single"&&s.removeOnClick&&getPanelByPoint(n,t,r)&&clearCovers(n)&&(c={isEnd:a,removeOnClick:!0});return c}function determineBrushType(n,t){return n==="auto"?t.defaultBrushType:n}var pointerHandlers={mousedown:function(n){if(this._dragging)handleDragEnd(this,n);else if(!n.target||!n.target.draggable){preventDefault(n);var t=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var r=this._creatingPanel=getPanelByPoint(this,n,t);r&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(n){var t=n.offsetX,r=n.offsetY,a=this.group.transformCoordToLocal(t,r);if(resetCursor(this,n,a),this._dragging){preventDefault(n);var o=updateCoverByMouse(this,n,a,!1);o&&trigger(this,o)}},mouseup:function(n){handleDragEnd(this,n)}};function handleDragEnd(n,t){if(n._dragging){preventDefault(t);var r=t.offsetX,a=t.offsetY,o=n.group.transformCoordToLocal(r,a),u=updateCoverByMouse(n,t,o,!0);n._dragging=!1,n._track=[],n._creatingCover=null,u&&trigger(n,u)}}function isOutsideZrArea(n,t,r){var a=n._zr;return t<0||t>a.getWidth()||r<0||r>a.getHeight()}var coverRenderers={lineX:getLineRenderer(0),lineY:getLineRenderer(1),rect:{createCover:function(n,t){function r(a){return a}return createBaseRectCover({toRectRange:r,fromRectRange:r},n,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var t=getTrackEnds(n);return formatRectRange(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(n,t,r,a){updateBaseRect(n,t,r,a)},updateCommon:updateCommon$1,contain:mainShapeContain},polygon:{createCover:function(n,t){var r=new Group$3;return r.add(new Polyline$1({name:"main",style:makeStyle(t),silent:!0})),r},getCreatingRange:function(n){return n},endCreating:function(n,t){t.remove(t.childAt(0)),t.add(new Polygon({name:"main",draggable:!0,drift:curry$1(driftPolygon,n,t),ondragend:curry$1(trigger,n,{isEnd:!0})}))},updateCoverShape:function(n,t,r,a){t.childAt(0).setShape({points:clipByPanel(n,t,r)})},updateCommon:updateCommon$1,contain:mainShapeContain}};function getLineRenderer(n){return{createCover:function(t,r){return createBaseRectCover({toRectRange:function(a){var o=[a,[0,100]];return n&&o.reverse(),o},fromRectRange:function(a){return a[n]}},t,r,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(t){var r=getTrackEnds(t),a=mathMin$1(r[0][n],r[1][n]),o=mathMax$1(r[0][n],r[1][n]);return[a,o]},updateCoverShape:function(t,r,a,o){var u,s=getPanelByCover(t,r);if(s!==BRUSH_PANEL_GLOBAL&&s.getLinearBrushOtherExtent)u=s.getLinearBrushOtherExtent(n);else{var c=t._zr;u=[0,[c.getWidth(),c.getHeight()][1-n]]}var l=[a,u];n&&l.reverse(),updateBaseRect(t,r,l,o)},updateCommon:updateCommon$1,contain:mainShapeContain}}function makeRectPanelClipPath(n){return n=normalizeRect(n),function(t){return clipPointsByRect(t,n)}}function makeLinearBrushOtherExtent(n,t){return n=normalizeRect(n),function(r){var a=t??r,o=a?n.width:n.height,u=a?n.x:n.y;return[u,u+(o||0)]}}function makeRectIsTargetByCursor(n,t,r){var a=normalizeRect(n);return function(o,u){return a.contain(u[0],u[1])&&!onIrrelevantElement(o,t,r)}}function normalizeRect(n){return BoundingRect.create(n)}var elementList$1=["axisLine","axisTickLabel","axisName"],ParallelAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a){n.prototype.init.apply(this,arguments),(this._brushController=new BrushController(a.getZr())).on("brush",bind$1(this._onBrush,this))},t.prototype.render=function(r,a,o,u){if(!fromAxisAreaSelect(r,a,u)){this.axisModel=r,this.api=o,this.group.removeAll();var s=this._axisGroup;if(this._axisGroup=new Group$3,this.group.add(this._axisGroup),!!r.get("show")){var c=getCoordSysModel(r,a),l=c.coordinateSystem,d=r.getAreaSelectStyle(),f=d.width,h=r.axis.dim,v=l.getAxisLayout(h),g=extend$1({strokeContainThreshold:f},v),b=new AxisBuilder(r,g);each$f(elementList$1,b.add,b),this._axisGroup.add(b.getGroup()),this._refreshBrushController(g,d,r,c,f,o),groupTransition(s,this._axisGroup,r)}}},t.prototype._refreshBrushController=function(r,a,o,u,s,c){var l=o.axis.getExtent(),d=l[1]-l[0],f=Math.min(30,Math.abs(d)*.1),h=BoundingRect.create({x:l[0],y:-s/2,width:d,height:s});h.x-=f,h.width+=2*f,this._brushController.mount({enableGlobalPan:!0,rotation:r.rotation,x:r.position[0],y:r.position[1]}).setPanels([{panelId:"pl",clipPath:makeRectPanelClipPath(h),isTargetByCursor:makeRectIsTargetByCursor(h,c,u),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(h,0)}]).enableBrush({brushType:"lineX",brushStyle:a,removeOnClick:!0}).updateCovers(getCoverInfoList(o))},t.prototype._onBrush=function(r){var a=r.areas,o=this.axisModel,u=o.axis,s=map$1(a,function(c){return[u.coordToData(c.range[0],!0),u.coordToData(c.range[1],!0)]});(!o.option.realtime===r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:o.id,intervals:s})},t.prototype.dispose=function(){this._brushController.dispose()},t.type="parallelAxis",t}(ComponentView);function fromAxisAreaSelect(n,t,r){return r&&r.type==="axisAreaSelect"&&t.findComponents({mainType:"parallelAxis",query:r})[0]===n}function getCoverInfoList(n){var t=n.axis;return map$1(n.activeIntervals,function(r){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(r[0],!0),t.dataToCoord(r[1],!0)]}})}function getCoordSysModel(n,t){return t.getComponent("parallel",n.get("parallelIndex"))}var actionInfo={type:"axisAreaSelect",event:"axisAreaSelected"};function installParallelActions(n){n.registerAction(actionInfo,function(t,r){r.eachComponent({mainType:"parallelAxis",query:t},function(a){a.axis.model.setActiveIntervals(t.intervals)})}),n.registerAction("parallelAxisExpand",function(t,r){r.eachComponent({mainType:"parallel",query:t},function(a){a.setAxisExpand(t)})})}var defaultAxisOption={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function install$C(n){n.registerComponentView(ParallelView),n.registerComponentModel(ParallelModel),n.registerCoordinateSystem("parallel",parallelCoordSysCreator),n.registerPreprocessor(parallelPreprocessor),n.registerComponentModel(ParallelAxisModel),n.registerComponentView(ParallelAxisView),axisModelCreator(n,"parallel",ParallelAxisModel,defaultAxisOption),installParallelActions(n)}function install$B(n){use(install$C),n.registerChartView(ParallelView$1),n.registerSeriesModel(ParallelSeriesModel),n.registerVisual(n.PRIORITY.VISUAL.BRUSH,parallelVisual)}var SankeyPathShape=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return n}(),SankeyPath=function(n){__extends(t,n);function t(r){return n.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new SankeyPathShape},t.prototype.buildPath=function(r,a){var o=a.extent;r.moveTo(a.x1,a.y1),r.bezierCurveTo(a.cpx1,a.cpy1,a.cpx2,a.cpy2,a.x2,a.y2),a.orient==="vertical"?(r.lineTo(a.x2+o,a.y2),r.bezierCurveTo(a.cpx2+o,a.cpy2,a.cpx1+o,a.cpy1,a.x1+o,a.y1)):(r.lineTo(a.x2,a.y2+o),r.bezierCurveTo(a.cpx2,a.cpy2+o,a.cpx1,a.cpy1+o,a.x1,a.y1+o)),r.closePath()},t.prototype.highlight=function(){enterEmphasis(this)},t.prototype.downplay=function(){leaveEmphasis(this)},t}(Path),SankeyView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._focusAdjacencyDisabled=!1,r}return t.prototype.render=function(r,a,o){var u=this,s=r.getGraph(),c=this.group,l=r.layoutInfo,d=l.width,f=l.height,h=r.getData(),v=r.getData("edge"),g=r.get("orient");this._model=r,c.removeAll(),c.x=l.x,c.y=l.y,s.eachEdge(function(b){var _=new SankeyPath,S=getECData(_);S.dataIndex=b.dataIndex,S.seriesIndex=r.seriesIndex,S.dataType="edge";var T=b.getModel(),w=T.getModel("lineStyle"),A=w.get("curveness"),R=b.node1.getLayout(),E=b.node1.getModel(),I=E.get("localX"),L=E.get("localY"),F=b.node2.getLayout(),D=b.node2.getModel(),$=D.get("localX"),O=D.get("localY"),P=b.getLayout(),C,q,M,N,G,X,Y,W;_.shape.extent=Math.max(1,P.dy),_.shape.orient=g,g==="vertical"?(C=(I!=null?I*d:R.x)+P.sy,q=(L!=null?L*f:R.y)+R.dy,M=($!=null?$*d:F.x)+P.ty,N=O!=null?O*f:F.y,G=C,X=q*(1-A)+N*A,Y=M,W=q*A+N*(1-A)):(C=(I!=null?I*d:R.x)+R.dx,q=(L!=null?L*f:R.y)+P.sy,M=$!=null?$*d:F.x,N=(O!=null?O*f:F.y)+P.ty,G=C*(1-A)+M*A,X=q,Y=C*A+M*(1-A),W=N),_.setShape({x1:C,y1:q,x2:M,y2:N,cpx1:G,cpy1:X,cpx2:Y,cpy2:W}),_.useStyle(w.getItemStyle()),applyCurveStyle(_.style,g,b);var te=""+T.get("value"),ue=getLabelStatesModels(T,"edgeLabel");setLabelStyle(_,ue,{labelFetcher:{getFormattedLabel:function(ye,Te,Re,ve,ce,J){return r.getFormattedLabel(ye,Te,"edge",ve,retrieve3(ce,ue.normal&&ue.normal.get("formatter"),te),J)}},labelDataIndex:b.dataIndex,defaultText:te}),_.setTextConfig({position:"inside"});var fe=T.getModel("emphasis");setStatesStylesFromModel(_,T,"lineStyle",function(ye){var Te=ye.getItemStyle();return applyCurveStyle(Te,g,b),Te}),c.add(_),v.setItemGraphicEl(b.dataIndex,_);var re=fe.get("focus");toggleHoverEmphasis(_,re==="adjacency"?b.getAdjacentDataIndices():re==="trajectory"?b.getTrajectoryDataIndices():re,fe.get("blurScope"),fe.get("disabled"))}),s.eachNode(function(b){var _=b.getLayout(),S=b.getModel(),T=S.get("localX"),w=S.get("localY"),A=S.getModel("emphasis"),R=S.get(["itemStyle","borderRadius"])||0,E=new Rect$2({shape:{x:T!=null?T*d:_.x,y:w!=null?w*f:_.y,width:_.dx,height:_.dy,r:R},style:S.getModel("itemStyle").getItemStyle(),z2:10});setLabelStyle(E,getLabelStatesModels(S),{labelFetcher:{getFormattedLabel:function(L,F){return r.getFormattedLabel(L,F,"node")}},labelDataIndex:b.dataIndex,defaultText:b.id}),E.disableLabelAnimation=!0,E.setStyle("fill",b.getVisual("color")),E.setStyle("decal",b.getVisual("style").decal),setStatesStylesFromModel(E,S),c.add(E),h.setItemGraphicEl(b.dataIndex,E),getECData(E).dataType="node";var I=A.get("focus");toggleHoverEmphasis(E,I==="adjacency"?b.getAdjacentDataIndices():I==="trajectory"?b.getTrajectoryDataIndices():I,A.get("blurScope"),A.get("disabled"))}),h.eachItemGraphicEl(function(b,_){var S=h.getItemModel(_);S.get("draggable")&&(b.drift=function(T,w){u._focusAdjacencyDisabled=!0,this.shape.x+=T,this.shape.y+=w,this.dirty(),o.dispatchAction({type:"dragNode",seriesId:r.id,dataIndex:h.getRawIndex(_),localX:this.shape.x/d,localY:this.shape.y/f})},b.ondragend=function(){u._focusAdjacencyDisabled=!1},b.draggable=!0,b.cursor="move")}),!this._data&&r.isAnimationEnabled()&&c.setClipPath(createGridClipShape$1(c.getBoundingRect(),r,function(){c.removeClipPath()})),this._data=r.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(ChartView);function applyCurveStyle(n,t,r){switch(n.fill){case"source":n.fill=r.node1.getVisual("color"),n.decal=r.node1.getVisual("style").decal;break;case"target":n.fill=r.node2.getVisual("color"),n.decal=r.node2.getVisual("style").decal;break;case"gradient":var a=r.node1.getVisual("color"),o=r.node2.getVisual("color");isString(a)&&isString(o)&&(n.fill=new LinearGradient(0,0,+(t==="horizontal"),+(t==="vertical"),[{color:a,offset:0},{color:o,offset:1}]))}}function createGridClipShape$1(n,t,r){var a=new Rect$2({shape:{x:n.x-10,y:n.y-10,width:0,height:n.height+20}});return initProps(a,{shape:{width:n.width+20}},t,r),a}var SankeySeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,a){var o=r.edges||r.links||[],u=r.data||r.nodes||[],s=r.levels||[];this.levelModels=[];for(var c=this.levelModels,l=0;l<s.length;l++)s[l].depth!=null&&s[l].depth>=0&&(c[s[l].depth]=new Model(s[l],this,a));var d=createGraphFromNodeEdge(u,o,this,!0,f);return d.data;function f(h,v){h.wrapMethod("getItemModel",function(g,b){var _=g.parentModel,S=_.getData().getItemLayout(b);if(S){var T=S.depth,w=_.levelModels[T];w&&(g.parentModel=w)}return g}),v.wrapMethod("getItemModel",function(g,b){var _=g.parentModel,S=_.getGraph().getEdgeByIndex(b),T=S.node1.getLayout();if(T){var w=T.depth,A=_.levelModels[w];A&&(g.parentModel=A)}return g})}},t.prototype.setNodePosition=function(r,a){var o=this.option.data||this.option.nodes,u=o[r];u.localX=a[0],u.localY=a[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(r,a,o){function u(g){return isNaN(g)||g==null}if(o==="edge"){var s=this.getDataParams(r,o),c=s.data,l=s.value,d=c.source+" -- "+c.target;return createTooltipMarkup("nameValue",{name:d,value:l,noValue:u(l)})}else{var f=this.getGraph().getNodeByIndex(r),h=f.getLayout().value,v=this.getDataParams(r,o).data.name;return createTooltipMarkup("nameValue",{name:v!=null?v+"":null,value:h,noValue:u(h)})}},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(r,a){var o=n.prototype.getDataParams.call(this,r,a);if(o.value==null&&a==="node"){var u=this.getGraph().getNodeByIndex(r),s=u.getLayout().value;o.value=s}return o},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(SeriesModel);function sankeyLayout(n,t){n.eachSeriesByType("sankey",function(r){var a=r.get("nodeWidth"),o=r.get("nodeGap"),u=getViewRect$1(r,t);r.layoutInfo=u;var s=u.width,c=u.height,l=r.getGraph(),d=l.nodes,f=l.edges;computeNodeValues(d);var h=filter$1(d,function(_){return _.getLayout().value===0}),v=h.length!==0?0:r.get("layoutIterations"),g=r.get("orient"),b=r.get("nodeAlign");layoutSankey(d,f,a,o,s,c,v,g,b)})}function getViewRect$1(n,t){return getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function layoutSankey(n,t,r,a,o,u,s,c,l){computeNodeBreadths(n,t,r,o,u,c,l),computeNodeDepths(n,t,u,o,a,s,c),computeEdgeDepths(n,c)}function computeNodeValues(n){each$f(n,function(t){var r=sum(t.outEdges,getEdgeValue),a=sum(t.inEdges,getEdgeValue),o=t.getValue()||0,u=Math.max(r,a,o);t.setLayout({value:u},!0)})}function computeNodeBreadths(n,t,r,a,o,u,s){for(var c=[],l=[],d=[],f=[],h=0,v=0;v<t.length;v++)c[v]=1;for(var v=0;v<n.length;v++)l[v]=n[v].inEdges.length,l[v]===0&&d.push(n[v]);for(var g=-1;d.length;){for(var b=0;b<d.length;b++){var _=d[b],S=_.hostGraph.data.getRawDataItem(_.dataIndex),T=S.depth!=null&&S.depth>=0;T&&S.depth>g&&(g=S.depth),_.setLayout({depth:T?S.depth:h},!0),u==="vertical"?_.setLayout({dy:r},!0):_.setLayout({dx:r},!0);for(var w=0;w<_.outEdges.length;w++){var A=_.outEdges[w],R=t.indexOf(A);c[R]=0;var E=A.node2,I=n.indexOf(E);--l[I]===0&&f.indexOf(E)<0&&f.push(E)}}++h,d=f,f=[]}for(var v=0;v<c.length;v++)if(c[v]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var L=g>h-1?g:h-1;s&&s!=="left"&&adjustNodeWithNodeAlign(n,s,u,L);var F=u==="vertical"?(o-r)/L:(a-r)/L;scaleNodeBreadths(n,F,u)}function isNodeDepth(n){var t=n.hostGraph.data.getRawDataItem(n.dataIndex);return t.depth!=null&&t.depth>=0}function adjustNodeWithNodeAlign(n,t,r,a){if(t==="right"){for(var o=[],u=n,s=0;u.length;){for(var c=0;c<u.length;c++){var l=u[c];l.setLayout({skNodeHeight:s},!0);for(var d=0;d<l.inEdges.length;d++){var f=l.inEdges[d];o.indexOf(f.node1)<0&&o.push(f.node1)}}u=o,o=[],++s}each$f(n,function(h){isNodeDepth(h)||h.setLayout({depth:Math.max(0,a-h.getLayout().skNodeHeight)},!0)})}else t==="justify"&&moveSinksRight(n,a)}function moveSinksRight(n,t){each$f(n,function(r){!isNodeDepth(r)&&!r.outEdges.length&&r.setLayout({depth:t},!0)})}function scaleNodeBreadths(n,t,r){each$f(n,function(a){var o=a.getLayout().depth*t;r==="vertical"?a.setLayout({y:o},!0):a.setLayout({x:o},!0)})}function computeNodeDepths(n,t,r,a,o,u,s){var c=prepareNodesByBreadth(n,s);initializeNodeDepth(c,t,r,a,o,s),resolveCollisions(c,o,r,a,s);for(var l=1;u>0;u--)l*=.99,relaxRightToLeft(c,l,s),resolveCollisions(c,o,r,a,s),relaxLeftToRight(c,l,s),resolveCollisions(c,o,r,a,s)}function prepareNodesByBreadth(n,t){var r=[],a=t==="vertical"?"y":"x",o=groupData(n,function(u){return u.getLayout()[a]});return o.keys.sort(function(u,s){return u-s}),each$f(o.keys,function(u){r.push(o.buckets.get(u))}),r}function initializeNodeDepth(n,t,r,a,o,u){var s=1/0;each$f(n,function(c){var l=c.length,d=0;each$f(c,function(h){d+=h.getLayout().value});var f=u==="vertical"?(a-(l-1)*o)/d:(r-(l-1)*o)/d;f<s&&(s=f)}),each$f(n,function(c){each$f(c,function(l,d){var f=l.getLayout().value*s;u==="vertical"?(l.setLayout({x:d},!0),l.setLayout({dx:f},!0)):(l.setLayout({y:d},!0),l.setLayout({dy:f},!0))})}),each$f(t,function(c){var l=+c.getValue()*s;c.setLayout({dy:l},!0)})}function resolveCollisions(n,t,r,a,o){var u=o==="vertical"?"x":"y";each$f(n,function(s){s.sort(function(_,S){return _.getLayout()[u]-S.getLayout()[u]});for(var c,l,d,f=0,h=s.length,v=o==="vertical"?"dx":"dy",g=0;g<h;g++)l=s[g],d=f-l.getLayout()[u],d>0&&(c=l.getLayout()[u]+d,o==="vertical"?l.setLayout({x:c},!0):l.setLayout({y:c},!0)),f=l.getLayout()[u]+l.getLayout()[v]+t;var b=o==="vertical"?a:r;if(d=f-t-b,d>0){c=l.getLayout()[u]-d,o==="vertical"?l.setLayout({x:c},!0):l.setLayout({y:c},!0),f=c;for(var g=h-2;g>=0;--g)l=s[g],d=l.getLayout()[u]+l.getLayout()[v]+t-f,d>0&&(c=l.getLayout()[u]-d,o==="vertical"?l.setLayout({x:c},!0):l.setLayout({y:c},!0)),f=l.getLayout()[u]}})}function relaxRightToLeft(n,t,r){each$f(n.slice().reverse(),function(a){each$f(a,function(o){if(o.outEdges.length){var u=sum(o.outEdges,weightedTarget,r)/sum(o.outEdges,getEdgeValue);if(isNaN(u)){var s=o.outEdges.length;u=s?sum(o.outEdges,centerTarget,r)/s:0}if(r==="vertical"){var c=o.getLayout().x+(u-center(o,r))*t;o.setLayout({x:c},!0)}else{var l=o.getLayout().y+(u-center(o,r))*t;o.setLayout({y:l},!0)}}})})}function weightedTarget(n,t){return center(n.node2,t)*n.getValue()}function centerTarget(n,t){return center(n.node2,t)}function weightedSource(n,t){return center(n.node1,t)*n.getValue()}function centerSource(n,t){return center(n.node1,t)}function center(n,t){return t==="vertical"?n.getLayout().x+n.getLayout().dx/2:n.getLayout().y+n.getLayout().dy/2}function getEdgeValue(n){return n.getValue()}function sum(n,t,r){for(var a=0,o=n.length,u=-1;++u<o;){var s=+t(n[u],r);isNaN(s)||(a+=s)}return a}function relaxLeftToRight(n,t,r){each$f(n,function(a){each$f(a,function(o){if(o.inEdges.length){var u=sum(o.inEdges,weightedSource,r)/sum(o.inEdges,getEdgeValue);if(isNaN(u)){var s=o.inEdges.length;u=s?sum(o.inEdges,centerSource,r)/s:0}if(r==="vertical"){var c=o.getLayout().x+(u-center(o,r))*t;o.setLayout({x:c},!0)}else{var l=o.getLayout().y+(u-center(o,r))*t;o.setLayout({y:l},!0)}}})})}function computeEdgeDepths(n,t){var r=t==="vertical"?"x":"y";each$f(n,function(a){a.outEdges.sort(function(o,u){return o.node2.getLayout()[r]-u.node2.getLayout()[r]}),a.inEdges.sort(function(o,u){return o.node1.getLayout()[r]-u.node1.getLayout()[r]})}),each$f(n,function(a){var o=0,u=0;each$f(a.outEdges,function(s){s.setLayout({sy:o},!0),o+=s.getLayout().dy}),each$f(a.inEdges,function(s){s.setLayout({ty:u},!0),u+=s.getLayout().dy})})}function sankeyVisual(n){n.eachSeriesByType("sankey",function(t){var r=t.getGraph(),a=r.nodes,o=r.edges;if(a.length){var u=1/0,s=-1/0;each$f(a,function(c){var l=c.getLayout().value;l<u&&(u=l),l>s&&(s=l)}),each$f(a,function(c){var l=new VisualMapping({type:"color",mappingMethod:"linear",dataExtent:[u,s],visual:t.get("color")}),d=l.mapValueToVisual(c.getLayout().value),f=c.getModel().get(["itemStyle","color"]);f!=null?(c.setVisual("color",f),c.setVisual("style",{fill:f})):(c.setVisual("color",d),c.setVisual("style",{fill:d}))})}o.length&&each$f(o,function(c){var l=c.getModel().get("lineStyle");c.setVisual("style",l)})})}function install$A(n){n.registerChartView(SankeyView),n.registerSeriesModel(SankeySeriesModel),n.registerLayout(sankeyLayout),n.registerVisual(sankeyVisual),n.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"sankey",query:t},function(a){a.setNodePosition(t.dataIndex,[t.localX,t.localY])})})}var WhiskerBoxCommonMixin=function(){function n(){}return n.prototype._hasEncodeRule=function(t){var r=this.getEncode();return r&&r.get(t)!=null},n.prototype.getInitialData=function(t,r){var a,o=r.getComponent("xAxis",this.get("xAxisIndex")),u=r.getComponent("yAxis",this.get("yAxisIndex")),s=o.get("type"),c=u.get("type"),l;s==="category"?(t.layout="horizontal",a=o.getOrdinalMeta(),l=!this._hasEncodeRule("x")):c==="category"?(t.layout="vertical",a=u.getOrdinalMeta(),l=!this._hasEncodeRule("y")):t.layout=t.layout||"horizontal";var d=["x","y"],f=t.layout==="horizontal"?0:1,h=this._baseAxisDim=d[f],v=d[1-f],g=[o,u],b=g[f].get("type"),_=g[1-f].get("type"),S=t.data;if(S&&l){var T=[];each$f(S,function(R,E){var I;isArray$2(R)?(I=R.slice(),R.unshift(E)):isArray$2(R.value)?(I=extend$1({},R),I.value=I.value.slice(),R.value.unshift(E)):I=R,T.push(I)}),t.data=T}var w=this.defaultValueDimensions,A=[{name:h,type:getDimensionTypeByAxis(b),ordinalMeta:a,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:v,type:getDimensionTypeByAxis(_),dimsDef:w.slice()}];return createSeriesDataSimply(this,{coordDimensions:A,dimensionsCount:w.length+1,encodeDefaulter:curry$1(makeSeriesEncodeForAxisCoordSys,A,this)})},n.prototype.getBaseAxis=function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis},n}(),BoxplotSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],r.visualDrawType="stroke",r}return t.type="series.boxplot",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},t}(SeriesModel);mixin$1(BoxplotSeriesModel,WhiskerBoxCommonMixin,!0);var BoxplotView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=r.getData(),s=this.group,c=this._data;this._data||s.removeAll();var l=r.get("layout")==="horizontal"?1:0;u.diff(c).add(function(d){if(u.hasValue(d)){var f=u.getItemLayout(d),h=createNormalBox$1(f,u,d,l,!0);u.setItemGraphicEl(d,h),s.add(h)}}).update(function(d,f){var h=c.getItemGraphicEl(f);if(!u.hasValue(d)){s.remove(h);return}var v=u.getItemLayout(d);h?(saveOldStyle(h),updateNormalBoxData(v,h,u,d)):h=createNormalBox$1(v,u,d,l),s.add(h),u.setItemGraphicEl(d,h)}).remove(function(d){var f=c.getItemGraphicEl(d);f&&s.remove(f)}).execute(),this._data=u},t.prototype.remove=function(r){var a=this.group,o=this._data;this._data=null,o&&o.eachItemGraphicEl(function(u){u&&a.remove(u)})},t.type="boxplot",t}(ChartView),BoxPathShape=function(){function n(){}return n}(),BoxPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="boxplotBoxPath",a}return t.prototype.getDefaultShape=function(){return new BoxPathShape},t.prototype.buildPath=function(r,a){var o=a.points,u=0;for(r.moveTo(o[u][0],o[u][1]),u++;u<4;u++)r.lineTo(o[u][0],o[u][1]);for(r.closePath();u<o.length;u++)r.moveTo(o[u][0],o[u][1]),u++,r.lineTo(o[u][0],o[u][1])},t}(Path);function createNormalBox$1(n,t,r,a,o){var u=n.ends,s=new BoxPath({shape:{points:o?transInit$1(u,a,n):u}});return updateNormalBoxData(n,s,t,r,o),s}function updateNormalBoxData(n,t,r,a,o){var u=r.hostModel,s=graphic[o?"initProps":"updateProps"];s(t,{shape:{points:n.ends}},u,a),t.useStyle(r.getItemVisual(a,"style")),t.style.strokeNoScale=!0,t.z2=100;var c=r.getItemModel(a),l=c.getModel("emphasis");setStatesStylesFromModel(t,c),toggleHoverEmphasis(t,l.get("focus"),l.get("blurScope"),l.get("disabled"))}function transInit$1(n,t,r){return map$1(n,function(a){return a=a.slice(),a[t]=r.initBaseline,a})}var each$9=each$f;function boxplotLayout(n){var t=groupSeriesByAxis(n);each$9(t,function(r){var a=r.seriesModels;a.length&&(calculateBase(r),each$9(a,function(o,u){layoutSingleSeries(o,r.boxOffsetList[u],r.boxWidthList[u])}))})}function groupSeriesByAxis(n){var t=[],r=[];return n.eachSeriesByType("boxplot",function(a){var o=a.getBaseAxis(),u=indexOf(r,o);u<0&&(u=r.length,r[u]=o,t[u]={axis:o,seriesModels:[]}),t[u].seriesModels.push(a)}),t}function calculateBase(n){var t=n.axis,r=n.seriesModels,a=r.length,o=n.boxWidthList=[],u=n.boxOffsetList=[],s=[],c;if(t.type==="category")c=t.getBandWidth();else{var l=0;each$9(r,function(b){l=Math.max(l,b.getData().count())});var d=t.getExtent();c=Math.abs(d[1]-d[0])/l}each$9(r,function(b){var _=b.get("boxWidth");isArray$2(_)||(_=[_,_]),s.push([parsePercent(_[0],c)||0,parsePercent(_[1],c)||0])});var f=c*.8-2,h=f/a*.3,v=(f-h*(a-1))/a,g=v/2-f/2;each$9(r,function(b,_){u.push(g),g+=h+v,o.push(Math.min(Math.max(v,s[_][0]),s[_][1]))})}function layoutSingleSeries(n,t,r){var a=n.coordinateSystem,o=n.getData(),u=r/2,s=n.get("layout")==="horizontal"?0:1,c=1-s,l=["x","y"],d=o.mapDimension(l[s]),f=o.mapDimensionsAll(l[c]);if(d==null||f.length<5)return;for(var h=0;h<o.count();h++){var v=o.get(d,h),g=A(v,f[2],h),b=A(v,f[0],h),_=A(v,f[1],h),S=A(v,f[3],h),T=A(v,f[4],h),w=[];R(w,_,!1),R(w,S,!0),w.push(b,_,T,S),E(w,b),E(w,T),E(w,g),o.setItemLayout(h,{initBaseline:g[c],ends:w})}function A(I,L,F){var D=o.get(L,F),$=[];$[s]=I,$[c]=D;var O;return isNaN(I)||isNaN(D)?O=[NaN,NaN]:(O=a.dataToPoint($),O[s]+=t),O}function R(I,L,F){var D=L.slice(),$=L.slice();D[s]+=u,$[s]-=u,F?I.push(D,$):I.push($,D)}function E(I,L){var F=L.slice(),D=L.slice();F[s]-=u,D[s]+=u,I.push(F,D)}}function prepareBoxplotData(n,t){t=t||{};for(var r=[],a=[],o=t.boundIQR,u=o==="none"||o===0,s=0;s<n.length;s++){var c=asc$2(n[s].slice()),l=quantile(c,.25),d=quantile(c,.5),f=quantile(c,.75),h=c[0],v=c[c.length-1],g=(o??1.5)*(f-l),b=u?h:Math.max(h,l-g),_=u?v:Math.min(v,f+g),S=t.itemNameFormatter,T=isFunction$1(S)?S({value:s}):isString(S)?S.replace("{value}",s+""):s+"";r.push([T,b,l,d,f,_]);for(var w=0;w<c.length;w++){var A=c[w];if(A<b||A>_){var R=[T,A];a.push(R)}}}return{boxData:r,outliers:a}}var boxplotTransform={type:"echarts:boxplot",transform:function(t){var r=t.upstream;if(r.sourceFormat!==SOURCE_FORMAT_ARRAY_ROWS){var a="";throwError(a)}var o=prepareBoxplotData(r.getRawData(),t.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:o.boxData},{data:o.outliers}]}};function install$z(n){n.registerSeriesModel(BoxplotSeriesModel),n.registerChartView(BoxplotView),n.registerLayout(boxplotLayout),n.registerTransform(boxplotTransform)}var positiveBorderColorQuery=["itemStyle","borderColor"],negativeBorderColorQuery=["itemStyle","borderColor0"],dojiBorderColorQuery=["itemStyle","borderColorDoji"],positiveColorQuery=["itemStyle","color"],negativeColorQuery=["itemStyle","color0"];function getColor(n,t){return t.get(n>0?positiveColorQuery:negativeColorQuery)}function getBorderColor(n,t){return t.get(n===0?dojiBorderColorQuery:n>0?positiveBorderColorQuery:negativeBorderColorQuery)}var candlestickVisual={seriesType:"candlestick",plan:createRenderPlanner(),performRawSeries:!0,reset:function(n,t){if(!t.isSeriesFiltered(n)){var r=n.pipelineContext.large;return!r&&{progress:function(a,o){for(var u;(u=a.next())!=null;){var s=o.getItemModel(u),c=o.getItemLayout(u).sign,l=s.getItemStyle();l.fill=getColor(c,s),l.stroke=getBorderColor(c,s)||l.fill;var d=o.ensureUniqueItemVisual(u,"style");extend$1(d,l)}}}}}},SKIP_PROPS=["color","borderColor"],CandlestickView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(r),this._isLargeDraw?this._renderLarge(r):this._renderNormal(r)},t.prototype.incrementalPrepareRender=function(r,a,o){this._clear(),this._updateDrawMode(r)},t.prototype.incrementalRender=function(r,a,o,u){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(r,a):this._incrementalRenderNormal(r,a)},t.prototype.eachRendered=function(r){traverseElements(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var a=r.pipelineContext.large;(this._isLargeDraw==null||a!==this._isLargeDraw)&&(this._isLargeDraw=a,this._clear())},t.prototype._renderNormal=function(r){var a=r.getData(),o=this._data,u=this.group,s=a.getLayout("isSimpleBox"),c=r.get("clip",!0),l=r.coordinateSystem,d=l.getArea&&l.getArea();this._data||u.removeAll(),a.diff(o).add(function(f){if(a.hasValue(f)){var h=a.getItemLayout(f);if(c&&isNormalBoxClipped(d,h))return;var v=createNormalBox(h,f,!0);initProps(v,{shape:{points:h.ends}},r,f),setBoxCommon(v,a,f,s),u.add(v),a.setItemGraphicEl(f,v)}}).update(function(f,h){var v=o.getItemGraphicEl(h);if(!a.hasValue(f)){u.remove(v);return}var g=a.getItemLayout(f);if(c&&isNormalBoxClipped(d,g)){u.remove(v);return}v?(updateProps$1(v,{shape:{points:g.ends}},r,f),saveOldStyle(v)):v=createNormalBox(g),setBoxCommon(v,a,f,s),u.add(v),a.setItemGraphicEl(f,v)}).remove(function(f){var h=o.getItemGraphicEl(f);h&&u.remove(h)}).execute(),this._data=a},t.prototype._renderLarge=function(r){this._clear(),createLarge(r,this.group);var a=r.get("clip",!0)?createClipPath(r.coordinateSystem,!1,r):null;a?this.group.setClipPath(a):this.group.removeClipPath()},t.prototype._incrementalRenderNormal=function(r,a){for(var o=a.getData(),u=o.getLayout("isSimpleBox"),s;(s=r.next())!=null;){var c=o.getItemLayout(s),l=createNormalBox(c);setBoxCommon(l,o,s,u),l.incremental=!0,this.group.add(l),this._progressiveEls.push(l)}},t.prototype._incrementalRenderLarge=function(r,a){createLarge(a,this.group,this._progressiveEls,!0)},t.prototype.remove=function(r){this._clear()},t.prototype._clear=function(){this.group.removeAll(),this._data=null},t.type="candlestick",t}(ChartView),NormalBoxPathShape=function(){function n(){}return n}(),NormalBoxPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="normalCandlestickBox",a}return t.prototype.getDefaultShape=function(){return new NormalBoxPathShape},t.prototype.buildPath=function(r,a){var o=a.points;this.__simpleBox?(r.moveTo(o[4][0],o[4][1]),r.lineTo(o[6][0],o[6][1])):(r.moveTo(o[0][0],o[0][1]),r.lineTo(o[1][0],o[1][1]),r.lineTo(o[2][0],o[2][1]),r.lineTo(o[3][0],o[3][1]),r.closePath(),r.moveTo(o[4][0],o[4][1]),r.lineTo(o[5][0],o[5][1]),r.moveTo(o[6][0],o[6][1]),r.lineTo(o[7][0],o[7][1]))},t}(Path);function createNormalBox(n,t,r){var a=n.ends;return new NormalBoxPath({shape:{points:r?transInit(a,n):a},z2:100})}function isNormalBoxClipped(n,t){for(var r=!0,a=0;a<t.ends.length;a++)if(n.contain(t.ends[a][0],t.ends[a][1])){r=!1;break}return r}function setBoxCommon(n,t,r,a){var o=t.getItemModel(r);n.useStyle(t.getItemVisual(r,"style")),n.style.strokeNoScale=!0,n.__simpleBox=a,setStatesStylesFromModel(n,o);var u=t.getItemLayout(r).sign;each$f(n.states,function(c,l){var d=o.getModel(l),f=getColor(u,d),h=getBorderColor(u,d)||f,v=c.style||(c.style={});f&&(v.fill=f),h&&(v.stroke=h)});var s=o.getModel("emphasis");toggleHoverEmphasis(n,s.get("focus"),s.get("blurScope"),s.get("disabled"))}function transInit(n,t){return map$1(n,function(r){return r=r.slice(),r[1]=t.initBaseline,r})}var LargeBoxPathShape=function(){function n(){}return n}(),LargeBoxPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a.type="largeCandlestickBox",a}return t.prototype.getDefaultShape=function(){return new LargeBoxPathShape},t.prototype.buildPath=function(r,a){for(var o=a.points,u=0;u<o.length;)if(this.__sign===o[u++]){var s=o[u++];r.moveTo(s,o[u++]),r.lineTo(s,o[u++])}else u+=3},t}(Path);function createLarge(n,t,r,a){var o=n.getData(),u=o.getLayout("largePoints"),s=new LargeBoxPath({shape:{points:u},__sign:1,ignoreCoarsePointer:!0});t.add(s);var c=new LargeBoxPath({shape:{points:u},__sign:-1,ignoreCoarsePointer:!0});t.add(c);var l=new LargeBoxPath({shape:{points:u},__sign:0,ignoreCoarsePointer:!0});t.add(l),setLargeStyle(1,s,n),setLargeStyle(-1,c,n),setLargeStyle(0,l,n),a&&(s.incremental=!0,c.incremental=!0),r&&r.push(s,c)}function setLargeStyle(n,t,r,a){var o=getBorderColor(n,r)||getColor(n,r),u=r.getModel("itemStyle").getItemStyle(SKIP_PROPS);t.useStyle(u),t.style.fill=null,t.style.stroke=o}var CandlestickSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],r}return t.prototype.getShadowDim=function(){return"open"},t.prototype.brushSelector=function(r,a,o){var u=a.getItemLayout(r);return u&&o.rect(u.brushRect)},t.type="series.candlestick",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},t}(SeriesModel);mixin$1(CandlestickSeriesModel,WhiskerBoxCommonMixin,!0);function candlestickPreprocessor(n){!n||!isArray$2(n.series)||each$f(n.series,function(t){isObject$4(t)&&t.type==="k"&&(t.type="candlestick")})}var candlestickLayout={seriesType:"candlestick",plan:createRenderPlanner(),reset:function(n){var t=n.coordinateSystem,r=n.getData(),a=calculateCandleWidth(n,r),o=0,u=1,s=["x","y"],c=r.getDimensionIndex(r.mapDimension(s[o])),l=map$1(r.mapDimensionsAll(s[u]),r.getDimensionIndex,r),d=l[0],f=l[1],h=l[2],v=l[3];if(r.setLayout({candleWidth:a,isSimpleBox:a<=1.3}),c<0||l.length<4)return;return{progress:n.pipelineContext.large?b:g};function g(_,S){for(var T,w=S.getStore();(T=_.next())!=null;){var A=w.get(c,T),R=w.get(d,T),E=w.get(f,T),I=w.get(h,T),L=w.get(v,T),F=Math.min(R,E),D=Math.max(R,E),$=G(F,A),O=G(D,A),P=G(I,A),C=G(L,A),q=[];X(q,O,0),X(q,$,1),q.push(W(C),W(O),W(P),W($));var M=S.getItemModel(T),N=!!M.get(["itemStyle","borderColorDoji"]);S.setItemLayout(T,{sign:getSign(w,T,R,E,f,N),initBaseline:R>E?O[u]:$[u],ends:q,brushRect:Y(I,L,A)})}function G(te,ue){var fe=[];return fe[o]=ue,fe[u]=te,isNaN(ue)||isNaN(te)?[NaN,NaN]:t.dataToPoint(fe)}function X(te,ue,fe){var re=ue.slice(),ye=ue.slice();re[o]=subPixelOptimize(re[o]+a/2,1,!1),ye[o]=subPixelOptimize(ye[o]-a/2,1,!0),fe?te.push(re,ye):te.push(ye,re)}function Y(te,ue,fe){var re=G(te,fe),ye=G(ue,fe);return re[o]-=a/2,ye[o]-=a/2,{x:re[0],y:re[1],width:a,height:ye[1]-re[1]}}function W(te){return te[o]=subPixelOptimize(te[o],1),te}}function b(_,S){for(var T=createFloat32Array(_.count*4),w=0,A,R=[],E=[],I,L=S.getStore(),F=!!n.get(["itemStyle","borderColorDoji"]);(I=_.next())!=null;){var D=L.get(c,I),$=L.get(d,I),O=L.get(f,I),P=L.get(h,I),C=L.get(v,I);if(isNaN(D)||isNaN(P)||isNaN(C)){T[w++]=NaN,w+=3;continue}T[w++]=getSign(L,I,$,O,f,F),R[o]=D,R[u]=P,A=t.dataToPoint(R,null,E),T[w++]=A?A[0]:NaN,T[w++]=A?A[1]:NaN,R[u]=C,A=t.dataToPoint(R,null,E),T[w++]=A?A[1]:NaN}S.setLayout("largePoints",T)}}};function getSign(n,t,r,a,o,u){var s;return r>a?s=-1:r<a?s=1:s=u?0:t>0?n.get(o,t-1)<=a?1:-1:1,s}function calculateCandleWidth(n,t){var r=n.getBaseAxis(),a,o=r.type==="category"?r.getBandWidth():(a=r.getExtent(),Math.abs(a[1]-a[0])/t.count()),u=parsePercent(retrieve2(n.get("barMaxWidth"),o),o),s=parsePercent(retrieve2(n.get("barMinWidth"),1),o),c=n.get("barWidth");return c!=null?parsePercent(c,o):Math.max(Math.min(o/2,u),s)}function install$y(n){n.registerChartView(CandlestickView),n.registerSeriesModel(CandlestickSeriesModel),n.registerPreprocessor(candlestickPreprocessor),n.registerVisual(candlestickVisual),n.registerLayout(candlestickLayout)}function updateRipplePath(n,t){var r=t.rippleEffectColor||t.color;n.eachChild(function(a){a.attr({z:t.z,zlevel:t.zlevel,style:{stroke:t.brushType==="stroke"?r:null,fill:t.brushType==="fill"?r:null}})})}var EffectSymbol=function(n){__extends(t,n);function t(r,a){var o=n.call(this)||this,u=new Symbol$2(r,a),s=new Group$3;return o.add(u),o.add(s),o.updateData(r,a),o}return t.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},t.prototype.startEffectAnimation=function(r){for(var a=r.symbolType,o=r.color,u=r.rippleNumber,s=this.childAt(1),c=0;c<u;c++){var l=createSymbol$1(a,-1,-1,2,2,o);l.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var d=-c/u*r.period+r.effectOffset;l.animate("",!0).when(r.period,{scaleX:r.rippleScale/2,scaleY:r.rippleScale/2}).delay(d).start(),l.animateStyle(!0).when(r.period,{opacity:0}).delay(d).start(),s.add(l)}updateRipplePath(s,r)},t.prototype.updateEffectAnimation=function(r){for(var a=this._effectCfg,o=this.childAt(1),u=["symbolType","period","rippleScale","rippleNumber"],s=0;s<u.length;s++){var c=u[s];if(a[c]!==r[c]){this.stopEffectAnimation(),this.startEffectAnimation(r);return}}updateRipplePath(o,r)},t.prototype.highlight=function(){enterEmphasis(this)},t.prototype.downplay=function(){leaveEmphasis(this)},t.prototype.getSymbolType=function(){var r=this.childAt(0);return r&&r.getSymbolType()},t.prototype.updateData=function(r,a){var o=this,u=r.hostModel;this.childAt(0).updateData(r,a);var s=this.childAt(1),c=r.getItemModel(a),l=r.getItemVisual(a,"symbol"),d=normalizeSymbolSize(r.getItemVisual(a,"symbolSize")),f=r.getItemVisual(a,"style"),h=f&&f.fill,v=c.getModel("emphasis");s.setScale(d),s.traverse(function(S){S.setStyle("fill",h)});var g=normalizeSymbolOffset(r.getItemVisual(a,"symbolOffset"),d);g&&(s.x=g[0],s.y=g[1]);var b=r.getItemVisual(a,"symbolRotate");s.rotation=(b||0)*Math.PI/180||0;var _={};_.showEffectOn=u.get("showEffectOn"),_.rippleScale=c.get(["rippleEffect","scale"]),_.brushType=c.get(["rippleEffect","brushType"]),_.period=c.get(["rippleEffect","period"])*1e3,_.effectOffset=a/r.count(),_.z=u.getShallow("z")||0,_.zlevel=u.getShallow("zlevel")||0,_.symbolType=l,_.color=h,_.rippleEffectColor=c.get(["rippleEffect","color"]),_.rippleNumber=c.get(["rippleEffect","number"]),_.showEffectOn==="render"?(this._effectCfg?this.updateEffectAnimation(_):this.startEffectAnimation(_),this._effectCfg=_):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(S){S==="emphasis"?_.showEffectOn!=="render"&&o.startEffectAnimation(_):S==="normal"&&_.showEffectOn!=="render"&&o.stopEffectAnimation()}),this._effectCfg=_,toggleHoverEmphasis(this,v.get("focus"),v.get("blurScope"),v.get("disabled"))},t.prototype.fadeOut=function(r){r&&r()},t}(Group$3),EffectScatterView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this._symbolDraw=new SymbolDraw(EffectSymbol)},t.prototype.render=function(r,a,o){var u=r.getData(),s=this._symbolDraw;s.updateData(u,{clipShape:this._getClipShape(r)}),this.group.add(s.group)},t.prototype._getClipShape=function(r){var a=r.coordinateSystem,o=a&&a.getArea&&a.getArea();return r.get("clip",!0)?o:null},t.prototype.updateTransform=function(r,a,o){var u=r.getData();this.group.dirty();var s=pointsLayout("").reset(r,a,o);s.progress&&s.progress({start:0,end:u.count(),count:u.count()},u),this._symbolDraw.updateLayout()},t.prototype._updateGroupTransform=function(r){var a=r.coordinateSystem;a&&a.getRoamTransform&&(this.group.transform=clone$3(a.getRoamTransform()),this.group.decomposeTransform())},t.prototype.remove=function(r,a){this._symbolDraw&&this._symbolDraw.remove(!0)},t.type="effectScatter",t}(ChartView),EffectScatterSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r,a){return createSeriesData(null,this,{useEncodeDefaulter:!0})},t.prototype.brushSelector=function(r,a,o){return o.point(a.getItemLayout(r))},t.type="series.effectScatter",t.dependencies=["grid","polar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},t}(SeriesModel);function install$x(n){n.registerChartView(EffectScatterView),n.registerSeriesModel(EffectScatterSeriesModel),n.registerLayout(pointsLayout("effectScatter"))}var EffectLine=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this)||this;return u.add(u.createLine(r,a,o)),u._updateEffectSymbol(r,a),u}return t.prototype.createLine=function(r,a,o){return new Line(r,a,o)},t.prototype._updateEffectSymbol=function(r,a){var o=r.getItemModel(a),u=o.getModel("effect"),s=u.get("symbolSize"),c=u.get("symbol");isArray$2(s)||(s=[s,s]);var l=r.getItemVisual(a,"style"),d=u.get("color")||l&&l.stroke,f=this.childAt(1);this._symbolType!==c&&(this.remove(f),f=createSymbol$1(c,-.5,-.5,1,1,d),f.z2=100,f.culling=!0,this.add(f)),f&&(f.setStyle("shadowColor",d),f.setStyle(u.getItemStyle(["color"])),f.scaleX=s[0],f.scaleY=s[1],f.setColor(d),this._symbolType=c,this._symbolScale=s,this._updateEffectAnimation(r,u,a))},t.prototype._updateEffectAnimation=function(r,a,o){var u=this.childAt(1);if(u){var s=r.getItemLayout(o),c=a.get("period")*1e3,l=a.get("loop"),d=a.get("roundTrip"),f=a.get("constantSpeed"),h=retrieve(a.get("delay"),function(g){return g/r.count()*c/3});if(u.ignore=!0,this._updateAnimationPoints(u,s),f>0&&(c=this._getLineLength(u)/f*1e3),c!==this._period||l!==this._loop||d!==this._roundTrip){u.stopAnimation();var v=void 0;isFunction$1(h)?v=h(o):v=h,u.__t>0&&(v=-c*u.__t),this._animateSymbol(u,c,v,l,d)}this._period=c,this._loop=l,this._roundTrip=d}},t.prototype._animateSymbol=function(r,a,o,u,s){if(a>0){r.__t=0;var c=this,l=r.animate("",u).when(s?a*2:a,{__t:s?2:1}).delay(o).during(function(){c._updateSymbolPosition(r)});u||l.done(function(){c.remove(r)}),l.start()}},t.prototype._getLineLength=function(r){return dist$7(r.__p1,r.__cp1)+dist$7(r.__cp1,r.__p2)},t.prototype._updateAnimationPoints=function(r,a){r.__p1=a[0],r.__p2=a[1],r.__cp1=a[2]||[(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]},t.prototype.updateData=function(r,a,o){this.childAt(0).updateData(r,a,o),this._updateEffectSymbol(r,a)},t.prototype._updateSymbolPosition=function(r){var a=r.__p1,o=r.__p2,u=r.__cp1,s=r.__t<1?r.__t:2-r.__t,c=[r.x,r.y],l=c.slice(),d=quadraticAt$1,f=quadraticDerivativeAt;c[0]=d(a[0],u[0],o[0],s),c[1]=d(a[1],u[1],o[1],s);var h=r.__t<1?f(a[0],u[0],o[0],s):f(o[0],u[0],a[0],1-s),v=r.__t<1?f(a[1],u[1],o[1],s):f(o[1],u[1],a[1],1-s);r.rotation=-Math.atan2(v,h)-Math.PI/2,(this._symbolType==="line"||this._symbolType==="rect"||this._symbolType==="roundRect")&&(r.__lastT!==void 0&&r.__lastT<r.__t?(r.scaleY=dist$7(l,c)*1.05,s===1&&(c[0]=l[0]+(c[0]-l[0])/2,c[1]=l[1]+(c[1]-l[1])/2)):r.__lastT===1?r.scaleY=2*dist$7(a,c):r.scaleY=this._symbolScale[1]),r.__lastT=r.__t,r.ignore=!1,r.x=c[0],r.y=c[1]},t.prototype.updateLayout=function(r,a){this.childAt(0).updateLayout(r,a);var o=r.getItemModel(a).getModel("effect");this._updateEffectAnimation(r,o,a)},t}(Group$3),Polyline=function(n){__extends(t,n);function t(r,a,o){var u=n.call(this)||this;return u._createPolyline(r,a,o),u}return t.prototype._createPolyline=function(r,a,o){var u=r.getItemLayout(a),s=new Polyline$1({shape:{points:u}});this.add(s),this._updateCommonStl(r,a,o)},t.prototype.updateData=function(r,a,o){var u=r.hostModel,s=this.childAt(0),c={shape:{points:r.getItemLayout(a)}};updateProps$1(s,c,u,a),this._updateCommonStl(r,a,o)},t.prototype._updateCommonStl=function(r,a,o){var u=this.childAt(0),s=r.getItemModel(a),c=o&&o.emphasisLineStyle,l=o&&o.focus,d=o&&o.blurScope,f=o&&o.emphasisDisabled;if(!o||r.hasItemOption){var h=s.getModel("emphasis");c=h.getModel("lineStyle").getLineStyle(),f=h.get("disabled"),l=h.get("focus"),d=h.get("blurScope")}u.useStyle(r.getItemVisual(a,"style")),u.style.fill=null,u.style.strokeNoScale=!0;var v=u.ensureState("emphasis");v.style=c,toggleHoverEmphasis(this,l,d,f)},t.prototype.updateLayout=function(r,a){var o=this.childAt(0);o.setShape("points",r.getItemLayout(a))},t}(Group$3),EffectPolyline=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r._lastFrame=0,r._lastFramePercent=0,r}return t.prototype.createLine=function(r,a,o){return new Polyline(r,a,o)},t.prototype._updateAnimationPoints=function(r,a){this._points=a;for(var o=[0],u=0,s=1;s<a.length;s++){var c=a[s-1],l=a[s];u+=dist$7(c,l),o.push(u)}if(u===0){this._length=0;return}for(var s=0;s<o.length;s++)o[s]/=u;this._offsets=o,this._length=u},t.prototype._getLineLength=function(){return this._length},t.prototype._updateSymbolPosition=function(r){var a=r.__t<1?r.__t:2-r.__t,o=this._points,u=this._offsets,s=o.length;if(u){var c=this._lastFrame,l;if(a<this._lastFramePercent){var d=Math.min(c+1,s-1);for(l=d;l>=0&&!(u[l]<=a);l--);l=Math.min(l,s-2)}else{for(l=c;l<s&&!(u[l]>a);l++);l=Math.min(l-1,s-2)}var f=(a-u[l])/(u[l+1]-u[l]),h=o[l],v=o[l+1];r.x=h[0]*(1-f)+f*v[0],r.y=h[1]*(1-f)+f*v[1];var g=r.__t<1?v[0]-h[0]:h[0]-v[0],b=r.__t<1?v[1]-h[1]:h[1]-v[1];r.rotation=-Math.atan2(b,g)-Math.PI/2,this._lastFrame=l,this._lastFramePercent=a,r.ignore=!1}},t}(EffectLine),LargeLinesPathShape=function(){function n(){this.polyline=!1,this.curveness=0,this.segs=[]}return n}(),LargeLinesPath=function(n){__extends(t,n);function t(r){var a=n.call(this,r)||this;return a._off=0,a.hoverDataIdx=-1,a}return t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new LargeLinesPathShape},t.prototype.buildPath=function(r,a){var o=a.segs,u=a.curveness,s;if(a.polyline)for(s=this._off;s<o.length;){var c=o[s++];if(c>0){r.moveTo(o[s++],o[s++]);for(var l=1;l<c;l++)r.lineTo(o[s++],o[s++])}}else for(s=this._off;s<o.length;){var d=o[s++],f=o[s++],h=o[s++],v=o[s++];if(r.moveTo(d,f),u>0){var g=(d+h)/2-(f-v)*u,b=(f+v)/2-(h-d)*u;r.quadraticCurveTo(g,b,h,v)}else r.lineTo(h,v)}this.incremental&&(this._off=s,this.notClear=!0)},t.prototype.findDataIndex=function(r,a){var o=this.shape,u=o.segs,s=o.curveness,c=this.style.lineWidth;if(o.polyline)for(var l=0,d=0;d<u.length;){var f=u[d++];if(f>0)for(var h=u[d++],v=u[d++],g=1;g<f;g++){var b=u[d++],_=u[d++];if(containStroke$4(h,v,b,_,c,r,a))return l}l++}else for(var l=0,d=0;d<u.length;){var h=u[d++],v=u[d++],b=u[d++],_=u[d++];if(s>0){var S=(h+b)/2-(v-_)*s,T=(v+_)/2-(b-h)*s;if(containStroke$2(h,v,S,T,b,_,c,r,a))return l}else if(containStroke$4(h,v,b,_,c,r,a))return l;l++}return-1},t.prototype.contain=function(r,a){var o=this.transformCoordToLocal(r,a),u=this.getBoundingRect();if(r=o[0],a=o[1],u.contain(r,a)){var s=this.hoverDataIdx=this.findDataIndex(r,a);return s>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var a=this.shape,o=a.segs,u=1/0,s=1/0,c=-1/0,l=-1/0,d=0;d<o.length;){var f=o[d++],h=o[d++];u=Math.min(f,u),c=Math.max(f,c),s=Math.min(h,s),l=Math.max(h,l)}r=this._rect=new BoundingRect(u,s,c,l)}return r},t}(Path),LargeLineDraw=function(){function n(){this.group=new Group$3}return n.prototype.updateData=function(t){this._clear();var r=this._create();r.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(r,t)},n.prototype.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clear()},n.prototype.incrementalUpdate=function(t,r){var a=this._newAdded[0],o=r.getLayout("linesPoints"),u=a&&a.shape.segs;if(u&&u.length<2e4){var s=u.length,c=new Float32Array(s+o.length);c.set(u),c.set(o,s),a.setShape({segs:c})}else{this._newAdded=[];var l=this._create();l.incremental=!0,l.setShape({segs:o}),this._setCommon(l,r),l.__startIndex=t.start}},n.prototype.remove=function(){this._clear()},n.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},n.prototype._create=function(){var t=new LargeLinesPath({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(t),this.group.add(t),t},n.prototype._setCommon=function(t,r,a){var o=r.hostModel;t.setShape({polyline:o.get("polyline"),curveness:o.get(["lineStyle","curveness"])}),t.useStyle(o.getModel("lineStyle").getLineStyle()),t.style.strokeNoScale=!0;var u=r.getVisual("style");u&&u.stroke&&t.setStyle("stroke",u.stroke),t.setStyle("fill",null);var s=getECData(t);s.seriesIndex=o.seriesIndex,t.on("mousemove",function(c){s.dataIndex=null;var l=t.hoverDataIdx;l>0&&(s.dataIndex=l+t.__startIndex)})},n.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},n}(),linesLayout={seriesType:"lines",plan:createRenderPlanner(),reset:function(n){var t=n.coordinateSystem;if(t){var r=n.get("polyline"),a=n.pipelineContext.large;return{progress:function(o,u){var s=[];if(a){var c=void 0,l=o.end-o.start;if(r){for(var d=0,f=o.start;f<o.end;f++)d+=n.getLineCoordsCount(f);c=new Float32Array(l+d*2)}else c=new Float32Array(l*4);for(var h=0,v=[],f=o.start;f<o.end;f++){var g=n.getLineCoords(f,s);r&&(c[h++]=g);for(var b=0;b<g;b++)v=t.dataToPoint(s[b],!1,v),c[h++]=v[0],c[h++]=v[1]}u.setLayout("linesPoints",c)}else for(var f=o.start;f<o.end;f++){var _=u.getItemModel(f),g=n.getLineCoords(f,s),S=[];if(r)for(var T=0;T<g;T++)S.push(t.dataToPoint(s[T]));else{S[0]=t.dataToPoint(s[0]),S[1]=t.dataToPoint(s[1]);var w=_.get(["lineStyle","curveness"]);+w&&(S[2]=[(S[0][0]+S[1][0])/2-(S[0][1]-S[1][1])*w,(S[0][1]+S[1][1])/2-(S[1][0]-S[0][0])*w])}u.setItemLayout(f,S)}}}}}},LinesView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=r.getData(),s=this._updateLineDraw(u,r),c=r.get("zlevel"),l=r.get(["effect","trailLength"]),d=o.getZr(),f=d.painter.getType()==="svg";f||d.painter.getLayer(c).clear(!0),this._lastZlevel!=null&&!f&&d.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(r)&&l>0&&(f||d.configLayer(c,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(l/10+.9,1),0)})),s.updateData(u);var h=r.get("clip",!0)&&createClipPath(r.coordinateSystem,!1,r);h?this.group.setClipPath(h):this.group.removeClipPath(),this._lastZlevel=c,this._finished=!0},t.prototype.incrementalPrepareRender=function(r,a,o){var u=r.getData(),s=this._updateLineDraw(u,r);s.incrementalPrepareUpdate(u),this._clearLayer(o),this._finished=!1},t.prototype.incrementalRender=function(r,a,o){this._lineDraw.incrementalUpdate(r,a.getData()),this._finished=r.end===a.getData().count()},t.prototype.eachRendered=function(r){this._lineDraw&&this._lineDraw.eachRendered(r)},t.prototype.updateTransform=function(r,a,o){var u=r.getData(),s=r.pipelineContext;if(!this._finished||s.large||s.progressiveRender)return{update:!0};var c=linesLayout.reset(r,a,o);c.progress&&c.progress({start:0,end:u.count(),count:u.count()},u),this._lineDraw.updateLayout(),this._clearLayer(o)},t.prototype._updateLineDraw=function(r,a){var o=this._lineDraw,u=this._showEffect(a),s=!!a.get("polyline"),c=a.pipelineContext,l=c.large;return(!o||u!==this._hasEffet||s!==this._isPolyline||l!==this._isLargeDraw)&&(o&&o.remove(),o=this._lineDraw=l?new LargeLineDraw:new LineDraw(s?u?EffectPolyline:Polyline:u?EffectLine:Line),this._hasEffet=u,this._isPolyline=s,this._isLargeDraw=l),this.group.add(o.group),o},t.prototype._showEffect=function(r){return!!r.get(["effect","show"])},t.prototype._clearLayer=function(r){var a=r.getZr(),o=a.painter.getType()==="svg";!o&&this._lastZlevel!=null&&a.painter.getLayer(this._lastZlevel).clear(!0)},t.prototype.remove=function(r,a){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(a)},t.prototype.dispose=function(r,a){this.remove(r,a)},t.type="lines",t}(ChartView),Uint32Arr=typeof Uint32Array>"u"?Array:Uint32Array,Float64Arr=typeof Float64Array>"u"?Array:Float64Array;function compatEc2(n){var t=n.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(n.data=map$1(t,function(r){var a=[r[0].coord,r[1].coord],o={coords:a};return r[0].name&&(o.fromName=r[0].name),r[1].name&&(o.toName=r[1].name),mergeAll([o,r[0],r[1]])}))}var LinesSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.init=function(r){r.data=r.data||[],compatEc2(r);var a=this._processFlatCoordsArray(r.data);this._flatCoords=a.flatCoords,this._flatCoordsOffset=a.flatCoordsOffset,a.flatCoords&&(r.data=new Float32Array(a.count)),n.prototype.init.apply(this,arguments)},t.prototype.mergeOption=function(r){if(compatEc2(r),r.data){var a=this._processFlatCoordsArray(r.data);this._flatCoords=a.flatCoords,this._flatCoordsOffset=a.flatCoordsOffset,a.flatCoords&&(r.data=new Float32Array(a.count))}n.prototype.mergeOption.apply(this,arguments)},t.prototype.appendData=function(r){var a=this._processFlatCoordsArray(r.data);a.flatCoords&&(this._flatCoords?(this._flatCoords=concatArray(this._flatCoords,a.flatCoords),this._flatCoordsOffset=concatArray(this._flatCoordsOffset,a.flatCoordsOffset)):(this._flatCoords=a.flatCoords,this._flatCoordsOffset=a.flatCoordsOffset),r.data=new Float32Array(a.count)),this.getRawData().appendData(r.data)},t.prototype._getCoordsFromItemModel=function(r){var a=this.getData().getItemModel(r),o=a.option instanceof Array?a.option:a.getShallow("coords");return o},t.prototype.getLineCoordsCount=function(r){return this._flatCoordsOffset?this._flatCoordsOffset[r*2+1]:this._getCoordsFromItemModel(r).length},t.prototype.getLineCoords=function(r,a){if(this._flatCoordsOffset){for(var o=this._flatCoordsOffset[r*2],u=this._flatCoordsOffset[r*2+1],s=0;s<u;s++)a[s]=a[s]||[],a[s][0]=this._flatCoords[o+s*2],a[s][1]=this._flatCoords[o+s*2+1];return u}else{for(var c=this._getCoordsFromItemModel(r),s=0;s<c.length;s++)a[s]=a[s]||[],a[s][0]=c[s][0],a[s][1]=c[s][1];return c.length}},t.prototype._processFlatCoordsArray=function(r){var a=0;if(this._flatCoords&&(a=this._flatCoords.length),isNumber(r[0])){for(var o=r.length,u=new Uint32Arr(o),s=new Float64Arr(o),c=0,l=0,d=0,f=0;f<o;){d++;var h=r[f++];u[l++]=c+a,u[l++]=h;for(var v=0;v<h;v++){var g=r[f++],b=r[f++];s[c++]=g,s[c++]=b}}return{flatCoordsOffset:new Uint32Array(u.buffer,0,l),flatCoords:s,count:d}}return{flatCoordsOffset:null,flatCoords:null,count:r.length}},t.prototype.getInitialData=function(r,a){var o=new SeriesData(["value"],this);return o.hasItemOption=!1,o.initData(r.data,[],function(u,s,c,l){if(u instanceof Array)return NaN;o.hasItemOption=!0;var d=u.value;if(d!=null)return d instanceof Array?d[l]:d}),o},t.prototype.formatTooltip=function(r,a,o){var u=this.getData(),s=u.getItemModel(r),c=s.get("name");if(c)return c;var l=s.get("fromName"),d=s.get("toName"),f=[];return l!=null&&f.push(l),d!=null&&f.push(d),createTooltipMarkup("nameValue",{name:f.join(" > ")})},t.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?1e4:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?2e4:this.get("progressiveThreshold"))},t.prototype.getZLevelKey=function(){var r=this.getModel("effect"),a=r.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:r.get("show")&&a>0?a+"":""},t.type="series.lines",t.dependencies=["grid","polar","geo","calendar"],t.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},t}(SeriesModel);function normalize$1(n){return n instanceof Array||(n=[n,n]),n}var linesVisual={seriesType:"lines",reset:function(n){var t=normalize$1(n.get("symbol")),r=normalize$1(n.get("symbolSize")),a=n.getData();a.setVisual("fromSymbol",t&&t[0]),a.setVisual("toSymbol",t&&t[1]),a.setVisual("fromSymbolSize",r&&r[0]),a.setVisual("toSymbolSize",r&&r[1]);function o(u,s){var c=u.getItemModel(s),l=normalize$1(c.getShallow("symbol",!0)),d=normalize$1(c.getShallow("symbolSize",!0));l[0]&&u.setItemVisual(s,"fromSymbol",l[0]),l[1]&&u.setItemVisual(s,"toSymbol",l[1]),d[0]&&u.setItemVisual(s,"fromSymbolSize",d[0]),d[1]&&u.setItemVisual(s,"toSymbolSize",d[1])}return{dataEach:a.hasItemOption?o:null}}};function install$w(n){n.registerChartView(LinesView),n.registerSeriesModel(LinesSeriesModel),n.registerLayout(linesLayout),n.registerVisual(linesVisual)}var GRADIENT_LEVELS=256,HeatmapLayer=function(){function n(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var t=platformApi.createCanvas();this.canvas=t}return n.prototype.update=function(t,r,a,o,u,s){var c=this._getBrush(),l=this._getGradient(u,"inRange"),d=this._getGradient(u,"outOfRange"),f=this.pointSize+this.blurSize,h=this.canvas,v=h.getContext("2d"),g=t.length;h.width=r,h.height=a;for(var b=0;b<g;++b){var _=t[b],S=_[0],T=_[1],w=_[2],A=o(w);v.globalAlpha=A,v.drawImage(c,S-f,T-f)}if(!h.width||!h.height)return h;for(var R=v.getImageData(0,0,h.width,h.height),E=R.data,I=0,L=E.length,F=this.minOpacity,D=this.maxOpacity,$=D-F;I<L;){var A=E[I+3]/256,O=Math.floor(A*(GRADIENT_LEVELS-1))*4;if(A>0){var P=s(A)?l:d;A>0&&(A=A*$+F),E[I++]=P[O],E[I++]=P[O+1],E[I++]=P[O+2],E[I++]=P[O+3]*A*256}else I+=4}return v.putImageData(R,0,0),h},n.prototype._getBrush=function(){var t=this._brushCanvas||(this._brushCanvas=platformApi.createCanvas()),r=this.pointSize+this.blurSize,a=r*2;t.width=a,t.height=a;var o=t.getContext("2d");return o.clearRect(0,0,a,a),o.shadowOffsetX=a,o.shadowBlur=this.blurSize,o.shadowColor="#000",o.beginPath(),o.arc(-r,r,this.pointSize,0,Math.PI*2,!0),o.closePath(),o.fill(),t},n.prototype._getGradient=function(t,r){for(var a=this._gradientPixels,o=a[r]||(a[r]=new Uint8ClampedArray(256*4)),u=[0,0,0,0],s=0,c=0;c<256;c++)t[r](c/255,!0,u),o[s++]=u[0],o[s++]=u[1],o[s++]=u[2],o[s++]=u[3];return o},n}();function getIsInPiecewiseRange(n,t,r){var a=n[1]-n[0];t=map$1(t,function(s){return{interval:[(s.interval[0]-n[0])/a,(s.interval[1]-n[0])/a]}});var o=t.length,u=0;return function(s){var c;for(c=u;c<o;c++){var l=t[c].interval;if(l[0]<=s&&s<=l[1]){u=c;break}}if(c===o)for(c=u-1;c>=0;c--){var l=t[c].interval;if(l[0]<=s&&s<=l[1]){u=c;break}}return c>=0&&c<o&&r[c]}}function getIsInContinuousRange(n,t){var r=n[1]-n[0];return t=[(t[0]-n[0])/r,(t[1]-n[0])/r],function(a){return a>=t[0]&&a<=t[1]}}function isGeoCoordSys(n){var t=n.dimensions;return t[0]==="lng"&&t[1]==="lat"}var HeatmapView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u;a.eachComponent("visualMap",function(c){c.eachTargetSeries(function(l){l===r&&(u=c)})}),this._progressiveEls=null,this.group.removeAll();var s=r.coordinateSystem;s.type==="cartesian2d"||s.type==="calendar"?this._renderOnCartesianAndCalendar(r,o,0,r.getData().count()):isGeoCoordSys(s)&&this._renderOnGeo(s,r,u,o)},t.prototype.incrementalPrepareRender=function(r,a,o){this.group.removeAll()},t.prototype.incrementalRender=function(r,a,o,u){var s=a.coordinateSystem;s&&(isGeoCoordSys(s)?this.render(a,o,u):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(a,u,r.start,r.end,!0)))},t.prototype.eachRendered=function(r){traverseElements(this._progressiveEls||this.group,r)},t.prototype._renderOnCartesianAndCalendar=function(r,a,o,u,s){var c=r.coordinateSystem,l=isCoordinateSystemType(c,"cartesian2d"),d,f,h,v;if(l){var g=c.getAxis("x"),b=c.getAxis("y");d=g.getBandWidth()+.5,f=b.getBandWidth()+.5,h=g.scale.getExtent(),v=b.scale.getExtent()}for(var _=this.group,S=r.getData(),T=r.getModel(["emphasis","itemStyle"]).getItemStyle(),w=r.getModel(["blur","itemStyle"]).getItemStyle(),A=r.getModel(["select","itemStyle"]).getItemStyle(),R=r.get(["itemStyle","borderRadius"]),E=getLabelStatesModels(r),I=r.getModel("emphasis"),L=I.get("focus"),F=I.get("blurScope"),D=I.get("disabled"),$=l?[S.mapDimension("x"),S.mapDimension("y"),S.mapDimension("value")]:[S.mapDimension("time"),S.mapDimension("value")],O=o;O<u;O++){var P=void 0,C=S.getItemVisual(O,"style");if(l){var q=S.get($[0],O),M=S.get($[1],O);if(isNaN(S.get($[2],O))||isNaN(q)||isNaN(M)||q<h[0]||q>h[1]||M<v[0]||M>v[1])continue;var N=c.dataToPoint([q,M]);P=new Rect$2({shape:{x:N[0]-d/2,y:N[1]-f/2,width:d,height:f},style:C})}else{if(isNaN(S.get($[1],O)))continue;P=new Rect$2({z2:1,shape:c.dataToRect([S.get($[0],O)]).contentShape,style:C})}if(S.hasItemOption){var G=S.getItemModel(O),X=G.getModel("emphasis");T=X.getModel("itemStyle").getItemStyle(),w=G.getModel(["blur","itemStyle"]).getItemStyle(),A=G.getModel(["select","itemStyle"]).getItemStyle(),R=G.get(["itemStyle","borderRadius"]),L=X.get("focus"),F=X.get("blurScope"),D=X.get("disabled"),E=getLabelStatesModels(G)}P.shape.r=R;var Y=r.getRawValue(O),W="-";Y&&Y[2]!=null&&(W=Y[2]+""),setLabelStyle(P,E,{labelFetcher:r,labelDataIndex:O,defaultOpacity:C.opacity,defaultText:W}),P.ensureState("emphasis").style=T,P.ensureState("blur").style=w,P.ensureState("select").style=A,toggleHoverEmphasis(P,L,F,D),P.incremental=s,s&&(P.states.emphasis.hoverLayer=!0),_.add(P),S.setItemGraphicEl(O,P),this._progressiveEls&&this._progressiveEls.push(P)}},t.prototype._renderOnGeo=function(r,a,o,u){var s=o.targetVisuals.inRange,c=o.targetVisuals.outOfRange,l=a.getData(),d=this._hmLayer||this._hmLayer||new HeatmapLayer;d.blurSize=a.get("blurSize"),d.pointSize=a.get("pointSize"),d.minOpacity=a.get("minOpacity"),d.maxOpacity=a.get("maxOpacity");var f=r.getViewRect().clone(),h=r.getRoamTransform();f.applyTransform(h);var v=Math.max(f.x,0),g=Math.max(f.y,0),b=Math.min(f.width+f.x,u.getWidth()),_=Math.min(f.height+f.y,u.getHeight()),S=b-v,T=_-g,w=[l.mapDimension("lng"),l.mapDimension("lat"),l.mapDimension("value")],A=l.mapArray(w,function(L,F,D){var $=r.dataToPoint([L,F]);return $[0]-=v,$[1]-=g,$.push(D),$}),R=o.getExtent(),E=o.type==="visualMap.continuous"?getIsInContinuousRange(R,o.option.range):getIsInPiecewiseRange(R,o.getPieceList(),o.option.selected);d.update(A,S,T,s.color.getNormalizer(),{inRange:s.color.getColorMapper(),outOfRange:c.color.getColorMapper()},E);var I=new ZRImage({style:{width:S,height:T,x:v,y:g,image:d.canvas},silent:!0});this.group.add(I)},t.type="heatmap",t}(ChartView),HeatmapSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,a){return createSeriesData(null,this,{generateCoord:"value"})},t.prototype.preventIncremental=function(){var r=CoordinateSystemManager.get(this.get("coordinateSystem"));if(r&&r.dimensions)return r.dimensions[0]==="lng"&&r.dimensions[1]==="lat"},t.type="series.heatmap",t.dependencies=["grid","geo","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},t}(SeriesModel);function install$v(n){n.registerChartView(HeatmapView),n.registerSeriesModel(HeatmapSeriesModel)}var BAR_BORDER_WIDTH_QUERY=["itemStyle","borderWidth"],LAYOUT_ATTRS=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],pathForLineWidth=new Circle,PictorialBarView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=this.group,s=r.getData(),c=this._data,l=r.coordinateSystem,d=l.getBaseAxis(),f=d.isHorizontal(),h=l.master.getRect(),v={ecSize:{width:o.getWidth(),height:o.getHeight()},seriesModel:r,coordSys:l,coordSysExtent:[[h.x,h.x+h.width],[h.y,h.y+h.height]],isHorizontal:f,valueDim:LAYOUT_ATTRS[+f],categoryDim:LAYOUT_ATTRS[1-+f]};s.diff(c).add(function(b){if(s.hasValue(b)){var _=getItemModel(s,b),S=getSymbolMeta(s,b,_,v),T=createBar(s,v,S);s.setItemGraphicEl(b,T),u.add(T),updateCommon(T,v,S)}}).update(function(b,_){var S=c.getItemGraphicEl(_);if(!s.hasValue(b)){u.remove(S);return}var T=getItemModel(s,b),w=getSymbolMeta(s,b,T,v),A=getShapeStr(s,w);S&&A!==S.__pictorialShapeStr&&(u.remove(S),s.setItemGraphicEl(b,null),S=null),S?updateBar(S,v,w):S=createBar(s,v,w,!0),s.setItemGraphicEl(b,S),S.__pictorialSymbolMeta=w,u.add(S),updateCommon(S,v,w)}).remove(function(b){var _=c.getItemGraphicEl(b);_&&removeBar(c,b,_.__pictorialSymbolMeta.animationModel,_)}).execute();var g=r.get("clip",!0)?createClipPath(r.coordinateSystem,!1,r):null;return g?u.setClipPath(g):u.removeClipPath(),this._data=s,this.group},t.prototype.remove=function(r,a){var o=this.group,u=this._data;r.get("animation")?u&&u.eachItemGraphicEl(function(s){removeBar(u,getECData(s).dataIndex,r,s)}):o.removeAll()},t.type="pictorialBar",t}(ChartView);function getSymbolMeta(n,t,r,a){var o=n.getItemLayout(t),u=r.get("symbolRepeat"),s=r.get("symbolClip"),c=r.get("symbolPosition")||"start",l=r.get("symbolRotate"),d=(l||0)*Math.PI/180||0,f=r.get("symbolPatternSize")||2,h=r.isAnimationEnabled(),v={dataIndex:t,layout:o,itemModel:r,symbolType:n.getItemVisual(t,"symbol")||"circle",style:n.getItemVisual(t,"style"),symbolClip:s,symbolRepeat:u,symbolRepeatDirection:r.get("symbolRepeatDirection"),symbolPatternSize:f,rotation:d,animationModel:h?r:null,hoverScale:h&&r.get(["emphasis","scale"]),z2:r.getShallow("z",!0)||0};prepareBarLength(r,u,o,a,v),prepareSymbolSize(n,t,o,u,s,v.boundingLength,v.pxSign,f,a,v),prepareLineWidth(r,v.symbolScale,d,a,v);var g=v.symbolSize,b=normalizeSymbolOffset(r.get("symbolOffset"),g);return prepareLayoutInfo(r,g,o,u,s,b,c,v.valueLineWidth,v.boundingLength,v.repeatCutLength,a,v),v}function prepareBarLength(n,t,r,a,o){var u=a.valueDim,s=n.get("symbolBoundingData"),c=a.coordSys.getOtherAxis(a.coordSys.getBaseAxis()),l=c.toGlobalCoord(c.dataToCoord(0)),d=1-+(r[u.wh]<=0),f;if(isArray$2(s)){var h=[convertToCoordOnAxis(c,s[0])-l,convertToCoordOnAxis(c,s[1])-l];h[1]<h[0]&&h.reverse(),f=h[d]}else s!=null?f=convertToCoordOnAxis(c,s)-l:t?f=a.coordSysExtent[u.index][d]-l:f=r[u.wh];o.boundingLength=f,t&&(o.repeatCutLength=r[u.wh]);var v=u.xy==="x",g=c.inverse;o.pxSign=v&&!g||!v&&g?f>=0?1:-1:f>0?1:-1}function convertToCoordOnAxis(n,t){return n.toGlobalCoord(n.dataToCoord(n.scale.parse(t)))}function prepareSymbolSize(n,t,r,a,o,u,s,c,l,d){var f=l.valueDim,h=l.categoryDim,v=Math.abs(r[h.wh]),g=n.getItemVisual(t,"symbolSize"),b;isArray$2(g)?b=g.slice():g==null?b=["100%","100%"]:b=[g,g],b[h.index]=parsePercent(b[h.index],v),b[f.index]=parsePercent(b[f.index],a?v:Math.abs(u)),d.symbolSize=b;var _=d.symbolScale=[b[0]/c,b[1]/c];_[f.index]*=(l.isHorizontal?-1:1)*s}function prepareLineWidth(n,t,r,a,o){var u=n.get(BAR_BORDER_WIDTH_QUERY)||0;u&&(pathForLineWidth.attr({scaleX:t[0],scaleY:t[1],rotation:r}),pathForLineWidth.updateTransform(),u/=pathForLineWidth.getLineScale(),u*=t[a.valueDim.index]),o.valueLineWidth=u||0}function prepareLayoutInfo(n,t,r,a,o,u,s,c,l,d,f,h){var v=f.categoryDim,g=f.valueDim,b=h.pxSign,_=Math.max(t[g.index]+c,0),S=_;if(a){var T=Math.abs(l),w=retrieve(n.get("symbolMargin"),"15%")+"",A=!1;w.lastIndexOf("!")===w.length-1&&(A=!0,w=w.slice(0,w.length-1));var R=parsePercent(w,t[g.index]),E=Math.max(_+R*2,0),I=A?0:R*2,L=isNumeric(a),F=L?a:toIntTimes((T+I)/E),D=T-F*_;R=D/2/(A?F:Math.max(F-1,1)),E=_+R*2,I=A?0:R*2,!L&&a!=="fixed"&&(F=d?toIntTimes((Math.abs(d)+I)/E):0),S=F*E-I,h.repeatTimes=F,h.symbolMargin=R}var $=b*(S/2),O=h.pathPosition=[];O[v.index]=r[v.wh]/2,O[g.index]=s==="start"?$:s==="end"?l-$:l/2,u&&(O[0]+=u[0],O[1]+=u[1]);var P=h.bundlePosition=[];P[v.index]=r[v.xy],P[g.index]=r[g.xy];var C=h.barRectShape=extend$1({},r);C[g.wh]=b*Math.max(Math.abs(r[g.wh]),Math.abs(O[g.index]+$)),C[v.wh]=r[v.wh];var q=h.clipShape={};q[v.xy]=-r[v.xy],q[v.wh]=f.ecSize[v.wh],q[g.xy]=0,q[g.wh]=r[g.wh]}function createPath$1(n){var t=n.symbolPatternSize,r=createSymbol$1(n.symbolType,-t/2,-t/2,t,t);return r.attr({culling:!0}),r.type!=="image"&&r.setStyle({strokeNoScale:!0}),r}function createOrUpdateRepeatSymbols(n,t,r,a){var o=n.__pictorialBundle,u=r.symbolSize,s=r.valueLineWidth,c=r.pathPosition,l=t.valueDim,d=r.repeatTimes||0,f=0,h=u[t.valueDim.index]+s+r.symbolMargin*2;for(eachPath(n,function(_){_.__pictorialAnimationIndex=f,_.__pictorialRepeatTimes=d,f<d?updateAttr(_,null,b(f),r,a):updateAttr(_,null,{scaleX:0,scaleY:0},r,a,function(){o.remove(_)}),f++});f<d;f++){var v=createPath$1(r);v.__pictorialAnimationIndex=f,v.__pictorialRepeatTimes=d,o.add(v);var g=b(f);updateAttr(v,{x:g.x,y:g.y,scaleX:0,scaleY:0},{scaleX:g.scaleX,scaleY:g.scaleY,rotation:g.rotation},r,a)}function b(_){var S=c.slice(),T=r.pxSign,w=_;return(r.symbolRepeatDirection==="start"?T>0:T<0)&&(w=d-1-_),S[l.index]=h*(w-d/2+.5)+c[l.index],{x:S[0],y:S[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation}}}function createOrUpdateSingleSymbol(n,t,r,a){var o=n.__pictorialBundle,u=n.__pictorialMainPath;u?updateAttr(u,null,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation},r,a):(u=n.__pictorialMainPath=createPath$1(r),o.add(u),updateAttr(u,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:0,scaleY:0,rotation:r.rotation},{scaleX:r.symbolScale[0],scaleY:r.symbolScale[1]},r,a))}function createOrUpdateBarRect(n,t,r){var a=extend$1({},t.barRectShape),o=n.__pictorialBarRect;o?updateAttr(o,null,{shape:a},t,r):(o=n.__pictorialBarRect=new Rect$2({z2:2,shape:a,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),o.disableMorphing=!0,n.add(o))}function createOrUpdateClip(n,t,r,a){if(r.symbolClip){var o=n.__pictorialClipPath,u=extend$1({},r.clipShape),s=t.valueDim,c=r.animationModel,l=r.dataIndex;if(o)updateProps$1(o,{shape:u},c,l);else{u[s.wh]=0,o=new Rect$2({shape:u}),n.__pictorialBundle.setClipPath(o),n.__pictorialClipPath=o;var d={};d[s.wh]=r.clipShape[s.wh],graphic[a?"updateProps":"initProps"](o,{shape:d},c,l)}}}function getItemModel(n,t){var r=n.getItemModel(t);return r.getAnimationDelayParams=getAnimationDelayParams,r.isAnimationEnabled=isAnimationEnabled,r}function getAnimationDelayParams(n){return{index:n.__pictorialAnimationIndex,count:n.__pictorialRepeatTimes}}function isAnimationEnabled(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function createBar(n,t,r,a){var o=new Group$3,u=new Group$3;return o.add(u),o.__pictorialBundle=u,u.x=r.bundlePosition[0],u.y=r.bundlePosition[1],r.symbolRepeat?createOrUpdateRepeatSymbols(o,t,r):createOrUpdateSingleSymbol(o,t,r),createOrUpdateBarRect(o,r,a),createOrUpdateClip(o,t,r,a),o.__pictorialShapeStr=getShapeStr(n,r),o.__pictorialSymbolMeta=r,o}function updateBar(n,t,r){var a=r.animationModel,o=r.dataIndex,u=n.__pictorialBundle;updateProps$1(u,{x:r.bundlePosition[0],y:r.bundlePosition[1]},a,o),r.symbolRepeat?createOrUpdateRepeatSymbols(n,t,r,!0):createOrUpdateSingleSymbol(n,t,r,!0),createOrUpdateBarRect(n,r,!0),createOrUpdateClip(n,t,r,!0)}function removeBar(n,t,r,a){var o=a.__pictorialBarRect;o&&o.removeTextContent();var u=[];eachPath(a,function(s){u.push(s)}),a.__pictorialMainPath&&u.push(a.__pictorialMainPath),a.__pictorialClipPath&&(r=null),each$f(u,function(s){removeElement(s,{scaleX:0,scaleY:0},r,t,function(){a.parent&&a.parent.remove(a)})}),n.setItemGraphicEl(t,null)}function getShapeStr(n,t){return[n.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function eachPath(n,t,r){each$f(n.__pictorialBundle.children(),function(a){a!==n.__pictorialBarRect&&t.call(r,a)})}function updateAttr(n,t,r,a,o,u){t&&n.attr(t),a.symbolClip&&!o?r&&n.attr(r):r&&graphic[o?"updateProps":"initProps"](n,r,a.animationModel,a.dataIndex,u)}function updateCommon(n,t,r){var a=r.dataIndex,o=r.itemModel,u=o.getModel("emphasis"),s=u.getModel("itemStyle").getItemStyle(),c=o.getModel(["blur","itemStyle"]).getItemStyle(),l=o.getModel(["select","itemStyle"]).getItemStyle(),d=o.getShallow("cursor"),f=u.get("focus"),h=u.get("blurScope"),v=u.get("scale");eachPath(n,function(_){if(_ instanceof ZRImage){var S=_.style;_.useStyle(extend$1({image:S.image,x:S.x,y:S.y,width:S.width,height:S.height},r.style))}else _.useStyle(r.style);var T=_.ensureState("emphasis");T.style=s,v&&(T.scaleX=_.scaleX*1.1,T.scaleY=_.scaleY*1.1),_.ensureState("blur").style=c,_.ensureState("select").style=l,d&&(_.cursor=d),_.z2=r.z2});var g=t.valueDim.posDesc[+(r.boundingLength>0)],b=n.__pictorialBarRect;b.ignoreClip=!0,setLabelStyle(b,getLabelStatesModels(o),{labelFetcher:t.seriesModel,labelDataIndex:a,defaultText:getDefaultLabel(t.seriesModel.getData(),a),inheritColor:r.style.fill,defaultOpacity:r.style.opacity,defaultOutsidePosition:g}),toggleHoverEmphasis(n,f,h,u.get("disabled"))}function toIntTimes(n){var t=Math.round(n);return Math.abs(n-t)<1e-4?t:Math.ceil(n)}var PictorialBarSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r.defaultSymbol="roundRect",r}return t.prototype.getInitialData=function(r){return r.stack=null,n.prototype.getInitialData.apply(this,arguments)},t.type="series.pictorialBar",t.dependencies=["grid"],t.defaultOption=inheritDefaultOption(BaseBarSeriesModel.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),t}(BaseBarSeriesModel);function install$u(n){n.registerChartView(PictorialBarView),n.registerSeriesModel(PictorialBarSeriesModel),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,curry$1(layout$5,"pictorialBar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,createProgressiveLayout("pictorialBar"))}var ThemeRiverView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._layers=[],r}return t.prototype.render=function(r,a,o){var u=r.getData(),s=this,c=this.group,l=r.getLayerSeries(),d=u.getLayout("layoutInfo"),f=d.rect,h=d.boundaryGap;c.x=0,c.y=f.y+h[0];function v(S){return S.name}var g=new DataDiffer(this._layersSeries||[],l,v,v),b=[];g.add(bind$1(_,this,"add")).update(bind$1(_,this,"update")).remove(bind$1(_,this,"remove")).execute();function _(S,T,w){var A=s._layers;if(S==="remove"){c.remove(A[T]);return}for(var R=[],E=[],I,L=l[T].indices,F=0;F<L.length;F++){var D=u.getItemLayout(L[F]),$=D.x,O=D.y0,P=D.y;R.push($,O),E.push($,O+P),I=u.getItemVisual(L[F],"style")}var C,q=u.getItemLayout(L[0]),M=r.getModel("label"),N=M.get("margin"),G=r.getModel("emphasis");if(S==="add"){var X=b[T]=new Group$3;C=new ECPolygon({shape:{points:R,stackedOnPoints:E,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),X.add(C),c.add(X),r.isAnimationEnabled()&&C.setClipPath(createGridClipShape(C.getBoundingRect(),r,function(){C.removeClipPath()}))}else{var X=A[w];C=X.childAt(0),c.add(X),b[T]=X,updateProps$1(C,{shape:{points:R,stackedOnPoints:E}},r),saveOldStyle(C)}setLabelStyle(C,getLabelStatesModels(r),{labelDataIndex:L[F-1],defaultText:u.getName(L[F-1]),inheritColor:I.fill},{normal:{verticalAlign:"middle"}}),C.setTextConfig({position:null,local:!0});var Y=C.getTextContent();Y&&(Y.x=q.x-N,Y.y=q.y0+q.y/2),C.useStyle(I),u.setItemGraphicEl(T,C),setStatesStylesFromModel(C,r),toggleHoverEmphasis(C,G.get("focus"),G.get("blurScope"),G.get("disabled"))}this._layersSeries=l,this._layers=b},t.type="themeRiver",t}(ChartView);function createGridClipShape(n,t,r){var a=new Rect$2({shape:{x:n.x-10,y:n.y-10,width:0,height:n.height+20}});return initProps(a,{shape:{x:n.x-50,width:n.width+100,height:n.height+20}},t,r),a}var DATA_NAME_INDEX=2,ThemeRiverSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new LegendVisualProvider(bind$1(this.getData,this),bind$1(this.getRawData,this))},t.prototype.fixData=function(r){var a=r.length,o={},u=groupData(r,function(v){return o.hasOwnProperty(v[0]+"")||(o[v[0]+""]=-1),v[2]}),s=[];u.buckets.each(function(v,g){s.push({name:g,dataList:v})});for(var c=s.length,l=0;l<c;++l){for(var d=s[l].name,f=0;f<s[l].dataList.length;++f){var h=s[l].dataList[f][0]+"";o[h]=l}for(var h in o)o.hasOwnProperty(h)&&o[h]!==l&&(o[h]=l,r[a]=[h,0,d],a++)}return r},t.prototype.getInitialData=function(r,a){for(var o=this.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0],u=o.get("type"),s=filter$1(r.data,function(b){return b[2]!==void 0}),c=this.fixData(s||[]),l=[],d=this.nameMap=createHashMap(),f=0,h=0;h<c.length;++h)l.push(c[h][DATA_NAME_INDEX]),d.get(c[h][DATA_NAME_INDEX])||(d.set(c[h][DATA_NAME_INDEX],f),f++);var v=prepareSeriesDataSchema(c,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:getDimensionTypeByAxis(u)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,g=new SeriesData(v,this);return g.initData(c),g},t.prototype.getLayerSeries=function(){for(var r=this.getData(),a=r.count(),o=[],u=0;u<a;++u)o[u]=u;var s=r.mapDimension("single"),c=groupData(o,function(d){return r.get("name",d)}),l=[];return c.buckets.each(function(d,f){d.sort(function(h,v){return r.get(s,h)-r.get(s,v)}),l.push({name:f,indices:d})}),l},t.prototype.getAxisTooltipData=function(r,a,o){isArray$2(r)||(r=r?[r]:[]);for(var u=this.getData(),s=this.getLayerSeries(),c=[],l=s.length,d,f=0;f<l;++f){for(var h=Number.MAX_VALUE,v=-1,g=s[f].indices.length,b=0;b<g;++b){var _=u.get(r[0],s[f].indices[b]),S=Math.abs(_-a);S<=h&&(d=_,h=S,v=s[f].indices[b])}c.push(v)}return{dataIndices:c,nestestValue:d}},t.prototype.formatTooltip=function(r,a,o){var u=this.getData(),s=u.getName(r),c=u.get(u.mapDimension("value"),r);return createTooltipMarkup("nameValue",{name:s,value:c})},t.type="series.themeRiver",t.dependencies=["singleAxis"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},t}(SeriesModel);function themeRiverLayout(n,t){n.eachSeriesByType("themeRiver",function(r){var a=r.getData(),o=r.coordinateSystem,u={},s=o.getRect();u.rect=s;var c=r.get("boundaryGap"),l=o.getAxis();if(u.boundaryGap=c,l.orient==="horizontal"){c[0]=parsePercent(c[0],s.height),c[1]=parsePercent(c[1],s.height);var d=s.height-c[0]-c[1];doThemeRiverLayout(a,r,d)}else{c[0]=parsePercent(c[0],s.width),c[1]=parsePercent(c[1],s.width);var f=s.width-c[0]-c[1];doThemeRiverLayout(a,r,f)}a.setLayout("layoutInfo",u)})}function doThemeRiverLayout(n,t,r){if(n.count())for(var a=t.coordinateSystem,o=t.getLayerSeries(),u=n.mapDimension("single"),s=n.mapDimension("value"),c=map$1(o,function(S){return map$1(S.indices,function(T){var w=a.dataToPoint(n.get(u,T));return w[1]=n.get(s,T),w})}),l=computeBaseline(c),d=l.y0,f=r/l.max,h=o.length,v=o[0].indices.length,g,b=0;b<v;++b){g=d[b]*f,n.setItemLayout(o[0].indices[b],{layerIndex:0,x:c[0][b][0],y0:g,y:c[0][b][1]*f});for(var _=1;_<h;++_)g+=c[_-1][b][1]*f,n.setItemLayout(o[_].indices[b],{layerIndex:_,x:c[_][b][0],y0:g,y:c[_][b][1]*f})}}function computeBaseline(n){for(var t=n.length,r=n[0].length,a=[],o=[],u=0,s=0;s<r;++s){for(var c=0,l=0;l<t;++l)c+=n[l][s][1];c>u&&(u=c),a.push(c)}for(var d=0;d<r;++d)o[d]=(u-a[d])/2;u=0;for(var f=0;f<r;++f){var h=a[f]+o[f];h>u&&(u=h)}return{y0:o,max:u}}function install$t(n){n.registerChartView(ThemeRiverView),n.registerSeriesModel(ThemeRiverSeriesModel),n.registerLayout(themeRiverLayout),n.registerProcessor(dataFilter$1("themeRiver"))}var DEFAULT_SECTOR_Z=2,DEFAULT_TEXT_Z=4,SunburstPiece=function(n){__extends(t,n);function t(r,a,o,u){var s=n.call(this)||this;s.z2=DEFAULT_SECTOR_Z,s.textConfig={inside:!0},getECData(s).seriesIndex=a.seriesIndex;var c=new ZRText({z2:DEFAULT_TEXT_Z,silent:r.getModel().get(["label","silent"])});return s.setTextContent(c),s.updateData(!0,r,a,o,u),s}return t.prototype.updateData=function(r,a,o,u,s){this.node=a,a.piece=this,o=o||this._seriesModel,u=u||this._ecModel;var c=this;getECData(c).dataIndex=a.dataIndex;var l=a.getModel(),d=l.getModel("emphasis"),f=a.getLayout(),h=extend$1({},f);h.label=null;var v=a.getVisual("style");v.lineJoin="bevel";var g=a.getVisual("decal");g&&(v.decal=createOrUpdatePatternFromDecal(g,s));var b=getSectorCornerRadius(l.getModel("itemStyle"),h,!0);extend$1(h,b),each$f(SPECIAL_STATES,function(w){var A=c.ensureState(w),R=l.getModel([w,"itemStyle"]);A.style=R.getItemStyle();var E=getSectorCornerRadius(R,h);E&&(A.shape=E)}),r?(c.setShape(h),c.shape.r=f.r0,initProps(c,{shape:{r:f.r}},o,a.dataIndex)):(updateProps$1(c,{shape:h},o),saveOldStyle(c)),c.useStyle(v),this._updateLabel(o);var _=l.getShallow("cursor");_&&c.attr("cursor",_),this._seriesModel=o||this._seriesModel,this._ecModel=u||this._ecModel;var S=d.get("focus"),T=S==="relative"?concatArray(a.getAncestorsIndices(),a.getDescendantIndices()):S==="ancestor"?a.getAncestorsIndices():S==="descendant"?a.getDescendantIndices():S;toggleHoverEmphasis(this,T,d.get("blurScope"),d.get("disabled"))},t.prototype._updateLabel=function(r){var a=this,o=this.node.getModel(),u=o.getModel("label"),s=this.node.getLayout(),c=s.endAngle-s.startAngle,l=(s.startAngle+s.endAngle)/2,d=Math.cos(l),f=Math.sin(l),h=this,v=h.getTextContent(),g=this.node.dataIndex,b=u.get("minAngle")/180*Math.PI,_=u.get("show")&&!(b!=null&&Math.abs(c)<b);v.ignore=!_,each$f(DISPLAY_STATES,function(T){var w=T==="normal"?o.getModel("label"):o.getModel([T,"label"]),A=T==="normal",R=A?v:v.ensureState(T),E=r.getFormattedLabel(g,T);A&&(E=E||a.node.name),R.style=createTextStyle(w,{},null,T!=="normal",!0),E&&(R.style.text=E);var I=w.get("show");I!=null&&!A&&(R.ignore=!I);var L=S(w,"position"),F=A?h:h.states[T],D=F.style.fill;F.textConfig={outsideFill:w.get("color")==="inherit"?D:null,inside:L!=="outside"};var $,O=S(w,"distance")||0,P=S(w,"align"),C=S(w,"rotate"),q=Math.PI*.5,M=Math.PI*1.5,N=normalizeRadian(C==="tangential"?Math.PI/2-l:l),G=N>q&&!isRadianAroundZero(N-q)&&N<M;L==="outside"?($=s.r+O,P=G?"right":"left"):!P||P==="center"?(c===2*Math.PI&&s.r0===0?$=0:$=(s.r+s.r0)/2,P="center"):P==="left"?($=s.r0+O,P=G?"right":"left"):P==="right"&&($=s.r-O,P=G?"left":"right"),R.style.align=P,R.style.verticalAlign=S(w,"verticalAlign")||"middle",R.x=$*d+s.cx,R.y=$*f+s.cy;var X=0;C==="radial"?X=normalizeRadian(-l)+(G?Math.PI:0):C==="tangential"?X=normalizeRadian(Math.PI/2-l)+(G?Math.PI:0):isNumber(C)&&(X=C*Math.PI/180),R.rotation=normalizeRadian(X)});function S(T,w){var A=T.get(w);return A??u.get(w)}v.dirtyStyle()},t}(Sector),ROOT_TO_NODE_ACTION="sunburstRootToNode",HIGHLIGHT_ACTION="sunburstHighlight",UNHIGHLIGHT_ACTION="sunburstUnhighlight";function installSunburstAction(n){n.registerAction({type:ROOT_TO_NODE_ACTION,update:"updateView"},function(t,r){r.eachComponent({mainType:"series",subType:"sunburst",query:t},a);function a(o,u){var s=retrieveTargetInfo(t,[ROOT_TO_NODE_ACTION],o);if(s){var c=o.getViewRoot();c&&(t.direction=aboveViewRoot(c,s.node)?"rollUp":"drillDown"),o.resetViewRoot(s.node)}}}),n.registerAction({type:HIGHLIGHT_ACTION,update:"none"},function(t,r,a){t=extend$1({},t),r.eachComponent({mainType:"series",subType:"sunburst",query:t},o);function o(u){var s=retrieveTargetInfo(t,[HIGHLIGHT_ACTION],u);s&&(t.dataIndex=s.node.dataIndex)}a.dispatchAction(extend$1(t,{type:"highlight"}))}),n.registerAction({type:UNHIGHLIGHT_ACTION,update:"updateView"},function(t,r,a){t=extend$1({},t),a.dispatchAction(extend$1(t,{type:"downplay"}))})}var SunburstView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o,u){var s=this;this.seriesModel=r,this.api=o,this.ecModel=a;var c=r.getData(),l=c.tree.root,d=r.getViewRoot(),f=this.group,h=r.get("renderLabelForZeroData"),v=[];d.eachNode(function(w){v.push(w)});var g=this._oldChildren||[];b(v,g),T(l,d),this._initEvents(),this._oldChildren=v;function b(w,A){if(w.length===0&&A.length===0)return;new DataDiffer(A,w,R,R).add(E).update(E).remove(curry$1(E,null)).execute();function R(I){return I.getId()}function E(I,L){var F=I==null?null:w[I],D=L==null?null:A[L];_(F,D)}}function _(w,A){if(!h&&w&&!w.getValue()&&(w=null),w!==l&&A!==l){if(A&&A.piece)w?(A.piece.updateData(!1,w,r,a,o),c.setItemGraphicEl(w.dataIndex,A.piece)):S(A);else if(w){var R=new SunburstPiece(w,r,a,o);f.add(R),c.setItemGraphicEl(w.dataIndex,R)}}}function S(w){w&&w.piece&&(f.remove(w.piece),w.piece=null)}function T(w,A){A.depth>0?(s.virtualPiece?s.virtualPiece.updateData(!1,w,r,a,o):(s.virtualPiece=new SunburstPiece(w,r,a,o),f.add(s.virtualPiece)),A.piece.off("click"),s.virtualPiece.on("click",function(R){s._rootToNode(A.parentNode)})):s.virtualPiece&&(f.remove(s.virtualPiece),s.virtualPiece=null)}},t.prototype._initEvents=function(){var r=this;this.group.off("click"),this.group.on("click",function(a){var o=!1,u=r.seriesModel.getViewRoot();u.eachNode(function(s){if(!o&&s.piece&&s.piece===a.target){var c=s.getModel().get("nodeClick");if(c==="rootToNode")r._rootToNode(s);else if(c==="link"){var l=s.getModel(),d=l.get("link");if(d){var f=l.get("target",!0)||"_blank";windowOpen(d,f)}}o=!0}})})},t.prototype._rootToNode=function(r){r!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:ROOT_TO_NODE_ACTION,from:this.uid,seriesId:this.seriesModel.id,targetNode:r})},t.prototype.containPoint=function(r,a){var o=a.getData(),u=o.getItemLayout(0);if(u){var s=r[0]-u.cx,c=r[1]-u.cy,l=Math.sqrt(s*s+c*c);return l<=u.r&&l>=u.r0}},t.type="sunburst",t}(ChartView),SunburstSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r,a){var o={name:r.name,children:r.data};completeTreeValue(o);var u=this._levelModels=map$1(r.levels||[],function(l){return new Model(l,this,a)},this),s=Tree.createTree(o,this,c);function c(l){l.wrapMethod("getItemModel",function(d,f){var h=s.getNodeByDataIndex(f),v=u[h.depth];return v&&(d.parentModel=v),d})}return s.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(r){var a=n.prototype.getDataParams.apply(this,arguments),o=this.getData().tree.getNodeByDataIndex(r);return a.treePathInfo=wrapTreePathInfo(o,this),a},t.prototype.getLevelModel=function(r){return this._levelModels&&this._levelModels[r.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var a=this.getRawData().tree.root;(!r||r!==a&&!a.contains(r))&&(this._viewRoot=a)},t.prototype.enableAriaDecal=function(){enableAriaDecalForTree(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}(SeriesModel);function completeTreeValue(n){var t=0;each$f(n.children,function(a){completeTreeValue(a);var o=a.value;isArray$2(o)&&(o=o[0]),t+=o});var r=n.value;isArray$2(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),isArray$2(n.value)?n.value[0]=r:n.value=r}var RADIAN=Math.PI/180;function sunburstLayout(n,t,r){t.eachSeriesByType(n,function(a){var o=a.get("center"),u=a.get("radius");isArray$2(u)||(u=[0,u]),isArray$2(o)||(o=[o,o]);var s=r.getWidth(),c=r.getHeight(),l=Math.min(s,c),d=parsePercent(o[0],s),f=parsePercent(o[1],c),h=parsePercent(u[0],l/2),v=parsePercent(u[1],l/2),g=-a.get("startAngle")*RADIAN,b=a.get("minAngle")*RADIAN,_=a.getData().tree.root,S=a.getViewRoot(),T=S.depth,w=a.get("sort");w!=null&&initChildren(S,w);var A=0;each$f(S.children,function(N){!isNaN(N.getValue())&&A++});var R=S.getValue(),E=Math.PI/(R||A)*2,I=S.depth>0,L=S.height-(I?-1:1),F=(v-h)/(L||1),D=a.get("clockwise"),$=a.get("stillShowZeroSum"),O=D?1:-1,P=function(N,G){if(N){var X=G;if(N!==_){var Y=N.getValue(),W=R===0&&$?E:Y*E;W<b&&(W=b),X=G+O*W;var te=N.depth-T-(I?-1:1),ue=h+F*te,fe=h+F*(te+1),re=a.getLevelModel(N);if(re){var ye=re.get("r0",!0),Te=re.get("r",!0),Re=re.get("radius",!0);Re!=null&&(ye=Re[0],Te=Re[1]),ye!=null&&(ue=parsePercent(ye,l/2)),Te!=null&&(fe=parsePercent(Te,l/2))}N.setLayout({angle:W,startAngle:G,endAngle:X,clockwise:D,cx:d,cy:f,r0:ue,r:fe})}if(N.children&&N.children.length){var ve=0;each$f(N.children,function(ce){ve+=P(ce,G+ve)})}return X-G}};if(I){var C=h,q=h+F,M=Math.PI*2;_.setLayout({angle:M,startAngle:g,endAngle:g+M,clockwise:D,cx:d,cy:f,r0:C,r:q})}P(S,g)})}function initChildren(n,t){var r=n.children||[];n.children=sort(r,t),r.length&&each$f(n.children,function(a){initChildren(a,t)})}function sort(n,t){if(isFunction$1(t)){var r=map$1(n,function(o,u){var s=o.getValue();return{params:{depth:o.depth,height:o.height,dataIndex:o.dataIndex,getValue:function(){return s}},index:u}});return r.sort(function(o,u){return t(o.params,u.params)}),map$1(r,function(o){return n[o.index]})}else{var a=t==="asc";return n.sort(function(o,u){var s=(o.getValue()-u.getValue())*(a?1:-1);return s===0?(o.dataIndex-u.dataIndex)*(a?-1:1):s})}}function sunburstVisual(n){var t={};function r(a,o,u){for(var s=a;s&&s.depth>1;)s=s.parentNode;var c=o.getColorFromPalette(s.name||s.dataIndex+"",t);return a.depth>1&&isString(c)&&(c=lift(c,(a.depth-1)/(u-1)*.5)),c}n.eachSeriesByType("sunburst",function(a){var o=a.getData(),u=o.tree;u.eachNode(function(s){var c=s.getModel(),l=c.getModel("itemStyle").getItemStyle();l.fill||(l.fill=r(s,a,u.root.height));var d=o.ensureUniqueItemVisual(s.dataIndex,"style");extend$1(d,l)})})}function install$s(n){n.registerChartView(SunburstView),n.registerSeriesModel(SunburstSeriesModel),n.registerLayout(curry$1(sunburstLayout,"sunburst")),n.registerProcessor(curry$1(dataFilter$1,"sunburst")),n.registerVisual(sunburstVisual),installSunburstAction(n)}var STYLE_VISUAL_TYPE={color:"fill",borderColor:"stroke"},NON_STYLE_VISUAL_PROPS={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},customInnerStore=makeInner(),CustomSeriesModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},t.prototype.getInitialData=function(r,a){return createSeriesData(null,this)},t.prototype.getDataParams=function(r,a,o){var u=n.prototype.getDataParams.call(this,r,a);return o&&(u.info=customInnerStore(o).info),u},t.type="series.custom",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},t}(SeriesModel);function dataToCoordSize$3(n,t){return t=t||[0,0],map$1(["x","y"],function(r,a){var o=this.getAxis(r),u=t[a],s=n[a]/2;return o.type==="category"?o.getBandWidth():Math.abs(o.dataToCoord(u-s)-o.dataToCoord(u+s))},this)}function cartesianPrepareCustom(n){var t=n.master.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return n.dataToPoint(r)},size:bind$1(dataToCoordSize$3,n)}}}function dataToCoordSize$2(n,t){return t=t||[0,0],map$1([0,1],function(r){var a=t[r],o=n[r]/2,u=[],s=[];return u[r]=a-o,s[r]=a+o,u[1-r]=s[1-r]=t[1-r],Math.abs(this.dataToPoint(u)[r]-this.dataToPoint(s)[r])},this)}function geoPrepareCustom(n){var t=n.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:n.getZoom()},api:{coord:function(r){return n.dataToPoint(r)},size:bind$1(dataToCoordSize$2,n)}}}function dataToCoordSize$1(n,t){var r=this.getAxis(),a=t instanceof Array?t[0]:t,o=(n instanceof Array?n[0]:n)/2;return r.type==="category"?r.getBandWidth():Math.abs(r.dataToCoord(a-o)-r.dataToCoord(a+o))}function singlePrepareCustom(n){var t=n.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return n.dataToPoint(r)},size:bind$1(dataToCoordSize$1,n)}}}function dataToCoordSize(n,t){return t=t||[0,0],map$1(["Radius","Angle"],function(r,a){var o="get"+r+"Axis",u=this[o](),s=t[a],c=n[a]/2,l=u.type==="category"?u.getBandWidth():Math.abs(u.dataToCoord(s-c)-u.dataToCoord(s+c));return r==="Angle"&&(l=l*Math.PI/180),l},this)}function polarPrepareCustom(n){var t=n.getRadiusAxis(),r=n.getAngleAxis(),a=t.getExtent();return a[0]>a[1]&&a.reverse(),{coordSys:{type:"polar",cx:n.cx,cy:n.cy,r:a[1],r0:a[0]},api:{coord:function(o){var u=t.dataToRadius(o[0]),s=r.dataToAngle(o[1]),c=n.coordToPoint([u,s]);return c.push(u,s*Math.PI/180),c},size:bind$1(dataToCoordSize,n)}}}function calendarPrepareCustom(n){var t=n.getRect(),r=n.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:n.getCellWidth(),cellHeight:n.getCellHeight(),rangeInfo:{start:r.start,end:r.end,weeks:r.weeks,dayCount:r.allDay}},api:{coord:function(a,o){return n.dataToPoint(a,o)}}}}function isEC4CompatibleStyle(n,t,r,a){return n&&(n.legacy||n.legacy!==!1&&!r&&!a&&t!=="tspan"&&(t==="text"||hasOwn(n,"text")))}function convertFromEC4CompatibleStyle(n,t,r){var a=n,o,u,s;if(t==="text")s=a;else{s={},hasOwn(a,"text")&&(s.text=a.text),hasOwn(a,"rich")&&(s.rich=a.rich),hasOwn(a,"textFill")&&(s.fill=a.textFill),hasOwn(a,"textStroke")&&(s.stroke=a.textStroke),hasOwn(a,"fontFamily")&&(s.fontFamily=a.fontFamily),hasOwn(a,"fontSize")&&(s.fontSize=a.fontSize),hasOwn(a,"fontStyle")&&(s.fontStyle=a.fontStyle),hasOwn(a,"fontWeight")&&(s.fontWeight=a.fontWeight),u={type:"text",style:s,silent:!0},o={};var c=hasOwn(a,"textPosition");r?o.position=c?a.textPosition:"inside":c&&(o.position=a.textPosition),hasOwn(a,"textPosition")&&(o.position=a.textPosition),hasOwn(a,"textOffset")&&(o.offset=a.textOffset),hasOwn(a,"textRotation")&&(o.rotation=a.textRotation),hasOwn(a,"textDistance")&&(o.distance=a.textDistance)}return convertEC4CompatibleRichItem(s,n),each$f(s.rich,function(l){convertEC4CompatibleRichItem(l,l)}),{textConfig:o,textContent:u}}function convertEC4CompatibleRichItem(n,t){t&&(t.font=t.textFont||t.font,hasOwn(t,"textStrokeWidth")&&(n.lineWidth=t.textStrokeWidth),hasOwn(t,"textAlign")&&(n.align=t.textAlign),hasOwn(t,"textVerticalAlign")&&(n.verticalAlign=t.textVerticalAlign),hasOwn(t,"textLineHeight")&&(n.lineHeight=t.textLineHeight),hasOwn(t,"textWidth")&&(n.width=t.textWidth),hasOwn(t,"textHeight")&&(n.height=t.textHeight),hasOwn(t,"textBackgroundColor")&&(n.backgroundColor=t.textBackgroundColor),hasOwn(t,"textPadding")&&(n.padding=t.textPadding),hasOwn(t,"textBorderColor")&&(n.borderColor=t.textBorderColor),hasOwn(t,"textBorderWidth")&&(n.borderWidth=t.textBorderWidth),hasOwn(t,"textBorderRadius")&&(n.borderRadius=t.textBorderRadius),hasOwn(t,"textBoxShadowColor")&&(n.shadowColor=t.textBoxShadowColor),hasOwn(t,"textBoxShadowBlur")&&(n.shadowBlur=t.textBoxShadowBlur),hasOwn(t,"textBoxShadowOffsetX")&&(n.shadowOffsetX=t.textBoxShadowOffsetX),hasOwn(t,"textBoxShadowOffsetY")&&(n.shadowOffsetY=t.textBoxShadowOffsetY))}function convertToEC4StyleForCustomSerise(n,t,r){var a=n;a.textPosition=a.textPosition||r.position||"inside",r.offset!=null&&(a.textOffset=r.offset),r.rotation!=null&&(a.textRotation=r.rotation),r.distance!=null&&(a.textDistance=r.distance);var o=a.textPosition.indexOf("inside")>=0,u=n.fill||"#000";convertToEC4RichItem(a,t);var s=a.textFill==null;return o?s&&(a.textFill=r.insideFill||"#fff",!a.textStroke&&r.insideStroke&&(a.textStroke=r.insideStroke),!a.textStroke&&(a.textStroke=u),a.textStrokeWidth==null&&(a.textStrokeWidth=2)):(s&&(a.textFill=n.fill||r.outsideFill||"#000"),!a.textStroke&&r.outsideStroke&&(a.textStroke=r.outsideStroke)),a.text=t.text,a.rich=t.rich,each$f(t.rich,function(c){convertToEC4RichItem(c,c)}),a}function convertToEC4RichItem(n,t){t&&(hasOwn(t,"fill")&&(n.textFill=t.fill),hasOwn(t,"stroke")&&(n.textStroke=t.fill),hasOwn(t,"lineWidth")&&(n.textStrokeWidth=t.lineWidth),hasOwn(t,"font")&&(n.font=t.font),hasOwn(t,"fontStyle")&&(n.fontStyle=t.fontStyle),hasOwn(t,"fontWeight")&&(n.fontWeight=t.fontWeight),hasOwn(t,"fontSize")&&(n.fontSize=t.fontSize),hasOwn(t,"fontFamily")&&(n.fontFamily=t.fontFamily),hasOwn(t,"align")&&(n.textAlign=t.align),hasOwn(t,"verticalAlign")&&(n.textVerticalAlign=t.verticalAlign),hasOwn(t,"lineHeight")&&(n.textLineHeight=t.lineHeight),hasOwn(t,"width")&&(n.textWidth=t.width),hasOwn(t,"height")&&(n.textHeight=t.height),hasOwn(t,"backgroundColor")&&(n.textBackgroundColor=t.backgroundColor),hasOwn(t,"padding")&&(n.textPadding=t.padding),hasOwn(t,"borderColor")&&(n.textBorderColor=t.borderColor),hasOwn(t,"borderWidth")&&(n.textBorderWidth=t.borderWidth),hasOwn(t,"borderRadius")&&(n.textBorderRadius=t.borderRadius),hasOwn(t,"shadowColor")&&(n.textBoxShadowColor=t.shadowColor),hasOwn(t,"shadowBlur")&&(n.textBoxShadowBlur=t.shadowBlur),hasOwn(t,"shadowOffsetX")&&(n.textBoxShadowOffsetX=t.shadowOffsetX),hasOwn(t,"shadowOffsetY")&&(n.textBoxShadowOffsetY=t.shadowOffsetY),hasOwn(t,"textShadowColor")&&(n.textShadowColor=t.textShadowColor),hasOwn(t,"textShadowBlur")&&(n.textShadowBlur=t.textShadowBlur),hasOwn(t,"textShadowOffsetX")&&(n.textShadowOffsetX=t.textShadowOffsetX),hasOwn(t,"textShadowOffsetY")&&(n.textShadowOffsetY=t.textShadowOffsetY))}var LEGACY_TRANSFORM_PROPS_MAP={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},LEGACY_TRANSFORM_PROPS=keys(LEGACY_TRANSFORM_PROPS_MAP);reduce$1(TRANSFORMABLE_PROPS,function(n,t){return n[t]=1,n},{});TRANSFORMABLE_PROPS.join(", ");var ELEMENT_ANIMATABLE_PROPS=["","style","shape","extra"],transitionInnerStore=makeInner();function getElementAnimationConfig(n,t,r,a,o){var u=n+"Animation",s=getAnimationConfig(n,a,o)||{},c=transitionInnerStore(t).userDuring;return s.duration>0&&(s.during=c?bind$1(duringCall,{el:t,userDuring:c}):null,s.setToFinal=!0,s.scope=n),extend$1(s,r[u]),s}function applyUpdateTransition(n,t,r,a){a=a||{};var o=a.dataIndex,u=a.isInit,s=a.clearStyle,c=r.isAnimationEnabled(),l=transitionInnerStore(n),d=t.style;l.userDuring=t.during;var f={},h={};if(prepareTransformAllPropsFinal(n,t,h),prepareShapeOrExtraAllPropsFinal("shape",t,h),prepareShapeOrExtraAllPropsFinal("extra",t,h),!u&&c&&(prepareTransformTransitionFrom(n,t,f),prepareShapeOrExtraTransitionFrom("shape",n,t,f),prepareShapeOrExtraTransitionFrom("extra",n,t,f),prepareStyleTransitionFrom(n,t,d,f)),h.style=d,applyPropsDirectly(n,h,s),applyMiscProps(n,t),c)if(u){var v={};each$f(ELEMENT_ANIMATABLE_PROPS,function(b){var _=b?t[b]:t;_&&_.enterFrom&&(b&&(v[b]=v[b]||{}),extend$1(b?v[b]:v,_.enterFrom))});var g=getElementAnimationConfig("enter",n,t,r,o);g.duration>0&&n.animateFrom(v,g)}else applyPropsTransition(n,t,o||0,r,f);updateLeaveTo(n,t),d?n.dirty():n.markRedraw()}function updateLeaveTo(n,t){for(var r=transitionInnerStore(n).leaveToProps,a=0;a<ELEMENT_ANIMATABLE_PROPS.length;a++){var o=ELEMENT_ANIMATABLE_PROPS[a],u=o?t[o]:t;u&&u.leaveTo&&(r||(r=transitionInnerStore(n).leaveToProps={}),o&&(r[o]=r[o]||{}),extend$1(o?r[o]:r,u.leaveTo))}}function applyLeaveTransition(n,t,r,a){if(n){var o=n.parent,u=transitionInnerStore(n).leaveToProps;if(u){var s=getElementAnimationConfig("update",n,t,r,0);s.done=function(){o.remove(n)},n.animateTo(u,s)}else o.remove(n)}}function isTransitionAll(n){return n==="all"}function applyPropsDirectly(n,t,r){var a=t.style;if(!n.isGroup&&a){if(r){n.useStyle({});for(var o=n.animators,u=0;u<o.length;u++){var s=o[u];s.targetName==="style"&&s.changeTarget(n.style)}}n.setStyle(a)}t&&(t.style=null,t&&n.attr(t),t.style=a)}function applyPropsTransition(n,t,r,a,o){if(o){var u=getElementAnimationConfig("update",n,t,a,r);u.duration>0&&n.animateFrom(o,u)}}function applyMiscProps(n,t){hasOwn(t,"silent")&&(n.silent=t.silent),hasOwn(t,"ignore")&&(n.ignore=t.ignore),n instanceof Displayable&&hasOwn(t,"invisible")&&(n.invisible=t.invisible),n instanceof Path&&hasOwn(t,"autoBatch")&&(n.autoBatch=t.autoBatch)}var tmpDuringScope={},transitionDuringAPI={setTransform:function(n,t){return tmpDuringScope.el[n]=t,this},getTransform:function(n){return tmpDuringScope.el[n]},setShape:function(n,t){var r=tmpDuringScope.el,a=r.shape||(r.shape={});return a[n]=t,r.dirtyShape&&r.dirtyShape(),this},getShape:function(n){var t=tmpDuringScope.el.shape;if(t)return t[n]},setStyle:function(n,t){var r=tmpDuringScope.el,a=r.style;return a&&(a[n]=t,r.dirtyStyle&&r.dirtyStyle()),this},getStyle:function(n){var t=tmpDuringScope.el.style;if(t)return t[n]},setExtra:function(n,t){var r=tmpDuringScope.el.extra||(tmpDuringScope.el.extra={});return r[n]=t,this},getExtra:function(n){var t=tmpDuringScope.el.extra;if(t)return t[n]}};function duringCall(){var n=this,t=n.el;if(t){var r=transitionInnerStore(t).userDuring,a=n.userDuring;if(r!==a){n.el=n.userDuring=null;return}tmpDuringScope.el=t,a(transitionDuringAPI)}}function prepareShapeOrExtraTransitionFrom(n,t,r,a){var o=r[n];if(o){var u=t[n],s;if(u){var c=r.transition,l=o.transition;if(l)if(!s&&(s=a[n]={}),isTransitionAll(l))extend$1(s,u);else for(var d=normalizeToArray(l),f=0;f<d.length;f++){var h=d[f],v=u[h];s[h]=v}else if(isTransitionAll(c)||indexOf(c,n)>=0){!s&&(s=a[n]={});for(var g=keys(u),f=0;f<g.length;f++){var h=g[f],v=u[h];isNonStyleTransitionEnabled(o[h],v)&&(s[h]=v)}}}}}function prepareShapeOrExtraAllPropsFinal(n,t,r){var a=t[n];if(a)for(var o=r[n]={},u=keys(a),s=0;s<u.length;s++){var c=u[s];o[c]=cloneValue(a[c])}}function prepareTransformTransitionFrom(n,t,r){for(var a=t.transition,o=isTransitionAll(a)?TRANSFORMABLE_PROPS:normalizeToArray(a||[]),u=0;u<o.length;u++){var s=o[u];if(!(s==="style"||s==="shape"||s==="extra")){var c=n[s];r[s]=c}}}function prepareTransformAllPropsFinal(n,t,r){for(var a=0;a<LEGACY_TRANSFORM_PROPS.length;a++){var o=LEGACY_TRANSFORM_PROPS[a],u=LEGACY_TRANSFORM_PROPS_MAP[o],s=t[o];s&&(r[u[0]]=s[0],r[u[1]]=s[1])}for(var a=0;a<TRANSFORMABLE_PROPS.length;a++){var c=TRANSFORMABLE_PROPS[a];t[c]!=null&&(r[c]=t[c])}}function prepareStyleTransitionFrom(n,t,r,a){if(r){var o=n.style,u;if(o){var s=r.transition,c=t.transition;if(s&&!isTransitionAll(s)){var l=normalizeToArray(s);!u&&(u=a.style={});for(var d=0;d<l.length;d++){var f=l[d],h=o[f];u[f]=h}}else if(n.getAnimationStyleProps&&(isTransitionAll(c)||isTransitionAll(s)||indexOf(c,"style")>=0)){var v=n.getAnimationStyleProps(),g=v?v.style:null;if(g){!u&&(u=a.style={});for(var b=keys(r),d=0;d<b.length;d++){var f=b[d];if(g[f]){var h=o[f];u[f]=h}}}}}}}function isNonStyleTransitionEnabled(n,t){return isArrayLike$1(n)?n!==t:n!=null&&isFinite(n)}var getStateToRestore=makeInner(),KEYFRAME_EXCLUDE_KEYS=["percent","easing","shape","style","extra"];function stopPreviousKeyframeAnimationAndRestore(n){n.stopAnimation("keyframe"),n.attr(getStateToRestore(n))}function applyKeyframeAnimation(n,t,r){if(!(!r.isAnimationEnabled()||!t)){if(isArray$2(t)){each$f(t,function(c){applyKeyframeAnimation(n,c,r)});return}var a=t.keyframes,o=t.duration;if(r&&o==null){var u=getAnimationConfig("enter",r,0);o=u&&u.duration}if(!(!a||!o)){var s=getStateToRestore(n);each$f(ELEMENT_ANIMATABLE_PROPS,function(c){if(!(c&&!n[c])){var l;a.sort(function(d,f){return d.percent-f.percent}),each$f(a,function(d){var f=n.animators,h=c?d[c]:d;if(h){var v=keys(h);if(c||(v=filter$1(v,function(_){return indexOf(KEYFRAME_EXCLUDE_KEYS,_)<0})),!!v.length){l||(l=n.animate(c,t.loop,!0),l.scope="keyframe");for(var g=0;g<f.length;g++)f[g]!==l&&f[g].targetName===l.targetName&&f[g].stopTracks(v);c&&(s[c]=s[c]||{});var b=c?s[c]:s;each$f(v,function(_){b[_]=((c?n[c]:n)||{})[_]}),l.whenWithKeys(o*d.percent,h,v,d.easing)}}}),l&&l.delay(t.delay||0).duration(o).start(t.easing)}})}}}var EMPHASIS="emphasis",NORMAL="normal",BLUR="blur",SELECT="select",STATES=[NORMAL,EMPHASIS,BLUR,SELECT],PATH_ITEM_STYLE={normal:["itemStyle"],emphasis:[EMPHASIS,"itemStyle"],blur:[BLUR,"itemStyle"],select:[SELECT,"itemStyle"]},PATH_LABEL={normal:["label"],emphasis:[EMPHASIS,"label"],blur:[BLUR,"label"],select:[SELECT,"label"]},DEFAULT_TRANSITION=["x","y"],GROUP_DIFF_PREFIX="e\0\0",attachedTxInfoTmp={normal:{},emphasis:{},blur:{},select:{}},prepareCustoms={cartesian2d:cartesianPrepareCustom,geo:geoPrepareCustom,single:singlePrepareCustom,polar:polarPrepareCustom,calendar:calendarPrepareCustom};function isPath(n){return n instanceof Path}function isDisplayable(n){return n instanceof Displayable}function copyElement(n,t){t.copyTransform(n),isDisplayable(t)&&isDisplayable(n)&&(t.setStyle(n.style),t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel,t.invisible=n.invisible,t.ignore=n.ignore,isPath(t)&&isPath(n)&&t.setShape(n.shape))}var CustomChartView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o,u){this._progressiveEls=null;var s=this._data,c=r.getData(),l=this.group,d=makeRenderItem(r,c,a,o);s||l.removeAll(),c.diff(s).add(function(h){createOrUpdateItem(o,null,h,d(h,u),r,l,c)}).remove(function(h){var v=s.getItemGraphicEl(h);v&&applyLeaveTransition(v,customInnerStore(v).option,r)}).update(function(h,v){var g=s.getItemGraphicEl(v);createOrUpdateItem(o,g,h,d(h,u),r,l,c)}).execute();var f=r.get("clip",!0)?createClipPath(r.coordinateSystem,!1,r):null;f?l.setClipPath(f):l.removeClipPath(),this._data=c},t.prototype.incrementalPrepareRender=function(r,a,o){this.group.removeAll(),this._data=null},t.prototype.incrementalRender=function(r,a,o,u,s){var c=a.getData(),l=makeRenderItem(a,c,o,u),d=this._progressiveEls=[];function f(g){g.isGroup||(g.incremental=!0,g.ensureState("emphasis").hoverLayer=!0)}for(var h=r.start;h<r.end;h++){var v=createOrUpdateItem(null,null,h,l(h,s),a,this.group,c);v&&(v.traverse(f),d.push(v))}},t.prototype.eachRendered=function(r){traverseElements(this._progressiveEls||this.group,r)},t.prototype.filterForExposedEvent=function(r,a,o,u){var s=a.element;if(s==null||o.name===s)return!0;for(;(o=o.__hostTarget||o.parent)&&o!==this.group;)if(o.name===s)return!0;return!1},t.type="custom",t}(ChartView);function createEl$1(n){var t=n.type,r;if(t==="path"){var a=n.shape,o=a.width!=null&&a.height!=null?{x:a.x||0,y:a.y||0,width:a.width,height:a.height}:null,u=getPathData(a);r=makePath(u,null,o,a.layout||"center"),customInnerStore(r).customPathData=u}else if(t==="image")r=new ZRImage({}),customInnerStore(r).customImagePath=n.style.image;else if(t==="text")r=new ZRText({});else if(t==="group")r=new Group$3;else{if(t==="compoundPath")throw new Error('"compoundPath" is not supported yet.');var s=getShapeClass(t);if(!s){var c="";throwError(c)}r=new s}return customInnerStore(r).customGraphicType=t,r.name=n.name,r.z2EmphasisLift=1,r.z2SelectLift=1,r}function updateElNormal(n,t,r,a,o,u,s){stopPreviousKeyframeAnimationAndRestore(t);var c=o&&o.normal.cfg;c&&t.setTextConfig(c),a&&a.transition==null&&(a.transition=DEFAULT_TRANSITION);var l=a&&a.style;if(l){if(t.type==="text"){var d=l;hasOwn(d,"textFill")&&(d.fill=d.textFill),hasOwn(d,"textStroke")&&(d.stroke=d.textStroke)}var f=void 0,h=isPath(t)?l.decal:null;n&&h&&(h.dirty=!0,f=createOrUpdatePatternFromDecal(h,n)),l.__decalPattern=f}if(isDisplayable(t)&&l){var f=l.__decalPattern;f&&(l.decal=f)}applyUpdateTransition(t,a,u,{dataIndex:r,isInit:s,clearStyle:!0}),applyKeyframeAnimation(t,a.keyframeAnimation,u)}function updateElOnState(n,t,r,a,o){var u=t.isGroup?null:t,s=o&&o[n].cfg;if(u){var c=u.ensureState(n);if(a===!1){var l=u.getState(n);l&&(l.style=null)}else c.style=a||null;s&&(c.textConfig=s),setDefaultStateProxy(u)}}function updateZ(n,t,r){if(!n.isGroup){var a=n,o=r.currentZ,u=r.currentZLevel;a.z=o,a.zlevel=u;var s=t.z2;s!=null&&(a.z2=s||0);for(var c=0;c<STATES.length;c++)updateZForEachState(a,t,STATES[c])}}function updateZForEachState(n,t,r){var a=r===NORMAL,o=a?t:retrieveStateOption(t,r),u=o?o.z2:null,s;u!=null&&(s=a?n:n.ensureState(r),s.z2=u||0)}function makeRenderItem(n,t,r,a){var o=n.get("renderItem"),u=n.coordinateSystem,s={};u&&(s=u.prepareCustoms?u.prepareCustoms(u):prepareCustoms[u.type](u));for(var c=defaults$h({getWidth:a.getWidth,getHeight:a.getHeight,getZr:a.getZr,getDevicePixelRatio:a.getDevicePixelRatio,value:R,style:I,ordinalRawValue:E,styleEmphasis:L,visual:$,barLayout:O,currentSeriesIndices:P,font:C},s.api||{}),l={context:{},seriesId:n.id,seriesName:n.name,seriesIndex:n.seriesIndex,coordSys:s.coordSys,dataInsideLength:t.count(),encode:wrapEncodeDef(n.getData())},d,f,h={},v={},g={},b={},_=0;_<STATES.length;_++){var S=STATES[_];g[S]=n.getModel(PATH_ITEM_STYLE[S]),b[S]=n.getModel(PATH_LABEL[S])}function T(q){return q===d?f||(f=t.getItemModel(q)):t.getItemModel(q)}function w(q,M){return t.hasItemOption?q===d?h[M]||(h[M]=T(q).getModel(PATH_ITEM_STYLE[M])):T(q).getModel(PATH_ITEM_STYLE[M]):g[M]}function A(q,M){return t.hasItemOption?q===d?v[M]||(v[M]=T(q).getModel(PATH_LABEL[M])):T(q).getModel(PATH_LABEL[M]):b[M]}return function(q,M){return d=q,f=null,h={},v={},o&&o(defaults$h({dataIndexInside:q,dataIndex:t.getRawIndex(q),actionType:M?M.type:null},l),c)};function R(q,M){return M==null&&(M=d),t.getStore().get(t.getDimensionIndex(q||0),M)}function E(q,M){M==null&&(M=d),q=q||0;var N=t.getDimensionInfo(q);if(!N){var G=t.getDimensionIndex(q);return G>=0?t.getStore().get(G,M):void 0}var X=t.get(N.name,M),Y=N&&N.ordinalMeta;return Y?Y.categories[X]:X}function I(q,M){M==null&&(M=d);var N=t.getItemVisual(M,"style"),G=N&&N.fill,X=N&&N.opacity,Y=w(M,NORMAL).getItemStyle();G!=null&&(Y.fill=G),X!=null&&(Y.opacity=X);var W={inheritColor:isString(G)?G:"#000"},te=A(M,NORMAL),ue=createTextStyle(te,null,W,!1,!0);ue.text=te.getShallow("show")?retrieve2(n.getFormattedLabel(M,NORMAL),getDefaultLabel(t,M)):null;var fe=createTextConfig(te,W,!1);return D(q,Y),Y=convertToEC4StyleForCustomSerise(Y,ue,fe),q&&F(Y,q),Y.legacy=!0,Y}function L(q,M){M==null&&(M=d);var N=w(M,EMPHASIS).getItemStyle(),G=A(M,EMPHASIS),X=createTextStyle(G,null,null,!0,!0);X.text=G.getShallow("show")?retrieve3(n.getFormattedLabel(M,EMPHASIS),n.getFormattedLabel(M,NORMAL),getDefaultLabel(t,M)):null;var Y=createTextConfig(G,null,!0);return D(q,N),N=convertToEC4StyleForCustomSerise(N,X,Y),q&&F(N,q),N.legacy=!0,N}function F(q,M){for(var N in M)hasOwn(M,N)&&(q[N]=M[N])}function D(q,M){q&&(q.textFill&&(M.textFill=q.textFill),q.textPosition&&(M.textPosition=q.textPosition))}function $(q,M){if(M==null&&(M=d),hasOwn(STYLE_VISUAL_TYPE,q)){var N=t.getItemVisual(M,"style");return N?N[STYLE_VISUAL_TYPE[q]]:null}if(hasOwn(NON_STYLE_VISUAL_PROPS,q))return t.getItemVisual(M,q)}function O(q){if(u.type==="cartesian2d"){var M=u.getBaseAxis();return getLayoutOnAxis(defaults$h({axis:M},q))}}function P(){return r.getCurrentSeriesIndices()}function C(q){return getFont(q,r)}}function wrapEncodeDef(n){var t={};return each$f(n.dimensions,function(r){var a=n.getDimensionInfo(r);if(!a.isExtraCoord){var o=a.coordDim,u=t[o]=t[o]||[];u[a.coordDimIndex]=n.getDimensionIndex(r)}}),t}function createOrUpdateItem(n,t,r,a,o,u,s){if(!a){u.remove(t);return}var c=doCreateOrUpdateEl(n,t,r,a,o,u);return c&&s.setItemGraphicEl(r,c),c&&toggleHoverEmphasis(c,a.focus,a.blurScope,a.emphasisDisabled),c}function doCreateOrUpdateEl(n,t,r,a,o,u){var s=-1,c=t;t&&doesElNeedRecreate(t,a,o)&&(s=indexOf(u.childrenRef(),t),t=null);var l=!t,d=t;d?d.clearStates():(d=createEl$1(a),c&&copyElement(c,d)),a.morph===!1?d.disableMorphing=!0:d.disableMorphing&&(d.disableMorphing=!1),attachedTxInfoTmp.normal.cfg=attachedTxInfoTmp.normal.conOpt=attachedTxInfoTmp.emphasis.cfg=attachedTxInfoTmp.emphasis.conOpt=attachedTxInfoTmp.blur.cfg=attachedTxInfoTmp.blur.conOpt=attachedTxInfoTmp.select.cfg=attachedTxInfoTmp.select.conOpt=null,attachedTxInfoTmp.isLegacy=!1,doCreateOrUpdateAttachedTx(d,r,a,o,l,attachedTxInfoTmp),doCreateOrUpdateClipPath(d,r,a,o,l),updateElNormal(n,d,r,a,attachedTxInfoTmp,o,l),hasOwn(a,"info")&&(customInnerStore(d).info=a.info);for(var f=0;f<STATES.length;f++){var h=STATES[f];if(h!==NORMAL){var v=retrieveStateOption(a,h),g=retrieveStyleOptionOnState(a,v,h);updateElOnState(h,d,v,g,attachedTxInfoTmp)}}return updateZ(d,a,o),a.type==="group"&&mergeChildren(n,d,r,a,o),s>=0?u.replaceAt(d,s):u.add(d),d}function doesElNeedRecreate(n,t,r){var a=customInnerStore(n),o=t.type,u=t.shape,s=t.style;return r.isUniversalTransitionEnabled()||o!=null&&o!==a.customGraphicType||o==="path"&&hasOwnPathData(u)&&getPathData(u)!==a.customPathData||o==="image"&&hasOwn(s,"image")&&s.image!==a.customImagePath}function doCreateOrUpdateClipPath(n,t,r,a,o){var u=r.clipPath;if(u===!1)n&&n.getClipPath()&&n.removeClipPath();else if(u){var s=n.getClipPath();s&&doesElNeedRecreate(s,u,a)&&(s=null),s||(s=createEl$1(u),n.setClipPath(s)),updateElNormal(null,s,t,u,null,a,o)}}function doCreateOrUpdateAttachedTx(n,t,r,a,o,u){if(!n.isGroup){processTxInfo(r,null,u),processTxInfo(r,EMPHASIS,u);var s=u.normal.conOpt,c=u.emphasis.conOpt,l=u.blur.conOpt,d=u.select.conOpt;if(s!=null||c!=null||d!=null||l!=null){var f=n.getTextContent();if(s===!1)f&&n.removeTextContent();else{s=u.normal.conOpt=s||{type:"text"},f?f.clearStates():(f=createEl$1(s),n.setTextContent(f)),updateElNormal(null,f,t,s,null,a,o);for(var h=s&&s.style,v=0;v<STATES.length;v++){var g=STATES[v];if(g!==NORMAL){var b=u[g].conOpt;updateElOnState(g,f,b,retrieveStyleOptionOnState(s,b,g),null)}}h?f.dirty():f.markRedraw()}}}}function processTxInfo(n,t,r){var a=t?retrieveStateOption(n,t):n,o=t?retrieveStyleOptionOnState(n,a,EMPHASIS):n.style,u=n.type,s=a?a.textConfig:null,c=n.textContent,l=c?t?retrieveStateOption(c,t):c:null;if(o&&(r.isLegacy||isEC4CompatibleStyle(o,u,!!s,!!l))){r.isLegacy=!0;var d=convertFromEC4CompatibleStyle(o,u,!t);!s&&d.textConfig&&(s=d.textConfig),!l&&d.textContent&&(l=d.textContent)}if(!t&&l){var f=l;!f.type&&(f.type="text")}var h=t?r[t]:r.normal;h.cfg=s,h.conOpt=l}function retrieveStateOption(n,t){return t?n?n[t]:null:n}function retrieveStyleOptionOnState(n,t,r){var a=t&&t.style;return a==null&&r===EMPHASIS&&n&&(a=n.styleEmphasis),a}function mergeChildren(n,t,r,a,o){var u=a.children,s=u?u.length:0,c=a.$mergeChildren,l=c==="byName"||a.diffChildrenByName,d=c===!1;if(!(!s&&!l&&!d)){if(l){diffGroupChildren({api:n,oldChildren:t.children()||[],newChildren:u||[],dataIndex:r,seriesModel:o,group:t});return}d&&t.removeAll();for(var f=0;f<s;f++){var h=u[f],v=t.childAt(f);h?(h.ignore==null&&(h.ignore=!1),doCreateOrUpdateEl(n,v,r,h,o,t)):v.ignore=!0}for(var g=t.childCount()-1;g>=f;g--){var b=t.childAt(g);removeChildFromGroup(t,b,o)}}}function removeChildFromGroup(n,t,r){t&&applyLeaveTransition(t,customInnerStore(n).option,r)}function diffGroupChildren(n){new DataDiffer(n.oldChildren,n.newChildren,getKey$1,getKey$1,n).add(processAddUpdate).update(processAddUpdate).remove(processRemove).execute()}function getKey$1(n,t){var r=n&&n.name;return r??GROUP_DIFF_PREFIX+t}function processAddUpdate(n,t){var r=this.context,a=n!=null?r.newChildren[n]:null,o=t!=null?r.oldChildren[t]:null;doCreateOrUpdateEl(r.api,o,r.dataIndex,a,r.seriesModel,r.group)}function processRemove(n){var t=this.context,r=t.oldChildren[n];r&&applyLeaveTransition(r,customInnerStore(r).option,t.seriesModel)}function getPathData(n){return n&&(n.pathData||n.d)}function hasOwnPathData(n){return n&&(hasOwn(n,"pathData")||hasOwn(n,"d"))}function install$r(n){n.registerChartView(CustomChartView),n.registerSeriesModel(CustomSeriesModel)}var inner$b=makeInner(),clone$2=clone$5,bind=bind$1,BaseAxisPointer=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(t,r,a,o){var u=r.get("value"),s=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=a,!(!o&&this._lastValue===u&&this._lastStatus===s)){this._lastValue=u,this._lastStatus=s;var c=this._group,l=this._handle;if(!s||s==="hide"){c&&c.hide(),l&&l.hide();return}c&&c.show(),l&&l.show();var d={};this.makeElOption(d,u,t,r,a);var f=d.graphicKey;f!==this._lastGraphicKey&&this.clear(a),this._lastGraphicKey=f;var h=this._moveAnimation=this.determineAnimation(t,r);if(!c)c=this._group=new Group$3,this.createPointerEl(c,d,t,r),this.createLabelEl(c,d,t,r),a.getZr().add(c);else{var v=curry$1(updateProps,r,h);this.updatePointerEl(c,d,v),this.updateLabelEl(c,d,v,r)}updateMandatoryProps(c,r,!0),this._renderHandle(u)}},n.prototype.remove=function(t){this.clear(t)},n.prototype.dispose=function(t){this.clear(t)},n.prototype.determineAnimation=function(t,r){var a=r.get("animation"),o=t.axis,u=o.type==="category",s=r.get("snap");if(!s&&!u)return!1;if(a==="auto"||a==null){var c=this.animationThreshold;if(u&&o.getBandWidth()>c)return!0;if(s){var l=getAxisInfo$1(t).seriesDataCount,d=o.getExtent();return Math.abs(d[0]-d[1])/l>c}return!1}return a===!0},n.prototype.makeElOption=function(t,r,a,o,u){},n.prototype.createPointerEl=function(t,r,a,o){var u=r.pointer;if(u){var s=inner$b(t).pointerEl=new graphic[u.type](clone$2(r.pointer));t.add(s)}},n.prototype.createLabelEl=function(t,r,a,o){if(r.label){var u=inner$b(t).labelEl=new ZRText(clone$2(r.label));t.add(u),updateLabelShowHide(u,o)}},n.prototype.updatePointerEl=function(t,r,a){var o=inner$b(t).pointerEl;o&&r.pointer&&(o.setStyle(r.pointer.style),a(o,{shape:r.pointer.shape}))},n.prototype.updateLabelEl=function(t,r,a,o){var u=inner$b(t).labelEl;u&&(u.setStyle(r.label.style),a(u,{x:r.label.x,y:r.label.y}),updateLabelShowHide(u,o))},n.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,a=this._api.getZr(),o=this._handle,u=r.getModel("handle"),s=r.get("status");if(!u.get("show")||!s||s==="hide"){o&&a.remove(o),this._handle=null;return}var c;this._handle||(c=!0,o=this._handle=createIcon(u.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(d){stop(d.event)},onmousedown:bind(this._onHandleDragMove,this,0,0),drift:bind(this._onHandleDragMove,this),ondragend:bind(this._onHandleDragEnd,this)}),a.add(o)),updateMandatoryProps(o,r,!1),o.setStyle(u.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=u.get("size");isArray$2(l)||(l=[l,l]),o.scaleX=l[0]/2,o.scaleY=l[1]/2,createOrUpdate(this,"_doDispatchAxisPointer",u.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,c)}},n.prototype._moveHandleToValue=function(t,r){updateProps(this._axisPointerModel,!r&&this._moveAnimation,this._handle,getHandleTransProps(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(t,r){var a=this._handle;if(a){this._dragging=!0;var o=this.updateHandleTransform(getHandleTransProps(a),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=o,a.stopAnimation(),a.attr(getHandleTransProps(o)),inner$b(a).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,a=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:a.axis.dim,axisIndex:a.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),a=this._group,o=this._handle;r&&a&&(this._lastGraphicKey=null,a&&r.remove(a),o&&r.remove(o),this._group=null,this._handle=null,this._payloadInfo=null),clear$1(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(t,r,a){return a=a||0,{x:t[a],y:t[1-a],width:r[a],height:r[1-a]}},n}();function updateProps(n,t,r,a){propsEqual(inner$b(r).lastProp,a)||(inner$b(r).lastProp=a,t?updateProps$1(r,a,n):(r.stopAnimation(),r.attr(a)))}function propsEqual(n,t){if(isObject$4(n)&&isObject$4(t)){var r=!0;return each$f(t,function(a,o){r=r&&propsEqual(n[o],a)}),!!r}else return n===t}function updateLabelShowHide(n,t){n[t.get(["label","show"])?"show":"hide"]()}function getHandleTransProps(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function updateMandatoryProps(n,t,r){var a=t.get("z"),o=t.get("zlevel");n&&n.traverse(function(u){u.type!=="group"&&(a!=null&&(u.z=a),o!=null&&(u.zlevel=o),u.silent=r)})}function buildElStyle(n){var t=n.get("type"),r=n.getModel(t+"Style"),a;return t==="line"?(a=r.getLineStyle(),a.fill=null):t==="shadow"&&(a=r.getAreaStyle(),a.stroke=null),a}function buildLabelElOption(n,t,r,a,o){var u=r.get("value"),s=getValueLabel(u,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),c=r.getModel("label"),l=normalizeCssArray(c.get("padding")||0),d=c.getFont(),f=getBoundingRect(s,d),h=o.position,v=f.width+l[1]+l[3],g=f.height+l[0]+l[2],b=o.align;b==="right"&&(h[0]-=v),b==="center"&&(h[0]-=v/2);var _=o.verticalAlign;_==="bottom"&&(h[1]-=g),_==="middle"&&(h[1]-=g/2),confineInContainer(h,v,g,a);var S=c.get("backgroundColor");(!S||S==="auto")&&(S=t.get(["axisLine","lineStyle","color"])),n.label={x:h[0],y:h[1],style:createTextStyle(c,{text:s,font:d,fill:c.getTextColor(),padding:l,backgroundColor:S}),z2:10}}function confineInContainer(n,t,r,a){var o=a.getWidth(),u=a.getHeight();n[0]=Math.min(n[0]+t,o)-t,n[1]=Math.min(n[1]+r,u)-r,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function getValueLabel(n,t,r,a,o){n=t.scale.parse(n);var u=t.scale.getLabel({value:n},{precision:o.precision}),s=o.formatter;if(s){var c={value:getAxisRawValue(t,{value:n}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};each$f(a,function(l){var d=r.getSeriesByIndex(l.seriesIndex),f=l.dataIndexInside,h=d&&d.getDataParams(f);h&&c.seriesData.push(h)}),isString(s)?u=s.replace("{value}",u):isFunction$1(s)&&(u=s(c))}return u}function getTransformedPosition(n,t,r){var a=create$2();return rotate$1(a,a,r.rotation),translate$1(a,a,r.position),applyTransform([n.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],a)}function buildCartesianSingleLabelElOption(n,t,r,a,o,u){var s=AxisBuilder.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=o.get(["label","margin"]),buildLabelElOption(t,a,o,u,{position:getTransformedPosition(a.axis,n,r),align:s.textAlign,verticalAlign:s.textVerticalAlign})}function makeLineShape(n,t,r){return r=r||0,{x1:n[r],y1:n[1-r],x2:t[r],y2:t[1-r]}}function makeRectShape(n,t,r){return r=r||0,{x:n[r],y:n[1-r],width:t[r],height:t[1-r]}}function makeSectorShape(n,t,r,a,o,u){return{cx:n,cy:t,r0:r,r:a,startAngle:o,endAngle:u,clockwise:!0}}var CartesianAxisPointer=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,a,o,u,s){var c=o.axis,l=c.grid,d=u.get("type"),f=getCartesian(l,c).getOtherAxis(c).getGlobalExtent(),h=c.toGlobalCoord(c.dataToCoord(a,!0));if(d&&d!=="none"){var v=buildElStyle(u),g=pointerShapeBuilder$2[d](c,h,f);g.style=v,r.graphicKey=g.type,r.pointer=g}var b=layout$4(l.model,o);buildCartesianSingleLabelElOption(a,r,b,o,u,s)},t.prototype.getHandleTransform=function(r,a,o){var u=layout$4(a.axis.grid.model,a,{labelInside:!1});u.labelMargin=o.get(["handle","margin"]);var s=getTransformedPosition(a.axis,r,u);return{x:s[0],y:s[1],rotation:u.rotation+(u.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,a,o,u){var s=o.axis,c=s.grid,l=s.getGlobalExtent(!0),d=getCartesian(c,s).getOtherAxis(s).getGlobalExtent(),f=s.dim==="x"?0:1,h=[r.x,r.y];h[f]+=a[f],h[f]=Math.min(l[1],h[f]),h[f]=Math.max(l[0],h[f]);var v=(d[1]+d[0])/2,g=[v,v];g[f]=h[f];var b=[{verticalAlign:"middle"},{align:"center"}];return{x:h[0],y:h[1],rotation:r.rotation,cursorPoint:g,tooltipOption:b[f]}},t}(BaseAxisPointer);function getCartesian(n,t){var r={};return r[t.dim+"AxisIndex"]=t.index,n.getCartesian(r)}var pointerShapeBuilder$2={line:function(n,t,r){var a=makeLineShape([t,r[0]],[t,r[1]],getAxisDimIndex(n));return{type:"Line",subPixelOptimize:!0,shape:a}},shadow:function(n,t,r){var a=Math.max(1,n.getBandWidth()),o=r[1]-r[0];return{type:"Rect",shape:makeRectShape([t-a/2,r[0]],[a,o],getAxisDimIndex(n))}}};function getAxisDimIndex(n){return n.dim==="x"?0:1}var AxisPointerModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(ComponentModel),inner$a=makeInner(),each$8=each$f;function register(n,t,r){if(!env.node){var a=t.getZr();inner$a(a).records||(inner$a(a).records={}),initGlobalListeners(a,t);var o=inner$a(a).records[n]||(inner$a(a).records[n]={});o.handler=r}}function initGlobalListeners(n,t){if(inner$a(n).initialized)return;inner$a(n).initialized=!0,r("click",curry$1(doEnter,"click")),r("mousemove",curry$1(doEnter,"mousemove")),r("globalout",onLeave);function r(a,o){n.on(a,function(u){var s=makeDispatchAction$1(t);each$8(inner$a(n).records,function(c){c&&o(c,u,s.dispatchAction)}),dispatchTooltipFinally(s.pendings,t)})}}function dispatchTooltipFinally(n,t){var r=n.showTip.length,a=n.hideTip.length,o;r?o=n.showTip[r-1]:a&&(o=n.hideTip[a-1]),o&&(o.dispatchAction=null,t.dispatchAction(o))}function onLeave(n,t,r){n.handler("leave",null,r)}function doEnter(n,t,r,a){t.handler(n,r,a)}function makeDispatchAction$1(n){var t={showTip:[],hideTip:[]},r=function(a){var o=t[a.type];o?o.push(a):(a.dispatchAction=r,n.dispatchAction(a))};return{dispatchAction:r,pendings:t}}function unregister(n,t){if(!env.node){var r=t.getZr(),a=(inner$a(r).records||{})[n];a&&(inner$a(r).records[n]=null)}}var AxisPointerView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=a.getComponent("tooltip"),s=r.get("triggerOn")||u&&u.get("triggerOn")||"mousemove|click";register("axisPointer",o,function(c,l,d){s!=="none"&&(c==="leave"||s.indexOf(c)>=0)&&d({type:"updateAxisPointer",currTrigger:c,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,a){unregister("axisPointer",a)},t.prototype.dispose=function(r,a){unregister("axisPointer",a)},t.type="axisPointer",t}(ComponentView);function findPointFromSeries(n,t){var r=[],a=n.seriesIndex,o;if(a==null||!(o=t.getSeriesByIndex(a)))return{point:[]};var u=o.getData(),s=queryDataIndex(u,n);if(s==null||s<0||isArray$2(s))return{point:[]};var c=u.getItemGraphicEl(s),l=o.coordinateSystem;if(o.getTooltipPosition)r=o.getTooltipPosition(s)||[];else if(l&&l.dataToPoint)if(n.isStacked){var d=l.getBaseAxis(),f=l.getOtherAxis(d),h=f.dim,v=d.dim,g=h==="x"||h==="radius"?1:0,b=u.mapDimension(v),_=[];_[g]=u.get(b,s),_[1-g]=u.get(u.getCalculationInfo("stackResultDimension"),s),r=l.dataToPoint(_)||[]}else r=l.dataToPoint(u.getValues(map$1(l.dimensions,function(T){return u.mapDimension(T)}),s))||[];else if(c){var S=c.getBoundingRect().clone();S.applyTransform(c.transform),r=[S.x+S.width/2,S.y+S.height/2]}return{point:r,el:c}}var inner$9=makeInner();function axisTrigger(n,t,r){var a=n.currTrigger,o=[n.x,n.y],u=n,s=n.dispatchAction||bind$1(r.dispatchAction,r),c=t.getComponent("axisPointer").coordSysAxesInfo;if(c){illegalPoint(o)&&(o=findPointFromSeries({seriesIndex:u.seriesIndex,dataIndex:u.dataIndex},t).point);var l=illegalPoint(o),d=u.axesInfo,f=c.axesInfo,h=a==="leave"||illegalPoint(o),v={},g={},b={list:[],map:{}},_={showPointer:curry$1(showPointer,g),showTooltip:curry$1(showTooltip,b)};each$f(c.coordSysMap,function(T,w){var A=l||T.containPoint(o);each$f(c.coordSysAxesInfo[w],function(R,E){var I=R.axis,L=findInputAxisInfo(d,R);if(!h&&A&&(!d||L)){var F=L&&L.value;F==null&&!l&&(F=I.pointToData(o)),F!=null&&processOnAxis(R,F,_,!1,v)}})});var S={};return each$f(f,function(T,w){var A=T.linkGroup;A&&!g[w]&&each$f(A.axesInfo,function(R,E){var I=g[E];if(R!==T&&I){var L=I.value;A.mapper&&(L=T.axis.scale.parse(A.mapper(L,makeMapperParam(R),makeMapperParam(T)))),S[T.key]=L}})}),each$f(S,function(T,w){processOnAxis(f[w],T,_,!0,v)}),updateModelActually(g,f,v),dispatchTooltipActually(b,o,n,s),dispatchHighDownActually(f,s,r),v}}function processOnAxis(n,t,r,a,o){var u=n.axis;if(!(u.scale.isBlank()||!u.containData(t))){if(!n.involveSeries){r.showPointer(n,t);return}var s=buildPayloadsBySeries(t,n),c=s.payloadBatch,l=s.snapToValue;c[0]&&o.seriesIndex==null&&extend$1(o,c[0]),!a&&n.snap&&u.containData(l)&&l!=null&&(t=l),r.showPointer(n,t,c),r.showTooltip(n,s,l)}}function buildPayloadsBySeries(n,t){var r=t.axis,a=r.dim,o=n,u=[],s=Number.MAX_VALUE,c=-1;return each$f(t.seriesModels,function(l,d){var f=l.getData().mapDimensionsAll(a),h,v;if(l.getAxisTooltipData){var g=l.getAxisTooltipData(f,n,r);v=g.dataIndices,h=g.nestestValue}else{if(v=l.getData().indicesOfNearest(f[0],n,r.type==="category"?.5:null),!v.length)return;h=l.getData().get(f[0],v[0])}if(!(h==null||!isFinite(h))){var b=n-h,_=Math.abs(b);_<=s&&((_<s||b>=0&&c<0)&&(s=_,c=b,o=h,u.length=0),each$f(v,function(S){u.push({seriesIndex:l.seriesIndex,dataIndexInside:S,dataIndex:l.getData().getRawIndex(S)})}))}}),{payloadBatch:u,snapToValue:o}}function showPointer(n,t,r,a){n[t.key]={value:r,payloadBatch:a}}function showTooltip(n,t,r,a){var o=r.payloadBatch,u=t.axis,s=u.model,c=t.axisPointerModel;if(!(!t.triggerTooltip||!o.length)){var l=t.coordSys.model,d=makeKey(l),f=n.map[d];f||(f=n.map[d]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},n.list.push(f)),f.dataByAxis.push({axisDim:u.dim,axisIndex:s.componentIndex,axisType:s.type,axisId:s.id,value:a,valueLabelOpt:{precision:c.get(["label","precision"]),formatter:c.get(["label","formatter"])},seriesDataIndices:o.slice()})}}function updateModelActually(n,t,r){var a=r.axesInfo=[];each$f(t,function(o,u){var s=o.axisPointerModel.option,c=n[u];c?(!o.useHandle&&(s.status="show"),s.value=c.value,s.seriesDataIndices=(c.payloadBatch||[]).slice()):!o.useHandle&&(s.status="hide"),s.status==="show"&&a.push({axisDim:o.axis.dim,axisIndex:o.axis.model.componentIndex,value:s.value})})}function dispatchTooltipActually(n,t,r,a){if(illegalPoint(t)||!n.list.length){a({type:"hideTip"});return}var o=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};a({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:o.dataIndexInside,dataIndex:o.dataIndex,seriesIndex:o.seriesIndex,dataByCoordSys:n.list})}function dispatchHighDownActually(n,t,r){var a=r.getZr(),o="axisPointerLastHighlights",u=inner$9(a)[o]||{},s=inner$9(a)[o]={};each$f(n,function(d,f){var h=d.axisPointerModel.option;h.status==="show"&&d.triggerEmphasis&&each$f(h.seriesDataIndices,function(v){var g=v.seriesIndex+" | "+v.dataIndex;s[g]=v})});var c=[],l=[];each$f(u,function(d,f){!s[f]&&l.push(d)}),each$f(s,function(d,f){!u[f]&&c.push(d)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),c.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:c})}function findInputAxisInfo(n,t){for(var r=0;r<(n||[]).length;r++){var a=n[r];if(t.axis.dim===a.axisDim&&t.axis.model.componentIndex===a.axisIndex)return a}}function makeMapperParam(n){var t=n.axis.model,r={},a=r.axisDim=n.axis.dim;return r.axisIndex=r[a+"AxisIndex"]=t.componentIndex,r.axisName=r[a+"AxisName"]=t.name,r.axisId=r[a+"AxisId"]=t.id,r}function illegalPoint(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function install$q(n){AxisView.registerAxisPointerClass("CartesianAxisPointer",CartesianAxisPointer),n.registerComponentModel(AxisPointerModel),n.registerComponentView(AxisPointerView),n.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!isArray$2(r)&&(t.axisPointer.link=[r])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=collect(t,r)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},axisTrigger)}function install$p(n){use(install$N),use(install$q)}var PolarAxisPointer=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,a,o,u,s){var c=o.axis;c.dim==="angle"&&(this.animationThreshold=Math.PI/18);var l=c.polar,d=l.getOtherAxis(c),f=d.getExtent(),h=c.dataToCoord(a),v=u.get("type");if(v&&v!=="none"){var g=buildElStyle(u),b=pointerShapeBuilder$1[v](c,l,h,f);b.style=g,r.graphicKey=b.type,r.pointer=b}var _=u.get(["label","margin"]),S=getLabelPosition(a,o,u,l,_);buildLabelElOption(r,o,u,s,S)},t}(BaseAxisPointer);function getLabelPosition(n,t,r,a,o){var u=t.axis,s=u.dataToCoord(n),c=a.getAngleAxis().getExtent()[0];c=c/180*Math.PI;var l=a.getRadiusAxis().getExtent(),d,f,h;if(u.dim==="radius"){var v=create$2();rotate$1(v,v,c),translate$1(v,v,[a.cx,a.cy]),d=applyTransform([s,-o],v);var g=t.getModel("axisLabel").get("rotate")||0,b=AxisBuilder.innerTextLayout(c,g*Math.PI/180,-1);f=b.textAlign,h=b.textVerticalAlign}else{var _=l[1];d=a.coordToPoint([_+o,s]);var S=a.cx,T=a.cy;f=Math.abs(d[0]-S)/_<.3?"center":d[0]>S?"left":"right",h=Math.abs(d[1]-T)/_<.3?"middle":d[1]>T?"top":"bottom"}return{position:d,align:f,verticalAlign:h}}var pointerShapeBuilder$1={line:function(n,t,r,a){return n.dim==="angle"?{type:"Line",shape:makeLineShape(t.coordToPoint([a[0],r]),t.coordToPoint([a[1],r]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r}}},shadow:function(n,t,r,a){var o=Math.max(1,n.getBandWidth()),u=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:makeSectorShape(t.cx,t.cy,a[0],a[1],(-r-o/2)*u,(-r+o/2)*u)}:{type:"Sector",shape:makeSectorShape(t.cx,t.cy,r-o/2,r+o/2,0,Math.PI*2)}}},PolarModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.findAxisModel=function(r){var a,o=this.ecModel;return o.eachComponent(r,function(u){u.getCoordSysModel()===this&&(a=u)},this),a},t.type="polar",t.dependencies=["radiusAxis","angleAxis"],t.defaultOption={z:0,center:["50%","50%"],radius:"80%"},t}(ComponentModel),PolarAxisModel=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",SINGLE_REFERRING).models[0]},t.type="polarAxis",t}(ComponentModel);mixin$1(PolarAxisModel,AxisModelCommonMixin);var AngleAxisModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="angleAxis",t}(PolarAxisModel),RadiusAxisModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="radiusAxis",t}(PolarAxisModel),RadiusAxis=function(n){__extends(t,n);function t(r,a){return n.call(this,"radius",r,a)||this}return t.prototype.pointToData=function(r,a){return this.polar.pointToData(r,a)[this.dim==="radius"?0:1]},t}(Axis);RadiusAxis.prototype.dataToRadius=Axis.prototype.dataToCoord;RadiusAxis.prototype.radiusToData=Axis.prototype.coordToData;var inner$8=makeInner(),AngleAxis=function(n){__extends(t,n);function t(r,a){return n.call(this,"angle",r,a||[0,360])||this}return t.prototype.pointToData=function(r,a){return this.polar.pointToData(r,a)[this.dim==="radius"?0:1]},t.prototype.calculateCategoryInterval=function(){var r=this,a=r.getLabelModel(),o=r.scale,u=o.getExtent(),s=o.count();if(u[1]-u[0]<1)return 0;var c=u[0],l=r.dataToCoord(c+1)-r.dataToCoord(c),d=Math.abs(l),f=getBoundingRect(c==null?"":c+"",a.getFont(),"center","top"),h=Math.max(f.height,7),v=h/d;isNaN(v)&&(v=1/0);var g=Math.max(0,Math.floor(v)),b=inner$8(r.model),_=b.lastAutoInterval,S=b.lastTickCount;return _!=null&&S!=null&&Math.abs(_-g)<=1&&Math.abs(S-s)<=1&&_>g?g=_:(b.lastTickCount=s,b.lastAutoInterval=g),g},t}(Axis);AngleAxis.prototype.dataToAngle=Axis.prototype.dataToCoord;AngleAxis.prototype.angleToData=Axis.prototype.coordToData;var polarDimensions=["radius","angle"],Polar=function(){function n(t){this.dimensions=polarDimensions,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new RadiusAxis,this._angleAxis=new AngleAxis,this.axisPointerEnabled=!0,this.name=t||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(t){var r=this.pointToCoord(t);return this._radiusAxis.contain(r[0])&&this._angleAxis.contain(r[1])},n.prototype.containData=function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},n.prototype.getAxis=function(t){var r="_"+t+"Axis";return this[r]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(t){var r=[],a=this._angleAxis,o=this._radiusAxis;return a.scale.type===t&&r.push(a),o.scale.type===t&&r.push(o),r},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(t){var r=this._angleAxis;return t===r?this._radiusAxis:r},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(t){var r=t!=null&&t!=="auto"?this.getAxis(t):this.getBaseAxis();return{baseAxes:[r],otherAxes:[this.getOtherAxis(r)]}},n.prototype.dataToPoint=function(t,r){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],r),this._angleAxis.dataToAngle(t[1],r)])},n.prototype.pointToData=function(t,r){var a=this.pointToCoord(t);return[this._radiusAxis.radiusToData(a[0],r),this._angleAxis.angleToData(a[1],r)]},n.prototype.pointToCoord=function(t){var r=t[0]-this.cx,a=t[1]-this.cy,o=this.getAngleAxis(),u=o.getExtent(),s=Math.min(u[0],u[1]),c=Math.max(u[0],u[1]);o.inverse?s=c-360:c=s+360;var l=Math.sqrt(r*r+a*a);r/=l,a/=l;for(var d=Math.atan2(-a,r)/Math.PI*180,f=d<s?1:-1;d<s||d>c;)d+=f*360;return[l,d]},n.prototype.coordToPoint=function(t){var r=t[0],a=t[1]/180*Math.PI,o=Math.cos(a)*r+this.cx,u=-Math.sin(a)*r+this.cy;return[o,u]},n.prototype.getArea=function(){var t=this.getAngleAxis(),r=this.getRadiusAxis(),a=r.getExtent().slice();a[0]>a[1]&&a.reverse();var o=t.getExtent(),u=Math.PI/180,s=1e-4;return{cx:this.cx,cy:this.cy,r0:a[0],r:a[1],startAngle:-o[0]*u,endAngle:-o[1]*u,clockwise:t.inverse,contain:function(c,l){var d=c-this.cx,f=l-this.cy,h=d*d+f*f,v=this.r,g=this.r0;return v!==g&&h-s<=v*v&&h+s>=g*g}}},n.prototype.convertToPixel=function(t,r,a){var o=getCoordSys$2(r);return o===this?this.dataToPoint(a):null},n.prototype.convertFromPixel=function(t,r,a){var o=getCoordSys$2(r);return o===this?this.pointToData(a):null},n}();function getCoordSys$2(n){var t=n.seriesModel,r=n.polarModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}function resizePolar(n,t,r){var a=t.get("center"),o=r.getWidth(),u=r.getHeight();n.cx=parsePercent(a[0],o),n.cy=parsePercent(a[1],u);var s=n.getRadiusAxis(),c=Math.min(o,u)/2,l=t.get("radius");l==null?l=[0,"100%"]:isArray$2(l)||(l=[0,l]);var d=[parsePercent(l[0],c),parsePercent(l[1],c)];s.inverse?s.setExtent(d[1],d[0]):s.setExtent(d[0],d[1])}function updatePolarScale(n,t){var r=this,a=r.getAngleAxis(),o=r.getRadiusAxis();if(a.scale.setExtent(1/0,-1/0),o.scale.setExtent(1/0,-1/0),n.eachSeries(function(c){if(c.coordinateSystem===r){var l=c.getData();each$f(getDataDimensionsOnAxis(l,"radius"),function(d){o.scale.unionExtentFromData(l,d)}),each$f(getDataDimensionsOnAxis(l,"angle"),function(d){a.scale.unionExtentFromData(l,d)})}}),niceScaleExtent(a.scale,a.model),niceScaleExtent(o.scale,o.model),a.type==="category"&&!a.onBand){var u=a.getExtent(),s=360/a.scale.count();a.inverse?u[1]+=s:u[1]-=s,a.setExtent(u[0],u[1])}}function isAngleAxisModel(n){return n.mainType==="angleAxis"}function setAxis(n,t){var r;if(n.type=t.get("type"),n.scale=createScaleByModel$1(t),n.onBand=t.get("boundaryGap")&&n.type==="category",n.inverse=t.get("inverse"),isAngleAxisModel(t)){n.inverse=n.inverse!==t.get("clockwise");var a=t.get("startAngle"),o=(r=t.get("endAngle"))!==null&&r!==void 0?r:a+(n.inverse?-360:360);n.setExtent(a,o)}t.axis=n,n.model=t}var polarCreator={dimensions:polarDimensions,create:function(n,t){var r=[];return n.eachComponent("polar",function(a,o){var u=new Polar(o+"");u.update=updatePolarScale;var s=u.getRadiusAxis(),c=u.getAngleAxis(),l=a.findAxisModel("radiusAxis"),d=a.findAxisModel("angleAxis");setAxis(s,l),setAxis(c,d),resizePolar(u,a,t),r.push(u),a.coordinateSystem=u,u.model=a}),n.eachSeries(function(a){if(a.get("coordinateSystem")==="polar"){var o=a.getReferringComponents("polar",SINGLE_REFERRING).models[0];a.coordinateSystem=o.coordinateSystem}}),r}},elementList=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function getAxisLineShape(n,t,r){t[1]>t[0]&&(t=t.slice().reverse());var a=n.coordToPoint([t[0],r]),o=n.coordToPoint([t[1],r]);return{x1:a[0],y1:a[1],x2:o[0],y2:o[1]}}function getRadiusIdx(n){var t=n.getRadiusAxis();return t.inverse?0:1}function fixAngleOverlap(n){var t=n[0],r=n[n.length-1];t&&r&&Math.abs(Math.abs(t.coord-r.coord)-360)<1e-4&&n.pop()}var AngleAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,a){if(this.group.removeAll(),!!r.get("show")){var o=r.axis,u=o.polar,s=u.getRadiusAxis().getExtent(),c=o.getTicksCoords(),l=o.getMinorTicksCoords(),d=map$1(o.getViewLabels(),function(f){f=clone$5(f);var h=o.scale,v=h.type==="ordinal"?h.getRawOrdinalNumber(f.tickValue):f.tickValue;return f.coord=o.dataToCoord(v),f});fixAngleOverlap(d),fixAngleOverlap(c),each$f(elementList,function(f){r.get([f,"show"])&&(!o.scale.isBlank()||f==="axisLine")&&angelAxisElementsBuilders[f](this.group,r,u,c,l,s,d)},this)}},t.type="angleAxis",t}(AxisView),angelAxisElementsBuilders={axisLine:function(n,t,r,a,o,u){var s=t.getModel(["axisLine","lineStyle"]),c=r.getAngleAxis(),l=Math.PI/180,d=c.getExtent(),f=getRadiusIdx(r),h=f?0:1,v,g=Math.abs(d[1]-d[0])===360?"Circle":"Arc";u[h]===0?v=new graphic[g]({shape:{cx:r.cx,cy:r.cy,r:u[f],startAngle:-d[0]*l,endAngle:-d[1]*l,clockwise:c.inverse},style:s.getLineStyle(),z2:1,silent:!0}):v=new Ring({shape:{cx:r.cx,cy:r.cy,r:u[f],r0:u[h]},style:s.getLineStyle(),z2:1,silent:!0}),v.style.fill=null,n.add(v)},axisTick:function(n,t,r,a,o,u){var s=t.getModel("axisTick"),c=(s.get("inside")?-1:1)*s.get("length"),l=u[getRadiusIdx(r)],d=map$1(a,function(f){return new Line$1({shape:getAxisLineShape(r,[l,l+c],f.coord)})});n.add(mergePath(d,{style:defaults$h(s.getModel("lineStyle").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,t,r,a,o,u){if(o.length){for(var s=t.getModel("axisTick"),c=t.getModel("minorTick"),l=(s.get("inside")?-1:1)*c.get("length"),d=u[getRadiusIdx(r)],f=[],h=0;h<o.length;h++)for(var v=0;v<o[h].length;v++)f.push(new Line$1({shape:getAxisLineShape(r,[d,d+l],o[h][v].coord)}));n.add(mergePath(f,{style:defaults$h(c.getModel("lineStyle").getLineStyle(),defaults$h(s.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,t,r,a,o,u,s){var c=t.getCategories(!0),l=t.getModel("axisLabel"),d=l.get("margin"),f=t.get("triggerEvent");each$f(s,function(h,v){var g=l,b=h.tickValue,_=u[getRadiusIdx(r)],S=r.coordToPoint([_+d,h.coord]),T=r.cx,w=r.cy,A=Math.abs(S[0]-T)/_<.3?"center":S[0]>T?"left":"right",R=Math.abs(S[1]-w)/_<.3?"middle":S[1]>w?"top":"bottom";if(c&&c[b]){var E=c[b];isObject$4(E)&&E.textStyle&&(g=new Model(E.textStyle,l,l.ecModel))}var I=new ZRText({silent:AxisBuilder.isLabelSilent(t),style:createTextStyle(g,{x:S[0],y:S[1],fill:g.getTextColor()||t.get(["axisLine","lineStyle","color"]),text:h.formattedLabel,align:A,verticalAlign:R})});if(n.add(I),f){var L=AxisBuilder.makeAxisEventDataBase(t);L.targetType="axisLabel",L.value=h.rawLabel,getECData(I).eventData=L}},this)},splitLine:function(n,t,r,a,o,u){var s=t.getModel("splitLine"),c=s.getModel("lineStyle"),l=c.get("color"),d=0;l=l instanceof Array?l:[l];for(var f=[],h=0;h<a.length;h++){var v=d++%l.length;f[v]=f[v]||[],f[v].push(new Line$1({shape:getAxisLineShape(r,u,a[h].coord)}))}for(var h=0;h<f.length;h++)n.add(mergePath(f[h],{style:defaults$h({stroke:l[h%l.length]},c.getLineStyle()),silent:!0,z:t.get("z")}))},minorSplitLine:function(n,t,r,a,o,u){if(o.length){for(var s=t.getModel("minorSplitLine"),c=s.getModel("lineStyle"),l=[],d=0;d<o.length;d++)for(var f=0;f<o[d].length;f++)l.push(new Line$1({shape:getAxisLineShape(r,u,o[d][f].coord)}));n.add(mergePath(l,{style:c.getLineStyle(),silent:!0,z:t.get("z")}))}},splitArea:function(n,t,r,a,o,u){if(a.length){var s=t.getModel("splitArea"),c=s.getModel("areaStyle"),l=c.get("color"),d=0;l=l instanceof Array?l:[l];for(var f=[],h=Math.PI/180,v=-a[0].coord*h,g=Math.min(u[0],u[1]),b=Math.max(u[0],u[1]),_=t.get("clockwise"),S=1,T=a.length;S<=T;S++){var w=S===T?a[0].coord:a[S].coord,A=d++%l.length;f[A]=f[A]||[],f[A].push(new Sector({shape:{cx:r.cx,cy:r.cy,r0:g,r:b,startAngle:v,endAngle:-w*h,clockwise:_},silent:!0})),v=-w*h}for(var S=0;S<f.length;S++)n.add(mergePath(f[S],{style:defaults$h({fill:l[S%l.length]},c.getAreaStyle()),silent:!0}))}}},axisBuilderAttrs$1=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs$1=["splitLine","splitArea","minorSplitLine"],RadiusAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,a){if(this.group.removeAll(),!!r.get("show")){var o=this._axisGroup,u=this._axisGroup=new Group$3;this.group.add(u);var s=r.axis,c=s.polar,l=c.getAngleAxis(),d=s.getTicksCoords(),f=s.getMinorTicksCoords(),h=l.getExtent()[0],v=s.getExtent(),g=layoutAxis(c,r,h),b=new AxisBuilder(r,g);each$f(axisBuilderAttrs$1,b.add,b),u.add(b.getGroup()),groupTransition(o,u,r),each$f(selfBuilderAttrs$1,function(_){r.get([_,"show"])&&!s.scale.isBlank()&&axisElementBuilders$1[_](this.group,r,c,h,v,d,f)},this)}},t.type="radiusAxis",t}(AxisView),axisElementBuilders$1={splitLine:function(n,t,r,a,o,u){var s=t.getModel("splitLine"),c=s.getModel("lineStyle"),l=c.get("color"),d=0,f=r.getAngleAxis(),h=Math.PI/180,v=f.getExtent(),g=Math.abs(v[1]-v[0])===360?"Circle":"Arc";l=l instanceof Array?l:[l];for(var b=[],_=0;_<u.length;_++){var S=d++%l.length;b[S]=b[S]||[],b[S].push(new graphic[g]({shape:{cx:r.cx,cy:r.cy,r:Math.max(u[_].coord,0),startAngle:-v[0]*h,endAngle:-v[1]*h,clockwise:f.inverse}}))}for(var _=0;_<b.length;_++)n.add(mergePath(b[_],{style:defaults$h({stroke:l[_%l.length],fill:null},c.getLineStyle()),silent:!0}))},minorSplitLine:function(n,t,r,a,o,u,s){if(s.length){for(var c=t.getModel("minorSplitLine"),l=c.getModel("lineStyle"),d=[],f=0;f<s.length;f++)for(var h=0;h<s[f].length;h++)d.push(new Circle({shape:{cx:r.cx,cy:r.cy,r:s[f][h].coord}}));n.add(mergePath(d,{style:defaults$h({fill:null},l.getLineStyle()),silent:!0}))}},splitArea:function(n,t,r,a,o,u){if(u.length){var s=t.getModel("splitArea"),c=s.getModel("areaStyle"),l=c.get("color"),d=0;l=l instanceof Array?l:[l];for(var f=[],h=u[0].coord,v=1;v<u.length;v++){var g=d++%l.length;f[g]=f[g]||[],f[g].push(new Sector({shape:{cx:r.cx,cy:r.cy,r0:h,r:u[v].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),h=u[v].coord}for(var v=0;v<f.length;v++)n.add(mergePath(f[v],{style:defaults$h({fill:l[v%l.length]},c.getAreaStyle()),silent:!0}))}}};function layoutAxis(n,t,r){return{position:[n.cx,n.cy],rotation:r/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}function getSeriesStackId(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function getAxisKey(n,t){return t.dim+n.model.componentIndex}function barLayoutPolar(n,t,r){var a={},o=calRadialBar(filter$1(t.getSeriesByType(n),function(u){return!t.isSeriesFiltered(u)&&u.coordinateSystem&&u.coordinateSystem.type==="polar"}));t.eachSeriesByType(n,function(u){if(u.coordinateSystem.type==="polar"){var s=u.getData(),c=u.coordinateSystem,l=c.getBaseAxis(),d=getAxisKey(c,l),f=getSeriesStackId(u),h=o[d][f],v=h.offset,g=h.width,b=c.getOtherAxis(l),_=u.coordinateSystem.cx,S=u.coordinateSystem.cy,T=u.get("barMinHeight")||0,w=u.get("barMinAngle")||0;a[f]=a[f]||[];for(var A=s.mapDimension(b.dim),R=s.mapDimension(l.dim),E=isDimensionStacked(s,A),I=l.dim!=="radius"||!u.get("roundCap",!0),L=b.model,F=L.get("startValue"),D=b.dataToCoord(F||0),$=0,O=s.count();$<O;$++){var P=s.get(A,$),C=s.get(R,$),q=P>=0?"p":"n",M=D;E&&(a[f][C]||(a[f][C]={p:D,n:D}),M=a[f][C][q]);var N=void 0,G=void 0,X=void 0,Y=void 0;if(b.dim==="radius"){var W=b.dataToCoord(P)-D,te=l.dataToCoord(C);Math.abs(W)<T&&(W=(W<0?-1:1)*T),N=M,G=M+W,X=te-v,Y=X-g,E&&(a[f][C][q]=G)}else{var ue=b.dataToCoord(P,I)-D,fe=l.dataToCoord(C);Math.abs(ue)<w&&(ue=(ue<0?-1:1)*w),N=fe+v,G=N+g,X=M,Y=M+ue,E&&(a[f][C][q]=Y)}s.setItemLayout($,{cx:_,cy:S,r0:N,r:G,startAngle:-X*Math.PI/180,endAngle:-Y*Math.PI/180,clockwise:X>=Y})}}})}function calRadialBar(n){var t={};each$f(n,function(a,o){var u=a.getData(),s=a.coordinateSystem,c=s.getBaseAxis(),l=getAxisKey(s,c),d=c.getExtent(),f=c.type==="category"?c.getBandWidth():Math.abs(d[1]-d[0])/u.count(),h=t[l]||{bandWidth:f,remainedWidth:f,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},v=h.stacks;t[l]=h;var g=getSeriesStackId(a);v[g]||h.autoWidthCount++,v[g]=v[g]||{width:0,maxWidth:0};var b=parsePercent(a.get("barWidth"),f),_=parsePercent(a.get("barMaxWidth"),f),S=a.get("barGap"),T=a.get("barCategoryGap");b&&!v[g].width&&(b=Math.min(h.remainedWidth,b),v[g].width=b,h.remainedWidth-=b),_&&(v[g].maxWidth=_),S!=null&&(h.gap=S),T!=null&&(h.categoryGap=T)});var r={};return each$f(t,function(a,o){r[o]={};var u=a.stacks,s=a.bandWidth,c=parsePercent(a.categoryGap,s),l=parsePercent(a.gap,1),d=a.remainedWidth,f=a.autoWidthCount,h=(d-c)/(f+(f-1)*l);h=Math.max(h,0),each$f(u,function(_,S){var T=_.maxWidth;T&&T<h&&(T=Math.min(T,d),_.width&&(T=Math.min(T,_.width)),d-=T,_.width=T,f--)}),h=(d-c)/(f+(f-1)*l),h=Math.max(h,0);var v=0,g;each$f(u,function(_,S){_.width||(_.width=h),g=_,v+=_.width*(1+l)}),g&&(v-=g.width*l);var b=-v/2;each$f(u,function(_,S){r[o][S]=r[o][S]||{offset:b,width:_.width},b+=_.width*(1+l)})}),r}var angleAxisExtraOption={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},radiusAxisExtraOption={splitNumber:5},PolarView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="polar",t}(ComponentView);function install$o(n){use(install$q),AxisView.registerAxisPointerClass("PolarAxisPointer",PolarAxisPointer),n.registerCoordinateSystem("polar",polarCreator),n.registerComponentModel(PolarModel),n.registerComponentView(PolarView),axisModelCreator(n,"angle",AngleAxisModel,angleAxisExtraOption),axisModelCreator(n,"radius",RadiusAxisModel,radiusAxisExtraOption),n.registerComponentView(AngleAxisView),n.registerComponentView(RadiusAxisView),n.registerLayout(curry$1(barLayoutPolar,"bar"))}function layout$3(n,t){t=t||{};var r=n.coordinateSystem,a=n.axis,o={},u=a.position,s=a.orient,c=r.getRect(),l=[c.x,c.x+c.width,c.y,c.y+c.height],d={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};o.position=[s==="vertical"?d.vertical[u]:l[0],s==="horizontal"?d.horizontal[u]:l[3]];var f={horizontal:0,vertical:1};o.rotation=Math.PI/2*f[s];var h={top:-1,bottom:1,right:1,left:-1};o.labelDirection=o.tickDirection=o.nameDirection=h[u],n.get(["axisTick","inside"])&&(o.tickDirection=-o.tickDirection),retrieve(t.labelInside,n.get(["axisLabel","inside"]))&&(o.labelDirection=-o.labelDirection);var v=t.rotate;return v==null&&(v=n.get(["axisLabel","rotate"])),o.labelRotation=u==="top"?-v:v,o.z2=1,o}var axisBuilderAttrs=["axisLine","axisTickLabel","axisName"],selfBuilderAttrs=["splitArea","splitLine"],SingleAxisView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="SingleAxisPointer",r}return t.prototype.render=function(r,a,o,u){var s=this.group;s.removeAll();var c=this._axisGroup;this._axisGroup=new Group$3;var l=layout$3(r),d=new AxisBuilder(r,l);each$f(axisBuilderAttrs,d.add,d),s.add(this._axisGroup),s.add(d.getGroup()),each$f(selfBuilderAttrs,function(f){r.get([f,"show"])&&axisElementBuilders[f](this,this.group,this._axisGroup,r)},this),groupTransition(c,this._axisGroup,r),n.prototype.render.call(this,r,a,o,u)},t.prototype.remove=function(){rectCoordAxisHandleRemove(this)},t.type="singleAxis",t}(AxisView),axisElementBuilders={splitLine:function(n,t,r,a){var o=a.axis;if(!o.scale.isBlank()){var u=a.getModel("splitLine"),s=u.getModel("lineStyle"),c=s.get("color");c=c instanceof Array?c:[c];for(var l=s.get("width"),d=a.coordinateSystem.getRect(),f=o.isHorizontal(),h=[],v=0,g=o.getTicksCoords({tickModel:u}),b=[],_=[],S=0;S<g.length;++S){var T=o.toGlobalCoord(g[S].coord);f?(b[0]=T,b[1]=d.y,_[0]=T,_[1]=d.y+d.height):(b[0]=d.x,b[1]=T,_[0]=d.x+d.width,_[1]=T);var w=new Line$1({shape:{x1:b[0],y1:b[1],x2:_[0],y2:_[1]},silent:!0});subPixelOptimizeLine(w.shape,l);var A=v++%c.length;h[A]=h[A]||[],h[A].push(w)}for(var R=s.getLineStyle(["color"]),S=0;S<h.length;++S)t.add(mergePath(h[S],{style:defaults$h({stroke:c[S%c.length]},R),silent:!0}))}},splitArea:function(n,t,r,a){rectCoordAxisBuildSplitArea(n,r,a,a)}},SingleAxisModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getCoordSysModel=function(){return this},t.type="singleAxis",t.layoutMode="box",t.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},t}(ComponentModel);mixin$1(SingleAxisModel,AxisModelCommonMixin.prototype);var SingleAxis=function(n){__extends(t,n);function t(r,a,o,u,s){var c=n.call(this,r,a,o)||this;return c.type=u||"value",c.position=s||"bottom",c}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.pointToData=function(r,a){return this.coordinateSystem.pointToData(r)[0]},t}(Axis),singleDimensions=["single"],Single=function(){function n(t,r,a){this.type="single",this.dimension="single",this.dimensions=singleDimensions,this.axisPointerEnabled=!0,this.model=t,this._init(t,r,a)}return n.prototype._init=function(t,r,a){var o=this.dimension,u=new SingleAxis(o,createScaleByModel$1(t),[0,0],t.get("type"),t.get("position")),s=u.type==="category";u.onBand=s&&t.get("boundaryGap"),u.inverse=t.get("inverse"),u.orient=t.get("orient"),t.axis=u,u.model=t,u.coordinateSystem=this,this._axis=u},n.prototype.update=function(t,r){t.eachSeries(function(a){if(a.coordinateSystem===this){var o=a.getData();each$f(o.mapDimensionsAll(this.dimension),function(u){this._axis.scale.unionExtentFromData(o,u)},this),niceScaleExtent(this._axis.scale,this._axis.model)}},this)},n.prototype.resize=function(t,r){this._rect=getLayoutRect({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:r.getWidth(),height:r.getHeight()}),this._adjustAxis()},n.prototype.getRect=function(){return this._rect},n.prototype._adjustAxis=function(){var t=this._rect,r=this._axis,a=r.isHorizontal(),o=a?[0,t.width]:[0,t.height],u=r.inverse?1:0;r.setExtent(o[u],o[1-u]),this._updateAxisTransform(r,a?t.x:t.y)},n.prototype._updateAxisTransform=function(t,r){var a=t.getExtent(),o=a[0]+a[1],u=t.isHorizontal();t.toGlobalCoord=u?function(s){return s+r}:function(s){return o-s+r},t.toLocalCoord=u?function(s){return s-r}:function(s){return o-s+r}},n.prototype.getAxis=function(){return this._axis},n.prototype.getBaseAxis=function(){return this._axis},n.prototype.getAxes=function(){return[this._axis]},n.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},n.prototype.containPoint=function(t){var r=this.getRect(),a=this.getAxis(),o=a.orient;return o==="horizontal"?a.contain(a.toLocalCoord(t[0]))&&t[1]>=r.y&&t[1]<=r.y+r.height:a.contain(a.toLocalCoord(t[1]))&&t[0]>=r.y&&t[0]<=r.y+r.height},n.prototype.pointToData=function(t){var r=this.getAxis();return[r.coordToData(r.toLocalCoord(t[r.orient==="horizontal"?0:1]))]},n.prototype.dataToPoint=function(t){var r=this.getAxis(),a=this.getRect(),o=[],u=r.orient==="horizontal"?0:1;return t instanceof Array&&(t=t[0]),o[u]=r.toGlobalCoord(r.dataToCoord(+t)),o[1-u]=u===0?a.y+a.height/2:a.x+a.width/2,o},n.prototype.convertToPixel=function(t,r,a){var o=getCoordSys$1(r);return o===this?this.dataToPoint(a):null},n.prototype.convertFromPixel=function(t,r,a){var o=getCoordSys$1(r);return o===this?this.pointToData(a):null},n}();function getCoordSys$1(n){var t=n.seriesModel,r=n.singleAxisModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}function create$1(n,t){var r=[];return n.eachComponent("singleAxis",function(a,o){var u=new Single(a,n,t);u.name="single_"+o,u.resize(a,t),a.coordinateSystem=u,r.push(u)}),n.eachSeries(function(a){if(a.get("coordinateSystem")==="singleAxis"){var o=a.getReferringComponents("singleAxis",SINGLE_REFERRING).models[0];a.coordinateSystem=o&&o.coordinateSystem}}),r}var singleCreator={create:create$1,dimensions:singleDimensions},XY$1=["x","y"],WH$1=["width","height"],SingleAxisPointer=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,a,o,u,s){var c=o.axis,l=c.coordinateSystem,d=getGlobalExtent(l,1-getPointDimIndex(c)),f=l.dataToPoint(a)[0],h=u.get("type");if(h&&h!=="none"){var v=buildElStyle(u),g=pointerShapeBuilder[h](c,f,d);g.style=v,r.graphicKey=g.type,r.pointer=g}var b=layout$3(o);buildCartesianSingleLabelElOption(a,r,b,o,u,s)},t.prototype.getHandleTransform=function(r,a,o){var u=layout$3(a,{labelInside:!1});u.labelMargin=o.get(["handle","margin"]);var s=getTransformedPosition(a.axis,r,u);return{x:s[0],y:s[1],rotation:u.rotation+(u.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,a,o,u){var s=o.axis,c=s.coordinateSystem,l=getPointDimIndex(s),d=getGlobalExtent(c,l),f=[r.x,r.y];f[l]+=a[l],f[l]=Math.min(d[1],f[l]),f[l]=Math.max(d[0],f[l]);var h=getGlobalExtent(c,1-l),v=(h[1]+h[0])/2,g=[v,v];return g[l]=f[l],{x:f[0],y:f[1],rotation:r.rotation,cursorPoint:g,tooltipOption:{verticalAlign:"middle"}}},t}(BaseAxisPointer),pointerShapeBuilder={line:function(n,t,r){var a=makeLineShape([t,r[0]],[t,r[1]],getPointDimIndex(n));return{type:"Line",subPixelOptimize:!0,shape:a}},shadow:function(n,t,r){var a=n.getBandWidth(),o=r[1]-r[0];return{type:"Rect",shape:makeRectShape([t-a/2,r[0]],[a,o],getPointDimIndex(n))}}};function getPointDimIndex(n){return n.isHorizontal()?0:1}function getGlobalExtent(n,t){var r=n.getRect();return[r[XY$1[t]],r[XY$1[t]]+r[WH$1[t]]]}var SingleView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="single",t}(ComponentView);function install$n(n){use(install$q),AxisView.registerAxisPointerClass("SingleAxisPointer",SingleAxisPointer),n.registerComponentView(SingleView),n.registerComponentView(SingleAxisView),n.registerComponentModel(SingleAxisModel),axisModelCreator(n,"single",SingleAxisModel,SingleAxisModel.defaultOption),n.registerCoordinateSystem("single",singleCreator)}var CalendarModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a,o){var u=getLayoutParams(r);n.prototype.init.apply(this,arguments),mergeAndNormalizeLayoutParams$1(r,u)},t.prototype.mergeOption=function(r){n.prototype.mergeOption.apply(this,arguments),mergeAndNormalizeLayoutParams$1(this.option,r)},t.prototype.getCellSize=function(){return this.option.cellSize},t.type="calendar",t.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},t}(ComponentModel);function mergeAndNormalizeLayoutParams$1(n,t){var r=n.cellSize,a;isArray$2(r)?a=r:a=n.cellSize=[r,r],a.length===1&&(a[1]=a[0]);var o=map$1([0,1],function(u){return sizeCalculable(t,u)&&(a[u]="auto"),a[u]!=null&&a[u]!=="auto"});mergeLayoutParam(n,t,{type:"box",ignoreSize:o})}var CalendarView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){var u=this.group;u.removeAll();var s=r.coordinateSystem,c=s.getRangeInfo(),l=s.getOrient(),d=a.getLocaleModel();this._renderDayRect(r,c,u),this._renderLines(r,c,l,u),this._renderYearText(r,c,l,u),this._renderMonthText(r,d,l,u),this._renderWeekText(r,d,c,l,u)},t.prototype._renderDayRect=function(r,a,o){for(var u=r.coordinateSystem,s=r.getModel("itemStyle").getItemStyle(),c=u.getCellWidth(),l=u.getCellHeight(),d=a.start.time;d<=a.end.time;d=u.getNextNDay(d,1).time){var f=u.dataToRect([d],!1).tl,h=new Rect$2({shape:{x:f[0],y:f[1],width:c,height:l},cursor:"default",style:s});o.add(h)}},t.prototype._renderLines=function(r,a,o,u){var s=this,c=r.coordinateSystem,l=r.getModel(["splitLine","lineStyle"]).getLineStyle(),d=r.get(["splitLine","show"]),f=l.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var h=a.start,v=0;h.time<=a.end.time;v++){b(h.formatedDate),v===0&&(h=c.getDateInfo(a.start.y+"-"+a.start.m));var g=h.date;g.setMonth(g.getMonth()+1),h=c.getDateInfo(g)}b(c.getNextNDay(a.end.time,1).formatedDate);function b(_){s._firstDayOfMonth.push(c.getDateInfo(_)),s._firstDayPoints.push(c.dataToRect([_],!1).tl);var S=s._getLinePointsOfOneWeek(r,_,o);s._tlpoints.push(S[0]),s._blpoints.push(S[S.length-1]),d&&s._drawSplitline(S,l,u)}d&&this._drawSplitline(s._getEdgesPoints(s._tlpoints,f,o),l,u),d&&this._drawSplitline(s._getEdgesPoints(s._blpoints,f,o),l,u)},t.prototype._getEdgesPoints=function(r,a,o){var u=[r[0].slice(),r[r.length-1].slice()],s=o==="horizontal"?0:1;return u[0][s]=u[0][s]-a/2,u[1][s]=u[1][s]+a/2,u},t.prototype._drawSplitline=function(r,a,o){var u=new Polyline$1({z2:20,shape:{points:r},style:a});o.add(u)},t.prototype._getLinePointsOfOneWeek=function(r,a,o){for(var u=r.coordinateSystem,s=u.getDateInfo(a),c=[],l=0;l<7;l++){var d=u.getNextNDay(s.time,l),f=u.dataToRect([d.time],!1);c[2*d.day]=f.tl,c[2*d.day+1]=f[o==="horizontal"?"bl":"tr"]}return c},t.prototype._formatterLabel=function(r,a){return isString(r)&&r?formatTplSimple(r,a):isFunction$1(r)?r(a):a.nameMap},t.prototype._yearTextPositionControl=function(r,a,o,u,s){var c=a[0],l=a[1],d=["center","bottom"];u==="bottom"?(l+=s,d=["center","top"]):u==="left"?c-=s:u==="right"?(c+=s,d=["center","top"]):l-=s;var f=0;return(u==="left"||u==="right")&&(f=Math.PI/2),{rotation:f,x:c,y:l,style:{align:d[0],verticalAlign:d[1]}}},t.prototype._renderYearText=function(r,a,o,u){var s=r.getModel("yearLabel");if(s.get("show")){var c=s.get("margin"),l=s.get("position");l||(l=o!=="horizontal"?"top":"left");var d=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],f=(d[0][0]+d[1][0])/2,h=(d[0][1]+d[1][1])/2,v=o==="horizontal"?0:1,g={top:[f,d[v][1]],bottom:[f,d[1-v][1]],left:[d[1-v][0],h],right:[d[v][0],h]},b=a.start.y;+a.end.y>+a.start.y&&(b=b+"-"+a.end.y);var _=s.get("formatter"),S={start:a.start.y,end:a.end.y,nameMap:b},T=this._formatterLabel(_,S),w=new ZRText({z2:30,style:createTextStyle(s,{text:T}),silent:s.get("silent")});w.attr(this._yearTextPositionControl(w,g[l],o,l,c)),u.add(w)}},t.prototype._monthTextPositionControl=function(r,a,o,u,s){var c="left",l="top",d=r[0],f=r[1];return o==="horizontal"?(f=f+s,a&&(c="center"),u==="start"&&(l="bottom")):(d=d+s,a&&(l="middle"),u==="start"&&(c="right")),{x:d,y:f,align:c,verticalAlign:l}},t.prototype._renderMonthText=function(r,a,o,u){var s=r.getModel("monthLabel");if(s.get("show")){var c=s.get("nameMap"),l=s.get("margin"),d=s.get("position"),f=s.get("align"),h=[this._tlpoints,this._blpoints];(!c||isString(c))&&(c&&(a=getLocaleModel(c)||a),c=a.get(["time","monthAbbr"])||[]);var v=d==="start"?0:1,g=o==="horizontal"?0:1;l=d==="start"?-l:l;for(var b=f==="center",_=s.get("silent"),S=0;S<h[v].length-1;S++){var T=h[v][S].slice(),w=this._firstDayOfMonth[S];if(b){var A=this._firstDayPoints[S];T[g]=(A[g]+h[0][S+1][g])/2}var R=s.get("formatter"),E=c[+w.m-1],I={yyyy:w.y,yy:(w.y+"").slice(2),MM:w.m,M:+w.m,nameMap:E},L=this._formatterLabel(R,I),F=new ZRText({z2:30,style:extend$1(createTextStyle(s,{text:L}),this._monthTextPositionControl(T,b,o,d,l)),silent:_});u.add(F)}}},t.prototype._weekTextPositionControl=function(r,a,o,u,s){var c="center",l="middle",d=r[0],f=r[1],h=o==="start";return a==="horizontal"?(d=d+u+(h?1:-1)*s[0]/2,c=h?"right":"left"):(f=f+u+(h?1:-1)*s[1]/2,l=h?"bottom":"top"),{x:d,y:f,align:c,verticalAlign:l}},t.prototype._renderWeekText=function(r,a,o,u,s){var c=r.getModel("dayLabel");if(c.get("show")){var l=r.coordinateSystem,d=c.get("position"),f=c.get("nameMap"),h=c.get("margin"),v=l.getFirstDayOfWeek();if(!f||isString(f)){f&&(a=getLocaleModel(f)||a);var g=a.get(["time","dayOfWeekShort"]);f=g||map$1(a.get(["time","dayOfWeekAbbr"]),function(I){return I[0]})}var b=l.getNextNDay(o.end.time,7-o.lweek).time,_=[l.getCellWidth(),l.getCellHeight()];h=parsePercent(h,Math.min(_[1],_[0])),d==="start"&&(b=l.getNextNDay(o.start.time,-(7+o.fweek)).time,h=-h);for(var S=c.get("silent"),T=0;T<7;T++){var w=l.getNextNDay(b,T),A=l.dataToRect([w.time],!1).center,R=T;R=Math.abs((T+v)%7);var E=new ZRText({z2:30,style:extend$1(createTextStyle(c,{text:f[R]}),this._weekTextPositionControl(A,u,d,h,_)),silent:S});s.add(E)}}},t.type="calendar",t}(ComponentView),PROXIMATE_ONE_DAY=864e5,Calendar=function(){function n(t,r,a){this.type="calendar",this.dimensions=n.dimensions,this.getDimensionsInfo=n.getDimensionsInfo,this._model=t}return n.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},n.prototype.getRangeInfo=function(){return this._rangeInfo},n.prototype.getModel=function(){return this._model},n.prototype.getRect=function(){return this._rect},n.prototype.getCellWidth=function(){return this._sw},n.prototype.getCellHeight=function(){return this._sh},n.prototype.getOrient=function(){return this._orient},n.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},n.prototype.getDateInfo=function(t){t=parseDate(t);var r=t.getFullYear(),a=t.getMonth()+1,o=a<10?"0"+a:""+a,u=t.getDate(),s=u<10?"0"+u:""+u,c=t.getDay();return c=Math.abs((c+7-this.getFirstDayOfWeek())%7),{y:r+"",m:o,d:s,day:c,time:t.getTime(),formatedDate:r+"-"+o+"-"+s,date:t}},n.prototype.getNextNDay=function(t,r){return r=r||0,r===0?this.getDateInfo(t):(t=new Date(this.getDateInfo(t).time),t.setDate(t.getDate()+r),this.getDateInfo(t))},n.prototype.update=function(t,r){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var a=this._rangeInfo.weeks||1,o=["width","height"],u=this._model.getCellSize().slice(),s=this._model.getBoxLayoutParams(),c=this._orient==="horizontal"?[a,7]:[7,a];each$f([0,1],function(h){f(u,h)&&(s[o[h]]=u[h]*c[h])});var l={width:r.getWidth(),height:r.getHeight()},d=this._rect=getLayoutRect(s,l);each$f([0,1],function(h){f(u,h)||(u[h]=d[o[h]]/c[h])});function f(h,v){return h[v]!=null&&h[v]!=="auto"}this._sw=u[0],this._sh=u[1]},n.prototype.dataToPoint=function(t,r){isArray$2(t)&&(t=t[0]),r==null&&(r=!0);var a=this.getDateInfo(t),o=this._rangeInfo,u=a.formatedDate;if(r&&!(a.time>=o.start.time&&a.time<o.end.time+PROXIMATE_ONE_DAY))return[NaN,NaN];var s=a.day,c=this._getRangeInfo([o.start.time,u]).nthWeek;return this._orient==="vertical"?[this._rect.x+s*this._sw+this._sw/2,this._rect.y+c*this._sh+this._sh/2]:[this._rect.x+c*this._sw+this._sw/2,this._rect.y+s*this._sh+this._sh/2]},n.prototype.pointToData=function(t){var r=this.pointToDate(t);return r&&r.time},n.prototype.dataToRect=function(t,r){var a=this.dataToPoint(t,r);return{contentShape:{x:a[0]-(this._sw-this._lineWidth)/2,y:a[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:a,tl:[a[0]-this._sw/2,a[1]-this._sh/2],tr:[a[0]+this._sw/2,a[1]-this._sh/2],br:[a[0]+this._sw/2,a[1]+this._sh/2],bl:[a[0]-this._sw/2,a[1]+this._sh/2]}},n.prototype.pointToDate=function(t){var r=Math.floor((t[0]-this._rect.x)/this._sw)+1,a=Math.floor((t[1]-this._rect.y)/this._sh)+1,o=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(a,r-1,o):this._getDateByWeeksAndDay(r,a-1,o)},n.prototype.convertToPixel=function(t,r,a){var o=getCoordSys(r);return o===this?o.dataToPoint(a):null},n.prototype.convertFromPixel=function(t,r,a){var o=getCoordSys(r);return o===this?o.pointToData(a):null},n.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},n.prototype._initRangeOption=function(){var t=this._model.get("range"),r;if(isArray$2(t)&&t.length===1&&(t=t[0]),isArray$2(t))r=t;else{var a=t.toString();if(/^\d{4}$/.test(a)&&(r=[a+"-01-01",a+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(a)){var o=this.getDateInfo(a),u=o.date;u.setMonth(u.getMonth()+1);var s=this.getNextNDay(u,-1);r=[o.formatedDate,s.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(a)&&(r=[a,a])}if(!r)return t;var c=this._getRangeInfo(r);return c.start.time>c.end.time&&r.reverse(),r},n.prototype._getRangeInfo=function(t){var r=[this.getDateInfo(t[0]),this.getDateInfo(t[1])],a;r[0].time>r[1].time&&(a=!0,r.reverse());var o=Math.floor(r[1].time/PROXIMATE_ONE_DAY)-Math.floor(r[0].time/PROXIMATE_ONE_DAY)+1,u=new Date(r[0].time),s=u.getDate(),c=r[1].date.getDate();u.setDate(s+o-1);var l=u.getDate();if(l!==c)for(var d=u.getTime()-r[1].time>0?1:-1;(l=u.getDate())!==c&&(u.getTime()-r[1].time)*d>0;)o-=d,u.setDate(l-d);var f=Math.floor((o+r[0].day+6)/7),h=a?-f+1:f-1;return a&&r.reverse(),{range:[r[0].formatedDate,r[1].formatedDate],start:r[0],end:r[1],allDay:o,weeks:f,nthWeek:h,fweek:r[0].day,lweek:r[1].day}},n.prototype._getDateByWeeksAndDay=function(t,r,a){var o=this._getRangeInfo(a);if(t>o.weeks||t===0&&r<o.fweek||t===o.weeks&&r>o.lweek)return null;var u=(t-1)*7-o.fweek+r,s=new Date(o.start.time);return s.setDate(+o.start.d+u),this.getDateInfo(s)},n.create=function(t,r){var a=[];return t.eachComponent("calendar",function(o){var u=new n(o);a.push(u),o.coordinateSystem=u}),t.eachSeries(function(o){o.get("coordinateSystem")==="calendar"&&(o.coordinateSystem=a[o.get("calendarIndex")||0])}),a},n.dimensions=["time","value"],n}();function getCoordSys(n){var t=n.calendarModel,r=n.seriesModel,a=t?t.coordinateSystem:r?r.coordinateSystem:null;return a}function install$m(n){n.registerComponentModel(CalendarModel),n.registerComponentView(CalendarView),n.registerCoordinateSystem("calendar",Calendar)}function setKeyInfoToNewElOption(n,t){var r=n.existing;if(t.id=n.keyInfo.id,!t.type&&r&&(t.type=r.type),t.parentId==null){var a=t.parentOption;a?t.parentId=a.id:r&&(t.parentId=r.parentId)}t.parentOption=null}function isSetLoc(n,t){var r;return each$f(t,function(a){n[a]!=null&&n[a]!=="auto"&&(r=!0)}),r}function mergeNewElOptionToExist(n,t,r){var a=extend$1({},r),o=n[t],u=r.$action||"merge";u==="merge"?o?(merge$3(o,a,!0),mergeLayoutParam(o,a,{ignoreSize:!0}),copyLayoutParams(r,o),copyTransitionInfo(r,o),copyTransitionInfo(r,o,"shape"),copyTransitionInfo(r,o,"style"),copyTransitionInfo(r,o,"extra"),r.clipPath=o.clipPath):n[t]=a:u==="replace"?n[t]=a:u==="remove"&&o&&(n[t]=null)}var TRANSITION_PROPS_TO_COPY=["transition","enterFrom","leaveTo"],ROOT_TRANSITION_PROPS_TO_COPY=TRANSITION_PROPS_TO_COPY.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function copyTransitionInfo(n,t,r){if(r&&(!n[r]&&t[r]&&(n[r]={}),n=n[r],t=t[r]),!(!n||!t))for(var a=r?TRANSITION_PROPS_TO_COPY:ROOT_TRANSITION_PROPS_TO_COPY,o=0;o<a.length;o++){var u=a[o];n[u]==null&&t[u]!=null&&(n[u]=t[u])}}function setLayoutInfoToExist(n,t){if(n&&(n.hv=t.hv=[isSetLoc(t,["left","right"]),isSetLoc(t,["top","bottom"])],n.type==="group")){var r=n,a=t;r.width==null&&(r.width=a.width=0),r.height==null&&(r.height=a.height=0)}}var GraphicComponentModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.preventAutoZ=!0,r}return t.prototype.mergeOption=function(r,a){var o=this.option.elements;this.option.elements=null,n.prototype.mergeOption.call(this,r,a),this.option.elements=o},t.prototype.optionUpdated=function(r,a){var o=this.option,u=(a?o:r).elements,s=o.elements=a?[]:o.elements,c=[];this._flatten(u,c,null);var l=mappingToExists(s,c,"normalMerge"),d=this._elOptionsToUpdate=[];each$f(l,function(f,h){var v=f.newOption;v&&(d.push(v),setKeyInfoToNewElOption(f,v),mergeNewElOptionToExist(s,h,v),setLayoutInfoToExist(s[h],v))},this),o.elements=filter$1(s,function(f){return f&&delete f.$action,f!=null})},t.prototype._flatten=function(r,a,o){each$f(r,function(u){if(u){o&&(u.parentOption=o),a.push(u);var s=u.children;s&&s.length&&this._flatten(s,a,u),delete u.children}},this)},t.prototype.useElOptionsToUpdate=function(){var r=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,r},t.type="graphic",t.defaultOption={elements:[]},t}(ComponentModel),nonShapeGraphicElements={path:null,compoundPath:null,group:Group$3,image:ZRImage,text:ZRText},inner$7=makeInner(),GraphicComponentView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this._elMap=createHashMap()},t.prototype.render=function(r,a,o){r!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=r,this._updateElements(r),this._relocate(r,o)},t.prototype._updateElements=function(r){var a=r.useElOptionsToUpdate();if(a){var o=this._elMap,u=this.group,s=r.get("z"),c=r.get("zlevel");each$f(a,function(l){var d=convertOptionIdName(l.id,null),f=d!=null?o.get(d):null,h=convertOptionIdName(l.parentId,null),v=h!=null?o.get(h):u,g=l.type,b=l.style;g==="text"&&b&&l.hv&&l.hv[1]&&(b.textVerticalAlign=b.textBaseline=b.verticalAlign=b.align=null);var _=l.textContent,S=l.textConfig;if(b&&isEC4CompatibleStyle(b,g,!!S,!!_)){var T=convertFromEC4CompatibleStyle(b,g,!0);!S&&T.textConfig&&(S=l.textConfig=T.textConfig),!_&&T.textContent&&(_=T.textContent)}var w=getCleanedElOption(l),A=l.$action||"merge",R=A==="merge",E=A==="replace";if(R){var I=!f,L=f;I?L=createEl(d,v,l.type,o):(L&&(inner$7(L).isNew=!1),stopPreviousKeyframeAnimationAndRestore(L)),L&&(applyUpdateTransition(L,w,r,{isInit:I}),updateCommonAttrs(L,l,s,c))}else if(E){removeEl$1(f,l,o,r);var F=createEl(d,v,l.type,o);F&&(applyUpdateTransition(F,w,r,{isInit:!0}),updateCommonAttrs(F,l,s,c))}else A==="remove"&&(updateLeaveTo(f,l),removeEl$1(f,l,o,r));var D=o.get(d);if(D&&_)if(R){var $=D.getTextContent();$?$.attr(_):D.setTextContent(new ZRText(_))}else E&&D.setTextContent(new ZRText(_));if(D){var O=l.clipPath;if(O){var P=O.type,C=void 0,I=!1;if(R){var q=D.getClipPath();I=!q||inner$7(q).type!==P,C=I?newEl(P):q}else E&&(I=!0,C=newEl(P));D.setClipPath(C),applyUpdateTransition(C,O,r,{isInit:I}),applyKeyframeAnimation(C,O.keyframeAnimation,r)}var M=inner$7(D);D.setTextConfig(S),M.option=l,setEventData(D,r,l),setTooltipConfig({el:D,componentModel:r,itemName:D.name,itemTooltipOption:l.tooltip}),applyKeyframeAnimation(D,l.keyframeAnimation,r)}})}},t.prototype._relocate=function(r,a){for(var o=r.option.elements,u=this.group,s=this._elMap,c=a.getWidth(),l=a.getHeight(),d=["x","y"],f=0;f<o.length;f++){var h=o[f],v=convertOptionIdName(h.id,null),g=v!=null?s.get(v):null;if(!(!g||!g.isGroup)){var b=g.parent,_=b===u,S=inner$7(g),T=inner$7(b);S.width=parsePercent(S.option.width,_?c:T.width)||0,S.height=parsePercent(S.option.height,_?l:T.height)||0}}for(var f=o.length-1;f>=0;f--){var h=o[f],v=convertOptionIdName(h.id,null),g=v!=null?s.get(v):null;if(g){var b=g.parent,T=inner$7(b),w=b===u?{width:c,height:l}:{width:T.width,height:T.height},A={},R=positionElement(g,h,w,null,{hv:h.hv,boundingMode:h.bounding},A);if(!inner$7(g).isNew&&R){for(var E=h.transition,I={},L=0;L<d.length;L++){var F=d[L],D=A[F];E&&(isTransitionAll(E)||indexOf(E,F)>=0)?I[F]=D:g[F]=D}updateProps$1(g,I,r,0)}else g.attr(A)}}},t.prototype._clear=function(){var r=this,a=this._elMap;a.each(function(o){removeEl$1(o,inner$7(o).option,a,r._lastGraphicModel)}),this._elMap=createHashMap()},t.prototype.dispose=function(){this._clear()},t.type="graphic",t}(ComponentView);function newEl(n){var t=hasOwn(nonShapeGraphicElements,n)?nonShapeGraphicElements[n]:getShapeClass(n),r=new t({});return inner$7(r).type=n,r}function createEl(n,t,r,a){var o=newEl(r);return t.add(o),a.set(n,o),inner$7(o).id=n,inner$7(o).isNew=!0,o}function removeEl$1(n,t,r,a){var o=n&&n.parent;o&&(n.type==="group"&&n.traverse(function(u){removeEl$1(u,t,r,a)}),applyLeaveTransition(n,t,a),r.removeKey(inner$7(n).id))}function updateCommonAttrs(n,t,r,a){n.isGroup||each$f([["cursor",Displayable.prototype.cursor],["zlevel",a||0],["z",r||0],["z2",0]],function(o){var u=o[0];hasOwn(t,u)?n[u]=retrieve2(t[u],o[1]):n[u]==null&&(n[u]=o[1])}),each$f(keys(t),function(o){if(o.indexOf("on")===0){var u=t[o];n[o]=isFunction$1(u)?u:null}}),hasOwn(t,"draggable")&&(n.draggable=t.draggable),t.name!=null&&(n.name=t.name),t.id!=null&&(n.id=t.id)}function getCleanedElOption(n){return n=extend$1({},n),each$f(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(LOCATION_PARAMS),function(t){delete n[t]}),n}function setEventData(n,t,r){var a=getECData(n).eventData;!n.silent&&!n.ignore&&!a&&(a=getECData(n).eventData={componentType:"graphic",componentIndex:t.componentIndex,name:n.name}),a&&(a.info=r.info)}function install$l(n){n.registerComponentModel(GraphicComponentModel),n.registerComponentView(GraphicComponentView),n.registerPreprocessor(function(t){var r=t.graphic;isArray$2(r)?!r[0]||!r[0].elements?t.graphic=[{elements:r}]:t.graphic=[t.graphic[0]]:r&&!r.elements&&(t.graphic=[{elements:[r]}])})}var DATA_ZOOM_AXIS_DIMENSIONS=["x","y","radius","angle","single"],SERIES_COORDS=["cartesian2d","polar","singleAxis"];function isCoordSupported(n){var t=n.get("coordinateSystem");return indexOf(SERIES_COORDS,t)>=0}function getAxisMainType(n){return n+"Axis"}function findEffectedDataZooms(n,t){var r=createHashMap(),a=[],o=createHashMap();n.eachComponent({mainType:"dataZoom",query:t},function(f){o.get(f.uid)||c(f)});var u;do u=!1,n.eachComponent("dataZoom",s);while(u);function s(f){!o.get(f.uid)&&l(f)&&(c(f),u=!0)}function c(f){o.set(f.uid,!0),a.push(f),d(f)}function l(f){var h=!1;return f.eachTargetAxis(function(v,g){var b=r.get(v);b&&b[g]&&(h=!0)}),h}function d(f){f.eachTargetAxis(function(h,v){(r.get(h)||r.set(h,[]))[v]=!0})}return a}function collectReferCoordSysModelInfo(n){var t=n.ecModel,r={infoList:[],infoMap:createHashMap()};return n.eachTargetAxis(function(a,o){var u=t.getComponent(getAxisMainType(a),o);if(u){var s=u.getCoordSysModel();if(s){var c=s.uid,l=r.infoMap.get(c);l||(l={model:s,axisModels:[]},r.infoList.push(l),r.infoMap.set(c,l)),l.axisModels.push(u)}}}),r}var DataZoomAxisInfo=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},n}(),DataZoomModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._autoThrottle=!0,r._noTarget=!0,r._rangePropMode=["percent","percent"],r}return t.prototype.init=function(r,a,o){var u=retrieveRawOption(r);this.settledOption=u,this.mergeDefaultAndTheme(r,o),this._doInit(u)},t.prototype.mergeOption=function(r){var a=retrieveRawOption(r);merge$3(this.option,r,!0),merge$3(this.settledOption,a,!0),this._doInit(a)},t.prototype._doInit=function(r){var a=this.option;this._setDefaultThrottle(r),this._updateRangeUse(r);var o=this.settledOption;each$f([["start","startValue"],["end","endValue"]],function(u,s){this._rangePropMode[s]==="value"&&(a[u[0]]=o[u[0]]=null)},this),this._resetTarget()},t.prototype._resetTarget=function(){var r=this.get("orient",!0),a=this._targetAxisInfoMap=createHashMap(),o=this._fillSpecifiedTargetAxis(a);o?this._orient=r||this._makeAutoOrientByTargetAxis():(this._orient=r||"horizontal",this._fillAutoTargetAxisByOrient(a,this._orient)),this._noTarget=!0,a.each(function(u){u.indexList.length&&(this._noTarget=!1)},this)},t.prototype._fillSpecifiedTargetAxis=function(r){var a=!1;return each$f(DATA_ZOOM_AXIS_DIMENSIONS,function(o){var u=this.getReferringComponents(getAxisMainType(o),MULTIPLE_REFERRING);if(u.specified){a=!0;var s=new DataZoomAxisInfo;each$f(u.models,function(c){s.add(c.componentIndex)}),r.set(o,s)}},this),a},t.prototype._fillAutoTargetAxisByOrient=function(r,a){var o=this.ecModel,u=!0;if(u){var s=a==="vertical"?"y":"x",c=o.findComponents({mainType:s+"Axis"});l(c,s)}if(u){var c=o.findComponents({mainType:"singleAxis",filter:function(f){return f.get("orient",!0)===a}});l(c,"single")}function l(d,f){var h=d[0];if(h){var v=new DataZoomAxisInfo;if(v.add(h.componentIndex),r.set(f,v),u=!1,f==="x"||f==="y"){var g=h.getReferringComponents("grid",SINGLE_REFERRING).models[0];g&&each$f(d,function(b){h.componentIndex!==b.componentIndex&&g===b.getReferringComponents("grid",SINGLE_REFERRING).models[0]&&v.add(b.componentIndex)})}}}u&&each$f(DATA_ZOOM_AXIS_DIMENSIONS,function(d){if(u){var f=o.findComponents({mainType:getAxisMainType(d),filter:function(v){return v.get("type",!0)==="category"}});if(f[0]){var h=new DataZoomAxisInfo;h.add(f[0].componentIndex),r.set(d,h),u=!1}}},this)},t.prototype._makeAutoOrientByTargetAxis=function(){var r;return this.eachTargetAxis(function(a){!r&&(r=a)},this),r==="y"?"vertical":"horizontal"},t.prototype._setDefaultThrottle=function(r){if(r.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var a=this.ecModel.option;this.option.throttle=a.animation&&a.animationDurationUpdate>0?100:20}},t.prototype._updateRangeUse=function(r){var a=this._rangePropMode,o=this.get("rangeMode");each$f([["start","startValue"],["end","endValue"]],function(u,s){var c=r[u[0]]!=null,l=r[u[1]]!=null;c&&!l?a[s]="percent":!c&&l?a[s]="value":o?a[s]=o[s]:c&&(a[s]="percent")})},t.prototype.noTarget=function(){return this._noTarget},t.prototype.getFirstTargetAxisModel=function(){var r;return this.eachTargetAxis(function(a,o){r==null&&(r=this.ecModel.getComponent(getAxisMainType(a),o))},this),r},t.prototype.eachTargetAxis=function(r,a){this._targetAxisInfoMap.each(function(o,u){each$f(o.indexList,function(s){r.call(a,u,s)})})},t.prototype.getAxisProxy=function(r,a){var o=this.getAxisModel(r,a);if(o)return o.__dzAxisProxy},t.prototype.getAxisModel=function(r,a){var o=this._targetAxisInfoMap.get(r);if(o&&o.indexMap[a])return this.ecModel.getComponent(getAxisMainType(r),a)},t.prototype.setRawRange=function(r){var a=this.option,o=this.settledOption;each$f([["start","startValue"],["end","endValue"]],function(u){(r[u[0]]!=null||r[u[1]]!=null)&&(a[u[0]]=o[u[0]]=r[u[0]],a[u[1]]=o[u[1]]=r[u[1]])},this),this._updateRangeUse(r)},t.prototype.setCalculatedRange=function(r){var a=this.option;each$f(["start","startValue","end","endValue"],function(o){a[o]=r[o]})},t.prototype.getPercentRange=function(){var r=this.findRepresentativeAxisProxy();if(r)return r.getDataPercentWindow()},t.prototype.getValueRange=function(r,a){if(r==null&&a==null){var o=this.findRepresentativeAxisProxy();if(o)return o.getDataValueWindow()}else return this.getAxisProxy(r,a).getDataValueWindow()},t.prototype.findRepresentativeAxisProxy=function(r){if(r)return r.__dzAxisProxy;for(var a,o=this._targetAxisInfoMap.keys(),u=0;u<o.length;u++)for(var s=o[u],c=this._targetAxisInfoMap.get(s),l=0;l<c.indexList.length;l++){var d=this.getAxisProxy(s,c.indexList[l]);if(d.hostedBy(this))return d;a||(a=d)}return a},t.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},t.prototype.getOrient=function(){return this._orient},t.type="dataZoom",t.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],t.defaultOption={z:4,filterMode:"filter",start:0,end:100},t}(ComponentModel);function retrieveRawOption(n){var t={};return each$f(["start","end","startValue","endValue","throttle"],function(r){n.hasOwnProperty(r)&&(t[r]=n[r])}),t}var SelectDataZoomModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(DataZoomModel),DataZoomView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o,u){this.dataZoomModel=r,this.ecModel=a,this.api=o},t.type="dataZoom",t}(ComponentView),SelectDataZoomView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(DataZoomView),each$7=each$f,asc$1=asc$2,AxisProxy=function(){function n(t,r,a,o){this._dimName=t,this._axisIndex=r,this.ecModel=o,this._dataZoomModel=a}return n.prototype.hostedBy=function(t){return this._dataZoomModel===t},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries(function(r){if(isCoordSupported(r)){var a=getAxisMainType(this._dimName),o=r.getReferringComponents(a,SINGLE_REFERRING).models[0];o&&this._axisIndex===o.componentIndex&&t.push(r)}},this),t},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return clone$5(this._minMaxSpan)},n.prototype.calculateDataWindow=function(t){var r=this._dataExtent,a=this.getAxisModel(),o=a.axis.scale,u=this._dataZoomModel.getRangePropMode(),s=[0,100],c=[],l=[],d;each$7(["start","end"],function(v,g){var b=t[v],_=t[v+"Value"];u[g]==="percent"?(b==null&&(b=s[g]),_=o.parse(linearMap$2(b,s,r))):(d=!0,_=_==null?r[g]:o.parse(_),b=linearMap$2(_,r,s)),l[g]=_==null||isNaN(_)?r[g]:_,c[g]=b==null||isNaN(b)?s[g]:b}),asc$1(l),asc$1(c);var f=this._minMaxSpan;d?h(l,c,r,s,!1):h(c,l,s,r,!0);function h(v,g,b,_,S){var T=S?"Span":"ValueSpan";sliderMove(0,v,b,"all",f["min"+T],f["max"+T]);for(var w=0;w<2;w++)g[w]=linearMap$2(v[w],b,_,!0),S&&(g[w]=o.parse(g[w]))}return{valueWindow:l,percentWindow:c}},n.prototype.reset=function(t){if(t===this._dataZoomModel){var r=this.getTargetSeriesModels();this._dataExtent=calculateDataExtent(this,this._dimName,r),this._updateMinMaxSpan();var a=this.calculateDataWindow(t.settledOption);this._valueWindow=a.valueWindow,this._percentWindow=a.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(t,r){if(t!==this._dataZoomModel)return;var a=this._dimName,o=this.getTargetSeriesModels(),u=t.get("filterMode"),s=this._valueWindow;if(u==="none")return;each$7(o,function(l){var d=l.getData(),f=d.mapDimensionsAll(a);if(f.length){if(u==="weakFilter"){var h=d.getStore(),v=map$1(f,function(g){return d.getDimensionIndex(g)},d);d.filterSelf(function(g){for(var b,_,S,T=0;T<f.length;T++){var w=h.get(v[T],g),A=!isNaN(w),R=w<s[0],E=w>s[1];if(A&&!R&&!E)return!0;A&&(S=!0),R&&(b=!0),E&&(_=!0)}return S&&b&&_})}else each$7(f,function(g){if(u==="empty")l.setData(d=d.map(g,function(_){return c(_)?_:NaN}));else{var b={};b[g]=s,d.selectRange(b)}});each$7(f,function(g){d.setApproximateExtent(s,g)})}});function c(l){return l>=s[0]&&l<=s[1]}},n.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},r=this._dataZoomModel,a=this._dataExtent;each$7(["min","max"],function(o){var u=r.get(o+"Span"),s=r.get(o+"ValueSpan");s!=null&&(s=this.getAxisModel().axis.scale.parse(s)),s!=null?u=linearMap$2(a[0]+s,a,[0,100],!0):u!=null&&(s=linearMap$2(u,[0,100],a,!0)-a[0]),t[o+"Span"]=u,t[o+"ValueSpan"]=s},this)},n.prototype._setAxisModel=function(){var t=this.getAxisModel(),r=this._percentWindow,a=this._valueWindow;if(r){var o=getPixelPrecision(a,[0,500]);o=Math.min(o,20);var u=t.axis.scale.rawExtentInfo;r[0]!==0&&u.setDeterminedMinMax("min",+a[0].toFixed(o)),r[1]!==100&&u.setDeterminedMinMax("max",+a[1].toFixed(o)),u.freeze()}},n}();function calculateDataExtent(n,t,r){var a=[1/0,-1/0];each$7(r,function(s){unionAxisExtentFromData(a,s.getData(),t)});var o=n.getAxisModel(),u=ensureScaleRawExtentInfo(o.axis.scale,o,a).calculate();return[u.min,u.max]}var dataZoomProcessor={getTargetSeries:function(n){function t(o){n.eachComponent("dataZoom",function(u){u.eachTargetAxis(function(s,c){var l=n.getComponent(getAxisMainType(s),c);o(s,c,l,u)})})}t(function(o,u,s,c){s.__dzAxisProxy=null});var r=[];t(function(o,u,s,c){s.__dzAxisProxy||(s.__dzAxisProxy=new AxisProxy(o,u,c,n),r.push(s.__dzAxisProxy))});var a=createHashMap();return each$f(r,function(o){each$f(o.getTargetSeriesModels(),function(u){a.set(u.uid,u)})}),a},overallReset:function(n,t){n.eachComponent("dataZoom",function(r){r.eachTargetAxis(function(a,o){r.getAxisProxy(a,o).reset(r)}),r.eachTargetAxis(function(a,o){r.getAxisProxy(a,o).filterData(r,t)})}),n.eachComponent("dataZoom",function(r){var a=r.findRepresentativeAxisProxy();if(a){var o=a.getDataPercentWindow(),u=a.getDataValueWindow();r.setCalculatedRange({start:o[0],end:o[1],startValue:u[0],endValue:u[1]})}})}};function installDataZoomAction(n){n.registerAction("dataZoom",function(t,r){var a=findEffectedDataZooms(r,t);each$f(a,function(o){o.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})})}var installed$1=!1;function installCommon$1(n){installed$1||(installed$1=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,dataZoomProcessor),installDataZoomAction(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function install$k(n){n.registerComponentModel(SelectDataZoomModel),n.registerComponentView(SelectDataZoomView),installCommon$1(n)}var ToolboxFeature=function(){function n(){}return n}(),features={};function registerFeature(n,t){features[n]=t}function getFeature(n){return features[n]}var ToolboxModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var r=this.ecModel;each$f(this.option.feature,function(a,o){var u=getFeature(o);u&&(u.getDefaultOption&&(u.defaultOption=u.getDefaultOption(r)),merge$3(a,u.defaultOption))})},t.type="toolbox",t.layoutMode={type:"box",ignoreSize:!0},t.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},t}(ComponentModel);function layout$2(n,t,r){var a=t.getBoxLayoutParams(),o=t.get("padding"),u={width:r.getWidth(),height:r.getHeight()},s=getLayoutRect(a,u,o);box(t.get("orient"),n,t.get("itemGap"),s.width,s.height),positionElement(n,a,u,o)}function makeBackground(n,t){var r=normalizeCssArray(t.get("padding")),a=t.getItemStyle(["color","opacity"]);return a.fill=t.get("backgroundColor"),n=new Rect$2({shape:{x:n.x-r[3],y:n.y-r[0],width:n.width+r[1]+r[3],height:n.height+r[0]+r[2],r:t.get("borderRadius")},style:a,silent:!0,z2:-1}),n}var ToolboxView=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(r,a,o,u){var s=this.group;if(s.removeAll(),!r.get("show"))return;var c=+r.get("itemSize"),l=r.get("orient")==="vertical",d=r.get("feature")||{},f=this._features||(this._features={}),h=[];each$f(d,function(b,_){h.push(_)}),new DataDiffer(this._featureNames||[],h).add(v).update(v).remove(curry$1(v,null)).execute(),this._featureNames=h;function v(b,_){var S=h[b],T=h[_],w=d[S],A=new Model(w,r,r.ecModel),R;if(u&&u.newTitle!=null&&u.featureName===S&&(w.title=u.newTitle),S&&!T){if(isUserFeatureName(S))R={onclick:A.option.onclick,featureName:S};else{var E=getFeature(S);if(!E)return;R=new E}f[S]=R}else if(R=f[T],!R)return;R.uid=getUID("toolbox-feature"),R.model=A,R.ecModel=a,R.api=o;var I=R instanceof ToolboxFeature;if(!S&&T){I&&R.dispose&&R.dispose(a,o);return}if(!A.get("show")||I&&R.unusable){I&&R.remove&&R.remove(a,o);return}g(A,R,S),A.setIconStatus=function(L,F){var D=this.option,$=this.iconPaths;D.iconStatus=D.iconStatus||{},D.iconStatus[L]=F,$[L]&&(F==="emphasis"?enterEmphasis:leaveEmphasis)($[L])},R instanceof ToolboxFeature&&R.render&&R.render(A,a,o,u)}function g(b,_,S){var T=b.getModel("iconStyle"),w=b.getModel(["emphasis","iconStyle"]),A=_ instanceof ToolboxFeature&&_.getIcons?_.getIcons():b.get("icon"),R=b.get("title")||{},E,I;isString(A)?(E={},E[S]=A):E=A,isString(R)?(I={},I[S]=R):I=R;var L=b.iconPaths={};each$f(E,function(F,D){var $=createIcon(F,{},{x:-c/2,y:-c/2,width:c,height:c});$.setStyle(T.getItemStyle());var O=$.ensureState("emphasis");O.style=w.getItemStyle();var P=new ZRText({style:{text:I[D],align:w.get("textAlign"),borderRadius:w.get("textBorderRadius"),padding:w.get("textPadding"),fill:null,font:getFont({fontStyle:w.get("textFontStyle"),fontFamily:w.get("textFontFamily"),fontSize:w.get("textFontSize"),fontWeight:w.get("textFontWeight")},a)},ignore:!0});$.setTextContent(P),setTooltipConfig({el:$,componentModel:r,itemName:D,formatterParamsExtra:{title:I[D]}}),$.__title=I[D],$.on("mouseover",function(){var C=w.getItemStyle(),q=l?r.get("right")==null&&r.get("left")!=="right"?"right":"left":r.get("bottom")==null&&r.get("top")!=="bottom"?"bottom":"top";P.setStyle({fill:w.get("textFill")||C.fill||C.stroke||"#000",backgroundColor:w.get("textBackgroundColor")}),$.setTextConfig({position:w.get("textPosition")||q}),P.ignore=!r.get("showTitle"),o.enterEmphasis(this)}).on("mouseout",function(){b.get(["iconStatus",D])!=="emphasis"&&o.leaveEmphasis(this),P.hide()}),(b.get(["iconStatus",D])==="emphasis"?enterEmphasis:leaveEmphasis)($),s.add($),$.on("click",bind$1(_.onclick,_,a,o,D)),L[D]=$})}layout$2(s,r,o),s.add(makeBackground(s.getBoundingRect(),r)),l||s.eachChild(function(b){var _=b.__title,S=b.ensureState("emphasis"),T=S.textConfig||(S.textConfig={}),w=b.getTextContent(),A=w&&w.ensureState("emphasis");if(A&&!isFunction$1(A)&&_){var R=A.style||(A.style={}),E=getBoundingRect(_,ZRText.makeFont(R)),I=b.x+s.x,L=b.y+s.y+c,F=!1;L+E.height>o.getHeight()&&(T.position="top",F=!0);var D=F?-5-E.height:c+10;I+E.width/2>o.getWidth()?(T.position=["100%",D],R.align="right"):I-E.width/2<0&&(T.position=[0,D],R.align="left")}})},t.prototype.updateView=function(r,a,o,u){each$f(this._features,function(s){s instanceof ToolboxFeature&&s.updateView&&s.updateView(s.model,a,o,u)})},t.prototype.remove=function(r,a){each$f(this._features,function(o){o instanceof ToolboxFeature&&o.remove&&o.remove(r,a)}),this.group.removeAll()},t.prototype.dispose=function(r,a){each$f(this._features,function(o){o instanceof ToolboxFeature&&o.dispose&&o.dispose(r,a)})},t.type="toolbox",t}(ComponentView);function isUserFeatureName(n){return n.indexOf("my")===0}var SaveAsImage=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(r,a){var o=this.model,u=o.get("name")||r.get("title.0.text")||"echarts",s=a.getZr().painter.getType()==="svg",c=s?"svg":o.get("type",!0)||"png",l=a.getConnectedDataURL({type:c,backgroundColor:o.get("backgroundColor",!0)||r.get("backgroundColor")||"#fff",connectedBackgroundColor:o.get("connectedBackgroundColor"),excludeComponents:o.get("excludeComponents"),pixelRatio:o.get("pixelRatio")}),d=env.browser;if(typeof MouseEvent=="function"&&(d.newEdge||!d.ie&&!d.edge)){var f=document.createElement("a");f.download=u+"."+c,f.target="_blank",f.href=l;var h=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});f.dispatchEvent(h)}else if(window.navigator.msSaveOrOpenBlob||s){var v=l.split(","),g=v[0].indexOf("base64")>-1,b=s?decodeURIComponent(v[1]):v[1];g&&(b=window.atob(b));var _=u+"."+c;if(window.navigator.msSaveOrOpenBlob){for(var S=b.length,T=new Uint8Array(S);S--;)T[S]=b.charCodeAt(S);var w=new Blob([T]);window.navigator.msSaveOrOpenBlob(w,_)}else{var A=document.createElement("iframe");document.body.appendChild(A);var R=A.contentWindow,E=R.document;E.open("image/svg+xml","replace"),E.write(b),E.close(),R.focus(),E.execCommand("SaveAs",!0,_),document.body.removeChild(A)}}else{var I=o.get("lang"),L='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(I&&I[0]||"")+'" /></body>',F=window.open();F.document.write(L),F.document.title=u}},t.getDefaultOption=function(r){var a={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:r.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:r.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return a},t}(ToolboxFeature),INNER_STACK_KEYWORD="__ec_magicType_stack__",radioTypes=[["line","bar"],["stack"]],MagicType=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getIcons=function(){var r=this.model,a=r.get("icon"),o={};return each$f(r.get("type"),function(u){a[u]&&(o[u]=a[u])}),o},t.getDefaultOption=function(r){var a={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:r.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return a},t.prototype.onclick=function(r,a,o){var u=this.model,s=u.get(["seriesIndex",o]);if(seriesOptGenreator[o]){var c={series:[]},l=function(h){var v=h.subType,g=h.id,b=seriesOptGenreator[o](v,g,h,u);b&&(defaults$h(b,h.option),c.series.push(b));var _=h.coordinateSystem;if(_&&_.type==="cartesian2d"&&(o==="line"||o==="bar")){var S=_.getAxesByScale("ordinal")[0];if(S){var T=S.dim,w=T+"Axis",A=h.getReferringComponents(w,SINGLE_REFERRING).models[0],R=A.componentIndex;c[w]=c[w]||[];for(var E=0;E<=R;E++)c[w][R]=c[w][R]||{};c[w][R].boundaryGap=o==="bar"}}};each$f(radioTypes,function(h){indexOf(h,o)>=0&&each$f(h,function(v){u.setIconStatus(v,"normal")})}),u.setIconStatus(o,"emphasis"),r.eachComponent({mainType:"series",query:s==null?null:{seriesIndex:s}},l);var d,f=o;o==="stack"&&(d=merge$3({stack:u.option.title.tiled,tiled:u.option.title.stack},u.option.title),u.get(["iconStatus",o])!=="emphasis"&&(f="tiled")),a.dispatchAction({type:"changeMagicType",currentType:f,newOption:c,newTitle:d,featureName:"magicType"})}},t}(ToolboxFeature),seriesOptGenreator={line:function(n,t,r,a){if(n==="bar")return merge$3({id:t,type:"line",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},a.get(["option","line"])||{},!0)},bar:function(n,t,r,a){if(n==="line")return merge$3({id:t,type:"bar",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},a.get(["option","bar"])||{},!0)},stack:function(n,t,r,a){var o=r.get("stack")===INNER_STACK_KEYWORD;if(n==="line"||n==="bar")return a.setIconStatus("stack",o?"normal":"emphasis"),merge$3({id:t,stack:o?"":INNER_STACK_KEYWORD},a.get(["option","stack"])||{},!0)}};registerAction({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,t){t.mergeOption(n.newOption)});var BLOCK_SPLITER=new Array(60).join("-"),ITEM_SPLITER="	";function groupSeries(n){var t={},r=[],a=[];return n.eachRawSeries(function(o){var u=o.coordinateSystem;if(u&&(u.type==="cartesian2d"||u.type==="polar")){var s=u.getBaseAxis();if(s.type==="category"){var c=s.dim+"_"+s.index;t[c]||(t[c]={categoryAxis:s,valueAxis:u.getOtherAxis(s),series:[]},a.push({axisDim:s.dim,axisIndex:s.index})),t[c].series.push(o)}else r.push(o)}else r.push(o)}),{seriesGroupByCategoryAxis:t,other:r,meta:a}}function assembleSeriesWithCategoryAxis(n){var t=[];return each$f(n,function(r,a){var o=r.categoryAxis,u=r.valueAxis,s=u.dim,c=[" "].concat(map$1(r.series,function(g){return g.name})),l=[o.model.getCategories()];each$f(r.series,function(g){var b=g.getRawData();l.push(g.getRawData().mapArray(b.mapDimension(s),function(_){return _}))});for(var d=[c.join(ITEM_SPLITER)],f=0;f<l[0].length;f++){for(var h=[],v=0;v<l.length;v++)h.push(l[v][f]);d.push(h.join(ITEM_SPLITER))}t.push(d.join(`
`))}),t.join(`

`+BLOCK_SPLITER+`

`)}function assembleOtherSeries(n){return map$1(n,function(t){var r=t.getRawData(),a=[t.name],o=[];return r.each(r.dimensions,function(){for(var u=arguments.length,s=arguments[u-1],c=r.getName(s),l=0;l<u-1;l++)o[l]=arguments[l];a.push((c?c+ITEM_SPLITER:"")+o.join(ITEM_SPLITER))}),a.join(`
`)}).join(`

`+BLOCK_SPLITER+`

`)}function getContentFromModel(n){var t=groupSeries(n);return{value:filter$1([assembleSeriesWithCategoryAxis(t.seriesGroupByCategoryAxis),assembleOtherSeries(t.other)],function(r){return!!r.replace(/[\n\t\s]/g,"")}).join(`

`+BLOCK_SPLITER+`

`),meta:t.meta}}function trim(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function isTSVFormat(n){var t=n.slice(0,n.indexOf(`
`));if(t.indexOf(ITEM_SPLITER)>=0)return!0}var itemSplitRegex=new RegExp("["+ITEM_SPLITER+"]+","g");function parseTSVContents(n){for(var t=n.split(/\n+/g),r=trim(t.shift()).split(itemSplitRegex),a=[],o=map$1(r,function(l){return{name:l,data:[]}}),u=0;u<t.length;u++){var s=trim(t[u]).split(itemSplitRegex);a.push(s.shift());for(var c=0;c<s.length;c++)o[c]&&(o[c].data[u]=s[c])}return{series:o,categories:a}}function parseListContents(n){for(var t=n.split(/\n+/g),r=trim(t.shift()),a=[],o=0;o<t.length;o++){var u=trim(t[o]);if(u){var s=u.split(itemSplitRegex),c="",l=void 0,d=!1;isNaN(s[0])?(d=!0,c=s[0],s=s.slice(1),a[o]={name:c,value:[]},l=a[o].value):l=a[o]=[];for(var f=0;f<s.length;f++)l.push(+s[f]);l.length===1&&(d?a[o].value=l[0]:a[o]=l[0])}}return{name:r,data:a}}function parseContents(n,t){var r=n.split(new RegExp(`
*`+BLOCK_SPLITER+`
*`,"g")),a={series:[]};return each$f(r,function(o,u){if(isTSVFormat(o)){var s=parseTSVContents(o),c=t[u],l=c.axisDim+"Axis";c&&(a[l]=a[l]||[],a[l][c.axisIndex]={data:s.categories},a.series=a.series.concat(s.series))}else{var s=parseListContents(o);a.series.push(s)}}),a}var DataView$1=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(r,a){setTimeout(function(){a.dispatchAction({type:"hideTip"})});var o=a.getDom(),u=this.model;this._dom&&o.removeChild(this._dom);var s=document.createElement("div");s.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",s.style.backgroundColor=u.get("backgroundColor")||"#fff";var c=document.createElement("h4"),l=u.get("lang")||[];c.innerHTML=l[0]||u.get("title"),c.style.cssText="margin:10px 20px",c.style.color=u.get("textColor");var d=document.createElement("div"),f=document.createElement("textarea");d.style.cssText="overflow:auto";var h=u.get("optionToContent"),v=u.get("contentToOption"),g=getContentFromModel(r);if(isFunction$1(h)){var b=h(a.getOption());isString(b)?d.innerHTML=b:isDom(b)&&d.appendChild(b)}else{f.readOnly=u.get("readOnly");var _=f.style;_.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",_.color=u.get("textColor"),_.borderColor=u.get("textareaBorderColor"),_.backgroundColor=u.get("textareaColor"),f.value=g.value,d.appendChild(f)}var S=g.meta,T=document.createElement("div");T.style.cssText="position:absolute;bottom:5px;left:0;right:0";var w="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",A=document.createElement("div"),R=document.createElement("div");w+=";background-color:"+u.get("buttonColor"),w+=";color:"+u.get("buttonTextColor");var E=this;function I(){o.removeChild(s),E._dom=null}addEventListener(A,"click",I),addEventListener(R,"click",function(){if(v==null&&h!=null||v!=null&&h==null){I();return}var L;try{isFunction$1(v)?L=v(d,a.getOption()):L=parseContents(f.value,S)}catch(F){throw I(),new Error("Data view format error "+F)}L&&a.dispatchAction({type:"changeDataView",newOption:L}),I()}),A.innerHTML=l[1],R.innerHTML=l[2],R.style.cssText=A.style.cssText=w,!u.get("readOnly")&&T.appendChild(R),T.appendChild(A),s.appendChild(c),s.appendChild(d),s.appendChild(T),d.style.height=o.clientHeight-80+"px",o.appendChild(s),this._dom=s},t.prototype.remove=function(r,a){this._dom&&a.getDom().removeChild(this._dom)},t.prototype.dispose=function(r,a){this.remove(r,a)},t.getDefaultOption=function(r){var a={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:r.getLocaleModel().get(["toolbox","dataView","title"]),lang:r.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return a},t}(ToolboxFeature);function tryMergeDataOption(n,t){return map$1(n,function(r,a){var o=t&&t[a];if(isObject$4(o)&&!isArray$2(o)){var u=isObject$4(r)&&!isArray$2(r);u||(r={value:r});var s=o.name!=null&&r.name==null;return r=defaults$h(r,o),s&&delete r.name,r}else return r})}registerAction({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,t){var r=[];each$f(n.newOption.series,function(a){var o=t.getSeriesByName(a.name)[0];if(!o)r.push(extend$1({type:"scatter"},a));else{var u=o.get("data");r.push({name:a.name,data:tryMergeDataOption(a.data,u)})}}),t.mergeOption(defaults$h({series:r},n.newOption))});var each$6=each$f,inner$6=makeInner();function push$1(n,t){var r=getStoreSnapshots(n);each$6(t,function(a,o){for(var u=r.length-1;u>=0;u--){var s=r[u];if(s[o])break}if(u<0){var c=n.queryComponents({mainType:"dataZoom",subType:"select",id:o})[0];if(c){var l=c.getPercentRange();r[0][o]={dataZoomId:o,start:l[0],end:l[1]}}}}),r.push(t)}function pop(n){var t=getStoreSnapshots(n),r=t[t.length-1];t.length>1&&t.pop();var a={};return each$6(r,function(o,u){for(var s=t.length-1;s>=0;s--)if(o=t[s][u],o){a[u]=o;break}}),a}function clear(n){inner$6(n).snapshots=null}function count(n){return getStoreSnapshots(n).length}function getStoreSnapshots(n){var t=inner$6(n);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var RestoreOption=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(r,a){clear(r),a.dispatchAction({type:"restore",from:this.uid})},t.getDefaultOption=function(r){var a={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:r.getLocaleModel().get(["toolbox","restore","title"])};return a},t}(ToolboxFeature);registerAction({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,t){t.resetOption("recreate")});var INCLUDE_FINDER_MAIN_TYPES=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],BrushTargetManager=function(){function n(t,r,a){var o=this;this._targetInfoList=[];var u=parseFinder(r,t);each$f(targetInfoBuilders,function(s,c){(!a||!a.include||indexOf(a.include,c)>=0)&&s(u,o._targetInfoList)})}return n.prototype.setOutputRanges=function(t,r){return this.matchOutputRanges(t,r,function(a,o,u){if((a.coordRanges||(a.coordRanges=[])).push(o),!a.coordRange){a.coordRange=o;var s=coordConvert[a.brushType](0,u,o);a.__rangeOffset={offset:diffProcessor[a.brushType](s.values,a.range,[1,1]),xyMinMax:s.xyMinMax}}}),t},n.prototype.matchOutputRanges=function(t,r,a){each$f(t,function(o){var u=this.findTargetInfo(o,r);u&&u!==!0&&each$f(u.coordSyses,function(s){var c=coordConvert[o.brushType](1,s,o.range,!0);a(o,c.values,s,r)})},this)},n.prototype.setInputRanges=function(t,r){each$f(t,function(a){var o=this.findTargetInfo(a,r);if(a.range=a.range||[],o&&o!==!0){a.panelId=o.panelId;var u=coordConvert[a.brushType](0,o.coordSys,a.coordRange),s=a.__rangeOffset;a.range=s?diffProcessor[a.brushType](u.values,s.offset,getScales(u.xyMinMax,s.xyMinMax)):u.values}},this)},n.prototype.makePanelOpts=function(t,r){return map$1(this._targetInfoList,function(a){var o=a.getPanelRect();return{panelId:a.panelId,defaultBrushType:r?r(a):null,clipPath:makeRectPanelClipPath(o),isTargetByCursor:makeRectIsTargetByCursor(o,t,a.coordSysModel),getLinearBrushOtherExtent:makeLinearBrushOtherExtent(o)}})},n.prototype.controlSeries=function(t,r,a){var o=this.findTargetInfo(t,a);return o===!0||o&&indexOf(o.coordSyses,r.coordinateSystem)>=0},n.prototype.findTargetInfo=function(t,r){for(var a=this._targetInfoList,o=parseFinder(r,t),u=0;u<a.length;u++){var s=a[u],c=t.panelId;if(c){if(s.panelId===c)return s}else for(var l=0;l<targetInfoMatchers.length;l++)if(targetInfoMatchers[l](o,s))return s}return!0},n}();function formatMinMax(n){return n[0]>n[1]&&n.reverse(),n}function parseFinder(n,t){return parseFinder$1(n,t,{includeMainTypes:INCLUDE_FINDER_MAIN_TYPES})}var targetInfoBuilders={grid:function(n,t){var r=n.xAxisModels,a=n.yAxisModels,o=n.gridModels,u=createHashMap(),s={},c={};!r&&!a&&!o||(each$f(r,function(l){var d=l.axis.grid.model;u.set(d.id,d),s[d.id]=!0}),each$f(a,function(l){var d=l.axis.grid.model;u.set(d.id,d),c[d.id]=!0}),each$f(o,function(l){u.set(l.id,l),s[l.id]=!0,c[l.id]=!0}),u.each(function(l){var d=l.coordinateSystem,f=[];each$f(d.getCartesians(),function(h,v){(indexOf(r,h.getAxis("x").model)>=0||indexOf(a,h.getAxis("y").model)>=0)&&f.push(h)}),t.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:f[0],coordSyses:f,getPanelRect:panelRectBuilders.grid,xAxisDeclared:s[l.id],yAxisDeclared:c[l.id]})}))},geo:function(n,t){each$f(n.geoModels,function(r){var a=r.coordinateSystem;t.push({panelId:"geo--"+r.id,geoModel:r,coordSysModel:r,coordSys:a,coordSyses:[a],getPanelRect:panelRectBuilders.geo})})}},targetInfoMatchers=[function(n,t){var r=n.xAxisModel,a=n.yAxisModel,o=n.gridModel;return!o&&r&&(o=r.axis.grid.model),!o&&a&&(o=a.axis.grid.model),o&&o===t.gridModel},function(n,t){var r=n.geoModel;return r&&r===t.geoModel}],panelRectBuilders={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,t=n.getBoundingRect().clone();return t.applyTransform(getTransform$1(n)),t}},coordConvert={lineX:curry$1(axisConvert,0),lineY:curry$1(axisConvert,1),rect:function(n,t,r,a){var o=n?t.pointToData([r[0][0],r[1][0]],a):t.dataToPoint([r[0][0],r[1][0]],a),u=n?t.pointToData([r[0][1],r[1][1]],a):t.dataToPoint([r[0][1],r[1][1]],a),s=[formatMinMax([o[0],u[0]]),formatMinMax([o[1],u[1]])];return{values:s,xyMinMax:s}},polygon:function(n,t,r,a){var o=[[1/0,-1/0],[1/0,-1/0]],u=map$1(r,function(s){var c=n?t.pointToData(s,a):t.dataToPoint(s,a);return o[0][0]=Math.min(o[0][0],c[0]),o[1][0]=Math.min(o[1][0],c[1]),o[0][1]=Math.max(o[0][1],c[0]),o[1][1]=Math.max(o[1][1],c[1]),c});return{values:u,xyMinMax:o}}};function axisConvert(n,t,r,a){var o=r.getAxis(["x","y"][n]),u=formatMinMax(map$1([0,1],function(c){return t?o.coordToData(o.toLocalCoord(a[c]),!0):o.toGlobalCoord(o.dataToCoord(a[c]))})),s=[];return s[n]=u,s[1-n]=[NaN,NaN],{values:u,xyMinMax:s}}var diffProcessor={lineX:curry$1(axisDiffProcessor,0),lineY:curry$1(axisDiffProcessor,1),rect:function(n,t,r){return[[n[0][0]-r[0]*t[0][0],n[0][1]-r[0]*t[0][1]],[n[1][0]-r[1]*t[1][0],n[1][1]-r[1]*t[1][1]]]},polygon:function(n,t,r){return map$1(n,function(a,o){return[a[0]-r[0]*t[o][0],a[1]-r[1]*t[o][1]]})}};function axisDiffProcessor(n,t,r,a){return[t[0]-a[n]*r[0],t[1]-a[n]*r[1]]}function getScales(n,t){var r=getSize(n),a=getSize(t),o=[r[0]/a[0],r[1]/a[1]];return isNaN(o[0])&&(o[0]=1),isNaN(o[1])&&(o[1]=1),o}function getSize(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var each$5=each$f,DATA_ZOOM_ID_BASE=makeInternalComponentId("toolbox-dataZoom_"),DataZoomFeature=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(r,a,o,u){this._brushController||(this._brushController=new BrushController(o.getZr()),this._brushController.on("brush",bind$1(this._onBrush,this)).mount()),updateZoomBtnStatus(r,a,this,u,o),updateBackBtnStatus(r,a)},t.prototype.onclick=function(r,a,o){handlers[o].call(this)},t.prototype.remove=function(r,a){this._brushController&&this._brushController.unmount()},t.prototype.dispose=function(r,a){this._brushController&&this._brushController.dispose()},t.prototype._onBrush=function(r){var a=r.areas;if(!r.isEnd||!a.length)return;var o={},u=this.ecModel;this._brushController.updateCovers([]);var s=new BrushTargetManager(makeAxisFinder(this.model),u,{include:["grid"]});s.matchOutputRanges(a,u,function(d,f,h){if(h.type==="cartesian2d"){var v=d.brushType;v==="rect"?(c("x",h,f[0]),c("y",h,f[1])):c({lineX:"x",lineY:"y"}[v],h,f)}}),push$1(u,o),this._dispatchZoomAction(o);function c(d,f,h){var v=f.getAxis(d),g=v.model,b=l(d,g,u),_=b.findRepresentativeAxisProxy(g).getMinMaxSpan();(_.minValueSpan!=null||_.maxValueSpan!=null)&&(h=sliderMove(0,h.slice(),v.scale.getExtent(),0,_.minValueSpan,_.maxValueSpan)),b&&(o[b.id]={dataZoomId:b.id,startValue:h[0],endValue:h[1]})}function l(d,f,h){var v;return h.eachComponent({mainType:"dataZoom",subType:"select"},function(g){var b=g.getAxisModel(d,f.componentIndex);b&&(v=g)}),v}},t.prototype._dispatchZoomAction=function(r){var a=[];each$5(r,function(o,u){a.push(clone$5(o))}),a.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:a})},t.getDefaultOption=function(r){var a={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:r.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return a},t}(ToolboxFeature),handlers={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction(pop(this.ecModel))}};function makeAxisFinder(n){var t={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return t.xAxisIndex==null&&t.xAxisId==null&&(t.xAxisIndex="all"),t.yAxisIndex==null&&t.yAxisId==null&&(t.yAxisIndex="all"),t}function updateBackBtnStatus(n,t){n.setIconStatus("back",count(t)>1?"emphasis":"normal")}function updateZoomBtnStatus(n,t,r,a,o){var u=r._isZoomActive;a&&a.type==="takeGlobalCursor"&&(u=a.key==="dataZoomSelect"?a.dataZoomSelectActive:!1),r._isZoomActive=u,n.setIconStatus("zoom",u?"emphasis":"normal");var s=new BrushTargetManager(makeAxisFinder(n),t,{include:["grid"]}),c=s.makePanelOpts(o,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});r._brushController.setPanels(c).enableBrush(u&&c.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}registerInternalOptionCreator("dataZoom",function(n){var t=n.getComponent("toolbox",0),r=["feature","dataZoom"];if(!t||t.get(r)==null)return;var a=t.getModel(r),o=[],u=makeAxisFinder(a),s=parseFinder$1(n,u);each$5(s.xAxisModels,function(l){return c(l,"xAxis","xAxisIndex")}),each$5(s.yAxisModels,function(l){return c(l,"yAxis","yAxisIndex")});function c(l,d,f){var h=l.componentIndex,v={type:"select",$fromToolbox:!0,filterMode:a.get("filterMode",!0)||"filter",id:DATA_ZOOM_ID_BASE+d+h};v[f]=h,o.push(v)}return o});function install$j(n){n.registerComponentModel(ToolboxModel),n.registerComponentView(ToolboxView),registerFeature("saveAsImage",SaveAsImage),registerFeature("magicType",MagicType),registerFeature("dataView",DataView$1),registerFeature("dataZoom",DataZoomFeature),registerFeature("restore",RestoreOption),use(install$k)}var TooltipModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(ComponentModel);function shouldTooltipConfine(n){var t=n.get("confine");return t!=null?!!t:n.get("renderMode")==="richText"}function testStyle(n){if(env.domSupported){for(var t=document.documentElement.style,r=0,a=n.length;r<a;r++)if(n[r]in t)return n[r]}}var TRANSFORM_VENDOR=testStyle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),TRANSITION_VENDOR=testStyle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function toCSSVendorPrefix(n,t){if(!n)return t;t=toCamelCase(t,!0);var r=n.indexOf(t);return n=r===-1?t:"-"+n.slice(0,r)+"-"+t,n.toLowerCase()}function getComputedStyle(n,t){var r=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return r?r[t]:null}var CSS_TRANSITION_VENDOR=toCSSVendorPrefix(TRANSITION_VENDOR,"transition"),CSS_TRANSFORM_VENDOR=toCSSVendorPrefix(TRANSFORM_VENDOR,"transform"),gCssText="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(env.transform3dSupported?"will-change:transform;":"");function mirrorPos(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function assembleArrow(n,t,r){if(!isString(r)||r==="inside")return"";var a=n.get("backgroundColor"),o=n.get("borderWidth");t=convertToColorString(t);var u=mirrorPos(r),s=Math.max(Math.round(o)*1.5,6),c="",l=CSS_TRANSFORM_VENDOR+":",d;indexOf(["left","right"],u)>-1?(c+="top:50%",l+="translateY(-50%) rotate("+(d=u==="left"?-225:-45)+"deg)"):(c+="left:50%",l+="translateX(-50%) rotate("+(d=u==="top"?225:45)+"deg)");var f=d*Math.PI/180,h=s+o,v=h*Math.abs(Math.cos(f))+h*Math.abs(Math.sin(f)),g=Math.round(((v-Math.SQRT2*o)/2+Math.SQRT2*o-(v-h)/2)*100)/100;c+=";"+u+":-"+g+"px";var b=t+" solid "+o+"px;",_=["position:absolute;width:"+s+"px;height:"+s+"px;z-index:-1;",c+";"+l+";","border-bottom:"+b,"border-right:"+b,"background-color:"+a+";"];return'<div style="'+_.join("")+'"></div>'}function assembleTransition(n,t){var r="cubic-bezier(0.23,1,0.32,1)",a=" "+n/2+"s "+r,o="opacity"+a+",visibility"+a;return t||(a=" "+n+"s "+r,o+=env.transformSupported?","+CSS_TRANSFORM_VENDOR+a:",left"+a+",top"+a),CSS_TRANSITION_VENDOR+":"+o}function assembleTransform(n,t,r){var a=n.toFixed(0)+"px",o=t.toFixed(0)+"px";if(!env.transformSupported)return r?"top:"+o+";left:"+a+";":[["top",o],["left",a]];var u=env.transform3dSupported,s="translate"+(u?"3d":"")+"("+a+","+o+(u?",0":"")+")";return r?"top:0;left:0;"+CSS_TRANSFORM_VENDOR+":"+s+";":[["top",0],["left",0],[TRANSFORM_VENDOR,s]]}function assembleFont(n){var t=[],r=n.get("fontSize"),a=n.getTextColor();a&&t.push("color:"+a),t.push("font:"+n.getFont());var o=retrieve2(n.get("lineHeight"),Math.round(r*3/2));r&&t.push("line-height:"+o+"px");var u=n.get("textShadowColor"),s=n.get("textShadowBlur")||0,c=n.get("textShadowOffsetX")||0,l=n.get("textShadowOffsetY")||0;return u&&s&&t.push("text-shadow:"+c+"px "+l+"px "+s+"px "+u),each$f(["decoration","align"],function(d){var f=n.get(d);f&&t.push("text-"+d+":"+f)}),t.join(";")}function assembleCssText(n,t,r){var a=[],o=n.get("transitionDuration"),u=n.get("backgroundColor"),s=n.get("shadowBlur"),c=n.get("shadowColor"),l=n.get("shadowOffsetX"),d=n.get("shadowOffsetY"),f=n.getModel("textStyle"),h=getPaddingFromTooltipModel(n,"html"),v=l+"px "+d+"px "+s+"px "+c;return a.push("box-shadow:"+v),t&&o&&a.push(assembleTransition(o,r)),u&&a.push("background-color:"+u),each$f(["width","color","radius"],function(g){var b="border-"+g,_=toCamelCase(b),S=n.get(_);S!=null&&a.push(b+":"+S+(g==="color"?"":"px"))}),a.push(assembleFont(f)),h!=null&&a.push("padding:"+normalizeCssArray(h).join("px ")+"px"),a.join(";")+";"}function makeStyleCoord$1(n,t,r,a,o){var u=t&&t.painter;if(r){var s=u&&u.getViewportRoot();s&&transformLocalCoord(n,s,r,a,o)}else{n[0]=a,n[1]=o;var c=u&&u.getViewportRootOffset();c&&(n[0]+=c.offsetLeft,n[1]+=c.offsetTop)}n[2]=n[0]/t.getWidth(),n[3]=n[1]/t.getHeight()}var TooltipHTMLContent=function(){function n(t,r){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,env.wxa)return null;var a=document.createElement("div");a.domBelongToZr=!0,this.el=a;var o=this._zr=t.getZr(),u=r.appendTo,s=u&&(isString(u)?document.querySelector(u):isDom(u)?u:isFunction$1(u)&&u(t.getDom()));makeStyleCoord$1(this._styleCoord,o,s,t.getWidth()/2,t.getHeight()/2),(s||t.getDom()).appendChild(a),this._api=t,this._container=s;var c=this;a.onmouseenter=function(){c._enterable&&(clearTimeout(c._hideTimeout),c._show=!0),c._inContent=!0},a.onmousemove=function(l){if(l=l||window.event,!c._enterable){var d=o.handler,f=o.painter.getViewportRoot();normalizeEvent(f,l,!0),d.dispatch("mousemove",l)}},a.onmouseleave=function(){c._inContent=!1,c._enterable&&c._show&&c.hideLater(c._hideDelay)}}return n.prototype.update=function(t){if(!this._container){var r=this._api.getDom(),a=getComputedStyle(r,"position"),o=r.style;o.position!=="absolute"&&a!=="absolute"&&(o.position="relative")}var u=t.get("alwaysShowContent");u&&this._moveIfResized(),this._alwaysShowContent=u,this.el.className=t.get("className")||""},n.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var a=this.el,o=a.style,u=this._styleCoord;a.innerHTML?o.cssText=gCssText+assembleCssText(t,!this._firstShow,this._longHide)+assembleTransform(u[0],u[1],!0)+("border-color:"+convertToColorString(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):o.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(t,r,a,o,u){var s=this.el;if(t==null){s.innerHTML="";return}var c="";if(isString(u)&&a.get("trigger")==="item"&&!shouldTooltipConfine(a)&&(c=assembleArrow(a,o,u)),isString(t))s.innerHTML=t+c;else if(t){s.innerHTML="",isArray$2(t)||(t=[t]);for(var l=0;l<t.length;l++)isDom(t[l])&&t[l].parentNode!==s&&s.appendChild(t[l]);if(c&&s.childNodes.length){var d=document.createElement("div");d.innerHTML=c,s.appendChild(d)}}},n.prototype.setEnterable=function(t){this._enterable=t},n.prototype.getSize=function(){var t=this.el;return t?[t.offsetWidth,t.offsetHeight]:[0,0]},n.prototype.moveTo=function(t,r){if(this.el){var a=this._styleCoord;if(makeStyleCoord$1(a,this._zr,this._container,t,r),a[0]!=null&&a[1]!=null){var o=this.el.style,u=assembleTransform(a[0],a[1]);each$f(u,function(s){o[s[0]]=s[1]})}}},n.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},n.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",env.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},n.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(bind$1(this.hide,this),t)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var t=this.el.parentNode;t&&t.removeChild(this.el),this.el=this._container=null},n}(),TooltipRichContent=function(){function n(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),makeStyleCoord(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return n.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(t,r,a,o,u){var s=this;isObject$4(t)&&throwError(""),this.el&&this._zr.remove(this.el);var c=a.getModel("textStyle");this.el=new ZRText({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:o,textShadowColor:c.get("textShadowColor"),fill:a.get(["textStyle","color"]),padding:getPaddingFromTooltipModel(a,"richText"),verticalAlign:"top",align:"left"},z:a.get("z")}),each$f(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(d){s.el.style[d]=a.get(d)}),each$f(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(d){s.el.style[d]=c.get(d)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},n.prototype.setEnterable=function(t){this._enterable=t},n.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),a=calcShadowOuterSize(t.style);return[r.width+a.left+a.right,r.height+a.top+a.bottom]},n.prototype.moveTo=function(t,r){var a=this.el;if(a){var o=this._styleCoord;makeStyleCoord(o,this._zr,t,r),t=o[0],r=o[1];var u=a.style,s=mathMaxWith0(u.borderWidth||0),c=calcShadowOuterSize(u);a.x=t+s+c.left,a.y=r+s+c.top,a.markRedraw()}},n.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(bind$1(this.hide,this),t)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function mathMaxWith0(n){return Math.max(0,n)}function calcShadowOuterSize(n){var t=mathMaxWith0(n.shadowBlur||0),r=mathMaxWith0(n.shadowOffsetX||0),a=mathMaxWith0(n.shadowOffsetY||0);return{left:mathMaxWith0(t-r),right:mathMaxWith0(t+r),top:mathMaxWith0(t-a),bottom:mathMaxWith0(t+a)}}function makeStyleCoord(n,t,r,a){n[0]=r,n[1]=a,n[2]=n[0]/t.getWidth(),n[3]=n[1]/t.getHeight()}var proxyRect=new Rect$2({shape:{x:-1,y:-1,width:2,height:2}}),TooltipView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a){if(!(env.node||!a.getDom())){var o=r.getComponent("tooltip"),u=this._renderMode=getTooltipRenderMode(o.get("renderMode"));this._tooltipContent=u==="richText"?new TooltipRichContent(a):new TooltipHTMLContent(a,{appendTo:o.get("appendToBody",!0)?"body":o.get("appendTo",!0)})}},t.prototype.render=function(r,a,o){if(!(env.node||!o.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=a,this._api=o;var u=this._tooltipContent;u.update(r),u.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?createOrUpdate(this,"_updatePosition",50,"fixRate"):clear$1(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,a=r.get("triggerOn");register("itemTooltip",this._api,bind$1(function(o,u,s){a!=="none"&&(a.indexOf(o)>=0?this._tryShow(u,s):o==="leave"&&this._hide(s))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,a=this._ecModel,o=this._api,u=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&u!=="none"&&u!=="click"){var s=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!o.isDisposed()&&s.manuallyShowTip(r,a,o,{x:s._lastX,y:s._lastY,dataByCoordSys:s._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,a,o,u){if(!(u.from===this.uid||env.node||!o.getDom())){var s=makeDispatchAction(u,o);this._ticket="";var c=u.dataByCoordSys,l=findComponentReference(u,a,o);if(l){var d=l.el.getBoundingRect().clone();d.applyTransform(l.el.transform),this._tryShow({offsetX:d.x+d.width/2,offsetY:d.y+d.height/2,target:l.el,position:u.position,positionDefault:"bottom"},s)}else if(u.tooltip&&u.x!=null&&u.y!=null){var f=proxyRect;f.x=u.x,f.y=u.y,f.update(),getECData(f).tooltipConfig={name:null,option:u.tooltip},this._tryShow({offsetX:u.x,offsetY:u.y,target:f},s)}else if(c)this._tryShow({offsetX:u.x,offsetY:u.y,position:u.position,dataByCoordSys:c,tooltipOption:u.tooltipOption},s);else if(u.seriesIndex!=null){if(this._manuallyAxisShowTip(r,a,o,u))return;var h=findPointFromSeries(u,a),v=h.point[0],g=h.point[1];v!=null&&g!=null&&this._tryShow({offsetX:v,offsetY:g,target:h.el,position:u.position,positionDefault:"bottom"},s)}else u.x!=null&&u.y!=null&&(o.dispatchAction({type:"updateAxisPointer",x:u.x,y:u.y}),this._tryShow({offsetX:u.x,offsetY:u.y,position:u.position,target:o.getZr().findHover(u.x,u.y).target},s))}},t.prototype.manuallyHideTip=function(r,a,o,u){var s=this._tooltipContent;this._tooltipModel&&s.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,u.from!==this.uid&&this._hide(makeDispatchAction(u,o))},t.prototype._manuallyAxisShowTip=function(r,a,o,u){var s=u.seriesIndex,c=u.dataIndex,l=a.getComponent("axisPointer").coordSysAxesInfo;if(!(s==null||c==null||l==null)){var d=a.getSeriesByIndex(s);if(d){var f=d.getData(),h=buildTooltipModel([f.getItemModel(c),d,(d.coordinateSystem||{}).model],this._tooltipModel);if(h.get("trigger")==="axis")return o.dispatchAction({type:"updateAxisPointer",seriesIndex:s,dataIndex:c,position:u.position}),!0}}},t.prototype._tryShow=function(r,a){var o=r.target,u=this._tooltipModel;if(u){this._lastX=r.offsetX,this._lastY=r.offsetY;var s=r.dataByCoordSys;if(s&&s.length)this._showAxisTooltip(s,r);else if(o){var c=getECData(o);if(c.ssrType==="legend")return;this._lastDataByCoordSys=null;var l,d;findEventDispatcher(o,function(f){if(getECData(f).dataIndex!=null)return l=f,!0;if(getECData(f).tooltipConfig!=null)return d=f,!0},!0),l?this._showSeriesItemTooltip(r,l,a):d?this._showComponentItemTooltip(r,d,a):this._hide(a)}else this._lastDataByCoordSys=null,this._hide(a)}},t.prototype._showOrMove=function(r,a){var o=r.get("showDelay");a=bind$1(a,this),clearTimeout(this._showTimout),o>0?this._showTimout=setTimeout(a,o):a()},t.prototype._showAxisTooltip=function(r,a){var o=this._ecModel,u=this._tooltipModel,s=[a.offsetX,a.offsetY],c=buildTooltipModel([a.tooltipOption],u),l=this._renderMode,d=[],f=createTooltipMarkup("section",{blocks:[],noHeader:!0}),h=[],v=new TooltipMarkupStyleCreator;each$f(r,function(w){each$f(w.dataByAxis,function(A){var R=o.getComponent(A.axisDim+"Axis",A.axisIndex),E=A.value;if(!(!R||E==null)){var I=getValueLabel(E,R.axis,o,A.seriesDataIndices,A.valueLabelOpt),L=createTooltipMarkup("section",{header:I,noHeader:!trim$1(I),sortBlocks:!0,blocks:[]});f.blocks.push(L),each$f(A.seriesDataIndices,function(F){var D=o.getSeriesByIndex(F.seriesIndex),$=F.dataIndexInside,O=D.getDataParams($);if(!(O.dataIndex<0)){O.axisDim=A.axisDim,O.axisIndex=A.axisIndex,O.axisType=A.axisType,O.axisId=A.axisId,O.axisValue=getAxisRawValue(R.axis,{value:E}),O.axisValueLabel=I,O.marker=v.makeTooltipMarker("item",convertToColorString(O.color),l);var P=normalizeTooltipFormatResult(D.formatTooltip($,!0,null)),C=P.frag;if(C){var q=buildTooltipModel([D],u).get("valueFormatter");L.blocks.push(q?extend$1({valueFormatter:q},C):C)}P.text&&h.push(P.text),d.push(O)}})}})}),f.blocks.reverse(),h.reverse();var g=a.position,b=c.get("order"),_=buildTooltipMarkup(f,v,l,b,o.get("useUTC"),c.get("textStyle"));_&&h.unshift(_);var S=l==="richText"?`

`:"<br/>",T=h.join(S);this._showOrMove(c,function(){this._updateContentNotChangedOnAxis(r,d)?this._updatePosition(c,g,s[0],s[1],this._tooltipContent,d):this._showTooltipContent(c,T,d,Math.random()+"",s[0],s[1],g,null,v)})},t.prototype._showSeriesItemTooltip=function(r,a,o){var u=this._ecModel,s=getECData(a),c=s.seriesIndex,l=u.getSeriesByIndex(c),d=s.dataModel||l,f=s.dataIndex,h=s.dataType,v=d.getData(h),g=this._renderMode,b=r.positionDefault,_=buildTooltipModel([v.getItemModel(f),d,l&&(l.coordinateSystem||{}).model],this._tooltipModel,b?{position:b}:null),S=_.get("trigger");if(!(S!=null&&S!=="item")){var T=d.getDataParams(f,h),w=new TooltipMarkupStyleCreator;T.marker=w.makeTooltipMarker("item",convertToColorString(T.color),g);var A=normalizeTooltipFormatResult(d.formatTooltip(f,!1,h)),R=_.get("order"),E=_.get("valueFormatter"),I=A.frag,L=I?buildTooltipMarkup(E?extend$1({valueFormatter:E},I):I,w,g,R,u.get("useUTC"),_.get("textStyle")):A.text,F="item_"+d.name+"_"+f;this._showOrMove(_,function(){this._showTooltipContent(_,L,T,F,r.offsetX,r.offsetY,r.position,r.target,w)}),o({type:"showTip",dataIndexInside:f,dataIndex:v.getRawIndex(f),seriesIndex:c,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,a,o){var u=this._renderMode==="html",s=getECData(a),c=s.tooltipConfig,l=c.option||{},d=l.encodeHTMLContent;if(isString(l)){var f=l;l={content:f,formatter:f},d=!0}d&&u&&l.content&&(l=clone$5(l),l.content=encodeHTML(l.content));var h=[l],v=this._ecModel.getComponent(s.componentMainType,s.componentIndex);v&&h.push(v),h.push({formatter:l.content});var g=r.positionDefault,b=buildTooltipModel(h,this._tooltipModel,g?{position:g}:null),_=b.get("content"),S=Math.random()+"",T=new TooltipMarkupStyleCreator;this._showOrMove(b,function(){var w=clone$5(b.get("formatterParams")||{});this._showTooltipContent(b,_,w,S,r.offsetX,r.offsetY,r.position,a,T)}),o({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,a,o,u,s,c,l,d,f){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var h=this._tooltipContent;h.setEnterable(r.get("enterable"));var v=r.get("formatter");l=l||r.get("position");var g=a,b=this._getNearestPoint([s,c],o,r.get("trigger"),r.get("borderColor")),_=b.color;if(v)if(isString(v)){var S=r.ecModel.get("useUTC"),T=isArray$2(o)?o[0]:o,w=T&&T.axisType&&T.axisType.indexOf("time")>=0;g=v,w&&(g=format(T.axisValue,g,S)),g=formatTpl(g,o,!0)}else if(isFunction$1(v)){var A=bind$1(function(R,E){R===this._ticket&&(h.setContent(E,f,r,_,l),this._updatePosition(r,l,s,c,h,o,d))},this);this._ticket=u,g=v(o,u,A)}else g=v;h.setContent(g,f,r,_,l),h.show(r,_),this._updatePosition(r,l,s,c,h,o,d)}},t.prototype._getNearestPoint=function(r,a,o,u){if(o==="axis"||isArray$2(a))return{color:u||(this._renderMode==="html"?"#fff":"none")};if(!isArray$2(a))return{color:u||a.color||a.borderColor}},t.prototype._updatePosition=function(r,a,o,u,s,c,l){var d=this._api.getWidth(),f=this._api.getHeight();a=a||r.get("position");var h=s.getSize(),v=r.get("align"),g=r.get("verticalAlign"),b=l&&l.getBoundingRect().clone();if(l&&b.applyTransform(l.transform),isFunction$1(a)&&(a=a([o,u],c,s.el,b,{viewSize:[d,f],contentSize:h.slice()})),isArray$2(a))o=parsePercent(a[0],d),u=parsePercent(a[1],f);else if(isObject$4(a)){var _=a;_.width=h[0],_.height=h[1];var S=getLayoutRect(_,{width:d,height:f});o=S.x,u=S.y,v=null,g=null}else if(isString(a)&&l){var T=calcTooltipPosition(a,b,h,r.get("borderWidth"));o=T[0],u=T[1]}else{var T=refixTooltipPosition(o,u,s,d,f,v?null:20,g?null:20);o=T[0],u=T[1]}if(v&&(o-=isCenterAlign(v)?h[0]/2:v==="right"?h[0]:0),g&&(u-=isCenterAlign(g)?h[1]/2:g==="bottom"?h[1]:0),shouldTooltipConfine(r)){var T=confineTooltipPosition(o,u,s,d,f);o=T[0],u=T[1]}s.moveTo(o,u)},t.prototype._updateContentNotChangedOnAxis=function(r,a){var o=this._lastDataByCoordSys,u=this._cbParamsList,s=!!o&&o.length===r.length;return s&&each$f(o,function(c,l){var d=c.dataByAxis||[],f=r[l]||{},h=f.dataByAxis||[];s=s&&d.length===h.length,s&&each$f(d,function(v,g){var b=h[g]||{},_=v.seriesDataIndices||[],S=b.seriesDataIndices||[];s=s&&v.value===b.value&&v.axisType===b.axisType&&v.axisId===b.axisId&&_.length===S.length,s&&each$f(_,function(T,w){var A=S[w];s=s&&T.seriesIndex===A.seriesIndex&&T.dataIndex===A.dataIndex}),u&&each$f(v.seriesDataIndices,function(T){var w=T.seriesIndex,A=a[w],R=u[w];A&&R&&R.data!==A.data&&(s=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=a,!!s},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,a){env.node||!a.getDom()||(clear$1(this,"_updatePosition"),this._tooltipContent.dispose(),unregister("itemTooltip",a))},t.type="tooltip",t}(ComponentView);function buildTooltipModel(n,t,r){var a=t.ecModel,o;r?(o=new Model(r,a,a),o=new Model(t.option,o,a)):o=t;for(var u=n.length-1;u>=0;u--){var s=n[u];s&&(s instanceof Model&&(s=s.get("tooltip",!0)),isString(s)&&(s={formatter:s}),s&&(o=new Model(s,o,a)))}return o}function makeDispatchAction(n,t){return n.dispatchAction||bind$1(t.dispatchAction,t)}function refixTooltipPosition(n,t,r,a,o,u,s){var c=r.getSize(),l=c[0],d=c[1];return u!=null&&(n+l+u+2>a?n-=l+u:n+=u),s!=null&&(t+d+s>o?t-=d+s:t+=s),[n,t]}function confineTooltipPosition(n,t,r,a,o){var u=r.getSize(),s=u[0],c=u[1];return n=Math.min(n+s,a)-s,t=Math.min(t+c,o)-c,n=Math.max(n,0),t=Math.max(t,0),[n,t]}function calcTooltipPosition(n,t,r,a){var o=r[0],u=r[1],s=Math.ceil(Math.SQRT2*a)+8,c=0,l=0,d=t.width,f=t.height;switch(n){case"inside":c=t.x+d/2-o/2,l=t.y+f/2-u/2;break;case"top":c=t.x+d/2-o/2,l=t.y-u-s;break;case"bottom":c=t.x+d/2-o/2,l=t.y+f+s;break;case"left":c=t.x-o-s,l=t.y+f/2-u/2;break;case"right":c=t.x+d+s,l=t.y+f/2-u/2}return[c,l]}function isCenterAlign(n){return n==="center"||n==="middle"}function findComponentReference(n,t,r){var a=preParseFinder(n).queryOptionMap,o=a.keys()[0];if(!(!o||o==="series")){var u=queryReferringComponents(t,o,a.get(o),{useDefault:!1,enableAll:!1,enableNone:!1}),s=u.models[0];if(s){var c=r.getViewOfComponentModel(s),l;if(c.group.traverse(function(d){var f=getECData(d).tooltipConfig;if(f&&f.name===n.name)return l=d,!0}),l)return{componentMainType:o,componentIndex:s.componentIndex,el:l}}}}function install$i(n){use(install$q),n.registerComponentModel(TooltipModel),n.registerComponentView(TooltipView),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},noop$3),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},noop$3)}var DEFAULT_TOOLBOX_BTNS=["rect","polygon","keep","clear"];function brushPreprocessor(n,t){var r=normalizeToArray(n?n.brush:[]);if(r.length){var a=[];each$f(r,function(l){var d=l.hasOwnProperty("toolbox")?l.toolbox:[];d instanceof Array&&(a=a.concat(d))});var o=n&&n.toolbox;isArray$2(o)&&(o=o[0]),o||(o={feature:{}},n.toolbox=[o]);var u=o.feature||(o.feature={}),s=u.brush||(u.brush={}),c=s.type||(s.type=[]);c.push.apply(c,a),removeDuplicate(c),t&&!c.length&&c.push.apply(c,DEFAULT_TOOLBOX_BTNS)}}function removeDuplicate(n){var t={};each$f(n,function(r){t[r]=1}),n.length=0,each$f(t,function(r,a){n.push(a)})}var each$4=each$f;function hasKeys(n){if(n){for(var t in n)if(n.hasOwnProperty(t))return!0}}function createVisualMappings(n,t,r){var a={};return each$4(t,function(u){var s=a[u]=o();each$4(n[u],function(c,l){if(VisualMapping.isValidType(l)){var d={type:l,visual:c};r&&r(d,u),s[l]=new VisualMapping(d),l==="opacity"&&(d=clone$5(d),d.type="colorAlpha",s.__hidden.__alphaForOpacity=new VisualMapping(d))}})}),a;function o(){var u=function(){};u.prototype.__hidden=u.prototype;var s=new u;return s}}function replaceVisualOption(n,t,r){var a;each$f(r,function(o){t.hasOwnProperty(o)&&hasKeys(t[o])&&(a=!0)}),a&&each$f(r,function(o){t.hasOwnProperty(o)&&hasKeys(t[o])?n[o]=clone$5(t[o]):delete n[o]})}function applyVisual(n,t,r,a,o,u){var s={};each$f(n,function(h){var v=VisualMapping.prepareVisualTypes(t[h]);s[h]=v});var c;function l(h){return getItemVisualFromData(r,c,h)}function d(h,v){setItemVisualFromData(r,c,h,v)}r.each(f);function f(h,v){c=h;var g=r.getRawDataItem(c);if(!(g&&g.visualMap===!1))for(var b=a.call(o,h),_=t[b],S=s[b],T=0,w=S.length;T<w;T++){var A=S[T];_[A]&&_[A].applyVisual(h,l,d)}}}function incrementalApplyVisual(n,t,r,a){var o={};return each$f(n,function(u){var s=VisualMapping.prepareVisualTypes(t[u]);o[u]=s}),{progress:function(s,c){var l;a!=null&&(l=c.getDimensionIndex(a));function d(E){return getItemVisualFromData(c,h,E)}function f(E,I){setItemVisualFromData(c,h,E,I)}for(var h,v=c.getStore();(h=s.next())!=null;){var g=c.getRawDataItem(h);if(!(g&&g.visualMap===!1))for(var b=a!=null?v.get(l,h):h,_=r(b),S=t[_],T=o[_],w=0,A=T.length;w<A;w++){var R=T[w];S[R]&&S[R].applyVisual(b,d,f)}}}}}function makeBrushCommonSelectorForSeries(n){var t=n.brushType,r={point:function(a){return selector[t].point(a,r,n)},rect:function(a){return selector[t].rect(a,r,n)}};return r}var selector={lineX:getLineSelectors(0),lineY:getLineSelectors(1),rect:{point:function(n,t,r){return n&&r.boundingRect.contain(n[0],n[1])},rect:function(n,t,r){return n&&r.boundingRect.intersect(n)}},polygon:{point:function(n,t,r){return n&&r.boundingRect.contain(n[0],n[1])&&contain(r.range,n[0],n[1])},rect:function(n,t,r){var a=r.range;if(!n||a.length<=1)return!1;var o=n.x,u=n.y,s=n.width,c=n.height,l=a[0];if(contain(a,o,u)||contain(a,o+s,u)||contain(a,o,u+c)||contain(a,o+s,u+c)||BoundingRect.create(n).contain(l[0],l[1])||linePolygonIntersect(o,u,o+s,u,a)||linePolygonIntersect(o,u,o,u+c,a)||linePolygonIntersect(o+s,u,o+s,u+c,a)||linePolygonIntersect(o,u+c,o+s,u+c,a))return!0}}};function getLineSelectors(n){var t=["x","y"],r=["width","height"];return{point:function(a,o,u){if(a){var s=u.range,c=a[n];return inLineRange(c,s)}},rect:function(a,o,u){if(a){var s=u.range,c=[a[t[n]],a[t[n]]+a[r[n]]];return c[1]<c[0]&&c.reverse(),inLineRange(c[0],s)||inLineRange(c[1],s)||inLineRange(s[0],c)||inLineRange(s[1],c)}}}}function inLineRange(n,t){return t[0]<=n&&n<=t[1]}var STATE_LIST=["inBrush","outOfBrush"],DISPATCH_METHOD="__ecBrushSelect",DISPATCH_FLAG="__ecInBrushSelectEvent";function layoutCovers(n){n.eachComponent({mainType:"brush"},function(t){var r=t.brushTargetManager=new BrushTargetManager(t.option,n);r.setInputRanges(t.areas,n)})}function brushVisual(n,t,r){var a=[],o,u;n.eachComponent({mainType:"brush"},function(s){r&&r.type==="takeGlobalCursor"&&s.setBrushOption(r.key==="brush"?r.brushOption:{brushType:!1})}),layoutCovers(n),n.eachComponent({mainType:"brush"},function(s,c){var l={brushId:s.id,brushIndex:c,brushName:s.name,areas:clone$5(s.areas),selected:[]};a.push(l);var d=s.option,f=d.brushLink,h=[],v=[],g=[],b=!1;c||(o=d.throttleType,u=d.throttleDelay);var _=map$1(s.areas,function(E){var I=boundingRectBuilders[E.brushType],L=defaults$h({boundingRect:I?I(E):void 0},E);return L.selectors=makeBrushCommonSelectorForSeries(L),L}),S=createVisualMappings(s.option,STATE_LIST,function(E){E.mappingMethod="fixed"});isArray$2(f)&&each$f(f,function(E){h[E]=1});function T(E){return f==="all"||!!h[E]}function w(E){return!!E.length}n.eachSeries(function(E,I){var L=g[I]=[];E.subType==="parallel"?A(E,I):R(E,I,L)});function A(E,I){var L=E.coordinateSystem;b=b||L.hasAxisBrushed(),T(I)&&L.eachActiveState(E.getData(),function(F,D){F==="active"&&(v[D]=1)})}function R(E,I,L){if(!(!E.brushSelector||brushModelNotControll(s,I))&&(each$f(_,function(D){s.brushTargetManager.controlSeries(D,E,n)&&L.push(D),b=b||w(L)}),T(I)&&w(L))){var F=E.getData();F.each(function(D){checkInRange(E,L,F,D)&&(v[D]=1)})}}n.eachSeries(function(E,I){var L={seriesId:E.id,seriesIndex:I,seriesName:E.name,dataIndex:[]};l.selected.push(L);var F=g[I],D=E.getData(),$=T(I)?function(O){return v[O]?(L.dataIndex.push(D.getRawIndex(O)),"inBrush"):"outOfBrush"}:function(O){return checkInRange(E,F,D,O)?(L.dataIndex.push(D.getRawIndex(O)),"inBrush"):"outOfBrush"};(T(I)?b:w(F))&&applyVisual(STATE_LIST,S,D,$)})}),dispatchAction$1(t,o,u,a,r)}function dispatchAction$1(n,t,r,a,o){if(o){var u=n.getZr();if(!u[DISPATCH_FLAG]){u[DISPATCH_METHOD]||(u[DISPATCH_METHOD]=doDispatch);var s=createOrUpdate(u,DISPATCH_METHOD,r,t);s(n,a)}}}function doDispatch(n,t){if(!n.isDisposed()){var r=n.getZr();r[DISPATCH_FLAG]=!0,n.dispatchAction({type:"brushSelect",batch:t}),r[DISPATCH_FLAG]=!1}}function checkInRange(n,t,r,a){for(var o=0,u=t.length;o<u;o++){var s=t[o];if(n.brushSelector(a,r,s.selectors,s))return!0}}function brushModelNotControll(n,t){var r=n.option.seriesIndex;return r!=null&&r!=="all"&&(isArray$2(r)?indexOf(r,t)<0:t!==r)}var boundingRectBuilders={rect:function(n){return getBoundingRectFromMinMax(n.range)},polygon:function(n){for(var t,r=n.range,a=0,o=r.length;a<o;a++){t=t||[[1/0,-1/0],[1/0,-1/0]];var u=r[a];u[0]<t[0][0]&&(t[0][0]=u[0]),u[0]>t[0][1]&&(t[0][1]=u[0]),u[1]<t[1][0]&&(t[1][0]=u[1]),u[1]>t[1][1]&&(t[1][1]=u[1])}return t&&getBoundingRectFromMinMax(t)}};function getBoundingRectFromMinMax(n){return new BoundingRect(n[0][0],n[1][0],n[0][1]-n[0][0],n[1][1]-n[1][0])}var BrushView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a){this.ecModel=r,this.api=a,this.model,(this._brushController=new BrushController(a.getZr())).on("brush",bind$1(this._onBrush,this)).mount()},t.prototype.render=function(r,a,o,u){this.model=r,this._updateController(r,a,o,u)},t.prototype.updateTransform=function(r,a,o,u){layoutCovers(a),this._updateController(r,a,o,u)},t.prototype.updateVisual=function(r,a,o,u){this.updateTransform(r,a,o,u)},t.prototype.updateView=function(r,a,o,u){this._updateController(r,a,o,u)},t.prototype._updateController=function(r,a,o,u){(!u||u.$from!==r.id)&&this._brushController.setPanels(r.brushTargetManager.makePanelOpts(o)).enableBrush(r.brushOption).updateCovers(r.areas.slice())},t.prototype.dispose=function(){this._brushController.dispose()},t.prototype._onBrush=function(r){var a=this.model.id,o=this.model.brushTargetManager.setOutputRanges(r.areas,this.ecModel);(!r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:a,areas:clone$5(o),$from:a}),r.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:a,areas:clone$5(o),$from:a})},t.type="brush",t}(ComponentView),DEFAULT_OUT_OF_BRUSH_COLOR="#ddd",BrushModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.areas=[],r.brushOption={},r}return t.prototype.optionUpdated=function(r,a){var o=this.option;!a&&replaceVisualOption(o,r,["inBrush","outOfBrush"]);var u=o.inBrush=o.inBrush||{};o.outOfBrush=o.outOfBrush||{color:DEFAULT_OUT_OF_BRUSH_COLOR},u.hasOwnProperty("liftZ")||(u.liftZ=5)},t.prototype.setAreas=function(r){r&&(this.areas=map$1(r,function(a){return generateBrushOption(this.option,a)},this))},t.prototype.setBrushOption=function(r){this.brushOption=generateBrushOption(this.option,r),this.brushType=this.brushOption.brushType},t.type="brush",t.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],t.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},t}(ComponentModel);function generateBrushOption(n,t){return merge$3({brushType:n.brushType,brushMode:n.brushMode,transformable:n.transformable,brushStyle:new Model(n.brushStyle).getItemStyle(),removeOnClick:n.removeOnClick,z:n.z},t,!0)}var ICON_TYPES=["rect","polygon","lineX","lineY","keep","clear"],BrushFeature=function(n){__extends(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(r,a,o){var u,s,c;a.eachComponent({mainType:"brush"},function(l){u=l.brushType,s=l.brushOption.brushMode||"single",c=c||!!l.areas.length}),this._brushType=u,this._brushMode=s,each$f(r.get("type",!0),function(l){r.setIconStatus(l,(l==="keep"?s==="multiple":l==="clear"?c:l===u)?"emphasis":"normal")})},t.prototype.updateView=function(r,a,o){this.render(r,a,o)},t.prototype.getIcons=function(){var r=this.model,a=r.get("icon",!0),o={};return each$f(r.get("type",!0),function(u){a[u]&&(o[u]=a[u])}),o},t.prototype.onclick=function(r,a,o){var u=this._brushType,s=this._brushMode;o==="clear"?(a.dispatchAction({type:"axisAreaSelect",intervals:[]}),a.dispatchAction({type:"brush",command:"clear",areas:[]})):a.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:o==="keep"?u:u===o?!1:o,brushMode:o==="keep"?s==="multiple"?"single":"multiple":s}})},t.getDefaultOption=function(r){var a={show:!0,type:ICON_TYPES.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:r.getLocaleModel().get(["toolbox","brush","title"])};return a},t}(ToolboxFeature);function install$h(n){n.registerComponentView(BrushView),n.registerComponentModel(BrushModel),n.registerPreprocessor(brushPreprocessor),n.registerVisual(n.PRIORITY.VISUAL.BRUSH,brushVisual),n.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(t,r){r.eachComponent({mainType:"brush",query:t},function(a){a.setAreas(t.areas)})}),n.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},noop$3),n.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},noop$3),registerFeature("brush",BrushFeature)}var TitleModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(ComponentModel),TitleView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,a,o){if(this.group.removeAll(),!!r.get("show")){var u=this.group,s=r.getModel("textStyle"),c=r.getModel("subtextStyle"),l=r.get("textAlign"),d=retrieve2(r.get("textBaseline"),r.get("textVerticalAlign")),f=new ZRText({style:createTextStyle(s,{text:r.get("text"),fill:s.getTextColor()},{disableBox:!0}),z2:10}),h=f.getBoundingRect(),v=r.get("subtext"),g=new ZRText({style:createTextStyle(c,{text:v,fill:c.getTextColor(),y:h.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),b=r.get("link"),_=r.get("sublink"),S=r.get("triggerEvent",!0);f.silent=!b&&!S,g.silent=!_&&!S,b&&f.on("click",function(){windowOpen(b,"_"+r.get("target"))}),_&&g.on("click",function(){windowOpen(_,"_"+r.get("subtarget"))}),getECData(f).eventData=getECData(g).eventData=S?{componentType:"title",componentIndex:r.componentIndex}:null,u.add(f),v&&u.add(g);var T=u.getBoundingRect(),w=r.getBoxLayoutParams();w.width=T.width,w.height=T.height;var A=getLayoutRect(w,{width:o.getWidth(),height:o.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?A.x+=A.width:l==="center"&&(A.x+=A.width/2)),d||(d=r.get("top")||r.get("bottom"),d==="center"&&(d="middle"),d==="bottom"?A.y+=A.height:d==="middle"&&(A.y+=A.height/2),d=d||"top"),u.x=A.x,u.y=A.y,u.markRedraw();var R={align:l,verticalAlign:d};f.setStyle(R),g.setStyle(R),T=u.getBoundingRect();var E=A.margin,I=r.getItemStyle(["color","opacity"]);I.fill=r.get("backgroundColor");var L=new Rect$2({shape:{x:T.x-E[3],y:T.y-E[0],width:T.width+E[1]+E[3],height:T.height+E[0]+E[2],r:r.get("borderRadius")},style:I,subPixelOptimize:!0,silent:!0});u.add(L)}},t.type="title",t}(ComponentView);function install$g(n){n.registerComponentModel(TitleModel),n.registerComponentView(TitleView)}var TimelineModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.layoutMode="box",r}return t.prototype.init=function(r,a,o){this.mergeDefaultAndTheme(r,o),this._initData()},t.prototype.mergeOption=function(r){n.prototype.mergeOption.apply(this,arguments),this._initData()},t.prototype.setCurrentIndex=function(r){r==null&&(r=this.option.currentIndex);var a=this._data.count();this.option.loop?r=(r%a+a)%a:(r>=a&&(r=a-1),r<0&&(r=0)),this.option.currentIndex=r},t.prototype.getCurrentIndex=function(){return this.option.currentIndex},t.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},t.prototype.setPlayState=function(r){this.option.autoPlay=!!r},t.prototype.getPlayState=function(){return!!this.option.autoPlay},t.prototype._initData=function(){var r=this.option,a=r.data||[],o=r.axisType,u=this._names=[],s;o==="category"?(s=[],each$f(a,function(d,f){var h=convertOptionIdName(getDataItemValue(d),""),v;isObject$4(d)?(v=clone$5(d),v.value=f):v=f,s.push(v),u.push(h)})):s=a;var c={category:"ordinal",time:"time",value:"number"}[o]||"number",l=this._data=new SeriesData([{name:"value",type:c}],this);l.initData(s,u)},t.prototype.getData=function(){return this._data},t.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},t.type="timeline",t.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},t}(ComponentModel),SliderTimelineModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline.slider",t.defaultOption=inheritDefaultOption(TimelineModel.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),t}(TimelineModel);mixin$1(SliderTimelineModel,DataFormatMixin.prototype);var TimelineView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline",t}(ComponentView),TimelineAxis=function(n){__extends(t,n);function t(r,a,o,u){var s=n.call(this,r,a,o)||this;return s.type=u||"value",s}return t.prototype.getLabelModel=function(){return this.model.getModel("label")},t.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},t}(Axis),PI=Math.PI,labelDataIndexStore=makeInner(),SliderTimelineView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,a){this.api=a},t.prototype.render=function(r,a,o){if(this.model=r,this.api=o,this.ecModel=a,this.group.removeAll(),r.get("show",!0)){var u=this._layout(r,o),s=this._createGroup("_mainGroup"),c=this._createGroup("_labelGroup"),l=this._axis=this._createAxis(u,r);r.formatTooltip=function(d){var f=l.scale.getLabel({value:d});return createTooltipMarkup("nameValue",{noName:!0,value:f})},each$f(["AxisLine","AxisTick","Control","CurrentPointer"],function(d){this["_render"+d](u,s,l,r)},this),this._renderAxisLabel(u,c,l,r),this._position(u,r)}this._doPlayStop(),this._updateTicksStatus()},t.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},t.prototype.dispose=function(){this._clearTimer()},t.prototype._layout=function(r,a){var o=r.get(["label","position"]),u=r.get("orient"),s=getViewRect(r,a),c;o==null||o==="auto"?c=u==="horizontal"?s.y+s.height/2<a.getHeight()/2?"-":"+":s.x+s.width/2<a.getWidth()/2?"+":"-":isString(o)?c={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[u][o]:c=o;var l={horizontal:"center",vertical:c>=0||c==="+"?"left":"right"},d={horizontal:c>=0||c==="+"?"top":"bottom",vertical:"middle"},f={horizontal:0,vertical:PI/2},h=u==="vertical"?s.height:s.width,v=r.getModel("controlStyle"),g=v.get("show",!0),b=g?v.get("itemSize"):0,_=g?v.get("itemGap"):0,S=b+_,T=r.get(["label","rotate"])||0;T=T*PI/180;var w,A,R,E=v.get("position",!0),I=g&&v.get("showPlayBtn",!0),L=g&&v.get("showPrevBtn",!0),F=g&&v.get("showNextBtn",!0),D=0,$=h;E==="left"||E==="bottom"?(I&&(w=[0,0],D+=S),L&&(A=[D,0],D+=S),F&&(R=[$-b,0],$-=S)):(I&&(w=[$-b,0],$-=S),L&&(A=[0,0],D+=S),F&&(R=[$-b,0],$-=S));var O=[D,$];return r.get("inverse")&&O.reverse(),{viewRect:s,mainLength:h,orient:u,rotation:f[u],labelRotation:T,labelPosOpt:c,labelAlign:r.get(["label","align"])||l[u],labelBaseline:r.get(["label","verticalAlign"])||r.get(["label","baseline"])||d[u],playPosition:w,prevBtnPosition:A,nextBtnPosition:R,axisExtent:O,controlSize:b,controlGap:_}},t.prototype._position=function(r,a){var o=this._mainGroup,u=this._labelGroup,s=r.viewRect;if(r.orient==="vertical"){var c=create$2(),l=s.x,d=s.y+s.height;translate$1(c,c,[-l,-d]),rotate$1(c,c,-PI/2),translate$1(c,c,[l,d]),s=s.clone(),s.applyTransform(c)}var f=w(s),h=w(o.getBoundingRect()),v=w(u.getBoundingRect()),g=[o.x,o.y],b=[u.x,u.y];b[0]=g[0]=f[0][0];var _=r.labelPosOpt;if(_==null||isString(_)){var S=_==="+"?0:1;A(g,h,f,1,S),A(b,v,f,1,1-S)}else{var S=_>=0?0:1;A(g,h,f,1,S),b[1]=g[1]+_}o.setPosition(g),u.setPosition(b),o.rotation=u.rotation=r.rotation,T(o),T(u);function T(R){R.originX=f[0][0]-R.x,R.originY=f[1][0]-R.y}function w(R){return[[R.x,R.x+R.width],[R.y,R.y+R.height]]}function A(R,E,I,L,F){R[L]+=I[L][F]-E[L][F]}},t.prototype._createAxis=function(r,a){var o=a.getData(),u=a.get("axisType"),s=createScaleByModel(a,u);s.getTicks=function(){return o.mapArray(["value"],function(d){return{value:d}})};var c=o.getDataExtent("value");s.setExtent(c[0],c[1]),s.calcNiceTicks();var l=new TimelineAxis("value",s,r.axisExtent,u);return l.model=a,l},t.prototype._createGroup=function(r){var a=this[r]=new Group$3;return this.group.add(a),a},t.prototype._renderAxisLine=function(r,a,o,u){var s=o.getExtent();if(u.get(["lineStyle","show"])){var c=new Line$1({shape:{x1:s[0],y1:0,x2:s[1],y2:0},style:extend$1({lineCap:"round"},u.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});a.add(c);var l=this._progressLine=new Line$1({shape:{x1:s[0],x2:this._currentPointer?this._currentPointer.x:s[0],y1:0,y2:0},style:defaults$h({lineCap:"round",lineWidth:c.style.lineWidth},u.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});a.add(l)}},t.prototype._renderAxisTick=function(r,a,o,u){var s=this,c=u.getData(),l=o.scale.getTicks();this._tickSymbols=[],each$f(l,function(d){var f=o.dataToCoord(d.value),h=c.getItemModel(d.value),v=h.getModel("itemStyle"),g=h.getModel(["emphasis","itemStyle"]),b=h.getModel(["progress","itemStyle"]),_={x:f,y:0,onclick:bind$1(s._changeTimeline,s,d.value)},S=giveSymbol(h,v,a,_);S.ensureState("emphasis").style=g.getItemStyle(),S.ensureState("progress").style=b.getItemStyle(),enableHoverEmphasis(S);var T=getECData(S);h.get("tooltip")?(T.dataIndex=d.value,T.dataModel=u):T.dataIndex=T.dataModel=null,s._tickSymbols.push(S)})},t.prototype._renderAxisLabel=function(r,a,o,u){var s=this,c=o.getLabelModel();if(c.get("show")){var l=u.getData(),d=o.getViewLabels();this._tickLabels=[],each$f(d,function(f){var h=f.tickValue,v=l.getItemModel(h),g=v.getModel("label"),b=v.getModel(["emphasis","label"]),_=v.getModel(["progress","label"]),S=o.dataToCoord(f.tickValue),T=new ZRText({x:S,y:0,rotation:r.labelRotation-r.rotation,onclick:bind$1(s._changeTimeline,s,h),silent:!1,style:createTextStyle(g,{text:f.formattedLabel,align:r.labelAlign,verticalAlign:r.labelBaseline})});T.ensureState("emphasis").style=createTextStyle(b),T.ensureState("progress").style=createTextStyle(_),a.add(T),enableHoverEmphasis(T),labelDataIndexStore(T).dataIndex=h,s._tickLabels.push(T)})}},t.prototype._renderControl=function(r,a,o,u){var s=r.controlSize,c=r.rotation,l=u.getModel("controlStyle").getItemStyle(),d=u.getModel(["emphasis","controlStyle"]).getItemStyle(),f=u.getPlayState(),h=u.get("inverse",!0);v(r.nextBtnPosition,"next",bind$1(this._changeTimeline,this,h?"-":"+")),v(r.prevBtnPosition,"prev",bind$1(this._changeTimeline,this,h?"+":"-")),v(r.playPosition,f?"stop":"play",bind$1(this._handlePlayClick,this,!f),!0);function v(g,b,_,S){if(g){var T=parsePercent$1(retrieve2(u.get(["controlStyle",b+"BtnSize"]),s),s),w=[0,-T/2,T,T],A=makeControlIcon(u,b+"Icon",w,{x:g[0],y:g[1],originX:s/2,originY:0,rotation:S?-c:0,rectHover:!0,style:l,onclick:_});A.ensureState("emphasis").style=d,a.add(A),enableHoverEmphasis(A)}}},t.prototype._renderCurrentPointer=function(r,a,o,u){var s=u.getData(),c=u.getCurrentIndex(),l=s.getItemModel(c).getModel("checkpointStyle"),d=this,f={onCreate:function(h){h.draggable=!0,h.drift=bind$1(d._handlePointerDrag,d),h.ondragend=bind$1(d._handlePointerDragend,d),pointerMoveTo(h,d._progressLine,c,o,u,!0)},onUpdate:function(h){pointerMoveTo(h,d._progressLine,c,o,u)}};this._currentPointer=giveSymbol(l,l,this._mainGroup,{},this._currentPointer,f)},t.prototype._handlePlayClick=function(r){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:r,from:this.uid})},t.prototype._handlePointerDrag=function(r,a,o){this._clearTimer(),this._pointerChangeTimeline([o.offsetX,o.offsetY])},t.prototype._handlePointerDragend=function(r){this._pointerChangeTimeline([r.offsetX,r.offsetY],!0)},t.prototype._pointerChangeTimeline=function(r,a){var o=this._toAxisCoord(r)[0],u=this._axis,s=asc$2(u.getExtent().slice());o>s[1]&&(o=s[1]),o<s[0]&&(o=s[0]),this._currentPointer.x=o,this._currentPointer.markRedraw();var c=this._progressLine;c&&(c.shape.x2=o,c.dirty());var l=this._findNearestTick(o),d=this.model;(a||l!==d.getCurrentIndex()&&d.get("realtime"))&&this._changeTimeline(l)},t.prototype._doPlayStop=function(){var r=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var a=r.model;r._changeTimeline(a.getCurrentIndex()+(a.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},t.prototype._toAxisCoord=function(r){var a=this._mainGroup.getLocalTransform();return applyTransform(r,a,!0)},t.prototype._findNearestTick=function(r){var a=this.model.getData(),o=1/0,u,s=this._axis;return a.each(["value"],function(c,l){var d=s.dataToCoord(c),f=Math.abs(d-r);f<o&&(o=f,u=l)}),u},t.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._changeTimeline=function(r){var a=this.model.getCurrentIndex();r==="+"?r=a+1:r==="-"&&(r=a-1),this.api.dispatchAction({type:"timelineChange",currentIndex:r,from:this.uid})},t.prototype._updateTicksStatus=function(){var r=this.model.getCurrentIndex(),a=this._tickSymbols,o=this._tickLabels;if(a)for(var u=0;u<a.length;u++)a&&a[u]&&a[u].toggleState("progress",u<r);if(o)for(var u=0;u<o.length;u++)o&&o[u]&&o[u].toggleState("progress",labelDataIndexStore(o[u]).dataIndex<=r)},t.type="timeline.slider",t}(TimelineView);function createScaleByModel(n,t){if(t=t||n.get("type"),t)switch(t){case"category":return new OrdinalScale({ordinalMeta:n.getCategories(),extent:[1/0,-1/0]});case"time":return new TimeScale({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new IntervalScale}}function getViewRect(n,t){return getLayoutRect(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()},n.get("padding"))}function makeControlIcon(n,t,r,a){var o=a.style,u=createIcon(n.get(["controlStyle",t]),a||{},new BoundingRect(r[0],r[1],r[2],r[3]));return o&&u.setStyle(o),u}function giveSymbol(n,t,r,a,o,u){var s=t.get("color");if(o)o.setColor(s),r.add(o),u&&u.onUpdate(o);else{var c=n.get("symbol");o=createSymbol$1(c,-1,-1,2,2,s),o.setStyle("strokeNoScale",!0),r.add(o),u&&u.onCreate(o)}var l=t.getItemStyle(["color"]);o.setStyle(l),a=merge$3({rectHover:!0,z2:100},a,!0);var d=normalizeSymbolSize(n.get("symbolSize"));a.scaleX=d[0]/2,a.scaleY=d[1]/2;var f=normalizeSymbolOffset(n.get("symbolOffset"),d);f&&(a.x=(a.x||0)+f[0],a.y=(a.y||0)+f[1]);var h=n.get("symbolRotate");return a.rotation=(h||0)*Math.PI/180||0,o.attr(a),o.updateTransform(),o}function pointerMoveTo(n,t,r,a,o,u){if(!n.dragging){var s=o.getModel("checkpointStyle"),c=a.dataToCoord(o.getData().get("value",r));if(u||!s.get("animation",!0))n.attr({x:c,y:0}),t&&t.attr({shape:{x2:c}});else{var l={duration:s.get("animationDuration",!0),easing:s.get("animationEasing",!0)};n.stopAnimation(null,!0),n.animateTo({x:c,y:0},l),t&&t.animateTo({shape:{x2:c}},l)}}}function installTimelineAction(n){n.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,r,a){var o=r.getComponent("timeline");return o&&t.currentIndex!=null&&(o.setCurrentIndex(t.currentIndex),!o.get("loop",!0)&&o.isIndexMax()&&o.getPlayState()&&(o.setPlayState(!1),a.dispatchAction({type:"timelinePlayChange",playState:!1,from:t.from}))),r.resetOption("timeline",{replaceMerge:o.get("replaceMerge",!0)}),defaults$h({currentIndex:o.option.currentIndex},t)}),n.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,r){var a=r.getComponent("timeline");a&&t.playState!=null&&a.setPlayState(t.playState)})}function timelinePreprocessor(n){var t=n&&n.timeline;isArray$2(t)||(t=t?[t]:[]),each$f(t,function(r){r&&compatibleEC2(r)})}function compatibleEC2(n){var t=n.type,r={number:"value",time:"time"};if(r[t]&&(n.axisType=r[t],delete n.type),transferItem(n),has$2(n,"controlPosition")){var a=n.controlStyle||(n.controlStyle={});has$2(a,"position")||(a.position=n.controlPosition),a.position==="none"&&!has$2(a,"show")&&(a.show=!1,delete a.position),delete n.controlPosition}each$f(n.data||[],function(o){isObject$4(o)&&!isArray$2(o)&&(!has$2(o,"value")&&has$2(o,"name")&&(o.value=o.name),transferItem(o))})}function transferItem(n){var t=n.itemStyle||(n.itemStyle={}),r=t.emphasis||(t.emphasis={}),a=n.label||n.label||{},o=a.normal||(a.normal={}),u={normal:1,emphasis:1};each$f(a,function(s,c){!u[c]&&!has$2(o,c)&&(o[c]=s)}),r.label&&!has$2(a,"emphasis")&&(a.emphasis=r.label,delete r.label)}function has$2(n,t){return n.hasOwnProperty(t)}function install$f(n){n.registerComponentModel(SliderTimelineModel),n.registerComponentView(SliderTimelineView),n.registerSubTypeDefaulter("timeline",function(){return"slider"}),installTimelineAction(n),n.registerPreprocessor(timelinePreprocessor)}function checkMarkerInSeries(n,t){if(!n)return!1;for(var r=isArray$2(n)?n:[n],a=0;a<r.length;a++)if(r[a]&&r[a][t])return!0;return!1}function fillLabel(n){defaultEmphasis(n,"label",["show"])}var inner$5=makeInner(),MarkerModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.createdBySelf=!1,r}return t.prototype.init=function(r,a,o){this.mergeDefaultAndTheme(r,o),this._mergeOption(r,o,!1,!0)},t.prototype.isAnimationEnabled=function(){if(env.node)return!1;var r=this.__hostSeries;return this.getShallow("animation")&&r&&r.isAnimationEnabled()},t.prototype.mergeOption=function(r,a){this._mergeOption(r,a,!1,!1)},t.prototype._mergeOption=function(r,a,o,u){var s=this.mainType;o||a.eachSeries(function(c){var l=c.get(this.mainType,!0),d=inner$5(c)[s];if(!l||!l.data){inner$5(c)[s]=null;return}d?d._mergeOption(l,a,!0):(u&&fillLabel(l),each$f(l.data,function(f){f instanceof Array?(fillLabel(f[0]),fillLabel(f[1])):fillLabel(f)}),d=this.createMarkerModelFromSeries(l,this,a),extend$1(d,{mainType:this.mainType,seriesIndex:c.seriesIndex,name:c.name,createdBySelf:!0}),d.__hostSeries=c),inner$5(c)[s]=d},this)},t.prototype.formatTooltip=function(r,a,o){var u=this.getData(),s=this.getRawValue(r),c=u.getName(r);return createTooltipMarkup("section",{header:this.name,blocks:[createTooltipMarkup("nameValue",{name:c,value:s,noName:!c,noValue:s==null})]})},t.prototype.getData=function(){return this._data},t.prototype.setData=function(r){this._data=r},t.prototype.getDataParams=function(r,a){var o=DataFormatMixin.prototype.getDataParams.call(this,r,a),u=this.__hostSeries;return u&&(o.seriesId=u.id,o.seriesName=u.name,o.seriesType=u.subType),o},t.getMarkerModelFromSeries=function(r,a){return inner$5(r)[a]},t.type="marker",t.dependencies=["series","grid","polar","geo"],t}(ComponentModel);mixin$1(MarkerModel,DataFormatMixin.prototype);var MarkPointModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,a,o){return new t(r,a,o)},t.type="markPoint",t.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},t}(MarkerModel);function hasXOrY(n){return!(isNaN(parseFloat(n.x))&&isNaN(parseFloat(n.y)))}function hasXAndY(n){return!isNaN(parseFloat(n.x))&&!isNaN(parseFloat(n.y))}function markerTypeCalculatorWithExtent(n,t,r,a,o,u){var s=[],c=isDimensionStacked(t,a),l=c?t.getCalculationInfo("stackResultDimension"):a,d=numCalculate(t,l,n),f=t.indicesOfNearest(l,d)[0];s[o]=t.get(r,f),s[u]=t.get(l,f);var h=t.get(a,f),v=getPrecision(t.get(a,f));return v=Math.min(v,20),v>=0&&(s[u]=+s[u].toFixed(v)),[s,h]}var markerTypeCalculator={min:curry$1(markerTypeCalculatorWithExtent,"min"),max:curry$1(markerTypeCalculatorWithExtent,"max"),average:curry$1(markerTypeCalculatorWithExtent,"average"),median:curry$1(markerTypeCalculatorWithExtent,"median")};function dataTransform(n,t){if(t){var r=n.getData(),a=n.coordinateSystem,o=a&&a.dimensions;if(!hasXAndY(t)&&!isArray$2(t.coord)&&isArray$2(o)){var u=getAxisInfo(t,r,a,n);if(t=clone$5(t),t.type&&markerTypeCalculator[t.type]&&u.baseAxis&&u.valueAxis){var s=indexOf(o,u.baseAxis.dim),c=indexOf(o,u.valueAxis.dim),l=markerTypeCalculator[t.type](r,u.baseDataDim,u.valueDataDim,s,c);t.coord=l[0],t.value=l[1]}else t.coord=[t.xAxis!=null?t.xAxis:t.radiusAxis,t.yAxis!=null?t.yAxis:t.angleAxis]}if(t.coord==null||!isArray$2(o))t.coord=[];else for(var d=t.coord,f=0;f<2;f++)markerTypeCalculator[d[f]]&&(d[f]=numCalculate(r,r.mapDimension(o[f]),d[f]));return t}}function getAxisInfo(n,t,r,a){var o={};return n.valueIndex!=null||n.valueDim!=null?(o.valueDataDim=n.valueIndex!=null?t.getDimension(n.valueIndex):n.valueDim,o.valueAxis=r.getAxis(dataDimToCoordDim(a,o.valueDataDim)),o.baseAxis=r.getOtherAxis(o.valueAxis),o.baseDataDim=t.mapDimension(o.baseAxis.dim)):(o.baseAxis=a.getBaseAxis(),o.valueAxis=r.getOtherAxis(o.baseAxis),o.baseDataDim=t.mapDimension(o.baseAxis.dim),o.valueDataDim=t.mapDimension(o.valueAxis.dim)),o}function dataDimToCoordDim(n,t){var r=n.getData().getDimensionInfo(t);return r&&r.coordDim}function dataFilter(n,t){return n&&n.containData&&t.coord&&!hasXOrY(t)?n.containData(t.coord):!0}function zoneFilter(n,t,r){return n&&n.containZone&&t.coord&&r.coord&&!hasXOrY(t)&&!hasXOrY(r)?n.containZone(t.coord,r.coord):!0}function createMarkerDimValueGetter(n,t){return n?function(r,a,o,u){var s=u<2?r.coord&&r.coord[u]:r.value;return parseDataValue(s,t[u])}:function(r,a,o,u){return parseDataValue(r.value,t[u])}}function numCalculate(n,t,r){if(r==="average"){var a=0,o=0;return n.each(t,function(u,s){isNaN(u)||(a+=u,o++)}),a/o}else return r==="median"?n.getMedian(t):n.getDataExtent(t)[r==="max"?1:0]}var inner$4=makeInner(),MarkerView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this.markerGroupMap=createHashMap()},t.prototype.render=function(r,a,o){var u=this,s=this.markerGroupMap;s.each(function(c){inner$4(c).keep=!1}),a.eachSeries(function(c){var l=MarkerModel.getMarkerModelFromSeries(c,u.type);l&&u.renderSeries(c,l,a,o)}),s.each(function(c){!inner$4(c).keep&&u.group.remove(c.group)})},t.prototype.markKeep=function(r){inner$4(r).keep=!0},t.prototype.toggleBlurSeries=function(r,a){var o=this;each$f(r,function(u){var s=MarkerModel.getMarkerModelFromSeries(u,o.type);if(s){var c=s.getData();c.eachItemGraphicEl(function(l){l&&(a?enterBlur(l):leaveBlur(l))})}})},t.type="marker",t}(ComponentView);function updateMarkerLayout(n,t,r){var a=t.coordinateSystem;n.each(function(o){var u=n.getItemModel(o),s,c=parsePercent(u.get("x"),r.getWidth()),l=parsePercent(u.get("y"),r.getHeight());if(!isNaN(c)&&!isNaN(l))s=[c,l];else if(t.getMarkerPosition)s=t.getMarkerPosition(n.getValues(n.dimensions,o));else if(a){var d=n.get(a.dimensions[0],o),f=n.get(a.dimensions[1],o);s=a.dataToPoint([d,f])}isNaN(c)||(s[0]=c),isNaN(l)||(s[1]=l),n.setItemLayout(o,s)})}var MarkPointView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,a,o){a.eachSeries(function(u){var s=MarkerModel.getMarkerModelFromSeries(u,"markPoint");s&&(updateMarkerLayout(s.getData(),u,o),this.markerGroupMap.get(u.id).updateLayout())},this)},t.prototype.renderSeries=function(r,a,o,u){var s=r.coordinateSystem,c=r.id,l=r.getData(),d=this.markerGroupMap,f=d.get(c)||d.set(c,new SymbolDraw),h=createData(s,r,a);a.setData(h),updateMarkerLayout(a.getData(),r,u),h.each(function(v){var g=h.getItemModel(v),b=g.getShallow("symbol"),_=g.getShallow("symbolSize"),S=g.getShallow("symbolRotate"),T=g.getShallow("symbolOffset"),w=g.getShallow("symbolKeepAspect");if(isFunction$1(b)||isFunction$1(_)||isFunction$1(S)||isFunction$1(T)){var A=a.getRawValue(v),R=a.getDataParams(v);isFunction$1(b)&&(b=b(A,R)),isFunction$1(_)&&(_=_(A,R)),isFunction$1(S)&&(S=S(A,R)),isFunction$1(T)&&(T=T(A,R))}var E=g.getModel("itemStyle").getItemStyle(),I=getVisualFromData(l,"color");E.fill||(E.fill=I),h.setItemVisual(v,{symbol:b,symbolSize:_,symbolRotate:S,symbolOffset:T,symbolKeepAspect:w,style:E})}),f.updateData(h),this.group.add(f.group),h.eachItemGraphicEl(function(v){v.traverse(function(g){getECData(g).dataModel=a})}),this.markKeep(f),f.group.silent=a.get("silent")||r.get("silent")},t.type="markPoint",t}(MarkerView);function createData(n,t,r){var a;n?a=map$1(n&&n.dimensions,function(c){var l=t.getData().getDimensionInfo(t.getData().mapDimension(c))||{};return extend$1(extend$1({},l),{name:c,ordinalMeta:null})}):a=[{name:"value",type:"float"}];var o=new SeriesData(a,r),u=map$1(r.get("data"),curry$1(dataTransform,t));n&&(u=filter$1(u,curry$1(dataFilter,n)));var s=createMarkerDimValueGetter(!!n,a);return o.initData(u,null,s),o}function install$e(n){n.registerComponentModel(MarkPointModel),n.registerComponentView(MarkPointView),n.registerPreprocessor(function(t){checkMarkerInSeries(t.series,"markPoint")&&(t.markPoint=t.markPoint||{})})}var MarkLineModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,a,o){return new t(r,a,o)},t.type="markLine",t.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},t}(MarkerModel),inner$3=makeInner(),markLineTransform=function(n,t,r,a){var o=n.getData(),u;if(isArray$2(a))u=a;else{var s=a.type;if(s==="min"||s==="max"||s==="average"||s==="median"||a.xAxis!=null||a.yAxis!=null){var c=void 0,l=void 0;if(a.yAxis!=null||a.xAxis!=null)c=t.getAxis(a.yAxis!=null?"y":"x"),l=retrieve(a.yAxis,a.xAxis);else{var d=getAxisInfo(a,o,t,n);c=d.valueAxis;var f=getStackedDimension(o,d.valueDataDim);l=numCalculate(o,f,s)}var h=c.dim==="x"?0:1,v=1-h,g=clone$5(a),b={coord:[]};g.type=null,g.coord=[],g.coord[v]=-1/0,b.coord[v]=1/0;var _=r.get("precision");_>=0&&isNumber(l)&&(l=+l.toFixed(Math.min(_,20))),g.coord[h]=b.coord[h]=l,u=[g,b,{type:s,valueIndex:a.valueIndex,value:l}]}else u=[]}var S=[dataTransform(n,u[0]),dataTransform(n,u[1]),extend$1({},u[2])];return S[2].type=S[2].type||null,merge$3(S[2],S[0]),merge$3(S[2],S[1]),S};function isInfinity$1(n){return!isNaN(n)&&!isFinite(n)}function ifMarkLineHasOnlyDim(n,t,r,a){var o=1-n,u=a.dimensions[n];return isInfinity$1(t[o])&&isInfinity$1(r[o])&&t[n]===r[n]&&a.getAxis(u).containData(t[n])}function markLineFilter(n,t){if(n.type==="cartesian2d"){var r=t[0].coord,a=t[1].coord;if(r&&a&&(ifMarkLineHasOnlyDim(1,r,a,n)||ifMarkLineHasOnlyDim(0,r,a,n)))return!0}return dataFilter(n,t[0])&&dataFilter(n,t[1])}function updateSingleMarkerEndLayout(n,t,r,a,o){var u=a.coordinateSystem,s=n.getItemModel(t),c,l=parsePercent(s.get("x"),o.getWidth()),d=parsePercent(s.get("y"),o.getHeight());if(!isNaN(l)&&!isNaN(d))c=[l,d];else{if(a.getMarkerPosition)c=a.getMarkerPosition(n.getValues(n.dimensions,t));else{var f=u.dimensions,h=n.get(f[0],t),v=n.get(f[1],t);c=u.dataToPoint([h,v])}if(isCoordinateSystemType(u,"cartesian2d")){var g=u.getAxis("x"),b=u.getAxis("y"),f=u.dimensions;isInfinity$1(n.get(f[0],t))?c[0]=g.toGlobalCoord(g.getExtent()[r?0:1]):isInfinity$1(n.get(f[1],t))&&(c[1]=b.toGlobalCoord(b.getExtent()[r?0:1]))}isNaN(l)||(c[0]=l),isNaN(d)||(c[1]=d)}n.setItemLayout(t,c)}var MarkLineView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,a,o){a.eachSeries(function(u){var s=MarkerModel.getMarkerModelFromSeries(u,"markLine");if(s){var c=s.getData(),l=inner$3(s).from,d=inner$3(s).to;l.each(function(f){updateSingleMarkerEndLayout(l,f,!0,u,o),updateSingleMarkerEndLayout(d,f,!1,u,o)}),c.each(function(f){c.setItemLayout(f,[l.getItemLayout(f),d.getItemLayout(f)])}),this.markerGroupMap.get(u.id).updateLayout()}},this)},t.prototype.renderSeries=function(r,a,o,u){var s=r.coordinateSystem,c=r.id,l=r.getData(),d=this.markerGroupMap,f=d.get(c)||d.set(c,new LineDraw);this.group.add(f.group);var h=createList$1(s,r,a),v=h.from,g=h.to,b=h.line;inner$3(a).from=v,inner$3(a).to=g,a.setData(b);var _=a.get("symbol"),S=a.get("symbolSize"),T=a.get("symbolRotate"),w=a.get("symbolOffset");isArray$2(_)||(_=[_,_]),isArray$2(S)||(S=[S,S]),isArray$2(T)||(T=[T,T]),isArray$2(w)||(w=[w,w]),h.from.each(function(R){A(v,R,!0),A(g,R,!1)}),b.each(function(R){var E=b.getItemModel(R).getModel("lineStyle").getLineStyle();b.setItemLayout(R,[v.getItemLayout(R),g.getItemLayout(R)]),E.stroke==null&&(E.stroke=v.getItemVisual(R,"style").fill),b.setItemVisual(R,{fromSymbolKeepAspect:v.getItemVisual(R,"symbolKeepAspect"),fromSymbolOffset:v.getItemVisual(R,"symbolOffset"),fromSymbolRotate:v.getItemVisual(R,"symbolRotate"),fromSymbolSize:v.getItemVisual(R,"symbolSize"),fromSymbol:v.getItemVisual(R,"symbol"),toSymbolKeepAspect:g.getItemVisual(R,"symbolKeepAspect"),toSymbolOffset:g.getItemVisual(R,"symbolOffset"),toSymbolRotate:g.getItemVisual(R,"symbolRotate"),toSymbolSize:g.getItemVisual(R,"symbolSize"),toSymbol:g.getItemVisual(R,"symbol"),style:E})}),f.updateData(b),h.line.eachItemGraphicEl(function(R){getECData(R).dataModel=a,R.traverse(function(E){getECData(E).dataModel=a})});function A(R,E,I){var L=R.getItemModel(E);updateSingleMarkerEndLayout(R,E,I,r,u);var F=L.getModel("itemStyle").getItemStyle();F.fill==null&&(F.fill=getVisualFromData(l,"color")),R.setItemVisual(E,{symbolKeepAspect:L.get("symbolKeepAspect"),symbolOffset:retrieve2(L.get("symbolOffset",!0),w[I?0:1]),symbolRotate:retrieve2(L.get("symbolRotate",!0),T[I?0:1]),symbolSize:retrieve2(L.get("symbolSize"),S[I?0:1]),symbol:retrieve2(L.get("symbol",!0),_[I?0:1]),style:F})}this.markKeep(f),f.group.silent=a.get("silent")||r.get("silent")},t.type="markLine",t}(MarkerView);function createList$1(n,t,r){var a;n?a=map$1(n&&n.dimensions,function(d){var f=t.getData().getDimensionInfo(t.getData().mapDimension(d))||{};return extend$1(extend$1({},f),{name:d,ordinalMeta:null})}):a=[{name:"value",type:"float"}];var o=new SeriesData(a,r),u=new SeriesData(a,r),s=new SeriesData([],r),c=map$1(r.get("data"),curry$1(markLineTransform,t,n,r));n&&(c=filter$1(c,curry$1(markLineFilter,n)));var l=createMarkerDimValueGetter(!!n,a);return o.initData(map$1(c,function(d){return d[0]}),null,l),u.initData(map$1(c,function(d){return d[1]}),null,l),s.initData(map$1(c,function(d){return d[2]})),s.hasItemOption=!0,{from:o,to:u,line:s}}function install$d(n){n.registerComponentModel(MarkLineModel),n.registerComponentView(MarkLineView),n.registerPreprocessor(function(t){checkMarkerInSeries(t.series,"markLine")&&(t.markLine=t.markLine||{})})}var MarkAreaModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,a,o){return new t(r,a,o)},t.type="markArea",t.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},t}(MarkerModel),inner$2=makeInner(),markAreaTransform=function(n,t,r,a){var o=a[0],u=a[1];if(!(!o||!u)){var s=dataTransform(n,o),c=dataTransform(n,u),l=s.coord,d=c.coord;l[0]=retrieve(l[0],-1/0),l[1]=retrieve(l[1],-1/0),d[0]=retrieve(d[0],1/0),d[1]=retrieve(d[1],1/0);var f=mergeAll([{},s,c]);return f.coord=[s.coord,c.coord],f.x0=s.x,f.y0=s.y,f.x1=c.x,f.y1=c.y,f}};function isInfinity(n){return!isNaN(n)&&!isFinite(n)}function ifMarkAreaHasOnlyDim(n,t,r,a){var o=1-n;return isInfinity(t[o])&&isInfinity(r[o])}function markAreaFilter(n,t){var r=t.coord[0],a=t.coord[1],o={coord:r,x:t.x0,y:t.y0},u={coord:a,x:t.x1,y:t.y1};return isCoordinateSystemType(n,"cartesian2d")?r&&a&&(ifMarkAreaHasOnlyDim(1,r,a)||ifMarkAreaHasOnlyDim(0,r,a))?!0:zoneFilter(n,o,u):dataFilter(n,o)||dataFilter(n,u)}function getSingleMarkerEndPoint(n,t,r,a,o){var u=a.coordinateSystem,s=n.getItemModel(t),c,l=parsePercent(s.get(r[0]),o.getWidth()),d=parsePercent(s.get(r[1]),o.getHeight());if(!isNaN(l)&&!isNaN(d))c=[l,d];else{if(a.getMarkerPosition){var f=n.getValues(["x0","y0"],t),h=n.getValues(["x1","y1"],t),v=u.clampData(f),g=u.clampData(h),b=[];r[0]==="x0"?b[0]=v[0]>g[0]?h[0]:f[0]:b[0]=v[0]>g[0]?f[0]:h[0],r[1]==="y0"?b[1]=v[1]>g[1]?h[1]:f[1]:b[1]=v[1]>g[1]?f[1]:h[1],c=a.getMarkerPosition(b,r,!0)}else{var _=n.get(r[0],t),S=n.get(r[1],t),T=[_,S];u.clampData&&u.clampData(T,T),c=u.dataToPoint(T,!0)}if(isCoordinateSystemType(u,"cartesian2d")){var w=u.getAxis("x"),A=u.getAxis("y"),_=n.get(r[0],t),S=n.get(r[1],t);isInfinity(_)?c[0]=w.toGlobalCoord(w.getExtent()[r[0]==="x0"?0:1]):isInfinity(S)&&(c[1]=A.toGlobalCoord(A.getExtent()[r[1]==="y0"?0:1]))}isNaN(l)||(c[0]=l),isNaN(d)||(c[1]=d)}return c}var dimPermutations=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],MarkAreaView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,a,o){a.eachSeries(function(u){var s=MarkerModel.getMarkerModelFromSeries(u,"markArea");if(s){var c=s.getData();c.each(function(l){var d=map$1(dimPermutations,function(h){return getSingleMarkerEndPoint(c,l,h,u,o)});c.setItemLayout(l,d);var f=c.getItemGraphicEl(l);f.setShape("points",d)})}},this)},t.prototype.renderSeries=function(r,a,o,u){var s=r.coordinateSystem,c=r.id,l=r.getData(),d=this.markerGroupMap,f=d.get(c)||d.set(c,{group:new Group$3});this.group.add(f.group),this.markKeep(f);var h=createList(s,r,a);a.setData(h),h.each(function(v){var g=map$1(dimPermutations,function(F){return getSingleMarkerEndPoint(h,v,F,r,u)}),b=s.getAxis("x").scale,_=s.getAxis("y").scale,S=b.getExtent(),T=_.getExtent(),w=[b.parse(h.get("x0",v)),b.parse(h.get("x1",v))],A=[_.parse(h.get("y0",v)),_.parse(h.get("y1",v))];asc$2(w),asc$2(A);var R=!(S[0]>w[1]||S[1]<w[0]||T[0]>A[1]||T[1]<A[0]),E=!R;h.setItemLayout(v,{points:g,allClipped:E});var I=h.getItemModel(v).getModel("itemStyle").getItemStyle(),L=getVisualFromData(l,"color");I.fill||(I.fill=L,isString(I.fill)&&(I.fill=modifyAlpha(I.fill,.4))),I.stroke||(I.stroke=L),h.setItemVisual(v,"style",I)}),h.diff(inner$2(f).data).add(function(v){var g=h.getItemLayout(v);if(!g.allClipped){var b=new Polygon({shape:{points:g.points}});h.setItemGraphicEl(v,b),f.group.add(b)}}).update(function(v,g){var b=inner$2(f).data.getItemGraphicEl(g),_=h.getItemLayout(v);_.allClipped?b&&f.group.remove(b):(b?updateProps$1(b,{shape:{points:_.points}},a,v):b=new Polygon({shape:{points:_.points}}),h.setItemGraphicEl(v,b),f.group.add(b))}).remove(function(v){var g=inner$2(f).data.getItemGraphicEl(v);f.group.remove(g)}).execute(),h.eachItemGraphicEl(function(v,g){var b=h.getItemModel(g),_=h.getItemVisual(g,"style");v.useStyle(h.getItemVisual(g,"style")),setLabelStyle(v,getLabelStatesModels(b),{labelFetcher:a,labelDataIndex:g,defaultText:h.getName(g)||"",inheritColor:isString(_.fill)?modifyAlpha(_.fill,1):"#000"}),setStatesStylesFromModel(v,b),toggleHoverEmphasis(v,null,null,b.get(["emphasis","disabled"])),getECData(v).dataModel=a}),inner$2(f).data=h,f.group.silent=a.get("silent")||r.get("silent")},t.type="markArea",t}(MarkerView);function createList(n,t,r){var a,o,u=["x0","y0","x1","y1"];if(n){var s=map$1(n&&n.dimensions,function(d){var f=t.getData(),h=f.getDimensionInfo(f.mapDimension(d))||{};return extend$1(extend$1({},h),{name:d,ordinalMeta:null})});o=map$1(u,function(d,f){return{name:d,type:s[f%2].type}}),a=new SeriesData(o,r)}else o=[{name:"value",type:"float"}],a=new SeriesData(o,r);var c=map$1(r.get("data"),curry$1(markAreaTransform,t,n,r));n&&(c=filter$1(c,curry$1(markAreaFilter,n)));var l=n?function(d,f,h,v){var g=d.coord[Math.floor(v/2)][v%2];return parseDataValue(g,o[v])}:function(d,f,h,v){return parseDataValue(d.value,o[v])};return a.initData(c,null,l),a.hasItemOption=!0,a}function install$c(n){n.registerComponentModel(MarkAreaModel),n.registerComponentView(MarkAreaView),n.registerPreprocessor(function(t){checkMarkerInSeries(t.series,"markArea")&&(t.markArea=t.markArea||{})})}var getDefaultSelectorOptions=function(n,t){if(t==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},LegendModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,a,o){this.mergeDefaultAndTheme(r,o),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,a){n.prototype.mergeOption.call(this,r,a),this._updateSelector(r)},t.prototype._updateSelector=function(r){var a=r.selector,o=this.ecModel;a===!0&&(a=r.selector=["all","inverse"]),isArray$2(a)&&each$f(a,function(u,s){isString(u)&&(u={type:u}),a[s]=merge$3(u,getDefaultSelectorOptions(o,u.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var a=!1,o=0;o<r.length;o++){var u=r[o].get("name");if(this.isSelected(u)){this.select(u),a=!0;break}}!a&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var a=[],o=[];r.eachRawSeries(function(l){var d=l.name;o.push(d);var f;if(l.legendVisualProvider){var h=l.legendVisualProvider,v=h.getAllNames();r.isSeriesFiltered(l)||(o=o.concat(v)),v.length?a=a.concat(v):f=!0}else f=!0;f&&isNameSpecified(l)&&a.push(l.name)}),this._availableNames=o;var u=this.get("data")||a,s=createHashMap(),c=map$1(u,function(l){return(isString(l)||isNumber(l))&&(l={name:l}),s.get(l.name)?null:(s.set(l.name,!0),new Model(l,this,this.ecModel))},this);this._data=filter$1(c,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var a=this.option.selected,o=this.get("selectedMode");if(o==="single"){var u=this._data;each$f(u,function(s){a[s.get("name")]=!1})}a[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var a=this.option.selected;a.hasOwnProperty(r)||(a[r]=!0),this[a[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,a=this.option.selected;each$f(r,function(o){a[o.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,a=this.option.selected;each$f(r,function(o){var u=o.get("name",!0);a.hasOwnProperty(u)||(a[u]=!0),a[u]=!a[u]})},t.prototype.isSelected=function(r){var a=this.option.selected;return!(a.hasOwnProperty(r)&&!a[r])&&indexOf(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(ComponentModel),curry=curry$1,each$3=each$f,Group$1=Group$3,LegendView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new Group$1),this.group.add(this._selectorGroup=new Group$1),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,a,o){var u=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var s=r.get("align"),c=r.get("orient");(!s||s==="auto")&&(s=r.get("left")==="right"&&c==="vertical"?"right":"left");var l=r.get("selector",!0),d=r.get("selectorPosition",!0);l&&(!d||d==="auto")&&(d=c==="horizontal"?"end":"start"),this.renderInner(s,r,a,o,l,c,d);var f=r.getBoxLayoutParams(),h={width:o.getWidth(),height:o.getHeight()},v=r.get("padding"),g=getLayoutRect(f,h,v),b=this.layoutInner(r,s,g,u,l,d),_=getLayoutRect(defaults$h({width:b.width,height:b.height},f),h,v);this.group.x=_.x-b.x,this.group.y=_.y-b.y,this.group.markRedraw(),this.group.add(this._backgroundEl=makeBackground(b,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,a,o,u,s,c,l){var d=this.getContentGroup(),f=createHashMap(),h=a.get("selectedMode"),v=[];o.eachRawSeries(function(g){!g.get("legendHoverLink")&&v.push(g.id)}),each$3(a.getData(),function(g,b){var _=g.get("name");if(!this.newlineDisabled&&(_===""||_===`
`)){var S=new Group$1;S.newline=!0,d.add(S);return}var T=o.getSeriesByName(_)[0];if(!f.get(_))if(T){var w=T.getData(),A=w.getVisual("legendLineStyle")||{},R=w.getVisual("legendIcon"),E=w.getVisual("style"),I=this._createItem(T,_,b,g,a,r,A,E,R,h,u);I.on("click",curry(dispatchSelectAction,_,null,u,v)).on("mouseover",curry(dispatchHighlightAction,T.name,null,u,v)).on("mouseout",curry(dispatchDownplayAction,T.name,null,u,v)),o.ssr&&I.eachChild(function(L){var F=getECData(L);F.seriesIndex=T.seriesIndex,F.dataIndex=b,F.ssrType="legend"}),f.set(_,!0)}else o.eachRawSeries(function(L){if(!f.get(_)&&L.legendVisualProvider){var F=L.legendVisualProvider;if(!F.containName(_))return;var D=F.indexOfName(_),$=F.getItemVisual(D,"style"),O=F.getItemVisual(D,"legendIcon"),P=parse$4($.fill);P&&P[3]===0&&(P[3]=.2,$=extend$1(extend$1({},$),{fill:stringify$2(P,"rgba")}));var C=this._createItem(L,_,b,g,a,r,{},$,O,h,u);C.on("click",curry(dispatchSelectAction,null,_,u,v)).on("mouseover",curry(dispatchHighlightAction,null,_,u,v)).on("mouseout",curry(dispatchDownplayAction,null,_,u,v)),o.ssr&&C.eachChild(function(q){var M=getECData(q);M.seriesIndex=L.seriesIndex,M.dataIndex=b,M.ssrType="legend"}),f.set(_,!0)}},this)},this),s&&this._createSelector(s,a,u,c,l)},t.prototype._createSelector=function(r,a,o,u,s){var c=this.getSelectorGroup();each$3(r,function(d){var f=d.type,h=new ZRText({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){o.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect",legendId:a.id})}});c.add(h);var v=a.getModel("selectorLabel"),g=a.getModel(["emphasis","selectorLabel"]);setLabelStyle(h,{normal:v,emphasis:g},{defaultText:d.title}),enableHoverEmphasis(h)})},t.prototype._createItem=function(r,a,o,u,s,c,l,d,f,h,v){var g=r.visualDrawType,b=s.get("itemWidth"),_=s.get("itemHeight"),S=s.isSelected(a),T=u.get("symbolRotate"),w=u.get("symbolKeepAspect"),A=u.get("icon");f=A||f||"roundRect";var R=getLegendStyle(f,u,l,d,g,S,v),E=new Group$1,I=u.getModel("textStyle");if(isFunction$1(r.getLegendIcon)&&(!A||A==="inherit"))E.add(r.getLegendIcon({itemWidth:b,itemHeight:_,icon:f,iconRotate:T,itemStyle:R.itemStyle,lineStyle:R.lineStyle,symbolKeepAspect:w}));else{var L=A==="inherit"&&r.getData().getVisual("symbol")?T==="inherit"?r.getData().getVisual("symbolRotate"):T:0;E.add(getDefaultLegendIcon({itemWidth:b,itemHeight:_,icon:f,iconRotate:L,itemStyle:R.itemStyle,symbolKeepAspect:w}))}var F=c==="left"?b+5:-5,D=c,$=s.get("formatter"),O=a;isString($)&&$?O=$.replace("{name}",a??""):isFunction$1($)&&(O=$(a));var P=S?I.getTextColor():u.get("inactiveColor");E.add(new ZRText({style:createTextStyle(I,{text:O,x:F,y:_/2,fill:P,align:D,verticalAlign:"middle"},{inheritColor:P})}));var C=new Rect$2({shape:E.getBoundingRect(),style:{fill:"transparent"}}),q=u.getModel("tooltip");return q.get("show")&&setTooltipConfig({el:C,componentModel:s,itemName:a,itemTooltipOption:q.option}),E.add(C),E.eachChild(function(M){M.silent=!0}),C.silent=!h,this.getContentGroup().add(E),enableHoverEmphasis(E),E.__legendDataIndex=o,E},t.prototype.layoutInner=function(r,a,o,u,s,c){var l=this.getContentGroup(),d=this.getSelectorGroup();box(r.get("orient"),l,r.get("itemGap"),o.width,o.height);var f=l.getBoundingRect(),h=[-f.x,-f.y];if(d.markRedraw(),l.markRedraw(),s){box("horizontal",d,r.get("selectorItemGap",!0));var v=d.getBoundingRect(),g=[-v.x,-v.y],b=r.get("selectorButtonGap",!0),_=r.getOrient().index,S=_===0?"width":"height",T=_===0?"height":"width",w=_===0?"y":"x";c==="end"?g[_]+=f[S]+b:h[_]+=v[S]+b,g[1-_]+=f[T]/2-v[T]/2,d.x=g[0],d.y=g[1],l.x=h[0],l.y=h[1];var A={x:0,y:0};return A[S]=f[S]+b+v[S],A[T]=Math.max(f[T],v[T]),A[w]=Math.min(0,v[w]+g[1-_]),A}else return l.x=h[0],l.y=h[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(ComponentView);function getLegendStyle(n,t,r,a,o,u,s){function c(S,T){S.lineWidth==="auto"&&(S.lineWidth=T.lineWidth>0?2:0),each$3(S,function(w,A){S[A]==="inherit"&&(S[A]=T[A])})}var l=t.getModel("itemStyle"),d=l.getItemStyle(),f=n.lastIndexOf("empty",0)===0?"fill":"stroke",h=l.getShallow("decal");d.decal=!h||h==="inherit"?a.decal:createOrUpdatePatternFromDecal(h,s),d.fill==="inherit"&&(d.fill=a[o]),d.stroke==="inherit"&&(d.stroke=a[f]),d.opacity==="inherit"&&(d.opacity=(o==="fill"?a:r).opacity),c(d,a);var v=t.getModel("lineStyle"),g=v.getLineStyle();if(c(g,r),d.fill==="auto"&&(d.fill=a.fill),d.stroke==="auto"&&(d.stroke=a.fill),g.stroke==="auto"&&(g.stroke=a.fill),!u){var b=t.get("inactiveBorderWidth"),_=d[f];d.lineWidth=b==="auto"?a.lineWidth>0&&_?2:0:d.lineWidth,d.fill=t.get("inactiveColor"),d.stroke=t.get("inactiveBorderColor"),g.stroke=v.get("inactiveColor"),g.lineWidth=v.get("inactiveWidth")}return{itemStyle:d,lineStyle:g}}function getDefaultLegendIcon(n){var t=n.icon||"roundRect",r=createSymbol$1(t,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return r.setStyle(n.itemStyle),r.rotation=(n.iconRotate||0)*Math.PI/180,r.setOrigin([n.itemWidth/2,n.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function dispatchSelectAction(n,t,r,a){dispatchDownplayAction(n,t,r,a),r.dispatchAction({type:"legendToggleSelect",name:n??t}),dispatchHighlightAction(n,t,r,a)}function isUseHoverLayer(n){for(var t=n.getZr().storage.getDisplayList(),r,a=0,o=t.length;a<o&&!(r=t[a].states.emphasis);)a++;return r&&r.hoverLayer}function dispatchHighlightAction(n,t,r,a){isUseHoverLayer(r)||r.dispatchAction({type:"highlight",seriesName:n,name:t,excludeSeriesId:a})}function dispatchDownplayAction(n,t,r,a){isUseHoverLayer(r)||r.dispatchAction({type:"downplay",seriesName:n,name:t,excludeSeriesId:a})}function legendFilter(n){var t=n.findComponents({mainType:"legend"});t&&t.length&&n.filterSeries(function(r){for(var a=0;a<t.length;a++)if(!t[a].isSelected(r.name))return!1;return!0})}function legendSelectActionHandler(n,t,r){var a=n==="allSelect"||n==="inverseSelect",o={},u=[];r.eachComponent({mainType:"legend",query:t},function(c){a?c[n]():c[n](t.name),makeSelectedMap(c,o),u.push(c.componentIndex)});var s={};return r.eachComponent("legend",function(c){each$f(o,function(l,d){c[l?"select":"unSelect"](d)}),makeSelectedMap(c,s)}),a?{selected:s,legendIndex:u}:{name:t.name,selected:s}}function makeSelectedMap(n,t){var r=t||{};return each$f(n.getData(),function(a){var o=a.get("name");if(!(o===`
`||o==="")){var u=n.isSelected(o);hasOwn(r,o)?r[o]=r[o]&&u:r[o]=u}}),r}function installLegendAction(n){n.registerAction("legendToggleSelect","legendselectchanged",curry$1(legendSelectActionHandler,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",curry$1(legendSelectActionHandler,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",curry$1(legendSelectActionHandler,"inverseSelect")),n.registerAction("legendSelect","legendselected",curry$1(legendSelectActionHandler,"select")),n.registerAction("legendUnSelect","legendunselected",curry$1(legendSelectActionHandler,"unSelect"))}function install$b(n){n.registerComponentModel(LegendModel),n.registerComponentView(LegendView),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,legendFilter),n.registerSubTypeDefaulter("legend",function(){return"plain"}),installLegendAction(n)}var ScrollableLegendModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,a,o){var u=getLayoutParams(r);n.prototype.init.call(this,r,a,o),mergeAndNormalizeLayoutParams(this,r,u)},t.prototype.mergeOption=function(r,a){n.prototype.mergeOption.call(this,r,a),mergeAndNormalizeLayoutParams(this,this.option,r)},t.type="legend.scroll",t.defaultOption=inheritDefaultOption(LegendModel.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(LegendModel);function mergeAndNormalizeLayoutParams(n,t,r){var a=n.getOrient(),o=[1,1];o[a.index]=0,mergeLayoutParam(t,r,{type:"box",ignoreSize:!!o})}var Group=Group$3,WH=["width","height"],XY=["x","y"],ScrollableLegendView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new Group),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Group)},t.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,a,o,u,s,c,l){var d=this;n.prototype.renderInner.call(this,r,a,o,u,s,c,l);var f=this._controllerGroup,h=a.get("pageIconSize",!0),v=isArray$2(h)?h:[h,h];b("pagePrev",0);var g=a.getModel("pageTextStyle");f.add(new ZRText({name:"pageText",style:{text:"xx/xx",fill:g.getTextColor(),font:g.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),b("pageNext",1);function b(_,S){var T=_+"DataIndex",w=createIcon(a.get("pageIcons",!0)[a.getOrient().name][S],{onclick:bind$1(d._pageGo,d,T,a,u)},{x:-v[0]/2,y:-v[1]/2,width:v[0],height:v[1]});w.name=_,f.add(w)}},t.prototype.layoutInner=function(r,a,o,u,s,c){var l=this.getSelectorGroup(),d=r.getOrient().index,f=WH[d],h=XY[d],v=WH[1-d],g=XY[1-d];s&&box("horizontal",l,r.get("selectorItemGap",!0));var b=r.get("selectorButtonGap",!0),_=l.getBoundingRect(),S=[-_.x,-_.y],T=clone$5(o);s&&(T[f]=o[f]-_[f]-b);var w=this._layoutContentAndController(r,u,T,d,f,v,g,h);if(s){if(c==="end")S[d]+=w[f]+b;else{var A=_[f]+b;S[d]-=A,w[h]-=A}w[f]+=_[f]+b,S[1-d]+=w[g]+w[v]/2-_[v]/2,w[v]=Math.max(w[v],_[v]),w[g]=Math.min(w[g],_[g]+S[1-d]),l.x=S[0],l.y=S[1],l.markRedraw()}return w},t.prototype._layoutContentAndController=function(r,a,o,u,s,c,l,d){var f=this.getContentGroup(),h=this._containerGroup,v=this._controllerGroup;box(r.get("orient"),f,r.get("itemGap"),u?o.width:null,u?null:o.height),box("horizontal",v,r.get("pageButtonItemGap",!0));var g=f.getBoundingRect(),b=v.getBoundingRect(),_=this._showController=g[s]>o[s],S=[-g.x,-g.y];a||(S[u]=f[d]);var T=[0,0],w=[-b.x,-b.y],A=retrieve2(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(_){var R=r.get("pageButtonPosition",!0);R==="end"?w[u]+=o[s]-b[s]:T[u]+=b[s]+A}w[1-u]+=g[c]/2-b[c]/2,f.setPosition(S),h.setPosition(T),v.setPosition(w);var E={x:0,y:0};if(E[s]=_?o[s]:g[s],E[c]=Math.max(g[c],b[c]),E[l]=Math.min(0,b[l]+w[1-u]),h.__rectSize=o[s],_){var I={x:0,y:0};I[s]=Math.max(o[s]-b[s]-A,0),I[c]=E[c],h.setClipPath(new Rect$2({shape:I})),h.__rectSize=I[s]}else v.eachChild(function(F){F.attr({invisible:!0,silent:!0})});var L=this._getPageInfo(r);return L.pageIndex!=null&&updateProps$1(f,{x:L.contentPosition[0],y:L.contentPosition[1]},_?r:null),this._updatePageInfoView(r,L),E},t.prototype._pageGo=function(r,a,o){var u=this._getPageInfo(a)[r];u!=null&&o.dispatchAction({type:"legendScroll",scrollDataIndex:u,legendId:a.id})},t.prototype._updatePageInfoView=function(r,a){var o=this._controllerGroup;each$f(["pagePrev","pageNext"],function(f){var h=f+"DataIndex",v=a[h]!=null,g=o.childOfName(f);g&&(g.setStyle("fill",v?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),g.cursor=v?"pointer":"default")});var u=o.childOfName("pageText"),s=r.get("pageFormatter"),c=a.pageIndex,l=c!=null?c+1:0,d=a.pageCount;u&&s&&u.setStyle("text",isString(s)?s.replace("{current}",l==null?"":l+"").replace("{total}",d==null?"":d+""):s({current:l,total:d}))},t.prototype._getPageInfo=function(r){var a=r.get("scrollDataIndex",!0),o=this.getContentGroup(),u=this._containerGroup.__rectSize,s=r.getOrient().index,c=WH[s],l=XY[s],d=this._findTargetItemIndex(a),f=o.children(),h=f[d],v=f.length,g=v?1:0,b={contentPosition:[o.x,o.y],pageCount:g,pageIndex:g-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!h)return b;var _=R(h);b.contentPosition[s]=-_.s;for(var S=d+1,T=_,w=_,A=null;S<=v;++S)A=R(f[S]),(!A&&w.e>T.s+u||A&&!E(A,T.s))&&(w.i>T.i?T=w:T=A,T&&(b.pageNextDataIndex==null&&(b.pageNextDataIndex=T.i),++b.pageCount)),w=A;for(var S=d-1,T=_,w=_,A=null;S>=-1;--S)A=R(f[S]),(!A||!E(w,A.s))&&T.i<w.i&&(w=T,b.pagePrevDataIndex==null&&(b.pagePrevDataIndex=T.i),++b.pageCount,++b.pageIndex),T=A;return b;function R(I){if(I){var L=I.getBoundingRect(),F=L[l]+I[l];return{s:F,e:F+L[c],i:I.__legendDataIndex}}}function E(I,L){return I.e>=L&&I.s<=L+u}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var a,o=this.getContentGroup(),u;return o.eachChild(function(s,c){var l=s.__legendDataIndex;u==null&&l!=null&&(u=c),l===r&&(a=c)}),a??u},t.type="legend.scroll",t}(LegendView);function installScrollableLegendAction(n){n.registerAction("legendScroll","legendscroll",function(t,r){var a=t.scrollDataIndex;a!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(o){o.setScrollDataIndex(a)})})}function install$a(n){use(install$b),n.registerComponentModel(ScrollableLegendModel),n.registerComponentView(ScrollableLegendView),installScrollableLegendAction(n)}function install$9(n){use(install$b),use(install$a)}var InsideZoomModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.inside",t.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(DataZoomModel),inner$1=makeInner();function setViewInfoToCoordSysRecord(n,t,r){inner$1(n).coordSysRecordMap.each(function(a){var o=a.dataZoomInfoMap.get(t.uid);o&&(o.getRange=r)})}function disposeCoordSysRecordIfNeeded(n,t){for(var r=inner$1(n).coordSysRecordMap,a=r.keys(),o=0;o<a.length;o++){var u=a[o],s=r.get(u),c=s.dataZoomInfoMap;if(c){var l=t.uid,d=c.get(l);d&&(c.removeKey(l),c.keys().length||disposeCoordSysRecord(r,s))}}}function disposeCoordSysRecord(n,t){if(t){n.removeKey(t.model.uid);var r=t.controller;r&&r.dispose()}}function createCoordSysRecord(n,t){var r={model:t,containsPoint:curry$1(containsPoint,t),dispatchAction:curry$1(dispatchAction,n),dataZoomInfoMap:null,controller:null},a=r.controller=new RoamController(n.getZr());return each$f(["pan","zoom","scrollMove"],function(o){a.on(o,function(u){var s=[];r.dataZoomInfoMap.each(function(c){if(u.isAvailableBehavior(c.model.option)){var l=(c.getRange||{})[o],d=l&&l(c.dzReferCoordSysInfo,r.model.mainType,r.controller,u);!c.model.get("disabled",!0)&&d&&s.push({dataZoomId:c.model.id,start:d[0],end:d[1]})}}),s.length&&r.dispatchAction(s)})}),r}function dispatchAction(n,t){n.isDisposed()||n.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function containsPoint(n,t,r,a){return n.coordinateSystem.containPoint([r,a])}function mergeControllerParams(n){var t,r="type_",a={type_true:2,type_move:1,type_false:0,type_undefined:-1},o=!0;return n.each(function(u){var s=u.model,c=s.get("disabled",!0)?!1:s.get("zoomLock",!0)?"move":!0;a[r+c]>a[r+t]&&(t=c),o=o&&s.get("preventDefaultMouseMove",!0)}),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!o}}}function installDataZoomRoamProcessor(n){n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,function(t,r){var a=inner$1(r),o=a.coordSysRecordMap||(a.coordSysRecordMap=createHashMap());o.each(function(u){u.dataZoomInfoMap=null}),t.eachComponent({mainType:"dataZoom",subType:"inside"},function(u){var s=collectReferCoordSysModelInfo(u);each$f(s.infoList,function(c){var l=c.model.uid,d=o.get(l)||o.set(l,createCoordSysRecord(r,c.model)),f=d.dataZoomInfoMap||(d.dataZoomInfoMap=createHashMap());f.set(u.uid,{dzReferCoordSysInfo:c,model:u,getRange:null})})}),o.each(function(u){var s=u.controller,c,l=u.dataZoomInfoMap;if(l){var d=l.keys()[0];d!=null&&(c=l.get(d))}if(!c){disposeCoordSysRecord(o,u);return}var f=mergeControllerParams(l);s.enable(f.controlType,f.opt),s.setPointerChecker(u.containsPoint),createOrUpdate(u,"dispatchAction",c.model.get("throttle",!0),"fixRate")})})}var InsideZoomView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="dataZoom.inside",r}return t.prototype.render=function(r,a,o){if(n.prototype.render.apply(this,arguments),r.noTarget()){this._clear();return}this.range=r.getPercentRange(),setViewInfoToCoordSysRecord(o,r,{pan:bind$1(getRangeHandlers.pan,this),zoom:bind$1(getRangeHandlers.zoom,this),scrollMove:bind$1(getRangeHandlers.scrollMove,this)})},t.prototype.dispose=function(){this._clear(),n.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){disposeCoordSysRecordIfNeeded(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(DataZoomView),getRangeHandlers={zoom:function(n,t,r,a){var o=this.range,u=o.slice(),s=n.axisModels[0];if(s){var c=getDirectionInfo[t](null,[a.originX,a.originY],s,r,n),l=(c.signal>0?c.pixelStart+c.pixelLength-c.pixel:c.pixel-c.pixelStart)/c.pixelLength*(u[1]-u[0])+u[0],d=Math.max(1/a.scale,0);u[0]=(u[0]-l)*d+l,u[1]=(u[1]-l)*d+l;var f=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(sliderMove(0,u,[0,100],0,f.minSpan,f.maxSpan),this.range=u,o[0]!==u[0]||o[1]!==u[1])return u}},pan:makeMover(function(n,t,r,a,o,u){var s=getDirectionInfo[a]([u.oldX,u.oldY],[u.newX,u.newY],t,o,r);return s.signal*(n[1]-n[0])*s.pixel/s.pixelLength}),scrollMove:makeMover(function(n,t,r,a,o,u){var s=getDirectionInfo[a]([0,0],[u.scrollDelta,u.scrollDelta],t,o,r);return s.signal*(n[1]-n[0])*u.scrollDelta})};function makeMover(n){return function(t,r,a,o){var u=this.range,s=u.slice(),c=t.axisModels[0];if(c){var l=n(s,c,t,r,a,o);if(sliderMove(l,s,[0,100],"all"),this.range=s,u[0]!==s[0]||u[1]!==s[1])return s}}}var getDirectionInfo={grid:function(n,t,r,a,o){var u=r.axis,s={},c=o.model.coordinateSystem.getRect();return n=n||[0,0],u.dim==="x"?(s.pixel=t[0]-n[0],s.pixelLength=c.width,s.pixelStart=c.x,s.signal=u.inverse?1:-1):(s.pixel=t[1]-n[1],s.pixelLength=c.height,s.pixelStart=c.y,s.signal=u.inverse?-1:1),s},polar:function(n,t,r,a,o){var u=r.axis,s={},c=o.model.coordinateSystem,l=c.getRadiusAxis().getExtent(),d=c.getAngleAxis().getExtent();return n=n?c.pointToCoord(n):[0,0],t=c.pointToCoord(t),r.mainType==="radiusAxis"?(s.pixel=t[0]-n[0],s.pixelLength=l[1]-l[0],s.pixelStart=l[0],s.signal=u.inverse?1:-1):(s.pixel=t[1]-n[1],s.pixelLength=d[1]-d[0],s.pixelStart=d[0],s.signal=u.inverse?-1:1),s},singleAxis:function(n,t,r,a,o){var u=r.axis,s=o.model.coordinateSystem.getRect(),c={};return n=n||[0,0],u.orient==="horizontal"?(c.pixel=t[0]-n[0],c.pixelLength=s.width,c.pixelStart=s.x,c.signal=u.inverse?1:-1):(c.pixel=t[1]-n[1],c.pixelLength=s.height,c.pixelStart=s.y,c.signal=u.inverse?-1:1),c}};function install$8(n){installCommon$1(n),n.registerComponentModel(InsideZoomModel),n.registerComponentView(InsideZoomView),installDataZoomRoamProcessor(n)}var SliderZoomModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=inheritDefaultOption(DataZoomModel.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(DataZoomModel),Rect=Rect$2,DEFAULT_LOCATION_EDGE_GAP=7,DEFAULT_FRAME_BORDER_WIDTH=1,DEFAULT_FILLER_SIZE=30,DEFAULT_MOVE_HANDLE_SIZE=7,HORIZONTAL="horizontal",VERTICAL="vertical",LABEL_GAP=5,SHOW_DATA_SHADOW_SERIES_TYPE=["line","bar","candlestick","scatter"],REALTIME_ANIMATION_CONFIG={easing:"cubicOut",duration:100,delay:0},SliderZoomView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._displayables={},r}return t.prototype.init=function(r,a){this.api=a,this._onBrush=bind$1(this._onBrush,this),this._onBrushEnd=bind$1(this._onBrushEnd,this)},t.prototype.render=function(r,a,o,u){if(n.prototype.render.apply(this,arguments),createOrUpdate(this,"_dispatchZoomAction",r.get("throttle"),"fixRate"),this._orient=r.getOrient(),r.get("show")===!1){this.group.removeAll();return}if(r.noTarget()){this._clear(),this.group.removeAll();return}(!u||u.type!=="dataZoom"||u.from!==this.uid)&&this._buildView(),this._updateView()},t.prototype.dispose=function(){this._clear(),n.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){clear$1(this,"_dispatchZoomAction");var r=this.api.getZr();r.off("mousemove",this._onBrush),r.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var r=this.group;r.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var a=this._displayables.sliderGroup=new Group$3;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),r.add(a),this._positionGroup()},t.prototype._resetLocation=function(){var r=this.dataZoomModel,a=this.api,o=r.get("brushSelect"),u=o?DEFAULT_MOVE_HANDLE_SIZE:0,s=this._findCoordRect(),c={width:a.getWidth(),height:a.getHeight()},l=this._orient===HORIZONTAL?{right:c.width-s.x-s.width,top:c.height-DEFAULT_FILLER_SIZE-DEFAULT_LOCATION_EDGE_GAP-u,width:s.width,height:DEFAULT_FILLER_SIZE}:{right:DEFAULT_LOCATION_EDGE_GAP,top:s.y,width:DEFAULT_FILLER_SIZE,height:s.height},d=getLayoutParams(r.option);each$f(["right","top","width","height"],function(h){d[h]==="ph"&&(d[h]=l[h])});var f=getLayoutRect(d,c);this._location={x:f.x,y:f.y},this._size=[f.width,f.height],this._orient===VERTICAL&&this._size.reverse()},t.prototype._positionGroup=function(){var r=this.group,a=this._location,o=this._orient,u=this.dataZoomModel.getFirstTargetAxisModel(),s=u&&u.get("inverse"),c=this._displayables.sliderGroup,l=(this._dataShadowInfo||{}).otherAxisInverse;c.attr(o===HORIZONTAL&&!s?{scaleY:l?1:-1,scaleX:1}:o===HORIZONTAL&&s?{scaleY:l?1:-1,scaleX:-1}:o===VERTICAL&&!s?{scaleY:l?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:l?-1:1,scaleX:-1,rotation:Math.PI/2});var d=r.getBoundingRect([c]);r.x=a.x-d.x,r.y=a.y-d.y,r.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var r=this.dataZoomModel,a=this._size,o=this._displayables.sliderGroup,u=r.get("brushSelect");o.add(new Rect({silent:!0,shape:{x:0,y:0,width:a[0],height:a[1]},style:{fill:r.get("backgroundColor")},z2:-40}));var s=new Rect({shape:{x:0,y:0,width:a[0],height:a[1]},style:{fill:"transparent"},z2:0,onclick:bind$1(this._onClickPanel,this)}),c=this.api.getZr();u?(s.on("mousedown",this._onBrushStart,this),s.cursor="crosshair",c.on("mousemove",this._onBrush),c.on("mouseup",this._onBrushEnd)):(c.off("mousemove",this._onBrush),c.off("mouseup",this._onBrushEnd)),o.add(s)},t.prototype._renderDataShadow=function(){var r=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!r)return;var a=this._size,o=this._shadowSize||[],u=r.series,s=u.getRawData(),c=u.getShadowDim&&u.getShadowDim(),l=c&&s.getDimensionInfo(c)?u.getShadowDim():r.otherDim;if(l==null)return;var d=this._shadowPolygonPts,f=this._shadowPolylinePts;if(s!==this._shadowData||l!==this._shadowDim||a[0]!==o[0]||a[1]!==o[1]){var h=s.getDataExtent(l),v=(h[1]-h[0])*.3;h=[h[0]-v,h[1]+v];var g=[0,a[1]],b=[0,a[0]],_=[[a[0],0],[0,0]],S=[],T=b[1]/(s.count()-1),w=0,A=Math.round(s.count()/a[0]),R;s.each([l],function(D,$){if(A>0&&$%A){w+=T;return}var O=D==null||isNaN(D)||D==="",P=O?0:linearMap$2(D,h,g,!0);O&&!R&&$?(_.push([_[_.length-1][0],0]),S.push([S[S.length-1][0],0])):!O&&R&&(_.push([w,0]),S.push([w,0])),_.push([w,P]),S.push([w,P]),w+=T,R=O}),d=this._shadowPolygonPts=_,f=this._shadowPolylinePts=S}this._shadowData=s,this._shadowDim=l,this._shadowSize=[a[0],a[1]];var E=this.dataZoomModel;function I(D){var $=E.getModel(D?"selectedDataBackground":"dataBackground"),O=new Group$3,P=new Polygon({shape:{points:d},segmentIgnoreThreshold:1,style:$.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),C=new Polyline$1({shape:{points:f},segmentIgnoreThreshold:1,style:$.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return O.add(P),O.add(C),O}for(var L=0;L<3;L++){var F=I(L===1);this._displayables.sliderGroup.add(F),this._displayables.dataShadowSegs.push(F)}},t.prototype._prepareDataShadowInfo=function(){var r=this.dataZoomModel,a=r.get("showDataShadow");if(a!==!1){var o,u=this.ecModel;return r.eachTargetAxis(function(s,c){var l=r.getAxisProxy(s,c).getTargetSeriesModels();each$f(l,function(d){if(!o&&!(a!==!0&&indexOf(SHOW_DATA_SHADOW_SERIES_TYPE,d.get("type"))<0)){var f=u.getComponent(getAxisMainType(s),c).axis,h=getOtherDim(s),v,g=d.coordinateSystem;h!=null&&g.getOtherAxis&&(v=g.getOtherAxis(f).inverse),h=d.getData().mapDimension(h),o={thisAxis:f,series:d,thisDim:s,otherDim:h,otherAxisInverse:v}}},this)},this),o}},t.prototype._renderHandle=function(){var r=this.group,a=this._displayables,o=a.handles=[null,null],u=a.handleLabels=[null,null],s=this._displayables.sliderGroup,c=this._size,l=this.dataZoomModel,d=this.api,f=l.get("borderRadius")||0,h=l.get("brushSelect"),v=a.filler=new Rect({silent:h,style:{fill:l.get("fillerColor")},textConfig:{position:"inside"}});s.add(v),s.add(new Rect({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:c[0],height:c[1],r:f},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:DEFAULT_FRAME_BORDER_WIDTH,fill:"rgba(0,0,0,0)"}})),each$f([0,1],function(A){var R=l.get("handleIcon");!symbolBuildProxies[R]&&R.indexOf("path://")<0&&R.indexOf("image://")<0&&(R="path://"+R);var E=createSymbol$1(R,-1,0,2,2,null,!0);E.attr({cursor:getCursor$1(this._orient),draggable:!0,drift:bind$1(this._onDragMove,this,A),ondragend:bind$1(this._onDragEnd,this),onmouseover:bind$1(this._showDataInfo,this,!0),onmouseout:bind$1(this._showDataInfo,this,!1),z2:5});var I=E.getBoundingRect(),L=l.get("handleSize");this._handleHeight=parsePercent(L,this._size[1]),this._handleWidth=I.width/I.height*this._handleHeight,E.setStyle(l.getModel("handleStyle").getItemStyle()),E.style.strokeNoScale=!0,E.rectHover=!0,E.ensureState("emphasis").style=l.getModel(["emphasis","handleStyle"]).getItemStyle(),enableHoverEmphasis(E);var F=l.get("handleColor");F!=null&&(E.style.fill=F),s.add(o[A]=E);var D=l.getModel("textStyle"),$=l.get("handleLabel")||{},O=$.show||!1;r.add(u[A]=new ZRText({silent:!0,invisible:!O,style:createTextStyle(D,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:D.getTextColor(),font:D.getFont()}),z2:10}))},this);var g=v;if(h){var b=parsePercent(l.get("moveHandleSize"),c[1]),_=a.moveHandle=new Rect$2({style:l.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:c[1]-.5,height:b}}),S=b*.8,T=a.moveHandleIcon=createSymbol$1(l.get("moveHandleIcon"),-S/2,-S/2,S,S,"#fff",!0);T.silent=!0,T.y=c[1]+b/2-.5,_.ensureState("emphasis").style=l.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var w=Math.min(c[1]/2,Math.max(b,10));g=a.moveZone=new Rect$2({invisible:!0,shape:{y:c[1]-w,height:b+w}}),g.on("mouseover",function(){d.enterEmphasis(_)}).on("mouseout",function(){d.leaveEmphasis(_)}),s.add(_),s.add(T),s.add(g)}g.attr({draggable:!0,cursor:getCursor$1(this._orient),drift:bind$1(this._onDragMove,this,"all"),ondragstart:bind$1(this._showDataInfo,this,!0),ondragend:bind$1(this._onDragEnd,this),onmouseover:bind$1(this._showDataInfo,this,!0),onmouseout:bind$1(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var r=this._range=this.dataZoomModel.getPercentRange(),a=this._getViewExtent();this._handleEnds=[linearMap$2(r[0],[0,100],a,!0),linearMap$2(r[1],[0,100],a,!0)]},t.prototype._updateInterval=function(r,a){var o=this.dataZoomModel,u=this._handleEnds,s=this._getViewExtent(),c=o.findRepresentativeAxisProxy().getMinMaxSpan(),l=[0,100];sliderMove(a,u,s,o.get("zoomLock")?"all":r,c.minSpan!=null?linearMap$2(c.minSpan,l,s,!0):null,c.maxSpan!=null?linearMap$2(c.maxSpan,l,s,!0):null);var d=this._range,f=this._range=asc$2([linearMap$2(u[0],s,l,!0),linearMap$2(u[1],s,l,!0)]);return!d||d[0]!==f[0]||d[1]!==f[1]},t.prototype._updateView=function(r){var a=this._displayables,o=this._handleEnds,u=asc$2(o.slice()),s=this._size;each$f([0,1],function(g){var b=a.handles[g],_=this._handleHeight;b.attr({scaleX:_/2,scaleY:_/2,x:o[g]+(g?-1:1),y:s[1]/2-_/2})},this),a.filler.setShape({x:u[0],y:0,width:u[1]-u[0],height:s[1]});var c={x:u[0],width:u[1]-u[0]};a.moveHandle&&(a.moveHandle.setShape(c),a.moveZone.setShape(c),a.moveZone.getBoundingRect(),a.moveHandleIcon&&a.moveHandleIcon.attr("x",c.x+c.width/2));for(var l=a.dataShadowSegs,d=[0,u[0],u[1],s[0]],f=0;f<l.length;f++){var h=l[f],v=h.getClipPath();v||(v=new Rect$2,h.setClipPath(v)),v.setShape({x:d[f],y:0,width:d[f+1]-d[f],height:s[1]})}this._updateDataInfo(r)},t.prototype._updateDataInfo=function(r){var a=this.dataZoomModel,o=this._displayables,u=o.handleLabels,s=this._orient,c=["",""];if(a.get("showDetail")){var l=a.findRepresentativeAxisProxy();if(l){var d=l.getAxisModel().axis,f=this._range,h=r?l.calculateDataWindow({start:f[0],end:f[1]}).valueWindow:l.getDataValueWindow();c=[this._formatLabel(h[0],d),this._formatLabel(h[1],d)]}}var v=asc$2(this._handleEnds.slice());g.call(this,0),g.call(this,1);function g(b){var _=getTransform$1(o.handles[b].parent,this.group),S=transformDirection(b===0?"right":"left",_),T=this._handleWidth/2+LABEL_GAP,w=applyTransform([v[b]+(b===0?-T:T),this._size[1]/2],_);u[b].setStyle({x:w[0],y:w[1],verticalAlign:s===HORIZONTAL?"middle":S,align:s===HORIZONTAL?S:"center",text:c[b]})}},t.prototype._formatLabel=function(r,a){var o=this.dataZoomModel,u=o.get("labelFormatter"),s=o.get("labelPrecision");(s==null||s==="auto")&&(s=a.getPixelPrecision());var c=r==null||isNaN(r)?"":a.type==="category"||a.type==="time"?a.scale.getLabel({value:Math.round(r)}):r.toFixed(Math.min(s,20));return isFunction$1(u)?u(r,c):isString(u)?u.replace("{value}",c):c},t.prototype._showDataInfo=function(r){var a=this.dataZoomModel.get("handleLabel")||{},o=a.show||!1,u=this.dataZoomModel.getModel(["emphasis","handleLabel"]),s=u.get("show")||!1,c=r||this._dragging?s:o,l=this._displayables,d=l.handleLabels;d[0].attr("invisible",!c),d[1].attr("invisible",!c),l.moveHandle&&this.api[c?"enterEmphasis":"leaveEmphasis"](l.moveHandle,1)},t.prototype._onDragMove=function(r,a,o,u){this._dragging=!0,stop(u.event);var s=this._displayables.sliderGroup.getLocalTransform(),c=applyTransform([a,o],s,!0),l=this._updateInterval(r,c[0]),d=this.dataZoomModel.get("realtime");this._updateView(!d),l&&d&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var r=this.dataZoomModel.get("realtime");!r&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(r){var a=this._size,o=this._displayables.sliderGroup.transformCoordToLocal(r.offsetX,r.offsetY);if(!(o[0]<0||o[0]>a[0]||o[1]<0||o[1]>a[1])){var u=this._handleEnds,s=(u[0]+u[1])/2,c=this._updateInterval("all",o[0]-s);this._updateView(),c&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(r){var a=r.offsetX,o=r.offsetY;this._brushStart=new Point(a,o),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(r){if(this._brushing){var a=this._displayables.brushRect;if(this._brushing=!1,!!a){a.attr("ignore",!0);var o=a.shape,u=+new Date;if(!(u-this._brushStartTime<200&&Math.abs(o.width)<5)){var s=this._getViewExtent(),c=[0,100];this._range=asc$2([linearMap$2(o.x,s,c,!0),linearMap$2(o.x+o.width,s,c,!0)]),this._handleEnds=[o.x,o.x+o.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(r){this._brushing&&(stop(r.event),this._updateBrushRect(r.offsetX,r.offsetY))},t.prototype._updateBrushRect=function(r,a){var o=this._displayables,u=this.dataZoomModel,s=o.brushRect;s||(s=o.brushRect=new Rect({silent:!0,style:u.getModel("brushStyle").getItemStyle()}),o.sliderGroup.add(s)),s.attr("ignore",!1);var c=this._brushStart,l=this._displayables.sliderGroup,d=l.transformCoordToLocal(r,a),f=l.transformCoordToLocal(c.x,c.y),h=this._size;d[0]=Math.max(Math.min(h[0],d[0]),0),s.setShape({x:f[0],y:0,width:d[0]-f[0],height:h[1]})},t.prototype._dispatchZoomAction=function(r){var a=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:r?REALTIME_ANIMATION_CONFIG:null,start:a[0],end:a[1]})},t.prototype._findCoordRect=function(){var r,a=collectReferCoordSysModelInfo(this.dataZoomModel).infoList;if(!r&&a.length){var o=a[0].model.coordinateSystem;r=o.getRect&&o.getRect()}if(!r){var u=this.api.getWidth(),s=this.api.getHeight();r={x:u*.2,y:s*.2,width:u*.6,height:s*.6}}return r},t.type="dataZoom.slider",t}(DataZoomView);function getOtherDim(n){var t={x:"y",y:"x",radius:"angle",angle:"radius"};return t[n]}function getCursor$1(n){return n==="vertical"?"ns-resize":"ew-resize"}function install$7(n){n.registerComponentModel(SliderZoomModel),n.registerComponentView(SliderZoomView),installCommon$1(n)}function install$6(n){use(install$8),use(install$7)}var visualDefault={get:function(n,t,r){var a=clone$5((defaultOption[n]||{})[t]);return r&&isArray$2(a)?a[a.length-1]:a}},defaultOption={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},mapVisual=VisualMapping.mapVisual,eachVisual=VisualMapping.eachVisual,isArray$1=isArray$2,each$2=each$f,asc=asc$2,linearMap$1=linearMap$2,VisualMapModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.stateList=["inRange","outOfRange"],r.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],r.layoutMode={type:"box",ignoreSize:!0},r.dataBound=[-1/0,1/0],r.targetVisuals={},r.controllerVisuals={},r}return t.prototype.init=function(r,a,o){this.mergeDefaultAndTheme(r,o)},t.prototype.optionUpdated=function(r,a){var o=this.option;!a&&replaceVisualOption(o,r,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},t.prototype.resetVisual=function(r){var a=this.stateList;r=bind$1(r,this),this.controllerVisuals=createVisualMappings(this.option.controller,a,r),this.targetVisuals=createVisualMappings(this.option.target,a,r)},t.prototype.getItemSymbol=function(){return null},t.prototype.getTargetSeriesIndices=function(){var r=this.option.seriesIndex,a=[];return r==null||r==="all"?this.ecModel.eachSeries(function(o,u){a.push(u)}):a=normalizeToArray(r),a},t.prototype.eachTargetSeries=function(r,a){each$f(this.getTargetSeriesIndices(),function(o){var u=this.ecModel.getSeriesByIndex(o);u&&r.call(a,u)},this)},t.prototype.isTargetSeries=function(r){var a=!1;return this.eachTargetSeries(function(o){o===r&&(a=!0)}),a},t.prototype.formatValueText=function(r,a,o){var u=this.option,s=u.precision,c=this.dataBound,l=u.formatter,d;o=o||["<",">"],isArray$2(r)&&(r=r.slice(),d=!0);var f=a?r:d?[h(r[0]),h(r[1])]:h(r);if(isString(l))return l.replace("{value}",d?f[0]:f).replace("{value2}",d?f[1]:f);if(isFunction$1(l))return d?l(r[0],r[1]):l(r);if(d)return r[0]===c[0]?o[0]+" "+f[1]:r[1]===c[1]?o[1]+" "+f[0]:f[0]+" - "+f[1];return f;function h(v){return v===c[0]?"min":v===c[1]?"max":(+v).toFixed(Math.min(s,20))}},t.prototype.resetExtent=function(){var r=this.option,a=asc([r.min,r.max]);this._dataExtent=a},t.prototype.getDataDimensionIndex=function(r){var a=this.option.dimension;if(a!=null)return r.getDimensionIndex(a);for(var o=r.dimensions,u=o.length-1;u>=0;u--){var s=o[u],c=r.getDimensionInfo(s);if(!c.isCalculationCoord)return c.storeDimIndex}},t.prototype.getExtent=function(){return this._dataExtent.slice()},t.prototype.completeVisualOption=function(){var r=this.ecModel,a=this.option,o={inRange:a.inRange,outOfRange:a.outOfRange},u=a.target||(a.target={}),s=a.controller||(a.controller={});merge$3(u,o),merge$3(s,o);var c=this.isCategory();l.call(this,u),l.call(this,s),d.call(this,u,"inRange","outOfRange"),f.call(this,s);function l(h){isArray$1(a.color)&&!h.inRange&&(h.inRange={color:a.color.slice().reverse()}),h.inRange=h.inRange||{color:r.get("gradientColor")}}function d(h,v,g){var b=h[v],_=h[g];b&&!_&&(_=h[g]={},each$2(b,function(S,T){if(VisualMapping.isValidType(T)){var w=visualDefault.get(T,"inactive",c);w!=null&&(_[T]=w,T==="color"&&!_.hasOwnProperty("opacity")&&!_.hasOwnProperty("colorAlpha")&&(_.opacity=[0,0]))}}))}function f(h){var v=(h.inRange||{}).symbol||(h.outOfRange||{}).symbol,g=(h.inRange||{}).symbolSize||(h.outOfRange||{}).symbolSize,b=this.get("inactiveColor"),_=this.getItemSymbol(),S=_||"roundRect";each$2(this.stateList,function(T){var w=this.itemSize,A=h[T];A||(A=h[T]={color:c?b:[b]}),A.symbol==null&&(A.symbol=v&&clone$5(v)||(c?S:[S])),A.symbolSize==null&&(A.symbolSize=g&&clone$5(g)||(c?w[0]:[w[0],w[0]])),A.symbol=mapVisual(A.symbol,function(I){return I==="none"?S:I});var R=A.symbolSize;if(R!=null){var E=-1/0;eachVisual(R,function(I){I>E&&(E=I)}),A.symbolSize=mapVisual(R,function(I){return linearMap$1(I,[0,E],[0,w[0]],!0)})}},this)}},t.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},t.prototype.isCategory=function(){return!!this.option.categories},t.prototype.setSelected=function(r){},t.prototype.getSelected=function(){return null},t.prototype.getValueState=function(r){return null},t.prototype.getVisualMeta=function(r){return null},t.type="visualMap",t.dependencies=["series"],t.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},t}(ComponentModel),DEFAULT_BAR_BOUND=[20,140],ContinuousModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(r,a){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(o){o.mappingMethod="linear",o.dataExtent=this.getExtent()}),this._resetRange()},t.prototype.resetItemSize=function(){n.prototype.resetItemSize.apply(this,arguments);var r=this.itemSize;(r[0]==null||isNaN(r[0]))&&(r[0]=DEFAULT_BAR_BOUND[0]),(r[1]==null||isNaN(r[1]))&&(r[1]=DEFAULT_BAR_BOUND[1])},t.prototype._resetRange=function(){var r=this.getExtent(),a=this.option.range;!a||a.auto?(r.auto=1,this.option.range=r):isArray$2(a)&&(a[0]>a[1]&&a.reverse(),a[0]=Math.max(a[0],r[0]),a[1]=Math.min(a[1],r[1]))},t.prototype.completeVisualOption=function(){n.prototype.completeVisualOption.apply(this,arguments),each$f(this.stateList,function(r){var a=this.option.controller[r].symbolSize;a&&a[0]!==a[1]&&(a[0]=a[1]/3)},this)},t.prototype.setSelected=function(r){this.option.range=r.slice(),this._resetRange()},t.prototype.getSelected=function(){var r=this.getExtent(),a=asc$2((this.get("range")||[]).slice());return a[0]>r[1]&&(a[0]=r[1]),a[1]>r[1]&&(a[1]=r[1]),a[0]<r[0]&&(a[0]=r[0]),a[1]<r[0]&&(a[1]=r[0]),a},t.prototype.getValueState=function(r){var a=this.option.range,o=this.getExtent();return(a[0]<=o[0]||a[0]<=r)&&(a[1]>=o[1]||r<=a[1])?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(r){var a=[];return this.eachTargetSeries(function(o){var u=[],s=o.getData();s.each(this.getDataDimensionIndex(s),function(c,l){r[0]<=c&&c<=r[1]&&u.push(l)},this),a.push({seriesId:o.id,dataIndex:u})},this),a},t.prototype.getVisualMeta=function(r){var a=getColorStopValues(this,"outOfRange",this.getExtent()),o=getColorStopValues(this,"inRange",this.option.range.slice()),u=[];function s(g,b){u.push({value:g,color:r(g,b)})}for(var c=0,l=0,d=o.length,f=a.length;l<f&&(!o.length||a[l]<=o[0]);l++)a[l]<o[c]&&s(a[l],"outOfRange");for(var h=1;c<d;c++,h=0)h&&u.length&&s(o[c],"outOfRange"),s(o[c],"inRange");for(var h=1;l<f;l++)(!o.length||o[o.length-1]<a[l])&&(h&&(u.length&&s(u[u.length-1].value,"outOfRange"),h=0),s(a[l],"outOfRange"));var v=u.length;return{stops:u,outerColors:[v?u[0].color:"transparent",v?u[v-1].color:"transparent"]}},t.type="visualMap.continuous",t.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),t}(VisualMapModel);function getColorStopValues(n,t,r){if(r[0]===r[1])return r.slice();for(var a=200,o=(r[1]-r[0])/a,u=r[0],s=[],c=0;c<=a&&u<r[1];c++)s.push(u),u+=o;return s.push(r[1]),s}var VisualMapView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r.autoPositionValues={left:1,right:1,top:1,bottom:1},r}return t.prototype.init=function(r,a){this.ecModel=r,this.api=a},t.prototype.render=function(r,a,o,u){if(this.visualMapModel=r,r.get("show")===!1){this.group.removeAll();return}this.doRender(r,a,o,u)},t.prototype.renderBackground=function(r){var a=this.visualMapModel,o=normalizeCssArray(a.get("padding")||0),u=r.getBoundingRect();r.add(new Rect$2({z2:-1,silent:!0,shape:{x:u.x-o[3],y:u.y-o[0],width:u.width+o[3]+o[1],height:u.height+o[0]+o[2]},style:{fill:a.get("backgroundColor"),stroke:a.get("borderColor"),lineWidth:a.get("borderWidth")}}))},t.prototype.getControllerVisual=function(r,a,o){o=o||{};var u=o.forceState,s=this.visualMapModel,c={};if(a==="color"){var l=s.get("contentColor");c.color=l}function d(g){return c[g]}function f(g,b){c[g]=b}var h=s.controllerVisuals[u||s.getValueState(r)],v=VisualMapping.prepareVisualTypes(h);return each$f(v,function(g){var b=h[g];o.convertOpacityToAlpha&&g==="opacity"&&(g="colorAlpha",b=h.__alphaForOpacity),VisualMapping.dependsOn(g,a)&&b&&b.applyVisual(r,d,f)}),c[a]},t.prototype.positionGroup=function(r){var a=this.visualMapModel,o=this.api;positionElement(r,a.getBoxLayoutParams(),{width:o.getWidth(),height:o.getHeight()})},t.prototype.doRender=function(r,a,o,u){},t.type="visualMap",t}(ComponentView),paramsSet=[["left","right","width"],["top","bottom","height"]];function getItemAlign(n,t,r){var a=n.option,o=a.align;if(o!=null&&o!=="auto")return o;for(var u={width:t.getWidth(),height:t.getHeight()},s=a.orient==="horizontal"?1:0,c=paramsSet[s],l=[0,null,10],d={},f=0;f<3;f++)d[paramsSet[1-s][f]]=l[f],d[c[f]]=f===2?r[0]:a[c[f]];var h=[["x","width",3],["y","height",0]][s],v=getLayoutRect(d,u,a.padding);return c[(v.margin[h[2]]||0)+v[h[0]]+v[h[1]]*.5<u[h[1]]*.5?0:1]}function makeHighDownBatch(n,t){return each$f(n||[],function(r){r.dataIndex!=null&&(r.dataIndexInside=r.dataIndex,r.dataIndex=null),r.highlightKey="visualMap"+(t?t.componentIndex:"")}),n}var linearMap=linearMap$2,each$1=each$f,mathMin=Math.min,mathMax=Math.max,HOVER_LINK_SIZE=12,HOVER_LINK_OUT=6,ContinuousView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._shapes={},r._dataInterval=[],r._handleEnds=[],r._hoverLinkDataIndices=[],r}return t.prototype.init=function(r,a){n.prototype.init.call(this,r,a),this._hoverLinkFromSeriesMouseOver=bind$1(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=bind$1(this._hideIndicator,this)},t.prototype.doRender=function(r,a,o,u){(!u||u.type!=="selectDataRange"||u.from!==this.uid)&&this._buildView()},t.prototype._buildView=function(){this.group.removeAll();var r=this.visualMapModel,a=this.group;this._orient=r.get("orient"),this._useHandle=r.get("calculable"),this._resetInterval(),this._renderBar(a);var o=r.get("text");this._renderEndsText(a,o,0),this._renderEndsText(a,o,1),this._updateView(!0),this.renderBackground(a),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(a)},t.prototype._renderEndsText=function(r,a,o){if(a){var u=a[1-o];u=u!=null?u+"":"";var s=this.visualMapModel,c=s.get("textGap"),l=s.itemSize,d=this._shapes.mainGroup,f=this._applyTransform([l[0]/2,o===0?-c:l[1]+c],d),h=this._applyTransform(o===0?"bottom":"top",d),v=this._orient,g=this.visualMapModel.textStyleModel;this.group.add(new ZRText({style:createTextStyle(g,{x:f[0],y:f[1],verticalAlign:v==="horizontal"?"middle":h,align:v==="horizontal"?h:"center",text:u})}))}},t.prototype._renderBar=function(r){var a=this.visualMapModel,o=this._shapes,u=a.itemSize,s=this._orient,c=this._useHandle,l=getItemAlign(a,this.api,u),d=o.mainGroup=this._createBarGroup(l),f=new Group$3;d.add(f),f.add(o.outOfRange=createPolygon()),f.add(o.inRange=createPolygon(null,c?getCursor(this._orient):null,bind$1(this._dragHandle,this,"all",!1),bind$1(this._dragHandle,this,"all",!0))),f.setClipPath(new Rect$2({shape:{x:0,y:0,width:u[0],height:u[1],r:3}}));var h=a.textStyleModel.getTextRect(""),v=mathMax(h.width,h.height);c&&(o.handleThumbs=[],o.handleLabels=[],o.handleLabelPoints=[],this._createHandle(a,d,0,u,v,s),this._createHandle(a,d,1,u,v,s)),this._createIndicator(a,d,u,v,s),r.add(d)},t.prototype._createHandle=function(r,a,o,u,s,c){var l=bind$1(this._dragHandle,this,o,!1),d=bind$1(this._dragHandle,this,o,!0),f=parsePercent$1(r.get("handleSize"),u[0]),h=createSymbol$1(r.get("handleIcon"),-f/2,-f/2,f,f,null,!0),v=getCursor(this._orient);h.attr({cursor:v,draggable:!0,drift:l,ondragend:d,onmousemove:function(T){stop(T.event)}}),h.x=u[0]/2,h.useStyle(r.getModel("handleStyle").getItemStyle()),h.setStyle({strokeNoScale:!0,strokeFirst:!0}),h.style.lineWidth*=2,h.ensureState("emphasis").style=r.getModel(["emphasis","handleStyle"]).getItemStyle(),setAsHighDownDispatcher(h,!0),a.add(h);var g=this.visualMapModel.textStyleModel,b=new ZRText({cursor:v,draggable:!0,drift:l,onmousemove:function(T){stop(T.event)},ondragend:d,style:createTextStyle(g,{x:0,y:0,text:""})});b.ensureState("blur").style={opacity:.1},b.stateTransition={duration:200},this.group.add(b);var _=[f,0],S=this._shapes;S.handleThumbs[o]=h,S.handleLabelPoints[o]=_,S.handleLabels[o]=b},t.prototype._createIndicator=function(r,a,o,u,s){var c=parsePercent$1(r.get("indicatorSize"),o[0]),l=createSymbol$1(r.get("indicatorIcon"),-c/2,-c/2,c,c,null,!0);l.attr({cursor:"move",invisible:!0,silent:!0,x:o[0]/2});var d=r.getModel("indicatorStyle").getItemStyle();if(l instanceof ZRImage){var f=l.style;l.useStyle(extend$1({image:f.image,x:f.x,y:f.y,width:f.width,height:f.height},d))}else l.useStyle(d);a.add(l);var h=this.visualMapModel.textStyleModel,v=new ZRText({silent:!0,invisible:!0,style:createTextStyle(h,{x:0,y:0,text:""})});this.group.add(v);var g=[(s==="horizontal"?u/2:HOVER_LINK_OUT)+o[0]/2,0],b=this._shapes;b.indicator=l,b.indicatorLabel=v,b.indicatorLabelPoint=g,this._firstShowIndicator=!0},t.prototype._dragHandle=function(r,a,o,u){if(this._useHandle){if(this._dragging=!a,!a){var s=this._applyTransform([o,u],this._shapes.mainGroup,!0);this._updateInterval(r,s[1]),this._hideIndicator(),this._updateView()}a===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),a?!this._hovering&&this._clearHoverLinkToSeries():useHoverLinkOnHandle(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[r],!1)}},t.prototype._resetInterval=function(){var r=this.visualMapModel,a=this._dataInterval=r.getSelected(),o=r.getExtent(),u=[0,r.itemSize[1]];this._handleEnds=[linearMap(a[0],o,u,!0),linearMap(a[1],o,u,!0)]},t.prototype._updateInterval=function(r,a){a=a||0;var o=this.visualMapModel,u=this._handleEnds,s=[0,o.itemSize[1]];sliderMove(a,u,s,r,0);var c=o.getExtent();this._dataInterval=[linearMap(u[0],s,c,!0),linearMap(u[1],s,c,!0)]},t.prototype._updateView=function(r){var a=this.visualMapModel,o=a.getExtent(),u=this._shapes,s=[0,a.itemSize[1]],c=r?s:this._handleEnds,l=this._createBarVisual(this._dataInterval,o,c,"inRange"),d=this._createBarVisual(o,o,s,"outOfRange");u.inRange.setStyle({fill:l.barColor}).setShape("points",l.barPoints),u.outOfRange.setStyle({fill:d.barColor}).setShape("points",d.barPoints),this._updateHandle(c,l)},t.prototype._createBarVisual=function(r,a,o,u){var s={forceState:u,convertOpacityToAlpha:!0},c=this._makeColorGradient(r,s),l=[this.getControllerVisual(r[0],"symbolSize",s),this.getControllerVisual(r[1],"symbolSize",s)],d=this._createBarPoints(o,l);return{barColor:new LinearGradient(0,0,0,1,c),barPoints:d,handlesColor:[c[0].color,c[c.length-1].color]}},t.prototype._makeColorGradient=function(r,a){var o=100,u=[],s=(r[1]-r[0])/o;u.push({color:this.getControllerVisual(r[0],"color",a),offset:0});for(var c=1;c<o;c++){var l=r[0]+s*c;if(l>r[1])break;u.push({color:this.getControllerVisual(l,"color",a),offset:c/o})}return u.push({color:this.getControllerVisual(r[1],"color",a),offset:1}),u},t.prototype._createBarPoints=function(r,a){var o=this.visualMapModel.itemSize;return[[o[0]-a[0],r[0]],[o[0],r[0]],[o[0],r[1]],[o[0]-a[1],r[1]]]},t.prototype._createBarGroup=function(r){var a=this._orient,o=this.visualMapModel.get("inverse");return new Group$3(a==="horizontal"&&!o?{scaleX:r==="bottom"?1:-1,rotation:Math.PI/2}:a==="horizontal"&&o?{scaleX:r==="bottom"?-1:1,rotation:-Math.PI/2}:a==="vertical"&&!o?{scaleX:r==="left"?1:-1,scaleY:-1}:{scaleX:r==="left"?1:-1})},t.prototype._updateHandle=function(r,a){if(this._useHandle){var o=this._shapes,u=this.visualMapModel,s=o.handleThumbs,c=o.handleLabels,l=u.itemSize,d=u.getExtent(),f=this._applyTransform("left",o.mainGroup);each$1([0,1],function(h){var v=s[h];v.setStyle("fill",a.handlesColor[h]),v.y=r[h];var g=linearMap(r[h],[0,l[1]],d,!0),b=this.getControllerVisual(g,"symbolSize");v.scaleX=v.scaleY=b/l[0],v.x=l[0]-b/2;var _=applyTransform(o.handleLabelPoints[h],getTransform$1(v,this.group));if(this._orient==="horizontal"){var S=f==="left"||f==="top"?(l[0]-b)/2:(l[0]-b)/-2;_[1]+=S}c[h].setStyle({x:_[0],y:_[1],text:u.formatValueText(this._dataInterval[h]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",o.mainGroup):"center"})},this)}},t.prototype._showIndicator=function(r,a,o,u){var s=this.visualMapModel,c=s.getExtent(),l=s.itemSize,d=[0,l[1]],f=this._shapes,h=f.indicator;if(h){h.attr("invisible",!1);var v={convertOpacityToAlpha:!0},g=this.getControllerVisual(r,"color",v),b=this.getControllerVisual(r,"symbolSize"),_=linearMap(r,c,d,!0),S=l[0]-b/2,T={x:h.x,y:h.y};h.y=_,h.x=S;var w=applyTransform(f.indicatorLabelPoint,getTransform$1(h,this.group)),A=f.indicatorLabel;A.attr("invisible",!1);var R=this._applyTransform("left",f.mainGroup),E=this._orient,I=E==="horizontal";A.setStyle({text:(o||"")+s.formatValueText(a),verticalAlign:I?R:"middle",align:I?"center":R});var L={x:S,y:_,style:{fill:g}},F={style:{x:w[0],y:w[1]}};if(s.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var D={duration:100,easing:"cubicInOut",additive:!0};h.x=T.x,h.y=T.y,h.animateTo(L,D),A.animateTo(F,D)}else h.attr(L),A.attr(F);this._firstShowIndicator=!1;var $=this._shapes.handleLabels;if($)for(var O=0;O<$.length;O++)this.api.enterBlur($[O])}},t.prototype._enableHoverLinkToSeries=function(){var r=this;this._shapes.mainGroup.on("mousemove",function(a){if(r._hovering=!0,!r._dragging){var o=r.visualMapModel.itemSize,u=r._applyTransform([a.offsetX,a.offsetY],r._shapes.mainGroup,!0,!0);u[1]=mathMin(mathMax(0,u[1]),o[1]),r._doHoverLinkToSeries(u[1],0<=u[0]&&u[0]<=o[0])}}).on("mouseout",function(){r._hovering=!1,!r._dragging&&r._clearHoverLinkToSeries()})},t.prototype._enableHoverLinkFromSeries=function(){var r=this.api.getZr();this.visualMapModel.option.hoverLink?(r.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),r.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},t.prototype._doHoverLinkToSeries=function(r,a){var o=this.visualMapModel,u=o.itemSize;if(o.option.hoverLink){var s=[0,u[1]],c=o.getExtent();r=mathMin(mathMax(s[0],r),s[1]);var l=getHalfHoverLinkSize(o,c,s),d=[r-l,r+l],f=linearMap(r,s,c,!0),h=[linearMap(d[0],s,c,!0),linearMap(d[1],s,c,!0)];d[0]<s[0]&&(h[0]=-1/0),d[1]>s[1]&&(h[1]=1/0),a&&(h[0]===-1/0?this._showIndicator(f,h[1],"< ",l):h[1]===1/0?this._showIndicator(f,h[0],"> ",l):this._showIndicator(f,f," ",l));var v=this._hoverLinkDataIndices,g=[];(a||useHoverLinkOnHandle(o))&&(g=this._hoverLinkDataIndices=o.findTargetDataIndices(h));var b=compressBatches(v,g);this._dispatchHighDown("downplay",makeHighDownBatch(b[0],o)),this._dispatchHighDown("highlight",makeHighDownBatch(b[1],o))}},t.prototype._hoverLinkFromSeriesMouseOver=function(r){var a;if(findEventDispatcher(r.target,function(l){var d=getECData(l);if(d.dataIndex!=null)return a=d,!0},!0),!!a){var o=this.ecModel.getSeriesByIndex(a.seriesIndex),u=this.visualMapModel;if(u.isTargetSeries(o)){var s=o.getData(a.dataType),c=s.getStore().get(u.getDataDimensionIndex(s),a.dataIndex);isNaN(c)||this._showIndicator(c,c)}}},t.prototype._hideIndicator=function(){var r=this._shapes;r.indicator&&r.indicator.attr("invisible",!0),r.indicatorLabel&&r.indicatorLabel.attr("invisible",!0);var a=this._shapes.handleLabels;if(a)for(var o=0;o<a.length;o++)this.api.leaveBlur(a[o])},t.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var r=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",makeHighDownBatch(r,this.visualMapModel)),r.length=0},t.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var r=this.api.getZr();r.off("mouseover",this._hoverLinkFromSeriesMouseOver),r.off("mouseout",this._hideIndicator)},t.prototype._applyTransform=function(r,a,o,u){var s=getTransform$1(a,u?null:this.group);return isArray$2(r)?applyTransform(r,s,o):transformDirection(r,s,o)},t.prototype._dispatchHighDown=function(r,a){a&&a.length&&this.api.dispatchAction({type:r,batch:a})},t.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},t.type="visualMap.continuous",t}(VisualMapView);function createPolygon(n,t,r,a){return new Polygon({shape:{points:n},draggable:!!r,cursor:t,drift:r,onmousemove:function(o){stop(o.event)},ondragend:a})}function getHalfHoverLinkSize(n,t,r){var a=HOVER_LINK_SIZE/2,o=n.get("hoverLinkDataSize");return o&&(a=linearMap(o,t,r,!0)/2),a}function useHoverLinkOnHandle(n){var t=n.get("hoverLinkOnHandle");return!!(t??n.get("realtime"))}function getCursor(n){return n==="vertical"?"ns-resize":"ew-resize"}var visualMapActionInfo={type:"selectDataRange",event:"dataRangeSelected",update:"update"},visualMapActionHander=function(n,t){t.eachComponent({mainType:"visualMap",query:n},function(r){r.setSelected(n.selected)})},visualMapEncodingHandlers=[{createOnAllSeries:!0,reset:function(n,t){var r=[];return t.eachComponent("visualMap",function(a){var o=n.pipelineContext;!a.isTargetSeries(n)||o&&o.large||r.push(incrementalApplyVisual(a.stateList,a.targetVisuals,bind$1(a.getValueState,a),a.getDataDimensionIndex(n.getData())))}),r}},{createOnAllSeries:!0,reset:function(n,t){var r=n.getData(),a=[];t.eachComponent("visualMap",function(o){if(o.isTargetSeries(n)){var u=o.getVisualMeta(bind$1(getColorVisual,null,n,o))||{stops:[],outerColors:[]},s=o.getDataDimensionIndex(r);s>=0&&(u.dimension=s,a.push(u))}}),n.getData().setVisual("visualMeta",a)}}];function getColorVisual(n,t,r,a){for(var o=t.targetVisuals[a],u=VisualMapping.prepareVisualTypes(o),s={color:getVisualFromData(n.getData(),"color")},c=0,l=u.length;c<l;c++){var d=u[c],f=o[d==="opacity"?"__alphaForOpacity":d];f&&f.applyVisual(r,h,v)}return s.color;function h(g){return s[g]}function v(g,b){s[g]=b}}var each=each$f;function visualMapPreprocessor(n){var t=n&&n.visualMap;isArray$2(t)||(t=t?[t]:[]),each(t,function(r){if(r){has$1(r,"splitList")&&!has$1(r,"pieces")&&(r.pieces=r.splitList,delete r.splitList);var a=r.pieces;a&&isArray$2(a)&&each(a,function(o){isObject$4(o)&&(has$1(o,"start")&&!has$1(o,"min")&&(o.min=o.start),has$1(o,"end")&&!has$1(o,"max")&&(o.max=o.end))})}})}function has$1(n,t){return n&&n.hasOwnProperty&&n.hasOwnProperty(t)}var installed=!1;function installCommon(n){installed||(installed=!0,n.registerSubTypeDefaulter("visualMap",function(t){return!t.categories&&(!(t.pieces?t.pieces.length>0:t.splitNumber>0)||t.calculable)?"continuous":"piecewise"}),n.registerAction(visualMapActionInfo,visualMapActionHander),each$f(visualMapEncodingHandlers,function(t){n.registerVisual(n.PRIORITY.VISUAL.COMPONENT,t)}),n.registerPreprocessor(visualMapPreprocessor))}function install$5(n){n.registerComponentModel(ContinuousModel),n.registerComponentView(ContinuousView),installCommon(n)}var PiecewiseModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r._pieceList=[],r}return t.prototype.optionUpdated=function(r,a){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var o=this._mode=this._determineMode();this._pieceList=[],resetMethods[this._mode].call(this,this._pieceList),this._resetSelected(r,a);var u=this.option.categories;this.resetVisual(function(s,c){o==="categories"?(s.mappingMethod="category",s.categories=clone$5(u)):(s.dataExtent=this.getExtent(),s.mappingMethod="piecewise",s.pieceList=map$1(this._pieceList,function(l){return l=clone$5(l),c!=="inRange"&&(l.visual=null),l}))})},t.prototype.completeVisualOption=function(){var r=this.option,a={},o=VisualMapping.listVisualTypes(),u=this.isCategory();each$f(r.pieces,function(c){each$f(o,function(l){c.hasOwnProperty(l)&&(a[l]=1)})}),each$f(a,function(c,l){var d=!1;each$f(this.stateList,function(f){d=d||s(r,f,l)||s(r.target,f,l)},this),!d&&each$f(this.stateList,function(f){(r[f]||(r[f]={}))[l]=visualDefault.get(l,f==="inRange"?"active":"inactive",u)})},this);function s(c,l,d){return c&&c[l]&&c[l].hasOwnProperty(d)}n.prototype.completeVisualOption.apply(this,arguments)},t.prototype._resetSelected=function(r,a){var o=this.option,u=this._pieceList,s=(a?o:r).selected||{};if(o.selected=s,each$f(u,function(l,d){var f=this.getSelectedMapKey(l);s.hasOwnProperty(f)||(s[f]=!0)},this),o.selectedMode==="single"){var c=!1;each$f(u,function(l,d){var f=this.getSelectedMapKey(l);s[f]&&(c?s[f]=!1:c=!0)},this)}},t.prototype.getItemSymbol=function(){return this.get("itemSymbol")},t.prototype.getSelectedMapKey=function(r){return this._mode==="categories"?r.value+"":r.index+""},t.prototype.getPieceList=function(){return this._pieceList},t.prototype._determineMode=function(){var r=this.option;return r.pieces&&r.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},t.prototype.setSelected=function(r){this.option.selected=clone$5(r)},t.prototype.getValueState=function(r){var a=VisualMapping.findPieceIndex(r,this._pieceList);return a!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[a])]?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(r){var a=[],o=this._pieceList;return this.eachTargetSeries(function(u){var s=[],c=u.getData();c.each(this.getDataDimensionIndex(c),function(l,d){var f=VisualMapping.findPieceIndex(l,o);f===r&&s.push(d)},this),a.push({seriesId:u.id,dataIndex:s})},this),a},t.prototype.getRepresentValue=function(r){var a;if(this.isCategory())a=r.value;else if(r.value!=null)a=r.value;else{var o=r.interval||[];a=o[0]===-1/0&&o[1]===1/0?0:(o[0]+o[1])/2}return a},t.prototype.getVisualMeta=function(r){if(this.isCategory())return;var a=[],o=["",""],u=this;function s(f,h){var v=u.getRepresentValue({interval:f});h||(h=u.getValueState(v));var g=r(v,h);f[0]===-1/0?o[0]=g:f[1]===1/0?o[1]=g:a.push({value:f[0],color:g},{value:f[1],color:g})}var c=this._pieceList.slice();if(!c.length)c.push({interval:[-1/0,1/0]});else{var l=c[0].interval[0];l!==-1/0&&c.unshift({interval:[-1/0,l]}),l=c[c.length-1].interval[1],l!==1/0&&c.push({interval:[l,1/0]})}var d=-1/0;return each$f(c,function(f){var h=f.interval;h&&(h[0]>d&&s([d,h[0]],"outOfRange"),s(h.slice()),d=h[1])},this),{stops:a,outerColors:o}},t.type="visualMap.piecewise",t.defaultOption=inheritDefaultOption(VisualMapModel.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),t}(VisualMapModel),resetMethods={splitNumber:function(n){var t=this.option,r=Math.min(t.precision,20),a=this.getExtent(),o=t.splitNumber;o=Math.max(parseInt(o,10),1),t.splitNumber=o;for(var u=(a[1]-a[0])/o;+u.toFixed(r)!==u&&r<5;)r++;t.precision=r,u=+u.toFixed(r),t.minOpen&&n.push({interval:[-1/0,a[0]],close:[0,0]});for(var s=0,c=a[0];s<o;c+=u,s++){var l=s===o-1?a[1]:c+u;n.push({interval:[c,l],close:[1,1]})}t.maxOpen&&n.push({interval:[a[1],1/0],close:[0,0]}),reformIntervals(n),each$f(n,function(d,f){d.index=f,d.text=this.formatValueText(d.interval)},this)},categories:function(n){var t=this.option;each$f(t.categories,function(r){n.push({text:this.formatValueText(r,!0),value:r})},this),normalizeReverse(t,n)},pieces:function(n){var t=this.option;each$f(t.pieces,function(r,a){isObject$4(r)||(r={value:r});var o={text:"",index:a};if(r.label!=null&&(o.text=r.label),r.hasOwnProperty("value")){var u=o.value=r.value;o.interval=[u,u],o.close=[1,1]}else{for(var s=o.interval=[],c=o.close=[0,0],l=[1,0,1],d=[-1/0,1/0],f=[],h=0;h<2;h++){for(var v=[["gte","gt","min"],["lte","lt","max"]][h],g=0;g<3&&s[h]==null;g++)s[h]=r[v[g]],c[h]=l[g],f[h]=g===2;s[h]==null&&(s[h]=d[h])}f[0]&&s[1]===1/0&&(c[0]=0),f[1]&&s[0]===-1/0&&(c[1]=0),s[0]===s[1]&&c[0]&&c[1]&&(o.value=s[0])}o.visual=VisualMapping.retrieveVisuals(r),n.push(o)},this),normalizeReverse(t,n),reformIntervals(n),each$f(n,function(r){var a=r.close,o=[["<",""][a[1]],[">",""][a[0]]];r.text=r.text||this.formatValueText(r.value!=null?r.value:r.interval,!1,o)},this)}};function normalizeReverse(n,t){var r=n.inverse;(n.orient==="vertical"?!r:r)&&t.reverse()}var PiecewiseVisualMapView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.doRender=function(){var r=this.group;r.removeAll();var a=this.visualMapModel,o=a.get("textGap"),u=a.textStyleModel,s=u.getFont(),c=u.getTextColor(),l=this._getItemAlign(),d=a.itemSize,f=this._getViewData(),h=f.endsText,v=retrieve(a.get("showLabel",!0),!h),g=!a.get("selectedMode");h&&this._renderEndsText(r,h[0],d,v,l),each$f(f.viewPieceList,function(b){var _=b.piece,S=new Group$3;S.onclick=bind$1(this._onItemClick,this,_),this._enableHoverLink(S,b.indexInModelPieceList);var T=a.getRepresentValue(_);if(this._createItemSymbol(S,T,[0,0,d[0],d[1]],g),v){var w=this.visualMapModel.getValueState(T);S.add(new ZRText({style:{x:l==="right"?-o:d[0]+o,y:d[1]/2,text:_.text,verticalAlign:"middle",align:l,font:s,fill:c,opacity:w==="outOfRange"?.5:1},silent:g}))}r.add(S)},this),h&&this._renderEndsText(r,h[1],d,v,l),box(a.get("orient"),r,a.get("itemGap")),this.renderBackground(r),this.positionGroup(r)},t.prototype._enableHoverLink=function(r,a){var o=this;r.on("mouseover",function(){return u("highlight")}).on("mouseout",function(){return u("downplay")});var u=function(s){var c=o.visualMapModel;c.option.hoverLink&&o.api.dispatchAction({type:s,batch:makeHighDownBatch(c.findTargetDataIndices(a),c)})}},t.prototype._getItemAlign=function(){var r=this.visualMapModel,a=r.option;if(a.orient==="vertical")return getItemAlign(r,this.api,r.itemSize);var o=a.align;return(!o||o==="auto")&&(o="left"),o},t.prototype._renderEndsText=function(r,a,o,u,s){if(a){var c=new Group$3,l=this.visualMapModel.textStyleModel;c.add(new ZRText({style:createTextStyle(l,{x:u?s==="right"?o[0]:0:o[0]/2,y:o[1]/2,verticalAlign:"middle",align:u?s:"center",text:a})})),r.add(c)}},t.prototype._getViewData=function(){var r=this.visualMapModel,a=map$1(r.getPieceList(),function(c,l){return{piece:c,indexInModelPieceList:l}}),o=r.get("text"),u=r.get("orient"),s=r.get("inverse");return(u==="horizontal"?s:!s)?a.reverse():o&&(o=o.slice().reverse()),{viewPieceList:a,endsText:o}},t.prototype._createItemSymbol=function(r,a,o,u){var s=createSymbol$1(this.getControllerVisual(a,"symbol"),o[0],o[1],o[2],o[3],this.getControllerVisual(a,"color"));s.silent=u,r.add(s)},t.prototype._onItemClick=function(r){var a=this.visualMapModel,o=a.option,u=o.selectedMode;if(u){var s=clone$5(o.selected),c=a.getSelectedMapKey(r);u==="single"||u===!0?(s[c]=!0,each$f(s,function(l,d){s[d]=d===c})):s[c]=!s[c],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:s})}},t.type="visualMap.piecewise",t}(VisualMapView);function install$4(n){n.registerComponentModel(PiecewiseModel),n.registerComponentView(PiecewiseVisualMapView),installCommon(n)}function install$3(n){use(install$5),use(install$4)}var DEFAULT_OPTION={label:{enabled:!0},decal:{show:!1}},inner=makeInner(),decalPaletteScope={};function ariaVisual(n,t){var r=n.getModel("aria");if(!r.get("enabled"))return;var a=clone$5(DEFAULT_OPTION);merge$3(a.label,n.getLocaleModel().get("aria"),!1),merge$3(r.option,a,!1),o(),u();function o(){var d=r.getModel("decal"),f=d.get("show");if(f){var h=createHashMap();n.eachSeries(function(v){if(!v.isColorBySeries()){var g=h.get(v.type);g||(g={},h.set(v.type,g)),inner(v).scope=g}}),n.eachRawSeries(function(v){if(n.isSeriesFiltered(v))return;if(isFunction$1(v.enableAriaDecal)){v.enableAriaDecal();return}var g=v.getData();if(v.isColorBySeries()){var w=getDecalFromPalette(v.ecModel,v.name,decalPaletteScope,n.getSeriesCount()),A=g.getVisual("decal");g.setVisual("decal",R(A,w))}else{var b=v.getRawData(),_={},S=inner(v).scope;g.each(function(E){var I=g.getRawIndex(E);_[I]=E});var T=b.count();b.each(function(E){var I=_[E],L=b.getName(E)||E+"",F=getDecalFromPalette(v.ecModel,L,S,T),D=g.getItemVisual(I,"decal");g.setItemVisual(I,"decal",R(D,F))})}function R(E,I){var L=E?extend$1(extend$1({},I),E):I;return L.dirty=!0,L}})}}function u(){var d=t.getZr().dom;if(d){var f=n.getLocaleModel().get("aria"),h=r.getModel("label");if(h.option=defaults$h(h.option,f),!!h.get("enabled")){if(d.setAttribute("role","img"),h.get("description")){d.setAttribute("aria-label",h.get("description"));return}var v=n.getSeriesCount(),g=h.get(["data","maxCount"])||10,b=h.get(["series","maxCount"])||10,_=Math.min(v,b),S;if(!(v<1)){var T=c();if(T){var w=h.get(["general","withTitle"]);S=s(w,{title:T})}else S=h.get(["general","withoutTitle"]);var A=[],R=v>1?h.get(["series","multiple","prefix"]):h.get(["series","single","prefix"]);S+=s(R,{seriesCount:v}),n.eachSeries(function(F,D){if(D<_){var $=void 0,O=F.get("name"),P=O?"withName":"withoutName";$=v>1?h.get(["series","multiple",P]):h.get(["series","single",P]),$=s($,{seriesId:F.seriesIndex,seriesName:F.get("name"),seriesType:l(F.subType)});var C=F.getData();if(C.count()>g){var q=h.get(["data","partialData"]);$+=s(q,{displayCnt:g})}else $+=h.get(["data","allData"]);for(var M=h.get(["data","separator","middle"]),N=h.get(["data","separator","end"]),G=h.get(["data","excludeDimensionId"]),X=[],Y=0;Y<C.count();Y++)if(Y<g){var W=C.getName(Y),te=G?filter$1(C.getValues(Y),function(fe,re){return indexOf(G,re)===-1}):C.getValues(Y),ue=h.get(["data",W?"withName":"withoutName"]);X.push(s(ue,{name:W,value:te.join(M)}))}$+=X.join(M)+N,A.push($)}});var E=h.getModel(["series","multiple","separator"]),I=E.get("middle"),L=E.get("end");S+=A.join(I)+L,d.setAttribute("aria-label",S)}}}}function s(d,f){if(!isString(d))return d;var h=d;return each$f(f,function(v,g){h=h.replace(new RegExp("\\{\\s*"+g+"\\s*\\}","g"),v)}),h}function c(){var d=n.get("title");return d&&d.length&&(d=d[0]),d&&d.text}function l(d){var f=n.getLocaleModel().get(["series","typeNames"]);return f[d]||f.chart}}function ariaPreprocessor(n){if(!(!n||!n.aria)){var t=n.aria;t.show!=null&&(t.enabled=t.show),t.label=t.label||{},each$f(["description","general","series","data"],function(r){t[r]!=null&&(t.label[r]=t[r])})}}function install$2(n){n.registerPreprocessor(ariaPreprocessor),n.registerVisual(n.PRIORITY.VISUAL.ARIA,ariaVisual)}var RELATIONAL_EXPRESSION_OP_ALIAS_MAP={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},RegExpEvaluator=function(){function n(t){var r=this._condVal=isString(t)?new RegExp(t):isRegExp(t)?t:null;if(r==null){var a="";throwError(a)}}return n.prototype.evaluate=function(t){var r=typeof t;return isString(r)?this._condVal.test(t):isNumber(r)?this._condVal.test(t+""):!1},n}(),ConstConditionInternal=function(){function n(){}return n.prototype.evaluate=function(){return this.value},n}(),AndConditionInternal=function(){function n(){}return n.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(!t[r].evaluate())return!1;return!0},n}(),OrConditionInternal=function(){function n(){}return n.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(t[r].evaluate())return!0;return!1},n}(),NotConditionInternal=function(){function n(){}return n.prototype.evaluate=function(){return!this.child.evaluate()},n}(),RelationalConditionInternal=function(){function n(){}return n.prototype.evaluate=function(){for(var t=!!this.valueParser,r=this.getValue,a=r(this.valueGetterParam),o=t?this.valueParser(a):null,u=0;u<this.subCondList.length;u++)if(!this.subCondList[u].evaluate(t?o:a))return!1;return!0},n}();function parseOption(n,t){if(n===!0||n===!1){var r=new ConstConditionInternal;return r.value=n,r}var a="";return isObjectNotArray(n)||throwError(a),n.and?parseAndOrOption("and",n,t):n.or?parseAndOrOption("or",n,t):n.not?parseNotOption(n,t):parseRelationalOption(n,t)}function parseAndOrOption(n,t,r){var a=t[n],o="";isArray$2(a)||throwError(o),a.length||throwError(o);var u=n==="and"?new AndConditionInternal:new OrConditionInternal;return u.children=map$1(a,function(s){return parseOption(s,r)}),u.children.length||throwError(o),u}function parseNotOption(n,t){var r=n.not,a="";isObjectNotArray(r)||throwError(a);var o=new NotConditionInternal;return o.child=parseOption(r,t),o.child||throwError(a),o}function parseRelationalOption(n,t){for(var r="",a=t.prepareGetValue(n),o=[],u=keys(n),s=n.parser,c=s?getRawValueParser(s):null,l=0;l<u.length;l++){var d=u[l];if(!(d==="parser"||t.valueGetterAttrMap.get(d))){var f=hasOwn(RELATIONAL_EXPRESSION_OP_ALIAS_MAP,d)?RELATIONAL_EXPRESSION_OP_ALIAS_MAP[d]:d,h=n[d],v=c?c(h):h,g=createFilterComparator(f,v)||f==="reg"&&new RegExpEvaluator(v);g||throwError(r),o.push(g)}}o.length||throwError(r);var b=new RelationalConditionInternal;return b.valueGetterParam=a,b.valueParser=c,b.getValue=t.getValue,b.subCondList=o,b}function isObjectNotArray(n){return isObject$4(n)&&!isArrayLike$1(n)}var ConditionalExpressionParsed=function(){function n(t,r){this._cond=parseOption(t,r)}return n.prototype.evaluate=function(){return this._cond.evaluate()},n}();function parseConditionalExpression(n,t){return new ConditionalExpressionParsed(n,t)}var filterTransform={type:"echarts:filter",transform:function(n){for(var t=n.upstream,r,a=parseConditionalExpression(n.config,{valueGetterAttrMap:createHashMap({dimension:!0}),prepareGetValue:function(c){var l="",d=c.dimension;hasOwn(c,"dimension")||throwError(l);var f=t.getDimensionInfo(d);return f||throwError(l),{dimIdx:f.index}},getValue:function(c){return t.retrieveValueFromItem(r,c.dimIdx)}}),o=[],u=0,s=t.count();u<s;u++)r=t.getRawDataItem(u),a.evaluate()&&o.push(r);return{data:o}}},sortTransform={type:"echarts:sort",transform:function(n){var t=n.upstream,r=n.config,a="",o=normalizeToArray(r);o.length||throwError(a);var u=[];each$f(o,function(f){var h=f.dimension,v=f.order,g=f.parser,b=f.incomparable;if(h==null&&throwError(a),v!=="asc"&&v!=="desc"&&throwError(a),b&&b!=="min"&&b!=="max"){var _="";throwError(_)}if(v!=="asc"&&v!=="desc"){var S="";throwError(S)}var T=t.getDimensionInfo(h);T||throwError(a);var w=g?getRawValueParser(g):null;g&&!w&&throwError(a),u.push({dimIdx:T.index,parser:w,comparator:new SortOrderComparator(v,b)})});var s=t.sourceFormat;s!==SOURCE_FORMAT_ARRAY_ROWS&&s!==SOURCE_FORMAT_OBJECT_ROWS&&throwError(a);for(var c=[],l=0,d=t.count();l<d;l++)c.push(t.getRawDataItem(l));return c.sort(function(f,h){for(var v=0;v<u.length;v++){var g=u[v],b=t.retrieveValueFromItem(f,g.dimIdx),_=t.retrieveValueFromItem(h,g.dimIdx);g.parser&&(b=g.parser(b),_=g.parser(_));var S=g.comparator.evaluate(b,_);if(S!==0)return S}return 0}),{data:c}}};function install$1(n){n.registerTransform(filterTransform),n.registerTransform(sortTransform)}var DatasetModel=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="dataset",r}return t.prototype.init=function(r,a,o){n.prototype.init.call(this,r,a,o),this._sourceManager=new SourceManager(this),disableTransformOptionMerge(this)},t.prototype.mergeOption=function(r,a){n.prototype.mergeOption.call(this,r,a),disableTransformOptionMerge(this)},t.prototype.optionUpdated=function(){this._sourceManager.dirty()},t.prototype.getSourceManager=function(){return this._sourceManager},t.type="dataset",t.defaultOption={seriesLayoutBy:SERIES_LAYOUT_BY_COLUMN},t}(ComponentModel),DatasetView=function(n){__extends(t,n);function t(){var r=n!==null&&n.apply(this,arguments)||this;return r.type="dataset",r}return t.type="dataset",t}(ComponentView);function install(n){n.registerComponentModel(DatasetModel),n.registerComponentView(DatasetView)}var CMD=PathProxy.CMD;function aroundEqual(n,t){return Math.abs(n-t)<1e-5}function pathToBezierCurves(n){var t=n.data,r=n.len(),a=[],o,u=0,s=0,c=0,l=0;function d(C,q){o&&o.length>2&&a.push(o),o=[C,q]}function f(C,q,M,N){aroundEqual(C,M)&&aroundEqual(q,N)||o.push(C,q,M,N,M,N)}function h(C,q,M,N,G,X){var Y=Math.abs(q-C),W=Math.tan(Y/4)*4/3,te=q<C?-1:1,ue=Math.cos(C),fe=Math.sin(C),re=Math.cos(q),ye=Math.sin(q),Te=ue*G+M,Re=fe*X+N,ve=re*G+M,ce=ye*X+N,J=G*W*te,j=X*W*te;o.push(Te-J*fe,Re+j*ue,ve+J*ye,ce-j*re,ve,ce)}for(var v,g,b,_,S=0;S<r;){var T=t[S++],w=S===1;switch(w&&(u=t[S],s=t[S+1],c=u,l=s,(T===CMD.L||T===CMD.C||T===CMD.Q)&&(o=[c,l])),T){case CMD.M:u=c=t[S++],s=l=t[S++],d(c,l);break;case CMD.L:v=t[S++],g=t[S++],f(u,s,v,g),u=v,s=g;break;case CMD.C:o.push(t[S++],t[S++],t[S++],t[S++],u=t[S++],s=t[S++]);break;case CMD.Q:v=t[S++],g=t[S++],b=t[S++],_=t[S++],o.push(u+2/3*(v-u),s+2/3*(g-s),b+2/3*(v-b),_+2/3*(g-_),b,_),u=b,s=_;break;case CMD.A:var A=t[S++],R=t[S++],E=t[S++],I=t[S++],L=t[S++],F=t[S++]+L;S+=1;var D=!t[S++];v=Math.cos(L)*E+A,g=Math.sin(L)*I+R,w?(c=v,l=g,d(c,l)):f(u,s,v,g),u=Math.cos(F)*E+A,s=Math.sin(F)*I+R;for(var $=(D?-1:1)*Math.PI/2,O=L;D?O>F:O<F;O+=$){var P=D?Math.max(O+$,F):Math.min(O+$,F);h(O,P,A,R,E,I)}break;case CMD.R:c=u=t[S++],l=s=t[S++],v=c+t[S++],g=l+t[S++],d(v,l),f(v,l,v,g),f(v,g,c,g),f(c,g,c,l),f(c,l,v,l);break;case CMD.Z:o&&f(u,s,c,l),u=c,s=l;break}}return o&&o.length>2&&a.push(o),a}function adpativeBezier(n,t,r,a,o,u,s,c,l,d){if(aroundEqual(n,r)&&aroundEqual(t,a)&&aroundEqual(o,s)&&aroundEqual(u,c)){l.push(s,c);return}var f=2/d,h=f*f,v=s-n,g=c-t,b=Math.sqrt(v*v+g*g);v/=b,g/=b;var _=r-n,S=a-t,T=o-s,w=u-c,A=_*_+S*S,R=T*T+w*w;if(A<h&&R<h){l.push(s,c);return}var E=v*_+g*S,I=-v*T-g*w,L=A-E*E,F=R-I*I;if(L<h&&E>=0&&F<h&&I>=0){l.push(s,c);return}var D=[],$=[];cubicSubdivide(n,r,o,s,.5,D),cubicSubdivide(t,a,u,c,.5,$),adpativeBezier(D[0],$[0],D[1],$[1],D[2],$[2],D[3],$[3],l,d),adpativeBezier(D[4],$[4],D[5],$[5],D[6],$[6],D[7],$[7],l,d)}function pathToPolygons(n,t){var r=pathToBezierCurves(n),a=[];t=t||1;for(var o=0;o<r.length;o++){var u=r[o],s=[],c=u[0],l=u[1];s.push(c,l);for(var d=2;d<u.length;){var f=u[d++],h=u[d++],v=u[d++],g=u[d++],b=u[d++],_=u[d++];adpativeBezier(c,l,f,h,v,g,b,_,s,t),c=b,l=_}a.push(s)}return a}function getDividingGrids(n,t,r){var a=n[t],o=n[1-t],u=Math.abs(a/o),s=Math.ceil(Math.sqrt(u*r)),c=Math.floor(r/s);c===0&&(c=1,s=r);for(var l=[],d=0;d<s;d++)l.push(c);var f=s*c,h=r-f;if(h>0)for(var d=0;d<h;d++)l[d%s]+=1;return l}function divideSector(n,t,r){for(var a=n.r0,o=n.r,u=n.startAngle,s=n.endAngle,c=Math.abs(s-u),l=c*o,d=o-a,f=l>Math.abs(d),h=getDividingGrids([l,d],f?0:1,t),v=(f?c:d)/h.length,g=0;g<h.length;g++)for(var b=(f?d:c)/h[g],_=0;_<h[g];_++){var S={};f?(S.startAngle=u+v*g,S.endAngle=u+v*(g+1),S.r0=a+b*_,S.r=a+b*(_+1)):(S.startAngle=u+b*_,S.endAngle=u+b*(_+1),S.r0=a+v*g,S.r=a+v*(g+1)),S.clockwise=n.clockwise,S.cx=n.cx,S.cy=n.cy,r.push(S)}}function divideRect(n,t,r){for(var a=n.width,o=n.height,u=a>o,s=getDividingGrids([a,o],u?0:1,t),c=u?"width":"height",l=u?"height":"width",d=u?"x":"y",f=u?"y":"x",h=n[c]/s.length,v=0;v<s.length;v++)for(var g=n[l]/s[v],b=0;b<s[v];b++){var _={};_[d]=v*h,_[f]=b*g,_[c]=h,_[l]=g,_.x+=n.x,_.y+=n.y,r.push(_)}}function crossProduct2d(n,t,r,a){return n*a-r*t}function lineLineIntersect(n,t,r,a,o,u,s,c){var l=r-n,d=a-t,f=s-o,h=c-u,v=crossProduct2d(f,h,l,d);if(Math.abs(v)<1e-6)return null;var g=n-o,b=t-u,_=crossProduct2d(g,b,f,h)/v;return _<0||_>1?null:new Point(_*l+n,_*d+t)}function projPtOnLine(n,t,r){var a=new Point;Point.sub(a,r,t),a.normalize();var o=new Point;Point.sub(o,n,t);var u=o.dot(a);return u}function addToPoly(n,t){var r=n[n.length-1];r&&r[0]===t[0]&&r[1]===t[1]||n.push(t)}function splitPolygonByLine(n,t,r){for(var a=n.length,o=[],u=0;u<a;u++){var s=n[u],c=n[(u+1)%a],l=lineLineIntersect(s[0],s[1],c[0],c[1],t.x,t.y,r.x,r.y);l&&o.push({projPt:projPtOnLine(l,t,r),pt:l,idx:u})}if(o.length<2)return[{points:n},{points:n}];o.sort(function(S,T){return S.projPt-T.projPt});var d=o[0],f=o[o.length-1];if(f.idx<d.idx){var h=d;d=f,f=h}for(var v=[d.pt.x,d.pt.y],g=[f.pt.x,f.pt.y],b=[v],_=[g],u=d.idx+1;u<=f.idx;u++)addToPoly(b,n[u].slice());addToPoly(b,g),addToPoly(b,v);for(var u=f.idx+1;u<=d.idx+a;u++)addToPoly(_,n[u%a].slice());return addToPoly(_,v),addToPoly(_,g),[{points:b},{points:_}]}function binaryDividePolygon(n){var t=n.points,r=[],a=[];fromPoints(t,r,a);var o=new BoundingRect(r[0],r[1],a[0]-r[0],a[1]-r[1]),u=o.width,s=o.height,c=o.x,l=o.y,d=new Point,f=new Point;return u>s?(d.x=f.x=c+u/2,d.y=l,f.y=l+s):(d.y=f.y=l+s/2,d.x=c,f.x=c+u),splitPolygonByLine(t,d,f)}function binaryDivideRecursive(n,t,r,a){if(r===1)a.push(t);else{var o=Math.floor(r/2),u=n(t);binaryDivideRecursive(n,u[0],o,a),binaryDivideRecursive(n,u[1],r-o,a)}return a}function clone$1(n,t){for(var r=[],a=0;a<t;a++)r.push(clonePath(n));return r}function copyPathProps(n,t){t.setStyle(n.style),t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel}function polygonConvert(n){for(var t=[],r=0;r<n.length;)t.push([n[r++],n[r++]]);return t}function split(n,t){var r=[],a=n.shape,o;switch(n.type){case"rect":divideRect(a,t,r),o=Rect$2;break;case"sector":divideSector(a,t,r),o=Sector;break;case"circle":divideSector({r0:0,r:a.r,startAngle:0,endAngle:Math.PI*2,cx:a.cx,cy:a.cy},t,r),o=Sector;break;default:var u=n.getComputedTransform(),s=u?Math.sqrt(Math.max(u[0]*u[0]+u[1]*u[1],u[2]*u[2]+u[3]*u[3])):1,c=map$1(pathToPolygons(n.getUpdatedPathProxy(),s),function(T){return polygonConvert(T)}),l=c.length;if(l===0)binaryDivideRecursive(binaryDividePolygon,{points:c[0]},t,r);else if(l===t)for(var d=0;d<l;d++)r.push({points:c[d]});else{var f=0,h=map$1(c,function(T){var w=[],A=[];fromPoints(T,w,A);var R=(A[1]-w[1])*(A[0]-w[0]);return f+=R,{poly:T,area:R}});h.sort(function(T,w){return w.area-T.area});for(var v=t,d=0;d<l;d++){var g=h[d];if(v<=0)break;var b=d===l-1?v:Math.ceil(g.area/f*t);b<0||(binaryDivideRecursive(binaryDividePolygon,{points:g.poly},b,r),v-=b)}}o=Polygon;break}if(!o)return clone$1(n,t);for(var _=[],d=0;d<r.length;d++){var S=new o;S.setShape(r[d]),copyPathProps(n,S),_.push(S)}return _}function alignSubpath(n,t){var r=n.length,a=t.length;if(r===a)return[n,t];for(var o=[],u=[],s=r<a?n:t,c=Math.min(r,a),l=Math.abs(a-r)/6,d=(c-2)/6,f=Math.ceil(l/d)+1,h=[s[0],s[1]],v=l,g=2;g<c;){var b=s[g-2],_=s[g-1],S=s[g++],T=s[g++],w=s[g++],A=s[g++],R=s[g++],E=s[g++];if(v<=0){h.push(S,T,w,A,R,E);continue}for(var I=Math.min(v,f-1)+1,L=1;L<=I;L++){var F=L/I;cubicSubdivide(b,S,w,R,F,o),cubicSubdivide(_,T,A,E,F,u),b=o[3],_=u[3],h.push(o[1],u[1],o[2],u[2],b,_),S=o[5],T=u[5],w=o[6],A=u[6]}v-=I-1}return s===n?[h,t]:[n,h]}function createSubpath(n,t){for(var r=n.length,a=n[r-2],o=n[r-1],u=[],s=0;s<t.length;)u[s++]=a,u[s++]=o;return u}function alignBezierCurves(n,t){for(var r,a,o,u=[],s=[],c=0;c<Math.max(n.length,t.length);c++){var l=n[c],d=t[c],f=void 0,h=void 0;l?d?(r=alignSubpath(l,d),f=r[0],h=r[1],a=f,o=h):(h=createSubpath(o||l,l),f=l):(f=createSubpath(a||d,d),h=d),u.push(f),s.push(h)}return[u,s]}function centroid(n){for(var t=0,r=0,a=0,o=n.length,u=0,s=o-2;u<o;s=u,u+=2){var c=n[s],l=n[s+1],d=n[u],f=n[u+1],h=c*f-d*l;t+=h,r+=(c+d)*h,a+=(l+f)*h}return t===0?[n[0]||0,n[1]||0]:[r/t/3,a/t/3,t]}function findBestRingOffset(n,t,r,a){for(var o=(n.length-2)/6,u=1/0,s=0,c=n.length,l=c-2,d=0;d<o;d++){for(var f=d*6,h=0,v=0;v<c;v+=2){var g=v===0?f:(f+v-2)%l+2,b=n[g]-r[0],_=n[g+1]-r[1],S=t[v]-a[0],T=t[v+1]-a[1],w=S-b,A=T-_;h+=w*w+A*A}h<u&&(u=h,s=d)}return s}function reverse(n){for(var t=[],r=n.length,a=0;a<r;a+=2)t[a]=n[r-a-2],t[a+1]=n[r-a-1];return t}function findBestMorphingRotation(n,t,r,a){for(var o=[],u,s=0;s<n.length;s++){var c=n[s],l=t[s],d=centroid(c),f=centroid(l);u==null&&(u=d[2]<0!=f[2]<0);var h=[],v=[],g=0,b=1/0,_=[],S=c.length;u&&(c=reverse(c));for(var T=findBestRingOffset(c,l,d,f)*6,w=S-2,A=0;A<w;A+=2){var R=(T+A)%w+2;h[A+2]=c[R]-d[0],h[A+3]=c[R+1]-d[1]}h[0]=c[T]-d[0],h[1]=c[T+1]-d[1];for(var E=a/r,I=-a/2;I<=a/2;I+=E){for(var L=Math.sin(I),F=Math.cos(I),D=0,A=0;A<c.length;A+=2){var $=h[A],O=h[A+1],P=l[A]-f[0],C=l[A+1]-f[1],q=P*F-C*L,M=P*L+C*F;_[A]=q,_[A+1]=M;var N=q-$,G=M-O;D+=N*N+G*G}if(D<b){b=D,g=I;for(var X=0;X<_.length;X++)v[X]=_[X]}}o.push({from:h,to:v,fromCp:d,toCp:f,rotation:-g})}return o}function isCombineMorphing(n){return n.__isCombineMorphing}var SAVED_METHOD_PREFIX="__mOriginal_";function saveAndModifyMethod(n,t,r){var a=SAVED_METHOD_PREFIX+t,o=n[a]||n[t];n[a]||(n[a]=n[t]);var u=r.replace,s=r.after,c=r.before;n[t]=function(){var l=arguments,d;return c&&c.apply(this,l),u?d=u.apply(this,l):d=o.apply(this,l),s&&s.apply(this,l),d}}function restoreMethod(n,t){var r=SAVED_METHOD_PREFIX+t;n[r]&&(n[t]=n[r],n[r]=null)}function applyTransformOnBeziers(n,t){for(var r=0;r<n.length;r++)for(var a=n[r],o=0;o<a.length;){var u=a[o],s=a[o+1];a[o++]=t[0]*u+t[2]*s+t[4],a[o++]=t[1]*u+t[3]*s+t[5]}}function prepareMorphPath(n,t){var r=n.getUpdatedPathProxy(),a=t.getUpdatedPathProxy(),o=alignBezierCurves(pathToBezierCurves(r),pathToBezierCurves(a)),u=o[0],s=o[1],c=n.getComputedTransform(),l=t.getComputedTransform();function d(){this.transform=null}c&&applyTransformOnBeziers(u,c),l&&applyTransformOnBeziers(s,l),saveAndModifyMethod(t,"updateTransform",{replace:d}),t.transform=null;var f=findBestMorphingRotation(u,s,10,Math.PI),h=[];saveAndModifyMethod(t,"buildPath",{replace:function(v){for(var g=t.__morphT,b=1-g,_=[],S=0;S<f.length;S++){var T=f[S],w=T.from,A=T.to,R=T.rotation*g,E=T.fromCp,I=T.toCp,L=Math.sin(R),F=Math.cos(R);lerp$1(_,E,I,g);for(var D=0;D<w.length;D+=2){var $=w[D],O=w[D+1],P=A[D],C=A[D+1],q=$*b+P*g,M=O*b+C*g;h[D]=q*F-M*L+_[0],h[D+1]=q*L+M*F+_[1]}var N=h[0],G=h[1];v.moveTo(N,G);for(var D=2;D<w.length;){var P=h[D++],C=h[D++],X=h[D++],Y=h[D++],W=h[D++],te=h[D++];N===P&&G===C&&X===W&&Y===te?v.lineTo(W,te):v.bezierCurveTo(P,C,X,Y,W,te),N=W,G=te}}}})}function morphPath(n,t,r){if(!n||!t)return t;var a=r.done,o=r.during;prepareMorphPath(n,t),t.__morphT=0;function u(){restoreMethod(t,"buildPath"),restoreMethod(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape()}return t.animateTo({__morphT:1},defaults$h({during:function(s){t.dirtyShape(),o&&o(s)},done:function(){u(),a&&a()}},r)),t}function hilbert(n,t,r,a,o,u){var s=16;n=o===r?0:Math.round(32767*(n-r)/(o-r)),t=u===a?0:Math.round(32767*(t-a)/(u-a));for(var c=0,l,d=(1<<s)/2;d>0;d/=2){var f=0,h=0;(n&d)>0&&(f=1),(t&d)>0&&(h=1),c+=d*d*(3*f^h),h===0&&(f===1&&(n=d-1-n,t=d-1-t),l=n,n=t,t=l)}return c}function sortPaths(n){var t=1/0,r=1/0,a=-1/0,o=-1/0,u=map$1(n,function(c){var l=c.getBoundingRect(),d=c.getComputedTransform(),f=l.x+l.width/2+(d?d[4]:0),h=l.y+l.height/2+(d?d[5]:0);return t=Math.min(f,t),r=Math.min(h,r),a=Math.max(f,a),o=Math.max(h,o),[f,h]}),s=map$1(u,function(c,l){return{cp:c,z:hilbert(c[0],c[1],t,r,a,o),path:n[l]}});return s.sort(function(c,l){return c.z-l.z}).map(function(c){return c.path})}function defaultDividePath(n){return split(n.path,n.count)}function createEmptyReturn(){return{fromIndividuals:[],toIndividuals:[],count:0}}function combineMorph(n,t,r){var a=[];function o(E){for(var I=0;I<E.length;I++){var L=E[I];isCombineMorphing(L)?o(L.childrenRef()):L instanceof Path&&a.push(L)}}o(n);var u=a.length;if(!u)return createEmptyReturn();var s=r.dividePath||defaultDividePath,c=s({path:t,count:u});if(c.length!==u)return console.error("Invalid morphing: unmatched splitted path"),createEmptyReturn();a=sortPaths(a),c=sortPaths(c);for(var l=r.done,d=r.during,f=r.individualDelay,h=new Transformable,v=0;v<u;v++){var g=a[v],b=c[v];b.parent=t,b.copyTransform(h),f||prepareMorphPath(g,b)}t.__isCombineMorphing=!0,t.childrenRef=function(){return c};function _(E){for(var I=0;I<c.length;I++)c[I].addSelfToZr(E)}saveAndModifyMethod(t,"addSelfToZr",{after:function(E){_(E)}}),saveAndModifyMethod(t,"removeSelfFromZr",{after:function(E){for(var I=0;I<c.length;I++)c[I].removeSelfFromZr(E)}});function S(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,restoreMethod(t,"addSelfToZr"),restoreMethod(t,"removeSelfFromZr")}var T=c.length;if(f)for(var w=T,A=function(){w--,w===0&&(S(),l&&l())},v=0;v<T;v++){var R=f?defaults$h({delay:(r.delay||0)+f(v,T,a[v],c[v]),done:A},r):r;morphPath(a[v],c[v],R)}else t.__morphT=0,t.animateTo({__morphT:1},defaults$h({during:function(E){for(var I=0;I<T;I++){var L=c[I];L.__morphT=t.__morphT,L.dirtyShape()}d&&d(E)},done:function(){S();for(var E=0;E<n.length;E++)restoreMethod(n[E],"updateTransform");l&&l()}},r));return t.__zr&&_(t.__zr),{fromIndividuals:a,toIndividuals:c,count:T}}function separateMorph(n,t,r){var a=t.length,o=[],u=r.dividePath||defaultDividePath;function s(g){for(var b=0;b<g.length;b++){var _=g[b];isCombineMorphing(_)?s(_.childrenRef()):_ instanceof Path&&o.push(_)}}if(isCombineMorphing(n)){s(n.childrenRef());var c=o.length;if(c<a)for(var l=0,d=c;d<a;d++)o.push(clonePath(o[l++%c]));o.length=a}else{o=u({path:n,count:a});for(var f=n.getComputedTransform(),d=0;d<o.length;d++)o[d].setLocalTransform(f);if(o.length!==a)return console.error("Invalid morphing: unmatched splitted path"),createEmptyReturn()}o=sortPaths(o),t=sortPaths(t);for(var h=r.individualDelay,d=0;d<a;d++){var v=h?defaults$h({delay:(r.delay||0)+h(d,a,o[d],t[d])},r):r;morphPath(o[d],t[d],v)}return{fromIndividuals:o,toIndividuals:t,count:t.length}}function isMultiple(n){return isArray$2(n[0])}function prepareMorphBatches(n,t){for(var r=[],a=n.length,o=0;o<a;o++)r.push({one:n[o],many:[]});for(var o=0;o<t.length;o++){var u=t[o].length,s=void 0;for(s=0;s<u;s++)r[s%a].many.push(t[o][s])}for(var c=0,o=a-1;o>=0;o--)if(!r[o].many.length){var l=r[c].many;if(l.length<=1)if(c)c=0;else return r;var u=l.length,d=Math.ceil(u/2);r[o].many=l.slice(d,u),r[c].many=l.slice(0,d),c++}return r}var pathDividers={clone:function(n){for(var t=[],r=1-Math.pow(1-n.path.style.opacity,1/n.count),a=0;a<n.count;a++){var o=clonePath(n.path);o.setStyle("opacity",r),t.push(o)}return t},split:null};function applyMorphAnimation(n,t,r,a,o,u){if(!n.length||!t.length)return;var s=getAnimationConfig("update",a,o);if(!(s&&s.duration>0))return;var c=a.getModel("universalTransition").get("delay"),l=Object.assign({setToFinal:!0},s),d,f;isMultiple(n)&&(d=n,f=t),isMultiple(t)&&(d=t,f=n);function h(T,w,A,R,E){var I=T.many,L=T.one;if(I.length===1&&!E){var F=w?I[0]:L,D=w?L:I[0];if(isCombineMorphing(F))h({many:[F],one:D},!0,A,R,!0);else{var $=c?defaults$h({delay:c(A,R)},l):l;morphPath(F,D,$),u(F,D,F,D,$)}}else for(var O=defaults$h({dividePath:pathDividers[r],individualDelay:c&&function(G,X,Y,W){return c(G+A,R)}},l),P=w?combineMorph(I,L,O):separateMorph(L,I,O),C=P.fromIndividuals,q=P.toIndividuals,M=C.length,N=0;N<M;N++){var $=c?defaults$h({delay:c(N,M)},l):l;u(C[N],q[N],w?I[N]:T.one,w?T.one:I[N],$)}}for(var v=d?d===n:n.length>t.length,g=d?prepareMorphBatches(f,d):prepareMorphBatches(v?t:n,[v?n:t]),b=0,_=0;_<g.length;_++)b+=g[_].many.length;for(var S=0,_=0;_<g.length;_++)h(g[_],v,S,b),S+=g[_].many.length}function getPathList(n){if(!n)return[];if(isArray$2(n)){for(var t=[],r=0;r<n.length;r++)t.push(getPathList(n[r]));return t}var a=[];return n.traverse(function(o){o instanceof Path&&!o.disableMorphing&&!o.invisible&&!o.ignore&&a.push(o)}),a}var DATA_COUNT_THRESHOLD=1e4,TRANSITION_NONE=0,TRANSITION_P2C=1,TRANSITION_C2P=2,getUniversalTransitionGlobalStore=makeInner();function getDimension(n,t){for(var r=n.dimensions,a=0;a<r.length;a++){var o=n.getDimensionInfo(r[a]);if(o&&o.otherDims[t]===0)return r[a]}}function getValueByDimension(n,t,r){var a=n.getDimensionInfo(r),o=a&&a.ordinalMeta;if(a){var u=n.get(a.name,t);return o&&o.categories[u]||u+""}}function getGroupId(n,t,r,a){var o=a?"itemChildGroupId":"itemGroupId",u=getDimension(n,o);if(u){var s=getValueByDimension(n,t,u);return s}var c=n.getRawDataItem(t),l=a?"childGroupId":"groupId";if(c&&c[l])return c[l]+"";if(!a)return r||n.getId(t)}function flattenDataDiffItems(n){var t=[];return each$f(n,function(r){var a=r.data,o=r.dataGroupId;if(!(a.count()>DATA_COUNT_THRESHOLD))for(var u=a.getIndices(),s=0;s<u.length;s++)t.push({data:a,groupId:getGroupId(a,s,o,!1),childGroupId:getGroupId(a,s,o,!0),divide:r.divide,dataIndex:s})}),t}function fadeInElement(n,t,r){n.traverse(function(a){a instanceof Path&&initProps(a,{style:{opacity:0}},t,{dataIndex:r,isFrom:!0})})}function removeEl(n){if(n.parent){var t=n.getComputedTransform();n.setLocalTransform(t),n.parent.remove(n)}}function stopAnimation(n){n.stopAnimation(),n.isGroup&&n.traverse(function(t){t.stopAnimation()})}function animateElementStyles(n,t,r){var a=getAnimationConfig("update",r,t);a&&n.traverse(function(o){if(o instanceof Displayable){var u=getOldStyle(o);u&&o.animateFrom({style:u},a)}})}function isAllIdSame(n,t){var r=n.length;if(r!==t.length)return!1;for(var a=0;a<r;a++){var o=n[a],u=t[a];if(o.data.getId(o.dataIndex)!==u.data.getId(u.dataIndex))return!1}return!0}function transitionBetween(n,t,r){var a=flattenDataDiffItems(n),o=flattenDataDiffItems(t);function u(A,R,E,I,L){(E||A)&&R.animateFrom({style:E&&E!==A?extend$1(extend$1({},E.style),A.style):A.style},L)}var s=!1,c=TRANSITION_NONE,l=createHashMap(),d=createHashMap();a.forEach(function(A){A.groupId&&l.set(A.groupId,!0),A.childGroupId&&d.set(A.childGroupId,!0)});for(var f=0;f<o.length;f++){var h=o[f].groupId;if(d.get(h)){c=TRANSITION_P2C;break}var v=o[f].childGroupId;if(v&&l.get(v)){c=TRANSITION_C2P;break}}function g(A,R){return function(E){var I=E.data,L=E.dataIndex;return R?I.getId(L):A?c===TRANSITION_P2C?E.childGroupId:E.groupId:c===TRANSITION_C2P?E.childGroupId:E.groupId}}var b=isAllIdSame(a,o),_={};if(!b)for(var f=0;f<o.length;f++){var S=o[f],T=S.data.getItemGraphicEl(S.dataIndex);T&&(_[T.id]=!0)}function w(A,R){var E=a[R],I=o[A],L=I.data.hostModel,F=E.data.getItemGraphicEl(E.dataIndex),D=I.data.getItemGraphicEl(I.dataIndex);if(F===D){D&&animateElementStyles(D,I.dataIndex,L);return}F&&_[F.id]||D&&(stopAnimation(D),F?(stopAnimation(F),removeEl(F),s=!0,applyMorphAnimation(getPathList(F),getPathList(D),I.divide,L,A,u)):fadeInElement(D,L,A))}new DataDiffer(a,o,g(!0,b),g(!1,b),null,"multiple").update(w).updateManyToOne(function(A,R){var E=o[A],I=E.data,L=I.hostModel,F=I.getItemGraphicEl(E.dataIndex),D=filter$1(map$1(R,function($){return a[$].data.getItemGraphicEl(a[$].dataIndex)}),function($){return $&&$!==F&&!_[$.id]});F&&(stopAnimation(F),D.length?(each$f(D,function($){stopAnimation($),removeEl($)}),s=!0,applyMorphAnimation(getPathList(D),getPathList(F),E.divide,L,A,u)):fadeInElement(F,L,E.dataIndex))}).updateOneToMany(function(A,R){var E=a[R],I=E.data.getItemGraphicEl(E.dataIndex);if(!(I&&_[I.id])){var L=filter$1(map$1(A,function(D){return o[D].data.getItemGraphicEl(o[D].dataIndex)}),function(D){return D&&D!==I}),F=o[A[0]].data.hostModel;L.length&&(each$f(L,function(D){return stopAnimation(D)}),I?(stopAnimation(I),removeEl(I),s=!0,applyMorphAnimation(getPathList(I),getPathList(L),E.divide,F,A[0],u)):each$f(L,function(D){return fadeInElement(D,F,A[0])}))}}).updateManyToMany(function(A,R){new DataDiffer(R,A,function(E){return a[E].data.getId(a[E].dataIndex)},function(E){return o[E].data.getId(o[E].dataIndex)}).update(function(E,I){w(A[E],R[I])}).execute()}).execute(),s&&each$f(t,function(A){var R=A.data,E=R.hostModel,I=E&&r.getViewOfSeriesModel(E),L=getAnimationConfig("update",E,0);I&&E.isAnimationEnabled()&&L&&L.duration>0&&I.group.traverse(function(F){F instanceof Path&&!F.animators.length&&F.animateFrom({style:{opacity:0}},L)})})}function getSeriesTransitionKey(n){var t=n.getModel("universalTransition").get("seriesKey");return t||n.id}function convertArraySeriesKeyToString(n){return isArray$2(n)?n.sort().join(","):n}function getDivideShapeFromData(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function findTransitionSeriesBatches(n,t){var r=createHashMap(),a=createHashMap(),o=createHashMap();return each$f(n.oldSeries,function(u,s){var c=n.oldDataGroupIds[s],l=n.oldData[s],d=getSeriesTransitionKey(u),f=convertArraySeriesKeyToString(d);a.set(f,{dataGroupId:c,data:l}),isArray$2(d)&&each$f(d,function(h){o.set(h,{key:f,dataGroupId:c,data:l})})}),each$f(t.updatedSeries,function(u){if(u.isUniversalTransitionEnabled()&&u.isAnimationEnabled()){var s=u.get("dataGroupId"),c=u.getData(),l=getSeriesTransitionKey(u),d=convertArraySeriesKeyToString(l),f=a.get(d);if(f)r.set(d,{oldSeries:[{dataGroupId:f.dataGroupId,divide:getDivideShapeFromData(f.data),data:f.data}],newSeries:[{dataGroupId:s,divide:getDivideShapeFromData(c),data:c}]});else if(isArray$2(l)){var h=[];each$f(l,function(b){var _=a.get(b);_.data&&h.push({dataGroupId:_.dataGroupId,divide:getDivideShapeFromData(_.data),data:_.data})}),h.length&&r.set(d,{oldSeries:h,newSeries:[{dataGroupId:s,data:c,divide:getDivideShapeFromData(c)}]})}else{var v=o.get(l);if(v){var g=r.get(v.key);g||(g={oldSeries:[{dataGroupId:v.dataGroupId,data:v.data,divide:getDivideShapeFromData(v.data)}],newSeries:[]},r.set(v.key,g)),g.newSeries.push({dataGroupId:s,data:c,divide:getDivideShapeFromData(c)})}}}}),r}function querySeries(n,t){for(var r=0;r<n.length;r++){var a=t.seriesIndex!=null&&t.seriesIndex===n[r].seriesIndex||t.seriesId!=null&&t.seriesId===n[r].id;if(a)return r}}function transitionSeriesFromOpt(n,t,r,a){var o=[],u=[];each$f(normalizeToArray(n.from),function(s){var c=querySeries(t.oldSeries,s);c>=0&&o.push({dataGroupId:t.oldDataGroupIds[c],data:t.oldData[c],divide:getDivideShapeFromData(t.oldData[c]),groupIdDim:s.dimension})}),each$f(normalizeToArray(n.to),function(s){var c=querySeries(r.updatedSeries,s);if(c>=0){var l=r.updatedSeries[c].getData();u.push({dataGroupId:t.oldDataGroupIds[c],data:l,divide:getDivideShapeFromData(l),groupIdDim:s.dimension})}}),o.length>0&&u.length>0&&transitionBetween(o,u,a)}function installUniversalTransition(n){n.registerUpdateLifecycle("series:beforeupdate",function(t,r,a){each$f(normalizeToArray(a.seriesTransition),function(o){each$f(normalizeToArray(o.to),function(u){for(var s=a.updatedSeries,c=0;c<s.length;c++)(u.seriesIndex!=null&&u.seriesIndex===s[c].seriesIndex||u.seriesId!=null&&u.seriesId===s[c].id)&&(s[c][SERIES_UNIVERSAL_TRANSITION_PROP]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(t,r,a){var o=getUniversalTransitionGlobalStore(r);if(o.oldSeries&&a.updatedSeries&&a.optionChanged){var u=a.seriesTransition;if(u)each$f(normalizeToArray(u),function(g){transitionSeriesFromOpt(g,o,a,r)});else{var s=findTransitionSeriesBatches(o,a);each$f(s.keys(),function(g){var b=s.get(g);transitionBetween(b.oldSeries,b.newSeries,r)})}each$f(a.updatedSeries,function(g){g[SERIES_UNIVERSAL_TRANSITION_PROP]&&(g[SERIES_UNIVERSAL_TRANSITION_PROP]=!1)})}for(var c=t.getSeries(),l=o.oldSeries=[],d=o.oldDataGroupIds=[],f=o.oldData=[],h=0;h<c.length;h++){var v=c[h].getData();v.count()<DATA_COUNT_THRESHOLD&&(l.push(c[h]),d.push(c[h].get("dataGroupId")),f.push(v))}})}use([install$R]);use([install$S]);use([install$Q,install$P,install$O,install$M,install$K,install$I,install$H,install$G,install$F,install$E,install$D,install$B,install$A,install$z,install$y,install$x,install$w,install$v,install$u,install$t,install$s,install$r]);use(install$p);use(install$o);use(install$J);use(install$n);use(install$C);use(install$m);use(install$l);use(install$j);use(install$i);use(install$q);use(install$h);use(install$g);use(install$f);use(install$e);use(install$d);use(install$c);use(install$9);use(install$6);use(install$8);use(install$7);use(install$3);use(install$5);use(install$4);use(install$2);use(install$1);use(install);use(installUniversalTransition);use(installLabelLayout);var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var r=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(n).forEach(function(a){var o=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(r,a,o.get?o:{enumerable:!0,get:function(){return n[a]}})}),r}var indexBrowser$1={},QueryEngine={},indexBrowser={},ActorInitQueryBase={},lib$4s={},ActorInit={},lib$4r={},ActionContext={},DELETE="delete",SHIFT=5,SIZE=1<<SHIFT,MASK=SIZE-1,NOT_SET={};function MakeRef(){return{value:!1}}function SetRef(n){n&&(n.value=!0)}function OwnerID(){}function ensureSize(n){return n.size===void 0&&(n.size=n.__iterate(returnTrue$1)),n.size}function wrapIndex(n,t){if(typeof t!="number"){var r=t>>>0;if(""+r!==t||r===4294967295)return NaN;t=r}return t<0?ensureSize(n)+t:t}function returnTrue$1(){return!0}function wholeSlice(n,t,r){return(n===0&&!isNeg(n)||r!==void 0&&n<=-r)&&(t===void 0||r!==void 0&&t>=r)}function resolveBegin(n,t){return resolveIndex(n,t,0)}function resolveEnd(n,t){return resolveIndex(n,t,t)}function resolveIndex(n,t,r){return n===void 0?r:isNeg(n)?t===1/0?t:Math.max(0,t+n)|0:t===void 0||t===n?n:Math.min(t,n)|0}function isNeg(n){return n<0||n===0&&1/n===-1/0}var IS_COLLECTION_SYMBOL="@@__IMMUTABLE_ITERABLE__@@";function isCollection(n){return!!(n&&n[IS_COLLECTION_SYMBOL])}var IS_KEYED_SYMBOL="@@__IMMUTABLE_KEYED__@@";function isKeyed(n){return!!(n&&n[IS_KEYED_SYMBOL])}var IS_INDEXED_SYMBOL="@@__IMMUTABLE_INDEXED__@@";function isIndexed(n){return!!(n&&n[IS_INDEXED_SYMBOL])}function isAssociative(n){return isKeyed(n)||isIndexed(n)}var Collection$1=function(t){return isCollection(t)?t:Seq(t)},KeyedCollection=function(n){function t(r){return isKeyed(r)?r:KeyedSeq(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Collection$1),IndexedCollection=function(n){function t(r){return isIndexed(r)?r:IndexedSeq(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Collection$1),SetCollection=function(n){function t(r){return isCollection(r)&&!isAssociative(r)?r:SetSeq(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t}(Collection$1);Collection$1.Keyed=KeyedCollection;Collection$1.Indexed=IndexedCollection;Collection$1.Set=SetCollection;var IS_SEQ_SYMBOL="@@__IMMUTABLE_SEQ__@@";function isSeq(n){return!!(n&&n[IS_SEQ_SYMBOL])}var IS_RECORD_SYMBOL="@@__IMMUTABLE_RECORD__@@";function isRecord(n){return!!(n&&n[IS_RECORD_SYMBOL])}function isImmutable(n){return isCollection(n)||isRecord(n)}var IS_ORDERED_SYMBOL="@@__IMMUTABLE_ORDERED__@@";function isOrdered(n){return!!(n&&n[IS_ORDERED_SYMBOL])}var ITERATE_KEYS=0,ITERATE_VALUES=1,ITERATE_ENTRIES=2,REAL_ITERATOR_SYMBOL=typeof Symbol=="function"&&Symbol.iterator,FAUX_ITERATOR_SYMBOL="@@iterator",ITERATOR_SYMBOL=REAL_ITERATOR_SYMBOL||FAUX_ITERATOR_SYMBOL,Iterator=function(t){this.next=t};Iterator.prototype.toString=function(){return"[Iterator]"};Iterator.KEYS=ITERATE_KEYS;Iterator.VALUES=ITERATE_VALUES;Iterator.ENTRIES=ITERATE_ENTRIES;Iterator.prototype.inspect=Iterator.prototype.toSource=function(){return this.toString()};Iterator.prototype[ITERATOR_SYMBOL]=function(){return this};function iteratorValue(n,t,r,a){var o=n===0?t:n===1?r:[t,r];return a?a.value=o:a={value:o,done:!1},a}function iteratorDone(){return{value:void 0,done:!0}}function hasIterator(n){return Array.isArray(n)?!0:!!getIteratorFn(n)}function isIterator(n){return n&&typeof n.next=="function"}function getIterator(n){var t=getIteratorFn(n);return t&&t.call(n)}function getIteratorFn(n){var t=n&&(REAL_ITERATOR_SYMBOL&&n[REAL_ITERATOR_SYMBOL]||n[FAUX_ITERATOR_SYMBOL]);if(typeof t=="function")return t}function isEntriesIterable(n){var t=getIteratorFn(n);return t&&t===n.entries}function isKeysIterable(n){var t=getIteratorFn(n);return t&&t===n.keys}var hasOwnProperty$5=Object.prototype.hasOwnProperty;function isArrayLike(n){return Array.isArray(n)||typeof n=="string"?!0:n&&typeof n=="object"&&Number.isInteger(n.length)&&n.length>=0&&(n.length===0?Object.keys(n).length===1:n.hasOwnProperty(n.length-1))}var Seq=function(n){function t(r){return r==null?emptySequence():isImmutable(r)?r.toSeq():seqFromValue(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(a,o){var u=this._cache;if(u){for(var s=u.length,c=0;c!==s;){var l=u[o?s-++c:c++];if(a(l[1],l[0],this)===!1)break}return c}return this.__iterateUncached(a,o)},t.prototype.__iterator=function(a,o){var u=this._cache;if(u){var s=u.length,c=0;return new Iterator(function(){if(c===s)return iteratorDone();var l=u[o?s-++c:c++];return iteratorValue(a,l[0],l[1])})}return this.__iteratorUncached(a,o)},t}(Collection$1),KeyedSeq=function(n){function t(r){return r==null?emptySequence().toKeyedSeq():isCollection(r)?isKeyed(r)?r.toSeq():r.fromEntrySeq():isRecord(r)?r.toSeq():keyedSeqFromValue(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(Seq),IndexedSeq=function(n){function t(r){return r==null?emptySequence():isCollection(r)?isKeyed(r)?r.entrySeq():r.toIndexedSeq():isRecord(r)?r.toSeq().entrySeq():indexedSeqFromValue(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(Seq),SetSeq=function(n){function t(r){return(isCollection(r)&&!isAssociative(r)?r:IndexedSeq(r)).toSetSeq()}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(Seq);Seq.isSeq=isSeq;Seq.Keyed=KeyedSeq;Seq.Set=SetSeq;Seq.Indexed=IndexedSeq;Seq.prototype[IS_SEQ_SYMBOL]=!0;var ArraySeq=function(n){function t(r){this._array=r,this.size=r.length}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(a,o){return this.has(a)?this._array[wrapIndex(this,a)]:o},t.prototype.__iterate=function(a,o){for(var u=this._array,s=u.length,c=0;c!==s;){var l=o?s-++c:c++;if(a(u[l],l,this)===!1)break}return c},t.prototype.__iterator=function(a,o){var u=this._array,s=u.length,c=0;return new Iterator(function(){if(c===s)return iteratorDone();var l=o?s-++c:c++;return iteratorValue(a,l,u[l])})},t}(IndexedSeq),ObjectSeq=function(n){function t(r){var a=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=a,this.size=a.length}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(a,o){return o!==void 0&&!this.has(a)?o:this._object[a]},t.prototype.has=function(a){return hasOwnProperty$5.call(this._object,a)},t.prototype.__iterate=function(a,o){for(var u=this._object,s=this._keys,c=s.length,l=0;l!==c;){var d=s[o?c-++l:l++];if(a(u[d],d,this)===!1)break}return l},t.prototype.__iterator=function(a,o){var u=this._object,s=this._keys,c=s.length,l=0;return new Iterator(function(){if(l===c)return iteratorDone();var d=s[o?c-++l:l++];return iteratorValue(a,d,u[d])})},t}(KeyedSeq);ObjectSeq.prototype[IS_ORDERED_SYMBOL]=!0;var CollectionSeq=function(n){function t(r){this._collection=r,this.size=r.length||r.size}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(a,o){if(o)return this.cacheResult().__iterate(a,o);var u=this._collection,s=getIterator(u),c=0;if(isIterator(s))for(var l;!(l=s.next()).done&&a(l.value,c++,this)!==!1;);return c},t.prototype.__iteratorUncached=function(a,o){if(o)return this.cacheResult().__iterator(a,o);var u=this._collection,s=getIterator(u);if(!isIterator(s))return new Iterator(iteratorDone);var c=0;return new Iterator(function(){var l=s.next();return l.done?l:iteratorValue(a,c++,l.value)})},t}(IndexedSeq),EMPTY_SEQ;function emptySequence(){return EMPTY_SEQ||(EMPTY_SEQ=new ArraySeq([]))}function keyedSeqFromValue(n){var t=maybeIndexedSeqFromValue(n);if(t)return t.fromEntrySeq();if(typeof n=="object")return new ObjectSeq(n);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+n)}function indexedSeqFromValue(n){var t=maybeIndexedSeqFromValue(n);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+n)}function seqFromValue(n){var t=maybeIndexedSeqFromValue(n);if(t)return isEntriesIterable(n)?t.fromEntrySeq():isKeysIterable(n)?t.toSetSeq():t;if(typeof n=="object")return new ObjectSeq(n);throw new TypeError("Expected Array or collection object of values, or keyed object: "+n)}function maybeIndexedSeqFromValue(n){return isArrayLike(n)?new ArraySeq(n):hasIterator(n)?new CollectionSeq(n):void 0}var IS_MAP_SYMBOL="@@__IMMUTABLE_MAP__@@";function isMap(n){return!!(n&&n[IS_MAP_SYMBOL])}function isOrderedMap(n){return isMap(n)&&isOrdered(n)}function isValueObject(n){return!!(n&&typeof n.equals=="function"&&typeof n.hashCode=="function")}function is(n,t){if(n===t||n!==n&&t!==t)return!0;if(!n||!t)return!1;if(typeof n.valueOf=="function"&&typeof t.valueOf=="function"){if(n=n.valueOf(),t=t.valueOf(),n===t||n!==n&&t!==t)return!0;if(!n||!t)return!1}return!!(isValueObject(n)&&isValueObject(t)&&n.equals(t))}var imul=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(t,r){t|=0,r|=0;var a=t&65535,o=r&65535;return a*o+((t>>>16)*o+a*(r>>>16)<<16>>>0)|0};function smi(n){return n>>>1&1073741824|n&3221225471}var defaultValueOf=Object.prototype.valueOf;function hash$1(n){if(n==null)return hashNullish(n);if(typeof n.hashCode=="function")return smi(n.hashCode(n));var t=valueOf(n);if(t==null)return hashNullish(t);switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return hashNumber(t);case"string":return t.length>STRING_HASH_CACHE_MIN_STRLEN?cachedHashString(t):hashString$1(t);case"object":case"function":return hashJSObj(t);case"symbol":return hashSymbol(t);default:if(typeof t.toString=="function")return hashString$1(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function hashNullish(n){return n===null?1108378658:1108378659}function hashNumber(n){if(n!==n||n===1/0)return 0;var t=n|0;for(t!==n&&(t^=n*4294967295);n>4294967295;)n/=4294967295,t^=n;return smi(t)}function cachedHashString(n){var t=stringHashCache[n];return t===void 0&&(t=hashString$1(n),STRING_HASH_CACHE_SIZE===STRING_HASH_CACHE_MAX_SIZE&&(STRING_HASH_CACHE_SIZE=0,stringHashCache={}),STRING_HASH_CACHE_SIZE++,stringHashCache[n]=t),t}function hashString$1(n){for(var t=0,r=0;r<n.length;r++)t=31*t+n.charCodeAt(r)|0;return smi(t)}function hashSymbol(n){var t=symbolMap[n];return t!==void 0||(t=nextHash(),symbolMap[n]=t),t}function hashJSObj(n){var t;if(usingWeakMap&&(t=weakMap.get(n),t!==void 0)||(t=n[UID_HASH_KEY],t!==void 0)||!canDefineProperty&&(t=n.propertyIsEnumerable&&n.propertyIsEnumerable[UID_HASH_KEY],t!==void 0||(t=getIENodeHash(n),t!==void 0)))return t;if(t=nextHash(),usingWeakMap)weakMap.set(n,t);else{if(isExtensible!==void 0&&isExtensible(n)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(canDefineProperty)Object.defineProperty(n,UID_HASH_KEY,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(n.propertyIsEnumerable!==void 0&&n.propertyIsEnumerable===n.constructor.prototype.propertyIsEnumerable)n.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},n.propertyIsEnumerable[UID_HASH_KEY]=t;else if(n.nodeType!==void 0)n[UID_HASH_KEY]=t;else throw new Error("Unable to set a non-enumerable property on object.")}return t}var isExtensible=Object.isExtensible,canDefineProperty=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function getIENodeHash(n){if(n&&n.nodeType>0)switch(n.nodeType){case 1:return n.uniqueID;case 9:return n.documentElement&&n.documentElement.uniqueID}}function valueOf(n){return n.valueOf!==defaultValueOf&&typeof n.valueOf=="function"?n.valueOf(n):n}function nextHash(){var n=++_objHashUID;return _objHashUID&1073741824&&(_objHashUID=0),n}var usingWeakMap=typeof WeakMap=="function",weakMap;usingWeakMap&&(weakMap=new WeakMap);var symbolMap=Object.create(null),_objHashUID=0,UID_HASH_KEY="__immutablehash__";typeof Symbol=="function"&&(UID_HASH_KEY=Symbol(UID_HASH_KEY));var STRING_HASH_CACHE_MIN_STRLEN=16,STRING_HASH_CACHE_MAX_SIZE=255,STRING_HASH_CACHE_SIZE=0,stringHashCache={},ToKeyedSequence=function(n){function t(r,a){this._iter=r,this._useKeys=a,this.size=r.size}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.get=function(a,o){return this._iter.get(a,o)},t.prototype.has=function(a){return this._iter.has(a)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var a=this,o=reverseFactory(this,!0);return this._useKeys||(o.valueSeq=function(){return a._iter.toSeq().reverse()}),o},t.prototype.map=function(a,o){var u=this,s=mapFactory(this,a,o);return this._useKeys||(s.valueSeq=function(){return u._iter.toSeq().map(a,o)}),s},t.prototype.__iterate=function(a,o){var u=this;return this._iter.__iterate(function(s,c){return a(s,c,u)},o)},t.prototype.__iterator=function(a,o){return this._iter.__iterator(a,o)},t}(KeyedSeq);ToKeyedSequence.prototype[IS_ORDERED_SYMBOL]=!0;var ToIndexedSequence=function(n){function t(r){this._iter=r,this.size=r.size}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.includes=function(a){return this._iter.includes(a)},t.prototype.__iterate=function(a,o){var u=this,s=0;return o&&ensureSize(this),this._iter.__iterate(function(c){return a(c,o?u.size-++s:s++,u)},o)},t.prototype.__iterator=function(a,o){var u=this,s=this._iter.__iterator(ITERATE_VALUES,o),c=0;return o&&ensureSize(this),new Iterator(function(){var l=s.next();return l.done?l:iteratorValue(a,o?u.size-++c:c++,l.value,l)})},t}(IndexedSeq),ToSetSequence=function(n){function t(r){this._iter=r,this.size=r.size}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.has=function(a){return this._iter.includes(a)},t.prototype.__iterate=function(a,o){var u=this;return this._iter.__iterate(function(s){return a(s,s,u)},o)},t.prototype.__iterator=function(a,o){var u=this._iter.__iterator(ITERATE_VALUES,o);return new Iterator(function(){var s=u.next();return s.done?s:iteratorValue(a,s.value,s.value,s)})},t}(SetSeq),FromEntriesSequence=function(n){function t(r){this._iter=r,this.size=r.size}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(a,o){var u=this;return this._iter.__iterate(function(s){if(s){validateEntry(s);var c=isCollection(s);return a(c?s.get(1):s[1],c?s.get(0):s[0],u)}},o)},t.prototype.__iterator=function(a,o){var u=this._iter.__iterator(ITERATE_VALUES,o);return new Iterator(function(){for(;;){var s=u.next();if(s.done)return s;var c=s.value;if(c){validateEntry(c);var l=isCollection(c);return iteratorValue(a,l?c.get(0):c[0],l?c.get(1):c[1],s)}}})},t}(KeyedSeq);ToIndexedSequence.prototype.cacheResult=ToKeyedSequence.prototype.cacheResult=ToSetSequence.prototype.cacheResult=FromEntriesSequence.prototype.cacheResult=cacheResultThrough;function flipFactory(n){var t=makeSequence(n);return t._iter=n,t.size=n.size,t.flip=function(){return n},t.reverse=function(){var r=n.reverse.apply(this);return r.flip=function(){return n.reverse()},r},t.has=function(r){return n.includes(r)},t.includes=function(r){return n.has(r)},t.cacheResult=cacheResultThrough,t.__iterateUncached=function(r,a){var o=this;return n.__iterate(function(u,s){return r(s,u,o)!==!1},a)},t.__iteratorUncached=function(r,a){if(r===ITERATE_ENTRIES){var o=n.__iterator(r,a);return new Iterator(function(){var u=o.next();if(!u.done){var s=u.value[0];u.value[0]=u.value[1],u.value[1]=s}return u})}return n.__iterator(r===ITERATE_VALUES?ITERATE_KEYS:ITERATE_VALUES,a)},t}function mapFactory(n,t,r){var a=makeSequence(n);return a.size=n.size,a.has=function(o){return n.has(o)},a.get=function(o,u){var s=n.get(o,NOT_SET);return s===NOT_SET?u:t.call(r,s,o,n)},a.__iterateUncached=function(o,u){var s=this;return n.__iterate(function(c,l,d){return o(t.call(r,c,l,d),l,s)!==!1},u)},a.__iteratorUncached=function(o,u){var s=n.__iterator(ITERATE_ENTRIES,u);return new Iterator(function(){var c=s.next();if(c.done)return c;var l=c.value,d=l[0];return iteratorValue(o,d,t.call(r,l[1],d,n),c)})},a}function reverseFactory(n,t){var r=this,a=makeSequence(n);return a._iter=n,a.size=n.size,a.reverse=function(){return n},n.flip&&(a.flip=function(){var o=flipFactory(n);return o.reverse=function(){return n.flip()},o}),a.get=function(o,u){return n.get(t?o:-1-o,u)},a.has=function(o){return n.has(t?o:-1-o)},a.includes=function(o){return n.includes(o)},a.cacheResult=cacheResultThrough,a.__iterate=function(o,u){var s=this,c=0;return u&&ensureSize(n),n.__iterate(function(l,d){return o(l,t?d:u?s.size-++c:c++,s)},!u)},a.__iterator=function(o,u){var s=0;u&&ensureSize(n);var c=n.__iterator(ITERATE_ENTRIES,!u);return new Iterator(function(){var l=c.next();if(l.done)return l;var d=l.value;return iteratorValue(o,t?d[0]:u?r.size-++s:s++,d[1],l)})},a}function filterFactory(n,t,r,a){var o=makeSequence(n);return a&&(o.has=function(u){var s=n.get(u,NOT_SET);return s!==NOT_SET&&!!t.call(r,s,u,n)},o.get=function(u,s){var c=n.get(u,NOT_SET);return c!==NOT_SET&&t.call(r,c,u,n)?c:s}),o.__iterateUncached=function(u,s){var c=this,l=0;return n.__iterate(function(d,f,h){if(t.call(r,d,f,h))return l++,u(d,a?f:l-1,c)},s),l},o.__iteratorUncached=function(u,s){var c=n.__iterator(ITERATE_ENTRIES,s),l=0;return new Iterator(function(){for(;;){var d=c.next();if(d.done)return d;var f=d.value,h=f[0],v=f[1];if(t.call(r,v,h,n))return iteratorValue(u,a?h:l++,v,d)}})},o}function countByFactory(n,t,r){var a=Map$3().asMutable();return n.__iterate(function(o,u){a.update(t.call(r,o,u,n),0,function(s){return s+1})}),a.asImmutable()}function groupByFactory(n,t,r){var a=isKeyed(n),o=(isOrdered(n)?OrderedMap():Map$3()).asMutable();n.__iterate(function(s,c){o.update(t.call(r,s,c,n),function(l){return l=l||[],l.push(a?[c,s]:s),l})});var u=collectionClass(n);return o.map(function(s){return reify(n,u(s))}).asImmutable()}function partitionFactory(n,t,r){var a=isKeyed(n),o=[[],[]];n.__iterate(function(s,c){o[t.call(r,s,c,n)?1:0].push(a?[c,s]:s)});var u=collectionClass(n);return o.map(function(s){return reify(n,u(s))})}function sliceFactory(n,t,r,a){var o=n.size;if(wholeSlice(t,r,o))return n;if(typeof o>"u"&&(t<0||r<0))return sliceFactory(n.toSeq().cacheResult(),t,r,a);var u=resolveBegin(t,o),s=resolveEnd(r,o),c=s-u,l;c===c&&(l=c<0?0:c);var d=makeSequence(n);return d.size=l===0?l:n.size&&l||void 0,!a&&isSeq(n)&&l>=0&&(d.get=function(f,h){return f=wrapIndex(this,f),f>=0&&f<l?n.get(f+u,h):h}),d.__iterateUncached=function(f,h){var v=this;if(l===0)return 0;if(h)return this.cacheResult().__iterate(f,h);var g=0,b=!0,_=0;return n.__iterate(function(S,T){if(!(b&&(b=g++<u)))return _++,f(S,a?T:_-1,v)!==!1&&_!==l}),_},d.__iteratorUncached=function(f,h){if(l!==0&&h)return this.cacheResult().__iterator(f,h);if(l===0)return new Iterator(iteratorDone);var v=n.__iterator(f,h),g=0,b=0;return new Iterator(function(){for(;g++<u;)v.next();if(++b>l)return iteratorDone();var _=v.next();return a||f===ITERATE_VALUES||_.done?_:f===ITERATE_KEYS?iteratorValue(f,b-1,void 0,_):iteratorValue(f,b-1,_.value[1],_)})},d}function takeWhileFactory(n,t,r){var a=makeSequence(n);return a.__iterateUncached=function(o,u){var s=this;if(u)return this.cacheResult().__iterate(o,u);var c=0;return n.__iterate(function(l,d,f){return t.call(r,l,d,f)&&++c&&o(l,d,s)}),c},a.__iteratorUncached=function(o,u){var s=this;if(u)return this.cacheResult().__iterator(o,u);var c=n.__iterator(ITERATE_ENTRIES,u),l=!0;return new Iterator(function(){if(!l)return iteratorDone();var d=c.next();if(d.done)return d;var f=d.value,h=f[0],v=f[1];return t.call(r,v,h,s)?o===ITERATE_ENTRIES?d:iteratorValue(o,h,v,d):(l=!1,iteratorDone())})},a}function skipWhileFactory(n,t,r,a){var o=makeSequence(n);return o.__iterateUncached=function(u,s){var c=this;if(s)return this.cacheResult().__iterate(u,s);var l=!0,d=0;return n.__iterate(function(f,h,v){if(!(l&&(l=t.call(r,f,h,v))))return d++,u(f,a?h:d-1,c)}),d},o.__iteratorUncached=function(u,s){var c=this;if(s)return this.cacheResult().__iterator(u,s);var l=n.__iterator(ITERATE_ENTRIES,s),d=!0,f=0;return new Iterator(function(){var h,v,g;do{if(h=l.next(),h.done)return a||u===ITERATE_VALUES?h:u===ITERATE_KEYS?iteratorValue(u,f++,void 0,h):iteratorValue(u,f++,h.value[1],h);var b=h.value;v=b[0],g=b[1],d&&(d=t.call(r,g,v,c))}while(d);return u===ITERATE_ENTRIES?h:iteratorValue(u,v,g,h)})},o}function concatFactory(n,t){var r=isKeyed(n),a=[n].concat(t).map(function(s){return isCollection(s)?r&&(s=KeyedCollection(s)):s=r?keyedSeqFromValue(s):indexedSeqFromValue(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(a.length===0)return n;if(a.length===1){var o=a[0];if(o===n||r&&isKeyed(o)||isIndexed(n)&&isIndexed(o))return o}var u=new ArraySeq(a);return r?u=u.toKeyedSeq():isIndexed(n)||(u=u.toSetSeq()),u=u.flatten(!0),u.size=a.reduce(function(s,c){if(s!==void 0){var l=c.size;if(l!==void 0)return s+l}},0),u}function flattenFactory(n,t,r){var a=makeSequence(n);return a.__iterateUncached=function(o,u){if(u)return this.cacheResult().__iterate(o,u);var s=0,c=!1;function l(d,f){d.__iterate(function(h,v){return(!t||f<t)&&isCollection(h)?l(h,f+1):(s++,o(h,r?v:s-1,a)===!1&&(c=!0)),!c},u)}return l(n,0),s},a.__iteratorUncached=function(o,u){if(u)return this.cacheResult().__iterator(o,u);var s=n.__iterator(o,u),c=[],l=0;return new Iterator(function(){for(;s;){var d=s.next();if(d.done!==!1){s=c.pop();continue}var f=d.value;if(o===ITERATE_ENTRIES&&(f=f[1]),(!t||c.length<t)&&isCollection(f))c.push(s),s=f.__iterator(o,u);else return r?d:iteratorValue(o,l++,f,d)}return iteratorDone()})},a}function flatMapFactory(n,t,r){var a=collectionClass(n);return n.toSeq().map(function(o,u){return a(t.call(r,o,u,n))}).flatten(!0)}function interposeFactory(n,t){var r=makeSequence(n);return r.size=n.size&&n.size*2-1,r.__iterateUncached=function(a,o){var u=this,s=0;return n.__iterate(function(c){return(!s||a(t,s++,u)!==!1)&&a(c,s++,u)!==!1},o),s},r.__iteratorUncached=function(a,o){var u=n.__iterator(ITERATE_VALUES,o),s=0,c;return new Iterator(function(){return(!c||s%2)&&(c=u.next(),c.done)?c:s%2?iteratorValue(a,s++,t):iteratorValue(a,s++,c.value,c)})},r}function sortFactory(n,t,r){t||(t=defaultComparator);var a=isKeyed(n),o=0,u=n.toSeq().map(function(s,c){return[c,s,o++,r?r(s,c,n):s]}).valueSeq().toArray();return u.sort(function(s,c){return t(s[3],c[3])||s[2]-c[2]}).forEach(a?function(s,c){u[c].length=2}:function(s,c){u[c]=s[1]}),a?KeyedSeq(u):isIndexed(n)?IndexedSeq(u):SetSeq(u)}function maxFactory(n,t,r){if(t||(t=defaultComparator),r){var a=n.toSeq().map(function(o,u){return[o,r(o,u,n)]}).reduce(function(o,u){return maxCompare(t,o[1],u[1])?u:o});return a&&a[0]}return n.reduce(function(o,u){return maxCompare(t,o,u)?u:o})}function maxCompare(n,t,r){var a=n(r,t);return a===0&&r!==t&&(r==null||r!==r)||a>0}function zipWithFactory(n,t,r,a){var o=makeSequence(n),u=new ArraySeq(r).map(function(s){return s.size});return o.size=a?u.max():u.min(),o.__iterate=function(s,c){for(var l=this.__iterator(ITERATE_VALUES,c),d,f=0;!(d=l.next()).done&&s(d.value,f++,this)!==!1;);return f},o.__iteratorUncached=function(s,c){var l=r.map(function(h){return h=Collection$1(h),getIterator(c?h.reverse():h)}),d=0,f=!1;return new Iterator(function(){var h;return f||(h=l.map(function(v){return v.next()}),f=a?h.every(function(v){return v.done}):h.some(function(v){return v.done})),f?iteratorDone():iteratorValue(s,d++,t.apply(null,h.map(function(v){return v.value})))})},o}function reify(n,t){return n===t?n:isSeq(n)?t:n.constructor(t)}function validateEntry(n){if(n!==Object(n))throw new TypeError("Expected [K, V] tuple: "+n)}function collectionClass(n){return isKeyed(n)?KeyedCollection:isIndexed(n)?IndexedCollection:SetCollection}function makeSequence(n){return Object.create((isKeyed(n)?KeyedSeq:isIndexed(n)?IndexedSeq:SetSeq).prototype)}function cacheResultThrough(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Seq.prototype.cacheResult.call(this)}function defaultComparator(n,t){return n===void 0&&t===void 0?0:n===void 0?1:t===void 0?-1:n>t?1:n<t?-1:0}function arrCopy(n,t){t=t||0;for(var r=Math.max(0,n.length-t),a=new Array(r),o=0;o<r;o++)a[o]=n[o+t];return a}function invariant$1(n,t){if(!n)throw new Error(t)}function assertNotInfinite(n){invariant$1(n!==1/0,"Cannot perform this action with an infinite size.")}function coerceKeyPath(n){if(isArrayLike(n)&&typeof n!="string")return n;if(isOrdered(n))return n.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+n)}var toString$2=Object.prototype.toString;function isPlainObject(n){if(!n||typeof n!="object"||toString$2.call(n)!=="[object Object]")return!1;var t=Object.getPrototypeOf(n);if(t===null)return!0;for(var r=t,a=Object.getPrototypeOf(t);a!==null;)r=a,a=Object.getPrototypeOf(r);return r===t}function isDataStructure(n){return typeof n=="object"&&(isImmutable(n)||Array.isArray(n)||isPlainObject(n))}function quoteString(n){try{return typeof n=="string"?JSON.stringify(n):String(n)}catch{return JSON.stringify(n)}}function has(n,t){return isImmutable(n)?n.has(t):isDataStructure(n)&&hasOwnProperty$5.call(n,t)}function get$1(n,t,r){return isImmutable(n)?n.get(t,r):has(n,t)?typeof n.get=="function"?n.get(t):n[t]:r}function shallowCopy(n){if(Array.isArray(n))return arrCopy(n);var t={};for(var r in n)hasOwnProperty$5.call(n,r)&&(t[r]=n[r]);return t}function remove$1(n,t){if(!isDataStructure(n))throw new TypeError("Cannot update non-data-structure value: "+n);if(isImmutable(n)){if(!n.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+n);return n.remove(t)}if(!hasOwnProperty$5.call(n,t))return n;var r=shallowCopy(n);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function set$1(n,t,r){if(!isDataStructure(n))throw new TypeError("Cannot update non-data-structure value: "+n);if(isImmutable(n)){if(!n.set)throw new TypeError("Cannot update immutable value without .set() method: "+n);return n.set(t,r)}if(hasOwnProperty$5.call(n,t)&&r===n[t])return n;var a=shallowCopy(n);return a[t]=r,a}function updateIn$1(n,t,r,a){a||(a=r,r=void 0);var o=updateInDeeply(isImmutable(n),n,coerceKeyPath(t),0,r,a);return o===NOT_SET?r:o}function updateInDeeply(n,t,r,a,o,u){var s=t===NOT_SET;if(a===r.length){var c=s?o:t,l=u(c);return l===c?t:l}if(!s&&!isDataStructure(t))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,a).map(quoteString)+"]: "+t);var d=r[a],f=s?NOT_SET:get$1(t,d,NOT_SET),h=updateInDeeply(f===NOT_SET?n:isImmutable(f),f,r,a+1,o,u);return h===f?t:h===NOT_SET?remove$1(t,d):set$1(s?n?emptyMap():{}:t,d,h)}function setIn$1(n,t,r){return updateIn$1(n,t,NOT_SET,function(){return r})}function setIn(n,t){return setIn$1(this,n,t)}function removeIn(n,t){return updateIn$1(n,t,function(){return NOT_SET})}function deleteIn(n){return removeIn(this,n)}function update$1(n,t,r,a){return updateIn$1(n,[t],r,a)}function update(n,t,r){return arguments.length===1?n(this):update$1(this,n,t,r)}function updateIn(n,t,r){return updateIn$1(this,n,t,r)}function merge$1$1(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return mergeIntoKeyedWith(this,n)}function mergeWith$1(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(typeof n!="function")throw new TypeError("Invalid merger function: "+n);return mergeIntoKeyedWith(this,t,n)}function mergeIntoKeyedWith(n,t,r){for(var a=[],o=0;o<t.length;o++){var u=KeyedCollection(t[o]);u.size!==0&&a.push(u)}return a.length===0?n:n.toSeq().size===0&&!n.__ownerID&&a.length===1?n.constructor(a[0]):n.withMutations(function(s){for(var c=r?function(d,f){update$1(s,f,NOT_SET,function(h){return h===NOT_SET?d:r(h,d,f)})}:function(d,f){s.set(f,d)},l=0;l<a.length;l++)a[l].forEach(c)})}function merge$2(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return mergeWithSources(n,t)}function mergeWith(n,t){for(var r=[],a=arguments.length-2;a-- >0;)r[a]=arguments[a+2];return mergeWithSources(t,r,n)}function mergeDeep$1(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return mergeDeepWithSources(n,t)}function mergeDeepWith$1(n,t){for(var r=[],a=arguments.length-2;a-- >0;)r[a]=arguments[a+2];return mergeDeepWithSources(t,r,n)}function mergeDeepWithSources(n,t,r){return mergeWithSources(n,t,deepMergerWith(r))}function mergeWithSources(n,t,r){if(!isDataStructure(n))throw new TypeError("Cannot merge into non-data-structure value: "+n);if(isImmutable(n))return typeof r=="function"&&n.mergeWith?n.mergeWith.apply(n,[r].concat(t)):n.merge?n.merge.apply(n,t):n.concat.apply(n,t);for(var a=Array.isArray(n),o=n,u=a?IndexedCollection:KeyedCollection,s=a?function(l){o===n&&(o=shallowCopy(o)),o.push(l)}:function(l,d){var f=hasOwnProperty$5.call(o,d),h=f&&r?r(o[d],l,d):l;(!f||h!==o[d])&&(o===n&&(o=shallowCopy(o)),o[d]=h)},c=0;c<t.length;c++)u(t[c]).forEach(s);return o}function deepMergerWith(n){function t(r,a,o){return isDataStructure(r)&&isDataStructure(a)&&areMergeable(r,a)?mergeWithSources(r,[a],t):n?n(r,a,o):a}return t}function areMergeable(n,t){var r=Seq(n),a=Seq(t);return isIndexed(r)===isIndexed(a)&&isKeyed(r)===isKeyed(a)}function mergeDeep(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return mergeDeepWithSources(this,n)}function mergeDeepWith(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return mergeDeepWithSources(this,t,n)}function mergeIn(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return updateIn$1(this,n,emptyMap(),function(a){return mergeWithSources(a,t)})}function mergeDeepIn(n){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return updateIn$1(this,n,emptyMap(),function(a){return mergeDeepWithSources(a,t)})}function withMutations(n){var t=this.asMutable();return n(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function asMutable(){return this.__ownerID?this:this.__ensureOwner(new OwnerID)}function asImmutable(){return this.__ensureOwner()}function wasAltered(){return this.__altered}var Map$3=function(n){function t(r){return r==null?emptyMap():isMap(r)&&!isOrdered(r)?r:emptyMap().withMutations(function(a){var o=n(r);assertNotInfinite(o.size),o.forEach(function(u,s){return a.set(s,u)})})}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];return emptyMap().withMutations(function(u){for(var s=0;s<a.length;s+=2){if(s+1>=a.length)throw new Error("Missing value for key: "+a[s]);u.set(a[s],a[s+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(a,o){return this._root?this._root.get(0,void 0,a,o):o},t.prototype.set=function(a,o){return updateMap(this,a,o)},t.prototype.remove=function(a){return updateMap(this,a,NOT_SET)},t.prototype.deleteAll=function(a){var o=Collection$1(a);return o.size===0?this:this.withMutations(function(u){o.forEach(function(s){return u.remove(s)})})},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):emptyMap()},t.prototype.sort=function(a){return OrderedMap(sortFactory(this,a))},t.prototype.sortBy=function(a,o){return OrderedMap(sortFactory(this,o,a))},t.prototype.map=function(a,o){var u=this;return this.withMutations(function(s){s.forEach(function(c,l){s.set(l,a.call(o,c,l,u))})})},t.prototype.__iterator=function(a,o){return new MapIterator(this,a,o)},t.prototype.__iterate=function(a,o){var u=this,s=0;return this._root&&this._root.iterate(function(c){return s++,a(c[1],c[0],u)},o),s},t.prototype.__ensureOwner=function(a){return a===this.__ownerID?this:a?makeMap(this.size,this._root,a,this.__hash):this.size===0?emptyMap():(this.__ownerID=a,this.__altered=!1,this)},t}(KeyedCollection);Map$3.isMap=isMap;var MapPrototype=Map$3.prototype;MapPrototype[IS_MAP_SYMBOL]=!0;MapPrototype[DELETE]=MapPrototype.remove;MapPrototype.removeAll=MapPrototype.deleteAll;MapPrototype.setIn=setIn;MapPrototype.removeIn=MapPrototype.deleteIn=deleteIn;MapPrototype.update=update;MapPrototype.updateIn=updateIn;MapPrototype.merge=MapPrototype.concat=merge$1$1;MapPrototype.mergeWith=mergeWith$1;MapPrototype.mergeDeep=mergeDeep;MapPrototype.mergeDeepWith=mergeDeepWith;MapPrototype.mergeIn=mergeIn;MapPrototype.mergeDeepIn=mergeDeepIn;MapPrototype.withMutations=withMutations;MapPrototype.wasAltered=wasAltered;MapPrototype.asImmutable=asImmutable;MapPrototype["@@transducer/init"]=MapPrototype.asMutable=asMutable;MapPrototype["@@transducer/step"]=function(n,t){return n.set(t[0],t[1])};MapPrototype["@@transducer/result"]=function(n){return n.asImmutable()};var ArrayMapNode=function(t,r){this.ownerID=t,this.entries=r};ArrayMapNode.prototype.get=function(t,r,a,o){for(var u=this.entries,s=0,c=u.length;s<c;s++)if(is(a,u[s][0]))return u[s][1];return o};ArrayMapNode.prototype.update=function(t,r,a,o,u,s,c){for(var l=u===NOT_SET,d=this.entries,f=0,h=d.length;f<h&&!is(o,d[f][0]);f++);var v=f<h;if(v?d[f][1]===u:l)return this;if(SetRef(c),(l||!v)&&SetRef(s),!(l&&d.length===1)){if(!v&&!l&&d.length>=MAX_ARRAY_MAP_SIZE)return createNodes(t,d,o,u);var g=t&&t===this.ownerID,b=g?d:arrCopy(d);return v?l?f===h-1?b.pop():b[f]=b.pop():b[f]=[o,u]:b.push([o,u]),g?(this.entries=b,this):new ArrayMapNode(t,b)}};var BitmapIndexedNode=function(t,r,a){this.ownerID=t,this.bitmap=r,this.nodes=a};BitmapIndexedNode.prototype.get=function(t,r,a,o){r===void 0&&(r=hash$1(a));var u=1<<((t===0?r:r>>>t)&MASK),s=this.bitmap;return s&u?this.nodes[popCount(s&u-1)].get(t+SHIFT,r,a,o):o};BitmapIndexedNode.prototype.update=function(t,r,a,o,u,s,c){a===void 0&&(a=hash$1(o));var l=(r===0?a:a>>>r)&MASK,d=1<<l,f=this.bitmap,h=(f&d)!==0;if(!h&&u===NOT_SET)return this;var v=popCount(f&d-1),g=this.nodes,b=h?g[v]:void 0,_=updateNode(b,t,r+SHIFT,a,o,u,s,c);if(_===b)return this;if(!h&&_&&g.length>=MAX_BITMAP_INDEXED_SIZE)return expandNodes(t,g,f,l,_);if(h&&!_&&g.length===2&&isLeafNode(g[v^1]))return g[v^1];if(h&&_&&g.length===1&&isLeafNode(_))return _;var S=t&&t===this.ownerID,T=h?_?f:f^d:f|d,w=h?_?setAt(g,v,_,S):spliceOut(g,v,S):spliceIn(g,v,_,S);return S?(this.bitmap=T,this.nodes=w,this):new BitmapIndexedNode(t,T,w)};var HashArrayMapNode=function(t,r,a){this.ownerID=t,this.count=r,this.nodes=a};HashArrayMapNode.prototype.get=function(t,r,a,o){r===void 0&&(r=hash$1(a));var u=(t===0?r:r>>>t)&MASK,s=this.nodes[u];return s?s.get(t+SHIFT,r,a,o):o};HashArrayMapNode.prototype.update=function(t,r,a,o,u,s,c){a===void 0&&(a=hash$1(o));var l=(r===0?a:a>>>r)&MASK,d=u===NOT_SET,f=this.nodes,h=f[l];if(d&&!h)return this;var v=updateNode(h,t,r+SHIFT,a,o,u,s,c);if(v===h)return this;var g=this.count;if(!h)g++;else if(!v&&(g--,g<MIN_HASH_ARRAY_MAP_SIZE))return packNodes(t,f,g,l);var b=t&&t===this.ownerID,_=setAt(f,l,v,b);return b?(this.count=g,this.nodes=_,this):new HashArrayMapNode(t,g,_)};var HashCollisionNode=function(t,r,a){this.ownerID=t,this.keyHash=r,this.entries=a};HashCollisionNode.prototype.get=function(t,r,a,o){for(var u=this.entries,s=0,c=u.length;s<c;s++)if(is(a,u[s][0]))return u[s][1];return o};HashCollisionNode.prototype.update=function(t,r,a,o,u,s,c){a===void 0&&(a=hash$1(o));var l=u===NOT_SET;if(a!==this.keyHash)return l?this:(SetRef(c),SetRef(s),mergeIntoNode(this,t,r,a,[o,u]));for(var d=this.entries,f=0,h=d.length;f<h&&!is(o,d[f][0]);f++);var v=f<h;if(v?d[f][1]===u:l)return this;if(SetRef(c),(l||!v)&&SetRef(s),l&&h===2)return new ValueNode(t,this.keyHash,d[f^1]);var g=t&&t===this.ownerID,b=g?d:arrCopy(d);return v?l?f===h-1?b.pop():b[f]=b.pop():b[f]=[o,u]:b.push([o,u]),g?(this.entries=b,this):new HashCollisionNode(t,this.keyHash,b)};var ValueNode=function(t,r,a){this.ownerID=t,this.keyHash=r,this.entry=a};ValueNode.prototype.get=function(t,r,a,o){return is(a,this.entry[0])?this.entry[1]:o};ValueNode.prototype.update=function(t,r,a,o,u,s,c){var l=u===NOT_SET,d=is(o,this.entry[0]);if(d?u===this.entry[1]:l)return this;if(SetRef(c),l){SetRef(s);return}return d?t&&t===this.ownerID?(this.entry[1]=u,this):new ValueNode(t,this.keyHash,[o,u]):(SetRef(s),mergeIntoNode(this,t,r,hash$1(o),[o,u]))};ArrayMapNode.prototype.iterate=HashCollisionNode.prototype.iterate=function(n,t){for(var r=this.entries,a=0,o=r.length-1;a<=o;a++)if(n(r[t?o-a:a])===!1)return!1};BitmapIndexedNode.prototype.iterate=HashArrayMapNode.prototype.iterate=function(n,t){for(var r=this.nodes,a=0,o=r.length-1;a<=o;a++){var u=r[t?o-a:a];if(u&&u.iterate(n,t)===!1)return!1}};ValueNode.prototype.iterate=function(n,t){return n(this.entry)};var MapIterator=function(n){function t(r,a,o){this._type=a,this._reverse=o,this._stack=r._root&&mapIteratorFrame(r._root)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var a=this._type,o=this._stack;o;){var u=o.node,s=o.index++,c=void 0;if(u.entry){if(s===0)return mapIteratorValue(a,u.entry)}else if(u.entries){if(c=u.entries.length-1,s<=c)return mapIteratorValue(a,u.entries[this._reverse?c-s:s])}else if(c=u.nodes.length-1,s<=c){var l=u.nodes[this._reverse?c-s:s];if(l){if(l.entry)return mapIteratorValue(a,l.entry);o=this._stack=mapIteratorFrame(l,o)}continue}o=this._stack=this._stack.__prev}return iteratorDone()},t}(Iterator);function mapIteratorValue(n,t){return iteratorValue(n,t[0],t[1])}function mapIteratorFrame(n,t){return{node:n,index:0,__prev:t}}function makeMap(n,t,r,a){var o=Object.create(MapPrototype);return o.size=n,o._root=t,o.__ownerID=r,o.__hash=a,o.__altered=!1,o}var EMPTY_MAP;function emptyMap(){return EMPTY_MAP||(EMPTY_MAP=makeMap(0))}function updateMap(n,t,r){var a,o;if(n._root){var u=MakeRef(),s=MakeRef();if(a=updateNode(n._root,n.__ownerID,0,void 0,t,r,u,s),!s.value)return n;o=n.size+(u.value?r===NOT_SET?-1:1:0)}else{if(r===NOT_SET)return n;o=1,a=new ArrayMapNode(n.__ownerID,[[t,r]])}return n.__ownerID?(n.size=o,n._root=a,n.__hash=void 0,n.__altered=!0,n):a?makeMap(o,a):emptyMap()}function updateNode(n,t,r,a,o,u,s,c){return n?n.update(t,r,a,o,u,s,c):u===NOT_SET?n:(SetRef(c),SetRef(s),new ValueNode(t,a,[o,u]))}function isLeafNode(n){return n.constructor===ValueNode||n.constructor===HashCollisionNode}function mergeIntoNode(n,t,r,a,o){if(n.keyHash===a)return new HashCollisionNode(t,a,[n.entry,o]);var u=(r===0?n.keyHash:n.keyHash>>>r)&MASK,s=(r===0?a:a>>>r)&MASK,c,l=u===s?[mergeIntoNode(n,t,r+SHIFT,a,o)]:(c=new ValueNode(t,a,o),u<s?[n,c]:[c,n]);return new BitmapIndexedNode(t,1<<u|1<<s,l)}function createNodes(n,t,r,a){n||(n=new OwnerID);for(var o=new ValueNode(n,hash$1(r),[r,a]),u=0;u<t.length;u++){var s=t[u];o=o.update(n,0,void 0,s[0],s[1])}return o}function packNodes(n,t,r,a){for(var o=0,u=0,s=new Array(r),c=0,l=1,d=t.length;c<d;c++,l<<=1){var f=t[c];f!==void 0&&c!==a&&(o|=l,s[u++]=f)}return new BitmapIndexedNode(n,o,s)}function expandNodes(n,t,r,a,o){for(var u=0,s=new Array(SIZE),c=0;r!==0;c++,r>>>=1)s[c]=r&1?t[u++]:void 0;return s[a]=o,new HashArrayMapNode(n,u+1,s)}function popCount(n){return n-=n>>1&1431655765,n=(n&858993459)+(n>>2&858993459),n=n+(n>>4)&252645135,n+=n>>8,n+=n>>16,n&127}function setAt(n,t,r,a){var o=a?n:arrCopy(n);return o[t]=r,o}function spliceIn(n,t,r,a){var o=n.length+1;if(a&&t+1===o)return n[t]=r,n;for(var u=new Array(o),s=0,c=0;c<o;c++)c===t?(u[c]=r,s=-1):u[c]=n[c+s];return u}function spliceOut(n,t,r){var a=n.length-1;if(r&&t===a)return n.pop(),n;for(var o=new Array(a),u=0,s=0;s<a;s++)s===t&&(u=1),o[s]=n[s+u];return o}var MAX_ARRAY_MAP_SIZE=SIZE/4,MAX_BITMAP_INDEXED_SIZE=SIZE/2,MIN_HASH_ARRAY_MAP_SIZE=SIZE/4,IS_LIST_SYMBOL="@@__IMMUTABLE_LIST__@@";function isList(n){return!!(n&&n[IS_LIST_SYMBOL])}var List=function(n){function t(r){var a=emptyList();if(r==null)return a;if(isList(r))return r;var o=n(r),u=o.size;return u===0?a:(assertNotInfinite(u),u>0&&u<SIZE?makeList(0,u,SHIFT,null,new VNode(o.toArray())):a.withMutations(function(s){s.setSize(u),o.forEach(function(c,l){return s.set(l,c)})}))}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(a,o){if(a=wrapIndex(this,a),a>=0&&a<this.size){a+=this._origin;var u=listNodeFor(this,a);return u&&u.array[a&MASK]}return o},t.prototype.set=function(a,o){return updateList(this,a,o)},t.prototype.remove=function(a){return this.has(a)?a===0?this.shift():a===this.size-1?this.pop():this.splice(a,1):this},t.prototype.insert=function(a,o){return this.splice(a,0,o)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=SHIFT,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):emptyList()},t.prototype.push=function(){var a=arguments,o=this.size;return this.withMutations(function(u){setListBounds(u,0,o+a.length);for(var s=0;s<a.length;s++)u.set(o+s,a[s])})},t.prototype.pop=function(){return setListBounds(this,0,-1)},t.prototype.unshift=function(){var a=arguments;return this.withMutations(function(o){setListBounds(o,-a.length);for(var u=0;u<a.length;u++)o.set(u,a[u])})},t.prototype.shift=function(){return setListBounds(this,1)},t.prototype.concat=function(){for(var a=arguments,o=[],u=0;u<arguments.length;u++){var s=a[u],c=n(typeof s!="string"&&hasIterator(s)?s:[s]);c.size!==0&&o.push(c)}return o.length===0?this:this.size===0&&!this.__ownerID&&o.length===1?this.constructor(o[0]):this.withMutations(function(l){o.forEach(function(d){return d.forEach(function(f){return l.push(f)})})})},t.prototype.setSize=function(a){return setListBounds(this,0,a)},t.prototype.map=function(a,o){var u=this;return this.withMutations(function(s){for(var c=0;c<u.size;c++)s.set(c,a.call(o,s.get(c),c,u))})},t.prototype.slice=function(a,o){var u=this.size;return wholeSlice(a,o,u)?this:setListBounds(this,resolveBegin(a,u),resolveEnd(o,u))},t.prototype.__iterator=function(a,o){var u=o?this.size:0,s=iterateList(this,o);return new Iterator(function(){var c=s();return c===DONE?iteratorDone():iteratorValue(a,o?--u:u++,c)})},t.prototype.__iterate=function(a,o){for(var u=o?this.size:0,s=iterateList(this,o),c;(c=s())!==DONE&&a(c,o?--u:u++,this)!==!1;);return u},t.prototype.__ensureOwner=function(a){return a===this.__ownerID?this:a?makeList(this._origin,this._capacity,this._level,this._root,this._tail,a,this.__hash):this.size===0?emptyList():(this.__ownerID=a,this.__altered=!1,this)},t}(IndexedCollection);List.isList=isList;var ListPrototype=List.prototype;ListPrototype[IS_LIST_SYMBOL]=!0;ListPrototype[DELETE]=ListPrototype.remove;ListPrototype.merge=ListPrototype.concat;ListPrototype.setIn=setIn;ListPrototype.deleteIn=ListPrototype.removeIn=deleteIn;ListPrototype.update=update;ListPrototype.updateIn=updateIn;ListPrototype.mergeIn=mergeIn;ListPrototype.mergeDeepIn=mergeDeepIn;ListPrototype.withMutations=withMutations;ListPrototype.wasAltered=wasAltered;ListPrototype.asImmutable=asImmutable;ListPrototype["@@transducer/init"]=ListPrototype.asMutable=asMutable;ListPrototype["@@transducer/step"]=function(n,t){return n.push(t)};ListPrototype["@@transducer/result"]=function(n){return n.asImmutable()};var VNode=function(t,r){this.array=t,this.ownerID=r};VNode.prototype.removeBefore=function(t,r,a){if(a===r?1<<r:this.array.length===0)return this;var o=a>>>r&MASK;if(o>=this.array.length)return new VNode([],t);var u=o===0,s;if(r>0){var c=this.array[o];if(s=c&&c.removeBefore(t,r-SHIFT,a),s===c&&u)return this}if(u&&!s)return this;var l=editableVNode(this,t);if(!u)for(var d=0;d<o;d++)l.array[d]=void 0;return s&&(l.array[o]=s),l};VNode.prototype.removeAfter=function(t,r,a){if(a===(r?1<<r:0)||this.array.length===0)return this;var o=a-1>>>r&MASK;if(o>=this.array.length)return this;var u;if(r>0){var s=this.array[o];if(u=s&&s.removeAfter(t,r-SHIFT,a),u===s&&o===this.array.length-1)return this}var c=editableVNode(this,t);return c.array.splice(o+1),u&&(c.array[o]=u),c};var DONE={};function iterateList(n,t){var r=n._origin,a=n._capacity,o=getTailOffset(a),u=n._tail;return s(n._root,n._level,0);function s(d,f,h){return f===0?c(d,h):l(d,f,h)}function c(d,f){var h=f===o?u&&u.array:d&&d.array,v=f>r?0:r-f,g=a-f;return g>SIZE&&(g=SIZE),function(){if(v===g)return DONE;var b=t?--g:v++;return h&&h[b]}}function l(d,f,h){var v,g=d&&d.array,b=h>r?0:r-h>>f,_=(a-h>>f)+1;return _>SIZE&&(_=SIZE),function(){for(;;){if(v){var S=v();if(S!==DONE)return S;v=null}if(b===_)return DONE;var T=t?--_:b++;v=s(g&&g[T],f-SHIFT,h+(T<<f))}}}}function makeList(n,t,r,a,o,u,s){var c=Object.create(ListPrototype);return c.size=t-n,c._origin=n,c._capacity=t,c._level=r,c._root=a,c._tail=o,c.__ownerID=u,c.__hash=s,c.__altered=!1,c}var EMPTY_LIST;function emptyList(){return EMPTY_LIST||(EMPTY_LIST=makeList(0,0,SHIFT))}function updateList(n,t,r){if(t=wrapIndex(n,t),t!==t)return n;if(t>=n.size||t<0)return n.withMutations(function(s){t<0?setListBounds(s,t).set(0,r):setListBounds(s,0,t+1).set(t,r)});t+=n._origin;var a=n._tail,o=n._root,u=MakeRef();return t>=getTailOffset(n._capacity)?a=updateVNode(a,n.__ownerID,0,t,r,u):o=updateVNode(o,n.__ownerID,n._level,t,r,u),u.value?n.__ownerID?(n._root=o,n._tail=a,n.__hash=void 0,n.__altered=!0,n):makeList(n._origin,n._capacity,n._level,o,a):n}function updateVNode(n,t,r,a,o,u){var s=a>>>r&MASK,c=n&&s<n.array.length;if(!c&&o===void 0)return n;var l;if(r>0){var d=n&&n.array[s],f=updateVNode(d,t,r-SHIFT,a,o,u);return f===d?n:(l=editableVNode(n,t),l.array[s]=f,l)}return c&&n.array[s]===o?n:(u&&SetRef(u),l=editableVNode(n,t),o===void 0&&s===l.array.length-1?l.array.pop():l.array[s]=o,l)}function editableVNode(n,t){return t&&n&&t===n.ownerID?n:new VNode(n?n.array.slice():[],t)}function listNodeFor(n,t){if(t>=getTailOffset(n._capacity))return n._tail;if(t<1<<n._level+SHIFT){for(var r=n._root,a=n._level;r&&a>0;)r=r.array[t>>>a&MASK],a-=SHIFT;return r}}function setListBounds(n,t,r){t!==void 0&&(t|=0),r!==void 0&&(r|=0);var a=n.__ownerID||new OwnerID,o=n._origin,u=n._capacity,s=o+t,c=r===void 0?u:r<0?u+r:o+r;if(s===o&&c===u)return n;if(s>=c)return n.clear();for(var l=n._level,d=n._root,f=0;s+f<0;)d=new VNode(d&&d.array.length?[void 0,d]:[],a),l+=SHIFT,f+=1<<l;f&&(s+=f,o+=f,c+=f,u+=f);for(var h=getTailOffset(u),v=getTailOffset(c);v>=1<<l+SHIFT;)d=new VNode(d&&d.array.length?[d]:[],a),l+=SHIFT;var g=n._tail,b=v<h?listNodeFor(n,c-1):v>h?new VNode([],a):g;if(g&&v>h&&s<u&&g.array.length){d=editableVNode(d,a);for(var _=d,S=l;S>SHIFT;S-=SHIFT){var T=h>>>S&MASK;_=_.array[T]=editableVNode(_.array[T],a)}_.array[h>>>SHIFT&MASK]=g}if(c<u&&(b=b&&b.removeAfter(a,0,c)),s>=v)s-=v,c-=v,l=SHIFT,d=null,b=b&&b.removeBefore(a,0,s);else if(s>o||v<h){for(f=0;d;){var w=s>>>l&MASK;if(w!==v>>>l&MASK)break;w&&(f+=(1<<l)*w),l-=SHIFT,d=d.array[w]}d&&s>o&&(d=d.removeBefore(a,l,s-f)),d&&v<h&&(d=d.removeAfter(a,l,v-f)),f&&(s-=f,c-=f)}return n.__ownerID?(n.size=c-s,n._origin=s,n._capacity=c,n._level=l,n._root=d,n._tail=b,n.__hash=void 0,n.__altered=!0,n):makeList(s,c,l,d,b)}function getTailOffset(n){return n<SIZE?0:n-1>>>SHIFT<<SHIFT}var OrderedMap=function(n){function t(r){return r==null?emptyOrderedMap():isOrderedMap(r)?r:emptyOrderedMap().withMutations(function(a){var o=KeyedCollection(r);assertNotInfinite(o.size),o.forEach(function(u,s){return a.set(s,u)})})}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(a,o){var u=this._map.get(a);return u!==void 0?this._list.get(u)[1]:o},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):emptyOrderedMap()},t.prototype.set=function(a,o){return updateOrderedMap(this,a,o)},t.prototype.remove=function(a){return updateOrderedMap(this,a,NOT_SET)},t.prototype.__iterate=function(a,o){var u=this;return this._list.__iterate(function(s){return s&&a(s[1],s[0],u)},o)},t.prototype.__iterator=function(a,o){return this._list.fromEntrySeq().__iterator(a,o)},t.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var o=this._map.__ensureOwner(a),u=this._list.__ensureOwner(a);return a?makeOrderedMap(o,u,a,this.__hash):this.size===0?emptyOrderedMap():(this.__ownerID=a,this.__altered=!1,this._map=o,this._list=u,this)},t}(Map$3);OrderedMap.isOrderedMap=isOrderedMap;OrderedMap.prototype[IS_ORDERED_SYMBOL]=!0;OrderedMap.prototype[DELETE]=OrderedMap.prototype.remove;function makeOrderedMap(n,t,r,a){var o=Object.create(OrderedMap.prototype);return o.size=n?n.size:0,o._map=n,o._list=t,o.__ownerID=r,o.__hash=a,o.__altered=!1,o}var EMPTY_ORDERED_MAP;function emptyOrderedMap(){return EMPTY_ORDERED_MAP||(EMPTY_ORDERED_MAP=makeOrderedMap(emptyMap(),emptyList()))}function updateOrderedMap(n,t,r){var a=n._map,o=n._list,u=a.get(t),s=u!==void 0,c,l;if(r===NOT_SET){if(!s)return n;o.size>=SIZE&&o.size>=a.size*2?(l=o.filter(function(d,f){return d!==void 0&&u!==f}),c=l.toKeyedSeq().map(function(d){return d[0]}).flip().toMap(),n.__ownerID&&(c.__ownerID=l.__ownerID=n.__ownerID)):(c=a.remove(t),l=u===o.size-1?o.pop():o.set(u,void 0))}else if(s){if(r===o.get(u)[1])return n;c=a,l=o.set(u,[t,r])}else c=a.set(t,o.size),l=o.set(o.size,[t,r]);return n.__ownerID?(n.size=c.size,n._map=c,n._list=l,n.__hash=void 0,n.__altered=!0,n):makeOrderedMap(c,l)}var IS_STACK_SYMBOL="@@__IMMUTABLE_STACK__@@";function isStack(n){return!!(n&&n[IS_STACK_SYMBOL])}var Stack=function(n){function t(r){return r==null?emptyStack():isStack(r)?r:emptyStack().pushAll(r)}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(a,o){var u=this._head;for(a=wrapIndex(this,a);u&&a--;)u=u.next;return u?u.value:o},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var a=arguments;if(arguments.length===0)return this;for(var o=this.size+arguments.length,u=this._head,s=arguments.length-1;s>=0;s--)u={value:a[s],next:u};return this.__ownerID?(this.size=o,this._head=u,this.__hash=void 0,this.__altered=!0,this):makeStack(o,u)},t.prototype.pushAll=function(a){if(a=n(a),a.size===0)return this;if(this.size===0&&isStack(a))return a;assertNotInfinite(a.size);var o=this.size,u=this._head;return a.__iterate(function(s){o++,u={value:s,next:u}},!0),this.__ownerID?(this.size=o,this._head=u,this.__hash=void 0,this.__altered=!0,this):makeStack(o,u)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):emptyStack()},t.prototype.slice=function(a,o){if(wholeSlice(a,o,this.size))return this;var u=resolveBegin(a,this.size),s=resolveEnd(o,this.size);if(s!==this.size)return n.prototype.slice.call(this,a,o);for(var c=this.size-u,l=this._head;u--;)l=l.next;return this.__ownerID?(this.size=c,this._head=l,this.__hash=void 0,this.__altered=!0,this):makeStack(c,l)},t.prototype.__ensureOwner=function(a){return a===this.__ownerID?this:a?makeStack(this.size,this._head,a,this.__hash):this.size===0?emptyStack():(this.__ownerID=a,this.__altered=!1,this)},t.prototype.__iterate=function(a,o){var u=this;if(o)return new ArraySeq(this.toArray()).__iterate(function(l,d){return a(l,d,u)},o);for(var s=0,c=this._head;c&&a(c.value,s++,this)!==!1;)c=c.next;return s},t.prototype.__iterator=function(a,o){if(o)return new ArraySeq(this.toArray()).__iterator(a,o);var u=0,s=this._head;return new Iterator(function(){if(s){var c=s.value;return s=s.next,iteratorValue(a,u++,c)}return iteratorDone()})},t}(IndexedCollection);Stack.isStack=isStack;var StackPrototype=Stack.prototype;StackPrototype[IS_STACK_SYMBOL]=!0;StackPrototype.shift=StackPrototype.pop;StackPrototype.unshift=StackPrototype.push;StackPrototype.unshiftAll=StackPrototype.pushAll;StackPrototype.withMutations=withMutations;StackPrototype.wasAltered=wasAltered;StackPrototype.asImmutable=asImmutable;StackPrototype["@@transducer/init"]=StackPrototype.asMutable=asMutable;StackPrototype["@@transducer/step"]=function(n,t){return n.unshift(t)};StackPrototype["@@transducer/result"]=function(n){return n.asImmutable()};function makeStack(n,t,r,a){var o=Object.create(StackPrototype);return o.size=n,o._head=t,o.__ownerID=r,o.__hash=a,o.__altered=!1,o}var EMPTY_STACK;function emptyStack(){return EMPTY_STACK||(EMPTY_STACK=makeStack(0))}var IS_SET_SYMBOL="@@__IMMUTABLE_SET__@@";function isSet(n){return!!(n&&n[IS_SET_SYMBOL])}function isOrderedSet(n){return isSet(n)&&isOrdered(n)}function deepEqual(n,t){if(n===t)return!0;if(!isCollection(t)||n.size!==void 0&&t.size!==void 0&&n.size!==t.size||n.__hash!==void 0&&t.__hash!==void 0&&n.__hash!==t.__hash||isKeyed(n)!==isKeyed(t)||isIndexed(n)!==isIndexed(t)||isOrdered(n)!==isOrdered(t))return!1;if(n.size===0&&t.size===0)return!0;var r=!isAssociative(n);if(isOrdered(n)){var a=n.entries();return t.every(function(l,d){var f=a.next().value;return f&&is(f[1],l)&&(r||is(f[0],d))})&&a.next().done}var o=!1;if(n.size===void 0)if(t.size===void 0)typeof n.cacheResult=="function"&&n.cacheResult();else{o=!0;var u=n;n=t,t=u}var s=!0,c=t.__iterate(function(l,d){if(r?!n.has(l):o?!is(l,n.get(d,NOT_SET)):!is(n.get(d,NOT_SET),l))return s=!1,!1});return s&&n.size===c}function mixin(n,t){var r=function(a){n.prototype[a]=t[a]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),n}function toJS(n){if(!n||typeof n!="object")return n;if(!isCollection(n)){if(!isDataStructure(n))return n;n=Seq(n)}if(isKeyed(n)){var t={};return n.__iterate(function(a,o){t[o]=toJS(a)}),t}var r=[];return n.__iterate(function(a){r.push(toJS(a))}),r}var Set$2=function(n){function t(r){return r==null?emptySet():isSet(r)&&!isOrdered(r)?r:emptySet().withMutations(function(a){var o=n(r);assertNotInfinite(o.size),o.forEach(function(u){return a.add(u)})})}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(a){return this(KeyedCollection(a).keySeq())},t.intersect=function(a){return a=Collection$1(a).toArray(),a.length?SetPrototype.intersect.apply(t(a.pop()),a):emptySet()},t.union=function(a){return a=Collection$1(a).toArray(),a.length?SetPrototype.union.apply(t(a.pop()),a):emptySet()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(a){return this._map.has(a)},t.prototype.add=function(a){return updateSet(this,this._map.set(a,a))},t.prototype.remove=function(a){return updateSet(this,this._map.remove(a))},t.prototype.clear=function(){return updateSet(this,this._map.clear())},t.prototype.map=function(a,o){var u=this,s=!1,c=updateSet(this,this._map.mapEntries(function(l){var d=l[1],f=a.call(o,d,d,u);return f!==d&&(s=!0),[f,f]},o));return s?c:this},t.prototype.union=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];return a=a.filter(function(u){return u.size!==0}),a.length===0?this:this.size===0&&!this.__ownerID&&a.length===1?this.constructor(a[0]):this.withMutations(function(u){for(var s=0;s<a.length;s++)typeof a[s]=="string"?u.add(a[s]):n(a[s]).forEach(function(c){return u.add(c)})})},t.prototype.intersect=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(a.length===0)return this;a=a.map(function(s){return n(s)});var u=[];return this.forEach(function(s){a.every(function(c){return c.includes(s)})||u.push(s)}),this.withMutations(function(s){u.forEach(function(c){s.remove(c)})})},t.prototype.subtract=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];if(a.length===0)return this;a=a.map(function(s){return n(s)});var u=[];return this.forEach(function(s){a.some(function(c){return c.includes(s)})&&u.push(s)}),this.withMutations(function(s){u.forEach(function(c){s.remove(c)})})},t.prototype.sort=function(a){return OrderedSet(sortFactory(this,a))},t.prototype.sortBy=function(a,o){return OrderedSet(sortFactory(this,o,a))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(a,o){var u=this;return this._map.__iterate(function(s){return a(s,s,u)},o)},t.prototype.__iterator=function(a,o){return this._map.__iterator(a,o)},t.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var o=this._map.__ensureOwner(a);return a?this.__make(o,a):this.size===0?this.__empty():(this.__ownerID=a,this._map=o,this)},t}(SetCollection);Set$2.isSet=isSet;var SetPrototype=Set$2.prototype;SetPrototype[IS_SET_SYMBOL]=!0;SetPrototype[DELETE]=SetPrototype.remove;SetPrototype.merge=SetPrototype.concat=SetPrototype.union;SetPrototype.withMutations=withMutations;SetPrototype.asImmutable=asImmutable;SetPrototype["@@transducer/init"]=SetPrototype.asMutable=asMutable;SetPrototype["@@transducer/step"]=function(n,t){return n.add(t)};SetPrototype["@@transducer/result"]=function(n){return n.asImmutable()};SetPrototype.__empty=emptySet;SetPrototype.__make=makeSet;function updateSet(n,t){return n.__ownerID?(n.size=t.size,n._map=t,n):t===n._map?n:t.size===0?n.__empty():n.__make(t)}function makeSet(n,t){var r=Object.create(SetPrototype);return r.size=n?n.size:0,r._map=n,r.__ownerID=t,r}var EMPTY_SET;function emptySet(){return EMPTY_SET||(EMPTY_SET=makeSet(emptyMap()))}var Range=function(n){function t(r,a,o){if(!(this instanceof t))return new t(r,a,o);if(invariant$1(o!==0,"Cannot step a Range by 0"),r=r||0,a===void 0&&(a=1/0),o=o===void 0?1:Math.abs(o),a<r&&(o=-o),this._start=r,this._end=a,this._step=o,this.size=Math.max(0,Math.ceil((a-r)/o-1)+1),this.size===0){if(EMPTY_RANGE)return EMPTY_RANGE;EMPTY_RANGE=this}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},t.prototype.get=function(a,o){return this.has(a)?this._start+wrapIndex(this,a)*this._step:o},t.prototype.includes=function(a){var o=(a-this._start)/this._step;return o>=0&&o<this.size&&o===Math.floor(o)},t.prototype.slice=function(a,o){return wholeSlice(a,o,this.size)?this:(a=resolveBegin(a,this.size),o=resolveEnd(o,this.size),o<=a?new t(0,0):new t(this.get(a,this._end),this.get(o,this._end),this._step))},t.prototype.indexOf=function(a){var o=a-this._start;if(o%this._step===0){var u=o/this._step;if(u>=0&&u<this.size)return u}return-1},t.prototype.lastIndexOf=function(a){return this.indexOf(a)},t.prototype.__iterate=function(a,o){for(var u=this.size,s=this._step,c=o?this._start+(u-1)*s:this._start,l=0;l!==u&&a(c,o?u-++l:l++,this)!==!1;)c+=o?-s:s;return l},t.prototype.__iterator=function(a,o){var u=this.size,s=this._step,c=o?this._start+(u-1)*s:this._start,l=0;return new Iterator(function(){if(l===u)return iteratorDone();var d=c;return c+=o?-s:s,iteratorValue(a,o?u-++l:l++,d)})},t.prototype.equals=function(a){return a instanceof t?this._start===a._start&&this._end===a._end&&this._step===a._step:deepEqual(this,a)},t}(IndexedSeq),EMPTY_RANGE;function getIn$1(n,t,r){for(var a=coerceKeyPath(t),o=0;o!==a.length;)if(n=get$1(n,a[o++],NOT_SET),n===NOT_SET)return r;return n}function getIn(n,t){return getIn$1(this,n,t)}function hasIn$1(n,t){return getIn$1(n,t,NOT_SET)!==NOT_SET}function hasIn(n){return hasIn$1(this,n)}function toObject(){assertNotInfinite(this.size);var n={};return this.__iterate(function(t,r){n[r]=t}),n}Collection$1.isIterable=isCollection;Collection$1.isKeyed=isKeyed;Collection$1.isIndexed=isIndexed;Collection$1.isAssociative=isAssociative;Collection$1.isOrdered=isOrdered;Collection$1.Iterator=Iterator;mixin(Collection$1,{toArray:function(){assertNotInfinite(this.size);var t=new Array(this.size||0),r=isKeyed(this),a=0;return this.__iterate(function(o,u){t[a++]=r?[u,o]:o}),t},toIndexedSeq:function(){return new ToIndexedSequence(this)},toJS:function(){return toJS(this)},toKeyedSeq:function(){return new ToKeyedSequence(this,!0)},toMap:function(){return Map$3(this.toKeyedSeq())},toObject,toOrderedMap:function(){return OrderedMap(this.toKeyedSeq())},toOrderedSet:function(){return OrderedSet(isKeyed(this)?this.valueSeq():this)},toSet:function(){return Set$2(isKeyed(this)?this.valueSeq():this)},toSetSeq:function(){return new ToSetSequence(this)},toSeq:function(){return isIndexed(this)?this.toIndexedSeq():isKeyed(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Stack(isKeyed(this)?this.valueSeq():this)},toList:function(){return List(isKeyed(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,r){return this.size===0?t+r:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return reify(this,concatFactory(this,t))},includes:function(t){return this.some(function(r){return is(r,t)})},entries:function(){return this.__iterator(ITERATE_ENTRIES)},every:function(t,r){assertNotInfinite(this.size);var a=!0;return this.__iterate(function(o,u,s){if(!t.call(r,o,u,s))return a=!1,!1}),a},filter:function(t,r){return reify(this,filterFactory(this,t,r,!0))},partition:function(t,r){return partitionFactory(this,t,r)},find:function(t,r,a){var o=this.findEntry(t,r);return o?o[1]:a},forEach:function(t,r){return assertNotInfinite(this.size),this.__iterate(r?t.bind(r):t)},join:function(t){assertNotInfinite(this.size),t=t!==void 0?""+t:",";var r="",a=!0;return this.__iterate(function(o){a?a=!1:r+=t,r+=o!=null?o.toString():""}),r},keys:function(){return this.__iterator(ITERATE_KEYS)},map:function(t,r){return reify(this,mapFactory(this,t,r))},reduce:function(t,r,a){return reduce(this,t,r,a,arguments.length<2,!1)},reduceRight:function(t,r,a){return reduce(this,t,r,a,arguments.length<2,!0)},reverse:function(){return reify(this,reverseFactory(this,!0))},slice:function(t,r){return reify(this,sliceFactory(this,t,r,!0))},some:function(t,r){assertNotInfinite(this.size);var a=!1;return this.__iterate(function(o,u,s){if(t.call(r,o,u,s))return a=!0,!1}),a},sort:function(t){return reify(this,sortFactory(this,t))},values:function(){return this.__iterator(ITERATE_VALUES)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(t,r){return ensureSize(t?this.toSeq().filter(t,r):this)},countBy:function(t,r){return countByFactory(this,t,r)},equals:function(t){return deepEqual(this,t)},entrySeq:function(){var t=this;if(t._cache)return new ArraySeq(t._cache);var r=t.toSeq().map(entryMapper).toIndexedSeq();return r.fromEntrySeq=function(){return t.toSeq()},r},filterNot:function(t,r){return this.filter(not(t),r)},findEntry:function(t,r,a){var o=a;return this.__iterate(function(u,s,c){if(t.call(r,u,s,c))return o=[s,u],!1}),o},findKey:function(t,r){var a=this.findEntry(t,r);return a&&a[0]},findLast:function(t,r,a){return this.toKeyedSeq().reverse().find(t,r,a)},findLastEntry:function(t,r,a){return this.toKeyedSeq().reverse().findEntry(t,r,a)},findLastKey:function(t,r){return this.toKeyedSeq().reverse().findKey(t,r)},first:function(t){return this.find(returnTrue$1,null,t)},flatMap:function(t,r){return reify(this,flatMapFactory(this,t,r))},flatten:function(t){return reify(this,flattenFactory(this,t,!0))},fromEntrySeq:function(){return new FromEntriesSequence(this)},get:function(t,r){return this.find(function(a,o){return is(o,t)},void 0,r)},getIn,groupBy:function(t,r){return groupByFactory(this,t,r)},has:function(t){return this.get(t,NOT_SET)!==NOT_SET},hasIn,isSubset:function(t){return t=typeof t.includes=="function"?t:Collection$1(t),this.every(function(r){return t.includes(r)})},isSuperset:function(t){return t=typeof t.isSubset=="function"?t:Collection$1(t),t.isSubset(this)},keyOf:function(t){return this.findKey(function(r){return is(r,t)})},keySeq:function(){return this.toSeq().map(keyMapper).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return maxFactory(this,t)},maxBy:function(t,r){return maxFactory(this,r,t)},min:function(t){return maxFactory(this,t?neg(t):defaultNegComparator)},minBy:function(t,r){return maxFactory(this,r?neg(r):defaultNegComparator,t)},rest:function(){return this.slice(1)},skip:function(t){return t===0?this:this.slice(Math.max(0,t))},skipLast:function(t){return t===0?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,r){return reify(this,skipWhileFactory(this,t,r,!0))},skipUntil:function(t,r){return this.skipWhile(not(t),r)},sortBy:function(t,r){return reify(this,sortFactory(this,r,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,r){return reify(this,takeWhileFactory(this,t,r))},takeUntil:function(t,r){return this.takeWhile(not(t),r)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=hashCollection(this))}});var CollectionPrototype=Collection$1.prototype;CollectionPrototype[IS_COLLECTION_SYMBOL]=!0;CollectionPrototype[ITERATOR_SYMBOL]=CollectionPrototype.values;CollectionPrototype.toJSON=CollectionPrototype.toArray;CollectionPrototype.__toStringMapper=quoteString;CollectionPrototype.inspect=CollectionPrototype.toSource=function(){return this.toString()};CollectionPrototype.chain=CollectionPrototype.flatMap;CollectionPrototype.contains=CollectionPrototype.includes;mixin(KeyedCollection,{flip:function(){return reify(this,flipFactory(this))},mapEntries:function(t,r){var a=this,o=0;return reify(this,this.toSeq().map(function(u,s){return t.call(r,[s,u],o++,a)}).fromEntrySeq())},mapKeys:function(t,r){var a=this;return reify(this,this.toSeq().flip().map(function(o,u){return t.call(r,o,u,a)}).flip())}});var KeyedCollectionPrototype=KeyedCollection.prototype;KeyedCollectionPrototype[IS_KEYED_SYMBOL]=!0;KeyedCollectionPrototype[ITERATOR_SYMBOL]=CollectionPrototype.entries;KeyedCollectionPrototype.toJSON=toObject;KeyedCollectionPrototype.__toStringMapper=function(n,t){return quoteString(t)+": "+quoteString(n)};mixin(IndexedCollection,{toKeyedSeq:function(){return new ToKeyedSequence(this,!1)},filter:function(t,r){return reify(this,filterFactory(this,t,r,!1))},findIndex:function(t,r){var a=this.findEntry(t,r);return a?a[0]:-1},indexOf:function(t){var r=this.keyOf(t);return r===void 0?-1:r},lastIndexOf:function(t){var r=this.lastKeyOf(t);return r===void 0?-1:r},reverse:function(){return reify(this,reverseFactory(this,!1))},slice:function(t,r){return reify(this,sliceFactory(this,t,r,!1))},splice:function(t,r){var a=arguments.length;if(r=Math.max(r||0,0),a===0||a===2&&!r)return this;t=resolveBegin(t,t<0?this.count():this.size);var o=this.slice(0,t);return reify(this,a===1?o:o.concat(arrCopy(arguments,2),this.slice(t+r)))},findLastIndex:function(t,r){var a=this.findLastEntry(t,r);return a?a[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return reify(this,flattenFactory(this,t,!1))},get:function(t,r){return t=wrapIndex(this,t),t<0||this.size===1/0||this.size!==void 0&&t>this.size?r:this.find(function(a,o){return o===t},void 0,r)},has:function(t){return t=wrapIndex(this,t),t>=0&&(this.size!==void 0?this.size===1/0||t<this.size:this.indexOf(t)!==-1)},interpose:function(t){return reify(this,interposeFactory(this,t))},interleave:function(){var t=[this].concat(arrCopy(arguments)),r=zipWithFactory(this.toSeq(),IndexedSeq.of,t),a=r.flatten(!0);return r.size&&(a.size=r.size*t.length),reify(this,a)},keySeq:function(){return Range(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,r){return reify(this,skipWhileFactory(this,t,r,!1))},zip:function(){var t=[this].concat(arrCopy(arguments));return reify(this,zipWithFactory(this,defaultZipper,t))},zipAll:function(){var t=[this].concat(arrCopy(arguments));return reify(this,zipWithFactory(this,defaultZipper,t,!0))},zipWith:function(t){var r=arrCopy(arguments);return r[0]=this,reify(this,zipWithFactory(this,t,r))}});var IndexedCollectionPrototype=IndexedCollection.prototype;IndexedCollectionPrototype[IS_INDEXED_SYMBOL]=!0;IndexedCollectionPrototype[IS_ORDERED_SYMBOL]=!0;mixin(SetCollection,{get:function(t,r){return this.has(t)?t:r},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var SetCollectionPrototype=SetCollection.prototype;SetCollectionPrototype.has=CollectionPrototype.includes;SetCollectionPrototype.contains=SetCollectionPrototype.includes;SetCollectionPrototype.keys=SetCollectionPrototype.values;mixin(KeyedSeq,KeyedCollectionPrototype);mixin(IndexedSeq,IndexedCollectionPrototype);mixin(SetSeq,SetCollectionPrototype);function reduce(n,t,r,a,o,u){return assertNotInfinite(n.size),n.__iterate(function(s,c,l){o?(o=!1,r=s):r=t.call(a,r,s,c,l)},u),r}function keyMapper(n,t){return t}function entryMapper(n,t){return[t,n]}function not(n){return function(){return!n.apply(this,arguments)}}function neg(n){return function(){return-n.apply(this,arguments)}}function defaultZipper(){return arrCopy(arguments)}function defaultNegComparator(n,t){return n<t?1:n>t?-1:0}function hashCollection(n){if(n.size===1/0)return 0;var t=isOrdered(n),r=isKeyed(n),a=t?1:0,o=n.__iterate(r?t?function(u,s){a=31*a+hashMerge(hash$1(u),hash$1(s))|0}:function(u,s){a=a+hashMerge(hash$1(u),hash$1(s))|0}:t?function(u){a=31*a+hash$1(u)|0}:function(u){a=a+hash$1(u)|0});return murmurHashOfSize(o,a)}function murmurHashOfSize(n,t){return t=imul(t,3432918353),t=imul(t<<15|t>>>-15,461845907),t=imul(t<<13|t>>>-13,5),t=(t+3864292196|0)^n,t=imul(t^t>>>16,2246822507),t=imul(t^t>>>13,3266489909),t=smi(t^t>>>16),t}function hashMerge(n,t){return n^t+2654435769+(n<<6)+(n>>2)|0}var OrderedSet=function(n){function t(r){return r==null?emptyOrderedSet():isOrderedSet(r)?r:emptyOrderedSet().withMutations(function(a){var o=SetCollection(r);assertNotInfinite(o.size),o.forEach(function(u){return a.add(u)})})}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(a){return this(KeyedCollection(a).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(Set$2);OrderedSet.isOrderedSet=isOrderedSet;var OrderedSetPrototype=OrderedSet.prototype;OrderedSetPrototype[IS_ORDERED_SYMBOL]=!0;OrderedSetPrototype.zip=IndexedCollectionPrototype.zip;OrderedSetPrototype.zipWith=IndexedCollectionPrototype.zipWith;OrderedSetPrototype.zipAll=IndexedCollectionPrototype.zipAll;OrderedSetPrototype.__empty=emptyOrderedSet;OrderedSetPrototype.__make=makeOrderedSet;function makeOrderedSet(n,t){var r=Object.create(OrderedSetPrototype);return r.size=n?n.size:0,r._map=n,r.__ownerID=t,r}var EMPTY_ORDERED_SET;function emptyOrderedSet(){return EMPTY_ORDERED_SET||(EMPTY_ORDERED_SET=makeOrderedSet(emptyOrderedMap()))}var PairSorting={LeftThenRight:-1,RightThenLeft:1};function throwOnInvalidDefaultValues(n){if(isRecord(n))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(isImmutable(n))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(n===null||typeof n!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var Record=function(t,r){var a;throwOnInvalidDefaultValues(t);var o=function(c){var l=this;if(c instanceof o)return c;if(!(this instanceof o))return new o(c);if(!a){a=!0;var d=Object.keys(t),f=u._indices={};u._name=r,u._keys=d,u._defaultValues=t;for(var h=0;h<d.length;h++){var v=d[h];f[v]=h,u[v]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+recordName(this)+' with property "'+v+'" since that property name is part of the Record API.'):setProp(u,v)}}return this.__ownerID=void 0,this._values=List().withMutations(function(g){g.setSize(l._keys.length),KeyedCollection(c).forEach(function(b,_){g.set(l._indices[_],b===l._defaultValues[_]?void 0:b)})}),this},u=o.prototype=Object.create(RecordPrototype);return u.constructor=o,r&&(o.displayName=r),o};Record.prototype.toString=function(){for(var t=recordName(this)+" { ",r=this._keys,a,o=0,u=r.length;o!==u;o++)a=r[o],t+=(o?", ":"")+a+": "+quoteString(this.get(a));return t+" }"};Record.prototype.equals=function(t){return this===t||isRecord(t)&&recordSeq(this).equals(recordSeq(t))};Record.prototype.hashCode=function(){return recordSeq(this).hashCode()};Record.prototype.has=function(t){return this._indices.hasOwnProperty(t)};Record.prototype.get=function(t,r){if(!this.has(t))return r;var a=this._indices[t],o=this._values.get(a);return o===void 0?this._defaultValues[t]:o};Record.prototype.set=function(t,r){if(this.has(t)){var a=this._values.set(this._indices[t],r===this._defaultValues[t]?void 0:r);if(a!==this._values&&!this.__ownerID)return makeRecord(this,a)}return this};Record.prototype.remove=function(t){return this.set(t)};Record.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:makeRecord(this,t)};Record.prototype.wasAltered=function(){return this._values.wasAltered()};Record.prototype.toSeq=function(){return recordSeq(this)};Record.prototype.toJS=function(){return toJS(this)};Record.prototype.entries=function(){return this.__iterator(ITERATE_ENTRIES)};Record.prototype.__iterator=function(t,r){return recordSeq(this).__iterator(t,r)};Record.prototype.__iterate=function(t,r){return recordSeq(this).__iterate(t,r)};Record.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var r=this._values.__ensureOwner(t);return t?makeRecord(this,r,t):(this.__ownerID=t,this._values=r,this)};Record.isRecord=isRecord;Record.getDescriptiveName=recordName;var RecordPrototype=Record.prototype;RecordPrototype[IS_RECORD_SYMBOL]=!0;RecordPrototype[DELETE]=RecordPrototype.remove;RecordPrototype.deleteIn=RecordPrototype.removeIn=deleteIn;RecordPrototype.getIn=getIn;RecordPrototype.hasIn=CollectionPrototype.hasIn;RecordPrototype.merge=merge$1$1;RecordPrototype.mergeWith=mergeWith$1;RecordPrototype.mergeIn=mergeIn;RecordPrototype.mergeDeep=mergeDeep;RecordPrototype.mergeDeepWith=mergeDeepWith;RecordPrototype.mergeDeepIn=mergeDeepIn;RecordPrototype.setIn=setIn;RecordPrototype.update=update;RecordPrototype.updateIn=updateIn;RecordPrototype.withMutations=withMutations;RecordPrototype.asMutable=asMutable;RecordPrototype.asImmutable=asImmutable;RecordPrototype[ITERATOR_SYMBOL]=RecordPrototype.entries;RecordPrototype.toJSON=RecordPrototype.toObject=CollectionPrototype.toObject;RecordPrototype.inspect=RecordPrototype.toSource=function(){return this.toString()};function makeRecord(n,t,r){var a=Object.create(Object.getPrototypeOf(n));return a._values=t,a.__ownerID=r,a}function recordName(n){return n.constructor.displayName||n.constructor.name||"Record"}function recordSeq(n){return keyedSeqFromValue(n._keys.map(function(t){return[t,n.get(t)]}))}function setProp(n,t){try{Object.defineProperty(n,t,{get:function(){return this.get(t)},set:function(r){invariant$1(this.__ownerID,"Cannot set on an immutable record."),this.set(t,r)}})}catch{}}var Repeat=function(n){function t(r,a){if(!(this instanceof t))return new t(r,a);if(this._value=r,this.size=a===void 0?1/0:Math.max(0,a),this.size===0){if(EMPTY_REPEAT)return EMPTY_REPEAT;EMPTY_REPEAT=this}}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},t.prototype.get=function(a,o){return this.has(a)?this._value:o},t.prototype.includes=function(a){return is(this._value,a)},t.prototype.slice=function(a,o){var u=this.size;return wholeSlice(a,o,u)?this:new t(this._value,resolveEnd(o,u)-resolveBegin(a,u))},t.prototype.reverse=function(){return this},t.prototype.indexOf=function(a){return is(this._value,a)?0:-1},t.prototype.lastIndexOf=function(a){return is(this._value,a)?this.size:-1},t.prototype.__iterate=function(a,o){for(var u=this.size,s=0;s!==u&&a(this._value,o?u-++s:s++,this)!==!1;);return s},t.prototype.__iterator=function(a,o){var u=this,s=this.size,c=0;return new Iterator(function(){return c===s?iteratorDone():iteratorValue(a,o?s-++c:c++,u._value)})},t.prototype.equals=function(a){return a instanceof t?is(this._value,a._value):deepEqual(this,a)},t}(IndexedSeq),EMPTY_REPEAT;function fromJS(n,t){return fromJSWith([],t||defaultConverter,n,"",t&&t.length>2?[]:void 0,{"":n})}function fromJSWith(n,t,r,a,o,u){if(typeof r!="string"&&!isImmutable(r)&&(isArrayLike(r)||hasIterator(r)||isPlainObject(r))){if(~n.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");n.push(r),o&&a!==""&&o.push(a);var s=t.call(u,a,Seq(r).map(function(c,l){return fromJSWith(n,t,c,l,o,r)}),o&&o.slice());return n.pop(),o&&o.pop(),s}return r}function defaultConverter(n,t){return isIndexed(t)?t.toList():isKeyed(t)?t.toMap():t.toSet()}var version$3="4.3.7",Immutable={version:version$3,Collection:Collection$1,Iterable:Collection$1,Seq,Map:Map$3,OrderedMap,List,Stack,Set:Set$2,OrderedSet,PairSorting,Record,Range,Repeat,is,fromJS,hash:hash$1,isImmutable,isCollection,isKeyed,isIndexed,isAssociative,isOrdered,isValueObject,isPlainObject,isSeq,isList,isMap,isOrderedMap,isStack,isSet,isOrderedSet,isRecord,get:get$1,getIn:getIn$1,has,hasIn:hasIn$1,merge:merge$2,mergeDeep:mergeDeep$1,mergeWith,mergeDeepWith:mergeDeepWith$1,remove:remove$1,removeIn,set:set$1,setIn:setIn$1,update:update$1,updateIn:updateIn$1},Iterable=Collection$1;const immutable_es=Object.freeze(Object.defineProperty({__proto__:null,Collection:Collection$1,Iterable,List,Map:Map$3,OrderedMap,OrderedSet,PairSorting,Range,Record,Repeat,Seq,Set:Set$2,Stack,default:Immutable,fromJS,get:get$1,getIn:getIn$1,has,hasIn:hasIn$1,hash:hash$1,is,isAssociative,isCollection,isImmutable,isIndexed,isKeyed,isList,isMap,isOrdered,isOrderedMap,isOrderedSet,isPlainObject,isRecord,isSeq,isSet,isStack,isValueObject,merge:merge$2,mergeDeep:mergeDeep$1,mergeDeepWith:mergeDeepWith$1,mergeWith,remove:remove$1,removeIn,set:set$1,setIn:setIn$1,update:update$1,updateIn:updateIn$1,version:version$3},Symbol.toStringTag,{value:"Module"})),require$$0$2=getAugmentedNamespace(immutable_es);var hasRequiredActionContext;function requireActionContext(){if(hasRequiredActionContext)return ActionContext;hasRequiredActionContext=1,Object.defineProperty(ActionContext,"__esModule",{value:!0}),ActionContext.ActionContextKey=ActionContext.ActionContext=void 0;const n=require$$0$2;let t=class en{constructor(o={}){this.map=(0,n.Map)(o)}setDefault(o,u){return this.has(o)?this:this.set(o,u)}set(o,u){return this.setRaw(o.name,u)}setRaw(o,u){return new en(this.map.set(o,u))}delete(o){return new en(this.map.delete(o.name))}get(o){return this.getRaw(o.name)}getRaw(o){return this.map.get(o)}getSafe(o){if(!this.has(o))throw new Error(`Context entry ${o.name} is required but not available`);return this.get(o)}has(o){return this.hasRaw(o.name)}hasRaw(o){return this.map.has(o)}merge(...o){let u=this;for(const s of o)for(const c of s.keys())u=u.set(c,s.get(c));return u}keys(){return[...this.map.keys()].map(o=>new r(o))}toJS(){return this.map.toJS()}toString(){return`ActionContext(${JSON.stringify(this.map.toJS())})`}[Symbol.for("nodejs.util.inspect.custom")](){return`ActionContext(${JSON.stringify(this.map.toJS(),null,"  ")})`}static ensureActionContext(o){return o instanceof en?o:new en((0,n.Map)(o??{}))}};ActionContext.ActionContext=t;class r{constructor(o){this.name=o}}return ActionContext.ActionContextKey=r,ActionContext}var Bus={},hasRequiredBus;function requireBus(){if(hasRequiredBus)return Bus;hasRequiredBus=1,Object.defineProperty(Bus,"__esModule",{value:!0}),Bus.Bus=void 0;let n=class{constructor(r){this.actors=[],this.observers=[],this.dependencyLinks=new Map,Object.assign(this,r),this.failMessage=`All actors over bus ${this.name} failed to handle an action`}subscribe(r){this.actors.push(r),this.reorderForDependencies()}subscribeObserver(r){this.observers.push(r)}unsubscribe(r){const a=this.actors.indexOf(r);return a>=0?(this.actors.splice(a,1),!0):!1}unsubscribeObserver(r){const a=this.observers.indexOf(r);return a>=0?(this.observers.splice(a,1),!0):!1}publish(r){return this.actors.map(a=>({actor:a,reply:a.test(r)}))}onRun(r,a,o){for(const u of this.observers)u.onRun(r,a,o)}addDependencies(r,a){for(const o of a){let u=this.dependencyLinks.get(o);u||(u=[],this.dependencyLinks.set(o,u)),u.push(r)}this.reorderForDependencies()}reorderForDependencies(){if(this.dependencyLinks.size>0){const r=[];for(const a of this.dependencyLinks.keys()){const o=this.actors.indexOf(a);o>=0&&(this.actors.splice(o,1),r.push(a))}for(;r.length>0;){let a=-1;for(let u=0;u<r.length;u++){let s=!0;for(const c of this.dependencyLinks.get(r[u]))if(!this.actors.includes(c)&&r.includes(c)){s=!1;break}if(s){a=u;break}}if(a<0)throw new Error(`Cyclic dependency links detected in bus ${this.name}`);const o=r.splice(a,1)[0];this.actors.push(o)}}}};return Bus.Bus=n,Bus}var BusIndexed={},hasRequiredBusIndexed;function requireBusIndexed(){if(hasRequiredBusIndexed)return BusIndexed;hasRequiredBusIndexed=1,Object.defineProperty(BusIndexed,"__esModule",{value:!0}),BusIndexed.BusIndexed=void 0;const n=requireBus();let t=class extends n.Bus{constructor(a){super(a),this.actorsIndex={}}subscribe(a){const o=this.getActorIdentifiers(a)??["_undefined_"];for(const u of o){let s=this.actorsIndex[u];s||(s=this.actorsIndex[u]=[]),s.push(a),super.subscribe(a)}}unsubscribe(a){const o=this.getActorIdentifiers(a)??["_undefined_"];let u=!1;for(const s of o){const c=this.actorsIndex[s];if(c){const l=c.indexOf(a);l>=0&&c.splice(l,1),c.length===0&&delete this.actorsIndex[s]}u=u||super.unsubscribe(a)}return u}publish(a){const o=this.getActionIdentifier(a);return o?[...this.actorsIndex[o]||[],...this.actorsIndex._undefined_||[]].map(s=>({actor:s,reply:s.test(a)})):super.publish(a)}getActorIdentifiers(a){const o=this.actorIdentifierFields.reduce((u,s)=>u[s],a);if(o)return Array.isArray(o)?o:[o]}getActionIdentifier(a){return this.actionIdentifierFields.reduce((o,u)=>o[u],a)}};return BusIndexed.BusIndexed=t,BusIndexed}var ContextEntries={},hasRequiredContextEntries;function requireContextEntries(){if(hasRequiredContextEntries)return ContextEntries;hasRequiredContextEntries=1,Object.defineProperty(ContextEntries,"__esModule",{value:!0}),ContextEntries.CONTEXT_KEY_LOGGER=void 0;const n=requireActionContext();return ContextEntries.CONTEXT_KEY_LOGGER=new n.ActionContextKey("@comunica/core:log"),ContextEntries}var ActionObserver={},hasRequiredActionObserver;function requireActionObserver(){if(hasRequiredActionObserver)return ActionObserver;hasRequiredActionObserver=1,Object.defineProperty(ActionObserver,"__esModule",{value:!0}),ActionObserver.ActionObserver=void 0;let n=class{constructor(r){Object.assign(this,r)}};return ActionObserver.ActionObserver=n,ActionObserver}var Actor={},hasRequiredActor;function requireActor(){if(hasRequiredActor)return Actor;hasRequiredActor=1,Object.defineProperty(Actor,"__esModule",{value:!0}),Actor.Actor=void 0;const n=requireContextEntries();let t=class Ir{constructor(a){this.beforeActors=[],Object.assign(this,a),this.bus.subscribe(this),this.beforeActors.length>0&&this.bus.addDependencies(this,this.beforeActors),a.busFailMessage&&(this.bus.failMessage=a.busFailMessage)}static getContextLogger(a){return a.get(n.CONTEXT_KEY_LOGGER)}runObservable(a,o){const u=this.run(a,o);return this.bus.onRun(this,a,u),u}getDefaultLogData(a,o){const u=o?o():{};return u.actor=this.name,u}logTrace(a,o,u){const s=Ir.getContextLogger(a);s&&s.trace(o,this.getDefaultLogData(a,u))}logDebug(a,o,u){const s=Ir.getContextLogger(a);s&&s.debug(o,this.getDefaultLogData(a,u))}logInfo(a,o,u){const s=Ir.getContextLogger(a);s&&s.info(o,this.getDefaultLogData(a,u))}logWarn(a,o,u){const s=Ir.getContextLogger(a);s&&s.warn(o,this.getDefaultLogData(a,u))}logError(a,o,u){const s=Ir.getContextLogger(a);s&&s.error(o,this.getDefaultLogData(a,u))}logFatal(a,o,u){const s=Ir.getContextLogger(a);s&&s.fatal(o,this.getDefaultLogData(a,u))}};return Actor.Actor=t,Actor}var Mediator={},hasRequiredMediator;function requireMediator(){if(hasRequiredMediator)return Mediator;hasRequiredMediator=1,Object.defineProperty(Mediator,"__esModule",{value:!0}),Mediator.Mediator=void 0;let n=class ni{constructor(r){Object.assign(this,r)}publish(r){const a=this.bus.publish(r);if(a.length===0)throw new Error(`No actors are able to reply to a message in the bus ${this.bus.name}`);return a}async mediateActor(r){return await this.mediateWith(r,this.publish(r))}async mediateTestable(r){return(await this.mediateActor(r)).mapAsync((o,u)=>o.runObservable(r,u))}async mediate(r){return(await this.mediateTestable(r)).getOrThrow()}constructFailureMessage(r,a){const o=`
        `;return`${this.bus.failMessage.replaceAll(/\$\{(.*?)\}/gu,(s,c)=>ni.getObjectValue({action:r},c.split("."))||s)}
    Error messages of failing actors:${o}${a.join(o)}`}static getObjectValue(r,a){if(a.length===0)return r;if(r)return ni.getObjectValue(r[a[0]],a.slice(1))}};return Mediator.Mediator=n,Mediator}var TestResult={},hasRequiredTestResult;function requireTestResult(){if(hasRequiredTestResult)return TestResult;hasRequiredTestResult=1,Object.defineProperty(TestResult,"__esModule",{value:!0}),TestResult.TestResultFailed=TestResult.TestResultPassed=TestResult.failTest=TestResult.passTestVoidWithSideData=TestResult.passTestWithSideData=TestResult.passTestVoid=TestResult.passTest=void 0;function n(c){return new u(c,void 0)}TestResult.passTest=n;function t(){return new u(!0,void 0)}TestResult.passTestVoid=t;function r(c,l){return new u(c,l)}TestResult.passTestWithSideData=r;function a(c){return new u(!0,c)}TestResult.passTestVoidWithSideData=a;function o(c){return new s(c)}TestResult.failTest=o;class u{constructor(l,d){this.value=l,this.sideData=d}isPassed(){return!0}isFailed(){return!1}get(){return this.value}getOrThrow(){return this.value}getSideData(){return this.sideData}getFailMessage(){}map(l){return new u(l(this.value,this.sideData),this.sideData)}async mapAsync(l){return new u(await l(this.value,this.sideData),this.sideData)}}TestResult.TestResultPassed=u;class s{constructor(l){this.failMessage=l}isPassed(){return!1}isFailed(){return!0}get(){}getOrThrow(){throw new Error(this.getFailMessage())}getSideData(){throw new Error(this.getFailMessage())}getFailMessage(){return this.failMessage}map(){return this}async mapAsync(){return this}}return TestResult.TestResultFailed=s,TestResult}var hasRequiredLib$4s;function requireLib$4s(){return hasRequiredLib$4s||(hasRequiredLib$4s=1,function(n){var t=lib$4r&&lib$4r.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4r&&lib$4r.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActionContext(),n),r(requireBus(),n),r(requireBusIndexed(),n),r(requireContextEntries(),n),r(requireActionObserver(),n),r(requireActor(),n),r(requireMediator(),n),r(requireTestResult(),n)}(lib$4r)),lib$4r}var hasRequiredActorInit;function requireActorInit(){if(hasRequiredActorInit)return ActorInit;hasRequiredActorInit=1,Object.defineProperty(ActorInit,"__esModule",{value:!0}),ActorInit.ActorInit=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorInit.ActorInit=t,ActorInit}var hasRequiredLib$4r;function requireLib$4r(){return hasRequiredLib$4r||(hasRequiredLib$4r=1,function(n){var t=lib$4s&&lib$4s.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4s&&lib$4s.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorInit(),n)}(lib$4s)),lib$4s}var hasRequiredActorInitQueryBase;function requireActorInitQueryBase(){if(hasRequiredActorInitQueryBase)return ActorInitQueryBase;hasRequiredActorInitQueryBase=1,Object.defineProperty(ActorInitQueryBase,"__esModule",{value:!0}),ActorInitQueryBase.ActorInitQueryBase=void 0;const n=requireLib$4r(),t=requireLib$4s();let r=class extends n.ActorInit{async test(o){return(0,t.passTestVoid)()}async run(o){throw new Error("ActorInitSparql#run is not supported in the browser.")}};return ActorInitQueryBase.ActorInitQueryBase=r,ActorInitQueryBase}var ActorInitQueryBrowser={},browser$2={exports:{}},hasRequiredBrowser$2;function requireBrowser$2(){if(hasRequiredBrowser$2)return browser$2.exports;hasRequiredBrowser$2=1;var n=browser$2.exports={},t,r;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?t=setTimeout:t=a}catch{t=a}try{typeof clearTimeout=="function"?r=clearTimeout:r=o}catch{r=o}})();function u(_){if(t===setTimeout)return setTimeout(_,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(_,0);try{return t(_,0)}catch{try{return t.call(null,_,0)}catch{return t.call(this,_,0)}}}function s(_){if(r===clearTimeout)return clearTimeout(_);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(_);try{return r(_)}catch{try{return r.call(null,_)}catch{return r.call(this,_)}}}var c=[],l=!1,d,f=-1;function h(){!l||!d||(l=!1,d.length?c=d.concat(c):f=-1,c.length&&v())}function v(){if(!l){var _=u(h);l=!0;for(var S=c.length;S;){for(d=c,c=[];++f<S;)d&&d[f].run();f=-1,S=c.length}d=null,l=!1,s(_)}}n.nextTick=function(_){var S=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)S[T-1]=arguments[T];c.push(new g(_,S)),c.length===1&&!l&&u(v)};function g(_,S){this.fun=_,this.array=S}g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={};function b(){}return n.on=b,n.addListener=b,n.once=b,n.off=b,n.removeListener=b,n.removeAllListeners=b,n.emit=b,n.prependListener=b,n.prependOnceListener=b,n.listeners=function(_){return[]},n.binding=function(_){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(_){throw new Error("process.chdir is not supported")},n.umask=function(){return 0},browser$2.exports}var hasRequiredActorInitQueryBrowser;function requireActorInitQueryBrowser(){if(hasRequiredActorInitQueryBrowser)return ActorInitQueryBrowser;hasRequiredActorInitQueryBrowser=1,Object.defineProperty(ActorInitQueryBrowser,"__esModule",{value:!0}),ActorInitQueryBrowser.ActorInitQuery=void 0;const n=requireActorInitQueryBase();typeof process>"u"&&(globalThis.process=requireBrowser$2());class t extends n.ActorInitQueryBase{}return ActorInitQueryBrowser.ActorInitQuery=t,ActorInitQueryBrowser}var QueryEngineBase={},lib$4q={},Keys={},hasRequiredKeys;function requireKeys(){if(hasRequiredKeys)return Keys;hasRequiredKeys=1,Object.defineProperty(Keys,"__esModule",{value:!0}),Keys.KeysStatistics=Keys.KeysRdfJoin=Keys.KeysMergeBindingsContext=Keys.KeysRdfUpdateQuads=Keys.KeysQuerySourceIdentify=Keys.KeysRdfParseHtmlScript=Keys.KeysRdfParseJsonLd=Keys.KeysQueryOperation=Keys.KeysExpressionEvaluator=Keys.KeysInitQuery=Keys.KeysHttpProxy=Keys.KeysHttpMemento=Keys.KeysHttpWayback=Keys.KeysHttp=Keys.KeysCore=void 0;const n=requireLib$4s();return Keys.KeysCore={log:n.CONTEXT_KEY_LOGGER},Keys.KeysHttp={includeCredentials:new n.ActionContextKey("@comunica/bus-http:include-credentials"),auth:new n.ActionContextKey("@comunica/bus-http:auth"),fetch:new n.ActionContextKey("@comunica/bus-http:fetch"),httpTimeout:new n.ActionContextKey("@comunica/bus-http:http-timeout"),httpBodyTimeout:new n.ActionContextKey("@comunica/bus-http:http-body-timeout"),httpRetryCount:new n.ActionContextKey("@comunica/bus-http:http-retry-count"),httpRetryDelayFallback:new n.ActionContextKey("@comunica/bus-http:http-retry-delay-fallback"),httpRetryDelayLimit:new n.ActionContextKey("@comunica/bus-http:http-retry-delay-limit"),httpRetryStatusCodes:new n.ActionContextKey("@comunica/bus-http:http-retry-status-codes")},Keys.KeysHttpWayback={recoverBrokenLinks:new n.ActionContextKey("@comunica/bus-http:recover-broken-links")},Keys.KeysHttpMemento={datetime:new n.ActionContextKey("@comunica/actor-http-memento:datetime")},Keys.KeysHttpProxy={httpProxyHandler:new n.ActionContextKey("@comunica/actor-http-proxy:httpProxyHandler")},Keys.KeysInitQuery={querySourcesUnidentified:new n.ActionContextKey("@comunica/actor-init-query:querySourcesUnidentified"),initialBindings:new n.ActionContextKey("@comunica/actor-init-query:initialBindings"),queryFormat:new n.ActionContextKey("@comunica/actor-init-query:queryFormat"),graphqlSingularizeVariables:new n.ActionContextKey("@comunica/actor-init-query:singularizeVariables"),lenient:new n.ActionContextKey("@comunica/actor-init-query:lenient"),queryString:new n.ActionContextKey("@comunica/actor-init-query:queryString"),query:new n.ActionContextKey("@comunica/actor-init-query:query"),baseIRI:new n.ActionContextKey("@comunica/actor-init-query:baseIRI"),functionArgumentsCache:new n.ActionContextKey("@comunica/actor-init-query:functionArgumentsCache"),queryTimestamp:new n.ActionContextKey("@comunica/actor-init-query:queryTimestamp"),queryTimestampHighResolution:new n.ActionContextKey("@comunica/actor-init-query:queryTimestampHighResolution"),extensionFunctionCreator:new n.ActionContextKey("@comunica/actor-init-query:extensionFunctionCreator"),extensionFunctions:new n.ActionContextKey("@comunica/actor-init-query:extensionFunctions"),cliArgsHandlers:new n.ActionContextKey("@comunica/actor-init-query:cliArgsHandlers"),explain:new n.ActionContextKey("@comunica/actor-init-query:explain"),physicalQueryPlanLogger:new n.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanLogger"),physicalQueryPlanNode:new n.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanNode"),jsonLdContext:new n.ActionContextKey("@context"),invalidateCache:new n.ActionContextKey("@comunica/actor-init-query:invalidateCache"),dataFactory:new n.ActionContextKey("@comunica/actor-init-query:dataFactory"),distinctConstruct:new n.ActionContextKey("@comunica/actor-init-query:distinctConstruct")},Keys.KeysExpressionEvaluator={extensionFunctionCreator:new n.ActionContextKey("@comunica/utils-expression-evaluator:extensionFunctionCreator"),superTypeProvider:new n.ActionContextKey("@comunica/utils-expression-evaluator:superTypeProvider"),defaultTimeZone:new n.ActionContextKey("@comunica/utils-expression-evaluator:defaultTimeZone"),actionContext:new n.ActionContextKey("@comunica/utils-expression-evaluator:actionContext")},Keys.KeysQueryOperation={operation:new n.ActionContextKey("@comunica/bus-query-operation:operation"),joinLeftMetadata:new n.ActionContextKey("@comunica/bus-query-operation:joinLeftMetadata"),joinRightMetadatas:new n.ActionContextKey("@comunica/bus-query-operation:joinRightMetadatas"),joinBindings:new n.ActionContextKey("@comunica/bus-query-operation:joinBindings"),readOnly:new n.ActionContextKey("@comunica/bus-query-operation:readOnly"),isPathArbitraryLengthDistinctKey:new n.ActionContextKey("@comunica/bus-query-operation:isPathArbitraryLengthDistinct"),limitIndicator:new n.ActionContextKey("@comunica/bus-query-operation:limitIndicator"),unionDefaultGraph:new n.ActionContextKey("@comunica/bus-query-operation:unionDefaultGraph"),querySources:new n.ActionContextKey("@comunica/bus-query-operation:querySources")},Keys.KeysRdfParseJsonLd={documentLoader:new n.ActionContextKey("@comunica/actor-rdf-parse-jsonld:documentLoader"),strictValues:new n.ActionContextKey("@comunica/actor-rdf-parse-jsonld:strictValues"),parserOptions:new n.ActionContextKey("@comunica/actor-rdf-parse-jsonld:parserOptions")},Keys.KeysRdfParseHtmlScript={processingHtmlScript:new n.ActionContextKey("@comunica/actor-rdf-parse-html-script:processingHtmlScript"),extractAllScripts:new n.ActionContextKey("extractAllScripts")},Keys.KeysQuerySourceIdentify={sourceIds:new n.ActionContextKey("@comunica/bus-query-source-identify:sourceIds"),hypermediaSourcesAggregatedStores:new n.ActionContextKey("@comunica/bus-query-source-identify:hypermediaSourcesAggregatedStores"),traverse:new n.ActionContextKey("@comunica/bus-query-source-identify:traverse")},Keys.KeysRdfUpdateQuads={destination:new n.ActionContextKey("@comunica/bus-rdf-update-quads:destination")},Keys.KeysMergeBindingsContext={sourcesBinding:new n.ActionContextKey("@comunica/bus-merge-bindings-context:sourcesBinding")},Keys.KeysRdfJoin={lastPhysicalJoin:new n.ActionContextKey("@comunica/bus-rdf-join:lastPhysicalJoin")},Keys.KeysStatistics={discoveredLinks:new n.ActionContextKey("@comunica/statistic:discoveredLinks"),dereferencedLinks:new n.ActionContextKey("@comunica/statistic:dereferencedLinks"),intermediateResults:new n.ActionContextKey("@comunica/statistic:intermediateResults")},Keys}var hasRequiredLib$4q;function requireLib$4q(){return hasRequiredLib$4q||(hasRequiredLib$4q=1,function(n){var t=lib$4q&&lib$4q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4q&&lib$4q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireKeys(),n)}(lib$4q)),lib$4q}var hasRequiredQueryEngineBase;function requireQueryEngineBase(){if(hasRequiredQueryEngineBase)return QueryEngineBase;hasRequiredQueryEngineBase=1,Object.defineProperty(QueryEngineBase,"__esModule",{value:!0}),QueryEngineBase.QueryEngineBase=void 0;const n=requireLib$4q(),t=requireLib$4s();let r=class ii{constructor(o){this.actorInitQuery=o}async queryBindings(o,u){return this.queryOfType(o,u,"bindings")}async queryQuads(o,u){return this.queryOfType(o,u,"quads")}async queryBoolean(o,u){return this.queryOfType(o,u,"boolean")}async queryVoid(o,u){return this.queryOfType(o,u,"void")}async queryOfType(o,u,s){const c=await this.query(o,u);if(c.resultType===s)return await c.execute();throw new Error(`Query result type '${s}' was expected, while '${c.resultType}' was found.`)}async query(o,u){const s=await this.queryOrExplain(o,u);if("explain"in s)throw new Error("Tried to explain a query when in query-only mode");return s}async explain(o,u,s){return u.explain=s,await this.queryOrExplain(o,u)}async queryOrExplain(o,u){const s=t.ActionContext.ensureActionContext(u);s.get(n.KeysInitQuery.invalidateCache)&&await this.invalidateHttpCache();const{result:c}=await this.actorInitQuery.mediatorQueryProcess.mediate({query:o,context:s});return"explain"in c?c:ii.internalToFinalResult(c)}async getResultMediaTypes(o){return o=t.ActionContext.ensureActionContext(o),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeCombiner.mediate({context:o,mediaTypes:!0})).mediaTypes}async getResultMediaTypeFormats(o){return o=t.ActionContext.ensureActionContext(o),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeFormatCombiner.mediate({context:o,mediaTypeFormats:!0})).mediaTypeFormats}async resultToString(o,u,s){if(s=t.ActionContext.ensureActionContext(s),!u)switch(o.resultType){case"bindings":u="application/json";break;case"quads":u="application/trig";break;default:u="simple";break}const c={...await ii.finalToInternalResult(o),context:s};return(await this.actorInitQuery.mediatorQueryResultSerialize.mediate({context:s,handle:c,handleMediaType:u})).handle}invalidateHttpCache(o,u){return u=t.ActionContext.ensureActionContext(u),this.actorInitQuery.mediatorHttpInvalidate.mediate({url:o,context:u})}static internalToFinalResult(o){switch(o.type){case"bindings":return{resultType:"bindings",execute:async()=>o.bindingsStream,metadata:async()=>{const u=await o.metadata();return u.variables=u.variables.map(s=>s.variable),u},context:o.context};case"quads":return{resultType:"quads",execute:async()=>o.quadStream,metadata:async()=>await o.metadata(),context:o.context};case"boolean":return{resultType:"boolean",execute:async()=>o.execute(),context:o.context};case"void":return{resultType:"void",execute:async()=>o.execute(),context:o.context}}}static async finalToInternalResult(o){switch(o.resultType){case"bindings":return{type:"bindings",bindingsStream:await o.execute(),metadata:async()=>{const u=await o.metadata();return u.variables=u.variables.map(s=>({variable:s,canBeUndef:!1})),u}};case"quads":return{type:"quads",quadStream:await o.execute(),metadata:async()=>await o.metadata()};case"boolean":return{type:"boolean",execute:()=>o.execute()};case"void":return{type:"void",execute:()=>o.execute()}}}};return QueryEngineBase.QueryEngineBase=r,QueryEngineBase}var hasRequiredIndexBrowser$1;function requireIndexBrowser$1(){return hasRequiredIndexBrowser$1||(hasRequiredIndexBrowser$1=1,function(n){var t=indexBrowser&&indexBrowser.__createBinding||(Object.create?function(o,u,s,c){c===void 0&&(c=s);var l=Object.getOwnPropertyDescriptor(u,s);(!l||("get"in l?!u.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return u[s]}}),Object.defineProperty(o,c,l)}:function(o,u,s,c){c===void 0&&(c=s),o[c]=u[s]}),r=indexBrowser&&indexBrowser.__exportStar||function(o,u){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(u,s)&&t(u,o,s)};Object.defineProperty(n,"__esModule",{value:!0}),n.QueryEngineBase=void 0,r(requireActorInitQueryBase(),n),r(requireActorInitQueryBrowser(),n);var a=requireQueryEngineBase();Object.defineProperty(n,"QueryEngineBase",{enumerable:!0,get:function(){return a.QueryEngineBase}})}(indexBrowser)),indexBrowser}var lib$4p={},LoggerVoid={},lib$4o={},Bindings$1={},hasRequiredBindings$1;function requireBindings$1(){return hasRequiredBindings$1||(hasRequiredBindings$1=1,Object.defineProperty(Bindings$1,"__esModule",{value:!0})),Bindings$1}var ComunicaDataFactory={},hasRequiredComunicaDataFactory;function requireComunicaDataFactory(){return hasRequiredComunicaDataFactory||(hasRequiredComunicaDataFactory=1,Object.defineProperty(ComunicaDataFactory,"__esModule",{value:!0})),ComunicaDataFactory}var IActionContext={},hasRequiredIActionContext;function requireIActionContext(){return hasRequiredIActionContext||(hasRequiredIActionContext=1,Object.defineProperty(IActionContext,"__esModule",{value:!0})),IActionContext}var IAggregatedStore={},hasRequiredIAggregatedStore;function requireIAggregatedStore(){return hasRequiredIAggregatedStore||(hasRequiredIAggregatedStore=1,Object.defineProperty(IAggregatedStore,"__esModule",{value:!0})),IAggregatedStore}var ICliArgsHandler={},hasRequiredICliArgsHandler;function requireICliArgsHandler(){return hasRequiredICliArgsHandler||(hasRequiredICliArgsHandler=1,Object.defineProperty(ICliArgsHandler,"__esModule",{value:!0})),ICliArgsHandler}var IDataDestination={},hasRequiredIDataDestination;function requireIDataDestination(){return hasRequiredIDataDestination||(hasRequiredIDataDestination=1,Object.defineProperty(IDataDestination,"__esModule",{value:!0})),IDataDestination}var IJoinEntry={},hasRequiredIJoinEntry;function requireIJoinEntry(){return hasRequiredIJoinEntry||(hasRequiredIJoinEntry=1,Object.defineProperty(IJoinEntry,"__esModule",{value:!0})),IJoinEntry}var IMetadata={},hasRequiredIMetadata;function requireIMetadata(){return hasRequiredIMetadata||(hasRequiredIMetadata=1,Object.defineProperty(IMetadata,"__esModule",{value:!0})),IMetadata}var IPhysicalQueryPlanLogger={},hasRequiredIPhysicalQueryPlanLogger;function requireIPhysicalQueryPlanLogger(){return hasRequiredIPhysicalQueryPlanLogger||(hasRequiredIPhysicalQueryPlanLogger=1,Object.defineProperty(IPhysicalQueryPlanLogger,"__esModule",{value:!0})),IPhysicalQueryPlanLogger}var IProxyHandler={},hasRequiredIProxyHandler;function requireIProxyHandler(){return hasRequiredIProxyHandler||(hasRequiredIProxyHandler=1,Object.defineProperty(IProxyHandler,"__esModule",{value:!0})),IProxyHandler}var IQueryContext={},hasRequiredIQueryContext;function requireIQueryContext(){return hasRequiredIQueryContext||(hasRequiredIQueryContext=1,Object.defineProperty(IQueryContext,"__esModule",{value:!0})),IQueryContext}var IQueryEngine={},hasRequiredIQueryEngine;function requireIQueryEngine(){return hasRequiredIQueryEngine||(hasRequiredIQueryEngine=1,Object.defineProperty(IQueryEngine,"__esModule",{value:!0})),IQueryEngine}var IQueryOperationResult={},hasRequiredIQueryOperationResult;function requireIQueryOperationResult(){return hasRequiredIQueryOperationResult||(hasRequiredIQueryOperationResult=1,Object.defineProperty(IQueryOperationResult,"__esModule",{value:!0})),IQueryOperationResult}var IQuerySource={},hasRequiredIQuerySource;function requireIQuerySource(){return hasRequiredIQuerySource||(hasRequiredIQuerySource=1,Object.defineProperty(IQuerySource,"__esModule",{value:!0})),IQuerySource}var IStatisticBase={},hasRequiredIStatisticBase;function requireIStatisticBase(){return hasRequiredIStatisticBase||(hasRequiredIStatisticBase=1,Object.defineProperty(IStatisticBase,"__esModule",{value:!0})),IStatisticBase}var IDiscoverEventData={},hasRequiredIDiscoverEventData;function requireIDiscoverEventData(){return hasRequiredIDiscoverEventData||(hasRequiredIDiscoverEventData=1,Object.defineProperty(IDiscoverEventData,"__esModule",{value:!0})),IDiscoverEventData}var IPartialResult={},hasRequiredIPartialResult;function requireIPartialResult(){return hasRequiredIPartialResult||(hasRequiredIPartialResult=1,Object.defineProperty(IPartialResult,"__esModule",{value:!0})),IPartialResult}var ILink={},hasRequiredILink;function requireILink(){return hasRequiredILink||(hasRequiredILink=1,Object.defineProperty(ILink,"__esModule",{value:!0})),ILink}var Logger={},hasRequiredLogger;function requireLogger(){if(hasRequiredLogger)return Logger;hasRequiredLogger=1,Object.defineProperty(Logger,"__esModule",{value:!0}),Logger.Logger=void 0;let n=class Qi{static getLevelOrdinal(r){return Qi.LEVELS[r]}};return Logger.Logger=n,n.LEVELS={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},Logger}var ExpressionEvaluator$1={},hasRequiredExpressionEvaluator$1;function requireExpressionEvaluator$1(){if(hasRequiredExpressionEvaluator$1)return ExpressionEvaluator$1;hasRequiredExpressionEvaluator$1=1,Object.defineProperty(ExpressionEvaluator$1,"__esModule",{value:!0}),ExpressionEvaluator$1.ExpressionType=void 0;var n;return function(t){t.Aggregate="aggregate",t.Existence="existence",t.Operator="operator",t.Term="term",t.Variable="variable"}(n||(ExpressionEvaluator$1.ExpressionType=n={})),ExpressionEvaluator$1}var hasRequiredLib$4p;function requireLib$4p(){return hasRequiredLib$4p||(hasRequiredLib$4p=1,function(n){var t=lib$4o&&lib$4o.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4o&&lib$4o.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireBindings$1(),n),r(requireComunicaDataFactory(),n),r(requireIActionContext(),n),r(requireIAggregatedStore(),n),r(requireICliArgsHandler(),n),r(requireIDataDestination(),n),r(requireIJoinEntry(),n),r(requireIMetadata(),n),r(requireIPhysicalQueryPlanLogger(),n),r(requireIProxyHandler(),n),r(requireIQueryContext(),n),r(requireIQueryEngine(),n),r(requireIQueryOperationResult(),n),r(requireIQuerySource(),n),r(requireIStatisticBase(),n),r(requireIDiscoverEventData(),n),r(requireIPartialResult(),n),r(requireILink(),n),r(requireLogger(),n),r(requireExpressionEvaluator$1(),n)}(lib$4o)),lib$4o}var hasRequiredLoggerVoid;function requireLoggerVoid(){if(hasRequiredLoggerVoid)return LoggerVoid;hasRequiredLoggerVoid=1,Object.defineProperty(LoggerVoid,"__esModule",{value:!0}),LoggerVoid.LoggerVoid=void 0;const n=requireLib$4p();let t=class extends n.Logger{debug(){}error(){}fatal(){}info(){}trace(){}warn(){}};return LoggerVoid.LoggerVoid=t,LoggerVoid}var hasRequiredLib$4o;function requireLib$4o(){return hasRequiredLib$4o||(hasRequiredLib$4o=1,function(n){var t=lib$4p&&lib$4p.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4p&&lib$4p.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireLoggerVoid(),n)}(lib$4p)),lib$4p}var lib$4n={},ActorFunctionFactory={},hasRequiredActorFunctionFactory;function requireActorFunctionFactory(){if(hasRequiredActorFunctionFactory)return ActorFunctionFactory;hasRequiredActorFunctionFactory=1,Object.defineProperty(ActorFunctionFactory,"__esModule",{value:!0}),ActorFunctionFactory.MediatorFunctionFactory=ActorFunctionFactory.ActorFunctionFactory=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(o){super(o)}};ActorFunctionFactory.ActorFunctionFactory=t;class r extends n.Mediator{}return ActorFunctionFactory.MediatorFunctionFactory=r,ActorFunctionFactory}var ActorFunctionFactoryDedicated={},hasRequiredActorFunctionFactoryDedicated;function requireActorFunctionFactoryDedicated(){if(hasRequiredActorFunctionFactoryDedicated)return ActorFunctionFactoryDedicated;hasRequiredActorFunctionFactoryDedicated=1,Object.defineProperty(ActorFunctionFactoryDedicated,"__esModule",{value:!0}),ActorFunctionFactoryDedicated.ActorFunctionFactoryDedicated=void 0;const n=requireLib$4s(),t=requireActorFunctionFactory();let r=class extends t.ActorFunctionFactory{constructor(o){super(o)}async test(o){return this.functionNames.includes(o.functionName)&&(this.termFunction||!o.requireTermExpression)?(0,n.passTestVoid)():(0,n.failTest)(`Actor ${this.name} can not provide implementation for "${o.functionName}", only for ${this.termFunction?"":"non-termExpression "}${this.functionNames.join(" and ")}.`)}};return ActorFunctionFactoryDedicated.ActorFunctionFactoryDedicated=r,ActorFunctionFactoryDedicated}var BusFunctionFactory={},hasRequiredBusFunctionFactory;function requireBusFunctionFactory(){if(hasRequiredBusFunctionFactory)return BusFunctionFactory;hasRequiredBusFunctionFactory=1,Object.defineProperty(BusFunctionFactory,"__esModule",{value:!0}),BusFunctionFactory.BusFunctionFactory=void 0;const n=requireLib$4s();let t=class extends n.BusIndexed{constructor(a){super({...a,actorIdentifierFields:["functionNames"],actionIdentifierFields:["functionName"]})}};return BusFunctionFactory.BusFunctionFactory=t,BusFunctionFactory}var Core$1={},lib$4m={},TermTransformer={},rdfString={},TermUtil$2={},rdfDataFactory={},BlankNode$1={},hasRequiredBlankNode;function requireBlankNode(){if(hasRequiredBlankNode)return BlankNode$1;hasRequiredBlankNode=1,Object.defineProperty(BlankNode$1,"__esModule",{value:!0}),BlankNode$1.BlankNode=void 0;class n{constructor(r){this.termType="BlankNode",this.value=r}equals(r){return!!r&&r.termType==="BlankNode"&&r.value===this.value}}return BlankNode$1.BlankNode=n,BlankNode$1}var DataFactory$2={},DefaultGraph$1={},hasRequiredDefaultGraph;function requireDefaultGraph(){if(hasRequiredDefaultGraph)return DefaultGraph$1;hasRequiredDefaultGraph=1,Object.defineProperty(DefaultGraph$1,"__esModule",{value:!0}),DefaultGraph$1.DefaultGraph=void 0;class n{constructor(){this.termType="DefaultGraph",this.value=""}equals(r){return!!r&&r.termType==="DefaultGraph"}}return DefaultGraph$1.DefaultGraph=n,n.INSTANCE=new n,DefaultGraph$1}var Literal$1={},NamedNode$1={},hasRequiredNamedNode;function requireNamedNode(){if(hasRequiredNamedNode)return NamedNode$1;hasRequiredNamedNode=1,Object.defineProperty(NamedNode$1,"__esModule",{value:!0}),NamedNode$1.NamedNode=void 0;class n{constructor(r){this.termType="NamedNode",this.value=r}equals(r){return!!r&&r.termType==="NamedNode"&&r.value===this.value}}return NamedNode$1.NamedNode=n,NamedNode$1}var hasRequiredLiteral;function requireLiteral(){if(hasRequiredLiteral)return Literal$1;hasRequiredLiteral=1,Object.defineProperty(Literal$1,"__esModule",{value:!0}),Literal$1.Literal=void 0;const n=requireNamedNode();class t{constructor(a,o){this.termType="Literal",this.value=a,typeof o=="string"?(this.language=o,this.datatype=t.RDF_LANGUAGE_STRING):o?(this.language="",this.datatype=o):(this.language="",this.datatype=t.XSD_STRING)}equals(a){return!!a&&a.termType==="Literal"&&a.value===this.value&&a.language===this.language&&this.datatype.equals(a.datatype)}}return Literal$1.Literal=t,t.RDF_LANGUAGE_STRING=new n.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),t.XSD_STRING=new n.NamedNode("http://www.w3.org/2001/XMLSchema#string"),Literal$1}var Quad$1={},hasRequiredQuad;function requireQuad(){if(hasRequiredQuad)return Quad$1;hasRequiredQuad=1,Object.defineProperty(Quad$1,"__esModule",{value:!0}),Quad$1.Quad=void 0;class n{constructor(r,a,o,u){this.termType="Quad",this.value="",this.subject=r,this.predicate=a,this.object=o,this.graph=u}equals(r){return!!r&&(r.termType==="Quad"||!r.termType)&&this.subject.equals(r.subject)&&this.predicate.equals(r.predicate)&&this.object.equals(r.object)&&this.graph.equals(r.graph)}}return Quad$1.Quad=n,Quad$1}var Variable$2={},hasRequiredVariable$1;function requireVariable$1(){if(hasRequiredVariable$1)return Variable$2;hasRequiredVariable$1=1,Object.defineProperty(Variable$2,"__esModule",{value:!0}),Variable$2.Variable=void 0;class n{constructor(r){this.termType="Variable",this.value=r}equals(r){return!!r&&r.termType==="Variable"&&r.value===this.value}}return Variable$2.Variable=n,Variable$2}var hasRequiredDataFactory;function requireDataFactory(){if(hasRequiredDataFactory)return DataFactory$2;hasRequiredDataFactory=1,Object.defineProperty(DataFactory$2,"__esModule",{value:!0}),DataFactory$2.DataFactory=void 0;const n=requireBlankNode(),t=requireDefaultGraph(),r=requireLiteral(),a=requireNamedNode(),o=requireQuad(),u=requireVariable$1();let s=0;class c{constructor(d){this.blankNodeCounter=0,d=d||{},this.blankNodePrefix=d.blankNodePrefix||`df_${s++}_`}namedNode(d){return new a.NamedNode(d)}blankNode(d){return new n.BlankNode(d||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(d,f){return new r.Literal(d,f)}variable(d){return new u.Variable(d)}defaultGraph(){return t.DefaultGraph.INSTANCE}quad(d,f,h,v){return new o.Quad(d,f,h,v||this.defaultGraph())}fromTerm(d){switch(d.termType){case"NamedNode":return this.namedNode(d.value);case"BlankNode":return this.blankNode(d.value);case"Literal":return d.language?this.literal(d.value,d.language):d.datatype.equals(r.Literal.XSD_STRING)?this.literal(d.value):this.literal(d.value,this.fromTerm(d.datatype));case"Variable":return this.variable(d.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(d.subject),this.fromTerm(d.predicate),this.fromTerm(d.object),this.fromTerm(d.graph))}}fromQuad(d){return this.fromTerm(d)}resetBlankNodeCounter(){this.blankNodeCounter=0}}return DataFactory$2.DataFactory=c,DataFactory$2}var hasRequiredRdfDataFactory;function requireRdfDataFactory(){return hasRequiredRdfDataFactory||(hasRequiredRdfDataFactory=1,function(n){var t=rdfDataFactory&&rdfDataFactory.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfDataFactory&&rdfDataFactory.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireBlankNode(),n),r(requireDataFactory(),n),r(requireDefaultGraph(),n),r(requireLiteral(),n),r(requireNamedNode(),n),r(requireQuad(),n),r(requireVariable$1(),n)}(rdfDataFactory)),rdfDataFactory}var hasRequiredTermUtil$2;function requireTermUtil$2(){if(hasRequiredTermUtil$2)return TermUtil$2;hasRequiredTermUtil$2=1,Object.defineProperty(TermUtil$2,"__esModule",{value:!0}),TermUtil$2.stringQuadToQuad=TermUtil$2.quadToStringQuad=TermUtil$2.stringToTerm=TermUtil$2.getLiteralLanguage=TermUtil$2.getLiteralType=TermUtil$2.getLiteralValue=TermUtil$2.termToString=void 0;const n=requireRdfDataFactory(),t=new n.DataFactory;function r(d){if(d)switch(d.termType){case"NamedNode":return d.value;case"BlankNode":return"_:"+d.value;case"Literal":const f=d;return'"'+f.value+'"'+(f.datatype&&f.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"&&f.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"?"^^"+f.datatype.value:"")+(f.language?"@"+f.language:"");case"Quad":return`<<${r(d.subject)} ${r(d.predicate)} ${r(d.object)}${d.graph.termType==="DefaultGraph"?"":" "+r(d.graph)}>>`;case"Variable":return"?"+d.value;case"DefaultGraph":return d.value}}TermUtil$2.termToString=r;function a(d){const f=/^"([^]*)"/.exec(d);if(!f)throw new Error(d+" is not a literal");return f[1]}TermUtil$2.getLiteralValue=a;function o(d){const f=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(d);if(!f)throw new Error(d+" is not a literal");return f[1]||(f[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}TermUtil$2.getLiteralType=o;function u(d){const f=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(d);if(!f)throw new Error(d+" is not a literal");return f[1]?f[1].toLowerCase():""}TermUtil$2.getLiteralLanguage=u;function s(d,f){if(f=f||t,!d||!d.length)return f.defaultGraph();switch(d[0]){case"_":return f.blankNode(d.substr(2));case"?":if(!f.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return f.variable(d.substr(1));case'"':const h=u(d),v=f.namedNode(o(d));return f.literal(a(d),h||v);case"<":default:if(d[0]==="<"&&d.length>4&&d[1]==="<"&&d[d.length-1]===">"&&d[d.length-2]===">"){const g=d.slice(2,-2).trim();let b=[],_=0,S=0,T=!1;for(let w=0;w<g.length;w++){const A=g[w];if(A==="<"&&_++,A===">"){if(_===0)throw new Error("Found closing tag without opening tag in "+d);_--}if(A==='"'){let R=!1,E=w;for(;E-- >0&&g[E]==="\\";)R=!R;R||(T=!T)}if(A===" "&&!T&&_===0){for(b.push(g.slice(S,w));g[w+1]===" ";)w+=1;S=w+1}}if(_!==0)throw new Error("Found opening tag without closing tag in "+d);if(b.push(g.slice(S,g.length)),b.length!==3&&b.length!==4)throw new Error("Nested quad syntax error "+d);return b=b.map(w=>w.startsWith("<")&&!w.includes(" ")?w.slice(1,-1):w),f.quad(s(b[0]),s(b[1]),s(b[2]),b[3]?s(b[3]):void 0)}return f.namedNode(d)}}TermUtil$2.stringToTerm=s;function c(d){return{subject:r(d.subject),predicate:r(d.predicate),object:r(d.object),graph:r(d.graph)}}TermUtil$2.quadToStringQuad=c;function l(d,f){return f=f||t,f.quad(s(d.subject,f),s(d.predicate,f),s(d.object,f),s(d.graph,f))}return TermUtil$2.stringQuadToQuad=l,TermUtil$2}var hasRequiredRdfString;function requireRdfString(){return hasRequiredRdfString||(hasRequiredRdfString=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.termToString=n.stringToTerm=n.stringQuadToQuad=n.quadToStringQuad=n.getLiteralValue=n.getLiteralType=n.getLiteralLanguage=void 0;const t=requireTermUtil$2();Object.defineProperty(n,"getLiteralLanguage",{enumerable:!0,get:function(){return t.getLiteralLanguage}}),Object.defineProperty(n,"getLiteralType",{enumerable:!0,get:function(){return t.getLiteralType}}),Object.defineProperty(n,"getLiteralValue",{enumerable:!0,get:function(){return t.getLiteralValue}}),Object.defineProperty(n,"quadToStringQuad",{enumerable:!0,get:function(){return t.quadToStringQuad}}),Object.defineProperty(n,"stringQuadToQuad",{enumerable:!0,get:function(){return t.stringQuadToQuad}}),Object.defineProperty(n,"stringToTerm",{enumerable:!0,get:function(){return t.stringToTerm}}),Object.defineProperty(n,"termToString",{enumerable:!0,get:function(){return t.termToString}})}(rdfString)),rdfString}var sparqlalgebrajs={},sparqlAlgebra={},es6,hasRequiredEs6;function requireEs6(){return hasRequiredEs6||(hasRequiredEs6=1,es6=function n(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var a,o,u;if(Array.isArray(t)){if(a=t.length,a!=r.length)return!1;for(o=a;o--!==0;)if(!n(t[o],r[o]))return!1;return!0}if(t instanceof Map&&r instanceof Map){if(t.size!==r.size)return!1;for(o of t.entries())if(!r.has(o[0]))return!1;for(o of t.entries())if(!n(o[1],r.get(o[0])))return!1;return!0}if(t instanceof Set&&r instanceof Set){if(t.size!==r.size)return!1;for(o of t.entries())if(!r.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)){if(a=t.length,a!=r.length)return!1;for(o=a;o--!==0;)if(t[o]!==r[o])return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(u=Object.keys(t),a=u.length,a!==Object.keys(r).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,u[o]))return!1;for(o=a;o--!==0;){var s=u[o];if(!n(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}),es6}var algebra={},hasRequiredAlgebra;function requireAlgebra(){return hasRequiredAlgebra||(hasRequiredAlgebra=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.expressionTypes=n.types=void 0,function(t){t.ALT="alt",t.ASK="ask",t.BGP="bgp",t.CONSTRUCT="construct",t.DESCRIBE="describe",t.DISTINCT="distinct",t.EXPRESSION="expression",t.EXTEND="extend",t.FILTER="filter",t.FROM="from",t.GRAPH="graph",t.GROUP="group",t.INV="inv",t.JOIN="join",t.LEFT_JOIN="leftjoin",t.LINK="link",t.MINUS="minus",t.NOP="nop",t.NPS="nps",t.ONE_OR_MORE_PATH="OneOrMorePath",t.ORDER_BY="orderby",t.PATH="path",t.PATTERN="pattern",t.PROJECT="project",t.REDUCED="reduced",t.SEQ="seq",t.SERVICE="service",t.SLICE="slice",t.UNION="union",t.VALUES="values",t.ZERO_OR_MORE_PATH="ZeroOrMorePath",t.ZERO_OR_ONE_PATH="ZeroOrOnePath",t.COMPOSITE_UPDATE="compositeupdate",t.DELETE_INSERT="deleteinsert",t.LOAD="load",t.CLEAR="clear",t.CREATE="create",t.DROP="drop",t.ADD="add",t.MOVE="move",t.COPY="copy"}(n.types||(n.types={})),function(t){t.AGGREGATE="aggregate",t.EXISTENCE="existence",t.NAMED="named",t.OPERATOR="operator",t.TERM="term",t.WILDCARD="wildcard"}(n.expressionTypes||(n.expressionTypes={}))}(algebra)),algebra}var factory={},Wildcard={},hasRequiredWildcard;function requireWildcard(){if(hasRequiredWildcard)return Wildcard;hasRequiredWildcard=1;let n=class{constructor(){return t||this}equals(a){return a&&this.termType===a.termType}};Object.defineProperty(n.prototype,"value",{enumerable:!0,value:"*"}),Object.defineProperty(n.prototype,"termType",{enumerable:!0,value:"Wildcard"});var t=new n;return Wildcard.Wildcard=n,Wildcard}var SparqlParser_1,hasRequiredSparqlParser;function requireSparqlParser(){if(hasRequiredSparqlParser)return SparqlParser_1;hasRequiredSparqlParser=1;var n=function(){var t=function(He,ke,Qe,et){for(Qe=Qe||{},et=He.length;et--;Qe[He[et]]=ke);return Qe},r=[6,12,13,15,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],a=[2,247],o=[100,110,113,115,116,123,126,131,329,330,331,332,333],u=[2,409],s=[1,18],c=[1,27],l=[13,16,45,197,224,229,308],d=[28,29,53],f=[28,53],h=[1,42],v=[1,45],g=[1,41],b=[1,44],_=[123,126],S=[1,67],T=[39,45,87],w=[13,16,45,197,224,308],A=[1,87],R=[2,281],E=[1,86],I=[13,16,45,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],L=[6,28,29,53,63,70,73,81,83,85],F=[6,13,16,28,29,53,63,70,73,81,83,85,87,308],D=[6,13,16,28,29,45,53,63,70,73,81,82,83,85,87,89,197,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314],$=[6,13,16,28,29,31,39,45,47,48,53,63,70,73,81,82,83,85,87,89,109,112,121,123,126,128,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,337,338,340,341,342,343,344,345,346],O=[13,16,308],P=[112,132,327,334],C=[13,16,112,132,308],q=[1,111],M=[1,117],N=[112,132,327,328,334],G=[13,16,112,132,308,328],X=[28,29,45,53,87],Y=[1,138],W=[1,151],te=[1,128],ue=[1,127],fe=[1,129],re=[1,140],ye=[1,141],Te=[1,142],Re=[1,143],ve=[1,144],ce=[1,145],J=[1,147],j=[1,148],z=[2,457],B=[1,158],U=[1,159],Z=[1,160],oe=[1,152],ie=[1,153],se=[1,156],ne=[1,171],he=[1,172],xe=[1,173],me=[1,174],Ie=[1,175],Pe=[1,176],Ce=[1,167],pe=[1,168],H=[1,169],V=[1,170],Q=[1,157],ee=[1,166],ae=[1,161],be=[1,162],le=[1,163],we=[1,164],De=[1,165],Fe=[6,13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],Ne=[1,195],de=[6,31,73,81,83,85],Le=[2,285],$e=[1,199],je=[1,201],Me=[6,31,70,73,81,83,85],ze=[2,283],Je=[1,207],Ke=[1,218],ot=[1,223],_e=[1,219],Ae=[1,225],Ve=[1,226],Ue=[1,224],We=[6,63,70,73,81,83,85],pt=[1,236],Ge=[2,334],ct=[1,243],Xe=[1,241],Ye=[6,193],nt=[2,349],gt=[2,339],ut=[28,128],tt=[47,48,193,272],Ct=[47,48,193,242,272],Ze=[47,48,193,242,246,272],Ee=[47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,341,342,343,344,345,346],qe=[39,47,48,193,242,246,250,263,265,272,290,297,298,299,300,301,302,338,341,342,343,344,345,346],Be=[1,271],it=[1,270],at=[6,13,16,29,31,39,45,47,48,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],vt=[1,281],At=[1,280],St=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],Xt=[45,89],jt=[13,16,29,31,39,45,47,48,82,85,87,89,112,159,160,161,163,164,174,193,197,224,229,231,232,242,246,250,263,265,272,290,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346],xt=[13,16,31,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Rt=[31,89],Lt=[48,87],Ht=[6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338],It=[6,13,16,39,45,48,82,87,89,231,263,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337,338,340],Ft=[1,313],qt=[6,85],Fr=[6,31,81,83,85],br=[2,361],Gt=[2,353],Ut=[1,343],Xr=[31,112,335],er=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],qn=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335],yi=[6,109,193],_r=[31,112],Pt=[13,16,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],Mn=[1,390],Nn=[1,391],lr=[13,16,87,197,308,314],mi=[13,16,39,45,82,87,224,263,265,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312,346,347,348,349,350,351],dn=[1,417],hn=[1,418],bi=[13,16,48,197,229,308],dr=[6,31,85],_i=[6,13,16,31,45,73,81,83,85,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Bn=[6,13,16,29,31,45,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,231,268,269,270,271,273,274,276,277,279,280,283,285,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,346,347,348,349,350,351],Sr=[29,31,85,112,159,160,161,163,164],pn=[1,443],vn=[1,444],Si=[1,449],Tr=[31,112,193,232,318,335],gn=[13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Ti=[13,16,31,45,48,82,87,89,112,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],jn=[13,16,29,31,45,48,82,85,87,89,112,159,160,161,163,164,193,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Kr=[13,16,31,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],Wr=[31,45],Ai=[1,507],xi=[1,508],wi=[6,13,16,29,31,39,45,47,48,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,336,338,341,342,343,344,345,346,347,348,349,350,351],yn=[29,31,85,112,159,160,161,163,164,335],Ar=[6,13,16,31,45,70,73,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Ri=[13,16,31,45,48,82,87,89,112,193,197,231,232,272,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,317,318,335],Ei=[2,352],kn=[13,16,197,308,314],Ii=[1,565],Cr=[6,13,16,31,45,76,78,81,83,85,87,268,269,270,271,273,274,276,277,279,280,283,285,308,346,347,348,349,350,351],Oi=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],tr=[13,16,29,31,45,82,85,87,89,112,159,160,161,163,164,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335],Li=[13,16,87,308],rr=[2,364],qr=[29,31,85,112,159,160,161,163,164,193,232,318,335],mn=[31,112,193,232,272,318,335],nr=[2,359],$i=[13,16,48,82,174,294,295,296,297,298,299,300,301,302,303,304,305,306,308,312],bn=[29,31,85,112,159,160,161,163,164,193,232,272,318,335],Di=[13,16,31,45,82,87,89,112,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],Pi=[2,347],Vn={trace:function(){},yy:{},symbols_:{error:2,QueryOrUpdate:3,Prologue:4,QueryOrUpdate_group0:5,EOF:6,Query:7,Qry:8,Query_option0:9,Prologue_repetition0:10,BaseDecl:11,BASE:12,IRIREF:13,PrefixDecl:14,PREFIX:15,PNAME_NS:16,SelectClauseWildcard:17,Qry_repetition0:18,WhereClause:19,SolutionModifierNoGroup:20,SelectClauseVars:21,Qry_repetition1:22,SolutionModifier:23,CONSTRUCT:24,ConstructTemplate:25,Qry_repetition2:26,Qry_repetition3:27,WHERE:28,"{":29,Qry_option0:30,"}":31,DESCRIBE:32,Qry_group0:33,Qry_repetition4:34,Qry_option1:35,ASK:36,Qry_repetition5:37,SelectClauseBase:38,"*":39,SelectClauseVars_repetition_plus0:40,SELECT:41,SelectClauseBase_option0:42,SelectClauseItem:43,Var:44,"(":45,Expression:46,AS:47,")":48,SubSelect:49,SubSelect_option0:50,SubSelect_option1:51,DatasetClause:52,FROM:53,DatasetClause_option0:54,iri:55,WhereClause_option0:56,GroupGraphPattern:57,SolutionModifier_option0:58,SolutionModifierNoGroup_option0:59,SolutionModifierNoGroup_option1:60,SolutionModifierNoGroup_option2:61,GroupClause:62,GROUP:63,BY:64,GroupClause_repetition_plus0:65,GroupCondition:66,BuiltInCall:67,FunctionCall:68,HavingClause:69,HAVING:70,HavingClause_repetition_plus0:71,OrderClause:72,ORDER:73,OrderClause_repetition_plus0:74,OrderCondition:75,ASC:76,BrackettedExpression:77,DESC:78,Constraint:79,LimitOffsetClauses:80,LIMIT:81,INTEGER:82,OFFSET:83,ValuesClause:84,VALUES:85,InlineData:86,VAR:87,InlineData_repetition0:88,NIL:89,InlineData_repetition1:90,InlineData_repetition_plus2:91,InlineData_repetition3:92,DataBlock:93,DataBlockValueList:94,DataBlockValueList_repetition_plus0:95,Update:96,Update_repetition0:97,Update1:98,Update_option0:99,LOAD:100,Update1_option0:101,Update1_option1:102,Update1_group0:103,Update1_option2:104,GraphRefAll:105,Update1_group1:106,Update1_option3:107,GraphOrDefault:108,TO:109,CREATE:110,Update1_option4:111,GRAPH:112,INSERTDATA:113,QuadPattern:114,DELETEDATA:115,DELETEWHERE:116,Update1_option5:117,InsertDeleteClause:118,Update1_repetition0:119,IntoGraphClause:120,INTO:121,GraphRef:122,DELETE:123,InsertDeleteClause_option0:124,InsertClause:125,INSERT:126,UsingClause:127,USING:128,UsingClause_option0:129,WithClause:130,WITH:131,DEFAULT:132,GraphOrDefault_option0:133,GraphRefAll_group0:134,Quads:135,Quads_option0:136,Quads_repetition0:137,QuadsNotTriples:138,VarOrIri:139,QuadsNotTriples_option0:140,QuadsNotTriples_option1:141,QuadsNotTriples_option2:142,TriplesTemplate:143,TriplesTemplate_repetition0:144,TriplesSameSubject:145,TriplesTemplate_option0:146,GroupGraphPatternSub:147,GroupGraphPatternSub_option0:148,GroupGraphPatternSub_repetition0:149,GroupGraphPatternSubTail:150,GraphPatternNotTriples:151,GroupGraphPatternSubTail_option0:152,GroupGraphPatternSubTail_option1:153,TriplesBlock:154,TriplesBlock_repetition0:155,TriplesSameSubjectPath:156,TriplesBlock_option0:157,GroupOrUnionGraphPattern:158,OPTIONAL:159,MINUS:160,SERVICE:161,GraphPatternNotTriples_option0:162,FILTER:163,BIND:164,InlineDataOneVar:165,InlineDataFull:166,InlineDataOneVar_repetition0:167,InlineDataFull_repetition0:168,InlineDataFull_repetition_plus1:169,InlineDataFull_repetition2:170,DataBlockValue:171,Literal:172,QuotedTriple:173,UNDEF:174,GroupOrUnionGraphPattern_repetition0:175,ArgList:176,ArgList_option0:177,ArgList_repetition0:178,ExpressionList:179,ExpressionList_repetition0:180,ConstructTemplate_option0:181,ConstructTriples:182,ConstructTriples_repetition0:183,ConstructTriples_option0:184,VarOrTermOrQuotedTP:185,PropertyListNotEmpty:186,TriplesNode:187,PropertyList:188,PropertyList_option0:189,VerbObjectList:190,PropertyListNotEmpty_repetition0:191,SemiOptionalVerbObjectList:192,";":193,SemiOptionalVerbObjectList_option0:194,Verb:195,ObjectList:196,a:197,ObjectList_repetition0:198,Object:199,GraphNode:200,Object_option0:201,PropertyListPathNotEmpty:202,TriplesNodePath:203,TriplesSameSubjectPath_option0:204,O:205,PropertyListPathNotEmpty_repetition0:206,PropertyListPathNotEmptyTail:207,O_group0:208,ObjectListPath:209,ObjectListPath_repetition0:210,ObjectPath:211,GraphNodePath:212,ObjectPath_option0:213,Path:214,Path_repetition0:215,PathSequence:216,PathSequence_repetition0:217,PathEltOrInverse:218,PathElt:219,PathPrimary:220,PathElt_option0:221,PathEltOrInverse_option0:222,IriOrA:223,"!":224,PathNegatedPropertySet:225,PathOneInPropertySet:226,PathNegatedPropertySet_repetition0:227,PathNegatedPropertySet_option0:228,"^":229,TriplesNode_repetition_plus0:230,"[":231,"]":232,TriplesNodePath_repetition_plus0:233,VarOrTermOrQuotedTPExpr:234,VarOrTerm:235,GraphTerm:236,BlankNode:237,ConditionalOrExpression:238,ConditionalAndExpression:239,ConditionalOrExpression_repetition0:240,ConditionalOrExpressionTail:241,"||":242,RelationalExpression:243,ConditionalAndExpression_repetition0:244,ConditionalAndExpressionTail:245,"&&":246,NumericExpression:247,RelationalExpression_group0:248,RelationalExpression_option0:249,IN:250,MultiplicativeExpression:251,NumericExpression_repetition0:252,AdditiveExpressionTail:253,AdditiveExpressionTail_group0:254,NumericLiteralPositive:255,AdditiveExpressionTail_repetition0:256,NumericLiteralNegative:257,AdditiveExpressionTail_repetition1:258,UnaryExpression:259,MultiplicativeExpression_repetition0:260,MultiplicativeExpressionTail:261,MultiplicativeExpressionTail_group0:262,"+":263,PrimaryExpression:264,"-":265,ExprQuotedTP:266,Aggregate:267,FUNC_ARITY0:268,FUNC_ARITY1:269,FUNC_ARITY1_SPARQL_STAR:270,FUNC_ARITY2:271,",":272,FUNC_ARITY3:273,FUNC_ARITY3_SPARQL_STAR:274,BuiltInCall_group0:275,BOUND:276,BNODE:277,BuiltInCall_option0:278,EXISTS:279,COUNT:280,Aggregate_option0:281,Aggregate_group0:282,FUNC_AGGREGATE:283,Aggregate_option1:284,GROUP_CONCAT:285,Aggregate_option2:286,Aggregate_option3:287,GroupConcatSeparator:288,SEPARATOR:289,"=":290,String:291,LANGTAG:292,"^^":293,DECIMAL:294,DOUBLE:295,BOOLEAN:296,INTEGER_POSITIVE:297,DECIMAL_POSITIVE:298,DOUBLE_POSITIVE:299,INTEGER_NEGATIVE:300,DECIMAL_NEGATIVE:301,DOUBLE_NEGATIVE:302,STRING_LITERAL1:303,STRING_LITERAL2:304,STRING_LITERAL_LONG1:305,STRING_LITERAL_LONG2:306,PrefixedName:307,PNAME_LN:308,BLANK_NODE_LABEL:309,ANON:310,QuotedTP:311,"<<":312,qtSubjectOrObject:313,">>":314,DataValueTerm:315,AnnotationPattern:316,"{|":317,"|}":318,AnnotationPatternPath:319,ExprVarOrTerm:320,QueryOrUpdate_group0_option0:321,Prologue_repetition0_group0:322,Qry_group0_repetition_plus0:323,SelectClauseBase_option0_group0:324,DISTINCT:325,REDUCED:326,NAMED:327,SILENT:328,CLEAR:329,DROP:330,ADD:331,MOVE:332,COPY:333,ALL:334,".":335,UNION:336,"|":337,"/":338,PathElt_option0_group0:339,"?":340,"!=":341,"<":342,">":343,"<=":344,">=":345,NOT:346,CONCAT:347,COALESCE:348,SUBSTR:349,REGEX:350,REPLACE:351,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",12:"BASE",13:"IRIREF",15:"PREFIX",16:"PNAME_NS",24:"CONSTRUCT",28:"WHERE",29:"{",31:"}",32:"DESCRIBE",36:"ASK",39:"*",41:"SELECT",45:"(",47:"AS",48:")",53:"FROM",63:"GROUP",64:"BY",70:"HAVING",73:"ORDER",76:"ASC",78:"DESC",81:"LIMIT",82:"INTEGER",83:"OFFSET",85:"VALUES",87:"VAR",89:"NIL",100:"LOAD",109:"TO",110:"CREATE",112:"GRAPH",113:"INSERTDATA",115:"DELETEDATA",116:"DELETEWHERE",121:"INTO",123:"DELETE",126:"INSERT",128:"USING",131:"WITH",132:"DEFAULT",159:"OPTIONAL",160:"MINUS",161:"SERVICE",163:"FILTER",164:"BIND",174:"UNDEF",193:";",197:"a",224:"!",229:"^",231:"[",232:"]",242:"||",246:"&&",250:"IN",263:"+",265:"-",268:"FUNC_ARITY0",269:"FUNC_ARITY1",270:"FUNC_ARITY1_SPARQL_STAR",271:"FUNC_ARITY2",272:",",273:"FUNC_ARITY3",274:"FUNC_ARITY3_SPARQL_STAR",276:"BOUND",277:"BNODE",279:"EXISTS",280:"COUNT",283:"FUNC_AGGREGATE",285:"GROUP_CONCAT",289:"SEPARATOR",290:"=",292:"LANGTAG",293:"^^",294:"DECIMAL",295:"DOUBLE",296:"BOOLEAN",297:"INTEGER_POSITIVE",298:"DECIMAL_POSITIVE",299:"DOUBLE_POSITIVE",300:"INTEGER_NEGATIVE",301:"DECIMAL_NEGATIVE",302:"DOUBLE_NEGATIVE",303:"STRING_LITERAL1",304:"STRING_LITERAL2",305:"STRING_LITERAL_LONG1",306:"STRING_LITERAL_LONG2",308:"PNAME_LN",309:"BLANK_NODE_LABEL",310:"ANON",312:"<<",314:">>",317:"{|",318:"|}",325:"DISTINCT",326:"REDUCED",327:"NAMED",328:"SILENT",329:"CLEAR",330:"DROP",331:"ADD",332:"MOVE",333:"COPY",334:"ALL",335:".",336:"UNION",337:"|",338:"/",340:"?",341:"!=",342:"<",343:">",344:"<=",345:">=",346:"NOT",347:"CONCAT",348:"COALESCE",349:"SUBSTR",350:"REGEX",351:"REPLACE"},productions_:[0,[3,3],[7,2],[4,1],[11,2],[14,3],[8,4],[8,4],[8,5],[8,7],[8,5],[8,4],[17,2],[21,2],[38,2],[43,1],[43,5],[49,4],[49,4],[52,3],[19,2],[23,2],[20,3],[62,3],[66,1],[66,1],[66,3],[66,5],[66,1],[69,2],[72,3],[75,2],[75,2],[75,1],[75,1],[80,2],[80,2],[80,4],[80,4],[84,2],[86,4],[86,4],[86,6],[86,2],[94,3],[96,3],[98,4],[98,3],[98,5],[98,4],[98,2],[98,2],[98,2],[98,5],[120,2],[118,3],[118,1],[125,2],[127,3],[130,2],[108,1],[108,2],[122,2],[105,1],[105,1],[114,3],[135,2],[138,7],[143,3],[57,3],[57,3],[147,2],[150,3],[154,3],[151,1],[151,2],[151,2],[151,3],[151,4],[151,2],[151,6],[151,1],[93,1],[93,1],[165,4],[166,4],[166,6],[171,1],[171,1],[171,1],[171,1],[158,2],[79,1],[79,1],[79,1],[68,2],[176,1],[176,5],[179,1],[179,4],[25,3],[182,3],[145,2],[145,2],[188,1],[186,2],[192,2],[190,2],[195,1],[195,1],[196,2],[199,2],[156,2],[156,2],[202,2],[207,1],[207,2],[205,2],[209,2],[211,2],[214,2],[216,2],[219,2],[218,2],[220,1],[220,2],[220,3],[225,1],[225,1],[225,4],[226,1],[226,2],[187,3],[187,3],[203,3],[203,3],[200,1],[200,1],[212,1],[212,1],[234,1],[235,1],[235,1],[139,1],[139,1],[44,1],[236,1],[236,1],[236,1],[236,1],[46,1],[238,2],[241,2],[239,2],[245,2],[243,1],[243,3],[243,4],[247,2],[253,2],[253,2],[253,2],[251,2],[261,2],[259,2],[259,2],[259,2],[259,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[264,1],[77,3],[67,1],[67,2],[67,4],[67,4],[67,6],[67,8],[67,8],[67,2],[67,4],[67,2],[67,4],[67,3],[267,5],[267,5],[267,6],[288,4],[172,1],[172,2],[172,3],[172,1],[172,1],[172,1],[172,1],[172,1],[172,1],[255,1],[255,1],[255,1],[257,1],[257,1],[257,1],[291,1],[291,1],[291,1],[291,1],[55,1],[55,1],[307,1],[307,1],[237,1],[237,1],[311,5],[173,5],[313,1],[313,1],[313,1],[313,1],[313,1],[315,1],[315,1],[315,1],[185,1],[185,1],[185,1],[316,3],[319,3],[266,5],[320,1],[320,1],[320,1],[223,1],[223,1],[321,0],[321,1],[5,1],[5,1],[5,1],[9,0],[9,1],[322,1],[322,1],[10,0],[10,2],[18,0],[18,2],[22,0],[22,2],[26,0],[26,2],[27,0],[27,2],[30,0],[30,1],[323,1],[323,2],[33,1],[33,1],[34,0],[34,2],[35,0],[35,1],[37,0],[37,2],[40,1],[40,2],[324,1],[324,1],[42,0],[42,1],[50,0],[50,1],[51,0],[51,1],[54,0],[54,1],[56,0],[56,1],[58,0],[58,1],[59,0],[59,1],[60,0],[60,1],[61,0],[61,1],[65,1],[65,2],[71,1],[71,2],[74,1],[74,2],[88,0],[88,2],[90,0],[90,2],[91,1],[91,2],[92,0],[92,2],[95,1],[95,2],[97,0],[97,4],[99,0],[99,2],[101,0],[101,1],[102,0],[102,1],[103,1],[103,1],[104,0],[104,1],[106,1],[106,1],[106,1],[107,0],[107,1],[111,0],[111,1],[117,0],[117,1],[119,0],[119,2],[124,0],[124,1],[129,0],[129,1],[133,0],[133,1],[134,1],[134,1],[134,1],[136,0],[136,1],[137,0],[137,2],[140,0],[140,1],[141,0],[141,1],[142,0],[142,1],[144,0],[144,3],[146,0],[146,1],[148,0],[148,1],[149,0],[149,2],[152,0],[152,1],[153,0],[153,1],[155,0],[155,3],[157,0],[157,1],[162,0],[162,1],[167,0],[167,2],[168,0],[168,2],[169,1],[169,2],[170,0],[170,2],[175,0],[175,3],[177,0],[177,1],[178,0],[178,3],[180,0],[180,3],[181,0],[181,1],[183,0],[183,3],[184,0],[184,1],[189,0],[189,1],[191,0],[191,2],[194,0],[194,1],[198,0],[198,3],[201,0],[201,1],[204,0],[204,1],[206,0],[206,2],[208,1],[208,1],[210,0],[210,3],[213,0],[213,1],[215,0],[215,3],[217,0],[217,3],[339,1],[339,1],[339,1],[221,0],[221,1],[222,0],[222,1],[227,0],[227,3],[228,0],[228,1],[230,1],[230,2],[233,1],[233,2],[240,0],[240,2],[244,0],[244,2],[248,1],[248,1],[248,1],[248,1],[248,1],[248,1],[249,0],[249,1],[252,0],[252,2],[254,1],[254,1],[256,0],[256,2],[258,0],[258,2],[260,0],[260,2],[262,1],[262,1],[275,1],[275,1],[275,1],[275,1],[275,1],[278,0],[278,1],[281,0],[281,1],[282,1],[282,1],[284,0],[284,1],[286,0],[286,1],[287,0],[287,1]],performAction:function(ke,Qe,et,dt,ft,ge,Qt){var Se=ge.length-1;switch(ft){case 1:if(ge[Se-1]=ge[Se-1]||{},bt.base&&(ge[Se-1].base=bt.base),bt.base="",ge[Se-1].prefixes=bt.prefixes,bt.prefixes=null,bt.pathOnly){if(ge[Se-1].type==="path"||"termType"in ge[Se-1])return ge[Se-1];throw new Error("Received full SPARQL query in path only mode")}else if(ge[Se-1].type==="path"||"termType"in ge[Se-1])throw new Error("Received only path in full SPARQL mode");if(ge[Se-1].type==="update"){const mt={};for(const Tt of ge[Se-1].updates)if(Tt.updateType==="insert"){const yt={};for(const Nt of Tt.insert)if(Nt.type==="bgp"||Nt.type==="graph")for(const Bt of Nt.triples)Bt.subject.termType==="BlankNode"&&(yt[Bt.subject.value]=!0),Bt.predicate.termType==="BlankNode"&&(yt[Bt.predicate.value]=!0),Bt.object.termType==="BlankNode"&&(yt[Bt.object.value]=!0);for(const Nt of Object.keys(yt)){if(mt[Nt])throw new Error("Detected reuse blank node across different INSERT DATA clauses");mt[Nt]=!0}}}return ge[Se-1];case 2:this.$={...ge[Se-1],...ge[Se],type:"query"};break;case 4:bt.base=Yr(ge[Se]);break;case 5:bt.prefixes||(bt.prefixes={}),ge[Se-1]=ge[Se-1].substr(0,ge[Se-1].length-1),ge[Se]=Yr(ge[Se]),bt.prefixes[ge[Se-1]]=ge[Se];break;case 6:this.$={...ge[Se-3],...Rr(ge[Se-2]),...ge[Se-1],...ge[Se]};break;case 7:if(!bt.skipValidation&&(Wn(ge[Se-3].variables.map(Tt=>Kn(Tt.expression))).some(Tt=>Tt.aggregation==="count"&&!(Tt.expression instanceof _n))||ge[Se].group)){for(const Tt of ge[Se-3].variables)if(Tt.termType==="Variable"){if(!ge[Se].group||!ge[Se].group.map(yt=>kr(yt)).includes(kr(Tt)))throw Error("Projection of ungrouped variable (?"+kr(Tt)+")")}else if(Kn(Tt.expression).length===0){const yt=Ea(Tt.expression);for(const Nt of yt)if(!ge[Se].group||!ge[Se].group.map||!ge[Se].group.map(Bt=>kr(Bt)).includes(kr(Nt)))throw Error("Use of ungrouped variable in projection of operation (?"+kr(Nt)+")")}}const Vr=ge[Se-1].where.filter(mt=>mt.type==="query");if(Vr.length>0){const mt=ge[Se-3].variables.filter(yt=>yt.variable&&yt.variable.value).map(yt=>yt.variable.value),Tt=Wn(Vr.map(yt=>yt.variables)).map(yt=>yt.value||yt.variable.value);for(const yt of mt)if(Tt.indexOf(yt)>=0)throw Error("Target id of 'AS' (?"+yt+") already used in subquery")}this.$=$t(ge[Se-3],Rr(ge[Se-2]),ge[Se-1],ge[Se]);break;case 8:this.$=$t({queryType:"CONSTRUCT",template:ge[Se-3]},Rr(ge[Se-2]),ge[Se-1],ge[Se]);break;case 9:this.$=$t({queryType:"CONSTRUCT",template:ge[Se-2]=ge[Se-2]?ge[Se-2].triples:[]},Rr(ge[Se-5]),{where:[{type:"bgp",triples:Mr([],ge[Se-2])}]},ge[Se]);break;case 10:this.$=$t({queryType:"DESCRIBE",variables:ge[Se-3]==="*"?[new _n]:ge[Se-3]},Rr(ge[Se-2]),ge[Se-1],ge[Se]);break;case 11:this.$=$t({queryType:"ASK"},Rr(ge[Se-2]),ge[Se-1],ge[Se]);break;case 12:this.$=$t(ge[Se-1],{variables:[new _n]});break;case 13:const ei=ge[Se].map(mt=>mt.value||mt.variable.value),Rn=Ia(ei);if(Rn.length>0)throw Error("Two or more of the resulting columns have the same name (?"+Rn[0]+")");this.$=$t(ge[Se-1],{variables:ge[Se]});break;case 14:this.$=$t({queryType:"SELECT"},ge[Se]&&(ge[Se-1]=Vt(ge[Se]),ge[Se]={},ge[Se][ge[Se-1]]=!0,ge[Se]));break;case 16:case 27:this.$=Nr(ge[Se-3],{variable:ge[Se-1]});break;case 17:case 18:this.$=$t(ge[Se-3],ge[Se-2],ge[Se-1],ge[Se],{type:"query"});break;case 19:case 58:this.$={iri:ge[Se],named:!!ge[Se-1]};break;case 20:this.$={where:ge[Se].patterns};break;case 21:this.$=$t(ge[Se-1],ge[Se]);break;case 22:this.$=$t(ge[Se-2],ge[Se-1],ge[Se]);break;case 23:this.$={group:ge[Se]};break;case 24:case 25:case 28:case 31:case 33:case 34:this.$=Nr(ge[Se]);break;case 26:this.$=Nr(ge[Se-1]);break;case 29:this.$={having:ge[Se]};break;case 30:this.$={order:ge[Se]};break;case 32:this.$=Nr(ge[Se],{descending:!0});break;case 35:this.$={limit:jr(ge[Se])};break;case 36:this.$={offset:jr(ge[Se])};break;case 37:this.$={limit:jr(ge[Se-2]),offset:jr(ge[Se])};break;case 38:this.$={limit:jr(ge[Se]),offset:jr(ge[Se-2])};break;case 39:case 43:this.$={type:"values",values:ge[Se]};break;case 40:case 84:this.$=ge[Se-1].map(mt=>({[ge[Se-3]]:mt}));break;case 41:case 85:this.$=ge[Se-1].map(()=>({}));break;case 42:case 86:var fr=ge[Se-4].length;ge[Se-4]=ge[Se-4].map(Hn),this.$=ge[Se-1].map(function(mt){if(mt.length!==fr)throw Error("Inconsistent VALUES length");for(var Tt={},yt=0;yt<fr;yt++)Tt["?"+ge[Se-4][yt].value]=mt[yt];return Tt});break;case 44:case 65:case 100:case 126:case 175:this.$=ge[Se-1];break;case 45:this.$={type:"update",updates:wr(ge[Se-2],ge[Se-1])};break;case 46:this.$=$t({type:"load",silent:!!ge[Se-2],source:ge[Se-1]},ge[Se]&&{destination:ge[Se]});break;case 47:this.$={type:Vt(ge[Se-2]),silent:!!ge[Se-1],graph:ge[Se]};break;case 48:this.$={type:Vt(ge[Se-4]),silent:!!ge[Se-3],source:ge[Se-2],destination:ge[Se]};break;case 49:this.$={type:"create",silent:!!ge[Se-2],graph:{type:"graph",name:ge[Se]}};break;case 50:this.$={updateType:"insert",insert:Ui(ge[Se])};break;case 51:this.$={updateType:"delete",delete:Zn(Ui(ge[Se]))};break;case 52:this.$={updateType:"deletewhere",delete:Zn(ge[Se])};break;case 53:this.$={updateType:"insertdelete",...ge[Se-4],...ge[Se-3],...Rr(ge[Se-2],"using"),where:ge[Se].patterns};break;case 54:case 57:case 62:case 167:case 191:case 236:this.$=ge[Se];break;case 55:this.$={delete:Zn(ge[Se-1]),insert:ge[Se]||[]};break;case 56:this.$={delete:[],insert:ge[Se]};break;case 59:this.$={graph:ge[Se]};break;case 60:this.$={type:"graph",default:!0};break;case 61:case 63:this.$={type:"graph",name:ge[Se]};break;case 64:this.$={[Vt(ge[Se])]:!0};break;case 66:this.$=ge[Se-1]?Yt(ge[Se],[ge[Se-1]]):Yt(ge[Se]);break;case 67:var An=$t(ge[Se-3]||{triples:[]},{type:"graph",name:ge[Se-5]});this.$=ge[Se]?[An,ge[Se]]:[An];break;case 68:case 73:this.$={type:"bgp",triples:Yt(ge[Se-2],[ge[Se-1]])};break;case 69:this.$={type:"group",patterns:[ge[Se-1]]};break;case 70:for(const mt of ge[Se-1].filter(Tt=>Tt.type==="bind")){const Tt=ge[Se-1].indexOf(mt),yt=new Set;for(const Nt of ge[Se-1].slice(0,Tt))(Nt.type==="group"||Nt.type==="bgp")&&Vi(Nt).forEach(Bt=>yt.add(Bt));if(yt.has(mt.variable.value))throw Error("Variable used to bind is already bound (?"+mt.variable.value+")")}this.$={type:"group",patterns:ge[Se-1]};break;case 71:this.$=ge[Se-1]?Yt([ge[Se-1]],ge[Se]):Yt(ge[Se]);break;case 72:this.$=ge[Se]?[ge[Se-2],ge[Se]]:ge[Se-2];break;case 75:this.$=$t(ge[Se],{type:"optional"});break;case 76:this.$=$t(ge[Se],{type:"minus"});break;case 77:this.$=$t(ge[Se],{type:"graph",name:ge[Se-1]});break;case 78:this.$=$t(ge[Se],{type:"service",name:ge[Se-1],silent:!!ge[Se-2]});break;case 79:this.$={type:"filter",expression:ge[Se]};break;case 80:this.$={type:"bind",variable:ge[Se-1],expression:ge[Se-3]};break;case 89:this.$=Zr(ge[Se]);break;case 90:this.$=void 0;break;case 91:this.$=ge[Se-1].length?{type:"union",patterns:Yt(ge[Se-1].map(zn),[zn(ge[Se])])}:ge[Se];break;case 95:this.$={...ge[Se],function:ge[Se-1]};break;case 96:this.$={type:"functionCall",args:[]};break;case 97:this.$={type:"functionCall",args:wr(ge[Se-2],ge[Se-1]),distinct:!!ge[Se-3]};break;case 98:case 115:case 128:case 247:case 249:case 251:case 253:case 255:case 263:case 267:case 297:case 299:case 303:case 307:case 328:case 341:case 349:case 355:case 361:case 367:case 369:case 373:case 375:case 379:case 381:case 385:case 391:case 395:case 401:case 405:case 409:case 411:case 420:case 428:case 430:case 440:case 444:case 446:case 448:this.$=[];break;case 99:this.$=wr(ge[Se-2],ge[Se-1]);break;case 101:this.$=Yt(ge[Se-2],[ge[Se-1]]);break;case 102:case 112:this.$=Jn(ge[Se].map(mt=>$t(ir(ge[Se-1]),mt)));break;case 103:this.$=Jn(Mr(ge[Se].map(mt=>$t(ir(ge[Se-1].entity),mt)),ge[Se-1].triples));break;case 105:this.$=Yt([ge[Se-1]],ge[Se]);break;case 106:this.$=Yt(ge[Se]);break;case 107:this.$=Xn(ge[Se-1],ge[Se]);break;case 109:case 237:this.$=bt.factory.namedNode(ga);break;case 110:case 118:this.$=wr(ge[Se-1],ge[Se]);break;case 111:this.$=ge[Se]?{annotation:ge[Se],object:ge[Se-1]}:ge[Se-1];break;case 113:this.$=ge[Se]?Jn(Mr(ge[Se].map(mt=>$t(ir(ge[Se-1].entity),mt)),ge[Se-1].triples)):ge[Se-1].triples;break;case 114:this.$=Xn(...ge[Se-1],ge[Se]);break;case 116:this.$=Xn(...ge[Se]);break;case 117:case 159:case 163:this.$=[ge[Se-1],ge[Se]];break;case 119:this.$=ge[Se]?{object:ge[Se-1],annotation:ge[Se]}:ge[Se-1];break;case 120:this.$=ge[Se-1].length?Br("|",wr(ge[Se-1],ge[Se])):ge[Se];break;case 121:this.$=ge[Se-1].length?Br("/",wr(ge[Se-1],ge[Se])):ge[Se];break;case 122:this.$=ge[Se]?Br(ge[Se],[ge[Se-1]]):ge[Se-1];break;case 123:this.$=ge[Se-1]?Br(ge[Se-1],[ge[Se]]):ge[Se];break;case 125:case 131:this.$=Br(ge[Se-1],[ge[Se]]);break;case 129:this.$=Br("|",wr(ge[Se-2],ge[Se-1]));break;case 132:case 134:this.$=wa(ge[Se-1]);break;case 133:case 135:this.$=Ra(ge[Se-1]);break;case 140:this.$={entity:ge[Se],triples:[]};break;case 145:this.$=Hn(ge[Se]);break;case 149:this.$=bt.factory.namedNode(Fi);break;case 151:case 153:case 158:case 162:this.$=Un(ge[Se-1],ge[Se]);break;case 152:this.$=["||",ge[Se]];break;case 154:this.$=["&&",ge[Se]];break;case 156:this.$=Mt(ge[Se-1],[ge[Se-2],ge[Se]]);break;case 157:this.$=Mt(ge[Se-2]?"notin":"in",[ge[Se-3],ge[Se]]);break;case 160:this.$=["+",Un(ge[Se-1],ge[Se])];break;case 161:var xn=Jt(ge[Se-1].value.replace("-",""),ge[Se-1].datatype);this.$=["-",Un(xn,ge[Se])];break;case 164:this.$=Mt("UPLUS",[ge[Se]]);break;case 165:this.$=Mt(ge[Se-1],[ge[Se]]);break;case 166:this.$=Mt("UMINUS",[ge[Se]]);break;case 177:this.$=Mt(Vt(ge[Se-1]));break;case 178:this.$=Mt(Vt(ge[Se-3]),[ge[Se-1]]);break;case 179:this.$=Zr(Mt(Vt(ge[Se-3]),[ge[Se-1]]));break;case 180:this.$=Mt(Vt(ge[Se-5]),[ge[Se-3],ge[Se-1]]);break;case 181:this.$=Mt(Vt(ge[Se-7]),[ge[Se-5],ge[Se-3],ge[Se-1]]);break;case 182:this.$=Zr(Mt(Vt(ge[Se-7]),[ge[Se-5],ge[Se-3],ge[Se-1]]));break;case 183:this.$=Mt(Vt(ge[Se-1]),ge[Se]);break;case 184:this.$=Mt("bound",[Hn(ge[Se-1])]);break;case 185:this.$=Mt(ge[Se-1],[]);break;case 186:this.$=Mt(ge[Se-3],[ge[Se-1]]);break;case 187:this.$=Mt(ge[Se-2]?"notexists":"exists",[zn(ge[Se])]);break;case 188:case 189:this.$=Nr(ge[Se-1],{type:"aggregate",aggregation:Vt(ge[Se-4]),distinct:!!ge[Se-2]});break;case 190:this.$=Nr(ge[Se-2],{type:"aggregate",aggregation:Vt(ge[Se-5]),distinct:!!ge[Se-3],separator:typeof ge[Se-1]=="string"?ge[Se-1]:" "});break;case 192:this.$=Jt(ge[Se]);break;case 193:this.$=Sa(ge[Se-1],Vt(ge[Se].substr(1)));break;case 194:this.$=Jt(ge[Se-2],ge[Se]);break;case 195:case 204:this.$=Jt(ge[Se],Ci);break;case 196:case 205:this.$=Jt(ge[Se],qi);break;case 197:case 206:this.$=Jt(Vt(ge[Se]),Mi);break;case 200:this.$=Jt(ge[Se].toLowerCase(),ba);break;case 201:this.$=Jt(ge[Se].substr(1),Ci);break;case 202:this.$=Jt(ge[Se].substr(1),qi);break;case 203:this.$=Jt(ge[Se].substr(1).toLowerCase(),Mi);break;case 207:case 208:this.$=ki(ge[Se],1);break;case 209:case 210:this.$=ki(ge[Se],3);break;case 211:this.$=bt.factory.namedNode(Yr(ge[Se]));break;case 213:var wn=ge[Se].indexOf(":"),Dt=ge[Se].substr(0,wn),Zt=bt.prefixes[Dt];if(!Zt)throw new Error("Unknown prefix: "+Dt);var Er=Yr(Zt+ge[Se].substr(wn+1));this.$=bt.factory.namedNode(Er);break;case 214:if(ge[Se]=ge[Se].substr(0,ge[Se].length-1),!(ge[Se]in bt.prefixes))throw new Error("Unknown prefix: "+ge[Se]);var Er=Yr(bt.prefixes[ge[Se]]);this.$=bt.factory.namedNode(Er);break;case 215:this.$=Jr(ge[Se].replace(/^(_:)/,""));break;case 216:this.$=Jr();break;case 217:case 218:case 232:this.$=Zr(Gn(ge[Se-3],ge[Se-2],ge[Se-1]));break;case 230:case 231:this.$=Zr(ge[Se-1]);break;case 248:case 250:case 252:case 254:case 256:case 260:case 264:case 268:case 270:case 292:case 294:case 296:case 298:case 300:case 302:case 304:case 306:case 329:case 342:case 356:case 368:case 370:case 372:case 374:case 392:case 402:case 425:case 427:case 429:case 431:case 441:case 445:case 447:case 449:ge[Se-1].push(ge[Se]);break;case 259:case 269:case 291:case 293:case 295:case 301:case 305:case 371:case 424:case 426:this.$=[ge[Se]];break;case 308:ge[Se-3].push(ge[Se-2]);break;case 350:case 362:case 376:case 380:case 382:case 386:case 396:case 406:case 410:case 412:case 421:ge[Se-2].push(ge[Se-1]);break}},table:[t(r,a,{3:1,4:2,10:3}),{1:[3]},t(o,[2,307],{5:4,7:5,321:6,214:7,8:8,96:9,215:10,17:11,21:12,97:16,38:17,6:[2,238],13:u,16:u,45:u,197:u,224:u,229:u,308:u,24:[1,13],32:[1,14],36:[1,15],41:s}),t([6,13,16,24,32,36,41,45,100,110,113,115,116,123,126,131,197,224,229,308,329,330,331,332,333],[2,3],{322:19,11:20,14:21,12:[1,22],15:[1,23]}),{6:[1,24]},{6:[2,240]},{6:[2,241]},{6:[2,242]},{6:[2,243],9:25,84:26,85:c},{6:[2,239]},t(l,[2,411],{216:28,217:29}),t(d,[2,249],{18:30}),t(d,[2,251],{22:31}),t(f,[2,255],{25:32,27:33,29:[1,34]}),{13:h,16:v,33:35,39:[1,37],44:39,55:40,87:g,139:38,307:43,308:b,323:36},t(d,[2,267],{37:46}),t(_,[2,326],{98:47,103:49,106:50,117:55,130:61,100:[1,48],110:[1,51],113:[1,52],115:[1,53],116:[1,54],131:[1,62],329:[1,56],330:[1,57],331:[1,58],332:[1,59],333:[1,60]}),{39:[1,63],40:64,43:65,44:66,45:S,87:g},t(T,[2,273],{42:68,324:69,325:[1,70],326:[1,71]}),t(r,[2,248]),t(r,[2,245]),t(r,[2,246]),{13:[1,72]},{16:[1,73]},{1:[2,1]},{6:[2,2]},{6:[2,244]},{45:[1,77],85:[1,78],86:74,87:[1,75],89:[1,76]},t([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312],[2,120],{337:[1,79]}),t(w,[2,418],{218:80,222:81,229:[1,82]}),{19:83,28:A,29:R,52:84,53:E,56:85},{19:88,28:A,29:R,52:89,53:E,56:85},t(d,[2,253],{26:90}),{28:[1,91],52:92,53:E},t(I,[2,385],{181:93,182:94,183:95,31:[2,383]}),t(L,[2,263],{34:96}),t(L,[2,261],{44:39,55:40,307:43,139:97,13:h,16:v,87:g,308:b}),t(L,[2,262]),t(F,[2,259]),t(D,[2,143]),t(D,[2,144]),t([6,13,16,28,29,31,39,45,47,48,53,63,70,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,197,224,229,231,232,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,314,317,318,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,145]),t($,[2,211]),t($,[2,212]),t($,[2,213]),t($,[2,214]),{19:98,28:A,29:R,52:99,53:E,56:85},{6:[2,309],99:100,193:[1,101]},t(O,[2,311],{101:102,328:[1,103]}),t(P,[2,317],{104:104,328:[1,105]}),t(C,[2,322],{107:106,328:[1,107]}),{111:108,112:[2,324],328:[1,109]},{29:q,114:110},{29:q,114:112},{29:q,114:113},{118:114,123:[1,115],125:116,126:M},t(N,[2,315]),t(N,[2,316]),t(G,[2,319]),t(G,[2,320]),t(G,[2,321]),t(_,[2,327]),{13:h,16:v,55:118,307:43,308:b},t(d,[2,12]),t(d,[2,13],{44:66,43:119,45:S,87:g}),t(X,[2,269]),t(X,[2,15]),{13:h,16:v,44:136,45:Y,46:120,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(T,[2,14]),t(T,[2,274]),t(T,[2,271]),t(T,[2,272]),t(r,[2,4]),{13:[1,177]},t(Fe,[2,39]),{29:[1,178]},{29:[1,179]},{87:[1,181],91:180},{45:[1,187],87:[1,185],89:[1,186],93:182,165:183,166:184},t(l,[2,410]),t([6,13,16,45,48,82,87,89,231,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,337],[2,121],{338:[1,188]}),{13:h,16:v,45:[1,193],55:194,197:Ne,219:189,220:190,223:191,224:[1,192],307:43,308:b},t(w,[2,419]),t(de,Le,{20:196,59:197,69:198,70:$e}),t(d,[2,250]),{29:je,57:200},t(O,[2,279],{54:202,327:[1,203]}),{29:[2,282]},t(Me,ze,{23:204,58:205,62:206,63:Je}),t(d,[2,252]),{19:208,28:A,29:R,52:209,53:E,56:85},{29:[1,210]},t(f,[2,256]),{31:[1,211]},{31:[2,384]},{13:h,16:v,44:215,45:Ke,55:220,82:W,87:g,89:ot,145:212,172:221,185:213,187:214,231:_e,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(We,[2,265],{56:85,35:227,52:228,19:229,28:A,29:R,53:E}),t(F,[2,260]),t(Me,ze,{58:205,62:206,23:230,63:Je}),t(d,[2,268]),{6:[2,45]},t(r,a,{10:3,4:231}),{13:h,16:v,55:232,307:43,308:b},t(O,[2,312]),{105:233,112:pt,122:234,132:[1,237],134:235,327:[1,238],334:[1,239]},t(P,[2,318]),t(O,Ge,{108:240,133:242,112:ct,132:Xe}),t(C,[2,323]),{112:[1,244]},{112:[2,325]},t(Ye,[2,50]),t(I,nt,{135:245,136:246,143:247,144:248,31:gt,112:gt}),t(Ye,[2,51]),t(Ye,[2,52]),t(ut,[2,328],{119:249}),{29:q,114:250},t(ut,[2,56]),{29:q,114:251},t(_,[2,59]),t(X,[2,270]),{47:[1,252]},t(tt,[2,150]),t(Ct,[2,428],{240:253}),t(Ze,[2,430],{244:254}),t(Ze,[2,155],{248:255,249:256,250:[2,438],290:[1,257],341:[1,258],342:[1,259],343:[1,260],344:[1,261],345:[1,262],346:[1,263]}),t(Ee,[2,440],{252:264}),t(qe,[2,448],{260:265}),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,255:154,257:155,264:266,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,255:154,257:155,264:267,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,255:154,257:155,264:268,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(qe,[2,167]),t(qe,[2,168]),t(qe,[2,169]),t(qe,[2,170],{176:269,45:Be,89:it}),t(qe,[2,171]),t(qe,[2,172]),t(qe,[2,173]),t(qe,[2,174]),{13:h,16:v,44:136,45:Y,46:272,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(at,[2,176]),{89:[1,273]},{45:[1,274]},{45:[1,275]},{45:[1,276]},{45:[1,277]},{45:[1,278]},{45:vt,89:At,179:279},{45:[1,282]},{45:[1,284],89:[1,283]},{279:[1,285]},t(St,[2,192],{292:[1,286],293:[1,287]}),t(St,[2,195]),t(St,[2,196]),t(St,[2,197]),t(St,[2,198]),t(St,[2,199]),t(St,[2,200]),{13:h,16:v,44:39,55:40,82:W,87:g,139:289,172:291,255:154,257:155,266:290,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,320:288},{45:[1,292]},{45:[1,293]},{45:[1,294]},t(Xt,[2,452]),t(Xt,[2,453]),t(Xt,[2,454]),t(Xt,[2,455]),t(Xt,[2,456]),{279:[2,458]},t(jt,[2,207]),t(jt,[2,208]),t(jt,[2,209]),t(jt,[2,210]),t(St,[2,201]),t(St,[2,202]),t(St,[2,203]),t(St,[2,204]),t(St,[2,205]),t(St,[2,206]),t(r,[2,5]),t(xt,[2,297],{88:295}),t(Rt,[2,299],{90:296}),{48:[1,297],87:[1,298]},t(Lt,[2,301]),t(Fe,[2,43]),t(Fe,[2,82]),t(Fe,[2,83]),{29:[1,299]},{29:[1,300]},{87:[1,302],169:301},t(l,[2,412]),t(Ht,[2,123]),t(Ht,[2,416],{221:303,339:304,39:[1,306],263:[1,307],340:[1,305]}),t(It,[2,124]),{13:h,16:v,45:[1,311],55:194,89:[1,310],197:Ne,223:312,225:308,226:309,229:Ft,307:43,308:b},t(l,u,{215:10,214:314}),t(It,[2,236]),t(It,[2,237]),t(qt,[2,6]),t(Fr,[2,287],{60:315,72:316,73:[1,317]}),t(de,[2,286]),{13:h,16:v,45:Y,55:323,67:321,68:322,71:318,77:320,79:319,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,307:43,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De},t([6,31,63,70,73,81,83,85],[2,20]),t(I,br,{38:17,49:324,147:325,17:326,21:327,148:328,154:329,155:330,29:Gt,31:Gt,85:Gt,112:Gt,159:Gt,160:Gt,161:Gt,163:Gt,164:Gt,41:s}),{13:h,16:v,55:331,307:43,308:b},t(O,[2,280]),t(qt,[2,7]),t(de,Le,{59:197,69:198,20:332,70:$e}),t(Me,[2,284]),{64:[1,333]},t(Me,ze,{58:205,62:206,23:334,63:Je}),t(d,[2,254]),t(I,nt,{144:248,30:335,143:336,31:[2,257]}),t(d,[2,100]),{31:[2,387],184:337,335:[1,338]},{13:h,16:v,44:39,55:40,87:g,139:342,186:339,190:340,195:341,197:Ut,307:43,308:b},t(Xr,[2,389],{44:39,55:40,307:43,190:340,195:341,139:342,188:344,189:345,186:346,13:h,16:v,87:g,197:Ut,308:b}),t(er,[2,227]),t(er,[2,228]),t(er,[2,229]),{13:h,16:v,44:215,45:Ke,55:220,82:W,87:g,89:ot,172:221,185:351,187:350,200:348,230:347,231:_e,234:349,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},{13:h,16:v,44:39,55:40,87:g,139:342,186:352,190:340,195:341,197:Ut,307:43,308:b},t(er,[2,146]),t(er,[2,147]),t(er,[2,148]),t(er,[2,149]),{13:h,16:v,44:354,55:355,82:W,87:g,172:357,237:356,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:358,312:Ue,313:353},t(qn,[2,215]),t(qn,[2,216]),t(Me,ze,{58:205,62:206,23:359,63:Je}),t(L,[2,264]),t(We,[2,266]),t(qt,[2,11]),t(o,[2,308],{6:[2,310]}),t(Ye,[2,313],{102:360,120:361,121:[1,362]}),t(Ye,[2,47]),t(Ye,[2,63]),t(Ye,[2,64]),{13:h,16:v,55:363,307:43,308:b},t(Ye,[2,336]),t(Ye,[2,337]),t(Ye,[2,338]),{109:[1,364]},t(yi,[2,60]),{13:h,16:v,55:365,307:43,308:b},t(O,[2,335]),{13:h,16:v,55:366,307:43,308:b},{31:[1,367]},t(_r,[2,341],{137:368}),t(_r,[2,340]),{13:h,16:v,44:215,45:Ke,55:220,82:W,87:g,89:ot,145:369,172:221,185:213,187:214,231:_e,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},{28:[1,370],127:371,128:[1,372]},t(ut,[2,330],{124:373,125:374,126:M}),t(ut,[2,57]),{44:375,87:g},t(tt,[2,151],{241:376,242:[1,377]}),t(Ct,[2,153],{245:378,246:[1,379]}),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,247:380,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{250:[1,381]},t(Pt,[2,432]),t(Pt,[2,433]),t(Pt,[2,434]),t(Pt,[2,435]),t(Pt,[2,436]),t(Pt,[2,437]),{250:[2,439]},t([47,48,193,242,246,250,272,290,341,342,343,344,345,346],[2,158],{253:382,254:383,255:384,257:385,263:[1,386],265:[1,387],297:ne,298:he,299:xe,300:me,301:Ie,302:Pe}),t(Ee,[2,162],{261:388,262:389,39:Mn,338:Nn}),t(qe,[2,164]),t(qe,[2,165]),t(qe,[2,166]),t(at,[2,95]),t(at,[2,96]),t(Pt,[2,377],{177:392,325:[1,393]}),{48:[1,394]},t(at,[2,177]),{13:h,16:v,44:136,45:Y,46:395,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:396,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:397,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:398,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:399,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(at,[2,183]),t(at,[2,98]),t(Pt,[2,381],{180:400}),{87:[1,401]},t(at,[2,185]),{13:h,16:v,44:136,45:Y,46:402,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{29:je,57:403},t(St,[2,193]),{13:h,16:v,55:404,307:43,308:b},{13:h,16:v,44:39,55:40,87:g,139:342,195:405,197:Ut,307:43,308:b},t(lr,[2,233]),t(lr,[2,234]),t(lr,[2,235]),t(mi,[2,459],{281:406,325:[1,407]}),t(Pt,[2,463],{284:408,325:[1,409]}),t(Pt,[2,465],{286:410,325:[1,411]}),{13:h,16:v,31:[1,412],55:414,82:W,171:413,172:415,173:416,174:dn,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:hn},{31:[1,419],89:[1,420]},{29:[1,421]},t(Lt,[2,302]),t(xt,[2,367],{167:422}),t(Rt,[2,369],{168:423}),{48:[1,424],87:[1,425]},t(Lt,[2,371]),t(Ht,[2,122]),t(Ht,[2,417]),t(Ht,[2,413]),t(Ht,[2,414]),t(Ht,[2,415]),t(It,[2,125]),t(It,[2,127]),t(It,[2,128]),t(bi,[2,420],{227:426}),t(It,[2,130]),{13:h,16:v,55:194,197:Ne,223:427,307:43,308:b},{48:[1,428]},t(dr,[2,289],{61:429,80:430,81:[1,431],83:[1,432]}),t(Fr,[2,288]),{64:[1,433]},t(de,[2,29],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:434,13:h,16:v,45:Y,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,276:J,277:j,279:z,280:B,283:U,285:Z,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De}),t(_i,[2,293]),t(Bn,[2,92]),t(Bn,[2,93]),t(Bn,[2,94]),{45:Be,89:it,176:269},{31:[1,435]},{31:[1,436]},{19:437,28:A,29:R,56:85},{19:438,28:A,29:R,56:85},t(Sr,[2,355],{149:439}),t(Sr,[2,354]),{13:h,16:v,44:215,45:pn,55:220,82:W,87:g,89:ot,156:440,172:221,185:441,203:442,231:vn,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(L,[2,19]),t(dr,[2,21]),{13:h,16:v,44:450,45:Si,55:323,65:445,66:446,67:447,68:448,87:g,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,307:43,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De},t(qt,[2,8]),{31:[1,451]},{31:[2,258]},{31:[2,101]},t(I,[2,386],{31:[2,388]}),t(Xr,[2,102]),t(Tr,[2,391],{191:452}),t(I,[2,395],{196:453,198:454}),t(I,[2,108]),t(I,[2,109]),t(Xr,[2,103]),t(Xr,[2,104]),t(Xr,[2,390]),{13:h,16:v,44:215,45:Ke,48:[1,455],55:220,82:W,87:g,89:ot,172:221,185:351,187:350,200:456,231:_e,234:349,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(gn,[2,424]),t(Ti,[2,136]),t(Ti,[2,137]),t(jn,[2,140]),{232:[1,457]},{13:h,16:v,44:39,55:40,87:g,139:342,195:458,197:Ut,307:43,308:b},t(lr,[2,219]),t(lr,[2,220]),t(lr,[2,221]),t(lr,[2,222]),t(lr,[2,223]),t(qt,[2,10]),t(Ye,[2,46]),t(Ye,[2,314]),{112:pt,122:459},t(Ye,[2,62]),t(O,Ge,{133:242,108:460,112:ct,132:Xe}),t(yi,[2,61]),t(Ye,[2,49]),t([6,28,126,128,193],[2,65]),{31:[2,66],112:[1,462],138:461},t(_r,[2,351],{146:463,335:[1,464]}),{29:je,57:465},t(ut,[2,329]),t(O,[2,332],{129:466,327:[1,467]}),t(ut,[2,55]),t(ut,[2,331]),{48:[1,468]},t(Ct,[2,429]),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,239:469,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Ze,[2,431]),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,243:470,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Ze,[2,156]),{45:vt,89:At,179:471},t(Ee,[2,441]),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,251:472,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(qe,[2,444],{256:473}),t(qe,[2,446],{258:474}),t(Pt,[2,442]),t(Pt,[2,443]),t(qe,[2,449]),{13:h,16:v,44:136,45:Y,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,255:154,257:155,259:475,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Pt,[2,450]),t(Pt,[2,451]),t(Pt,[2,379],{178:476}),t(Pt,[2,378]),t([6,13,16,29,31,39,45,47,48,73,76,78,81,82,83,85,87,89,112,159,160,161,163,164,193,231,242,246,250,263,265,268,269,270,271,272,273,274,276,277,279,280,283,285,290,294,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,312,335,338,341,342,343,344,345,346,347,348,349,350,351],[2,175]),{48:[1,477]},{48:[1,478]},{272:[1,479]},{272:[1,480]},{272:[1,481]},{13:h,16:v,44:136,45:Y,46:482,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{48:[1,483]},{48:[1,484]},t(at,[2,187]),t(St,[2,194]),{13:h,16:v,44:39,55:40,82:W,87:g,139:289,172:291,255:154,257:155,266:290,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,320:485},{13:h,16:v,39:[1,487],44:136,45:Y,46:488,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,282:486,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(mi,[2,460]),{13:h,16:v,44:136,45:Y,46:489,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Pt,[2,464]),{13:h,16:v,44:136,45:Y,46:490,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Pt,[2,466]),t(Fe,[2,40]),t(xt,[2,298]),t(Kr,[2,87]),t(Kr,[2,88]),t(Kr,[2,89]),t(Kr,[2,90]),{13:h,16:v,55:492,82:W,172:493,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,311:494,312:Ue,315:491},t(Fe,[2,41]),t(Rt,[2,300]),t(Wr,[2,303],{92:495}),{13:h,16:v,31:[1,496],55:414,82:W,171:497,172:415,173:416,174:dn,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:hn},{31:[1,498],89:[1,499]},{29:[1,500]},t(Lt,[2,372]),{13:h,16:v,48:[2,422],55:194,197:Ne,223:312,226:502,228:501,229:Ft,307:43,308:b},t(It,[2,131]),t(It,[2,126]),t(dr,[2,22]),t(dr,[2,290]),{82:[1,503]},{82:[1,504]},{13:h,16:v,44:510,45:Y,55:323,67:321,68:322,74:505,75:506,76:Ai,77:320,78:xi,79:509,87:g,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,307:43,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De},t(_i,[2,294]),t(wi,[2,69]),t(wi,[2,70]),t(de,Le,{59:197,69:198,20:511,70:$e}),t(Me,ze,{58:205,62:206,23:512,63:Je}),{29:[2,375],31:[2,71],84:522,85:c,112:[1,518],150:513,151:514,158:515,159:[1,516],160:[1,517],161:[1,519],163:[1,520],164:[1,521],175:523},t(Sr,[2,363],{157:524,335:[1,525]}),t(l,u,{215:10,202:526,205:527,208:528,214:529,44:530,87:g}),t(yn,[2,399],{215:10,205:527,208:528,214:529,44:530,204:531,202:532,13:u,16:u,45:u,197:u,224:u,229:u,308:u,87:g}),{13:h,16:v,44:215,45:pn,55:220,82:W,87:g,89:ot,172:221,185:351,203:536,212:534,231:vn,233:533,234:535,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(l,u,{215:10,205:527,208:528,214:529,44:530,202:537,87:g}),t(Me,[2,23],{307:43,267:139,275:146,278:149,55:323,67:447,68:448,44:450,66:538,13:h,16:v,45:Si,87:g,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,276:J,277:j,279:z,280:B,283:U,285:Z,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De}),t(Ar,[2,291]),t(Ar,[2,24]),t(Ar,[2,25]),{13:h,16:v,44:136,45:Y,46:539,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(Ar,[2,28]),t(Me,ze,{58:205,62:206,23:540,63:Je}),t([31,112,232,318,335],[2,105],{192:541,193:[1,542]}),t(Tr,[2,107]),{13:h,16:v,44:215,45:Ke,55:220,82:W,87:g,89:ot,172:221,185:351,187:350,199:543,200:544,231:_e,234:349,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(Ri,[2,132]),t(gn,[2,425]),t(Ri,[2,133]),{13:h,16:v,44:354,55:355,82:W,87:g,172:357,237:356,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:358,312:Ue,313:545},t(Ye,[2,54]),t(Ye,[2,48]),t(_r,[2,342]),{13:h,16:v,44:39,55:40,87:g,139:546,307:43,308:b},t(_r,[2,68]),t(I,[2,350],{31:Ei,112:Ei}),t(Ye,[2,53]),{13:h,16:v,55:547,307:43,308:b},t(O,[2,333]),t(X,[2,16]),t(Ct,[2,152]),t(Ze,[2,154]),t(Ze,[2,157]),t(Ee,[2,159]),t(Ee,[2,160],{262:389,261:548,39:Mn,338:Nn}),t(Ee,[2,161],{262:389,261:549,39:Mn,338:Nn}),t(qe,[2,163]),{13:h,16:v,44:136,45:Y,46:550,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(at,[2,178]),t(at,[2,179]),{13:h,16:v,44:136,45:Y,46:551,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:552,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:553,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{48:[1,554],272:[1,555]},t(at,[2,184]),t(at,[2,186]),{314:[1,556]},{48:[1,557]},{48:[2,461]},{48:[2,462]},{48:[1,558]},{48:[2,467],193:[1,561],287:559,288:560},{13:h,16:v,55:194,197:Ne,223:562,307:43,308:b},t(kn,[2,224]),t(kn,[2,225]),t(kn,[2,226]),{31:[1,563],45:Ii,94:564},t(Fe,[2,84]),t(xt,[2,368]),t(Fe,[2,85]),t(Rt,[2,370]),t(Wr,[2,373],{170:566}),{48:[1,567]},{48:[2,423],337:[1,568]},t(dr,[2,35],{83:[1,569]}),t(dr,[2,36],{81:[1,570]}),t(Fr,[2,30],{307:43,267:139,275:146,278:149,77:320,67:321,68:322,55:323,79:509,44:510,75:571,13:h,16:v,45:Y,76:Ai,78:xi,87:g,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,276:J,277:j,279:z,280:B,283:U,285:Z,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De}),t(Cr,[2,295]),{45:Y,77:572},{45:Y,77:573},t(Cr,[2,33]),t(Cr,[2,34]),{31:[2,275],50:574,84:575,85:c},{31:[2,277],51:576,84:577,85:c},t(Sr,[2,356]),t(Oi,[2,357],{152:578,335:[1,579]}),t(tr,[2,74]),{29:je,57:580},{29:je,57:581},{13:h,16:v,44:39,55:40,87:g,139:582,307:43,308:b},t(Li,[2,365],{162:583,328:[1,584]}),{13:h,16:v,45:Y,55:323,67:321,68:322,77:320,79:585,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,307:43,308:b,346:ee,347:ae,348:be,349:le,350:we,351:De},{45:[1,586]},t(tr,[2,81]),{29:je,57:587},t(Sr,[2,73]),t(I,[2,362],{29:rr,31:rr,85:rr,112:rr,159:rr,160:rr,161:rr,163:rr,164:rr}),t(yn,[2,112]),t(qr,[2,401],{206:588}),t(I,[2,405],{209:589,210:590}),t(I,[2,403]),t(I,[2,404]),t(yn,[2,113]),t(yn,[2,400]),{13:h,16:v,44:215,45:pn,48:[1,591],55:220,82:W,87:g,89:ot,172:221,185:351,203:536,212:592,231:vn,234:535,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(gn,[2,426]),t(jn,[2,138]),t(jn,[2,139]),{232:[1,593]},t(Ar,[2,292]),{47:[1,595],48:[1,594]},t(qt,[2,9]),t(Tr,[2,392]),t(Tr,[2,393],{44:39,55:40,307:43,195:341,139:342,194:596,190:597,13:h,16:v,87:g,197:Ut,308:b}),t(Tr,[2,110],{272:[1,598]}),t(mn,[2,397],{201:599,316:600,317:[1,601]}),{314:[1,602]},{29:[1,603]},t(ut,[2,58]),t(qe,[2,445]),t(qe,[2,447]),{48:[1,604],272:[1,605]},{48:[1,606]},{272:[1,607]},{272:[1,608]},t(at,[2,99]),t(Pt,[2,382]),t([13,16,39,47,48,87,193,197,242,246,250,263,265,272,290,297,298,299,300,301,302,308,314,338,341,342,343,344,345,346],[2,232]),t(at,[2,188]),t(at,[2,189]),{48:[1,609]},{48:[2,468]},{289:[1,610]},{13:h,16:v,55:492,82:W,172:493,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,311:494,312:Ue,315:611},t(Fe,[2,42]),t(Wr,[2,304]),{13:h,16:v,55:414,82:W,95:612,171:613,172:415,173:416,174:dn,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:hn},{31:[1,614],45:Ii,94:615},t(It,[2,129]),t(bi,[2,421]),{82:[1,616]},{82:[1,617]},t(Cr,[2,296]),t(Cr,[2,31]),t(Cr,[2,32]),{31:[2,17]},{31:[2,276]},{31:[2,18]},{31:[2,278]},t(I,br,{155:330,153:618,154:619,29:nr,31:nr,85:nr,112:nr,159:nr,160:nr,161:nr,163:nr,164:nr}),t(Oi,[2,358]),t(tr,[2,75]),t(tr,[2,76]),{29:je,57:620},{13:h,16:v,44:39,55:40,87:g,139:621,307:43,308:b},t(Li,[2,366]),t(tr,[2,79]),{13:h,16:v,44:136,45:Y,46:622,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(tr,[2,91],{336:[1,623]}),t([29,31,85,112,159,160,161,163,164,232,318,335],[2,114],{207:624,193:[1,625]}),t(qr,[2,117]),{13:h,16:v,44:215,45:pn,55:220,82:W,87:g,89:ot,172:221,185:351,203:536,211:626,212:627,231:vn,234:535,236:216,237:222,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,309:Ae,310:Ve,311:217,312:Ue},t(er,[2,134]),t(gn,[2,427]),t(er,[2,135]),t(Ar,[2,26]),{44:628,87:g},t(Tr,[2,106]),t(Tr,[2,394]),t(I,[2,396]),t(mn,[2,111]),t(mn,[2,398]),{13:h,16:v,44:39,55:40,87:g,139:342,186:629,190:340,195:341,197:Ut,307:43,308:b},t(qn,[2,217]),t(I,nt,{144:248,140:630,143:631,31:[2,343]}),t(at,[2,97]),t(Pt,[2,380]),t(at,[2,180]),{13:h,16:v,44:136,45:Y,46:632,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},{13:h,16:v,44:136,45:Y,46:633,55:133,67:132,68:134,77:131,82:W,87:g,172:135,224:te,238:121,239:122,243:123,247:124,251:125,255:154,257:155,259:126,263:ue,264:130,265:fe,266:137,267:139,268:re,269:ye,270:Te,271:Re,273:ve,274:ce,275:146,276:J,277:j,278:149,279:z,280:B,283:U,285:Z,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:Q,346:ee,347:ae,348:be,349:le,350:we,351:De},t(at,[2,190]),{290:[1,634]},{314:[1,635]},{13:h,16:v,48:[1,636],55:414,82:W,171:637,172:415,173:416,174:dn,255:154,257:155,291:150,294:oe,295:ie,296:se,297:ne,298:he,299:xe,300:me,301:Ie,302:Pe,303:Ce,304:pe,305:H,306:V,307:43,308:b,312:hn},t($i,[2,305]),t(Fe,[2,86]),t(Wr,[2,374]),t(dr,[2,37]),t(dr,[2,38]),t(Sr,[2,72]),t(Sr,[2,360]),t(tr,[2,77]),{29:je,57:638},{47:[1,639]},{29:[2,376]},t(qr,[2,402]),t(qr,[2,115],{215:10,208:528,214:529,44:530,205:640,13:u,16:u,45:u,197:u,224:u,229:u,308:u,87:g}),t(qr,[2,118],{272:[1,641]}),t(bn,[2,407],{213:642,319:643,317:[1,644]}),{48:[1,645]},{318:[1,646]},{31:[1,647]},{31:[2,344]},{48:[1,648]},{48:[1,649]},{291:650,303:Ce,304:pe,305:H,306:V},t(Kr,[2,218]),t(Wr,[2,44]),t($i,[2,306]),t(tr,[2,78]),{44:651,87:g},t(qr,[2,116]),t(I,[2,406]),t(bn,[2,119]),t(bn,[2,408]),t(l,u,{215:10,205:527,208:528,214:529,44:530,202:652,87:g}),t(Ar,[2,27]),t(mn,[2,230]),t(Di,[2,345],{141:653,335:[1,654]}),t(at,[2,181]),t(at,[2,182]),{48:[2,191]},{48:[1,655]},{318:[1,656]},t(I,nt,{144:248,142:657,143:658,31:Pi,112:Pi}),t(Di,[2,346]),t(tr,[2,80]),t(bn,[2,231]),t(_r,[2,67]),t(_r,[2,348])],defaultActions:{5:[2,240],6:[2,241],7:[2,242],9:[2,239],24:[2,1],25:[2,2],26:[2,244],87:[2,282],94:[2,384],100:[2,45],109:[2,325],166:[2,458],263:[2,439],336:[2,258],337:[2,101],487:[2,461],488:[2,462],560:[2,468],574:[2,17],575:[2,276],576:[2,18],577:[2,278],623:[2,376],631:[2,344],650:[2,191]},parseError:function(ke,Qe){if(Qe.recoverable)this.trace(ke);else{var et=new Error(ke);throw et.hash=Qe,et}},parse:function(ke){var Qe=this,et=[0],dt=[null],ft=[],ge=this.table,Qt="",Se=0,fr=0,An=2,xn=1,wn=ft.slice.call(arguments,1),Dt=Object.create(this.lexer),Zt={yy:{}};for(var Er in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Er)&&(Zt.yy[Er]=this.yy[Er]);Dt.setInput(ke,Zt.yy),Zt.yy.lexer=Dt,Zt.yy.parser=this,typeof Dt.yylloc>"u"&&(Dt.yylloc={});var Vr=Dt.yylloc;ft.push(Vr);var ei=Dt.options&&Dt.options.ranges;typeof Zt.yy.parseError=="function"?this.parseError=Zt.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var Rn=function(){var Hr;return Hr=Dt.lex()||xn,typeof Hr!="number"&&(Hr=Qe.symbols_[Hr]||Hr),Hr},mt,Tt,yt,Nt,Bt={},En,ar,zi,In;;){if(Tt=et[et.length-1],this.defaultActions[Tt]?yt=this.defaultActions[Tt]:((mt===null||typeof mt>"u")&&(mt=Rn()),yt=ge[Tt]&&ge[Tt][mt]),typeof yt>"u"||!yt.length||!yt[0]){var ti="";In=[];for(En in ge[Tt])this.terminals_[En]&&En>An&&In.push("'"+this.terminals_[En]+"'");Dt.showPosition?ti="Parse error on line "+(Se+1)+`:
`+Dt.showPosition()+`
Expecting `+In.join(", ")+", got '"+(this.terminals_[mt]||mt)+"'":ti="Parse error on line "+(Se+1)+": Unexpected "+(mt==xn?"end of input":"'"+(this.terminals_[mt]||mt)+"'"),this.parseError(ti,{text:Dt.match,token:this.terminals_[mt]||mt,line:Dt.yylineno,loc:Vr,expected:In})}if(yt[0]instanceof Array&&yt.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Tt+", token: "+mt);switch(yt[0]){case 1:et.push(mt),dt.push(Dt.yytext),ft.push(Dt.yylloc),et.push(yt[1]),mt=null,fr=Dt.yyleng,Qt=Dt.yytext,Se=Dt.yylineno,Vr=Dt.yylloc;break;case 2:if(ar=this.productions_[yt[1]][1],Bt.$=dt[dt.length-ar],Bt._$={first_line:ft[ft.length-(ar||1)].first_line,last_line:ft[ft.length-1].last_line,first_column:ft[ft.length-(ar||1)].first_column,last_column:ft[ft.length-1].last_column},ei&&(Bt._$.range=[ft[ft.length-(ar||1)].range[0],ft[ft.length-1].range[1]]),Nt=this.performAction.apply(Bt,[Qt,fr,Se,Zt.yy,yt[1],dt,ft].concat(wn)),typeof Nt<"u")return Nt;ar&&(et=et.slice(0,-1*ar*2),dt=dt.slice(0,-1*ar),ft=ft.slice(0,-1*ar)),et.push(this.productions_[yt[1]][0]),dt.push(Bt.$),ft.push(Bt._$),zi=ge[et[et.length-2]][et[et.length-1]],et.push(zi);break;case 3:return!0}}return!0}},_n=requireWildcard().Wildcard,Sn="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ga=Sn+"type",ya=Sn+"first",ma=Sn+"rest",Fi=Sn+"nil",Tn="http://www.w3.org/2001/XMLSchema#",Ci=Tn+"integer",qi=Tn+"decimal",Mi=Tn+"double",ba=Tn+"boolean",xr="",Ni="",Bi="";function Vt(He){return He.toLowerCase()}function wr(He,ke){return He.push(ke),He}function Mr(He,ke){return He.push.apply(He,ke),He}function $t(He){He||(He={});for(var ke=1,Qe=arguments.length,et;ke<Qe&&(et=arguments[ke]||{});ke++)for(var dt in et)He[dt]=et[dt];return He}function Yt(){for(var He=[],ke=0,Qe=arguments.length;ke<Qe;ke++)He=He.concat.apply(He,arguments[ke]);return He}function Yr(He){if(He[0]==="<"&&(He=He.substring(1,He.length-1)),/^[a-z][a-z0-9.+-]*:/i.test(He))return He;if(!bt.base)throw new Error("Cannot resolve relative IRI "+He+" because no base IRI was set.");switch(xr!==bt.base&&(xr=bt.base,Ni=xr.replace(/[^\/:]*$/,""),Bi=xr.match(/^(?:[a-z]+:\/*)?[^\/]*/)[0]),He[0]){case void 0:return xr;case"#":return xr+He;case"?":return xr.replace(/(?:\?.*)?$/,He);case"/":return Bi+He;default:return Ni+He}}function Hn(He){if(He){var ke=He[0];if(ke==="?"||ke==="$")return bt.factory.variable(He.substr(1))}return He}function Mt(He,ke){return{type:"operation",operator:He,args:ke||[]}}function Nr(He,ke){var Qe={expression:He==="*"?new _n:He};if(ke)for(var et in ke)Qe[et]=ke[et];return Qe}function Br(He,ke){return{type:"path",pathType:He,items:ke}}function Un(He,ke){for(var Qe=0,et=ke.length,dt;Qe<et&&(dt=ke[Qe]);Qe++)He=Mt(dt[0],[He,dt[1]]);return He}function Rr(He,ke){var Qe=[],et=[],dt=He.length,ft,ge={};if(!dt)return null;for(var Qt=0;Qt<dt&&(ft=He[Qt]);Qt++)(ft.named?et:Qe).push(ft.iri);return ge[ke||"from"]={default:Qe,named:et},ge}function jr(He){return parseInt(He,10)}function zn(He){return He.type==="group"&&He.patterns.length===1?He.patterns[0]:He}function Jt(He,ke){return ke&&ke.termType!=="NamedNode"&&(ke=bt.factory.namedNode(ke)),bt.factory.literal(He,ke)}function Sa(He,ke){return bt.factory.literal(He,ke)}function Gn(He,ke,Qe){if(!("termType"in ke))throw new Error("Nested triples cannot contain paths");return bt.factory.quad(He,ke,Qe)}function ir(He,ke,Qe,et){var dt={};return He!=null&&(dt.subject=He),ke!=null&&(dt.predicate=ke),Qe!=null&&(dt.object=Qe),et!=null&&(dt.annotations=et),dt}function Jr(He){return typeof He=="string"?He.startsWith("e_")?bt.factory.blankNode(He):bt.factory.blankNode("e_"+He):bt.factory.blankNode("g_"+ji++)}var ji=0;bt._resetBlanks=function(){ji=0};var Ta=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,Aa={"\\":"\\","'":"'",'"':'"',t:"	",b:"\b",n:`
`,r:"\r",f:"\f"},xa=/[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/,Qn=String.fromCharCode;function ki(He,ke){He=He.substring(ke,He.length-ke);try{He=He.replace(Ta,function(Qe,et,dt,ft){var ge;if(et){if(ge=parseInt(et,16),isNaN(ge))throw new Error;return Qn(ge)}else if(dt){if(ge=parseInt(dt,16),isNaN(ge))throw new Error;return ge<65535?Qn(ge):Qn(55296+((ge-=65536)>>10),56320+(ge&1023))}else{var Qt=Aa[ft];if(!Qt)throw new Error;return Qt}})}catch{return""}if(xa.exec(He))throw new Error("Invalid unicode codepoint of surrogate pair without corresponding codepoint in "+He);return He}function wa(He){var ke=Jr(),Qe=ke,et=[],dt,ft=[];He.forEach(function(fr){et.push(fr.entity),Mr(ft,fr.triples)});for(var ge=0,Qt=0,Se=et.length,dt=Array(Se*2);ge<Se;)dt[Qt++]=ir(Qe,bt.factory.namedNode(ya),et[ge]),dt[Qt++]=ir(Qe,bt.factory.namedNode(ma),Qe=++ge<Se?Jr():bt.factory.namedNode(Fi));return{entity:ke,triples:Mr(dt,ft)}}function Ra(He){var ke=Jr();return{entity:ke,triples:He.map(function(Qe){return $t(ir(ke),Qe)})}}function Xn(He,ke,Qe){var et=[],dt=[];return ke.forEach(function(ft){let ge=null;ft.annotation&&(ge=ft.annotation,ft=ft.object),et.push(ir(null,He,ft.entity,ge)),Mr(dt,ft.triples)}),Yt(et,Qe||[],dt)}function kr(He){return He.variable?He.variable.value:He.value||He.expression.value}function Kn(He){if(!He)return[];if(He.type==="aggregate")return[He];if(He.type==="operation"){const ke=[];for(const Qe of He.args)ke.push(...Kn(Qe));return ke}return[]}function Ea(He){const ke=new Set,Qe=function(et){et&&(et.termType==="Variable"?ke.add(et):et.type==="operation"&&et.args.forEach(Qe))};return Qe(He),ke}function Wn(He,ke=1,Qe=[]){for(const et of He)ke>0&&et instanceof Array?Wn(et,ke-1,Qe):Qe.push(et);return Qe}function Yn(He){return He.termType==="Variable"}function Vi(He){if(He.triples){const ke=[];for(const Qe of He.triples)Yn(Qe.subject)&&ke.push(Qe.subject.value),Yn(Qe.predicate)&&ke.push(Qe.predicate.value),Yn(Qe.object)&&ke.push(Qe.object.value);return ke}else if(He.patterns){const ke=[];for(const Qe of He.patterns)ke.push(...Vi(Qe));return ke}return[]}function Ia(He){const ke=He.slice().sort(),Qe=[];for(let et=0;et<ke.length-1;et++)ke[et+1]==ke[et]&&Qe.push(ke[et]);return Qe}function Zr(He){if(!bt.sparqlStar)throw new Error("SPARQL-star support is not enabled");return He}function Hi(He,ke,Qe){for(const et of ke){const dt=ir("subject"in et?et.subject:He,et.predicate,et.object);Qe.push(dt),et.annotations&&Hi(Gn(He,et.predicate,et.object),et.annotations,Qe)}}function Jn(He){if(bt.sparqlStar){const ke=[];return He.forEach(Qe=>{const et=ir(Qe.subject,Qe.predicate,Qe.object);ke.push(et),Qe.annotations&&Hi(Gn(Qe.subject,Qe.predicate,Qe.object),Qe.annotations,ke)}),ke}return He}function Ui(He){for(const ke of He){if(ke.type==="graph"&&ke.name.termType==="Variable")throw new Error("Detected illegal variable in GRAPH");if(ke.type==="bgp"||ke.type==="graph"){for(const Qe of ke.triples)if(Qe.subject.termType==="Variable"||Qe.predicate.termType==="Variable"||Qe.object.termType==="Variable")throw new Error("Detected illegal variable in BGP")}}return He}function Zn(He){for(const ke of He)if(ke.type==="bgp"){for(const Qe of ke.triples)if(Qe.subject.termType==="BlankNode"||Qe.predicate.termType==="BlankNode"||Qe.object.termType==="BlankNode")throw new Error("Detected illegal blank node in BGP")}return He}var Oa=function(){var He={EOF:1,parseError:function(Qe,et){if(this.yy.parser)this.yy.parser.parseError(Qe,et);else throw new Error(Qe)},setInput:function(ke,Qe){return this.yy=Qe||this.yy||{},this._input=ke,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ke=this._input[0];this.yytext+=ke,this.yyleng++,this.offset++,this.match+=ke,this.matched+=ke;var Qe=ke.match(/(?:\r\n?|\n).*/g);return Qe?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ke},unput:function(ke){var Qe=ke.length,et=ke.split(/(?:\r\n?|\n)/g);this._input=ke+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Qe),this.offset-=Qe;var dt=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),et.length-1&&(this.yylineno-=et.length-1);var ft=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:et?(et.length===dt.length?this.yylloc.first_column:0)+dt[dt.length-et.length].length-et[0].length:this.yylloc.first_column-Qe},this.options.ranges&&(this.yylloc.range=[ft[0],ft[0]+this.yyleng-Qe]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(ke){this.unput(this.match.slice(ke))},pastInput:function(){var ke=this.matched.substr(0,this.matched.length-this.match.length);return(ke.length>20?"...":"")+ke.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var ke=this.match;return ke.length<20&&(ke+=this._input.substr(0,20-ke.length)),(ke.substr(0,20)+(ke.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var ke=this.pastInput(),Qe=new Array(ke.length+1).join("-");return ke+this.upcomingInput()+`
`+Qe+"^"},test_match:function(ke,Qe){var et,dt,ft;if(this.options.backtrack_lexer&&(ft={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ft.yylloc.range=this.yylloc.range.slice(0))),dt=ke[0].match(/(?:\r\n?|\n).*/g),dt&&(this.yylineno+=dt.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:dt?dt[dt.length-1].length-dt[dt.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ke[0].length},this.yytext+=ke[0],this.match+=ke[0],this.matches=ke,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(ke[0].length),this.matched+=ke[0],et=this.performAction.call(this,this.yy,this,Qe,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),et)return et;if(this._backtrack){for(var ge in ft)this[ge]=ft[ge];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var ke,Qe,et,dt;this._more||(this.yytext="",this.match="");for(var ft=this._currentRules(),ge=0;ge<ft.length;ge++)if(et=this._input.match(this.rules[ft[ge]]),et&&(!Qe||et[0].length>Qe[0].length)){if(Qe=et,dt=ge,this.options.backtrack_lexer){if(ke=this.test_match(et,ft[ge]),ke!==!1)return ke;if(this._backtrack){Qe=!1;continue}else return!1}else if(!this.options.flex)break}return Qe?(ke=this.test_match(Qe,ft[dt]),ke!==!1?ke:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Qe=this.next();return Qe||this.lex()},begin:function(Qe){this.conditionStack.push(Qe)},popState:function(){var Qe=this.conditionStack.length-1;return Qe>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Qe){return Qe=this.conditionStack.length-1-Math.abs(Qe||0),Qe>=0?this.conditionStack[Qe]:"INITIAL"},pushState:function(Qe){this.begin(Qe)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0,"case-insensitive":!0},performAction:function(Qe,et,dt,ft){switch(dt){case 0:break;case 1:return 12;case 2:return 15;case 3:return 41;case 4:return 325;case 5:return 326;case 6:return 45;case 7:return 47;case 8:return 48;case 9:return 39;case 10:return 24;case 11:return 28;case 12:return 29;case 13:return 31;case 14:return 32;case 15:return 36;case 16:return 53;case 17:return 327;case 18:return 63;case 19:return 64;case 20:return 70;case 21:return 73;case 22:return 76;case 23:return 78;case 24:return 81;case 25:return 83;case 26:return 85;case 27:return 193;case 28:return 100;case 29:return 328;case 30:return 121;case 31:return 329;case 32:return 330;case 33:return 110;case 34:return 331;case 35:return 109;case 36:return 332;case 37:return 333;case 38:return 113;case 39:return 115;case 40:return 116;case 41:return 131;case 42:return 123;case 43:return 126;case 44:return 128;case 45:return 132;case 46:return 112;case 47:return 334;case 48:return 335;case 49:return 159;case 50:return 161;case 51:return 164;case 52:return 174;case 53:return 160;case 54:return 336;case 55:return 163;case 56:return 312;case 57:return 314;case 58:return 317;case 59:return 318;case 60:return 272;case 61:return 197;case 62:return 337;case 63:return 338;case 64:return 229;case 65:return 340;case 66:return 263;case 67:return 224;case 68:return 231;case 69:return 232;case 70:return 242;case 71:return 246;case 72:return 290;case 73:return 341;case 74:return 342;case 75:return 343;case 76:return 344;case 77:return 345;case 78:return 250;case 79:return 346;case 80:return 265;case 81:return 276;case 82:return 277;case 83:return 268;case 84:return 269;case 85:return 270;case 86:return 271;case 87:return 347;case 88:return 348;case 89:return 273;case 90:return 274;case 91:return 350;case 92:return 349;case 93:return 351;case 94:return 279;case 95:return 280;case 96:return 283;case 97:return 285;case 98:return 289;case 99:return 293;case 100:return 296;case 101:return 13;case 102:return 16;case 103:return 308;case 104:return 309;case 105:return 87;case 106:return 292;case 107:return 82;case 108:return 294;case 109:return 295;case 110:return 297;case 111:return 298;case 112:return 299;case 113:return 300;case 114:return 301;case 115:return 302;case 116:return"EXPONENT";case 117:return 303;case 118:return 304;case 119:return 305;case 120:return 306;case 121:return 89;case 122:return 310;case 123:return 6;case 124:return"INVALID";case 125:console.log(et.yytext);break}},rules:[/^(?:\s+|(#[^\n\r]*))/i,/^(?:BASE)/i,/^(?:PREFIX)/i,/^(?:SELECT)/i,/^(?:DISTINCT)/i,/^(?:REDUCED)/i,/^(?:\()/i,/^(?:AS)/i,/^(?:\))/i,/^(?:\*)/i,/^(?:CONSTRUCT)/i,/^(?:WHERE)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:DESCRIBE)/i,/^(?:ASK)/i,/^(?:FROM)/i,/^(?:NAMED)/i,/^(?:GROUP)/i,/^(?:BY)/i,/^(?:HAVING)/i,/^(?:ORDER)/i,/^(?:ASC)/i,/^(?:DESC)/i,/^(?:LIMIT)/i,/^(?:OFFSET)/i,/^(?:VALUES)/i,/^(?:;)/i,/^(?:LOAD)/i,/^(?:SILENT)/i,/^(?:INTO)/i,/^(?:CLEAR)/i,/^(?:DROP)/i,/^(?:CREATE)/i,/^(?:ADD)/i,/^(?:TO)/i,/^(?:MOVE)/i,/^(?:COPY)/i,/^(?:INSERT((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)WHERE)/i,/^(?:WITH)/i,/^(?:DELETE)/i,/^(?:INSERT)/i,/^(?:USING)/i,/^(?:DEFAULT)/i,/^(?:GRAPH)/i,/^(?:ALL)/i,/^(?:\.)/i,/^(?:OPTIONAL)/i,/^(?:SERVICE)/i,/^(?:BIND)/i,/^(?:UNDEF)/i,/^(?:MINUS)/i,/^(?:UNION)/i,/^(?:FILTER)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:\{\|)/i,/^(?:\|\})/i,/^(?:,)/i,/^(?:a)/i,/^(?:\|)/i,/^(?:\/)/i,/^(?:\^)/i,/^(?:\?)/i,/^(?:\+)/i,/^(?:!)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\|\|)/i,/^(?:&&)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:<)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:>=)/i,/^(?:IN)/i,/^(?:NOT)/i,/^(?:-)/i,/^(?:BOUND)/i,/^(?:BNODE)/i,/^(?:(RAND|NOW|UUID|STRUUID))/i,/^(?:(LANG|DATATYPE|IRI|URI|ABS|CEIL|FLOOR|ROUND|STRLEN|STR|UCASE|LCASE|ENCODE_FOR_URI|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|TIMEZONE|TZ|MD5|SHA1|SHA256|SHA384|SHA512|isIRI|isURI|isBLANK|isLITERAL|isNUMERIC))/i,/^(?:(SUBJECT|PREDICATE|OBJECT|isTRIPLE))/i,/^(?:(LANGMATCHES|CONTAINS|STRSTARTS|STRENDS|STRBEFORE|STRAFTER|STRLANG|STRDT|sameTerm))/i,/^(?:CONCAT)/i,/^(?:COALESCE)/i,/^(?:IF)/i,/^(?:TRIPLE)/i,/^(?:REGEX)/i,/^(?:SUBSTR)/i,/^(?:REPLACE)/i,/^(?:EXISTS)/i,/^(?:COUNT)/i,/^(?:SUM|MIN|MAX|AVG|SAMPLE)/i,/^(?:GROUP_CONCAT)/i,/^(?:SEPARATOR)/i,/^(?:\^\^)/i,/^(?:true|false)/i,/^(?:(<(?:[^<>\"\{\}\|\^`\\\u0000-\u0020])*>))/i,/^(?:((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:)((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|:|[0-9]|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(_:(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?))/i,/^(?:([\?\$]((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])*)))/i,/^(?:(@[a-zA-Z]+(?:-[a-zA-Z0-9]+)*))/i,/^(?:([0-9]+))/i,/^(?:([0-9]*\.[0-9]+))/i,/^(?:([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+)))/i,/^(?:(\+([0-9]+)))/i,/^(?:(\+([0-9]*\.[0-9]+)))/i,/^(?:(\+([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:(-([0-9]+)))/i,/^(?:(-([0-9]*\.[0-9]+)))/i,/^(?:(-([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*"""))/i,/^(?:(\((\u0020|\u0009|\u000D|\u000A)*\)))/i,/^(?:(\[(\u0020|\u0009|\u000D|\u000A)*\]))/i,/^(?:$)/i,/^(?:.)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125],inclusive:!0}}};return He}();Vn.lexer=Oa;function bt(){this.yy={}}return bt.prototype=Vn,Vn.Parser=bt,new bt}();return SparqlParser_1=n,SparqlParser_1}var SparqlGenerator,hasRequiredSparqlGenerator;function requireSparqlGenerator(){if(hasRequiredSparqlGenerator)return SparqlGenerator;hasRequiredSparqlGenerator=1;var n="http://www.w3.org/2001/XMLSchema#integer",t="http://www.w3.org/2001/XMLSchema#string";function r(v){this._options=v=v||{};var g=v.prefixes||{};this._prefixByIri={};var b=[];for(var _ in g){var S=g[_];c(S)&&(this._prefixByIri[S]=_,b.push(S))}var T=b.join("|").replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&");this._prefixRegex=new RegExp("^("+T+")([a-zA-Z][\\-_a-zA-Z0-9]*)$"),this._usedPrefixes={},this._sparqlStar=v.sparqlStar,this._indent=c(v.indent)?v.indent:"  ",this._newline=c(v.newline)?v.newline:`
`,this._explicitDatatype=!!v.explicitDatatype}r.prototype.toQuery=function(v){var g="";return v.queryType&&(g+=v.queryType.toUpperCase()+" "),v.reduced&&(g+="REDUCED "),v.distinct&&(g+="DISTINCT "),v.variables?g+=f(v.variables,void 0,function(b){return/^[?$]/.test(b)?b:l(b)?this.toEntity(b):"("+this.toExpression(b.expression)+" AS "+s(b.variable)+")"},this)+" ":v.template&&(g+=this.group(v.template,!0)+this._newline),v.from&&(g+=this.graphs("FROM ",v.from.default)+this.graphs("FROM NAMED ",v.from.named)),v.where&&(g+="WHERE "+this.group(v.where,!0)+this._newline),v.updates&&(g+=f(v.updates,";"+this._newline,this.toUpdate,this)),v.group&&(g+="GROUP BY "+f(v.group,void 0,function(b){var _=l(b.expression)?this.toEntity(b.expression):"("+this.toExpression(b.expression)+")";return b.variable?"("+_+" AS "+s(b.variable)+")":_},this)+this._newline),v.having&&(g+="HAVING ("+f(v.having,void 0,this.toExpression,this)+")"+this._newline),v.order&&(g+="ORDER BY "+f(v.order,void 0,function(b){var _="("+this.toExpression(b.expression)+")";return b.descending?"DESC "+_:_},this)+this._newline),v.offset&&(g+="OFFSET "+v.offset+this._newline),v.limit&&(g+="LIMIT "+v.limit+this._newline),v.values&&(g+=this.values(v)),g=this.baseAndPrefixes(v)+g,g.trim()},r.prototype.baseAndPrefixes=function(v){var g=v.base?"BASE <"+v.base+">"+this._newline:"",b="";for(var _ in v.prefixes)(this._options.allPrefixes||this._usedPrefixes[_])&&(b+="PREFIX "+_+": <"+v.prefixes[_]+">"+this._newline);return g+b},r.prototype.toPattern=function(v){var g=v.type||v instanceof Array&&"array"||(v.subject&&v.predicate&&v.object?"triple":"");if(!(g in this))throw new Error("Unknown entry type: "+g);return this[g](v)},r.prototype.triple=function(v){return this.toEntity(v.subject)+" "+this.toEntity(v.predicate)+" "+this.toEntity(v.object)+"."},r.prototype.array=function(v){return f(v,this._newline,this.toPattern,this)},r.prototype.bgp=function(v){return this.encodeTriples(v.triples)},r.prototype.encodeTriples=function(v){if(!v.length)return"";for(var g=[],b=void 0,_=void 0,S=0;S<v.length;S++){var T=v[S];d(T.subject,b)?d(T.predicate,_)?g.push(","):(_=T.predicate,g.push(";"+this._newline,this._indent,this.toEntity(_))):(b&&g.push("."+this._newline),b=T.subject,_=T.predicate,g.push(this.toEntity(b)," ",this.toEntity(_))),g.push(" ",this.toEntity(T.object))}return g.push("."),g.join("")},r.prototype.graph=function(v){return"GRAPH "+this.toEntity(v.name)+" "+this.group(v)},r.prototype.graphs=function(v,g){return!g||g.length===0?"":f(g,"",function(b){return v+this.toEntity(b)+this._newline},this)},r.prototype.group=function(v,g){return v=g!==!0?this.array(v.patterns||v.triples):this.toPattern(v.type!=="group"?v:v.patterns),v.indexOf(this._newline)===-1?"{ "+v+" }":"{"+this._newline+this.indent(v)+this._newline+"}"},r.prototype.query=function(v){return this.toQuery(v)},r.prototype.filter=function(v){return"FILTER("+this.toExpression(v.expression)+")"},r.prototype.bind=function(v){return"BIND("+this.toExpression(v.expression)+" AS "+s(v.variable)+")"},r.prototype.optional=function(v){return"OPTIONAL "+this.group(v)},r.prototype.union=function(v){return f(v.patterns,this._newline+"UNION"+this._newline,function(g){return this.group(g,!0)},this)},r.prototype.minus=function(v){return"MINUS "+this.group(v)},r.prototype.values=function(v){var g=Object.keys(v.values.reduce(function(S,T){for(var w in T)S[w]=!0;return S},{})),b,_;return g.length===1?b=_="":(b="(",_=")"),"VALUES "+b+g.join(" ")+_+" {"+this._newline+f(v.values,this._newline,function(S){return"  "+b+f(g,void 0,function(T){return S[T]?this.toEntity(S[T]):"UNDEF"},this)+_},this)+this._newline+"}"},r.prototype.service=function(v){return"SERVICE "+(v.silent?"SILENT ":"")+this.toEntity(v.name)+" "+this.group(v)},r.prototype.toExpression=function(v){if(l(v))return this.toEntity(v);switch(v.type.toLowerCase()){case"aggregate":return v.aggregation.toUpperCase()+"("+(v.distinct?"DISTINCT ":"")+this.toExpression(v.expression)+(typeof v.separator=="string"?'; SEPARATOR = "'+v.separator.replace(a,o)+'"':"")+")";case"functioncall":return this.toEntity(v.function)+"("+f(v.args,", ",this.toExpression,this)+")";case"operation":var g=v.operator.toUpperCase(),b=v.args||[];switch(v.operator.toLowerCase()){case"<":case">":case">=":case"<=":case"&&":case"||":case"=":case"!=":case"+":case"-":case"*":case"/":return(l(b[0])?this.toEntity(b[0]):"("+this.toExpression(b[0])+")")+" "+g+" "+(l(b[1])?this.toEntity(b[1]):"("+this.toExpression(b[1])+")");case"!":return"!("+this.toExpression(b[0])+")";case"uplus":return"+("+this.toExpression(b[0])+")";case"uminus":return"-("+this.toExpression(b[0])+")";case"notin":g="NOT IN";case"in":return this.toExpression(b[0])+" "+g+"("+(c(b[1])?b[1]:f(b[1],", ",this.toExpression,this))+")";case"notexists":g="NOT EXISTS";case"exists":return g+" "+this.group(b[0],!0);default:return g+"("+f(b,", ",this.toExpression,this)+")"}default:throw new Error("Unknown expression type: "+v.type)}},r.prototype.toEntity=function(v){if(l(v))switch(v.termType){case"Wildcard":return"*";case"Variable":return s(v);case"BlankNode":return"_:"+v.value;case"Literal":var g=v.value||"",b=v.language||"",_=v.datatype;if(v='"'+g.replace(a,o)+'"',b)v+="@"+b;else if(_){if(!this._explicitDatatype)switch(_.value){case t:return v;case n:if(/^\d+$/.test(g))return g+" "}v+="^^"+this.encodeIRI(_.value)}return v;case"Quad":if(!this._sparqlStar)throw new Error("SPARQL* support is not enabled");return v.graph&&v.graph.termType!=="DefaultGraph"?"<< GRAPH "+this.toEntity(v.graph)+" { "+this.toEntity(v.subject)+" "+this.toEntity(v.predicate)+" "+this.toEntity(v.object)+" }  >>":"<< "+this.toEntity(v.subject)+" "+this.toEntity(v.predicate)+" "+this.toEntity(v.object)+" >>";default:return this.encodeIRI(v.value)}else{var S=v.items.map(this.toEntity,this),T=v.pathType;switch(T){case"^":case"!":return T+S[0];case"*":case"+":case"?":return"("+S[0]+T+")";default:return"("+S.join(T)+")"}}};var a=/["\\\t\n\r\b\f]/g,o=function(v){return u[v]},u={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};r.prototype.encodeIRI=function(v){var g=this._prefixRegex.exec(v);if(g){var b=this._prefixByIri[g[1]];return this._usedPrefixes[b]=!0,b+":"+g[2]}return"<"+v+">"},r.prototype.toUpdate=function(v){switch(v.type||v.updateType){case"load":return"LOAD"+(v.source?" "+this.toEntity(v.source):"")+(v.destination?" INTO GRAPH "+this.toEntity(v.destination):"");case"insert":return"INSERT DATA "+this.group(v.insert,!0);case"delete":return"DELETE DATA "+this.group(v.delete,!0);case"deletewhere":return"DELETE WHERE "+this.group(v.delete,!0);case"insertdelete":return(v.graph?"WITH "+this.toEntity(v.graph)+this._newline:"")+(v.delete.length?"DELETE "+this.group(v.delete,!0)+this._newline:"")+(v.insert.length?"INSERT "+this.group(v.insert,!0)+this._newline:"")+(v.using?this.graphs("USING ",v.using.default):"")+(v.using?this.graphs("USING NAMED ",v.using.named):"")+"WHERE "+this.group(v.where,!0);case"add":case"copy":case"move":return v.type.toUpperCase()+" "+(v.silent?"SILENT ":"")+(v.source.default?"DEFAULT":this.toEntity(v.source.name))+" TO "+this.toEntity(v.destination.name);case"create":case"clear":case"drop":return v.type.toUpperCase()+(v.silent?" SILENT ":" ")+(v.graph.default?"DEFAULT":v.graph.named?"NAMED":v.graph.all?"ALL":"GRAPH "+this.toEntity(v.graph.name));default:throw new Error("Unknown update query type: "+v.type)}},r.prototype.indent=function(v){return v.replace(/^/gm,this._indent)};function s(v){return"?"+v.value}function c(v){return typeof v=="string"}function l(v){return typeof v.termType=="string"}function d(v,g){if(!v||!l(v)||!g||!l(g)||v.termType!==g.termType)return!1;switch(v.termType){case"Literal":return v.value===g.value&&v.language===g.language&&d(v.datatype,g.datatype);case"Quad":return d(v.subject,g.subject)&&d(v.predicate,g.predicate)&&d(v.object,g.object)&&d(v.graph,g.graph);default:return v.value===g.value}}function f(v,g,b,_){return v.map(b,_).join(c(g)?g:" ")}function h(v={}){return{stringify:function(g){var b=Object.create(v);return b.prefixes=g.prefixes,new r(b).toQuery(g)},createGenerator:function(){return new r(v)}}}return SparqlGenerator={Generator:h},SparqlGenerator}var sparql$1,hasRequiredSparql$1;function requireSparql$1(){if(hasRequiredSparql$1)return sparql$1;hasRequiredSparql$1=1;const{Parser:n}=requireSparqlParser(),{Generator:t}=requireSparqlGenerator(),{Wildcard:r}=requireWildcard(),{DataFactory:a}=requireRdfDataFactory();function o({prefixes:u,baseIRI:s,factory:c,pathOnly:l,sparqlStar:d,skipValidation:f,skipUngroupedVariableCheck:h}={}){const v={};for(const b in u??{})v[b]=u[b];const g=new n;return g.parse=function(){return n.base=s||"",n.prefixes=Object.create(v),n.factory=c||new a,n.sparqlStar=!!d,n.pathOnly=!!l,n.skipValidation=!!f||!!h,n.prototype.parse.apply(g,arguments)},g._resetBlanks=n._resetBlanks,g}return sparql$1={Parser:o,Generator:t,Wildcard:r},sparql$1}var hasRequiredFactory;function requireFactory(){if(hasRequiredFactory)return factory;hasRequiredFactory=1;var n=factory&&factory.__createBinding||(Object.create?function(l,d,f,h){h===void 0&&(h=f);var v=Object.getOwnPropertyDescriptor(d,f);(!v||("get"in v?!d.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return d[f]}}),Object.defineProperty(l,h,v)}:function(l,d,f,h){h===void 0&&(h=f),l[h]=d[f]}),t=factory&&factory.__setModuleDefault||(Object.create?function(l,d){Object.defineProperty(l,"default",{enumerable:!0,value:d})}:function(l,d){l.default=d}),r=factory&&factory.__importStar||function(l){if(l&&l.__esModule)return l;var d={};if(l!=null)for(var f in l)f!=="default"&&Object.prototype.hasOwnProperty.call(l,f)&&n(d,l,f);return t(d,l),d};Object.defineProperty(factory,"__esModule",{value:!0});const a=r(requireAlgebra()),o=requireRdfDataFactory(),u=requireRdfString(),s=requireSparql$1();class c{constructor(d){this.dataFactory=d||new o.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(d,f=!0){return this.flattenMulti({type:a.types.ALT,input:d},f)}createAsk(d){return{type:a.types.ASK,input:d}}createBoundAggregate(d,f,h,v,g){const b=this.createAggregateExpression(f,h,v,g);return b.variable=d,b}createBgp(d){return{type:a.types.BGP,patterns:d}}createConstruct(d,f){return{type:a.types.CONSTRUCT,input:d,template:f}}createDescribe(d,f){return{type:a.types.DESCRIBE,input:d,terms:f}}createDistinct(d){return{type:a.types.DISTINCT,input:d}}createExtend(d,f,h){return{type:a.types.EXTEND,input:d,variable:f,expression:h}}createFrom(d,f,h){return{type:a.types.FROM,input:d,default:f,named:h}}createFilter(d,f){return{type:a.types.FILTER,input:d,expression:f}}createGraph(d,f){return{type:a.types.GRAPH,input:d,name:f}}createGroup(d,f,h){return{type:a.types.GROUP,input:d,variables:f,aggregates:h}}createInv(d){return{type:a.types.INV,path:d}}createJoin(d,f=!0){return this.flattenMulti({type:a.types.JOIN,input:d},f)}createLeftJoin(d,f,h){return h?{type:a.types.LEFT_JOIN,input:[d,f],expression:h}:{type:a.types.LEFT_JOIN,input:[d,f]}}createLink(d){return{type:a.types.LINK,iri:d}}createMinus(d,f){return{type:a.types.MINUS,input:[d,f]}}createNop(){return{type:a.types.NOP}}createNps(d){return{type:a.types.NPS,iris:d}}createOneOrMorePath(d){return{type:a.types.ONE_OR_MORE_PATH,path:d}}createOrderBy(d,f){return{type:a.types.ORDER_BY,input:d,expressions:f}}createPath(d,f,h,v){return v?{type:a.types.PATH,subject:d,predicate:f,object:h,graph:v}:{type:a.types.PATH,subject:d,predicate:f,object:h,graph:this.dataFactory.defaultGraph()}}createPattern(d,f,h,v){const g=this.dataFactory.quad(d,f,h,v);return g.type=a.types.PATTERN,g}createProject(d,f){return{type:a.types.PROJECT,input:d,variables:f}}createReduced(d){return{type:a.types.REDUCED,input:d}}createSeq(d,f=!0){return this.flattenMulti({type:a.types.SEQ,input:d},f)}createService(d,f,h){return{type:a.types.SERVICE,input:d,name:f,silent:!!h}}createSlice(d,f,h){return f=f||0,h!==void 0?{type:a.types.SLICE,input:d,start:f,length:h}:{type:a.types.SLICE,input:d,start:f}}createUnion(d,f=!0){return this.flattenMulti({type:a.types.UNION,input:d},f)}createValues(d,f){return{type:a.types.VALUES,variables:d,bindings:f}}createZeroOrMorePath(d){return{type:a.types.ZERO_OR_MORE_PATH,path:d}}createZeroOrOnePath(d){return{type:a.types.ZERO_OR_ONE_PATH,path:d}}createAggregateExpression(d,f,h,v){return v?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:d,expression:f,separator:v,distinct:h}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:d,expression:f,distinct:h}}createExistenceExpression(d,f){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:d,input:f}}createNamedExpression(d,f){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:d,args:f}}createOperatorExpression(d,f){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:d,args:f}}createTermExpression(d){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:d}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new s.Wildcard}}createTerm(d){return d[0]==="$"&&(d=d.replace("$","?")),(0,u.stringToTerm)(d,this.dataFactory)}createCompositeUpdate(d){return{type:a.types.COMPOSITE_UPDATE,updates:d}}createDeleteInsert(d,f,h){const v={type:a.types.DELETE_INSERT};return d&&(v.delete=d),f&&(v.insert=f),h&&(v.where=h),v}createLoad(d,f,h){const v={type:a.types.LOAD,source:d};return f&&(v.destination=f),this.addSilent(v,!!h)}createClear(d,f){return this.addSilent({type:a.types.CLEAR,source:d},!!f)}createCreate(d,f){return this.addSilent({type:a.types.CREATE,source:d},!!f)}createDrop(d,f){return this.addSilent({type:a.types.DROP,source:d},!!f)}createAdd(d,f,h){return this.addSilent({type:a.types.ADD,source:d,destination:f},!!h)}createMove(d,f,h){return this.addSilent({type:a.types.MOVE,source:d,destination:f},!!h)}createCopy(d,f,h){return this.addSilent({type:a.types.COPY,source:d,destination:f},!!h)}addSilent(d,f){return f&&(d.silent=f),d}flattenMulti(d,f){if(!f)return d;const h=d.type,v=d.input;let g=[];for(const b of v)b.type===h?g.push(...b.input):g.push(b);return d.input=g,d}}return factory.default=c,factory}var util$1={},rdfTerms={},QuadTermUtil={},hasRequiredQuadTermUtil;function requireQuadTermUtil(){if(hasRequiredQuadTermUtil)return QuadTermUtil;hasRequiredQuadTermUtil=1,Object.defineProperty(QuadTermUtil,"__esModule",{value:!0}),QuadTermUtil.matchPatternMappings=QuadTermUtil.matchPatternComplete=QuadTermUtil.matchPattern=QuadTermUtil.matchTerm=QuadTermUtil.getValueNestedPath=QuadTermUtil.someTermsNested=QuadTermUtil.someTerms=QuadTermUtil.everyTermsNested=QuadTermUtil.everyTerms=QuadTermUtil.reduceTermsNested=QuadTermUtil.reduceTerms=QuadTermUtil.mapTermsNested=QuadTermUtil.mapTerms=QuadTermUtil.filterQuadTermNamesNested=QuadTermUtil.filterQuadTermNames=QuadTermUtil.filterTermsNested=QuadTermUtil.filterTerms=QuadTermUtil.forEachTermsNested=QuadTermUtil.forEachTerms=QuadTermUtil.collectNamedTerms=QuadTermUtil.getNamedTerms=QuadTermUtil.getTermsNested=QuadTermUtil.getTerms=QuadTermUtil.TRIPLE_TERM_NAMES=QuadTermUtil.QUAD_TERM_NAMES=void 0;const n=requireRdfDataFactory(),t=new n.DataFactory;QuadTermUtil.QUAD_TERM_NAMES=["subject","predicate","object","graph"],QuadTermUtil.TRIPLE_TERM_NAMES=["subject","predicate","object"];function r(D,$){return $&&D.graph.termType==="DefaultGraph"?[D.subject,D.predicate,D.object]:[D.subject,D.predicate,D.object,D.graph]}QuadTermUtil.getTerms=r;function a(D,$){const O=[];for(const P of r(D,$))P.termType==="Quad"?a(P,$).forEach(C=>O.push(C)):O.push(P);return O}QuadTermUtil.getTermsNested=a;function o(D){return[{key:"subject",value:D.subject},{key:"predicate",value:D.predicate},{key:"object",value:D.object},{key:"graph",value:D.graph}]}QuadTermUtil.getNamedTerms=o;function u(D,$,O){const P={};return D.forEach(C=>P[C.key]=C.value),$&&(P.subject=P.subject||$("subject"),P.predicate=P.predicate||$("predicate"),P.object=P.object||$("object"),P.graph=P.graph||$("graph")),(O||t).quad(P.subject,P.predicate,P.object,P.graph)}QuadTermUtil.collectNamedTerms=u;function s(D,$){$(D.subject,"subject"),$(D.predicate,"predicate"),$(D.object,"object"),$(D.graph,"graph")}QuadTermUtil.forEachTerms=s;function c(D,$,O=[]){D.subject.termType==="Quad"?c(D.subject,$,[...O,"subject"]):$(D.subject,[...O,"subject"]),D.predicate.termType==="Quad"?c(D.predicate,$,[...O,"predicate"]):$(D.predicate,[...O,"predicate"]),D.object.termType==="Quad"?c(D.object,$,[...O,"object"]):$(D.object,[...O,"object"]),D.graph.termType==="Quad"?c(D.graph,$,[...O,"graph"]):$(D.graph,[...O,"graph"])}QuadTermUtil.forEachTermsNested=c;function l(D,$){const O=[];return $(D.subject,"subject")&&O.push(D.subject),$(D.predicate,"predicate")&&O.push(D.predicate),$(D.object,"object")&&O.push(D.object),$(D.graph,"graph")&&O.push(D.graph),O}QuadTermUtil.filterTerms=l;function d(D,$,O=[]){let P=[];return D.subject.termType==="Quad"?P=[...P,...d(D.subject,$,[...O,"subject"])]:$(D.subject,[...O,"subject"])&&P.push(D.subject),D.predicate.termType==="Quad"?P=[...P,...d(D.predicate,$,[...O,"predicate"])]:$(D.predicate,[...O,"predicate"])&&P.push(D.predicate),D.object.termType==="Quad"?P=[...P,...d(D.object,$,[...O,"object"])]:$(D.object,[...O,"object"])&&P.push(D.object),D.graph.termType==="Quad"?P=[...P,...d(D.graph,$,[...O,"graph"])]:$(D.graph,[...O,"graph"])&&P.push(D.graph),P}QuadTermUtil.filterTermsNested=d;function f(D,$){const O=[];return $(D.subject,"subject")&&O.push("subject"),$(D.predicate,"predicate")&&O.push("predicate"),$(D.object,"object")&&O.push("object"),$(D.graph,"graph")&&O.push("graph"),O}QuadTermUtil.filterQuadTermNames=f;function h(D,$,O=[]){let P=[];const C=[...O,"subject"];D.subject.termType==="Quad"?P=[...P,...h(D.subject,$,C)]:$(D.subject,C)&&P.push(C);const q=[...O,"predicate"];D.predicate.termType==="Quad"?P=[...P,...h(D.predicate,$,q)]:$(D.predicate,q)&&P.push(q);const M=[...O,"object"];D.object.termType==="Quad"?P=[...P,...h(D.object,$,M)]:$(D.object,M)&&P.push(M);const N=[...O,"graph"];return D.graph.termType==="Quad"?P=[...P,...h(D.graph,$,N)]:$(D.graph,N)&&P.push(N),P}QuadTermUtil.filterQuadTermNamesNested=h;function v(D,$,O){return(O||t).quad($(D.subject,"subject"),$(D.predicate,"predicate"),$(D.object,"object"),$(D.graph,"graph"))}QuadTermUtil.mapTerms=v;function g(D,$,O,P=[]){return(O||t).quad(D.subject.termType==="Quad"?g(D.subject,$,O,[...P,"subject"]):$(D.subject,[...P,"subject"]),D.predicate.termType==="Quad"?g(D.predicate,$,O,[...P,"predicate"]):$(D.predicate,[...P,"predicate"]),D.object.termType==="Quad"?g(D.object,$,O,[...P,"object"]):$(D.object,[...P,"object"]),D.graph.termType==="Quad"?g(D.graph,$,O,[...P,"graph"]):$(D.graph,[...P,"graph"]))}QuadTermUtil.mapTermsNested=g;function b(D,$,O){let P=O;return P=$(P,D.subject,"subject"),P=$(P,D.predicate,"predicate"),P=$(P,D.object,"object"),$(P,D.graph,"graph")}QuadTermUtil.reduceTerms=b;function _(D,$,O,P=[]){let C=O;return D.subject.termType==="Quad"?C=_(D.subject,$,C,[...P,"subject"]):C=$(C,D.subject,[...P,"subject"]),D.predicate.termType==="Quad"?C=_(D.predicate,$,C,[...P,"predicate"]):C=$(C,D.predicate,[...P,"predicate"]),D.object.termType==="Quad"?C=_(D.object,$,C,[...P,"object"]):C=$(C,D.object,[...P,"object"]),D.graph.termType==="Quad"?C=_(D.graph,$,C,[...P,"graph"]):C=$(C,D.graph,[...P,"graph"]),C}QuadTermUtil.reduceTermsNested=_;function S(D,$){return $(D.subject,"subject")&&$(D.predicate,"predicate")&&$(D.object,"object")&&$(D.graph,"graph")}QuadTermUtil.everyTerms=S;function T(D,$,O=[]){return(D.subject.termType==="Quad"?T(D.subject,$,[...O,"subject"]):$(D.subject,[...O,"subject"]))&&(D.predicate.termType==="Quad"?T(D.predicate,$,[...O,"predicate"]):$(D.predicate,[...O,"predicate"]))&&(D.object.termType==="Quad"?T(D.object,$,[...O,"object"]):$(D.object,[...O,"object"]))&&(D.graph.termType==="Quad"?T(D.graph,$,[...O,"graph"]):$(D.graph,[...O,"graph"]))}QuadTermUtil.everyTermsNested=T;function w(D,$){return $(D.subject,"subject")||$(D.predicate,"predicate")||$(D.object,"object")||$(D.graph,"graph")}QuadTermUtil.someTerms=w;function A(D,$,O=[]){return(D.subject.termType==="Quad"?A(D.subject,$,[...O,"subject"]):$(D.subject,[...O,"subject"]))||(D.predicate.termType==="Quad"?A(D.predicate,$,[...O,"predicate"]):$(D.predicate,[...O,"predicate"]))||(D.object.termType==="Quad"?A(D.object,$,[...O,"object"]):$(D.object,[...O,"object"]))||(D.graph.termType==="Quad"?A(D.graph,$,[...O,"graph"]):$(D.graph,[...O,"graph"]))}QuadTermUtil.someTermsNested=A;function R(D,$){if($.length===0)return D;if(D.termType==="Quad")return R(D[$[0]],$.slice(1));throw new Error(`Tried to get ${$[0]} from term of type ${D.termType}`)}QuadTermUtil.getValueNestedPath=R;function E(D,$){return!$||$.termType==="Variable"||$.termType==="Quad"&&D.termType==="Quad"&&L(D,$)||$.equals(D)}QuadTermUtil.matchTerm=E;function I(D,$,O,P,C){return E(D.subject,$)&&E(D.predicate,O)&&E(D.object,P)&&E(D.graph,C)}QuadTermUtil.matchPattern=I;function L(D,$){return I(D,$.subject,$.predicate,$.object,$.graph)}QuadTermUtil.matchPatternComplete=L;function F(D,$,O={}){const P={};function C(q,M){return S(q,(N,G)=>{var X,Y;const W=M[G];switch(N.termType){case"Variable":return O.skipVarMapping&&W.termType==="Variable"||((Y=(X=P[N.value])===null||X===void 0?void 0:X.equals(W))!==null&&Y!==void 0?Y:(P[N.value]=W,!0));case"Quad":return W.termType==="Quad"&&C(N,W);default:return N.equals(W)}})}return C($,D)&&(O.returnMappings?P:!0)}return QuadTermUtil.matchPatternMappings=F,QuadTermUtil}var TermUtil$1={},hasRequiredTermUtil$1;function requireTermUtil$1(){if(hasRequiredTermUtil$1)return TermUtil$1;hasRequiredTermUtil$1=1,Object.defineProperty(TermUtil$1,"__esModule",{value:!0}),TermUtil$1.getQuads=TermUtil$1.getDefaultGraphs=TermUtil$1.getVariables=TermUtil$1.getLiterals=TermUtil$1.getBlankNodes=TermUtil$1.getNamedNodes=TermUtil$1.getTermsOfType=TermUtil$1.uniqTerms=TermUtil$1.TERM_TYPES=void 0;const n=requireRdfString();TermUtil$1.TERM_TYPES=["NamedNode","BlankNode","Literal","Variable","DefaultGraph","Quad"];function t(d){const f={};return d.filter(h=>{const v=(0,n.termToString)(h);return!(v in f)&&(f[v]=!0)})}TermUtil$1.uniqTerms=t;function r(d,f){return d.filter(h=>h.termType===f)}TermUtil$1.getTermsOfType=r;function a(d){return r(d,"NamedNode")}TermUtil$1.getNamedNodes=a;function o(d){return r(d,"BlankNode")}TermUtil$1.getBlankNodes=o;function u(d){return r(d,"Literal")}TermUtil$1.getLiterals=u;function s(d){return r(d,"Variable")}TermUtil$1.getVariables=s;function c(d){return r(d,"DefaultGraph")}TermUtil$1.getDefaultGraphs=c;function l(d){return r(d,"Quad")}return TermUtil$1.getQuads=l,TermUtil$1}var hasRequiredRdfTerms;function requireRdfTerms(){return hasRequiredRdfTerms||(hasRequiredRdfTerms=1,function(n){var t=rdfTerms&&rdfTerms.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfTerms&&rdfTerms.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireQuadTermUtil(),n),r(requireTermUtil$1(),n)}(rdfTerms)),rdfTerms}var hasRequiredUtil$a;function requireUtil$a(){if(hasRequiredUtil$a)return util$1;hasRequiredUtil$a=1;var n=util$1&&util$1.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(util$1,"__esModule",{value:!0});const t=requireAlgebra(),r=n(requireFactory()),a=requireRdfTerms();class o{static flatten(s){return Array.prototype.concat(...s).filter(c=>c)}static objectify(s){if(s.termType){if(s.termType==="Quad")return{type:"pattern",termType:"Quad",subject:o.objectify(s.subject),predicate:o.objectify(s.predicate),object:o.objectify(s.object),graph:o.objectify(s.graph)};{let c={termType:s.termType,value:s.value};return s.language&&(c.language=s.language),s.datatype&&(c.datatype=o.objectify(s.datatype)),c}}if(Array.isArray(s))return s.map(c=>o.objectify(c));if(s===Object(s)){let c={};for(let l of Object.keys(s))c[l]=o.objectify(s[l]);return c}return s}static inScopeVariables(s){const c=[];function l(f){c.find(h=>f.value===h.value)||c.push(f)}function d(f){f.subject.termType==="Variable"&&l(f.subject),f.predicate.termType==="Variable"&&l(f.predicate),f.object.termType==="Variable"&&l(f.object),f.graph.termType==="Variable"&&l(f.graph),f.subject.termType==="Quad"&&d(f.subject),f.predicate.termType==="Quad"&&d(f.predicate),f.object.termType==="Quad"&&d(f.object),f.graph.termType==="Quad"&&d(f.graph)}return o.recurseOperation(s,{[t.types.EXPRESSION]:f=>(f.expressionType===t.expressionTypes.AGGREGATE&&f.variable&&l(f.variable),!0),[t.types.EXTEND]:f=>(l(f.variable),!0),[t.types.GRAPH]:f=>(f.name.termType==="Variable"&&l(f.name),!0),[t.types.GROUP]:f=>(f.variables.forEach(l),!0),[t.types.PATH]:f=>(f.subject.termType==="Variable"&&l(f.subject),f.object.termType==="Variable"&&l(f.object),f.graph.termType==="Variable"&&l(f.graph),f.subject.termType==="Quad"&&d(f.subject),f.object.termType==="Quad"&&d(f.object),f.graph.termType==="Quad"&&d(f.graph),!0),[t.types.PATTERN]:f=>(d(f),!0),[t.types.PROJECT]:f=>(f.variables.forEach(l),!1),[t.types.SERVICE]:f=>(f.name.termType==="Variable"&&l(f.name),!0),[t.types.VALUES]:f=>(f.variables.forEach(l),!0)}),c}static recurseOperation(s,c){let l=s,d=!0;const f=c[s.type];if(f&&(d=f(s)),!d)return;let h=v=>o.recurseOperation(v,c);switch(l.type){case t.types.ALT:l.input.map(h);break;case t.types.ASK:h(l.input);break;case t.types.BGP:l.patterns.forEach(h);break;case t.types.CONSTRUCT:h(l.input),l.template.map(h);break;case t.types.DESCRIBE:h(l.input);break;case t.types.DISTINCT:h(l.input);break;case t.types.EXPRESSION:l.expressionType===t.expressionTypes.EXISTENCE&&h(l.input);break;case t.types.EXTEND:h(l.input),h(l.expression);break;case t.types.FILTER:h(l.input),h(l.expression);break;case t.types.FROM:h(l.input);break;case t.types.GRAPH:h(l.input);break;case t.types.GROUP:h(l.input),l.aggregates.forEach(h);break;case t.types.INV:h(l.path);break;case t.types.JOIN:l.input.map(h);break;case t.types.LEFT_JOIN:l.input.map(h),l.expression&&h(l.expression);break;case t.types.LINK:break;case t.types.MINUS:l.input.map(h);break;case t.types.NOP:break;case t.types.NPS:break;case t.types.ONE_OR_MORE_PATH:h(l.path);break;case t.types.ORDER_BY:h(l.input),l.expressions.forEach(h);break;case t.types.PATH:h(l.predicate);break;case t.types.PATTERN:break;case t.types.PROJECT:h(l.input);break;case t.types.REDUCED:h(l.input);break;case t.types.SEQ:l.input.map(h);break;case t.types.SERVICE:h(l.input);break;case t.types.SLICE:h(l.input);break;case t.types.UNION:l.input.map(h);break;case t.types.VALUES:break;case t.types.ZERO_OR_MORE_PATH:h(l.path);break;case t.types.ZERO_OR_ONE_PATH:h(l.path);break;case t.types.COMPOSITE_UPDATE:l.updates.forEach(v=>h(v));break;case t.types.DELETE_INSERT:l.delete&&l.delete.forEach(v=>h(v)),l.insert&&l.insert.forEach(v=>h(v)),l.where&&h(l.where);break;case t.types.LOAD:break;case t.types.CLEAR:break;case t.types.CREATE:break;case t.types.DROP:break;case t.types.ADD:break;case t.types.MOVE:break;case t.types.COPY:break;default:throw new Error(`Unknown Operation type ${l.type}`)}}static mapOperation(s,c,l){let d=s,f=!0,h=!0;l=l||new r.default;const v=c[s.type];if(v){const _=v(s,l);d=_.result,f=_.recurse,h=_.copyMetadata!==!1}let g;if(h&&(d.metadata||s.metadata)&&(g={...d.metadata,...s.metadata}),!f)return g&&(d.metadata=g),d;let b=_=>o.mapOperation(_,c,l);switch(d.type){case t.types.ALT:d=l.createAlt(d.input.map(b));break;case t.types.ASK:d=l.createAsk(b(d.input));break;case t.types.BGP:d=l.createBgp(d.patterns.map(b));break;case t.types.CONSTRUCT:d=l.createConstruct(b(d.input),d.template.map(b));break;case t.types.DESCRIBE:d=l.createDescribe(b(d.input),d.terms);break;case t.types.DISTINCT:d=l.createDistinct(b(d.input));break;case t.types.EXPRESSION:d=o.mapExpression(d,c,l);break;case t.types.EXTEND:d=l.createExtend(b(d.input),d.variable,b(d.expression));break;case t.types.FILTER:d=l.createFilter(b(d.input),b(d.expression));break;case t.types.FROM:d=l.createFrom(b(d.input),[...d.default],[...d.named]);break;case t.types.GRAPH:d=l.createGraph(b(d.input),d.name);break;case t.types.GROUP:d=l.createGroup(b(d.input),[].concat(d.variables),d.aggregates.map(b));break;case t.types.INV:d=l.createInv(b(d.path));break;case t.types.JOIN:d=l.createJoin(d.input.map(b));break;case t.types.LEFT_JOIN:d=l.createLeftJoin(b(d.input[0]),b(d.input[1]),d.expression?b(d.expression):void 0);break;case t.types.LINK:d=l.createLink(d.iri);break;case t.types.MINUS:d=l.createMinus(b(d.input[0]),b(d.input[1]));break;case t.types.NOP:d=l.createNop();break;case t.types.NPS:d=l.createNps([].concat(d.iris));break;case t.types.ONE_OR_MORE_PATH:d=l.createOneOrMorePath(b(d.path));break;case t.types.ORDER_BY:d=l.createOrderBy(b(d.input),d.expressions.map(b));break;case t.types.PATH:d=l.createPath(d.subject,b(d.predicate),d.object,d.graph);break;case t.types.PATTERN:d=l.createPattern(d.subject,d.predicate,d.object,d.graph);break;case t.types.PROJECT:d=l.createProject(b(d.input),[...d.variables]);break;case t.types.REDUCED:d=l.createReduced(b(d.input));break;case t.types.SEQ:d=l.createSeq(d.input.map(b));break;case t.types.SERVICE:d=l.createService(b(d.input),d.name,d.silent);break;case t.types.SLICE:d=l.createSlice(b(d.input),d.start,d.length);break;case t.types.UNION:d=l.createUnion(d.input.map(b));break;case t.types.VALUES:d=l.createValues([].concat(d.variables),d.bindings.map(_=>Object.assign({},_)));break;case t.types.ZERO_OR_MORE_PATH:d=l.createZeroOrMorePath(b(d.path));break;case t.types.ZERO_OR_ONE_PATH:d=l.createZeroOrOnePath(b(d.path));break;case t.types.COMPOSITE_UPDATE:d=l.createCompositeUpdate(d.updates.map(b));break;case t.types.DELETE_INSERT:d=l.createDeleteInsert(d.delete?d.delete.map(b):void 0,d.insert?d.insert.map(b):void 0,d.where?b(d.where):void 0);break;case t.types.LOAD:d=l.createLoad(d.source,d.destination,d.silent);break;case t.types.CLEAR:d=l.createClear(d.source,d.silent);break;case t.types.CREATE:d=l.createCreate(d.source,d.silent);break;case t.types.DROP:d=l.createDrop(d.source,d.silent);break;case t.types.ADD:d=l.createAdd(d.source,d.destination);break;case t.types.MOVE:d=l.createMove(d.source,d.destination);break;case t.types.COPY:d=l.createCopy(d.source,d.destination);break;default:throw new Error(`Unknown Operation type ${d.type}`)}return g&&(d.metadata=g),d}static mapExpression(s,c,l){let d=s,f=!0;l=l||new r.default;const h=c[s.expressionType];if(h&&({result:d,recurse:f}=h(s,l)),!f)return d;let v=g=>o.mapOperation(g,c,l);switch(s.expressionType){case t.expressionTypes.AGGREGATE:return s.variable?l.createBoundAggregate(s.variable,s.aggregator,v(s.expression),s.distinct,s.separator):l.createAggregateExpression(s.aggregator,v(s.expression),s.distinct,s.separator);case t.expressionTypes.EXISTENCE:return l.createExistenceExpression(s.not,v(s.input));case t.expressionTypes.NAMED:return l.createNamedExpression(s.name,s.args.map(v));case t.expressionTypes.OPERATOR:return l.createOperatorExpression(s.operator,s.args.map(v));case t.expressionTypes.TERM:return l.createTermExpression(s.term);case t.expressionTypes.WILDCARD:return l.createWildcardExpression();default:throw new Error(`Unknown Expression type ${s.expressionType}`)}}static cloneOperation(s){return o.mapOperation(s,{})}static cloneExpression(s){return o.mapExpression(s,{})}static createUniqueVariable(s,c,l){let d=0,f=s;for(;c[f];)f=`${s}${d++}`;return l.variable(f)}static isSimpleTerm(s){return s.termType!==void 0&&s.termType!=="Quad"&&s.termType!=="Wildcard"}static isQuad(s){return s.termType==="Quad"}static hasQuadVariables(s){return(0,a.someTermsNested)(s,c=>c.termType==="Variable")}static isWildcard(s){return s.termType==="Wildcard"}}return util$1.default=o,util$1}var hasRequiredSparqlAlgebra;function requireSparqlAlgebra(){if(hasRequiredSparqlAlgebra)return sparqlAlgebra;hasRequiredSparqlAlgebra=1;var n=sparqlAlgebra&&sparqlAlgebra.__createBinding||(Object.create?function(j,z,B,U){U===void 0&&(U=B);var Z=Object.getOwnPropertyDescriptor(z,B);(!Z||("get"in Z?!z.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return z[B]}}),Object.defineProperty(j,U,Z)}:function(j,z,B,U){U===void 0&&(U=B),j[U]=z[B]}),t=sparqlAlgebra&&sparqlAlgebra.__setModuleDefault||(Object.create?function(j,z){Object.defineProperty(j,"default",{enumerable:!0,value:z})}:function(j,z){j.default=z}),r=sparqlAlgebra&&sparqlAlgebra.__importStar||function(j){if(j&&j.__esModule)return j;var z={};if(j!=null)for(var B in j)B!=="default"&&Object.prototype.hasOwnProperty.call(j,B)&&n(z,j,B);return t(z,j),z},a=sparqlAlgebra&&sparqlAlgebra.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(sparqlAlgebra,"__esModule",{value:!0});const o=requireEs6(),u=requireRdfString(),s=r(requireAlgebra()),c=a(requireFactory()),l=a(requireUtil$a()),d=requireSparql$1().Parser,f=s.types;let h=new Set,v=0,g=!1,b;function _(j,z){z=z||{},b=new c.default(z.dataFactory);let B;if(T(j)){let U=new d(z);U._resetBlanks(),B=U.parse(j)}else B=j;return S(B,z.quads,z.blankToVariable)}sparqlAlgebra.default=_;function S(j,z,B){if(h=new Set,v=0,g=!!z,!j.type)return b.createNop();if(j.type!=="query"&&j.type!=="update")throw new Error("Translate only works on complete query or update objects.");let U;if(E(j),j.type==="query"){const Z={type:"group",patterns:j.where||[]};U=L(Z),U=W(j,U)}else j.type==="update"&&(U=fe(j));return B&&(U=J(U)),U}function T(j){return typeof j=="string"}function w(j){return!!(j!=null&&j.termType)}function A(j){return j.subject&&j.predicate&&j.object}function R(j){return(j==null?void 0:j.termType)==="Variable"}function E(j){if(w(j))R(j)&&h.add(`?${j.value}`);else if(Array.isArray(j))for(const z of j)E(z);else if(j&&typeof j=="object")for(let z of Object.keys(j))z.startsWith("?")?h.add(z):z.startsWith("$")&&h.add(`?${z.slice(1)}`),E(j[z])}function I(j){let z={};if(A(j)){const B=[I(j.subject),I(j.predicate),I(j.object),j.graph?I(j.graph):{}];Object.assign(z,...B)}else if(w(j))R(j)&&(z[j.value]=j);else if(j.type==="bgp"){const B=j.triples;Object.assign(z,...B.map(I))}else if(j.type==="path")Object.assign(z,...j.items.map(I));else if(j.type==="group"||j.type==="union"||j.type==="optional")Object.assign(z,...j.patterns.map(I));else if(j.type==="service"||j.type==="graph")Object.assign(z,I(j.name)),Object.assign(z,...j.patterns.map(I));else if(j.type==="bind")Object.assign(z,I(j.variable));else if(j.type==="values"){if(j.values.length>0){const B=Object.keys(j.values[0]).map(U=>b.createTerm(U));Object.assign(z,...B.map(I))}}else if(j.type==="query"&&(j.queryType==="SELECT"||j.queryType==="DESCRIBE")){j.where&&j.variables.some(l.default.isWildcard)&&Object.assign(z,...j.where.map(I));for(const B of j.variables)R(B)?Object.assign(z,I(B)):B.variable&&Object.assign(z,I(B.variable));if(j.queryType==="SELECT"){if(j.group)for(const B of j.group)B.variable&&Object.assign(z,I(B.variable));if(j.values){const B={type:"values",values:j.values};Object.assign(z,I(B))}}}return z}function L(j){if(j.type==="bgp")return D(j);if(j.type==="union")return b.createUnion(j.patterns.map(z=>(z.type!=="group"&&(z={type:"group",patterns:[z]}),L(z))));if(j.type==="graph"){const z={type:"group",patterns:j.patterns};let B=L(z);return g?B=N(B,j.name):B=b.createGraph(B,j.name),B}if(j.type==="values")return Y(j);if(j.type==="query")return S(j,g,!1);if(j.type==="group"){let z=[],B=[];for(let oe of j.patterns)(oe.type==="filter"?z:B).push(oe);let U=B.reduce(G,b.createBgp([])),Z=z.map(oe=>F(oe.expression));return Z.length>0&&(U=b.createFilter(U,Z.reduce((oe,ie)=>b.createOperatorExpression("&&",[oe,ie])))),U}throw new Error(`Unexpected type: ${j.type}`)}function F(j){if(l.default.isSimpleTerm(j))return b.createTermExpression(j);if(l.default.isQuad(j))return l.default.hasQuadVariables(j)?b.createOperatorExpression("triple",[F(j.subject),F(j.predicate),F(j.object)]):b.createTermExpression(j);if(l.default.isWildcard(j))return b.createWildcardExpression();if("aggregation"in j)return b.createAggregateExpression(j.aggregation,F(j.expression),!!j.distinct,j.separator);if("function"in j)return b.createNamedExpression(j.function,j.args.map(F));if("operator"in j)return j.operator==="exists"||j.operator==="notexists"?b.createExistenceExpression(j.operator==="notexists",L(j.args[0])):((j.operator==="in"||j.operator==="notin")&&(j.args=[j.args[0]].concat(j.args[1])),b.createOperatorExpression(j.operator,j.args.map(F)));throw new Error(`Unknown expression: ${JSON.stringify(j)}`)}function D(j){let z=[],B=[];for(let U of j.triples)if("pathType"in U.predicate){let Z=$(U);for(let oe of Z)oe.type===f.PATH?(z.length>0&&B.push(b.createBgp(z)),z=[],B.push(oe)):z.push(oe)}else z.push(q(U));return z.length>0&&B.push(b.createBgp(z)),B.length===1?B[0]:b.createJoin(B)}function $(j){let z=j.subject,B=O(j.predicate),U=j.object;return P(z,B,U)}function O(j){if(l.default.isSimpleTerm(j)){if(j.termType==="NamedNode")return b.createLink(j);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(j)}`)}if(j.pathType==="^")return b.createInv(O(j.items[0]));if(j.pathType==="!"){let z=[],B=[],U;"pathType"in j.items[0]&&j.items[0].pathType==="|"?U=j.items[0].items:U=j.items;for(let ie of U)if(l.default.isSimpleTerm(ie))z.push(ie);else if(ie.pathType==="^")B.push(ie.items[0]);else throw new Error(`Unexpected item: ${JSON.stringify(ie)}`);let Z=b.createNps(z),oe=b.createInv(b.createNps(B));return B.length===0?Z:z.length===0?oe:b.createAlt([Z,oe])}if(j.pathType==="/")return b.createSeq(j.items.map(O));if(j.pathType==="|")return b.createAlt(j.items.map(O));if(j.pathType==="*")return b.createZeroOrMorePath(O(j.items[0]));if(j.pathType==="+")return b.createOneOrMorePath(O(j.items[0]));if(j.pathType==="?")return b.createZeroOrOnePath(O(j.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(j)}`)}function P(j,z,B){if(z.type===f.LINK)return[b.createPattern(j,z.iri,B)];if(z.type===f.INV)return P(B,z.path,j);if(z.type===f.SEQ){let U=j;return l.default.flatten(z.input.map((Z,oe)=>{const ie=oe===z.input.length-1?B:C(),se=P(U,Z,ie);return ie.termType==="Variable"&&(U=ie),se}))}return[b.createPath(j,z,B)]}function C(){let j=`?var${v++}`;return h.has(j)?C():(h.add(j),b.createTerm(j))}function q(j){if("pathType"in j.predicate)throw new Error("Trying to translate property path to quad.");return b.createPattern(j.subject,j.predicate,j.object,j.graph)}let M=Object.values(f);function N(j,z,B){if(j.type===f.GRAPH){if(B)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");j=N(j.input,j.name)}else if(j.type!==f.SERVICE)if(j.type===f.BGP)j.patterns=j.patterns.map(U=>(B&&(U.subject.equals(z)&&(U.subject=B),U.predicate.equals(z)&&(U.predicate=B),U.object.equals(z)&&(U.object=B)),U.graph.termType==="DefaultGraph"&&(U.graph=z),U));else if(j.type===f.PATH)B&&(j.subject.equals(z)&&(j.subject=B),j.object.equals(z)&&(j.object=B)),j.graph.termType==="DefaultGraph"&&(j.graph=z);else if(j.type===f.PROJECT&&!B)j.variables.some(U=>U.equals(z))||(B=C()),j.input=N(j.input,z,B);else if(j.type===f.EXTEND&&!B)j.variable.equals(z)&&(B=C()),j.input=N(j.input,z,B);else for(let U of Object.keys(j))Array.isArray(j[U])?j[U]=j[U].map(Z=>N(Z,z,B)):M.indexOf(j[U].type)>=0?j[U]=N(j[U],z,B):B&&R(j[U])&&j[U].equals(z)&&(j[U]=B);return j}function G(j,z){if(z.type==="optional"){const B=L({type:"group",patterns:z.patterns});B.type===f.FILTER?j=b.createLeftJoin(j,B.input,B.expression):j=b.createLeftJoin(j,B)}else if(z.type==="minus"){const B=L({type:"group",patterns:z.patterns});j=b.createMinus(j,B)}else if(z.type==="bind")j=b.createExtend(j,z.variable,F(z.expression));else if(z.type==="service"){const B={type:"group",patterns:z.patterns},U=b.createService(L(B),z.name,z.silent);j=X(j,U)}else{const B=L(z);j=X(j,B)}return j}function X(j,z){return j.type===f.BGP&&z.type===f.BGP?j=b.createBgp([...j.patterns,...z.patterns]):j.type===f.BGP&&j.patterns.length===0?j=z:z.type===f.BGP&&z.patterns.length===0||(j=b.createJoin([j,z])),j}function Y(j){let z=(j.values.length===0?[]:Object.keys(j.values[0])).map(b.createTerm.bind(b)),B=j.values.map(U=>{let Z=Object.keys(U);Z=Z.filter(ie=>U[ie]!==void 0);let oe={};for(let ie of Z)oe[ie]=U[ie];return oe});return b.createValues(z,B)}function W(j,z){const B=j,U=[],Z={};if(B.variables=B.variables&&B.variables.map(ie=>te(ie,Z)),B.having=B.having&&B.having.map(ie=>te(ie,Z)),B.order=B.order&&B.order.map(ie=>te(ie,Z)),B.group||Object.keys(Z).length>0){const ie=Object.keys(Z).map(ne=>ue(Z[ne],b.createTerm(ne))),se=[];if(B.group)for(const ne of B.group)if(l.default.isSimpleTerm(ne.expression))se.push(ne.expression);else{const he="variable"in ne?ne.variable:C();z=b.createExtend(z,he,F(ne.expression)),se.push(he)}z=b.createGroup(z,se,ie)}if(B.having)for(let ie of B.having)z=b.createFilter(z,F(ie));j.values&&(z=b.createJoin([z,Y(j)]));let oe=[];if(j.queryType==="SELECT"||j.queryType==="DESCRIBE")if(j.variables.some(ie=>ie&&l.default.isWildcard(ie)))oe=Object.values(I(j)).sort((ie,se)=>ie.value.localeCompare(se.value));else for(let ie of j.variables)R(ie)||!("variable"in ie)?oe.push(ie):ie.variable&&(oe.push(ie.variable),U.push(ie));for(let ie of U)z=b.createExtend(z,ie.variable,F(ie.expression));return B.order&&(z=b.createOrderBy(z,B.order.map(ie=>{let se=F(ie.expression);return ie.descending&&(se=b.createOperatorExpression("desc",[se])),se}))),j.queryType==="SELECT"&&(z=b.createProject(z,oe)),B.distinct&&(z=b.createDistinct(z)),B.reduced&&(z=b.createReduced(z)),j.queryType==="CONSTRUCT"?z=b.createConstruct(z,(j.template||[]).map(q)):j.queryType==="ASK"?z=b.createAsk(z):j.queryType==="DESCRIBE"&&(z=b.createDescribe(z,oe)),(B.offset||B.limit)&&(z=b.createSlice(z,B.offset||0,B.limit)),B.from&&(z=b.createFrom(z,B.from.default,B.from.named)),z}function te(j,z){if("type"in j&&j.type==="aggregate"){let B=!1,U;for(let Z of Object.keys(z))if(o(z[Z],j)){U=b.createTerm(Z),B=!0;break}return B||(U=C(),z[(0,u.termToString)(U)]=j),U}return"expression"in j&&j.expression?{...j,expression:te(j.expression,z)}:"args"in j&&j.args?{...j,args:j.args.map(B=>te(B,z))}:j}function ue(j,z){if(j.type!=="aggregate"||!j.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(j)}`);const B=F(j);return B.variable=z,B}function fe(j){return j.updates.length===1?re(j.updates[0]):b.createCompositeUpdate(j.updates.map(re))}function re(j){if("type"in j){if(j.type==="load")return ve(j);if(j.type==="clear"||j.type==="create"||j.type==="drop")return Re(j);if(j.type==="add"||j.type==="copy"||j.type==="move")return ce(j)}else if(j.updateType==="insertdelete"||j.updateType==="deletewhere"||j.updateType==="delete"||j.updateType==="insert")return ye(j);throw new Error(`Unknown update type ${JSON.stringify(j)}`)}function ye(j){if(!g)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let z=[],B=[],U;if(j.delete&&(z=l.default.flatten(j.delete.map(Z=>Te(Z,j.graph)))),j.insert&&(B=l.default.flatten(j.insert.map(Z=>Te(Z,j.graph)))),j.where&&j.where.length>0){U=L({type:"group",patterns:j.where});const Z=j.using;Z?U=b.createFrom(U,Z.default,Z.named):j.graph&&(U=N(U,j.graph))}else j.updateType==="deletewhere"&&z.length>0&&(U=b.createBgp(z));return b.createDeleteInsert(z.length>0?z:void 0,B.length>0?B:void 0,U)}function Te(j,z){let B=z;j.type==="graph"&&(B=j.name);let U=j.triples;return B&&(U=U.map(Z=>Object.assign(Z,{graph:B}))),U.map(q)}function Re(j){let z;switch(l.default.isSimpleTerm(j.graph)?z=j.graph:j.graph.all?z="ALL":j.graph.default?z="DEFAULT":j.graph.named?z="NAMED":z=j.graph.name,j.type){case"clear":return b.createClear(z,j.silent);case"create":return b.createCreate(z,j.silent);case"drop":return b.createDrop(z,j.silent)}}function ve(j){return b.createLoad(j.source,j.destination,j.silent)}function ce(j){const z=j.source.default?"DEFAULT":j.source.name,B=j.destination.default?"DEFAULT":j.destination.name;switch(j.type){case"copy":return b.createCopy(z,B,j.silent);case"move":return b.createMove(z,B,j.silent);case"add":return b.createAdd(z,B,j.silent)}}function J(j){const z={},B=Array.from(h).reduce((Z,oe)=>(Z[oe]=!0,Z),{});return l.default.mapOperation(j,{[s.types.DELETE_INSERT]:Z=>({result:b.createDeleteInsert(Z.delete,Z.insert,Z.where&&J(Z.where)),recurse:!1}),[s.types.PATH]:(Z,oe)=>({result:oe.createPath(U(Z.subject),Z.predicate,U(Z.object),U(Z.graph)),recurse:!1}),[s.types.PATTERN]:(Z,oe)=>({result:oe.createPattern(U(Z.subject),U(Z.predicate),U(Z.object),U(Z.graph)),recurse:!1}),[s.types.CONSTRUCT]:Z=>({result:b.createConstruct(J(Z.input),Z.template),recurse:!1})});function U(Z){if(Z.termType==="BlankNode"){let oe=z[Z.value];return oe||(oe=l.default.createUniqueVariable(Z.value,B,b.dataFactory),B[oe.value]=!0,z[Z.value]=oe),oe}return Z}}return sparqlAlgebra}var sparql={},rdfIsomorphic={},RdfIsomorphic={},hash={},utils$5={},minimalisticAssert,hasRequiredMinimalisticAssert;function requireMinimalisticAssert(){if(hasRequiredMinimalisticAssert)return minimalisticAssert;hasRequiredMinimalisticAssert=1,minimalisticAssert=n;function n(t,r){if(!t)throw new Error(r||"Assertion failed")}return n.equal=function(r,a,o){if(r!=a)throw new Error(o||"Assertion failed: "+r+" != "+a)},minimalisticAssert}var inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(t,r){if(r){t.super_=r;var a=function(){};a.prototype=r.prototype,t.prototype=new a,t.prototype.constructor=t}}),inherits_browser.exports}var hasRequiredUtils$8;function requireUtils$8(){if(hasRequiredUtils$8)return utils$5;hasRequiredUtils$8=1;var n=requireMinimalisticAssert(),t=requireInherits_browser();utils$5.inherits=t;function r(P,C){return(P.charCodeAt(C)&64512)!==55296||C<0||C+1>=P.length?!1:(P.charCodeAt(C+1)&64512)===56320}function a(P,C){if(Array.isArray(P))return P.slice();if(!P)return[];var q=[];if(typeof P=="string")if(C){if(C==="hex")for(P=P.replace(/[^a-z0-9]+/ig,""),P.length%2!==0&&(P="0"+P),N=0;N<P.length;N+=2)q.push(parseInt(P[N]+P[N+1],16))}else for(var M=0,N=0;N<P.length;N++){var G=P.charCodeAt(N);G<128?q[M++]=G:G<2048?(q[M++]=G>>6|192,q[M++]=G&63|128):r(P,N)?(G=65536+((G&1023)<<10)+(P.charCodeAt(++N)&1023),q[M++]=G>>18|240,q[M++]=G>>12&63|128,q[M++]=G>>6&63|128,q[M++]=G&63|128):(q[M++]=G>>12|224,q[M++]=G>>6&63|128,q[M++]=G&63|128)}else for(N=0;N<P.length;N++)q[N]=P[N]|0;return q}utils$5.toArray=a;function o(P){for(var C="",q=0;q<P.length;q++)C+=c(P[q].toString(16));return C}utils$5.toHex=o;function u(P){var C=P>>>24|P>>>8&65280|P<<8&16711680|(P&255)<<24;return C>>>0}utils$5.htonl=u;function s(P,C){for(var q="",M=0;M<P.length;M++){var N=P[M];C==="little"&&(N=u(N)),q+=l(N.toString(16))}return q}utils$5.toHex32=s;function c(P){return P.length===1?"0"+P:P}utils$5.zero2=c;function l(P){return P.length===7?"0"+P:P.length===6?"00"+P:P.length===5?"000"+P:P.length===4?"0000"+P:P.length===3?"00000"+P:P.length===2?"000000"+P:P.length===1?"0000000"+P:P}utils$5.zero8=l;function d(P,C,q,M){var N=q-C;n(N%4===0);for(var G=new Array(N/4),X=0,Y=C;X<G.length;X++,Y+=4){var W;M==="big"?W=P[Y]<<24|P[Y+1]<<16|P[Y+2]<<8|P[Y+3]:W=P[Y+3]<<24|P[Y+2]<<16|P[Y+1]<<8|P[Y],G[X]=W>>>0}return G}utils$5.join32=d;function f(P,C){for(var q=new Array(P.length*4),M=0,N=0;M<P.length;M++,N+=4){var G=P[M];C==="big"?(q[N]=G>>>24,q[N+1]=G>>>16&255,q[N+2]=G>>>8&255,q[N+3]=G&255):(q[N+3]=G>>>24,q[N+2]=G>>>16&255,q[N+1]=G>>>8&255,q[N]=G&255)}return q}utils$5.split32=f;function h(P,C){return P>>>C|P<<32-C}utils$5.rotr32=h;function v(P,C){return P<<C|P>>>32-C}utils$5.rotl32=v;function g(P,C){return P+C>>>0}utils$5.sum32=g;function b(P,C,q){return P+C+q>>>0}utils$5.sum32_3=b;function _(P,C,q,M){return P+C+q+M>>>0}utils$5.sum32_4=_;function S(P,C,q,M,N){return P+C+q+M+N>>>0}utils$5.sum32_5=S;function T(P,C,q,M){var N=P[C],G=P[C+1],X=M+G>>>0,Y=(X<M?1:0)+q+N;P[C]=Y>>>0,P[C+1]=X}utils$5.sum64=T;function w(P,C,q,M){var N=C+M>>>0,G=(N<C?1:0)+P+q;return G>>>0}utils$5.sum64_hi=w;function A(P,C,q,M){var N=C+M;return N>>>0}utils$5.sum64_lo=A;function R(P,C,q,M,N,G,X,Y){var W=0,te=C;te=te+M>>>0,W+=te<C?1:0,te=te+G>>>0,W+=te<G?1:0,te=te+Y>>>0,W+=te<Y?1:0;var ue=P+q+N+X+W;return ue>>>0}utils$5.sum64_4_hi=R;function E(P,C,q,M,N,G,X,Y){var W=C+M+G+Y;return W>>>0}utils$5.sum64_4_lo=E;function I(P,C,q,M,N,G,X,Y,W,te){var ue=0,fe=C;fe=fe+M>>>0,ue+=fe<C?1:0,fe=fe+G>>>0,ue+=fe<G?1:0,fe=fe+Y>>>0,ue+=fe<Y?1:0,fe=fe+te>>>0,ue+=fe<te?1:0;var re=P+q+N+X+W+ue;return re>>>0}utils$5.sum64_5_hi=I;function L(P,C,q,M,N,G,X,Y,W,te){var ue=C+M+G+Y+te;return ue>>>0}utils$5.sum64_5_lo=L;function F(P,C,q){var M=C<<32-q|P>>>q;return M>>>0}utils$5.rotr64_hi=F;function D(P,C,q){var M=P<<32-q|C>>>q;return M>>>0}utils$5.rotr64_lo=D;function $(P,C,q){return P>>>q}utils$5.shr64_hi=$;function O(P,C,q){var M=P<<32-q|C>>>q;return M>>>0}return utils$5.shr64_lo=O,utils$5}var common$1={},hasRequiredCommon$1;function requireCommon$1(){if(hasRequiredCommon$1)return common$1;hasRequiredCommon$1=1;var n=requireUtils$8(),t=requireMinimalisticAssert();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return common$1.BlockHash=r,r.prototype.update=function(o,u){if(o=n.toArray(o,u),this.pending?this.pending=this.pending.concat(o):this.pending=o,this.pendingTotal+=o.length,this.pending.length>=this._delta8){o=this.pending;var s=o.length%this._delta8;this.pending=o.slice(o.length-s,o.length),this.pending.length===0&&(this.pending=null),o=n.join32(o,0,o.length-s,this.endian);for(var c=0;c<o.length;c+=this._delta32)this._update(o,c,c+this._delta32)}return this},r.prototype.digest=function(o){return this.update(this._pad()),t(this.pending===null),this._digest(o)},r.prototype._pad=function(){var o=this.pendingTotal,u=this._delta8,s=u-(o+this.padLength)%u,c=new Array(s+this.padLength);c[0]=128;for(var l=1;l<s;l++)c[l]=0;if(o<<=3,this.endian==="big"){for(var d=8;d<this.padLength;d++)c[l++]=0;c[l++]=0,c[l++]=0,c[l++]=0,c[l++]=0,c[l++]=o>>>24&255,c[l++]=o>>>16&255,c[l++]=o>>>8&255,c[l++]=o&255}else for(c[l++]=o&255,c[l++]=o>>>8&255,c[l++]=o>>>16&255,c[l++]=o>>>24&255,c[l++]=0,c[l++]=0,c[l++]=0,c[l++]=0,d=8;d<this.padLength;d++)c[l++]=0;return c},common$1}var sha={},common={},hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;var n=requireUtils$8(),t=n.rotr32;function r(f,h,v,g){if(f===0)return a(h,v,g);if(f===1||f===3)return u(h,v,g);if(f===2)return o(h,v,g)}common.ft_1=r;function a(f,h,v){return f&h^~f&v}common.ch32=a;function o(f,h,v){return f&h^f&v^h&v}common.maj32=o;function u(f,h,v){return f^h^v}common.p32=u;function s(f){return t(f,2)^t(f,13)^t(f,22)}common.s0_256=s;function c(f){return t(f,6)^t(f,11)^t(f,25)}common.s1_256=c;function l(f){return t(f,7)^t(f,18)^f>>>3}common.g0_256=l;function d(f){return t(f,17)^t(f,19)^f>>>10}return common.g1_256=d,common}var _1,hasRequired_1;function require_1(){if(hasRequired_1)return _1;hasRequired_1=1;var n=requireUtils$8(),t=requireCommon$1(),r=requireCommon(),a=n.rotl32,o=n.sum32,u=n.sum32_5,s=r.ft_1,c=t.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return n.inherits(d,c),_1=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(h,v){for(var g=this.W,b=0;b<16;b++)g[b]=h[v+b];for(;b<g.length;b++)g[b]=a(g[b-3]^g[b-8]^g[b-14]^g[b-16],1);var _=this.h[0],S=this.h[1],T=this.h[2],w=this.h[3],A=this.h[4];for(b=0;b<g.length;b++){var R=~~(b/20),E=u(a(_,5),s(R,S,T,w),A,g[b],l[R]);A=w,w=T,T=a(S,30),S=_,_=E}this.h[0]=o(this.h[0],_),this.h[1]=o(this.h[1],S),this.h[2]=o(this.h[2],T),this.h[3]=o(this.h[3],w),this.h[4]=o(this.h[4],A)},d.prototype._digest=function(h){return h==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},_1}var _256,hasRequired_256;function require_256(){if(hasRequired_256)return _256;hasRequired_256=1;var n=requireUtils$8(),t=requireCommon$1(),r=requireCommon(),a=requireMinimalisticAssert(),o=n.sum32,u=n.sum32_4,s=n.sum32_5,c=r.ch32,l=r.maj32,d=r.s0_256,f=r.s1_256,h=r.g0_256,v=r.g1_256,g=t.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function _(){if(!(this instanceof _))return new _;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}return n.inherits(_,g),_256=_,_.blockSize=512,_.outSize=256,_.hmacStrength=192,_.padLength=64,_.prototype._update=function(T,w){for(var A=this.W,R=0;R<16;R++)A[R]=T[w+R];for(;R<A.length;R++)A[R]=u(v(A[R-2]),A[R-7],h(A[R-15]),A[R-16]);var E=this.h[0],I=this.h[1],L=this.h[2],F=this.h[3],D=this.h[4],$=this.h[5],O=this.h[6],P=this.h[7];for(a(this.k.length===A.length),R=0;R<A.length;R++){var C=s(P,f(D),c(D,$,O),this.k[R],A[R]),q=o(d(E),l(E,I,L));P=O,O=$,$=D,D=o(F,C),F=L,L=I,I=E,E=o(C,q)}this.h[0]=o(this.h[0],E),this.h[1]=o(this.h[1],I),this.h[2]=o(this.h[2],L),this.h[3]=o(this.h[3],F),this.h[4]=o(this.h[4],D),this.h[5]=o(this.h[5],$),this.h[6]=o(this.h[6],O),this.h[7]=o(this.h[7],P)},_.prototype._digest=function(T){return T==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},_256}var _224,hasRequired_224;function require_224(){if(hasRequired_224)return _224;hasRequired_224=1;var n=requireUtils$8(),t=require_256();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return n.inherits(r,t),_224=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(o){return o==="hex"?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")},_224}var _512,hasRequired_512;function require_512(){if(hasRequired_512)return _512;hasRequired_512=1;var n=requireUtils$8(),t=requireCommon$1(),r=requireMinimalisticAssert(),a=n.rotr64_hi,o=n.rotr64_lo,u=n.shr64_hi,s=n.shr64_lo,c=n.sum64,l=n.sum64_hi,d=n.sum64_lo,f=n.sum64_4_hi,h=n.sum64_4_lo,v=n.sum64_5_hi,g=n.sum64_5_lo,b=t.BlockHash,_=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function S(){if(!(this instanceof S))return new S;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=_,this.W=new Array(160)}n.inherits(S,b),_512=S,S.blockSize=1024,S.outSize=512,S.hmacStrength=192,S.padLength=128,S.prototype._prepareBlock=function(q,M){for(var N=this.W,G=0;G<32;G++)N[G]=q[M+G];for(;G<N.length;G+=2){var X=O(N[G-4],N[G-3]),Y=P(N[G-4],N[G-3]),W=N[G-14],te=N[G-13],ue=D(N[G-30],N[G-29]),fe=$(N[G-30],N[G-29]),re=N[G-32],ye=N[G-31];N[G]=f(X,Y,W,te,ue,fe,re,ye),N[G+1]=h(X,Y,W,te,ue,fe,re,ye)}},S.prototype._update=function(q,M){this._prepareBlock(q,M);var N=this.W,G=this.h[0],X=this.h[1],Y=this.h[2],W=this.h[3],te=this.h[4],ue=this.h[5],fe=this.h[6],re=this.h[7],ye=this.h[8],Te=this.h[9],Re=this.h[10],ve=this.h[11],ce=this.h[12],J=this.h[13],j=this.h[14],z=this.h[15];r(this.k.length===N.length);for(var B=0;B<N.length;B+=2){var U=j,Z=z,oe=L(ye,Te),ie=F(ye,Te),se=T(ye,Te,Re,ve,ce),ne=w(ye,Te,Re,ve,ce,J),he=this.k[B],xe=this.k[B+1],me=N[B],Ie=N[B+1],Pe=v(U,Z,oe,ie,se,ne,he,xe,me,Ie),Ce=g(U,Z,oe,ie,se,ne,he,xe,me,Ie);U=E(G,X),Z=I(G,X),oe=A(G,X,Y,W,te),ie=R(G,X,Y,W,te,ue);var pe=l(U,Z,oe,ie),H=d(U,Z,oe,ie);j=ce,z=J,ce=Re,J=ve,Re=ye,ve=Te,ye=l(fe,re,Pe,Ce),Te=d(re,re,Pe,Ce),fe=te,re=ue,te=Y,ue=W,Y=G,W=X,G=l(Pe,Ce,pe,H),X=d(Pe,Ce,pe,H)}c(this.h,0,G,X),c(this.h,2,Y,W),c(this.h,4,te,ue),c(this.h,6,fe,re),c(this.h,8,ye,Te),c(this.h,10,Re,ve),c(this.h,12,ce,J),c(this.h,14,j,z)},S.prototype._digest=function(q){return q==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")};function T(C,q,M,N,G){var X=C&M^~C&G;return X<0&&(X+=4294967296),X}function w(C,q,M,N,G,X){var Y=q&N^~q&X;return Y<0&&(Y+=4294967296),Y}function A(C,q,M,N,G){var X=C&M^C&G^M&G;return X<0&&(X+=4294967296),X}function R(C,q,M,N,G,X){var Y=q&N^q&X^N&X;return Y<0&&(Y+=4294967296),Y}function E(C,q){var M=a(C,q,28),N=a(q,C,2),G=a(q,C,7),X=M^N^G;return X<0&&(X+=4294967296),X}function I(C,q){var M=o(C,q,28),N=o(q,C,2),G=o(q,C,7),X=M^N^G;return X<0&&(X+=4294967296),X}function L(C,q){var M=a(C,q,14),N=a(C,q,18),G=a(q,C,9),X=M^N^G;return X<0&&(X+=4294967296),X}function F(C,q){var M=o(C,q,14),N=o(C,q,18),G=o(q,C,9),X=M^N^G;return X<0&&(X+=4294967296),X}function D(C,q){var M=a(C,q,1),N=a(C,q,8),G=u(C,q,7),X=M^N^G;return X<0&&(X+=4294967296),X}function $(C,q){var M=o(C,q,1),N=o(C,q,8),G=s(C,q,7),X=M^N^G;return X<0&&(X+=4294967296),X}function O(C,q){var M=a(C,q,19),N=a(q,C,29),G=u(C,q,6),X=M^N^G;return X<0&&(X+=4294967296),X}function P(C,q){var M=o(C,q,19),N=o(q,C,29),G=s(C,q,6),X=M^N^G;return X<0&&(X+=4294967296),X}return _512}var _384,hasRequired_384;function require_384(){if(hasRequired_384)return _384;hasRequired_384=1;var n=requireUtils$8(),t=require_512();function r(){if(!(this instanceof r))return new r;t.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return n.inherits(r,t),_384=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(o){return o==="hex"?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")},_384}var hasRequiredSha;function requireSha(){return hasRequiredSha||(hasRequiredSha=1,sha.sha1=require_1(),sha.sha224=require_224(),sha.sha256=require_256(),sha.sha384=require_384(),sha.sha512=require_512()),sha}var ripemd={},hasRequiredRipemd;function requireRipemd(){if(hasRequiredRipemd)return ripemd;hasRequiredRipemd=1;var n=requireUtils$8(),t=requireCommon$1(),r=n.rotl32,a=n.sum32,o=n.sum32_3,u=n.sum32_4,s=t.BlockHash;function c(){if(!(this instanceof c))return new c;s.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}n.inherits(c,s),ripemd.ripemd160=c,c.blockSize=512,c.outSize=160,c.hmacStrength=192,c.padLength=64,c.prototype._update=function(S,T){for(var w=this.h[0],A=this.h[1],R=this.h[2],E=this.h[3],I=this.h[4],L=w,F=A,D=R,$=E,O=I,P=0;P<80;P++){var C=a(r(u(w,l(P,A,R,E),S[h[P]+T],d(P)),g[P]),I);w=I,I=E,E=r(R,10),R=A,A=C,C=a(r(u(L,l(79-P,F,D,$),S[v[P]+T],f(P)),b[P]),O),L=O,O=$,$=r(D,10),D=F,F=C}C=o(this.h[1],R,$),this.h[1]=o(this.h[2],E,O),this.h[2]=o(this.h[3],I,L),this.h[3]=o(this.h[4],w,F),this.h[4]=o(this.h[0],A,D),this.h[0]=C},c.prototype._digest=function(S){return S==="hex"?n.toHex32(this.h,"little"):n.split32(this.h,"little")};function l(_,S,T,w){return _<=15?S^T^w:_<=31?S&T|~S&w:_<=47?(S|~T)^w:_<=63?S&w|T&~w:S^(T|~w)}function d(_){return _<=15?0:_<=31?1518500249:_<=47?1859775393:_<=63?2400959708:2840853838}function f(_){return _<=15?1352829926:_<=31?1548603684:_<=47?1836072691:_<=63?2053994217:0}var h=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return ripemd}var hmac,hasRequiredHmac;function requireHmac(){if(hasRequiredHmac)return hmac;hasRequiredHmac=1;var n=requireUtils$8(),t=requireMinimalisticAssert();function r(a,o,u){if(!(this instanceof r))return new r(a,o,u);this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(o,u))}return hmac=r,r.prototype._init=function(o){o.length>this.blockSize&&(o=new this.Hash().update(o).digest()),t(o.length<=this.blockSize);for(var u=o.length;u<this.blockSize;u++)o.push(0);for(u=0;u<o.length;u++)o[u]^=54;for(this.inner=new this.Hash().update(o),u=0;u<o.length;u++)o[u]^=106;this.outer=new this.Hash().update(o)},r.prototype.update=function(o,u){return this.inner.update(o,u),this},r.prototype.digest=function(o){return this.outer.update(this.inner.digest()),this.outer.digest(o)},hmac}var hasRequiredHash;function requireHash(){return hasRequiredHash||(hasRequiredHash=1,function(n){var t=n;t.utils=requireUtils$8(),t.common=requireCommon$1(),t.sha=requireSha(),t.ripemd=requireRipemd(),t.hmac=requireHmac(),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160}(hash)),hash}var hasRequiredRdfIsomorphic$1;function requireRdfIsomorphic$1(){if(hasRequiredRdfIsomorphic$1)return RdfIsomorphic;hasRequiredRdfIsomorphic$1=1,Object.defineProperty(RdfIsomorphic,"__esModule",{value:!0}),RdfIsomorphic.isTermGrounded=RdfIsomorphic.termToSignature=RdfIsomorphic.quadToSignature=RdfIsomorphic.sha1hex=RdfIsomorphic.hashTerm=RdfIsomorphic.hashTerms=RdfIsomorphic.getGraphBlankNodes=RdfIsomorphic.uniqGraph=RdfIsomorphic.deindexGraph=RdfIsomorphic.indexGraph=RdfIsomorphic.getQuadsWithoutBlankNodes=RdfIsomorphic.getQuadsWithBlankNodes=RdfIsomorphic.hasValue=RdfIsomorphic.hashValues=RdfIsomorphic.getBijectionInner=RdfIsomorphic.getBijection=RdfIsomorphic.isomorphic=void 0;const n=requireHash(),t=requireRdfString(),r=requireRdfTerms();function a(E,I){return!!o(E,I)}RdfIsomorphic.isomorphic=a;function o(E,I){const L=h(f(E)),F=h(f(I));if(Object.keys(L).length!==Object.keys(F).length)return null;for(const C in L)if(L[C]!==F[C])return null;const D=g(d(E)),$=g(d(I)),O=b(E),P=b(I);return u(D,$,O,P)}RdfIsomorphic.getBijection=o;function u(E,I,L,F,D,$){D||(D={}),$||($={});const[O,P]=_(E,L,D),[C,q]=_(I,F,$);if(Object.keys(O).length!==Object.keys(C).length)return null;for(const N in O)if(!l(C,O[N]))return null;let M={};for(const N of L){const G=t.termToString(N),X=P[G];for(const Y in q)if(q[Y]===X){M[G]=Y,delete q[Y];break}}if(!s(Object.keys(M).sort(),L.map(t.termToString).sort())||!s(c(M).sort(),F.map(t.termToString).sort())){M=null;for(const N of L){const G=t.termToString(N);if(!O[G])for(const X of F){const Y=t.termToString(X);if(!C[Y]&&P[G]===q[Y]){const W=T(G);M=u(E,I,L,F,Object.assign(Object.assign({},O),{[G]:W}),Object.assign(Object.assign({},C),{[Y]:W}))}}}}return M}RdfIsomorphic.getBijectionInner=u;function s(E,I){if(E.length!==I.length)return!1;for(let L=E.length;L--;)if(E[L]!==I[L])return!1;return!0}function c(E){const I=[];for(const L in E)I.push(E[L]);return I}RdfIsomorphic.hashValues=c;function l(E,I){for(const L in E)if(E[L]===I)return!0;return!1}RdfIsomorphic.hasValue=l;function d(E){return E.filter(I=>r.someTerms(I,L=>L.termType==="BlankNode"||L.termType==="Quad"&&r.getTermsNested(L).some(F=>F.termType==="BlankNode")))}RdfIsomorphic.getQuadsWithBlankNodes=d;function f(E){return E.filter(I=>r.everyTerms(I,L=>L.termType!=="BlankNode"&&!(L.termType==="Quad"&&r.getTermsNested(L).some(F=>F.termType==="BlankNode"))))}RdfIsomorphic.getQuadsWithoutBlankNodes=f;function h(E){const I={};for(const L of E)I[JSON.stringify(t.quadToStringQuad(L))]=!0;return I}RdfIsomorphic.indexGraph=h;function v(E){return Object.keys(E).map(I=>t.stringQuadToQuad(JSON.parse(I)))}RdfIsomorphic.deindexGraph=v;function g(E){return v(h(E))}RdfIsomorphic.uniqGraph=g;function b(E){return r.uniqTerms(E.map(I=>r.getBlankNodes(r.getTermsNested(I))).reduce((I,L)=>I.concat(L),[]))}RdfIsomorphic.getGraphBlankNodes=b;function _(E,I,L){const F=Object.assign({},L),D={};let $=!0;for(;$;){const O=Object.keys(F).length;for(const C of I){const q=t.termToString(C);if(!F[q]){const[M,N]=S(C,E,F);M&&(F[q]=N),D[q]=N}}const P={};for(const C in D){const q=D[C];P[q]===void 0?P[q]=C:P[q]=!1}for(const C in P){const q=P[C];q&&(F[q]=C)}$=O!==Object.keys(F).length}return[F,D]}RdfIsomorphic.hashTerms=_;function S(E,I,L){const F=[];let D=!0;for(const O of I){const P=r.getTermsNested(O);if(P.some(C=>C.equals(E))){F.push(w(O,L,E));for(const C of P)!R(C,L)&&!C.equals(E)&&(D=!1)}}const $=T(F.sort().join(""));return[D,$]}RdfIsomorphic.hashTerm=S;function T(E){return n.sha1().update(E).digest("hex")}RdfIsomorphic.sha1hex=T;function w(E,I,L){return r.getTerms(E).map(F=>A(F,I,L)).join("|")}RdfIsomorphic.quadToSignature=w;function A(E,I,L){return E.equals(L)?"@self":E.termType==="BlankNode"?I[t.termToString(E)]||"@blank":E.termType==="Quad"?`<${w(E,I,L)}>`:t.termToString(E)}RdfIsomorphic.termToSignature=A;function R(E,I){return E.termType!=="BlankNode"&&!(E.termType==="Quad"&&r.getTermsNested(E).some(L=>!R(L,I)))||!!I[t.termToString(E)]}return RdfIsomorphic.isTermGrounded=R,RdfIsomorphic}var hasRequiredRdfIsomorphic;function requireRdfIsomorphic(){return hasRequiredRdfIsomorphic||(hasRequiredRdfIsomorphic=1,function(n){var t=rdfIsomorphic&&rdfIsomorphic.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u),Object.defineProperty(a,s,{enumerable:!0,get:function(){return o[u]}})}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfIsomorphic&&rdfIsomorphic.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireRdfIsomorphic$1(),n)}(rdfIsomorphic)),rdfIsomorphic}var hasRequiredSparql;function requireSparql(){if(hasRequiredSparql)return sparql;hasRequiredSparql=1;var n=sparql&&sparql.__createBinding||(Object.create?function(de,Le,$e,je){je===void 0&&(je=$e);var Me=Object.getOwnPropertyDescriptor(Le,$e);(!Me||("get"in Me?!Le.__esModule:Me.writable||Me.configurable))&&(Me={enumerable:!0,get:function(){return Le[$e]}}),Object.defineProperty(de,je,Me)}:function(de,Le,$e,je){je===void 0&&(je=$e),de[je]=Le[$e]}),t=sparql&&sparql.__setModuleDefault||(Object.create?function(de,Le){Object.defineProperty(de,"default",{enumerable:!0,value:Le})}:function(de,Le){de.default=Le}),r=sparql&&sparql.__importStar||function(de){if(de&&de.__esModule)return de;var Le={};if(de!=null)for(var $e in de)$e!=="default"&&Object.prototype.hasOwnProperty.call(de,$e)&&n(Le,de,$e);return t(Le,de),Le},a=sparql&&sparql.__importDefault||function(de){return de&&de.__esModule?de:{default:de}};Object.defineProperty(sparql,"__esModule",{value:!0}),sparql.toSparqlJs=sparql.toSparql=void 0;const o=requireRdfIsomorphic(),u=requireRdfString(),s=requireSparql$1(),c=r(requireAlgebra()),l=a(requireFactory()),d=a(requireUtil$a()),f=c.types,h=c.expressionTypes;let v;const g=new l.default;function b(de,Le={}){return new s.Generator(Le).stringify(_(de))}sparql.toSparql=b;function _(de){S(),de=De(de);let Le=T(de);return Le.type==="group"?Le.patterns[0]:Le}sparql.toSparqlJs=_;function S(){v={project:!1,extend:[],group:[],aggregates:[],order:[]}}function T(de){switch(de.type!==f.EXTEND&&de.type!==f.ORDER_BY&&de.type!==f.GRAPH&&(v.project=!1),de.type){case f.EXPRESSION:return w(de);case f.ASK:return ve(de,f.ASK);case f.BGP:return C(de);case f.CONSTRUCT:return q(de);case f.DESCRIBE:return ve(de,f.DESCRIBE);case f.DISTINCT:return M(de);case f.EXTEND:return N(de);case f.FROM:return G(de);case f.FILTER:return X(de);case f.GRAPH:return Y(de);case f.GROUP:return W(de);case f.JOIN:return te(de);case f.LEFT_JOIN:return ue(de);case f.MINUS:return fe(de);case f.NOP:return{};case f.ORDER_BY:return re(de);case f.PATH:return ye(de);case f.PATTERN:return Te(de);case f.PROJECT:return ve(de,f.PROJECT);case f.REDUCED:return J(de);case f.SERVICE:return j(de);case f.SLICE:return z(de);case f.UNION:return B(de);case f.VALUES:return U(de);case f.COMPOSITE_UPDATE:return Ie(de);case f.DELETE_INSERT:return Pe(de);case f.LOAD:return Ce(de);case f.CLEAR:return pe(de);case f.CREATE:return H(de);case f.DROP:return V(de);case f.ADD:return ee(de);case f.MOVE:return ae(de);case f.COPY:return be(de)}throw new Error(`Unknown Operation type ${de.type}`)}function w(de){switch(de.expressionType){case h.AGGREGATE:return E(de);case h.EXISTENCE:return I(de);case h.NAMED:return L(de);case h.OPERATOR:return F(de);case h.TERM:return D(de);case h.WILDCARD:return $(de)}throw new Error(`Unknown Expression Operation type ${de.expressionType}`)}function A(de){switch(de.type){case f.ALT:return Z(de);case f.INV:return oe(de);case f.LINK:return ie(de);case f.NPS:return se(de);case f.ONE_OR_MORE_PATH:return ne(de);case f.SEQ:return he(de);case f.ZERO_OR_MORE_PATH:return xe(de);case f.ZERO_OR_ONE_PATH:return me(de)}throw new Error(`Unknown Path type ${de.type}`)}function R(de){return(0,u.termToString)(de)}function E(de){const Le={expression:w(de.expression),type:"aggregate",aggregation:de.aggregator,distinct:de.distinct};return de.separator&&(Le.separator=de.separator),Le}function I(de){return{type:"operation",operator:de.not?"notexists":"exists",args:[{type:"group",patterns:d.default.flatten([T(de.input)])}]}}function L(de){return{type:"functionCall",function:de.name,args:de.args.map(w)}}function F(de){if(de.operator==="desc"){const $e={expression:w(de.args[0])};return $e.descending=!0,$e}const Le={type:"operation",operator:de.operator,args:de.args.map(w)};return(Le.operator==="in"||Le.operator==="notin")&&(Le.args=[Le.args[0]].concat([Le.args.slice(1)])),Le}function D(de){return de.term}function $(de){return de.wildcard}function O(de){return Array.isArray(de)?de.length===1?de[0]:{type:"group",patterns:de}:de}function P(de){return de}function C(de){let Le=de.patterns.map(Te);return Le.length===0?null:{type:"bgp",triples:Le}}function q(de){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:de.template.map(Te),where:d.default.flatten([T(de.input)])}}function M(de){let Le=T(de.input);return Le.patterns[0].distinct=!0,Le}function N(de){return v.project?(v.extend.push(de),T(de.input)):d.default.flatten([T(de.input),{type:"bind",variable:de.variable,expression:w(de.expression)}])}function G(de){const Le=T(de.input);let $e=Le;return Le.type==="group"&&($e=Le.patterns[0]),$e.from={default:de.default,named:de.named},Le}function X(de){return{type:"group",patterns:d.default.flatten([T(de.input),{type:"filter",expression:w(de.expression)}])}}function Y(de){return{type:"graph",patterns:d.default.flatten([T(de.input)]),name:de.name}}function W(de){const Le=T(de.input),$e=de.aggregates.map(P);return v.aggregates.push(...$e),v.group.push(...de.variables),Le}function te(de){return d.default.flatten(de.input.map(T)).reduce(($e,je)=>(je.type!=="bgp"||$e.length==0||$e[$e.length-1].type!=="bgp"?$e.push(je):$e[$e.length-1].triples.push(...je.triples),$e),[])}function ue(de){const Le={type:"optional",patterns:[T(de.input[1])]};return de.expression&&Le.patterns.push({type:"filter",expression:w(de.expression)}),Le.patterns=d.default.flatten(Le.patterns),d.default.flatten([T(de.input[0]),Le])}function fe(de){let Le=T(de.input[1]);return Le.type==="group"&&(Le=Le.patterns),Array.isArray(Le)||(Le=[Le]),d.default.flatten([T(de.input[0]),{type:"minus",patterns:Le}])}function re(de){return v.order.push(...de.expressions),T(de.input)}function ye(de){return{type:"bgp",triples:[{subject:de.subject,predicate:A(de.predicate),object:de.object}]}}function Te(de){return{subject:de.subject,predicate:de.predicate,object:de.object}}function Re(de,Le){let $e=d.default.isSimpleTerm(de)?R(de):de;if(typeof $e=="string"){if(Le[$e])return Le[$e]}else if(Array.isArray(de))de=de.map(je=>Re(je,Le));else for(let je of Object.keys(de))de[je]=Re(de[je],Le);return de}function ve(de,Le){const $e={type:"query",prefixes:{}},je=$e;let Me;Le===f.PROJECT?($e.queryType="SELECT",Me=de.variables):Le===f.ASK?$e.queryType="ASK":Le===f.DESCRIBE&&($e.queryType="DESCRIBE",Me=de.terms);const ze=v.extend,Je=v.group,Ke=v.aggregates,ot=v.order;S(),v.project=!0;let _e=d.default.flatten([T(de.input)]);_e.length===1&&_e[0].type==="group"&&(_e=_e[0].patterns),$e.where=_e;let Ae={};for(let We of v.aggregates)Ae[R(We.variable)]=w(We);let Ve={};for(let We=v.extend.length-1;We>=0;--We){let pt=v.extend[We];Ve[R(pt.variable)]=Re(w(pt.expression),Ae)}v.group.length>0&&(je.group=v.group.map(We=>{let pt=R(We);if(Ve[pt]){let Ge=Ve[pt];return delete Ve[pt],{variable:We,expression:Ge}}return{expression:We}})),v.order.length>0&&(je.order=v.order.map(T).map(We=>We.descending?We:{expression:We})),Me&&(je.variables=Me.map(We=>{let pt=R(We);if(Ve[pt]){let Ge=Ve[pt];return delete Ve[pt],{variable:We,expression:Ge}}return We}),je.variables.length===0&&(je.variables=[new s.Wildcard]));const Ue=Object.entries(Ve);if(Ue.length>0){je.where=je.where||[];for(const[We,pt]of Ue)je.where.push({type:"bind",variable:(0,u.stringToTerm)(We),expression:pt})}if($e.where.length>0&&$e.where[$e.where.length-1].type==="filter"){const We=$e.where[$e.where.length-1];ce(We,Object.keys(Ae))&&(je.having=d.default.flatten([Re(We.expression,Ae)]),$e.where.splice(-1))}return v.extend=ze,v.group=Je,v.aggregates=Ke,v.order=ot,{type:"group",patterns:[je]}}function ce(de,Le){return d.default.isSimpleTerm(de)?Le.indexOf(R(de))>=0:Array.isArray(de)?de.some($e=>ce($e,Le)):de===Object(de)?Object.keys(de).some($e=>ce(de[$e],Le)):Le.indexOf(de)>=0}function J(de){let Le=T(de.input);return Le.patterns[0].reduced=!0,Le}function j(de){let Le=T(de.input);return Le.type==="group"&&(Le=Le.patterns),Array.isArray(Le)||(Le=[Le]),{type:"service",name:de.name,silent:de.silent,patterns:Le}}function z(de){let Le=T(de.input),$e=Le;return Le.type&&Le.type==="group"&&($e=Le.patterns[0]),de.start!==0&&($e.offset=de.start),de.length!==void 0&&($e.limit=de.length),Le}function B(de){return{type:"union",patterns:de.input.map(T).map(O)}}function U(de){return{type:"values",values:de.bindings.map(Le=>{let $e={};for(let je of de.variables){let Me=`?${je.value}`;Le[Me]?$e[Me]=Le[Me]:$e[Me]=void 0}return $e})}}function Z(de){const Le=de.input.map(A);return Le.every($e=>"pathType"in $e&&$e.pathType==="!")?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:d.default.flatten(Le.map($e=>$e.items))}]}:{type:"path",pathType:"|",items:Le}}function oe(de){if(de.path.type===f.NPS){const Le=de.path.iris.map($e=>({type:"path",pathType:"^",items:[$e]}));return Le.length<=1?{type:"path",pathType:"!",items:Le}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:Le}]}}return{type:"path",pathType:"^",items:[A(de.path)]}}function ie(de){return de.iri}function se(de){return de.iris.length<=1?{type:"path",pathType:"!",items:de.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:de.iris}]}}function ne(de){return{type:"path",pathType:"+",items:[A(de.path)]}}function he(de){return{type:"path",pathType:"/",items:de.input.map(A)}}function xe(de){return{type:"path",pathType:"*",items:[A(de.path)]}}function me(de){return{type:"path",pathType:"?",items:[A(de.path)]}}function Ie(de){const Le=de.updates.map($e=>T($e).updates[0]);return{prefixes:{},type:"update",updates:Le}}function Pe(de){var Le;let $e=de.where,je;if($e&&$e.type===f.FROM){let ze=$e;$e=ze.input,je={default:ze.default,named:ze.named}}const Me=[{updateType:"insertdelete",delete:we(de.delete||[]),insert:we(de.insert||[])}];if(je&&(Me[0].using=je),!$e||$e.type===f.BGP&&$e.patterns.length===0)Me[0].where=[];else{const ze=[];let Je=T(Fe($e,ze));if(Je.type==="group"?Me[0].where=Je.patterns:Me[0].where=[Je],ze.length>0){if(ze.length!==1)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");((Le=ze[0])===null||Le===void 0?void 0:Le.value)!==""&&(Me[0].where=[{type:"graph",patterns:Me[0].where,name:ze[0]}])}}return!de.delete&&!de.where?(Me[0].updateType="insert",delete Me[0].delete,delete Me[0].where):!de.insert&&!de.where?(delete Me[0].insert,delete Me[0].where,de.delete.some(ze=>ze.subject.termType==="Variable"||ze.predicate.termType==="Variable"||ze.object.termType==="Variable")?Me[0].updateType="deletewhere":Me[0].updateType="delete"):!de.insert&&de.where&&de.where.type==="bgp"&&(0,o.isomorphic)(de.delete,de.where.patterns)&&(delete Me[0].where,Me[0].updateType="deletewhere"),{prefixes:{},type:"update",updates:Me}}function Ce(de){const Le=[{type:"load",silent:!!de.silent,source:de.source}];return de.destination&&(Le[0].destination=de.destination),{prefixes:{},type:"update",updates:Le}}function pe(de){return Q(de,"clear")}function H(de){return Q(de,"create")}function V(de){return Q(de,"drop")}function Q(de,Le){const $e=[{type:Le,silent:!!de.silent}];return de.source==="DEFAULT"?$e[0].graph={default:!0}:de.source==="NAMED"?$e[0].graph={named:!0}:de.source==="ALL"?$e[0].graph={all:!0}:$e[0].graph={type:"graph",name:de.source},{prefixes:{},type:"update",updates:$e}}function ee(de){return le(de,"add")}function ae(de){return le(de,"move")}function be(de){return le(de,"copy")}function le(de,Le){const $e=[{type:Le,silent:!!de.silent}];return $e[0].source=de.source==="DEFAULT"?{type:"graph",default:!0}:{type:"graph",name:de.source},$e[0].destination=de.destination==="DEFAULT"?{type:"graph",default:!0}:{type:"graph",name:de.destination},{prefixes:{},type:"update",updates:$e}}function we(de){if(!de)return[];const Le={};return de.forEach($e=>{const je=$e.graph.value;Le[je]||(Le[je]=[]),Le[je].push($e)}),Object.keys(Le).map($e=>$e===""?{type:"bgp",triples:Le[$e].map(Te)}:{type:"graph",triples:Le[$e].map(Te),name:Le[$e][0].graph})}function De(de){return Fe(de,[])}function Fe(de,Le){if(Array.isArray(de))return de.map(Je=>Fe(Je,Le));if(!de.type||de.type===f.DELETE_INSERT)return de;if((de.type===f.PATTERN||de.type===f.PATH)&&de.graph)return Le.push(de.graph),de.graph.name!==""?de.type===f.PATTERN?g.createPattern(de.subject,de.predicate,de.object):g.createPath(de.subject,de.predicate,de.object):de;const $e={},je={},Me={};for(let Je of Object.keys(de)){const Ke=[];if($e[Je]=Fe(de[Je],Ke),Ke.length>0){je[Je]=Ke;for(const ot of Ke)Me[ot.value]=ot}}const ze=Object.keys(Me);if(ze.length>0)if(ze.length===1&&![f.PROJECT,f.SERVICE].includes(de.type))Le.push(Me[ze[0]]);else{if(de.type===f.BGP)return Ne(de,je.patterns);for(let Je of Object.keys(je)){const Ke=$e[Je];Array.isArray(Ke)?$e[Je]=Ke.map((ot,_e)=>je[Je][0].value===""?ot:g.createGraph(ot,je[Je][_e])):je[Je][0].value!==""&&($e[Je]=g.createGraph(Ke,je[Je][0]))}}return $e}function Ne(de,Le){var $e;const je={};for(let Je=0;Je<de.patterns.length;++Je){const Ke=de.patterns[Je],ot=Le[Je].value;je[ot]=($e=je[ot])!==null&&$e!==void 0?$e:{patterns:[],graph:Le[Je]},je[ot].patterns.push(Ke)}let Me=[];for(const[Je,{patterns:Ke,graph:ot}]of Object.entries(je)){const _e=g.createBgp(Ke);Me.push(Je===""?_e:g.createGraph(_e,ot))}let ze=Me[0];for(let Je=1;Je<Me.length;++Je)ze=g.createJoin([ze,Me[Je]]);return ze}return sparql}var hasRequiredSparqlalgebrajs;function requireSparqlalgebrajs(){return hasRequiredSparqlalgebrajs||(hasRequiredSparqlalgebrajs=1,function(n){var t=sparqlalgebrajs&&sparqlalgebrajs.__createBinding||(Object.create?function(f,h,v,g){g===void 0&&(g=v);var b=Object.getOwnPropertyDescriptor(h,v);(!b||("get"in b?!h.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return h[v]}}),Object.defineProperty(f,g,b)}:function(f,h,v,g){g===void 0&&(g=v),f[g]=h[v]}),r=sparqlalgebrajs&&sparqlalgebrajs.__setModuleDefault||(Object.create?function(f,h){Object.defineProperty(f,"default",{enumerable:!0,value:h})}:function(f,h){f.default=h}),a=sparqlalgebrajs&&sparqlalgebrajs.__importStar||function(f){if(f&&f.__esModule)return f;var h={};if(f!=null)for(var v in f)v!=="default"&&Object.prototype.hasOwnProperty.call(f,v)&&t(h,f,v);return r(h,f),h},o=sparqlalgebrajs&&sparqlalgebrajs.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(n,"__esModule",{value:!0}),n.Util=n.toSparqlJs=n.toSparql=n.Factory=n.Algebra=n.translate=void 0;const u=o(requireSparqlAlgebra());n.translate=u.default;const s=a(requireAlgebra());n.Algebra=s;const c=o(requireFactory());n.Factory=c.default;const l=requireSparql();Object.defineProperty(n,"toSparql",{enumerable:!0,get:function(){return l.toSparql}}),Object.defineProperty(n,"toSparqlJs",{enumerable:!0,get:function(){return l.toSparqlJs}});const d=o(requireUtil$a());n.Util=d.default}(sparqlalgebrajs)),sparqlalgebrajs}var expressions={},Expressions={},hasRequiredExpressions$1;function requireExpressions$1(){if(hasRequiredExpressions$1)return Expressions;hasRequiredExpressions$1=1,Object.defineProperty(Expressions,"__esModule",{value:!0}),Expressions.asTermType=void 0;function n(t){if(t==="namedNode"||t==="literal"||t==="blankNode"||t==="quad")return t}return Expressions.asTermType=n,Expressions}var Variable$1={},hasRequiredVariable;function requireVariable(){if(hasRequiredVariable)return Variable$1;hasRequiredVariable=1,Object.defineProperty(Variable$1,"__esModule",{value:!0}),Variable$1.Variable=void 0;const n=requireLib$4p();class t{constructor(a){this.expressionType=n.ExpressionType.Variable,this.name=a}}return Variable$1.Variable=t,Variable$1}var Term$1={},Consts={},hasRequiredConsts;function requireConsts(){if(hasRequiredConsts)return Consts;hasRequiredConsts=1,Object.defineProperty(Consts,"__esModule",{value:!0}),Consts.SparqlOperator=Consts.TypeURL=Consts.typedLiteral=Consts.TypeAlias=void 0;const n=requireRdfDataFactory();var t;(function(s){s.SPARQL_NUMERIC="SPARQL_NUMERIC",s.SPARQL_STRINGLY="SPARQL_STRINGLY"})(t||(Consts.TypeAlias=t={}));const r=new n.DataFactory;function a(s,c){return r.literal(s,r.namedNode(c))}Consts.typedLiteral=a;var o;(function(s){s.XSD_ANY_URI="http://www.w3.org/2001/XMLSchema#anyURI",s.XSD_STRING="http://www.w3.org/2001/XMLSchema#string",s.RDF_LANG_STRING="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",s.XSD_BOOLEAN="http://www.w3.org/2001/XMLSchema#boolean",s.XSD_DATE_TIME="http://www.w3.org/2001/XMLSchema#dateTime",s.XSD_DATE_TIME_STAMP="http://www.w3.org/2001/XMLSchema#dateTimeStamp",s.XSD_DATE="http://www.w3.org/2001/XMLSchema#date",s.XSD_G_MONTH="http://www.w3.org/2001/XMLSchema#gMonth",s.XSD_G_MONTHDAY="http://www.w3.org/2001/XMLSchema#gMonthDay",s.XSD_G_YEAR="http://www.w3.org/2001/XMLSchema#gYear",s.XSD_G_YEAR_MONTH="http://www.w3.org/2001/XMLSchema#gYearMonth",s.XSD_TIME="http://www.w3.org/2001/XMLSchema#time",s.XSD_G_DAY="http://www.w3.org/2001/XMLSchema#gDay",s.XSD_DECIMAL="http://www.w3.org/2001/XMLSchema#decimal",s.XSD_FLOAT="http://www.w3.org/2001/XMLSchema#float",s.XSD_DOUBLE="http://www.w3.org/2001/XMLSchema#double",s.XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer",s.XSD_NON_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonPositiveInteger",s.XSD_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#negativeInteger",s.XSD_LONG="http://www.w3.org/2001/XMLSchema#long",s.XSD_INT="http://www.w3.org/2001/XMLSchema#int",s.XSD_SHORT="http://www.w3.org/2001/XMLSchema#short",s.XSD_BYTE="http://www.w3.org/2001/XMLSchema#byte",s.XSD_NON_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",s.XSD_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#positiveInteger",s.XSD_UNSIGNED_LONG="http://www.w3.org/2001/XMLSchema#unsignedLong",s.XSD_UNSIGNED_INT="http://www.w3.org/2001/XMLSchema#unsignedInt",s.XSD_UNSIGNED_SHORT="http://www.w3.org/2001/XMLSchema#unsignedShort",s.XSD_UNSIGNED_BYTE="http://www.w3.org/2001/XMLSchema#unsignedByte",s.XSD_NORMALIZED_STRING="http://www.w3.org/2001/XMLSchema#normalizedString",s.XSD_TOKEN="http://www.w3.org/2001/XMLSchema#token",s.XSD_LANGUAGE="http://www.w3.org/2001/XMLSchema#language",s.XSD_NM_TOKEN="http://www.w3.org/2001/XMLSchema#NMTOKEN",s.XSD_NAME="http://www.w3.org/2001/XMLSchema#name",s.XSD_NC_NAME="http://www.w3.org/2001/XMLSchema#NCName",s.XSD_ENTITY="http://www.w3.org/2001/XMLSchema#ENTITY",s.XSD_ID="http://www.w3.org/2001/XMLSchema#ID",s.XSD_ID_REF="http://www.w3.org/2001/XMLSchema#IDREF",s.XSD_DURATION="http://www.w3.org/2001/XMLSchema#duration",s.XSD_YEAR_MONTH_DURATION="http://www.w3.org/2001/XMLSchema#yearMonthDuration",s.XSD_DAY_TIME_DURATION="http://www.w3.org/2001/XMLSchema#dayTimeDuration"})(o||(Consts.TypeURL=o={}));var u;return function(s){s.NOT="!",s.UMINUS="uminus",s.UPLUS="uplus",s.LOGICAL_OR="||",s.LOGICAL_AND="&&",s.EQUAL="=",s.NOT_EQUAL="!=",s.LT="<",s.GT=">",s.LTE="<=",s.GTE=">=",s.SAME_TERM="sameterm",s.IN="in",s.NOT_IN="notin",s.MULTIPLICATION="*",s.DIVISION="/",s.ADDITION="+",s.SUBTRACTION="-",s.IS_IRI="isiri",s.IS_URI="isuri",s.IS_BLANK="isblank",s.IS_LITERAL="isliteral",s.IS_NUMERIC="isnumeric",s.STR="str",s.LANG="lang",s.DATATYPE="datatype",s.IRI="iri",s.URI="uri",s.BNODE="bnode",s.STRDT="strdt",s.STRLANG="strlang",s.UUID="uuid",s.STRUUID="struuid",s.STRLEN="strlen",s.SUBSTR="substr",s.UCASE="ucase",s.LCASE="lcase",s.STRSTARTS="strstarts",s.STRENDS="strends",s.CONTAINS="contains",s.STRBEFORE="strbefore",s.STRAFTER="strafter",s.ENCODE_FOR_URI="encode_for_uri",s.CONCAT="concat",s.LANG_MATCHES="langmatches",s.REGEX="regex",s.REPLACE="replace",s.ABS="abs",s.ROUND="round",s.CEIL="ceil",s.FLOOR="floor",s.RAND="rand",s.NOW="now",s.YEAR="year",s.MONTH="month",s.DAY="day",s.HOURS="hours",s.MINUTES="minutes",s.SECONDS="seconds",s.TIMEZONE="timezone",s.TZ="tz",s.MD5="md5",s.SHA1="sha1",s.SHA256="sha256",s.SHA384="sha384",s.SHA512="sha512",s.TRIPLE="triple",s.SUBJECT="subject",s.PREDICATE="predicate",s.OBJECT="object",s.IS_TRIPLE="istriple",s.BOUND="bound",s.IF="if",s.COALESCE="coalesce"}(u||(Consts.SparqlOperator=u={})),Consts}var Errors={},hasRequiredErrors$1;function requireErrors$1(){if(hasRequiredErrors$1)return Errors;hasRequiredErrors$1=1,Object.defineProperty(Errors,"__esModule",{value:!0}),Errors.NoAggregator=Errors.ExtensionFunctionError=Errors.InvalidExpression=Errors.InvalidArity=Errors.UnexpectedError=Errors.ParseError=Errors.EmptyAggregateError=Errors.IncompatibleLanguageOperation=Errors.InvalidTimezoneCall=Errors.CastError=Errors.InvalidArgumentTypes=Errors.InError=Errors.CoalesceError=Errors.RDFEqualTypeError=Errors.EBVCoercionError=Errors.UnboundVariableError=Errors.InvalidLexicalForm=Errors.isExpressionError=Errors.ExpressionError=void 0;class n extends Error{}Errors.ExpressionError=n;function t(R){return R instanceof n}Errors.isExpressionError=t;class r extends n{constructor(E){super(`Invalid lexical form '${A(E)}'`),this.arg=E}}Errors.InvalidLexicalForm=r;class a extends n{constructor(E,I){super(`Unbound variable '${A(E)}'`),this.variable=E,this.bindings=I}}Errors.UnboundVariableError=a;class o extends n{constructor(E){super(`Cannot coerce term to EBV '${A(E)}'`),this.arg=E}}Errors.EBVCoercionError=o;class u extends n{constructor(E){super("Equality test for literals with unsupported datatypes"),this.args=E}}Errors.RDFEqualTypeError=u;class s extends n{constructor(E){super("All COALESCE arguments threw errors"),this.errors=E}}Errors.CoalesceError=s;class c extends n{constructor(E){super(`Some argument to IN errorred and none where equal. ${E.map(I=>`(${I.toString()}) `).join("and ")}`),this.errors=E}}Errors.InError=c;class l extends n{constructor(E,I){super(`Argument types not valid for operator: '${A(I)}' with '${A(E)}`),this.args=E,this.op=I}}Errors.InvalidArgumentTypes=l;class d extends n{constructor(E,I){super(`Invalid cast: '${A(E)}' to '${A(I)}'`),this.arg=E}}Errors.CastError=d;class f extends n{constructor(E){super(`TIMEZONE call on ${E} which has no timezone`),this.dateString=E}}Errors.InvalidTimezoneCall=f;class h extends n{constructor(E,I){super(`Operation on incompatible language literals '${A(E)}' and '${A(I)}'`),this.arg1=E,this.arg2=I}}Errors.IncompatibleLanguageOperation=h;class v extends n{constructor(){super("Empty aggregate expression")}}Errors.EmptyAggregateError=v;class g extends n{constructor(E,I){super(`Failed to parse "${E}" as ${I}.`)}}Errors.ParseError=g;class b extends Error{constructor(E,I){super(`Programmer Error '${E}'`),this.payload=I}}Errors.UnexpectedError=b;class _ extends Error{constructor(E,I){super(`The number of args does not match the arity of the operator '${A(I)}'.`),this.args=E,this.op=I}}Errors.InvalidArity=_;class S extends Error{constructor(E){super(`Invalid SPARQL Expression '${A(E)}'`)}}Errors.InvalidExpression=S;class T extends Error{constructor(E,I){I instanceof Error?super(`Error thrown in ${E}: ${I.message}${I.stack?`
${I.stack}`:""}`):super(`Error thrown in ${E}`)}}Errors.ExtensionFunctionError=T;class w extends Error{constructor(E){super(`Aggregate expression ${A(E)} found, but no aggregate hook provided.`)}}Errors.NoAggregator=w;function A(R){return JSON.stringify(R)}return Errors}var Serialization={},hasRequiredSerialization;function requireSerialization(){if(hasRequiredSerialization)return Serialization;hasRequiredSerialization=1,Object.defineProperty(Serialization,"__esModule",{value:!0}),Serialization.serializeDuration=Serialization.serializeTime=Serialization.serializeDate=Serialization.serializeDateTime=void 0;function n(s,c=2){return s.toLocaleString(void 0,{minimumIntegerDigits:c,useGrouping:!1})}function t(s){return`${a({year:s.year,month:s.month,day:s.day})}T${o(s)}`}Serialization.serializeDateTime=t;function r(s){return s.zoneHours===void 0||s.zoneMinutes===void 0?"":s.zoneHours===0&&s.zoneMinutes===0?"Z":`${s.zoneHours>=0?`+${n(s.zoneHours)}`:n(s.zoneHours)}:${n(Math.abs(s.zoneMinutes))}`}function a(s){return`${n(s.year,4)}-${n(s.month)}-${n(s.day)}${r(s)}`}Serialization.serializeDate=a;function o(s){return`${n(s.hours)}:${n(s.minutes)}:${n(s.seconds)}${r(s)}`}Serialization.serializeTime=o;function u(s,c="PT0S"){if(!Object.values(s).some(S=>(S||0)!==0))return c;const l=Object.values(s).some(S=>(S||0)<0)?"-":"",d=s.year?`${Math.abs(s.year)}Y`:"",f=s.month?`${Math.abs(s.month)}M`:"",h=s.day?`${Math.abs(s.day)}D`:"",v=`${l}P${d}${f}${h}`;if(!(s.hours||s.minutes||s.seconds))return v;const g=s.hours?`${Math.abs(s.hours)}H`:"",b=s.minutes?`${Math.abs(s.minutes)}M`:"",_=s.seconds?`${Math.abs(s.seconds)}S`:"";return`${v}T${g}${b}${_}`}return Serialization.serializeDuration=u,Serialization}var TypeHandling={},Helpers={},OverloadTree={},hasRequiredOverloadTree;function requireOverloadTree(){if(hasRequiredOverloadTree)return OverloadTree;hasRequiredOverloadTree=1,Object.defineProperty(OverloadTree,"__esModule",{value:!0}),OverloadTree.OverloadTree=void 0;const n=requireExpressions(),t=requireTypeHandling();let r=class ai{constructor(o,u){this.identifier=o,this.implementation=void 0,this.generalOverloads=Object.create(null),this.literalOverLoads=[],this.depth=u??0,this.promotionCount=void 0}getSubtree(o){const u=(0,t.asGeneralType)(o);if(u)return this.generalOverloads[u];for(const[s,c]of this.literalOverLoads)if(o===s)return c}getImplementationExact(o){let u=this;for(const s of o)if(u=u.getSubtree(s),!u)return;return u.implementation}search(o,u,s){let c=s[this.identifier],l=0;for(;l<o.length&&(c!=null&&c.cache);){const h=o[l],v=(0,n.isLiteralTermExpression)(h);c=c.cache[v?v.dataType:h.termType],l++}if(l===o.length&&(c!=null&&c.func))return c.func;const d=[],f=0;if(o.length===0)return this.implementation;for(d.push(...this.getSubTreeWithArg(o[f],u).map(h=>({node:h,index:f+1})));d.length>0;){const{index:h,node:v}=d.pop();if(h===o.length&&v.implementation)return this.addToCache(s,o,v.implementation),v.implementation;d.push(...v.getSubTreeWithArg(o[h],u).map(g=>({node:g,index:h+1})))}}addToCache(o,u,s){function c(d,f){return f in d||(d[f]={}),d[f]}let l=c(o,this.identifier);for(const d of u){const f=(0,n.isLiteralTermExpression)(d),h=f?f.dataType:d.termType;l.cache=l.cache??{},l=c(l.cache,h)}l.func=s}addOverload(o,u){this._addOverload([...o],u,0)}_addOverload(o,u,s){const[c,...l]=o;if(!c){(this.promotionCount===void 0||s<=this.promotionCount)&&(this.promotionCount=s,this.implementation=u);return}let d=this.getSubtree(c);if(!d){const f=new ai(this.identifier,this.depth+1),h=(0,t.asGeneralType)(c);h&&(this.generalOverloads[h]=f);const v=(0,t.asOverrideType)(c);v&&this.literalOverLoads.push([v,f]),d=f}if(d._addOverload(l,u,s),t.typePromotion[c])for(const f of t.typePromotion[c])this.addPromotedOverload(f.typeToPromote,u,f.conversionFunction,l,s)}addPromotedOverload(o,u,s,c,l){let d=this.getSubtree(o);if(!d){const f=new ai(this.identifier,this.depth+1);this.literalOverLoads.push([o,f]),d=f}d._addOverload(c,f=>h=>u(f)([...h.slice(0,this.depth),s(h[this.depth]),...h.slice(this.depth+1,h.length)]),l+1)}getSubTreeWithArg(o,u){const s=[],c=(0,n.isLiteralTermExpression)(o);if(this.generalOverloads.term&&s.push(this.generalOverloads.term),this.generalOverloads[o.termType]&&s.push(this.generalOverloads[o.termType]),c){const l=(0,t.asKnownLiteralType)(c.dataType);let d;l?d=t.superTypeDictTable[l]:d=(0,t.getSuperTypes)(c.dataType,u);const f=this.literalOverLoads.filter(([h,v])=>h in d).map(([h,v])=>[d[h],v]);f.sort(([h,v],[g,b])=>h-g),s.push(...f.map(([h,v])=>v))}return s}};return OverloadTree.OverloadTree=r,OverloadTree}var hasRequiredHelpers$1;function requireHelpers$1(){if(hasRequiredHelpers$1)return Helpers;hasRequiredHelpers$1=1,Object.defineProperty(Helpers,"__esModule",{value:!0}),Helpers.expressionToVar=Helpers.dateTime=Helpers.langString=Helpers.string=Helpers.double=Helpers.float=Helpers.decimal=Helpers.integer=Helpers.bool=Helpers.Builder=Helpers.declare=void 0;const n=requireLib$4q(),t=requireExpressions(),r=requireExpressions(),a=requireConsts(),o=requireConsts(),u=requireErrors$1(),s=requireOverloadTree();function c(w){return new l(w)}Helpers.declare=c;class l{constructor(A){this.overloadTree=new s.OverloadTree(A),this.collected=!1}collect(){if(this.collected)throw new Error("Builders can only be collected once!");return this.collected=!0,this.overloadTree}static wrapInvalidLexicalProtected(A){return R=>E=>{for(const[I,L]of E.entries())if(L instanceof r.NonLexicalLiteral)throw new u.InvalidLexicalForm(E[I].toRDF(R.context.getSafe(n.KeysInitQuery.dataFactory)));return A(R)(E)}}set(A,R,E=!0){return this.overloadTree.addOverload(A,E?l.wrapInvalidLexicalProtected(R):R),this}copy({from:A,to:R}){const E=this.overloadTree.getImplementationExact(A);if(!E)throw new u.UnexpectedError("Tried to copy implementation, but types not found",{from:A,to:R});return this.set(R,E)}onUnary(A,R,E=!0){return this.set([A],I=>([L])=>R(I)(L),E)}onUnaryTyped(A,R,E=!0){return this.set([A],I=>([L])=>R(I)(L.typedValue),E)}onBinary(A,R,E=!0){return this.set(A,I=>([L,F])=>R(I)(L,F),E)}onBinaryTyped(A,R,E=!0){return this.set(A,I=>([L,F])=>R(I)(L.typedValue,F.typedValue),E)}onTernaryTyped(A,R,E=!0){return this.set(A,I=>([L,F,D])=>R(I)(L.typedValue,F.typedValue,D.typedValue),E)}onTernary(A,R,E=!0){return this.set(A,I=>([L,F,D])=>R(I)(L,F,D),E)}onQuaternaryTyped(A,R,E=!0){return this.set(A,I=>([L,F,D,$])=>R(I)(L.typedValue,F.typedValue,D.typedValue,$.typedValue),E)}onTerm1(A,R=!1){return this.set(["term"],E=>([I])=>A(E)(I),R)}onTerm3(A){return this.set(["term","term","term"],R=>([E,I,L])=>A(R)(E,I,L))}onQuad1(A){return this.set(["quad"],R=>([E])=>A(R)(E))}onLiteral1(A,R=!0){return this.set(["literal"],E=>([I])=>A(E)(I),R)}onBoolean1(A,R=!0){return this.set([a.TypeURL.XSD_BOOLEAN],E=>([I])=>A(E)(I),R)}onBoolean1Typed(A,R=!0){return this.set([a.TypeURL.XSD_BOOLEAN],E=>([I])=>A(E)(I.typedValue),R)}onString1(A,R=!0){return this.set([a.TypeURL.XSD_STRING],E=>([I])=>A(E)(I),R)}onString1Typed(A,R=!0){return this.set([a.TypeURL.XSD_STRING],E=>([I])=>A(E)(I.typedValue),R)}onLangString1(A,R=!0){return this.set([a.TypeURL.RDF_LANG_STRING],E=>([I])=>A(E)(I),R)}onStringly1(A,R=!0){return this.set([a.TypeAlias.SPARQL_STRINGLY],E=>([I])=>A(E)(I),R)}onStringly1Typed(A,R=!0){return this.set([a.TypeAlias.SPARQL_STRINGLY],E=>([I])=>A(E)(I.typedValue),R)}onNumeric1(A,R=!0){return this.set([a.TypeAlias.SPARQL_NUMERIC],E=>([I])=>A(E)(I),R)}onDateTime1(A,R=!0){return this.set([a.TypeURL.XSD_DATE_TIME],E=>([I])=>A(E)(I),R)}numericConverter(A,R=!0){const E=I=>L=>A(I)(L.typedValue);return this.onUnary(o.TypeURL.XSD_INTEGER,I=>L=>f(E(I)(L)),R).onUnary(o.TypeURL.XSD_DECIMAL,I=>L=>h(E(I)(L)),R).onUnary(o.TypeURL.XSD_FLOAT,I=>L=>v(E(I)(L)),R).onUnary(o.TypeURL.XSD_DOUBLE,I=>L=>g(E(I)(L)),R)}arithmetic(A,R=!0){const E=I=>(L,F)=>A(I)(L.typedValue,F.typedValue);return this.onBinary([o.TypeURL.XSD_INTEGER,o.TypeURL.XSD_INTEGER],I=>(L,F)=>f(E(I)(L,F)),R).onBinary([o.TypeURL.XSD_DECIMAL,o.TypeURL.XSD_DECIMAL],I=>(L,F)=>h(E(I)(L,F)),R).onBinary([o.TypeURL.XSD_FLOAT,o.TypeURL.XSD_FLOAT],I=>(L,F)=>v(E(I)(L,F)),R).onBinary([o.TypeURL.XSD_DOUBLE,o.TypeURL.XSD_DOUBLE],I=>(L,F)=>g(E(I)(L,F)),R)}numberTest(A){return this.numeric(R=>([E,I])=>{const L=A(R)(E.typedValue,I.typedValue);return d(L)})}stringTest(A,R=!0){return this.set([a.TypeURL.XSD_STRING,a.TypeURL.XSD_STRING],E=>([I,L])=>{const F=A(E)(I.typedValue,L.typedValue);return d(F)},R)}booleanTest(A,R=!0){return this.set([a.TypeURL.XSD_BOOLEAN,a.TypeURL.XSD_BOOLEAN],E=>([I,L])=>{const F=A(E)(I.typedValue,L.typedValue);return d(F)},R)}dateTimeTest(A,R=!0){return this.set([a.TypeURL.XSD_DATE_TIME,a.TypeURL.XSD_DATE_TIME],E=>([I,L])=>{const F=A(E)(I.typedValue,L.typedValue);return d(F)},R)}numeric(A){return this.set([a.TypeAlias.SPARQL_NUMERIC,a.TypeAlias.SPARQL_NUMERIC],A)}}Helpers.Builder=l;function d(w){return new t.BooleanLiteral(w)}Helpers.bool=d;function f(w){return new t.IntegerLiteral(w)}Helpers.integer=f;function h(w){return new t.DecimalLiteral(w)}Helpers.decimal=h;function v(w){return new t.FloatLiteral(w)}Helpers.float=v;function g(w){return new t.DoubleLiteral(w)}Helpers.double=g;function b(w){return new t.StringLiteral(w)}Helpers.string=b;function _(w,A){return new t.LangStringLiteral(w,A)}Helpers.langString=_;function S(w,A){return new t.DateTimeLiteral(w,A)}Helpers.dateTime=S;function T(w,A){return w.variable(A.name.slice(1))}return Helpers.expressionToVar=T,Helpers}var hasRequiredTypeHandling;function requireTypeHandling(){return hasRequiredTypeHandling||(hasRequiredTypeHandling=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.typePromotion=n.isSubTypeOf=n.getSuperTypeDict=n.isInternalSubType=n.asGeneralType=n.asOverrideType=n.asKnownLiteralType=n.asTypeAlias=n.typeAliasCheck=n.extensionTableInit=n.getSuperTypes=n.superTypeDictTable=n.extensionTableInput=void 0;const t=requireExpressions(),r=requireHelpers$1(),a=requireConsts();n.extensionTableInput={[a.TypeURL.XSD_DATE_TIME_STAMP]:a.TypeURL.XSD_DATE_TIME,[a.TypeURL.XSD_DAY_TIME_DURATION]:a.TypeURL.XSD_DURATION,[a.TypeURL.XSD_YEAR_MONTH_DURATION]:a.TypeURL.XSD_DURATION,[a.TypeURL.RDF_LANG_STRING]:a.TypeAlias.SPARQL_STRINGLY,[a.TypeURL.XSD_STRING]:a.TypeAlias.SPARQL_STRINGLY,[a.TypeURL.XSD_NORMALIZED_STRING]:a.TypeURL.XSD_STRING,[a.TypeURL.XSD_TOKEN]:a.TypeURL.XSD_NORMALIZED_STRING,[a.TypeURL.XSD_LANGUAGE]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NM_TOKEN]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NAME]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NC_NAME]:a.TypeURL.XSD_NAME,[a.TypeURL.XSD_ENTITY]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_ID]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_ID_REF]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_DOUBLE]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_FLOAT]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_DECIMAL]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_INTEGER]:a.TypeURL.XSD_DECIMAL,[a.TypeURL.XSD_NON_POSITIVE_INTEGER]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_NEGATIVE_INTEGER]:a.TypeURL.XSD_NON_POSITIVE_INTEGER,[a.TypeURL.XSD_LONG]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_INT]:a.TypeURL.XSD_LONG,[a.TypeURL.XSD_SHORT]:a.TypeURL.XSD_INT,[a.TypeURL.XSD_BYTE]:a.TypeURL.XSD_SHORT,[a.TypeURL.XSD_NON_NEGATIVE_INTEGER]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_POSITIVE_INTEGER]:a.TypeURL.XSD_NON_NEGATIVE_INTEGER,[a.TypeURL.XSD_UNSIGNED_LONG]:a.TypeURL.XSD_NON_NEGATIVE_INTEGER,[a.TypeURL.XSD_UNSIGNED_INT]:a.TypeURL.XSD_UNSIGNED_LONG,[a.TypeURL.XSD_UNSIGNED_SHORT]:a.TypeURL.XSD_UNSIGNED_INT,[a.TypeURL.XSD_UNSIGNED_BYTE]:a.TypeURL.XSD_UNSIGNED_SHORT,[a.TypeURL.XSD_DATE_TIME]:"term",[a.TypeURL.XSD_BOOLEAN]:"term",[a.TypeURL.XSD_DATE]:"term",[a.TypeURL.XSD_G_MONTH]:"term",[a.TypeURL.XSD_G_MONTHDAY]:"term",[a.TypeURL.XSD_G_YEAR]:"term",[a.TypeURL.XSD_G_YEAR_MONTH]:"term",[a.TypeURL.XSD_TIME]:"term",[a.TypeURL.XSD_G_DAY]:"term",[a.TypeURL.XSD_DURATION]:"term",[a.TypeAlias.SPARQL_NUMERIC]:"term",[a.TypeAlias.SPARQL_STRINGLY]:"term",[a.TypeURL.XSD_ANY_URI]:"term"},n.superTypeDictTable=Object.create(null);function o(_,S){const T=S.cache.get(_);if(T)return T;const w=S.discoverer(_);if(w==="term"){const E=Object.create(null);return E.__depth=0,E[_]=0,S.cache.set(_,E),E}let A;const R=d(w);return R?A={...n.superTypeDictTable[R]}:A={...o(w,S)},A.__depth++,A[_]=A.__depth,S.cache.set(_,A),A}n.getSuperTypes=o;function u(){for(const[_,S]of Object.entries(n.extensionTableInput)){const T=_;n.superTypeDictTable[T]||s(T,S,n.superTypeDictTable)}}n.extensionTableInit=u,u();function s(_,S,T){if(S==="term"||S===void 0){const w=Object.create(null);w.__depth=0,w[_]=0,T[_]=w;return}T[S]||s(S,n.extensionTableInput[S],T),T[_]={...T[S],[_]:T[S].__depth+1,__depth:T[S].__depth+1}}n.typeAliasCheck=Object.create(null);function c(){for(const _ of Object.values(a.TypeAlias))n.typeAliasCheck[_]=!0}c();function l(_){if(_ in n.typeAliasCheck)return _}n.asTypeAlias=l;function d(_){if(_ in n.superTypeDictTable)return _}n.asKnownLiteralType=d;function f(_){if(d(_)??_==="term")return _}n.asOverrideType=f;function h(_){if(_==="term"||(0,t.asTermType)(_))return _}n.asGeneralType=h;function v(_,S){return _!=="term"&&n.superTypeDictTable[_]&&n.superTypeDictTable[_][S]!==void 0}n.isInternalSubType=v;function g(_,S){const T=d(_);return T?n.superTypeDictTable[T]:o(_,S)}n.getSuperTypeDict=g;function b(_,S,T){return _==="term"?!1:g(_,T)[S]!==void 0}n.isSubTypeOf=b,n.typePromotion={[a.TypeURL.XSD_STRING]:[{typeToPromote:a.TypeURL.XSD_ANY_URI,conversionFunction:_=>(0,r.string)(_.str())}],[a.TypeURL.XSD_DOUBLE]:[{typeToPromote:a.TypeURL.XSD_FLOAT,conversionFunction:_=>(0,r.double)(_.typedValue)},{typeToPromote:a.TypeURL.XSD_DECIMAL,conversionFunction:_=>(0,r.double)(_.typedValue)}],[a.TypeURL.XSD_FLOAT]:[{typeToPromote:a.TypeURL.XSD_DECIMAL,conversionFunction:_=>(0,r.float)(_.typedValue)}]}}(TypeHandling)),TypeHandling}var hasRequiredTerm;function requireTerm(){if(hasRequiredTerm)return Term$1;hasRequiredTerm=1,Object.defineProperty(Term$1,"__esModule",{value:!0}),Term$1.isNonLexicalLiteral=Term$1.NonLexicalLiteral=Term$1.YearMonthDurationLiteral=Term$1.DayTimeDurationLiteral=Term$1.DurationLiteral=Term$1.DateLiteral=Term$1.TimeLiteral=Term$1.DateTimeLiteral=Term$1.StringLiteral=Term$1.LangStringLiteral=Term$1.BooleanLiteral=Term$1.DoubleLiteral=Term$1.FloatLiteral=Term$1.DecimalLiteral=Term$1.IntegerLiteral=Term$1.NumericLiteral=Term$1.Literal=Term$1.isLiteralTermExpression=Term$1.DefaultGraph=Term$1.Quad=Term$1.BlankNode=Term$1.NamedNode=Term$1.Term=void 0;const n=requireLib$4p(),t=requireConsts(),r=requireConsts(),a=requireErrors$1(),o=requireSerialization(),u=requireTypeHandling();class s{constructor(){this.expressionType=n.ExpressionType.Term}str(){throw new a.InvalidArgumentTypes([this],t.SparqlOperator.STR)}coerceEBV(){throw new a.EBVCoercionError(this)}}Term$1.Term=s;class c extends s{constructor(q){super(),this.value=q,this.termType="namedNode"}toRDF(q){return q.namedNode(this.value)}str(){return this.value}}Term$1.NamedNode=c;class l extends s{constructor(q){super(),this.termType="blankNode",this.value=q}toRDF(q){return typeof this.value=="string"?q.blankNode(this.value):this.value}}Term$1.BlankNode=l;class d extends s{constructor(q,M,N,G){super(),this.subject=q,this.predicate=M,this.object=N,this.graph=G,this.termType="quad"}toRDF(q){return q.quad(this.subject.toRDF(q),this.predicate.toRDF(q),this.object.toRDF(q),this.graph.toRDF(q))}str(){return`Quad: [${this.subject.str()}, ${this.predicate.str()}, ${this.object.str()}, ${this.graph.str()}]`}}Term$1.Quad=d;class f extends s{constructor(){super(),this.termType="defaultGraph"}toRDF(q){return q.defaultGraph()}str(){return"DefaultGraph"}}Term$1.DefaultGraph=f;function h(C){if(C.termType==="literal")return C}Term$1.isLiteralTermExpression=h;class v extends s{constructor(q,M,N,G){super(),this.typedValue=q,this.dataType=M,this.strValue=N,this.language=G,this.termType="literal"}toRDF(q){return q.literal(this.strValue??this.str(),this.language??q.namedNode(this.dataType))}str(){return this.strValue??this.typedValue.toString()}}Term$1.Literal=v;class g extends v{constructor(q,M,N,G){super(q,M,N,G),this.typedValue=q,this.strValue=N,this.language=G}coerceEBV(){return!!this.typedValue}toRDF(q){const M=super.toRDF(q);return Number.isFinite(this.typedValue)||(M.value=M.value.replace("Infinity","INF")),M}str(){return this.strValue??this.specificFormatter(this.typedValue)}}Term$1.NumericLiteral=g;class b extends g{constructor(q,M,N,G){super(q,M??r.TypeURL.XSD_INTEGER,N,G),this.typedValue=q,this.strValue=N,this.language=G}specificFormatter(q){return q.toFixed(0)}}Term$1.IntegerLiteral=b;class _ extends g{constructor(q,M,N,G){super(q,M??r.TypeURL.XSD_DECIMAL,N,G),this.typedValue=q,this.strValue=N,this.language=G}specificFormatter(q){return q.toString()}}Term$1.DecimalLiteral=_;class S extends g{constructor(q,M,N,G){super(q,M??r.TypeURL.XSD_FLOAT,N,G),this.typedValue=q,this.strValue=N,this.language=G}specificFormatter(q){return q.toString()}}Term$1.FloatLiteral=S;class T extends g{constructor(q,M,N,G){super(q,M??r.TypeURL.XSD_DOUBLE,N,G),this.typedValue=q,this.strValue=N,this.language=G}specificFormatter(q){if(!Number.isFinite(q))return q>0?"INF":q<0?"-INF":"NaN";const M=q.toExponential(),[N,G]=M.split("e"),X=G.replace(/\+/u,"");return`${N.includes(".")?N:`${N}.0`}E${X}`}}Term$1.DoubleLiteral=T;class w extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_BOOLEAN,M),this.typedValue=q,this.strValue=M}coerceEBV(){return this.typedValue}}Term$1.BooleanLiteral=w;class A extends v{constructor(q,M,N){super(q,N??r.TypeURL.RDF_LANG_STRING,q,M),this.typedValue=q,this.language=M}coerceEBV(){return this.str().length>0}}Term$1.LangStringLiteral=A;class R extends v{constructor(q,M){super(q,M??r.TypeURL.XSD_STRING,q),this.typedValue=q}coerceEBV(){return this.str().length>0}}Term$1.StringLiteral=R;class E extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_DATE_TIME,M),this.typedValue=q,this.strValue=M}str(){return(0,o.serializeDateTime)(this.typedValue)}}Term$1.DateTimeLiteral=E;class I extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_TIME,M),this.typedValue=q,this.strValue=M}str(){return(0,o.serializeTime)(this.typedValue)}}Term$1.TimeLiteral=I;class L extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_DATE,M),this.typedValue=q,this.strValue=M}str(){return(0,o.serializeDate)(this.typedValue)}}Term$1.DateLiteral=L;class F extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_DURATION,M),this.typedValue=q,this.strValue=M}str(){return(0,o.serializeDuration)(this.typedValue)}}Term$1.DurationLiteral=F;class D extends F{constructor(q,M,N){super(q,M,N??r.TypeURL.XSD_DAY_TIME_DURATION),this.typedValue=q,this.strValue=M}}Term$1.DayTimeDurationLiteral=D;class $ extends v{constructor(q,M,N){super(q,N??r.TypeURL.XSD_YEAR_MONTH_DURATION,M),this.typedValue=q,this.strValue=M}str(){return(0,o.serializeDuration)(this.typedValue,"P0M")}}Term$1.YearMonthDurationLiteral=$;class O extends v{constructor(q,M,N,G,X){super({toString:()=>"undefined"},M,G,X),this.openWorldType=N}coerceEBV(){if((0,u.isSubTypeOf)(this.dataType,r.TypeURL.XSD_BOOLEAN,this.openWorldType)||(0,u.isSubTypeOf)(this.dataType,r.TypeAlias.SPARQL_NUMERIC,this.openWorldType))return!1;throw new a.EBVCoercionError(this)}toRDF(q){return q.literal(this.str(),this.language??q.namedNode(this.dataType))}str(){return this.strValue??""}}Term$1.NonLexicalLiteral=O;function P(C){if(C instanceof O)return C}return Term$1.isNonLexicalLiteral=P,Term$1}var Operator={},hasRequiredOperator;function requireOperator(){if(hasRequiredOperator)return Operator;hasRequiredOperator=1,Object.defineProperty(Operator,"__esModule",{value:!0}),Operator.Operator=void 0;const n=requireLib$4p();let t=class{constructor(a,o,u){this.name=a,this.args=o,this.apply=u,this.expressionType=n.ExpressionType.Operator}};return Operator.Operator=t,Operator}var Aggregate={},hasRequiredAggregate;function requireAggregate(){if(hasRequiredAggregate)return Aggregate;hasRequiredAggregate=1,Object.defineProperty(Aggregate,"__esModule",{value:!0}),Aggregate.Aggregate=void 0;const n=requireLib$4p();let t=class{constructor(a,o){this.name=a,this.expression=o,this.expressionType=n.ExpressionType.Aggregate}};return Aggregate.Aggregate=t,Aggregate}var Existence={},hasRequiredExistence;function requireExistence(){if(hasRequiredExistence)return Existence;hasRequiredExistence=1,Object.defineProperty(Existence,"__esModule",{value:!0}),Existence.Existence=void 0;const n=requireLib$4p();let t=class{constructor(a){this.expression=a,this.expressionType=n.ExpressionType.Existence}};return Existence.Existence=t,Existence}var hasRequiredExpressions;function requireExpressions(){return hasRequiredExpressions||(hasRequiredExpressions=1,function(n){var t=expressions&&expressions.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=expressions&&expressions.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireExpressions$1(),n),r(requireVariable(),n),r(requireTerm(),n),r(requireOperator(),n),r(requireAggregate(),n),r(requireExistence(),n)}(expressions)),expressions}var Parsing={},DateTimeHelpers={},hasRequiredDateTimeHelpers;function requireDateTimeHelpers(){if(hasRequiredDateTimeHelpers)return DateTimeHelpers;hasRequiredDateTimeHelpers=1,Object.defineProperty(DateTimeHelpers,"__esModule",{value:!0}),DateTimeHelpers.extractTimeZone=DateTimeHelpers.extractRawTimeZone=DateTimeHelpers.dayTimeDurationsToSeconds=DateTimeHelpers.yearMonthDurationsToMonths=DateTimeHelpers.trimToDayTimeDuration=DateTimeHelpers.trimToYearMonthDuration=DateTimeHelpers.toUTCDate=DateTimeHelpers.toJSDate=DateTimeHelpers.negateDuration=DateTimeHelpers.toDateTimeRepresentation=DateTimeHelpers.defaultedDateTimeRepresentation=DateTimeHelpers.simplifyDurationRepresentation=DateTimeHelpers.defaultedDurationRepresentation=DateTimeHelpers.defaultedYearMonthDurationRepresentation=DateTimeHelpers.defaultedDayTimeDurationRepresentation=void 0;function n(_){return{day:_.day??0,hours:_.hours??0,minutes:_.minutes??0,seconds:_.seconds??0}}DateTimeHelpers.defaultedDayTimeDurationRepresentation=n;function t(_){return{year:_.year??0,month:_.month??0}}DateTimeHelpers.defaultedYearMonthDurationRepresentation=t;function r(_){return{...n(_),...t(_)}}DateTimeHelpers.defaultedDurationRepresentation=r;function a(_){const S=r(_),T={},w=S.year+Math.trunc(S.month/12);w&&(T.year=w,S.month%=12),S.month&&(T.month=S.month);const A=S.day+Math.trunc(S.hours/24)+Math.trunc(S.minutes/(24*60))+Math.trunc(S.seconds/(24*60*60));A&&(T.day=A,S.hours%=24,S.minutes%=24*60,S.seconds%=24*60*60);const R=S.hours+Math.trunc(S.minutes/60)+Math.trunc(S.seconds/(60*60));R&&(T.hours=R,S.minutes%=60,S.seconds%=60*60);const E=S.minutes+Math.trunc(S.seconds/60);return E&&(T.minutes=E,S.seconds%=60),S.seconds&&(T.seconds=S.seconds),T}DateTimeHelpers.simplifyDurationRepresentation=a;function o(_){return{..._,day:_.day??1,hours:_.hours??0,month:_.month??1,year:_.year??0,seconds:_.seconds??0,minutes:_.minutes??0}}DateTimeHelpers.defaultedDateTimeRepresentation=o;function u({date:_,timeZone:S}){return{year:_.getFullYear(),month:_.getMonth()+1,day:_.getDate(),hours:_.getHours(),minutes:_.getMinutes(),seconds:_.getSeconds(),zoneHours:S.zoneHours,zoneMinutes:S.zoneMinutes}}DateTimeHelpers.toDateTimeRepresentation=u;function s(_){return{year:_.year===void 0?void 0:-1*_.year,month:_.month===void 0?void 0:-1*_.month,day:_.day===void 0?void 0:-1*_.day,hours:_.hours===void 0?void 0:-1*_.hours,minutes:_.minutes===void 0?void 0:-1*_.minutes,seconds:_.seconds===void 0?void 0:-1*_.seconds}}DateTimeHelpers.negateDuration=s;function c(_){const S=new Date(_.year,_.month-1,_.day,_.hours,_.minutes,Math.trunc(_.seconds),_.seconds%1*1e3);return _.year>=0&&_.year<100&&S.setFullYear(S.getFullYear()-1900),S}DateTimeHelpers.toJSDate=c;function l(_,S){const T=c(o(_)),w=T.getTimezoneOffset(),A=_.zoneHours??S.zoneHours,R=_.zoneMinutes??S.zoneMinutes;return new Date(T.getTime()-(w+A*60+R)*60*1e3)}DateTimeHelpers.toUTCDate=l;function d(_){return{year:_.year,month:_.month}}DateTimeHelpers.trimToYearMonthDuration=d;function f(_){return{day:_.day,hours:_.hours,minutes:_.minutes,seconds:_.seconds}}DateTimeHelpers.trimToDayTimeDuration=f;function h(_){return _.year*12+_.month}DateTimeHelpers.yearMonthDurationsToMonths=h;function v(_){return((_.day*24+_.hours)*60+_.minutes)*60+_.seconds}DateTimeHelpers.dayTimeDurationsToSeconds=v;function g(_){return/(Z|([+-]\d\d:\d\d))?$/u.exec(_)[0]}DateTimeHelpers.extractRawTimeZone=g;function b(_){return{zoneHours:_.getTimezoneOffset()/60,zoneMinutes:_.getTimezoneOffset()%60}}return DateTimeHelpers.extractTimeZone=b,DateTimeHelpers}var SpecAlgos={},hasRequiredSpecAlgos;function requireSpecAlgos(){if(hasRequiredSpecAlgos)return SpecAlgos;hasRequiredSpecAlgos=1,Object.defineProperty(SpecAlgos,"__esModule",{value:!0}),SpecAlgos.elapsedDuration=SpecAlgos.addDurationToDateTime=SpecAlgos.maximumDayInMonthFor=void 0;const n=requireDateTimeHelpers();function t(u,s,c=0){const l=u-c,d=s-c,f=Math.floor(l/d);return{intDiv:f,remainder:u-f*d}}function r(u,s){const{intDiv:c,remainder:l}=t(s,13,1),d=u+c;return[1,3,5,7,8,10,12].includes(l)?31:[4,6,9,11].includes(l)?30:l===2&&(t(d,400).remainder===0||t(d,100).remainder!==0&&t(d,4).remainder===0)?29:28}SpecAlgos.maximumDayInMonthFor=r;function a(u,s){const c={...u};let l=t(u.month+s.month,13,1);for(c.month=l.remainder,c.year=u.year+s.year+l.intDiv,l=t(u.seconds+s.seconds,60),c.seconds=l.remainder,l=t(u.minutes+s.minutes+l.intDiv,60),c.minutes=l.remainder,l=t(u.hours+s.hours+l.intDiv,24),c.hours=l.remainder,c.day=u.day+s.day+l.intDiv;;){let d;if(c.day<1)c.day+=r(c.year,c.month-1),d=-1;else if(c.day>r(c.year,c.month))c.day-=r(c.year,c.month),d=1;else break;l=t(c.month+d,13,1),c.month=l.remainder,c.year+=l.intDiv}return c}SpecAlgos.addDurationToDateTime=a;function o(u,s,c){const l=(0,n.toUTCDate)(u,c),d=(0,n.toUTCDate)(s,c),f=l.getTime()-d.getTime();return{day:Math.floor(f/(1e3*60*60*24)),hours:Math.floor(f%(1e3*60*60*24)/(1e3*60*60)),minutes:Math.floor(f%(1e3*60*60)/(1e3*60)),seconds:f%(1e3*60)}}return SpecAlgos.elapsedDuration=o,SpecAlgos}var hasRequiredParsing;function requireParsing(){if(hasRequiredParsing)return Parsing;hasRequiredParsing=1,Object.defineProperty(Parsing,"__esModule",{value:!0}),Parsing.parseDayTimeDuration=Parsing.parseYearMonthDuration=Parsing.parseDuration=Parsing.parseTime=Parsing.parseDate=Parsing.parseDateTime=Parsing.parseXSDDecimal=Parsing.parseXSDFloat=void 0;const n=requireDateTimeHelpers(),t=requireErrors$1(),r=requireSpecAlgos();function a(g){const b=Number(g);return Number.isNaN(b)?g==="NaN"?Number.NaN:g==="INF"||g==="+INF"?Number.POSITIVE_INFINITY:g==="-INF"?Number.NEGATIVE_INFINITY:void 0:b}Parsing.parseXSDFloat=a;function o(g){const b=Number(g);return Number.isNaN(b)?void 0:b}Parsing.parseXSDDecimal=o;function u(g){const[b,_]=g.split("T");if(_===void 0)throw new t.ParseError(g,"dateTime");return{...c(b),...l(_)}}Parsing.parseDateTime=u;function s(g){if(g==="")return{zoneHours:void 0,zoneMinutes:void 0};if(g==="Z")return{zoneHours:0,zoneMinutes:0};const _=g.replaceAll(/^([+|-])(\d\d):(\d\d)$/gu,"$11!$2!$3").split("!").map(Number);return{zoneHours:_[0]*_[1],zoneMinutes:_[0]*_[2]}}function c(g){const b=g.replaceAll(/^(-)?([123456789]*\d{4})-(\d\d)-(\d\d)(Z|([+-]\d\d:\d\d))?$/gu,"$11!$2!$3!$4!$5");if(b===g)throw new t.ParseError(g,"date");const _=b.split("!"),S=_.slice(0,-1).map(Number),T={year:S[0]*S[1],month:S[2],day:S[3],...s(_[4])};if(!(T.month>=1&&T.month<=12)||!(T.day>=1&&T.day<=(0,r.maximumDayInMonthFor)(T.year,T.month)))throw new t.ParseError(g,"date");return T}Parsing.parseDate=c;function l(g){const b=g.replaceAll(/^(\d\d):(\d\d):(\d\d(\.\d+)?)(Z|([+-]\d\d:\d\d))?$/gu,"$1!$2!$3!$5");if(b===g)throw new t.ParseError(g,"time");const _=b.split("!"),S=_.slice(0,-1).map(Number),T={hours:S[0],minutes:S[1],seconds:S[2],...s(_[3])};if(T.seconds>=60||T.minutes>=60||T.hours>24||T.hours===24&&(T.minutes!==0||T.seconds!==0))throw new t.ParseError(g,"time");return T}function d(g){const b=l(g);return b.hours%=24,b}Parsing.parseTime=d;function f(g){const[b,_]=g.split("T"),S=b.replaceAll(/^(-)?P(\d+Y)?(\d+M)?(\d+D)?$/gu,"$11S!$2!$3!$4");if(S===b)throw new t.ParseError(g,"duration");const T=S.split("!");if(_!==void 0){const R=_.replaceAll(/^(\d+H)?(\d+M)?(\d+(\.\d+)?S)?$/gu,"$1!$2!$3");if(_===""||_===R)throw new t.ParseError(g,"duration");T.push(...R.split("!"))}const w=T.map(R=>R.slice(0,-1));if(!w.slice(1).some(Boolean))throw new t.ParseError(g,"duration");const A=Number(w[0]);return(0,n.simplifyDurationRepresentation)({year:w[1]?A*Number(w[1]):void 0,month:w[2]?A*Number(w[2]):void 0,day:w[3]?A*Number(w[3]):void 0,hours:w[4]?A*Number(w[4]):void 0,minutes:w[5]?A*Number(w[5]):void 0,seconds:w[6]?A*Number(w[6]):void 0})}Parsing.parseDuration=f;function h(g){const b=f(g);if(["hours","minutes","seconds","day"].some(_=>!!b[_]))throw new t.ParseError(g,"yearMonthDuration");return b}Parsing.parseYearMonthDuration=h;function v(g){const b=f(g);if(["year","month"].some(_=>!!b[_]))throw new t.ParseError(g,"dayTimeDuration");return b}return Parsing.parseDayTimeDuration=v,Parsing}var hasRequiredTermTransformer;function requireTermTransformer(){if(hasRequiredTermTransformer)return TermTransformer;hasRequiredTermTransformer=1,Object.defineProperty(TermTransformer,"__esModule",{value:!0}),TermTransformer.TermTransformer=void 0;const n=requireRdfString(),t=requireSparqlalgebrajs(),r=requireExpressions(),a=requireConsts(),o=requireErrors$1(),u=requireErrors$1(),s=requireParsing(),c=requireParsing(),l=requireTypeHandling();let d=class{constructor(h){this.superTypeProvider=h}transformRDFTermUnsafe(h){return this.transformTerm({term:h,type:t.Algebra.types.EXPRESSION,expressionType:t.Algebra.expressionTypes.TERM})}transformTerm(h){if(!h.term)throw new o.InvalidExpression(h);switch(h.term.termType){case"Variable":return new r.Variable(n.termToString(h.term));case"Literal":return this.transformLiteral(h.term);case"NamedNode":return new r.NamedNode(h.term.value);case"BlankNode":return new r.BlankNode(h.term.value);case"Quad":return new r.Quad(this.transformRDFTermUnsafe(h.term.subject),this.transformRDFTermUnsafe(h.term.predicate),this.transformRDFTermUnsafe(h.term.object),this.transformRDFTermUnsafe(h.term.graph));case"DefaultGraph":return new r.DefaultGraph}}transformLiteral(h){if(!h.datatype||[null,void 0,""].includes(h.datatype.value))return h.language?new r.LangStringLiteral(h.value,h.language):new r.StringLiteral(h.value);const v=h.datatype.value,g=(0,l.getSuperTypeDict)(v,this.superTypeProvider);try{if(a.TypeURL.XSD_STRING in g)return new r.StringLiteral(h.value,v);if(a.TypeURL.RDF_LANG_STRING in g)return new r.LangStringLiteral(h.value,h.language);if(a.TypeURL.XSD_YEAR_MONTH_DURATION in g)return new r.YearMonthDurationLiteral((0,s.parseYearMonthDuration)(h.value),h.value,v);if(a.TypeURL.XSD_DAY_TIME_DURATION in g)return new r.DayTimeDurationLiteral((0,s.parseDayTimeDuration)(h.value),h.value,v);if(a.TypeURL.XSD_DURATION in g)return new r.DurationLiteral((0,s.parseDuration)(h.value),h.value,v);if(a.TypeURL.XSD_DATE_TIME in g){const S=new Date(h.value);return Number.isNaN(S.getTime())?new r.NonLexicalLiteral(void 0,v,this.superTypeProvider,h.value):new r.DateTimeLiteral((0,s.parseDateTime)(h.value),h.value,v)}if(a.TypeURL.XSD_DATE in g)return new r.DateLiteral((0,s.parseDate)(h.value),h.value,v);if(a.TypeURL.XSD_TIME in g)return new r.TimeLiteral((0,s.parseTime)(h.value),h.value,v);if(a.TypeURL.XSD_BOOLEAN in g)return h.value!=="true"&&h.value!=="false"&&h.value!=="1"&&h.value!=="0"?new r.NonLexicalLiteral(void 0,v,this.superTypeProvider,h.value):new r.BooleanLiteral(h.value==="true"||h.value==="1",h.value);if(a.TypeURL.XSD_DECIMAL in g){const S=c.parseXSDDecimal(h.value);return S===void 0?new r.NonLexicalLiteral(void 0,v,this.superTypeProvider,h.value):a.TypeURL.XSD_INTEGER in g?new r.IntegerLiteral(S,v,h.value):new r.DecimalLiteral(S,v,h.value)}const b=a.TypeURL.XSD_FLOAT in g,_=a.TypeURL.XSD_DOUBLE in g;if(b||_){const S=c.parseXSDFloat(h.value);return S===void 0?new r.NonLexicalLiteral(void 0,v,this.superTypeProvider,h.value):b?new r.FloatLiteral(S,v,h.value):new r.DoubleLiteral(S,v,h.value)}return new r.Literal(h.value,v,h.value)}catch(b){if((0,u.isExpressionError)(b))return new r.NonLexicalLiteral(void 0,v,this.superTypeProvider,h.value);throw b}}};return TermTransformer.TermTransformer=d,TermTransformer}var Context={},commonjs$1={},hasRequiredCommonjs$1;function requireCommonjs$1(){var v,g,_,S,T,w,A,R,E,I,L,F,D,$,O,P,C,q,M,N,G,X,Y,W,te,ue,fe,re,oi,Te,Re,ve,ce,Xi,j,z,B,hr,pr,ui,Ln,$n,wt,si,tn,vr,ci;if(hasRequiredCommonjs$1)return commonjs$1;hasRequiredCommonjs$1=1,Object.defineProperty(commonjs$1,"__esModule",{value:!0}),commonjs$1.LRUCache=void 0;const n=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,t=new Set,r=typeof process=="object"&&process?process:{},a=(Ce,pe,H,V)=>{typeof r.emitWarning=="function"?r.emitWarning(Ce,pe,H,V):console.error(`[${H}] ${pe}: ${Ce}`)};let o=globalThis.AbortController,u=globalThis.AbortSignal;if(typeof o>"u"){u=class{constructor(){Et(this,"onabort");Et(this,"_onabort",[]);Et(this,"reason");Et(this,"aborted",!1)}addEventListener(V,Q){this._onabort.push(Q)}},o=class{constructor(){Et(this,"signal",new u);pe()}abort(V){var Q,ee;if(!this.signal.aborted){this.signal.reason=V,this.signal.aborted=!0;for(const ae of this.signal._onabort)ae(V);(ee=(Q=this.signal).onabort)==null||ee.call(Q,V)}}};let Ce=((v=r.env)==null?void 0:v.LRU_CACHE_IGNORE_AC_WARNING)!=="1";const pe=()=>{Ce&&(Ce=!1,a("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",pe))}}const s=Ce=>!t.has(Ce),c=Ce=>Ce&&Ce===Math.floor(Ce)&&Ce>0&&isFinite(Ce),l=Ce=>c(Ce)?Ce<=Math.pow(2,8)?Uint8Array:Ce<=Math.pow(2,16)?Uint16Array:Ce<=Math.pow(2,32)?Uint32Array:Ce<=Number.MAX_SAFE_INTEGER?d:null:null;class d extends Array{constructor(pe){super(pe),this.fill(0)}}const b=class b{constructor(pe,H){Et(this,"heap");Et(this,"length");if(!Oe(b,g))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new H(pe),this.length=0}static create(pe){const H=l(pe);if(!H)return[];ht(b,g,!0);const V=new b(pe,H);return ht(b,g,!1),V}push(pe){this.heap[this.length++]=pe}pop(){return this.heap[--this.length]}};g=new WeakMap,_t(b,g,!1);let f=b;const Pe=class Pe{constructor(pe){_t(this,re);_t(this,T);_t(this,w);_t(this,A);_t(this,R);_t(this,E);_t(this,I);Et(this,"ttl");Et(this,"ttlResolution");Et(this,"ttlAutopurge");Et(this,"updateAgeOnGet");Et(this,"updateAgeOnHas");Et(this,"allowStale");Et(this,"noDisposeOnSet");Et(this,"noUpdateTTL");Et(this,"maxEntrySize");Et(this,"sizeCalculation");Et(this,"noDeleteOnFetchRejection");Et(this,"noDeleteOnStaleGet");Et(this,"allowStaleOnFetchAbort");Et(this,"allowStaleOnFetchRejection");Et(this,"ignoreFetchAbort");_t(this,L);_t(this,F);_t(this,D);_t(this,$);_t(this,O);_t(this,P);_t(this,C);_t(this,q);_t(this,M);_t(this,N);_t(this,G);_t(this,X);_t(this,Y);_t(this,W);_t(this,te);_t(this,ue);_t(this,fe);_t(this,Te,()=>{});_t(this,Re,()=>{});_t(this,ve,()=>{});_t(this,ce,()=>!1);_t(this,j,pe=>{});_t(this,z,(pe,H,V)=>{});_t(this,B,(pe,H,V,Q)=>{if(V||Q)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});Et(this,_,"LRUCache");const{max:H=0,ttl:V,ttlResolution:Q=1,ttlAutopurge:ee,updateAgeOnGet:ae,updateAgeOnHas:be,allowStale:le,dispose:we,disposeAfter:De,noDisposeOnSet:Fe,noUpdateTTL:Ne,maxSize:de=0,maxEntrySize:Le=0,sizeCalculation:$e,fetchMethod:je,memoMethod:Me,noDeleteOnFetchRejection:ze,noDeleteOnStaleGet:Je,allowStaleOnFetchRejection:Ke,allowStaleOnFetchAbort:ot,ignoreFetchAbort:_e}=pe;if(H!==0&&!c(H))throw new TypeError("max option must be a nonnegative integer");const Ae=H?l(H):Array;if(!Ae)throw new Error("invalid max value: "+H);if(ht(this,T,H),ht(this,w,de),this.maxEntrySize=Le||Oe(this,w),this.sizeCalculation=$e,this.sizeCalculation){if(!Oe(this,w)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(Me!==void 0&&typeof Me!="function")throw new TypeError("memoMethod must be a function if defined");if(ht(this,I,Me),je!==void 0&&typeof je!="function")throw new TypeError("fetchMethod must be a function if specified");if(ht(this,E,je),ht(this,ue,!!je),ht(this,D,new Map),ht(this,$,new Array(H).fill(void 0)),ht(this,O,new Array(H).fill(void 0)),ht(this,P,new Ae(H)),ht(this,C,new Ae(H)),ht(this,q,0),ht(this,M,0),ht(this,N,f.create(H)),ht(this,L,0),ht(this,F,0),typeof we=="function"&&ht(this,A,we),typeof De=="function"?(ht(this,R,De),ht(this,G,[])):(ht(this,R,void 0),ht(this,G,void 0)),ht(this,te,!!Oe(this,A)),ht(this,fe,!!Oe(this,R)),this.noDisposeOnSet=!!Fe,this.noUpdateTTL=!!Ne,this.noDeleteOnFetchRejection=!!ze,this.allowStaleOnFetchRejection=!!Ke,this.allowStaleOnFetchAbort=!!ot,this.ignoreFetchAbort=!!_e,this.maxEntrySize!==0){if(Oe(this,w)!==0&&!c(Oe(this,w)))throw new TypeError("maxSize must be a positive integer if specified");if(!c(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");st(this,re,Xi).call(this)}if(this.allowStale=!!le,this.noDeleteOnStaleGet=!!Je,this.updateAgeOnGet=!!ae,this.updateAgeOnHas=!!be,this.ttlResolution=c(Q)||Q===0?Q:1,this.ttlAutopurge=!!ee,this.ttl=V||0,this.ttl){if(!c(this.ttl))throw new TypeError("ttl must be a positive integer if specified");st(this,re,oi).call(this)}if(Oe(this,T)===0&&this.ttl===0&&Oe(this,w)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!Oe(this,T)&&!Oe(this,w)){const Ve="LRU_CACHE_UNBOUNDED";s(Ve)&&(t.add(Ve),a("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",Ve,Pe))}}static unsafeExposeInternals(pe){return{starts:Oe(pe,Y),ttls:Oe(pe,W),sizes:Oe(pe,X),keyMap:Oe(pe,D),keyList:Oe(pe,$),valList:Oe(pe,O),next:Oe(pe,P),prev:Oe(pe,C),get head(){return Oe(pe,q)},get tail(){return Oe(pe,M)},free:Oe(pe,N),isBackgroundFetch:H=>{var V;return st(V=pe,re,wt).call(V,H)},backgroundFetch:(H,V,Q,ee)=>{var ae;return st(ae=pe,re,$n).call(ae,H,V,Q,ee)},moveToTail:H=>{var V;return st(V=pe,re,tn).call(V,H)},indexes:H=>{var V;return st(V=pe,re,hr).call(V,H)},rindexes:H=>{var V;return st(V=pe,re,pr).call(V,H)},isStale:H=>{var V;return Oe(V=pe,ce).call(V,H)}}}get max(){return Oe(this,T)}get maxSize(){return Oe(this,w)}get calculatedSize(){return Oe(this,F)}get size(){return Oe(this,L)}get fetchMethod(){return Oe(this,E)}get memoMethod(){return Oe(this,I)}get dispose(){return Oe(this,A)}get disposeAfter(){return Oe(this,R)}getRemainingTTL(pe){return Oe(this,D).has(pe)?1/0:0}*entries(){for(const pe of st(this,re,hr).call(this))Oe(this,O)[pe]!==void 0&&Oe(this,$)[pe]!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield[Oe(this,$)[pe],Oe(this,O)[pe]])}*rentries(){for(const pe of st(this,re,pr).call(this))Oe(this,O)[pe]!==void 0&&Oe(this,$)[pe]!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield[Oe(this,$)[pe],Oe(this,O)[pe]])}*keys(){for(const pe of st(this,re,hr).call(this)){const H=Oe(this,$)[pe];H!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield H)}}*rkeys(){for(const pe of st(this,re,pr).call(this)){const H=Oe(this,$)[pe];H!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield H)}}*values(){for(const pe of st(this,re,hr).call(this))Oe(this,O)[pe]!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield Oe(this,O)[pe])}*rvalues(){for(const pe of st(this,re,pr).call(this))Oe(this,O)[pe]!==void 0&&!st(this,re,wt).call(this,Oe(this,O)[pe])&&(yield Oe(this,O)[pe])}[(S=Symbol.iterator,_=Symbol.toStringTag,S)](){return this.entries()}find(pe,H={}){for(const V of st(this,re,hr).call(this)){const Q=Oe(this,O)[V],ee=st(this,re,wt).call(this,Q)?Q.__staleWhileFetching:Q;if(ee!==void 0&&pe(ee,Oe(this,$)[V],this))return this.get(Oe(this,$)[V],H)}}forEach(pe,H=this){for(const V of st(this,re,hr).call(this)){const Q=Oe(this,O)[V],ee=st(this,re,wt).call(this,Q)?Q.__staleWhileFetching:Q;ee!==void 0&&pe.call(H,ee,Oe(this,$)[V],this)}}rforEach(pe,H=this){for(const V of st(this,re,pr).call(this)){const Q=Oe(this,O)[V],ee=st(this,re,wt).call(this,Q)?Q.__staleWhileFetching:Q;ee!==void 0&&pe.call(H,ee,Oe(this,$)[V],this)}}purgeStale(){let pe=!1;for(const H of st(this,re,pr).call(this,{allowStale:!0}))Oe(this,ce).call(this,H)&&(st(this,re,vr).call(this,Oe(this,$)[H],"expire"),pe=!0);return pe}info(pe){const H=Oe(this,D).get(pe);if(H===void 0)return;const V=Oe(this,O)[H],Q=st(this,re,wt).call(this,V)?V.__staleWhileFetching:V;if(Q===void 0)return;const ee={value:Q};if(Oe(this,W)&&Oe(this,Y)){const ae=Oe(this,W)[H],be=Oe(this,Y)[H];if(ae&&be){const le=ae-(n.now()-be);ee.ttl=le,ee.start=Date.now()}}return Oe(this,X)&&(ee.size=Oe(this,X)[H]),ee}dump(){const pe=[];for(const H of st(this,re,hr).call(this,{allowStale:!0})){const V=Oe(this,$)[H],Q=Oe(this,O)[H],ee=st(this,re,wt).call(this,Q)?Q.__staleWhileFetching:Q;if(ee===void 0||V===void 0)continue;const ae={value:ee};if(Oe(this,W)&&Oe(this,Y)){ae.ttl=Oe(this,W)[H];const be=n.now()-Oe(this,Y)[H];ae.start=Math.floor(Date.now()-be)}Oe(this,X)&&(ae.size=Oe(this,X)[H]),pe.unshift([V,ae])}return pe}load(pe){this.clear();for(const[H,V]of pe){if(V.start){const Q=Date.now()-V.start;V.start=n.now()-Q}this.set(H,V.value,V)}}set(pe,H,V={}){var Ne,de,Le,$e,je;if(H===void 0)return this.delete(pe),this;const{ttl:Q=this.ttl,start:ee,noDisposeOnSet:ae=this.noDisposeOnSet,sizeCalculation:be=this.sizeCalculation,status:le}=V;let{noUpdateTTL:we=this.noUpdateTTL}=V;const De=Oe(this,B).call(this,pe,H,V.size||0,be);if(this.maxEntrySize&&De>this.maxEntrySize)return le&&(le.set="miss",le.maxEntrySizeExceeded=!0),st(this,re,vr).call(this,pe,"set"),this;let Fe=Oe(this,L)===0?void 0:Oe(this,D).get(pe);if(Fe===void 0)Fe=Oe(this,L)===0?Oe(this,M):Oe(this,N).length!==0?Oe(this,N).pop():Oe(this,L)===Oe(this,T)?st(this,re,Ln).call(this,!1):Oe(this,L),Oe(this,$)[Fe]=pe,Oe(this,O)[Fe]=H,Oe(this,D).set(pe,Fe),Oe(this,P)[Oe(this,M)]=Fe,Oe(this,C)[Fe]=Oe(this,M),ht(this,M,Fe),On(this,L)._++,Oe(this,z).call(this,Fe,De,le),le&&(le.set="add"),we=!1;else{st(this,re,tn).call(this,Fe);const Me=Oe(this,O)[Fe];if(H!==Me){if(Oe(this,ue)&&st(this,re,wt).call(this,Me)){Me.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:ze}=Me;ze!==void 0&&!ae&&(Oe(this,te)&&((Ne=Oe(this,A))==null||Ne.call(this,ze,pe,"set")),Oe(this,fe)&&((de=Oe(this,G))==null||de.push([ze,pe,"set"])))}else ae||(Oe(this,te)&&((Le=Oe(this,A))==null||Le.call(this,Me,pe,"set")),Oe(this,fe)&&(($e=Oe(this,G))==null||$e.push([Me,pe,"set"])));if(Oe(this,j).call(this,Fe),Oe(this,z).call(this,Fe,De,le),Oe(this,O)[Fe]=H,le){le.set="replace";const ze=Me&&st(this,re,wt).call(this,Me)?Me.__staleWhileFetching:Me;ze!==void 0&&(le.oldValue=ze)}}else le&&(le.set="update")}if(Q!==0&&!Oe(this,W)&&st(this,re,oi).call(this),Oe(this,W)&&(we||Oe(this,ve).call(this,Fe,Q,ee),le&&Oe(this,Re).call(this,le,Fe)),!ae&&Oe(this,fe)&&Oe(this,G)){const Me=Oe(this,G);let ze;for(;ze=Me==null?void 0:Me.shift();)(je=Oe(this,R))==null||je.call(this,...ze)}return this}pop(){var pe;try{for(;Oe(this,L);){const H=Oe(this,O)[Oe(this,q)];if(st(this,re,Ln).call(this,!0),st(this,re,wt).call(this,H)){if(H.__staleWhileFetching)return H.__staleWhileFetching}else if(H!==void 0)return H}}finally{if(Oe(this,fe)&&Oe(this,G)){const H=Oe(this,G);let V;for(;V=H==null?void 0:H.shift();)(pe=Oe(this,R))==null||pe.call(this,...V)}}}has(pe,H={}){const{updateAgeOnHas:V=this.updateAgeOnHas,status:Q}=H,ee=Oe(this,D).get(pe);if(ee!==void 0){const ae=Oe(this,O)[ee];if(st(this,re,wt).call(this,ae)&&ae.__staleWhileFetching===void 0)return!1;if(Oe(this,ce).call(this,ee))Q&&(Q.has="stale",Oe(this,Re).call(this,Q,ee));else return V&&Oe(this,Te).call(this,ee),Q&&(Q.has="hit",Oe(this,Re).call(this,Q,ee)),!0}else Q&&(Q.has="miss");return!1}peek(pe,H={}){const{allowStale:V=this.allowStale}=H,Q=Oe(this,D).get(pe);if(Q===void 0||!V&&Oe(this,ce).call(this,Q))return;const ee=Oe(this,O)[Q];return st(this,re,wt).call(this,ee)?ee.__staleWhileFetching:ee}async fetch(pe,H={}){const{allowStale:V=this.allowStale,updateAgeOnGet:Q=this.updateAgeOnGet,noDeleteOnStaleGet:ee=this.noDeleteOnStaleGet,ttl:ae=this.ttl,noDisposeOnSet:be=this.noDisposeOnSet,size:le=0,sizeCalculation:we=this.sizeCalculation,noUpdateTTL:De=this.noUpdateTTL,noDeleteOnFetchRejection:Fe=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:Ne=this.allowStaleOnFetchRejection,ignoreFetchAbort:de=this.ignoreFetchAbort,allowStaleOnFetchAbort:Le=this.allowStaleOnFetchAbort,context:$e,forceRefresh:je=!1,status:Me,signal:ze}=H;if(!Oe(this,ue))return Me&&(Me.fetch="get"),this.get(pe,{allowStale:V,updateAgeOnGet:Q,noDeleteOnStaleGet:ee,status:Me});const Je={allowStale:V,updateAgeOnGet:Q,noDeleteOnStaleGet:ee,ttl:ae,noDisposeOnSet:be,size:le,sizeCalculation:we,noUpdateTTL:De,noDeleteOnFetchRejection:Fe,allowStaleOnFetchRejection:Ne,allowStaleOnFetchAbort:Le,ignoreFetchAbort:de,status:Me,signal:ze};let Ke=Oe(this,D).get(pe);if(Ke===void 0){Me&&(Me.fetch="miss");const ot=st(this,re,$n).call(this,pe,Ke,Je,$e);return ot.__returned=ot}else{const ot=Oe(this,O)[Ke];if(st(this,re,wt).call(this,ot)){const We=V&&ot.__staleWhileFetching!==void 0;return Me&&(Me.fetch="inflight",We&&(Me.returnedStale=!0)),We?ot.__staleWhileFetching:ot.__returned=ot}const _e=Oe(this,ce).call(this,Ke);if(!je&&!_e)return Me&&(Me.fetch="hit"),st(this,re,tn).call(this,Ke),Q&&Oe(this,Te).call(this,Ke),Me&&Oe(this,Re).call(this,Me,Ke),ot;const Ae=st(this,re,$n).call(this,pe,Ke,Je,$e),Ue=Ae.__staleWhileFetching!==void 0&&V;return Me&&(Me.fetch=_e?"stale":"refresh",Ue&&_e&&(Me.returnedStale=!0)),Ue?Ae.__staleWhileFetching:Ae.__returned=Ae}}async forceFetch(pe,H={}){const V=await this.fetch(pe,H);if(V===void 0)throw new Error("fetch() returned undefined");return V}memo(pe,H={}){const V=Oe(this,I);if(!V)throw new Error("no memoMethod provided to constructor");const{context:Q,forceRefresh:ee,...ae}=H,be=this.get(pe,ae);if(!ee&&be!==void 0)return be;const le=V(pe,be,{options:ae,context:Q});return this.set(pe,le,ae),le}get(pe,H={}){const{allowStale:V=this.allowStale,updateAgeOnGet:Q=this.updateAgeOnGet,noDeleteOnStaleGet:ee=this.noDeleteOnStaleGet,status:ae}=H,be=Oe(this,D).get(pe);if(be!==void 0){const le=Oe(this,O)[be],we=st(this,re,wt).call(this,le);return ae&&Oe(this,Re).call(this,ae,be),Oe(this,ce).call(this,be)?(ae&&(ae.get="stale"),we?(ae&&V&&le.__staleWhileFetching!==void 0&&(ae.returnedStale=!0),V?le.__staleWhileFetching:void 0):(ee||st(this,re,vr).call(this,pe,"expire"),ae&&V&&(ae.returnedStale=!0),V?le:void 0)):(ae&&(ae.get="hit"),we?le.__staleWhileFetching:(st(this,re,tn).call(this,be),Q&&Oe(this,Te).call(this,be),le))}else ae&&(ae.get="miss")}delete(pe){return st(this,re,vr).call(this,pe,"delete")}clear(){return st(this,re,ci).call(this,"delete")}};T=new WeakMap,w=new WeakMap,A=new WeakMap,R=new WeakMap,E=new WeakMap,I=new WeakMap,L=new WeakMap,F=new WeakMap,D=new WeakMap,$=new WeakMap,O=new WeakMap,P=new WeakMap,C=new WeakMap,q=new WeakMap,M=new WeakMap,N=new WeakMap,G=new WeakMap,X=new WeakMap,Y=new WeakMap,W=new WeakMap,te=new WeakMap,ue=new WeakMap,fe=new WeakMap,re=new WeakSet,oi=function(){const pe=new d(Oe(this,T)),H=new d(Oe(this,T));ht(this,W,pe),ht(this,Y,H),ht(this,ve,(ee,ae,be=n.now())=>{if(H[ee]=ae!==0?be:0,pe[ee]=ae,ae!==0&&this.ttlAutopurge){const le=setTimeout(()=>{Oe(this,ce).call(this,ee)&&st(this,re,vr).call(this,Oe(this,$)[ee],"expire")},ae+1);le.unref&&le.unref()}}),ht(this,Te,ee=>{H[ee]=pe[ee]!==0?n.now():0}),ht(this,Re,(ee,ae)=>{if(pe[ae]){const be=pe[ae],le=H[ae];if(!be||!le)return;ee.ttl=be,ee.start=le,ee.now=V||Q();const we=ee.now-le;ee.remainingTTL=be-we}});let V=0;const Q=()=>{const ee=n.now();if(this.ttlResolution>0){V=ee;const ae=setTimeout(()=>V=0,this.ttlResolution);ae.unref&&ae.unref()}return ee};this.getRemainingTTL=ee=>{const ae=Oe(this,D).get(ee);if(ae===void 0)return 0;const be=pe[ae],le=H[ae];if(!be||!le)return 1/0;const we=(V||Q())-le;return be-we},ht(this,ce,ee=>{const ae=H[ee],be=pe[ee];return!!be&&!!ae&&(V||Q())-ae>be})},Te=new WeakMap,Re=new WeakMap,ve=new WeakMap,ce=new WeakMap,Xi=function(){const pe=new d(Oe(this,T));ht(this,F,0),ht(this,X,pe),ht(this,j,H=>{ht(this,F,Oe(this,F)-pe[H]),pe[H]=0}),ht(this,B,(H,V,Q,ee)=>{if(st(this,re,wt).call(this,V))return 0;if(!c(Q))if(ee){if(typeof ee!="function")throw new TypeError("sizeCalculation must be a function");if(Q=ee(V,H),!c(Q))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return Q}),ht(this,z,(H,V,Q)=>{if(pe[H]=V,Oe(this,w)){const ee=Oe(this,w)-pe[H];for(;Oe(this,F)>ee;)st(this,re,Ln).call(this,!0)}ht(this,F,Oe(this,F)+pe[H]),Q&&(Q.entrySize=V,Q.totalCalculatedSize=Oe(this,F))})},j=new WeakMap,z=new WeakMap,B=new WeakMap,hr=function*({allowStale:pe=this.allowStale}={}){if(Oe(this,L))for(let H=Oe(this,M);!(!st(this,re,ui).call(this,H)||((pe||!Oe(this,ce).call(this,H))&&(yield H),H===Oe(this,q)));)H=Oe(this,C)[H]},pr=function*({allowStale:pe=this.allowStale}={}){if(Oe(this,L))for(let H=Oe(this,q);!(!st(this,re,ui).call(this,H)||((pe||!Oe(this,ce).call(this,H))&&(yield H),H===Oe(this,M)));)H=Oe(this,P)[H]},ui=function(pe){return pe!==void 0&&Oe(this,D).get(Oe(this,$)[pe])===pe},Ln=function(pe){var ee,ae;const H=Oe(this,q),V=Oe(this,$)[H],Q=Oe(this,O)[H];return Oe(this,ue)&&st(this,re,wt).call(this,Q)?Q.__abortController.abort(new Error("evicted")):(Oe(this,te)||Oe(this,fe))&&(Oe(this,te)&&((ee=Oe(this,A))==null||ee.call(this,Q,V,"evict")),Oe(this,fe)&&((ae=Oe(this,G))==null||ae.push([Q,V,"evict"]))),Oe(this,j).call(this,H),pe&&(Oe(this,$)[H]=void 0,Oe(this,O)[H]=void 0,Oe(this,N).push(H)),Oe(this,L)===1?(ht(this,q,ht(this,M,0)),Oe(this,N).length=0):ht(this,q,Oe(this,P)[H]),Oe(this,D).delete(V),On(this,L)._--,H},$n=function(pe,H,V,Q){const ee=H===void 0?void 0:Oe(this,O)[H];if(st(this,re,wt).call(this,ee))return ee;const ae=new o,{signal:be}=V;be==null||be.addEventListener("abort",()=>ae.abort(be.reason),{signal:ae.signal});const le={signal:ae.signal,options:V,context:Q},we=($e,je=!1)=>{const{aborted:Me}=ae.signal,ze=V.ignoreFetchAbort&&$e!==void 0;if(V.status&&(Me&&!je?(V.status.fetchAborted=!0,V.status.fetchError=ae.signal.reason,ze&&(V.status.fetchAbortIgnored=!0)):V.status.fetchResolved=!0),Me&&!ze&&!je)return Fe(ae.signal.reason);const Je=de;return Oe(this,O)[H]===de&&($e===void 0?Je.__staleWhileFetching?Oe(this,O)[H]=Je.__staleWhileFetching:st(this,re,vr).call(this,pe,"fetch"):(V.status&&(V.status.fetchUpdated=!0),this.set(pe,$e,le.options))),$e},De=$e=>(V.status&&(V.status.fetchRejected=!0,V.status.fetchError=$e),Fe($e)),Fe=$e=>{const{aborted:je}=ae.signal,Me=je&&V.allowStaleOnFetchAbort,ze=Me||V.allowStaleOnFetchRejection,Je=ze||V.noDeleteOnFetchRejection,Ke=de;if(Oe(this,O)[H]===de&&(!Je||Ke.__staleWhileFetching===void 0?st(this,re,vr).call(this,pe,"fetch"):Me||(Oe(this,O)[H]=Ke.__staleWhileFetching)),ze)return V.status&&Ke.__staleWhileFetching!==void 0&&(V.status.returnedStale=!0),Ke.__staleWhileFetching;if(Ke.__returned===Ke)throw $e},Ne=($e,je)=>{var ze;const Me=(ze=Oe(this,E))==null?void 0:ze.call(this,pe,ee,le);Me&&Me instanceof Promise&&Me.then(Je=>$e(Je===void 0?void 0:Je),je),ae.signal.addEventListener("abort",()=>{(!V.ignoreFetchAbort||V.allowStaleOnFetchAbort)&&($e(void 0),V.allowStaleOnFetchAbort&&($e=Je=>we(Je,!0)))})};V.status&&(V.status.fetchDispatched=!0);const de=new Promise(Ne).then(we,De),Le=Object.assign(de,{__abortController:ae,__staleWhileFetching:ee,__returned:void 0});return H===void 0?(this.set(pe,Le,{...le.options,status:void 0}),H=Oe(this,D).get(pe)):Oe(this,O)[H]=Le,Le},wt=function(pe){if(!Oe(this,ue))return!1;const H=pe;return!!H&&H instanceof Promise&&H.hasOwnProperty("__staleWhileFetching")&&H.__abortController instanceof o},si=function(pe,H){Oe(this,C)[H]=pe,Oe(this,P)[pe]=H},tn=function(pe){pe!==Oe(this,M)&&(pe===Oe(this,q)?ht(this,q,Oe(this,P)[pe]):st(this,re,si).call(this,Oe(this,C)[pe],Oe(this,P)[pe]),st(this,re,si).call(this,Oe(this,M),pe),ht(this,M,pe))},vr=function(pe,H){var Q,ee,ae,be;let V=!1;if(Oe(this,L)!==0){const le=Oe(this,D).get(pe);if(le!==void 0)if(V=!0,Oe(this,L)===1)st(this,re,ci).call(this,H);else{Oe(this,j).call(this,le);const we=Oe(this,O)[le];if(st(this,re,wt).call(this,we)?we.__abortController.abort(new Error("deleted")):(Oe(this,te)||Oe(this,fe))&&(Oe(this,te)&&((Q=Oe(this,A))==null||Q.call(this,we,pe,H)),Oe(this,fe)&&((ee=Oe(this,G))==null||ee.push([we,pe,H]))),Oe(this,D).delete(pe),Oe(this,$)[le]=void 0,Oe(this,O)[le]=void 0,le===Oe(this,M))ht(this,M,Oe(this,C)[le]);else if(le===Oe(this,q))ht(this,q,Oe(this,P)[le]);else{const De=Oe(this,C)[le];Oe(this,P)[De]=Oe(this,P)[le];const Fe=Oe(this,P)[le];Oe(this,C)[Fe]=Oe(this,C)[le]}On(this,L)._--,Oe(this,N).push(le)}}if(Oe(this,fe)&&((ae=Oe(this,G))!=null&&ae.length)){const le=Oe(this,G);let we;for(;we=le==null?void 0:le.shift();)(be=Oe(this,R))==null||be.call(this,...we)}return V},ci=function(pe){var H,V,Q;for(const ee of st(this,re,pr).call(this,{allowStale:!0})){const ae=Oe(this,O)[ee];if(st(this,re,wt).call(this,ae))ae.__abortController.abort(new Error("deleted"));else{const be=Oe(this,$)[ee];Oe(this,te)&&((H=Oe(this,A))==null||H.call(this,ae,be,pe)),Oe(this,fe)&&((V=Oe(this,G))==null||V.push([ae,be,pe]))}}if(Oe(this,D).clear(),Oe(this,O).fill(void 0),Oe(this,$).fill(void 0),Oe(this,W)&&Oe(this,Y)&&(Oe(this,W).fill(0),Oe(this,Y).fill(0)),Oe(this,X)&&Oe(this,X).fill(0),ht(this,q,0),ht(this,M,0),Oe(this,N).length=0,ht(this,F,0),ht(this,L,0),Oe(this,fe)&&Oe(this,G)){const ee=Oe(this,G);let ae;for(;ae=ee==null?void 0:ee.shift();)(Q=Oe(this,R))==null||Q.call(this,...ae)}};let h=Pe;return commonjs$1.LRUCache=h,commonjs$1}var hasRequiredContext;function requireContext(){if(hasRequiredContext)return Context;hasRequiredContext=1,Object.defineProperty(Context,"__esModule",{value:!0}),Context.prepareEvaluatorActionContext=void 0;const n=requireLib$4q(),t=requireCommonjs$1(),r=requireDateTimeHelpers();function a(o){let u=o;if(u.has(n.KeysInitQuery.extensionFunctionCreator)&&u.has(n.KeysInitQuery.extensionFunctions))throw new Error("Illegal simultaneous usage of extensionFunctionCreator and extensionFunctions in context");if(u.has(n.KeysInitQuery.extensionFunctionCreator))u=u.set(n.KeysExpressionEvaluator.extensionFunctionCreator,u.get(n.KeysInitQuery.extensionFunctionCreator));else if(u.has(n.KeysInitQuery.extensionFunctions)){const s=u.getSafe(n.KeysInitQuery.extensionFunctions);u=u.set(n.KeysExpressionEvaluator.extensionFunctionCreator,async c=>s[c.value])}else u=u.setDefault(n.KeysExpressionEvaluator.extensionFunctionCreator,async()=>{});return u=u.setDefault(n.KeysExpressionEvaluator.defaultTimeZone,(0,r.extractTimeZone)(u.getSafe(n.KeysInitQuery.queryTimestamp))),u=u.setDefault(n.KeysExpressionEvaluator.superTypeProvider,{cache:new t.LRUCache({max:1e3}),discoverer:()=>"term"}),u}return Context.prepareEvaluatorActionContext=a,Context}var hasRequiredLib$4n;function requireLib$4n(){return hasRequiredLib$4n||(hasRequiredLib$4n=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.LangStringLiteral=n.TimeLiteral=n.DurationLiteral=n.DateLiteral=n.DayTimeDurationLiteral=n.DateTimeLiteral=n.yearMonthDurationsToMonths=n.toUTCDate=n.toDateTimeRepresentation=n.negateDuration=n.extractRawTimeZone=n.defaultedYearMonthDurationRepresentation=n.defaultedDurationRepresentation=n.defaultedDayTimeDurationRepresentation=n.defaultedDateTimeRepresentation=n.dayTimeDurationsToSeconds=n.isSubTypeOf=n.SparqlOperator=n.TypeAlias=n.TypeURL=n.typedLiteral=n.InvalidArity=n.InvalidLexicalForm=n.ExtensionFunctionError=n.CastError=n.UnboundVariableError=n.NoAggregator=n.InError=n.CoalesceError=n.InvalidArgumentTypes=n.InvalidTimezoneCall=n.IncompatibleLanguageOperation=n.RDFEqualTypeError=n.EmptyAggregateError=n.isExpressionError=n.ExpressionError=n.Builder=n.expressionToVar=n.float=n.decimal=n.langString=n.dateTime=n.integer=n.double=n.string=n.bool=n.declare=n.prepareEvaluatorActionContext=n.OverloadTree=n.TermTransformer=void 0,n.trimToDayTimeDuration=n.trimToYearMonthDuration=n.parseDate=n.parseXSDFloat=n.parseXSDDecimal=n.parseYearMonthDuration=n.parseTime=n.parseDuration=n.parseDayTimeDuration=n.parseDateTime=n.elapsedDuration=n.addDurationToDateTime=n.isNonLexicalLiteral=n.StringLiteral=n.NonLexicalLiteral=n.FloatLiteral=n.IntegerLiteral=n.Literal=n.Existence=n.Aggregate=n.DoubleLiteral=n.DefaultGraph=n.DecimalLiteral=n.BlankNode=n.BooleanLiteral=n.NumericLiteral=n.Variable=n.NamedNode=n.Operator=n.Quad=n.YearMonthDurationLiteral=n.Term=void 0;var t=requireTermTransformer();Object.defineProperty(n,"TermTransformer",{enumerable:!0,get:function(){return t.TermTransformer}});var r=requireOverloadTree();Object.defineProperty(n,"OverloadTree",{enumerable:!0,get:function(){return r.OverloadTree}});var a=requireContext();Object.defineProperty(n,"prepareEvaluatorActionContext",{enumerable:!0,get:function(){return a.prepareEvaluatorActionContext}});var o=requireHelpers$1();Object.defineProperty(n,"declare",{enumerable:!0,get:function(){return o.declare}}),Object.defineProperty(n,"bool",{enumerable:!0,get:function(){return o.bool}}),Object.defineProperty(n,"string",{enumerable:!0,get:function(){return o.string}}),Object.defineProperty(n,"double",{enumerable:!0,get:function(){return o.double}}),Object.defineProperty(n,"integer",{enumerable:!0,get:function(){return o.integer}}),Object.defineProperty(n,"dateTime",{enumerable:!0,get:function(){return o.dateTime}}),Object.defineProperty(n,"langString",{enumerable:!0,get:function(){return o.langString}}),Object.defineProperty(n,"decimal",{enumerable:!0,get:function(){return o.decimal}}),Object.defineProperty(n,"float",{enumerable:!0,get:function(){return o.float}}),Object.defineProperty(n,"expressionToVar",{enumerable:!0,get:function(){return o.expressionToVar}}),Object.defineProperty(n,"Builder",{enumerable:!0,get:function(){return o.Builder}});var u=requireErrors$1();Object.defineProperty(n,"ExpressionError",{enumerable:!0,get:function(){return u.ExpressionError}}),Object.defineProperty(n,"isExpressionError",{enumerable:!0,get:function(){return u.isExpressionError}}),Object.defineProperty(n,"EmptyAggregateError",{enumerable:!0,get:function(){return u.EmptyAggregateError}}),Object.defineProperty(n,"RDFEqualTypeError",{enumerable:!0,get:function(){return u.RDFEqualTypeError}}),Object.defineProperty(n,"IncompatibleLanguageOperation",{enumerable:!0,get:function(){return u.IncompatibleLanguageOperation}}),Object.defineProperty(n,"InvalidTimezoneCall",{enumerable:!0,get:function(){return u.InvalidTimezoneCall}}),Object.defineProperty(n,"InvalidArgumentTypes",{enumerable:!0,get:function(){return u.InvalidArgumentTypes}}),Object.defineProperty(n,"CoalesceError",{enumerable:!0,get:function(){return u.CoalesceError}}),Object.defineProperty(n,"InError",{enumerable:!0,get:function(){return u.InError}}),Object.defineProperty(n,"NoAggregator",{enumerable:!0,get:function(){return u.NoAggregator}}),Object.defineProperty(n,"UnboundVariableError",{enumerable:!0,get:function(){return u.UnboundVariableError}}),Object.defineProperty(n,"CastError",{enumerable:!0,get:function(){return u.CastError}}),Object.defineProperty(n,"ExtensionFunctionError",{enumerable:!0,get:function(){return u.ExtensionFunctionError}}),Object.defineProperty(n,"InvalidLexicalForm",{enumerable:!0,get:function(){return u.InvalidLexicalForm}}),Object.defineProperty(n,"InvalidArity",{enumerable:!0,get:function(){return u.InvalidArity}});var s=requireConsts();Object.defineProperty(n,"typedLiteral",{enumerable:!0,get:function(){return s.typedLiteral}}),Object.defineProperty(n,"TypeURL",{enumerable:!0,get:function(){return s.TypeURL}}),Object.defineProperty(n,"TypeAlias",{enumerable:!0,get:function(){return s.TypeAlias}}),Object.defineProperty(n,"SparqlOperator",{enumerable:!0,get:function(){return s.SparqlOperator}});var c=requireTypeHandling();Object.defineProperty(n,"isSubTypeOf",{enumerable:!0,get:function(){return c.isSubTypeOf}});var l=requireDateTimeHelpers();Object.defineProperty(n,"dayTimeDurationsToSeconds",{enumerable:!0,get:function(){return l.dayTimeDurationsToSeconds}}),Object.defineProperty(n,"defaultedDateTimeRepresentation",{enumerable:!0,get:function(){return l.defaultedDateTimeRepresentation}}),Object.defineProperty(n,"defaultedDayTimeDurationRepresentation",{enumerable:!0,get:function(){return l.defaultedDayTimeDurationRepresentation}}),Object.defineProperty(n,"defaultedDurationRepresentation",{enumerable:!0,get:function(){return l.defaultedDurationRepresentation}}),Object.defineProperty(n,"defaultedYearMonthDurationRepresentation",{enumerable:!0,get:function(){return l.defaultedYearMonthDurationRepresentation}}),Object.defineProperty(n,"extractRawTimeZone",{enumerable:!0,get:function(){return l.extractRawTimeZone}}),Object.defineProperty(n,"negateDuration",{enumerable:!0,get:function(){return l.negateDuration}}),Object.defineProperty(n,"toDateTimeRepresentation",{enumerable:!0,get:function(){return l.toDateTimeRepresentation}}),Object.defineProperty(n,"toUTCDate",{enumerable:!0,get:function(){return l.toUTCDate}}),Object.defineProperty(n,"yearMonthDurationsToMonths",{enumerable:!0,get:function(){return l.yearMonthDurationsToMonths}});var d=requireExpressions();Object.defineProperty(n,"DateTimeLiteral",{enumerable:!0,get:function(){return d.DateTimeLiteral}}),Object.defineProperty(n,"DayTimeDurationLiteral",{enumerable:!0,get:function(){return d.DayTimeDurationLiteral}}),Object.defineProperty(n,"DateLiteral",{enumerable:!0,get:function(){return d.DateLiteral}}),Object.defineProperty(n,"DurationLiteral",{enumerable:!0,get:function(){return d.DurationLiteral}}),Object.defineProperty(n,"TimeLiteral",{enumerable:!0,get:function(){return d.TimeLiteral}}),Object.defineProperty(n,"LangStringLiteral",{enumerable:!0,get:function(){return d.LangStringLiteral}}),Object.defineProperty(n,"Term",{enumerable:!0,get:function(){return d.Term}}),Object.defineProperty(n,"YearMonthDurationLiteral",{enumerable:!0,get:function(){return d.YearMonthDurationLiteral}}),Object.defineProperty(n,"Quad",{enumerable:!0,get:function(){return d.Quad}}),Object.defineProperty(n,"Operator",{enumerable:!0,get:function(){return d.Operator}}),Object.defineProperty(n,"NamedNode",{enumerable:!0,get:function(){return d.NamedNode}}),Object.defineProperty(n,"Variable",{enumerable:!0,get:function(){return d.Variable}}),Object.defineProperty(n,"NumericLiteral",{enumerable:!0,get:function(){return d.NumericLiteral}}),Object.defineProperty(n,"BooleanLiteral",{enumerable:!0,get:function(){return d.BooleanLiteral}}),Object.defineProperty(n,"BlankNode",{enumerable:!0,get:function(){return d.BlankNode}}),Object.defineProperty(n,"DecimalLiteral",{enumerable:!0,get:function(){return d.DecimalLiteral}}),Object.defineProperty(n,"DefaultGraph",{enumerable:!0,get:function(){return d.DefaultGraph}}),Object.defineProperty(n,"DoubleLiteral",{enumerable:!0,get:function(){return d.DoubleLiteral}}),Object.defineProperty(n,"Aggregate",{enumerable:!0,get:function(){return d.Aggregate}}),Object.defineProperty(n,"Existence",{enumerable:!0,get:function(){return d.Existence}}),Object.defineProperty(n,"Literal",{enumerable:!0,get:function(){return d.Literal}}),Object.defineProperty(n,"IntegerLiteral",{enumerable:!0,get:function(){return d.IntegerLiteral}}),Object.defineProperty(n,"FloatLiteral",{enumerable:!0,get:function(){return d.FloatLiteral}}),Object.defineProperty(n,"NonLexicalLiteral",{enumerable:!0,get:function(){return d.NonLexicalLiteral}}),Object.defineProperty(n,"StringLiteral",{enumerable:!0,get:function(){return d.StringLiteral}}),Object.defineProperty(n,"isNonLexicalLiteral",{enumerable:!0,get:function(){return d.isNonLexicalLiteral}});var f=requireSpecAlgos();Object.defineProperty(n,"addDurationToDateTime",{enumerable:!0,get:function(){return f.addDurationToDateTime}}),Object.defineProperty(n,"elapsedDuration",{enumerable:!0,get:function(){return f.elapsedDuration}});var h=requireParsing();Object.defineProperty(n,"parseDateTime",{enumerable:!0,get:function(){return h.parseDateTime}}),Object.defineProperty(n,"parseDayTimeDuration",{enumerable:!0,get:function(){return h.parseDayTimeDuration}}),Object.defineProperty(n,"parseDuration",{enumerable:!0,get:function(){return h.parseDuration}}),Object.defineProperty(n,"parseTime",{enumerable:!0,get:function(){return h.parseTime}}),Object.defineProperty(n,"parseYearMonthDuration",{enumerable:!0,get:function(){return h.parseYearMonthDuration}}),Object.defineProperty(n,"parseXSDDecimal",{enumerable:!0,get:function(){return h.parseXSDDecimal}}),Object.defineProperty(n,"parseXSDFloat",{enumerable:!0,get:function(){return h.parseXSDFloat}}),Object.defineProperty(n,"parseDate",{enumerable:!0,get:function(){return h.parseDate}});var v=requireDateTimeHelpers();Object.defineProperty(n,"trimToYearMonthDuration",{enumerable:!0,get:function(){return v.trimToYearMonthDuration}}),Object.defineProperty(n,"trimToDayTimeDuration",{enumerable:!0,get:function(){return v.trimToDayTimeDuration}})}(lib$4m)),lib$4m}var hasRequiredCore;function requireCore(){if(hasRequiredCore)return Core$1;hasRequiredCore=1,Object.defineProperty(Core$1,"__esModule",{value:!0}),Core$1.TermFunctionBase=Core$1.ExpressionFunctionBase=void 0;const n=requireLib$4q(),t=requireLib$4n();class r{constructor({arity:u,operator:s,apply:c}){this.arity=u,this.operator=s,this.apply=c}checkArity(u){return Array.isArray(this.arity)?this.arity.includes(u.length):this.arity===Number.POSITIVE_INFINITY?!0:u.length===this.arity}}Core$1.ExpressionFunctionBase=r;class a extends r{constructor({arity:u,operator:s,overloads:c}){super({arity:u,operator:s,apply:async({args:l,exprEval:d,mapping:f})=>this.applyOnTerms(await Promise.all(l.map(h=>d.evaluatorExpressionEvaluation(h,f))),d)}),this.supportsTermExpressions=!0,this.overloads=c}applyOnTerms(u,s){return(this.overloads.search(u,s.context.getSafe(n.KeysExpressionEvaluator.superTypeProvider),s.context.getSafe(n.KeysInitQuery.functionArgumentsCache))??this.handleInvalidTypes(u))(s)(u)}handleInvalidTypes(u){throw new t.InvalidArgumentTypes(u,this.operator)}}return Core$1.TermFunctionBase=a,Core$1}var hasRequiredLib$4m;function requireLib$4m(){return hasRequiredLib$4m||(hasRequiredLib$4m=1,function(n){var t=lib$4n&&lib$4n.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4n&&lib$4n.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactory(),n),r(requireActorFunctionFactoryDedicated(),n),r(requireBusFunctionFactory(),n),r(requireCore(),n)}(lib$4n)),lib$4n}var lib$4l={},ActorQueryOperation={},hasRequiredActorQueryOperation;function requireActorQueryOperation(){if(hasRequiredActorQueryOperation)return ActorQueryOperation;hasRequiredActorQueryOperation=1,Object.defineProperty(ActorQueryOperation,"__esModule",{value:!0}),ActorQueryOperation.ActorQueryOperation=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorQueryOperation.ActorQueryOperation=t,ActorQueryOperation}var ActorQueryOperationTyped={},lib$4k={},MetadataValidationState={},hasRequiredMetadataValidationState;function requireMetadataValidationState(){if(hasRequiredMetadataValidationState)return MetadataValidationState;hasRequiredMetadataValidationState=1,Object.defineProperty(MetadataValidationState,"__esModule",{value:!0}),MetadataValidationState.MetadataValidationState=void 0;let n=class{constructor(){this.invalidateListeners=[],this.valid=!0}addInvalidateListener(r){this.invalidateListeners.push(r)}invalidate(){if(this.valid){this.valid=!1;for(const r of this.invalidateListeners)r()}}};return MetadataValidationState.MetadataValidationState=n,MetadataValidationState}var Utils$2={},hasRequiredUtils$7;function requireUtils$7(){if(hasRequiredUtils$7)return Utils$2;hasRequiredUtils$7=1,Object.defineProperty(Utils$2,"__esModule",{value:!0}),Utils$2.cachifyMetadata=Utils$2.validateMetadataBindings=Utils$2.validateMetadataQuads=Utils$2.getMetadataBindings=Utils$2.getMetadataQuads=void 0;function n(u){return o(()=>new Promise((s,c)=>{u.getProperty("metadata",l=>s(l)),u.on("error",c)}).then(s=>r(s)))}Utils$2.getMetadataQuads=n;function t(u){return o(()=>new Promise((s,c)=>{u.getProperty("metadata",l=>s(l)),u.on("error",c)}).then(s=>a(s)))}Utils$2.getMetadataBindings=t;function r(u){for(const s of["cardinality"])if(!(s in u))throw new Error(`Invalid metadata: missing ${s} in ${JSON.stringify(u)}`);return u}Utils$2.validateMetadataQuads=r;function a(u){for(const s of["cardinality","variables"])if(!(s in u))throw new Error(`Invalid metadata: missing ${s} in ${JSON.stringify(u)}`);return u}Utils$2.validateMetadataBindings=a;function o(u){let s;return()=>(s||(s=u(),s.then(c=>c.state.addInvalidateListener(()=>{s=void 0})).catch(()=>{})),s)}return Utils$2.cachifyMetadata=o,Utils$2}var hasRequiredLib$4l;function requireLib$4l(){return hasRequiredLib$4l||(hasRequiredLib$4l=1,function(n){var t=lib$4k&&lib$4k.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4k&&lib$4k.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMetadataValidationState(),n),r(requireUtils$7(),n)}(lib$4k)),lib$4k}var hasRequiredActorQueryOperationTyped;function requireActorQueryOperationTyped(){if(hasRequiredActorQueryOperationTyped)return ActorQueryOperationTyped;hasRequiredActorQueryOperationTyped=1,Object.defineProperty(ActorQueryOperationTyped,"__esModule",{value:!0}),ActorQueryOperationTyped.ActorQueryOperationTyped=void 0;const n=requireLib$4q(),t=requireLib$4s(),r=requireLib$4l(),a=requireActorQueryOperation();let o=class extends a.ActorQueryOperation{constructor(s,c){if(super({...s,operationName:c}),!this.operationName)throw new Error('A valid "operationName" argument must be provided.')}async test(s){if(!s.operation)return(0,t.failTest)("Missing field 'operation' in a query operation action.");if(s.operation.type!==this.operationName)return(0,t.failTest)(`Actor ${this.name} only supports ${this.operationName} operations, but got ${s.operation.type}`);const c=s.operation;return this.testOperation(c,s.context)}async run(s,c){const l=s.context.get(n.KeysInitQuery.physicalQueryPlanLogger);l&&(l.logOperation(s.operation.type,void 0,s.operation,s.context.get(n.KeysInitQuery.physicalQueryPlanNode),this.name,{}),s.context=s.context.set(n.KeysInitQuery.physicalQueryPlanNode,s.operation));const d=s.operation,f=s.context.set(n.KeysQueryOperation.operation,d),h=await this.runOperation(d,f,c);return"metadata"in h&&(h.metadata=(0,r.cachifyMetadata)(h.metadata)),h}};return ActorQueryOperationTyped.ActorQueryOperationTyped=o,ActorQueryOperationTyped}var ActorQueryOperationTypedMediated={},hasRequiredActorQueryOperationTypedMediated;function requireActorQueryOperationTypedMediated(){if(hasRequiredActorQueryOperationTypedMediated)return ActorQueryOperationTypedMediated;hasRequiredActorQueryOperationTypedMediated=1,Object.defineProperty(ActorQueryOperationTypedMediated,"__esModule",{value:!0}),ActorQueryOperationTypedMediated.ActorQueryOperationTypedMediated=void 0;const n=requireActorQueryOperationTyped();let t=class extends n.ActorQueryOperationTyped{constructor(a,o){super(a,o)}};return ActorQueryOperationTypedMediated.ActorQueryOperationTypedMediated=t,ActorQueryOperationTypedMediated}var BusQueryOperation={},hasRequiredBusQueryOperation;function requireBusQueryOperation(){if(hasRequiredBusQueryOperation)return BusQueryOperation;hasRequiredBusQueryOperation=1,Object.defineProperty(BusQueryOperation,"__esModule",{value:!0}),BusQueryOperation.BusQueryOperation=void 0;const n=requireLib$4s();let t=class extends n.BusIndexed{constructor(a){super({...a,actorIdentifierFields:["operationName"],actionIdentifierFields:["operation","type"]})}};return BusQueryOperation.BusQueryOperation=t,BusQueryOperation}var hasRequiredLib$4k;function requireLib$4k(){return hasRequiredLib$4k||(hasRequiredLib$4k=1,function(n){var t=lib$4l&&lib$4l.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4l&&lib$4l.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperation(),n),r(requireActorQueryOperationTyped(),n),r(requireActorQueryOperationTypedMediated(),n),r(requireBusQueryOperation(),n)}(lib$4l)),lib$4l}var lib$4j={},ActorContextPreprocessConvertShortcuts={},lib$4i={},ActorContextPreprocess={},hasRequiredActorContextPreprocess;function requireActorContextPreprocess(){if(hasRequiredActorContextPreprocess)return ActorContextPreprocess;hasRequiredActorContextPreprocess=1,Object.defineProperty(ActorContextPreprocess,"__esModule",{value:!0}),ActorContextPreprocess.ActorContextPreprocess=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorContextPreprocess.ActorContextPreprocess=t,ActorContextPreprocess}var hasRequiredLib$4j;function requireLib$4j(){return hasRequiredLib$4j||(hasRequiredLib$4j=1,function(n){var t=lib$4i&&lib$4i.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4i&&lib$4i.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocess(),n)}(lib$4i)),lib$4i}var hasRequiredActorContextPreprocessConvertShortcuts;function requireActorContextPreprocessConvertShortcuts(){if(hasRequiredActorContextPreprocessConvertShortcuts)return ActorContextPreprocessConvertShortcuts;hasRequiredActorContextPreprocessConvertShortcuts=1,Object.defineProperty(ActorContextPreprocessConvertShortcuts,"__esModule",{value:!0}),ActorContextPreprocessConvertShortcuts.ActorContextPreprocessConvertShortcuts=void 0;const n=requireLib$4j(),t=requireLib$4s();let r=class Ki extends n.ActorContextPreprocess{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return{context:Ki.expandShortcuts(o.context,this.contextKeyShortcuts)}}static expandShortcuts(o,u){for(const s of o.keys())u[s.name]&&(o=o.set(new t.ActionContextKey(u[s.name]),o.get(s)).delete(s));return o}};return ActorContextPreprocessConvertShortcuts.ActorContextPreprocessConvertShortcuts=r,ActorContextPreprocessConvertShortcuts}var hasRequiredLib$4i;function requireLib$4i(){return hasRequiredLib$4i||(hasRequiredLib$4i=1,function(n){var t=lib$4j&&lib$4j.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4j&&lib$4j.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocessConvertShortcuts(),n)}(lib$4j)),lib$4j}var lib$4h={},ActorContextPreprocessSetDefaults={},hasRequiredActorContextPreprocessSetDefaults;function requireActorContextPreprocessSetDefaults(){if(hasRequiredActorContextPreprocessSetDefaults)return ActorContextPreprocessSetDefaults;hasRequiredActorContextPreprocessSetDefaults=1,Object.defineProperty(ActorContextPreprocessSetDefaults,"__esModule",{value:!0}),ActorContextPreprocessSetDefaults.ActorContextPreprocessSetDefaults=void 0;const n=requireLib$4j(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfDataFactory();let o=class extends n.ActorContextPreprocess{constructor(s){super(s),this.defaultFunctionArgumentsCache={}}async test(s){return(0,r.passTestVoid)()}async run(s){let c=s.context;if(s.initialize){c=c.setDefault(t.KeysInitQuery.queryTimestamp,new Date).setDefault(t.KeysInitQuery.queryTimestampHighResolution,performance.now()).setDefault(t.KeysQuerySourceIdentify.sourceIds,new Map).setDefault(t.KeysCore.log,this.logger).setDefault(t.KeysInitQuery.functionArgumentsCache,this.defaultFunctionArgumentsCache).setDefault(t.KeysQuerySourceIdentify.hypermediaSourcesAggregatedStores,new Map).setDefault(t.KeysInitQuery.dataFactory,new a.DataFactory);let l={language:"sparql",version:"1.1"};c.has(t.KeysInitQuery.queryFormat)?(l=c.get(t.KeysInitQuery.queryFormat),l.language==="graphql"&&(c=c.setDefault(t.KeysInitQuery.graphqlSingularizeVariables,{}))):c=c.set(t.KeysInitQuery.queryFormat,l)}return{context:c}}};return ActorContextPreprocessSetDefaults.ActorContextPreprocessSetDefaults=o,ActorContextPreprocessSetDefaults}var hasRequiredLib$4h;function requireLib$4h(){return hasRequiredLib$4h||(hasRequiredLib$4h=1,function(n){var t=lib$4h&&lib$4h.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4h&&lib$4h.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocessSetDefaults(),n)}(lib$4h)),lib$4h}var lib$4g={},ActorContextPreprocessSourceToDestination={},hasRequiredActorContextPreprocessSourceToDestination;function requireActorContextPreprocessSourceToDestination(){if(hasRequiredActorContextPreprocessSourceToDestination)return ActorContextPreprocessSourceToDestination;hasRequiredActorContextPreprocessSourceToDestination=1,Object.defineProperty(ActorContextPreprocessSourceToDestination,"__esModule",{value:!0}),ActorContextPreprocessSourceToDestination.ActorContextPreprocessSourceToDestination=void 0;const n=requireLib$4j(),t=requireLib$4q(),r=requireLib$4s();let a=class extends n.ActorContextPreprocess{constructor(u){super(u)}async test(u){return(0,r.passTestVoid)()}async run(u){if(u.context.get(t.KeysInitQuery.querySourcesUnidentified)&&!u.context.get(t.KeysRdfUpdateQuads.destination)){const s=u.context.get(t.KeysInitQuery.querySourcesUnidentified);if(s.length===1)return{context:u.context.set(t.KeysRdfUpdateQuads.destination,s[0])}}return u}};return ActorContextPreprocessSourceToDestination.ActorContextPreprocessSourceToDestination=a,ActorContextPreprocessSourceToDestination}var hasRequiredLib$4g;function requireLib$4g(){return hasRequiredLib$4g||(hasRequiredLib$4g=1,function(n){var t=lib$4g&&lib$4g.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4g&&lib$4g.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocessSourceToDestination(),n)}(lib$4g)),lib$4g}var lib$4f={},ActorContextPreprocessQuerySourceSkolemize={},QuerySourceSkolemized={},asynciterator={},events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var n=typeof Reflect=="object"?Reflect:null,t=n&&typeof n.apply=="function"?n.apply:function(E,I,L){return Function.prototype.apply.call(E,I,L)},r;n&&typeof n.ownKeys=="function"?r=n.ownKeys:Object.getOwnPropertySymbols?r=function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:r=function(E){return Object.getOwnPropertyNames(E)};function a(R){console&&console.warn&&console.warn(R)}var o=Number.isNaN||function(E){return E!==E};function u(){u.init.call(this)}events.exports=u,events.exports.once=T,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var s=10;function c(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(R){if(typeof R!="number"||R<0||o(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");s=R}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(E){if(typeof E!="number"||E<0||o(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this};function l(R){return R._maxListeners===void 0?u.defaultMaxListeners:R._maxListeners}u.prototype.getMaxListeners=function(){return l(this)},u.prototype.emit=function(E){for(var I=[],L=1;L<arguments.length;L++)I.push(arguments[L]);var F=E==="error",D=this._events;if(D!==void 0)F=F&&D.error===void 0;else if(!F)return!1;if(F){var $;if(I.length>0&&($=I[0]),$ instanceof Error)throw $;var O=new Error("Unhandled error."+($?" ("+$.message+")":""));throw O.context=$,O}var P=D[E];if(P===void 0)return!1;if(typeof P=="function")t(P,this,I);else for(var C=P.length,q=b(P,C),L=0;L<C;++L)t(q[L],this,I);return!0};function d(R,E,I,L){var F,D,$;if(c(I),D=R._events,D===void 0?(D=R._events=Object.create(null),R._eventsCount=0):(D.newListener!==void 0&&(R.emit("newListener",E,I.listener?I.listener:I),D=R._events),$=D[E]),$===void 0)$=D[E]=I,++R._eventsCount;else if(typeof $=="function"?$=D[E]=L?[I,$]:[$,I]:L?$.unshift(I):$.push(I),F=l(R),F>0&&$.length>F&&!$.warned){$.warned=!0;var O=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit");O.name="MaxListenersExceededWarning",O.emitter=R,O.type=E,O.count=$.length,a(O)}return R}u.prototype.addListener=function(E,I){return d(this,E,I,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(E,I){return d(this,E,I,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(R,E,I){var L={fired:!1,wrapFn:void 0,target:R,type:E,listener:I},F=f.bind(L);return F.listener=I,L.wrapFn=F,F}u.prototype.once=function(E,I){return c(I),this.on(E,h(this,E,I)),this},u.prototype.prependOnceListener=function(E,I){return c(I),this.prependListener(E,h(this,E,I)),this},u.prototype.removeListener=function(E,I){var L,F,D,$,O;if(c(I),F=this._events,F===void 0)return this;if(L=F[E],L===void 0)return this;if(L===I||L.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete F[E],F.removeListener&&this.emit("removeListener",E,L.listener||I));else if(typeof L!="function"){for(D=-1,$=L.length-1;$>=0;$--)if(L[$]===I||L[$].listener===I){O=L[$].listener,D=$;break}if(D<0)return this;D===0?L.shift():_(L,D),L.length===1&&(F[E]=L[0]),F.removeListener!==void 0&&this.emit("removeListener",E,O||I)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(E){var I,L,F;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[E]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[E]),this;if(arguments.length===0){var D=Object.keys(L),$;for(F=0;F<D.length;++F)$=D[F],$!=="removeListener"&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=L[E],typeof I=="function")this.removeListener(E,I);else if(I!==void 0)for(F=I.length-1;F>=0;F--)this.removeListener(E,I[F]);return this};function v(R,E,I){var L=R._events;if(L===void 0)return[];var F=L[E];return F===void 0?[]:typeof F=="function"?I?[F.listener||F]:[F]:I?S(F):b(F,F.length)}u.prototype.listeners=function(E){return v(this,E,!0)},u.prototype.rawListeners=function(E){return v(this,E,!1)},u.listenerCount=function(R,E){return typeof R.listenerCount=="function"?R.listenerCount(E):g.call(R,E)},u.prototype.listenerCount=g;function g(R){var E=this._events;if(E!==void 0){var I=E[R];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function b(R,E){for(var I=new Array(E),L=0;L<E;++L)I[L]=R[L];return I}function _(R,E){for(;E+1<R.length;E++)R[E]=R[E+1];R.pop()}function S(R){for(var E=new Array(R.length),I=0;I<E.length;++I)E[I]=R[I].listener||R[I];return E}function T(R,E){return new Promise(function(I,L){function F($){R.removeListener(E,D),L($)}function D(){typeof R.removeListener=="function"&&R.removeListener("error",F),I([].slice.call(arguments))}A(R,E,D,{once:!0}),E!=="error"&&w(R,F,{once:!0})})}function w(R,E,I){typeof R.on=="function"&&A(R,"error",E,I)}function A(R,E,I,L){if(typeof R.on=="function")L.once?R.once(E,I):R.on(E,I);else if(typeof R.addEventListener=="function")R.addEventListener(E,function F(D){L.once&&R.removeEventListener(E,F),I(D)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R)}return events.exports}var linkedlist={},hasRequiredLinkedlist;function requireLinkedlist(){if(hasRequiredLinkedlist)return linkedlist;hasRequiredLinkedlist=1,Object.defineProperty(linkedlist,"__esModule",{value:!0}),linkedlist.LinkedList=void 0;class n{constructor(){this._length=0,this._head=null,this._tail=null}get length(){return this._length}get first(){var r;return(r=this._head)===null||r===void 0?void 0:r.value}get last(){var r;return(r=this._tail)===null||r===void 0?void 0:r.value}get empty(){return this._head===null}push(r){const a={value:r,next:null};this._tail===null?this._head=this._tail=a:this._tail.next=this._tail=a,this._length++}shift(){if(this._head===null)return;const{value:r,next:a}=this._head;return this._head=a,a===null&&(this._tail=null),this._length--,r}clear(){this._length=0,this._head=this._tail=null}}return linkedlist.LinkedList=n,linkedlist}var taskscheduler={},hasRequiredTaskscheduler;function requireTaskscheduler(){if(hasRequiredTaskscheduler)return taskscheduler;hasRequiredTaskscheduler=1,Object.defineProperty(taskscheduler,"__esModule",{value:!0}),taskscheduler.createTaskScheduler=void 0;const n=Promise.resolve(void 0);function t(){const r=typeof queueMicrotask=="function"?queueMicrotask:s=>n.then(s),a=typeof setImmediate=="function"?setImmediate:s=>setTimeout(s,0);let o=0,u=null;return s=>{u!==null?u.push(s):++o<100?r(s):(u=[s],a(()=>{for(const c of u)r(c);u=null,o=0}))}}return taskscheduler.createTaskScheduler=t,taskscheduler}var hasRequiredAsynciterator;function requireAsynciterator(){return hasRequiredAsynciterator||(hasRequiredAsynciterator=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isIterator=n.isIterable=n.isSourceExpression=n.isPromise=n.isEventEmitter=n.isFunction=n.range=n.union=n.fromIterable=n.fromIterator=n.fromArray=n.single=n.empty=n.wrap=n.WrappingIterator=n.ClonedIterator=n.UnionIterator=n.MultiTransformIterator=n.SimpleTransformIterator=n.TransformIterator=n.BufferedIterator=n.MappingIterator=n.DESTINATION=n.identity=n.IntegerIterator=n.ArrayIterator=n.SingletonIterator=n.EmptyIterator=n.AsyncIterator=n.DESTROYED=n.ENDED=n.CLOSED=n.CLOSING=n.OPEN=n.INIT=n.setTaskScheduler=n.getTaskScheduler=n.scheduleTask=n.LinkedList=void 0;const t=requireEvents(),r=requireLinkedlist();Object.defineProperty(n,"LinkedList",{enumerable:!0,get:function(){return r.LinkedList}});let o=requireTaskscheduler().createTaskScheduler();function u(z){o(z)}n.scheduleTask=u;function s(){return o}n.getTaskScheduler=s;function c(z){o=z}n.setTaskScheduler=c,n.INIT=1,n.OPEN=2,n.CLOSING=4,n.CLOSED=8,n.ENDED=16,n.DESTROYED=32;class l extends t.EventEmitter{constructor(B=n.OPEN){super(),this._readable=!1,this._state=B,this.on("newListener",d)}_changeState(B,U=!1){const Z=B>this._state&&this._state<n.ENDED;return Z&&(this._state=B,B===n.ENDED&&(U?o(()=>this.emit("end")):this.emit("end"))),Z}read(){return null}forEach(B,U){this.on("data",ye(B,U))}close(){this._changeState(n.CLOSED)&&this._endAsync()}destroy(B){this.done||this._destroy(B,U=>{B=B||U,B&&this.emit("error",B),this._end(!0)})}_destroy(B,U){U()}_end(B=!1){this._changeState(B?n.DESTROYED:n.ENDED)&&(this._readable=!1,this.removeAllListeners("readable"),this.removeAllListeners("data"),this.removeAllListeners("end"))}_endAsync(){o(()=>this._end())}get readable(){return this._readable}set readable(B){B=!!B&&!this.done,this._readable!==B&&(this._readable=B,B&&o(()=>this.emit("readable")))}get closed(){return this._state>=n.CLOSING}get ended(){return this._state===n.ENDED}get destroyed(){return this._state===n.DESTROYED}get done(){return this._state>=n.ENDED}toString(){const B=this._toStringDetails();return`[${this.constructor.name}${B?` ${B}`:""}]`}_toStringDetails(){return""}toArray(B){const U=[],Z=typeof(B==null?void 0:B.limit)=="number"?B.limit:1/0;return this.ended||Z<=0?Promise.resolve(U):new Promise((oe,ie)=>{const se=()=>oe(U),ne=he=>{U.push(he),U.length>=Z&&(this.removeListener("error",ie),this.removeListener("data",ne),this.removeListener("end",se),oe(U))};this.on("error",ie),this.on("data",ne),this.on("end",se)})}getProperty(B,U){const Z=this._properties;if(!U)return Z&&Z[B];if(Z&&B in Z)o(()=>U(Z[B]));else{let oe;(oe=this._propertyCallbacks)||(this._propertyCallbacks=oe=Object.create(null)),B in oe?oe[B].push(U):oe[B]=[U]}}setProperty(B,U){const Z=this._properties||(this._properties=Object.create(null));Z[B]=U;const oe=this._propertyCallbacks||{},ie=oe[B];if(ie){delete oe[B],o(()=>{for(const se of ie)se(U)});for(B in oe)return;delete this._propertyCallbacks}}getProperties(){const B=this._properties,U={};for(const Z in B)U[Z]=B[Z];return U}setProperties(B){for(const U in B)this.setProperty(U,B[U])}copyProperties(B,U){for(const Z of U)B.getProperty(Z,oe=>this.setProperty(Z,oe))}transform(B){return new $(this,B)}map(B,U){return new T(this,ye(B,U))}filter(B,U){return this.map(function(Z){return B.call(U||this,Z)?Z:null})}uniq(B=S){const U=new Set;return this.filter(function(Z){const oe=B.call(this,Z);return U.has(oe)?!1:(U.add(oe),!0)})}prepend(B){return this.transform({prepend:B})}append(B){return this.transform({append:B})}surround(B,U){return this.transform({prepend:B,append:U})}skip(B){return this.map(U=>B-- >0?null:U)}take(B){return this.transform({limit:B})}range(B,U){return this.transform({offset:B,limit:Math.max(U-B+1,0)})}clone(){return new q(this)}[Symbol.asyncIterator](){const B=this;let U=null,Z=null,oe=null;B.addListener("readable",ie),B.addListener("end",ie),B.addListener("error",se);function ie(){if(U!==null)if(oe!==null)se(oe);else if(B.done)U({done:!0,value:void 0}),U=Z=null,ne();else{const he=B.read();he!==null&&(U({done:!1,value:he}),U=Z=null)}}function se(he){Z!==null?(Z(he),U=Z=oe=null,ne()):oe===null&&(oe=he)}function ne(){B.removeListener("readable",ie),B.removeListener("end",ie),B.removeListener("error",se)}return{next(){return new Promise((he,xe)=>{U=he,Z=xe,ie()})}}}}n.AsyncIterator=l;function d(z){z==="data"&&(this.removeListener("newListener",d),h(this,"readable",f),this.readable&&o(()=>f.call(this)))}function f(){let z;for(;this.listenerCount("data")!==0&&(z=this.read())!==null;)this.emit("data",z);this.listenerCount("data")===0&&!this.done&&(this.removeListener("readable",f),h(this,"newListener",d))}function h(z,B,U){z.listeners(B).includes(U)||z.on(B,U)}class v extends l{constructor(){super(),this._changeState(n.ENDED,!0)}}n.EmptyIterator=v;class g extends l{constructor(B){super(),this._item=B,B===null?this.close():this.readable=!0}read(){const B=this._item;return this._item=null,this.close(),B}_toStringDetails(){return this._item===null?"":`(${this._item})`}}n.SingletonIterator=g;class b extends l{constructor(B=[],{autoStart:U=!0,preserve:Z=!0}={}){super();const oe=Z||!Array.isArray(B)?[...B]:B;this._index=0,this._sourceStarted=U!==!1,this._truncateThreshold=Z?-1:64,this._sourceStarted&&oe.length===0?this.close():this._buffer=oe,this.readable=!0}read(){this._sourceStarted||(this._sourceStarted=!0);let B=null;return this._buffer&&(this._index<this._buffer.length&&(B=this._buffer[this._index++]),this._index===this._buffer.length?(delete this._buffer,this.close()):this._index===this._truncateThreshold&&(this._buffer.splice(0,this._truncateThreshold),this._index=0)),B}_toStringDetails(){return`(${this._buffer?this._buffer.length-this._index:0})`}_destroy(B,U){delete this._buffer,U()}toArray(B={}){if(!this._buffer)return Promise.resolve([]);const{length:U}=this._buffer,Z=this._index,oe=typeof B.limit!="number"?U:Z+B.limit,ie=this._buffer.slice(Z,oe);return this._index=oe,oe>=U&&this.close(),Promise.resolve(ie)}}n.ArrayIterator=b;class _ extends l{constructor({start:B=0,step:U=1,end:Z}={}){super(),Number.isFinite(B)&&(B=Math.trunc(B)),this._next=B,Number.isFinite(U)&&(U=Math.trunc(U)),this._step=U;const oe=U>=0,ie=oe?1/0:-1/0;Number.isFinite(Z)?Z=Math.trunc(Z):Z!==-ie&&(Z=ie),this._last=Z,!Number.isFinite(B)||(oe?B>Z:B<Z)?this.close():this.readable=!0}read(){if(this.closed)return null;const B=this._next,U=this._step,Z=this._last,oe=this._next+=U;return(U>=0?oe>Z:oe<Z)&&this.close(),B}_toStringDetails(){return`(${this._next}...${this._last})`}}n.IntegerIterator=_;function S(z){return z}n.identity=S,n.DESTINATION=Symbol("destination");class T extends l{constructor(B,U=S,Z={}){super(),this._map=U,this._source=w(B),this._destroySource=Z.destroySource!==!1,B.done?this.close():(this._source[n.DESTINATION]=this,this._source.on("end",L),this._source.on("error",I),this._source.on("readable",E),this.readable=this._source.readable)}read(){if(!this.done){if(this._source.readable){let B,U;for(;(B=this._source.read())!==null;)if((U=this._map(B))!==null)return U}this.readable=!1,this._source.done&&this.close()}return null}_end(B){this._source.removeListener("end",L),this._source.removeListener("error",I),this._source.removeListener("readable",E),delete this._source[n.DESTINATION],this._destroySource&&this._source.destroy(),super._end(B)}}n.MappingIterator=T;function w(z,B=!1){if(!z||!Te(z.read)||!Te(z.on))throw new TypeError(`Invalid source: ${z}`);if(!B&&z[n.DESTINATION])throw new Error("The source already has a destination");return z}class A extends l{constructor({maxBufferSize:B=4,autoStart:U=!0}={}){super(n.INIT),this._buffer=new r.LinkedList,this._maxBufferSize=4,this._reading=!0,this._pushedCount=0,this.maxBufferSize=B,o(()=>this._init(U)),this._sourceStarted=U!==!1}get maxBufferSize(){return this._maxBufferSize}set maxBufferSize(B){B!==1/0&&(B=Number.isFinite(B)?Math.max(Math.trunc(B),1):4),this._maxBufferSize!==B&&(this._maxBufferSize=B,this._state===n.OPEN&&this._fillBuffer())}_init(B){let U=!1;this._reading=!0,this._begin(()=>{if(U)throw new Error("done callback called multiple times");U=!0,this._reading=!1,this._changeState(n.OPEN),B?this._fillBufferAsync():this.readable=!0})}_begin(B){B()}read(){if(this.done)return null;this._sourceStarted||(this._sourceStarted=!0);const B=this._buffer;let U;return B.empty?(U=null,this.readable=!1):U=B.shift(),!this._reading&&B.length<this._maxBufferSize&&(this.closed?B.empty&&this._endAsync():this._fillBufferAsync()),U}_read(B,U){U()}_push(B){this.done||(this._pushedCount++,this._buffer.push(B),this.readable=!0)}_fillBuffer(){let B;this._reading||(this.closed?this._completeClose():(B=Math.min(this._maxBufferSize-this._buffer.length,128))>0&&(this._pushedCount=0,this._reading=!0,this._read(B,()=>{if(!B)throw new Error("done callback called multiple times");B=0,this._reading=!1,this.closed?this._completeClose():this._pushedCount&&(this.readable=!0,this._buffer.length<this._maxBufferSize/2&&this._fillBufferAsync())})))}_fillBufferAsync(){this._reading||(this._reading=!0,o(()=>{this._reading=!1,this._fillBuffer()}))}close(){this._reading?this._changeState(n.CLOSING):this._completeClose()}_completeClose(){this._changeState(n.CLOSED)&&(this._reading=!0,this._flush(()=>{if(!this._reading)throw new Error("done callback called multiple times");this._reading=!1,this._buffer.empty&&this._endAsync()}))}_destroy(B,U){this._buffer.clear(),U()}_flush(B){B()}_toStringDetails(){const B=this._buffer;return`{${B.empty?"":`next: ${B.first}, `}buffer: ${B.length}}`}}n.BufferedIterator=A;class R extends A{constructor(B,U=B||{}){super(U),this._boundPush=Z=>this._push(Z),ce(B)||(B=U.source),Re(B)?this.source=B:B&&(this._createSource=ve(B)?()=>B:B,this._sourceStarted&&this._loadSourceAsync()),this._optional=!!U.optional,this._destroySource=U.destroySource!==!1}get source(){return Te(this._createSource)&&this._loadSourceAsync(),this._source}set source(B){const U=this._source=this._validateSource(B);U[n.DESTINATION]=this,this.done?this._destroySource&&U.destroy():U.done?this.close():(U.on("end",F),U.on("readable",D),U.on("error",I))}_loadSourceAsync(){Te(this._createSource)&&(Promise.resolve(this._createSource()).then(B=>{delete this._createSource,this.source=B,this._fillBuffer()},B=>this.emit("error",B)),this._createSource=null)}_validateSource(B,U=!1){if(this._source||typeof this._createSource<"u")throw new Error("The source cannot be changed after it has been set");return w(B,U)}_read(B,U){const Z=()=>{this._pushedCount<B&&!this.closed?o(()=>this._readAndTransform(Z,U)):U()};this._readAndTransform(Z,U)}_readAndTransform(B,U){let Z;const oe=this.source;!oe||oe.done||(Z=oe.read())===null?U():this._optional?this._optionalTransform(Z,B):this._transform(Z,B,this._boundPush)}_optionalTransform(B,U){const Z=this._pushedCount;this._transform(B,()=>{Z===this._pushedCount&&this._push(B),U()},this._boundPush)}_transform(B,U,Z){Z(B),U()}_closeWhenDone(){this.close()}_end(B){const U=this._source;U&&(U.removeListener("end",F),U.removeListener("error",I),U.removeListener("readable",D),delete U[n.DESTINATION],this._destroySource&&U.destroy()),super._end(B)}}n.TransformIterator=R;function E(){this[n.DESTINATION].readable=!0}function I(z){this[n.DESTINATION].emit("error",z)}function L(){this[n.DESTINATION].close()}function F(){this[n.DESTINATION]._closeWhenDone()}function D(){this[n.DESTINATION]._sourceStarted!==!1&&this[n.DESTINATION]._fillBuffer()}class $ extends R{constructor(B,U){if(super(B,U),this._offset=0,this._limit=1/0,this._filter=Z=>!0,U=U||(ce(B)?null:B),U){const Z=Te(U)?U:U.transform,{limit:oe,offset:ie,filter:se,map:ne,prepend:he,append:xe}=U;ie===1/0||oe===-1/0?this._limit=0:(Number.isFinite(ie)&&(this._offset=Math.max(Math.trunc(ie),0)),Number.isFinite(oe)&&(this._limit=Math.max(Math.trunc(oe),0)),Te(se)&&(this._filter=se),Te(ne)&&(this._map=ne),this._transform=Te(Z)?Z:null),he&&(this._prepender=Re(he)?he:W(he)),xe&&(this._appender=Re(xe)?xe:W(xe))}}_read(B,U){const Z=()=>this._readAndTransformSimple(B,oe,U);this._readAndTransformSimple(B,oe,U);function oe(){o(Z)}}_readAndTransformSimple(B,U,Z){let oe;const{source:ie}=this;if(!ie||ie.done){Z();return}for(this._limit===0&&this.close();!this.closed&&this._pushedCount<B&&(oe=ie.read())!==null;){if(!this._filter(oe)||this._offset!==0&&this._offset--)continue;const se=typeof this._map>"u"?oe:this._map(oe);if(se===null)this._optional&&this._push(oe);else if(!Te(this._transform))this._push(se);else{this._optional?this._optionalTransform(se,U):this._transform(se,U,this._boundPush);return}--this._limit===0&&this.close()}Z()}_begin(B){this._insert(this._prepender,B),delete this._prepender}_flush(B){this._insert(this._appender,B),delete this._appender}_insert(B,U){const Z=ie=>this._push(ie);!B||B.done?U():(B.on("data",Z),B.on("end",oe));function oe(){B.removeListener("data",Z),B.removeListener("end",oe),U()}}}n.SimpleTransformIterator=$;class O extends R{constructor(B,U){if(super(B,U),this._transformerQueue=[],U){const Z=Te(U)?U:U.multiTransform;Z&&(this._createTransformer=Z)}}_read(B,U){const Z=this._transformerQueue,oe=this._optional;let ie,se;for(;(ie=Z[0])&&ie.transformer.done;){oe&&ie.item!==null&&(B--,this._push(ie.item)),Z.shift();const{transformer:he}=ie;he.removeListener("end",D),he.removeListener("readable",D),he.removeListener("error",I)}const{source:ne}=this;for(;ne&&!ne.done&&Z.length<this.maxBufferSize&&(se=ne.read(),se!==null);){const he=this._createTransformer(se)||new v;he[n.DESTINATION]=this,he.on("end",D),he.on("readable",D),he.on("error",I),Z.push({transformer:he,item:se})}if(ie=Z[0],ie){const{transformer:he}=ie;for(;B-- >0&&(se=he.read())!==null;)this._push(se),oe&&(ie.item=null)}else ne&&ne.done&&this.close();U()}_createTransformer(B){return new g(B)}_closeWhenDone(){this._transformerQueue.length||this.close()}_end(B){if(super._end(B),this._destroySource)for(const U of this._transformerQueue)U.transformer.destroy()}}n.MultiTransformIterator=O;class P extends A{constructor(B,U={}){super(U),this._sources=[],this._currentSource=-1;const Z=U.autoStart!==!1;if(Re(B))B.on("error",oe=>this.emit("error",oe)),this._pending={loading:!1,sources:B},Z&&this._loadSources();else if(Array.isArray(B)&&B.length>0)for(const oe of B)this._addSource(oe);else Z&&this.close();this._destroySources=U.destroySources!==!1}_loadSources(){const B=this._pending.sources;this._pending.loading=!0,B.done?(delete this._pending,this.close()):(B.on("data",U=>{this._addSource(U),this._fillBufferAsync()}),B.on("end",()=>{delete this._pending,this._fillBuffer()}))}_addSource(B){ve(B)&&(B=G(B)),B.done||(this._sources.push(B),B[n.DESTINATION]=this,B.on("error",I),B.on("readable",D),B.on("end",C))}_removeEmptySources(){this._sources=this._sources.filter((B,U)=>(B.done&&U<=this._currentSource&&this._currentSource--,!B.done)),this._fillBuffer()}_read(B,U){var Z;((Z=this._pending)===null||Z===void 0?void 0:Z.loading)===!1&&this._loadSources();let oe=0,ie;for(;oe!==(oe=B);)for(let se=0;se<this._sources.length&&B>0;se++)this._currentSource=(this._currentSource+1)%this._sources.length,(ie=this._sources[this._currentSource].read())!==null&&(B--,this._push(ie));!this._pending&&this._sources.length===0&&this.close(),U()}_end(B=!1){if(super._end(B),this._destroySources){for(const U of this._sources)U.destroy();this._pending&&(this._pending.sources.destroy(),delete this._pending)}}}n.UnionIterator=P;function C(){this[n.DESTINATION]._removeEmptySources()}class q extends R{constructor(B){super(B,{autoStart:!1}),this._readPosition=0,this._reading=!1,B&&(this.readable=!0)}_init(){}close(){l.prototype.close.call(this)}get source(){return super.source}set source(B){const U=this._source=this._validateSource(B),Z=U&&U[n.DESTINATION]||(U[n.DESTINATION]=new M(U));this.done?this._destroySource&&U.destroy():Z.endsAt(0)?this.close():(Z.register(this),(U._sourceStarted===!1||Z.readAt(0)!==null)&&(this.readable=!0));const oe=this._propertyCallbacks;for(const ie in oe){const se=oe[ie];for(const ne of se)this._getSourceProperty(ie,ne)}}_validateSource(B,U=!1){const Z=B&&B[n.DESTINATION];return super._validateSource(B,!Z||Z instanceof M)}getProperty(B,U){const{source:Z}=this,oe=this._properties,ie=oe&&B in oe;if(!U)return ie?oe&&oe[B]:Z&&Z.getProperty(B);super.getProperty(B,U),Z&&!ie&&this._getSourceProperty(B,U)}_getSourceProperty(B,U){this.source.getProperty(B,Z=>{(!this._properties||!(B in this._properties))&&U(Z)})}getProperties(){const B=this.source?this.source.getProperties():{},U=this._properties;for(const Z in U)B[Z]=U[Z];return B}_toStringDetails(){return`{source: ${this.source?this.source.toString():"none"}}`}read(){this._sourceStarted||(this._sourceStarted=!0);const B=this.source;let U=null;if(!this.done&&B){const Z=B[n.DESTINATION];(U=Z.readAt(this._readPosition))!==null?this._readPosition++:this.readable=!1,Z.endsAt(this._readPosition)&&this.close()}return U}_end(B){const U=this.source,Z=U==null?void 0:U[n.DESTINATION];Z&&Z.unregister(this),A.prototype._end.call(this,B)}}n.ClonedIterator=q;class M{constructor(B){if(this._history=[],this._trackers=new Set,this._source=B,!B.done){const U=()=>{for(const ie of this._trackers)ie.readable=!0},Z=ie=>{for(const se of this._trackers)se.emit("error",ie)},oe=()=>{for(const ie of this._trackers)ie._sourceStarted!==!1&&ie._readPosition===this._history.length&&ie.close();this._trackers.clear(),B.removeListener("end",oe),B.removeListener("error",Z),B.removeListener("readable",U)};B.on("end",oe),B.on("error",Z),B.on("readable",U)}}register(B){this._source.done||this._trackers.add(B)}unregister(B){this._trackers.delete(B)}readAt(B){let U=null;return B<this._history.length?U=this._history[B]:!this._source.done&&(U=this._source.read())!==null&&(this._history[B]=U),U}endsAt(B){return this._source.done&&this._history.length===B}}class N extends l{constructor(B,U){super(),this._source=null,this._destroySource=(U==null?void 0:U.destroySource)!==!1,ve(B)?(this._source=new l,B.then(Z=>{this._source=null,this.source=Z}).catch(Z=>this.emit("error",Z))):B&&(this.source=B)}set source(B){let U=B;if(this._source!==null)throw new Error("The source cannot be changed after it has been set");if(J(U)&&(U=U[Symbol.iterator]()),j(U)){let Z=U;U=new t.EventEmitter,U.read=()=>{if(Z!==null){let oe;for(;!(oe=Z.next()).done;)if(oe.value!==null)return oe.value;Z=null,this.close()}return null}}else U=w(U);if(this.done){this._destroySource&&Te(U.destroy)&&U.destroy();return}U[n.DESTINATION]=this,U.on("end",L),U.on("error",I),U.on("readable",E),this._source=U,this.readable=U.readable!==!1}read(){if(this._source!==null&&this._source.readable!==!1){const B=this._source.read();if(B!==null)return B;this.readable=!1}return null}_end(B=!1){this._source!==null&&(this._source.removeListener("end",L),this._source.removeListener("error",I),this._source.removeListener("readable",E),delete this._source[n.DESTINATION],this._destroySource&&Te(this._source.destroy)&&this._source.destroy(),this._source=null),super._end(B)}}n.WrappingIterator=N;function G(z,B){if(B&&("autoStart"in B||"optional"in B||"source"in B||"maxBufferSize"in B))return z&&!Re(z)&&(z=new N(z)),new R(z,B);if(!z)return X();if(ve(z))return new N(z,B);if(z instanceof l)return z;if(Array.isArray(z))return W(z);if(J(z)||j(z)||Re(z))return new N(z,B);throw new TypeError(`Invalid source: ${z}`)}n.wrap=G;function X(){return new v}n.empty=X;function Y(z){return new g(z)}n.single=Y;function W(z){return new b(z)}n.fromArray=W;function te(z){return new N(z)}n.fromIterator=te;function ue(z){return new N(z)}n.fromIterable=ue;function fe(z){return new P(z)}n.union=fe;function re(z,B,U){return new _({start:z,end:B,step:U})}n.range=re;function ye(z,B){return B?z.bind(B):z}function Te(z){return typeof z=="function"}n.isFunction=Te;function Re(z){return Te(z==null?void 0:z.on)}n.isEventEmitter=Re;function ve(z){return Te(z==null?void 0:z.then)}n.isPromise=ve;function ce(z){return z&&(Re(z)||ve(z)||Te(z))}n.isSourceExpression=ce;function J(z){return z&&Symbol.iterator in z}n.isIterable=J;function j(z){return Te(z==null?void 0:z.next)}n.isIterator=j}(asynciterator)),asynciterator}var utils$4={},lib$4e={},BlankNodeScoped={},hasRequiredBlankNodeScoped;function requireBlankNodeScoped(){if(hasRequiredBlankNodeScoped)return BlankNodeScoped;hasRequiredBlankNodeScoped=1,Object.defineProperty(BlankNodeScoped,"__esModule",{value:!0}),BlankNodeScoped.BlankNodeScoped=void 0;let n=class{constructor(r,a){this.termType="BlankNode",this.value=r,this.skolemized=a}equals(r){return!!r&&r.termType==="BlankNode"&&r.value===this.value}};return BlankNodeScoped.BlankNodeScoped=n,BlankNodeScoped}var BlankNodeBindingsScoped={},hasRequiredBlankNodeBindingsScoped;function requireBlankNodeBindingsScoped(){if(hasRequiredBlankNodeBindingsScoped)return BlankNodeBindingsScoped;hasRequiredBlankNodeBindingsScoped=1,Object.defineProperty(BlankNodeBindingsScoped,"__esModule",{value:!0}),BlankNodeBindingsScoped.BlankNodeBindingsScoped=void 0;let n=class{constructor(r){this.termType="BlankNode",this.singleBindingsScope=!0,this.value=r}equals(r){return!!r&&r.termType==="BlankNode"&&r.value===this.value}};return BlankNodeBindingsScoped.BlankNodeBindingsScoped=n,BlankNodeBindingsScoped}var hasRequiredLib$4f;function requireLib$4f(){return hasRequiredLib$4f||(hasRequiredLib$4f=1,function(n){var t=lib$4e&&lib$4e.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4e&&lib$4e.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireBlankNodeScoped(),n),r(requireBlankNodeBindingsScoped(),n)}(lib$4e)),lib$4e}var hasRequiredUtils$6;function requireUtils$6(){return hasRequiredUtils$6||(hasRequiredUtils$6=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.deskolemizeOperation=n.deskolemizeQuad=n.deskolemizeTermNestedThrowing=n.deskolemizeTerm=n.skolemizeBindingsStream=n.skolemizeQuadStream=n.skolemizeBindings=n.skolemizeQuad=n.skolemizeTerm=n.getSourceId=n.SKOLEM_PREFIX=void 0;const t=requireLib$4f(),r=requireRdfTerms(),a=requireSparqlalgebrajs();n.SKOLEM_PREFIX="urn:comunica_skolem:source_";function o(b,_){let S=b.get(_.referenceValue);return S===void 0&&(S=`${b.size}`,b.set(_.referenceValue,S)),S}n.getSourceId=o;function u(b,_,S){return _.termType==="BlankNode"?new t.BlankNodeScoped(`bc_${S}_${_.value}`,b.namedNode(`${n.SKOLEM_PREFIX}${S}:${_.value}`)):_}n.skolemizeTerm=u;function s(b,_,S){return(0,r.mapTermsNested)(_,T=>u(b,T,S))}n.skolemizeQuad=s;function c(b,_,S){return _.map(T=>T.termType==="Quad"?s(b,T,S):u(b,T,S))}n.skolemizeBindings=c;function l(b,_,S){const T=_.map(A=>s(b,A,S));function w(){_.getProperty("metadata",A=>{T.setProperty("metadata",A),A.state.addInvalidateListener(w)})}return w(),T}n.skolemizeQuadStream=l;function d(b,_,S){const T=_.map(A=>c(b,A,S));function w(){_.getProperty("metadata",A=>{T.setProperty("metadata",A),A.state.addInvalidateListener(w)})}return w(),T}n.skolemizeBindingsStream=d;function f(b,_,S){if(_.termType==="BlankNode"&&"skolemized"in _&&(_=_.skolemized),_.termType==="NamedNode"&&_.value.startsWith(n.SKOLEM_PREFIX)){const T=_.value.indexOf(":",n.SKOLEM_PREFIX.length);if(_.value.slice(n.SKOLEM_PREFIX.length,T)===S){const A=_.value.slice(T+1,_.value.length);return b.blankNode(A)}return null}return _}n.deskolemizeTerm=f;function h(b,_,S){if(_.termType==="Quad")return(0,r.mapTermsNested)(_,w=>{const A=f(b,w,S);if(!A)throw new Error("Skolemized term is not in scope for this source");return A});const T=f(b,_,S);if(T===null)throw new Error("Skolemized term is not in scope for this source");return T}n.deskolemizeTermNestedThrowing=h;function v(b,_,S){return(0,r.mapTermsNested)(_,T=>f(b,T,S)??T)}n.deskolemizeQuad=v;function g(b,_,S){const T=new a.Factory;try{return a.Util.mapOperation(_,{[a.Algebra.types.PATTERN](w,A){return{result:Object.assign(A.createPattern(h(b,w.subject,S),h(b,w.predicate,S),h(b,w.object,S),h(b,w.graph,S)),{metadata:w.metadata}),recurse:!1}},[a.Algebra.types.PATH](w,A){return{result:Object.assign(A.createPath(h(b,w.subject,S),w.predicate,h(b,w.object,S),h(b,w.graph,S)),{metadata:w.metadata}),recurse:!1}}},T)}catch{}}n.deskolemizeOperation=g}(utils$4)),utils$4}var hasRequiredQuerySourceSkolemized;function requireQuerySourceSkolemized(){if(hasRequiredQuerySourceSkolemized)return QuerySourceSkolemized;hasRequiredQuerySourceSkolemized=1,Object.defineProperty(QuerySourceSkolemized,"__esModule",{value:!0}),QuerySourceSkolemized.QuerySourceSkolemized=void 0;const n=requireLib$4q(),t=requireLib$4l(),r=requireAsynciterator(),a=requireUtils$6();let o=class{constructor(s,c){this.innerSource=s,this.sourceId=c}async getSelectorShape(s){return this.innerSource.getSelectorShape(s)}queryBindings(s,c,l){const d=c.getSafe(n.KeysInitQuery.dataFactory),f=(0,a.deskolemizeOperation)(d,s,this.sourceId);if(!f){const h=new r.ArrayIterator([],{autoStart:!1});return h.setProperty("metadata",{state:new t.MetadataValidationState,cardinality:{type:"exact",value:0},variables:[]}),h}return(0,a.skolemizeBindingsStream)(d,this.innerSource.queryBindings(f,c,l),this.sourceId)}queryBoolean(s,c){return this.innerSource.queryBoolean(s,c)}queryQuads(s,c){const l=c.getSafe(n.KeysInitQuery.dataFactory),d=(0,a.deskolemizeOperation)(l,s,this.sourceId);if(!d){const f=new r.ArrayIterator([],{autoStart:!1});return f.setProperty("metadata",{state:new t.MetadataValidationState,cardinality:{type:"exact",value:0}}),f}return(0,a.skolemizeQuadStream)(l,this.innerSource.queryQuads(d,c),this.sourceId)}queryVoid(s,c){return this.innerSource.queryVoid(s,c)}get referenceValue(){return this.innerSource.referenceValue}toString(){return`${this.innerSource.toString()}(SkolemID:${this.sourceId})`}};return QuerySourceSkolemized.QuerySourceSkolemized=o,QuerySourceSkolemized}var hasRequiredActorContextPreprocessQuerySourceSkolemize;function requireActorContextPreprocessQuerySourceSkolemize(){if(hasRequiredActorContextPreprocessQuerySourceSkolemize)return ActorContextPreprocessQuerySourceSkolemize;hasRequiredActorContextPreprocessQuerySourceSkolemize=1,Object.defineProperty(ActorContextPreprocessQuerySourceSkolemize,"__esModule",{value:!0}),ActorContextPreprocessQuerySourceSkolemize.ActorContextPreprocessQuerySourceSkolemize=void 0;const n=requireLib$4j(),t=requireLib$4q(),r=requireLib$4s(),a=requireQuerySourceSkolemized(),o=requireUtils$6();let u=class extends n.ActorContextPreprocess{constructor(c){super(c)}async test(c){return(0,r.passTestVoid)()}async run(c){let l=c.context;if(l.has(t.KeysQueryOperation.querySources)){l.has(t.KeysQuerySourceIdentify.sourceIds)||(l=l.set(t.KeysQuerySourceIdentify.sourceIds,new Map));const d=l.getSafe(t.KeysQuerySourceIdentify.sourceIds);let f=l.getSafe(t.KeysQueryOperation.querySources);f=f.map(h=>({source:new a.QuerySourceSkolemized(h.source,(0,o.getSourceId)(d,h.source)),context:h.context})),l=l.set(t.KeysQueryOperation.querySources,f)}return{context:l}}};return ActorContextPreprocessQuerySourceSkolemize.ActorContextPreprocessQuerySourceSkolemize=u,ActorContextPreprocessQuerySourceSkolemize}var hasRequiredLib$4e;function requireLib$4e(){return hasRequiredLib$4e||(hasRequiredLib$4e=1,function(n){var t=lib$4f&&lib$4f.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4f&&lib$4f.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocessQuerySourceSkolemize(),n),r(requireQuerySourceSkolemized(),n),r(requireUtils$6(),n)}(lib$4f)),lib$4f}var lib$4d={},MediatorCombinePipeline={},hasRequiredMediatorCombinePipeline;function requireMediatorCombinePipeline(){if(hasRequiredMediatorCombinePipeline)return MediatorCombinePipeline;hasRequiredMediatorCombinePipeline=1,Object.defineProperty(MediatorCombinePipeline,"__esModule",{value:!0}),MediatorCombinePipeline.MediatorCombinePipeline=void 0;const n=requireLib$4s();let t=class extends n.Mediator{constructor(a){super(a)}async mediate(a){let o;try{o=this.publish(a)}catch{return a}if(this.filterFailures){const l=[];for(const d of o)(await d.reply).isPassed()&&l.push(d);o=l}const u=[];if(o=await Promise.all(o.map(async({actor:l,reply:d},f)=>{try{const h=await d,v=h.getOrThrow();return u[f]=h.getSideData(),{actor:l,reply:v}}catch(h){throw new Error(this.constructFailureMessage(a,[h.message]))}})),this.order){const l=d=>{const f=this.field?d[this.field]:d;if(typeof f!="number")throw new TypeError("Cannot order elements that are not numbers.");return f};o=o.sort((d,f)=>(this.order==="increasing"?1:-1)*(l(d.reply)-l(f.reply)))}let s=a,c=0;for(const{actor:l}of o)s={...s,...await l.runObservable(s,u[c++])};return s}mediateWith(){throw new Error("Method not supported.")}};return MediatorCombinePipeline.MediatorCombinePipeline=t,MediatorCombinePipeline}var hasRequiredLib$4d;function requireLib$4d(){return hasRequiredLib$4d||(hasRequiredLib$4d=1,function(n){var t=lib$4d&&lib$4d.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4d&&lib$4d.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorCombinePipeline(),n)}(lib$4d)),lib$4d}var lib$4c={},ActorHashBindingsMurmur={},lib$4b={},ActorHashBindings={},hasRequiredActorHashBindings;function requireActorHashBindings(){if(hasRequiredActorHashBindings)return ActorHashBindings;hasRequiredActorHashBindings=1,Object.defineProperty(ActorHashBindings,"__esModule",{value:!0}),ActorHashBindings.ActorHashBindings=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorHashBindings.ActorHashBindings=t,ActorHashBindings}var hasRequiredLib$4c;function requireLib$4c(){return hasRequiredLib$4c||(hasRequiredLib$4c=1,function(n){var t=lib$4b&&lib$4b.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4b&&lib$4b.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHashBindings(),n)}(lib$4b)),lib$4b}var imurmurhash={exports:{}};/**
 * @preserve
 * JS Implementation of incremental MurmurHash3 (r150) (as of May 10, 2013)
 *
 * @author <a href="mailto:jensyt@gmail.com">Jens Taylor</a>
 * @see http://github.com/homebrewing/brauhaus-diff
 * @author <a href="mailto:gary.court@gmail.com">Gary Court</a>
 * @see http://github.com/garycourt/murmurhash-js
 * @author <a href="mailto:aappleby@gmail.com">Austin Appleby</a>
 * @see http://sites.google.com/site/murmurhash/
 */var hasRequiredImurmurhash;function requireImurmurhash(){return hasRequiredImurmurhash||(hasRequiredImurmurhash=1,function(n){(function(){var t;function r(a,o){var u=this instanceof r?this:t;if(u.reset(o),typeof a=="string"&&a.length>0&&u.hash(a),u!==this)return u}r.prototype.hash=function(a){var o,u,s,c,l;switch(l=a.length,this.len+=l,u=this.k1,s=0,this.rem){case 0:u^=l>s?a.charCodeAt(s++)&65535:0;case 1:u^=l>s?(a.charCodeAt(s++)&65535)<<8:0;case 2:u^=l>s?(a.charCodeAt(s++)&65535)<<16:0;case 3:u^=l>s?(a.charCodeAt(s)&255)<<24:0,u^=l>s?(a.charCodeAt(s++)&65280)>>8:0}if(this.rem=l+this.rem&3,l-=this.rem,l>0){for(o=this.h1;u=u*11601+(u&65535)*3432906752&4294967295,u=u<<15|u>>>17,u=u*13715+(u&65535)*461832192&4294967295,o^=u,o=o<<13|o>>>19,o=o*5+3864292196&4294967295,!(s>=l);)u=a.charCodeAt(s++)&65535^(a.charCodeAt(s++)&65535)<<8^(a.charCodeAt(s++)&65535)<<16,c=a.charCodeAt(s++),u^=(c&255)<<24^(c&65280)>>8;switch(u=0,this.rem){case 3:u^=(a.charCodeAt(s+2)&65535)<<16;case 2:u^=(a.charCodeAt(s+1)&65535)<<8;case 1:u^=a.charCodeAt(s)&65535}this.h1=o}return this.k1=u,this},r.prototype.result=function(){var a,o;return a=this.k1,o=this.h1,a>0&&(a=a*11601+(a&65535)*3432906752&4294967295,a=a<<15|a>>>17,a=a*13715+(a&65535)*461832192&4294967295,o^=a),o^=this.len,o^=o>>>16,o=o*51819+(o&65535)*2246770688&4294967295,o^=o>>>13,o=o*44597+(o&65535)*3266445312&4294967295,o^=o>>>16,o>>>0},r.prototype.reset=function(a){return this.h1=typeof a=="number"?a:0,this.rem=this.k1=this.len=0,this},t=new r,n.exports=r})()}(imurmurhash)),imurmurhash.exports}var hasRequiredActorHashBindingsMurmur;function requireActorHashBindingsMurmur(){if(hasRequiredActorHashBindingsMurmur)return ActorHashBindingsMurmur;hasRequiredActorHashBindingsMurmur=1,Object.defineProperty(ActorHashBindingsMurmur,"__esModule",{value:!0}),ActorHashBindingsMurmur.ActorHashBindingsMurmur=void 0;const n=requireLib$4c(),t=requireLib$4s(),r=requireImurmurhash();let a=class extends n.ActorHashBindings{async test(u){return(0,t.passTestVoid)()}async run(u){return{hashFunction:(s,c)=>{var d;let l=r();for(const f of c)l=l.hash(((d=s.get(f))==null?void 0:d.value)??"UNDEF");return l.result()}}}};return ActorHashBindingsMurmur.ActorHashBindingsMurmur=a,ActorHashBindingsMurmur}var hasRequiredLib$4b;function requireLib$4b(){return hasRequiredLib$4b||(hasRequiredLib$4b=1,function(n){var t=lib$4c&&lib$4c.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4c&&lib$4c.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHashBindingsMurmur(),n)}(lib$4c)),lib$4c}var lib$4a={},MediatorRace={},hasRequiredMediatorRace;function requireMediatorRace(){if(hasRequiredMediatorRace)return MediatorRace;hasRequiredMediatorRace=1,Object.defineProperty(MediatorRace,"__esModule",{value:!0}),MediatorRace.MediatorRace=void 0;const n=requireLib$4s();let t=class extends n.Mediator{constructor(a){super(a)}mediateWith(a,o){return new Promise((u,s)=>{const c=[];for(const l of o)l.reply.then(d=>{d.isPassed()?u((0,n.passTestWithSideData)(l.actor,d.getSideData())):(c.push(d.getFailMessage()),c.length===o.length&&u((0,n.failTest)(this.constructFailureMessage(a,c))))}).catch(d=>{s(d)})})}};return MediatorRace.MediatorRace=t,MediatorRace}var hasRequiredLib$4a;function requireLib$4a(){return hasRequiredLib$4a||(hasRequiredLib$4a=1,function(n){var t=lib$4a&&lib$4a.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4a&&lib$4a.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorRace(),n)}(lib$4a)),lib$4a}var lib$49={},ActorHashQuadsMurmur={},lib$48={},ActorHashQuads={},hasRequiredActorHashQuads;function requireActorHashQuads(){if(hasRequiredActorHashQuads)return ActorHashQuads;hasRequiredActorHashQuads=1,Object.defineProperty(ActorHashQuads,"__esModule",{value:!0}),ActorHashQuads.ActorHashQuads=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorHashQuads.ActorHashQuads=t,ActorHashQuads}var hasRequiredLib$49;function requireLib$49(){return hasRequiredLib$49||(hasRequiredLib$49=1,function(n){var t=lib$48&&lib$48.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$48&&lib$48.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHashQuads(),n)}(lib$48)),lib$48}var hasRequiredActorHashQuadsMurmur;function requireActorHashQuadsMurmur(){if(hasRequiredActorHashQuadsMurmur)return ActorHashQuadsMurmur;hasRequiredActorHashQuadsMurmur=1,Object.defineProperty(ActorHashQuadsMurmur,"__esModule",{value:!0}),ActorHashQuadsMurmur.ActorHashQuadsMurmur=void 0;const n=requireLib$49(),t=requireLib$4s(),r=requireImurmurhash();let a=class extends n.ActorHashQuads{async test(u){return(0,t.passTestVoid)()}async run(u){return{hashFunction:s=>{const c=r(s.subject.value);return c.hash(s.predicate.value),c.hash(s.object.value),c.hash(s.graph.value),c.result()}}}};return ActorHashQuadsMurmur.ActorHashQuadsMurmur=a,ActorHashQuadsMurmur}var hasRequiredLib$48;function requireLib$48(){return hasRequiredLib$48||(hasRequiredLib$48=1,function(n){var t=lib$49&&lib$49.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$49&&lib$49.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHashQuadsMurmur(),n)}(lib$49)),lib$49}var lib$47={},ActorOptimizeQueryOperationRewriteCopy={},lib$46={},ActorOptimizeQueryOperation={},hasRequiredActorOptimizeQueryOperation;function requireActorOptimizeQueryOperation(){if(hasRequiredActorOptimizeQueryOperation)return ActorOptimizeQueryOperation;hasRequiredActorOptimizeQueryOperation=1,Object.defineProperty(ActorOptimizeQueryOperation,"__esModule",{value:!0}),ActorOptimizeQueryOperation.ActorOptimizeQueryOperation=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorOptimizeQueryOperation.ActorOptimizeQueryOperation=t,ActorOptimizeQueryOperation}var hasRequiredLib$47;function requireLib$47(){return hasRequiredLib$47||(hasRequiredLib$47=1,function(n){var t=lib$46&&lib$46.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$46&&lib$46.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperation(),n)}(lib$46)),lib$46}var hasRequiredActorOptimizeQueryOperationRewriteCopy;function requireActorOptimizeQueryOperationRewriteCopy(){if(hasRequiredActorOptimizeQueryOperationRewriteCopy)return ActorOptimizeQueryOperationRewriteCopy;hasRequiredActorOptimizeQueryOperationRewriteCopy=1,Object.defineProperty(ActorOptimizeQueryOperationRewriteCopy,"__esModule",{value:!0}),ActorOptimizeQueryOperationRewriteCopy.ActorOptimizeQueryOperationRewriteCopy=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{constructor(s){super(s)}async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c);return{operation:a.Util.mapOperation(s.operation,{[a.Algebra.types.COPY](f,h){let v;return typeof f.destination=="string"&&typeof f.source=="string"&&f.destination===f.source||typeof f.destination!="string"&&typeof f.source!="string"&&f.destination.equals(f.source)?v=h.createCompositeUpdate([]):v=h.createCompositeUpdate([h.createDrop(f.destination,!0),h.createAdd(f.source,f.destination,f.silent)]),{result:v,recurse:!1}}},l),context:s.context}}};return ActorOptimizeQueryOperationRewriteCopy.ActorOptimizeQueryOperationRewriteCopy=o,ActorOptimizeQueryOperationRewriteCopy}var hasRequiredLib$46;function requireLib$46(){return hasRequiredLib$46||(hasRequiredLib$46=1,function(n){var t=lib$47&&lib$47.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$47&&lib$47.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationRewriteCopy(),n)}(lib$47)),lib$47}var lib$45={},ActorOptimizeQueryOperationRewriteMove={},hasRequiredActorOptimizeQueryOperationRewriteMove;function requireActorOptimizeQueryOperationRewriteMove(){if(hasRequiredActorOptimizeQueryOperationRewriteMove)return ActorOptimizeQueryOperationRewriteMove;hasRequiredActorOptimizeQueryOperationRewriteMove=1,Object.defineProperty(ActorOptimizeQueryOperationRewriteMove,"__esModule",{value:!0}),ActorOptimizeQueryOperationRewriteMove.ActorOptimizeQueryOperationRewriteMove=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{constructor(s){super(s)}async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c);return{operation:a.Util.mapOperation(s.operation,{[a.Algebra.types.MOVE](f,h){let v;if(typeof f.destination=="string"&&typeof f.source=="string"&&f.destination===f.source||typeof f.destination!="string"&&typeof f.source!="string"&&f.destination.equals(f.source))v=h.createCompositeUpdate([]);else{const g=[h.createDrop(f.destination,!0),h.createAdd(f.source,f.destination,f.silent),h.createDrop(f.source)];v=h.createCompositeUpdate(g)}return{result:v,recurse:!1}}},l),context:s.context}}};return ActorOptimizeQueryOperationRewriteMove.ActorOptimizeQueryOperationRewriteMove=o,ActorOptimizeQueryOperationRewriteMove}var hasRequiredLib$45;function requireLib$45(){return hasRequiredLib$45||(hasRequiredLib$45=1,function(n){var t=lib$45&&lib$45.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$45&&lib$45.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationRewriteMove(),n)}(lib$45)),lib$45}var lib$44={},ActorOptimizeQueryOperationRewriteAdd={},hasRequiredActorOptimizeQueryOperationRewriteAdd;function requireActorOptimizeQueryOperationRewriteAdd(){if(hasRequiredActorOptimizeQueryOperationRewriteAdd)return ActorOptimizeQueryOperationRewriteAdd;hasRequiredActorOptimizeQueryOperationRewriteAdd=1,Object.defineProperty(ActorOptimizeQueryOperationRewriteAdd,"__esModule",{value:!0}),ActorOptimizeQueryOperationRewriteAdd.ActorOptimizeQueryOperationRewriteAdd=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfDataFactory(),o=requireSparqlalgebrajs(),u=new a.DataFactory;let s=class extends n.ActorOptimizeQueryOperation{constructor(l){super(l)}async test(l){return(0,r.passTestVoid)()}async run(l){const d=l.context.getSafe(t.KeysInitQuery.dataFactory),f=new o.Factory(d);return{operation:o.Util.mapOperation(l.operation,{[o.Algebra.types.ADD](v,g){const b=v.destination==="DEFAULT"?u.defaultGraph():v.destination,_=v.source==="DEFAULT"?u.defaultGraph():v.source;return{result:g.createDeleteInsert(void 0,[g.createPattern(u.variable("s"),u.variable("p"),u.variable("o"),b)],g.createPattern(u.variable("s"),u.variable("p"),u.variable("o"),_)),recurse:!1}}},f),context:l.context}}};return ActorOptimizeQueryOperationRewriteAdd.ActorOptimizeQueryOperationRewriteAdd=s,ActorOptimizeQueryOperationRewriteAdd}var hasRequiredLib$44;function requireLib$44(){return hasRequiredLib$44||(hasRequiredLib$44=1,function(n){var t=lib$44&&lib$44.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$44&&lib$44.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationRewriteAdd(),n)}(lib$44)),lib$44}var lib$43={},ActorOptimizeQueryOperationGroupSources={},lib$42={},FragmentSelectorShapes={},hasRequiredFragmentSelectorShapes;function requireFragmentSelectorShapes(){if(hasRequiredFragmentSelectorShapes)return FragmentSelectorShapes;hasRequiredFragmentSelectorShapes=1,Object.defineProperty(FragmentSelectorShapes,"__esModule",{value:!0}),FragmentSelectorShapes.doesShapeAcceptOperation=void 0;function n(a,o,u){return t(a,a,o,u)}FragmentSelectorShapes.doesShapeAcceptOperation=n;function t(a,o,u,s){if(o.type==="conjunction")return o.children.every(l=>t(a,l,u,s));if(o.type==="disjunction")return o.children.some(l=>t(a,l,u,s));if(o.type==="arity")return t(a,o.child,u,s);if(((s==null?void 0:s.joinBindings)&&!o.joinBindings)??((s==null?void 0:s.filterBindings)&&!o.filterBindings))return!1;const c=o.operation;switch(c.operationType){case"type":return r(a,o,u,s)?c.type===u.type:!1;case"pattern":return r(a,o,u,s)?c.pattern.type===u.type:!1;case"wildcard":return!0}}function r(a,o,u,s){return!(u.input&&!(Array.isArray(u.input)?u.input:[u.input]).every(l=>t(a,a,l,s))||u.patterns&&!u.patterns.every(c=>t(a,a,c,s)))}return FragmentSelectorShapes}var Utils$1={},hasRequiredUtils$5;function requireUtils$5(){if(hasRequiredUtils$5)return Utils$1;hasRequiredUtils$5=1,Object.defineProperty(Utils$1,"__esModule",{value:!0}),Utils$1.removeOperationSource=Utils$1.assignOperationSource=Utils$1.getOperationSource=Utils$1.testReadOnly=Utils$1.validateQueryOutput=Utils$1.getSafeVoid=Utils$1.getSafeBoolean=Utils$1.getSafeQuads=Utils$1.getSafeBindings=void 0;const n=requireLib$4q(),t=requireLib$4s();function r(h){return s(h,"bindings"),h}Utils$1.getSafeBindings=r;function a(h){return s(h,"quads"),h}Utils$1.getSafeQuads=a;function o(h){return s(h,"boolean"),h}Utils$1.getSafeBoolean=o;function u(h){return s(h,"void"),h}Utils$1.getSafeVoid=u;function s(h,v){if(h.type!==v)throw new Error(`Invalid query output type: Expected '${v}' but got '${h.type}'`)}Utils$1.validateQueryOutput=s;function c(h){return h.get(n.KeysQueryOperation.readOnly)?(0,t.failTest)("Attempted a write operation in read-only mode"):(0,t.passTestVoid)()}Utils$1.testReadOnly=c;function l(h){var v;return(v=h.metadata)==null?void 0:v.scopedSource}Utils$1.getOperationSource=l;function d(h,v){return h={...h},h.metadata=h.metadata?{...h.metadata}:{},h.metadata.scopedSource=v,h}Utils$1.assignOperationSource=d;function f(h){var v;(v=h.metadata)==null||delete v.scopedSource,h.metadata&&Object.keys(h.metadata).length===0&&delete h.metadata}return Utils$1.removeOperationSource=f,Utils$1}var MaterializeBindings={},hasRequiredMaterializeBindings;function requireMaterializeBindings(){if(hasRequiredMaterializeBindings)return MaterializeBindings;hasRequiredMaterializeBindings=1,Object.defineProperty(MaterializeBindings,"__esModule",{value:!0}),MaterializeBindings.materializeOperation=MaterializeBindings.materializeTerm=void 0;const n=requireRdfString(),t=requireRdfTerms(),r=requireSparqlalgebrajs();function a(s,c){if(s.termType==="Variable"){const l=c.get(s);if(l)return l}return s.termType==="Quad"&&(0,t.someTermsNested)(s,l=>l.termType==="Variable")?(0,t.mapTermsNested)(s,l=>a(l,c)):s}MaterializeBindings.materializeTerm=a;function o(s,c,l,d,f={}){return f={strictTargetVariables:"strictTargetVariables"in f?f.strictTargetVariables:!1,bindFilter:"bindFilter"in f?f.bindFilter:!0,originalBindings:"originalBindings"in f?f.originalBindings:c},r.Util.mapOperation(s,{path(h,v){return{recurse:!1,result:Object.assign(v.createPath(a(h.subject,c),h.predicate,a(h.object,c),a(h.graph,c)),{metadata:h.metadata})}},pattern(h,v){return{recurse:!1,result:Object.assign(v.createPattern(a(h.subject,c),a(h.predicate,c),a(h.object,c),a(h.graph,c)),{metadata:h.metadata})}},extend(h){if(c.has(h.variable)){if(f.strictTargetVariables)throw new Error(`Tried to bind variable ${(0,n.termToString)(h.variable)} in a BIND operator.`);return{recurse:!0,result:o(h.input,c,l,d,f)}}return{recurse:!0,result:h}},group(h,v){if(f.strictTargetVariables){for(const b of h.variables)if(c.has(b))throw new Error(`Tried to bind variable ${(0,n.termToString)(b)} in a GROUP BY operator.`);return{recurse:!0,result:h}}const g=h.variables.filter(b=>!c.has(b));return{recurse:!0,result:v.createGroup(h.input,g,h.aggregates)}},filter(h,v){const g=f.originalBindings;if(h.expression.expressionType!=="operator"||g.size===0)return{recurse:!1,result:h};const b=u(v,g),_=o(h.expression,c,l,d,f);let S=o(h.input,c,l,d,f);return b.length>0&&(S=v.createJoin([...b,S])),{recurse:!1,result:v.createFilter(S,_)}},project(h,v){if(f.strictTargetVariables){for(const _ of h.variables)if(c.has(_))throw new Error(`Tried to bind variable ${(0,n.termToString)(_)} in a SELECT operator.`);return{recurse:!0,result:h}}for(const _ of c.keys())for(const S of h.variables)if(S.equals(_)){c=c.delete(_);break}const g=u(v,f.originalBindings,h.variables);let b=o(h.input,c,l,d,f);return g.length>0&&(b=v.createJoin([...g,b])),{recurse:!1,result:v.createProject(b,h.variables)}},values(h,v){if(f.strictTargetVariables){for(const g of h.variables)if(c.has(g))throw new Error(`Tried to bind variable ${(0,n.termToString)(g)} in a VALUES operator.`)}else{const g=h.variables.filter(_=>!c.has(_)),b=h.bindings.map(_=>{const S={..._};let T=!0;return c.forEach((w,A)=>{const R=(0,n.termToString)(A);R in S&&(w.equals(S[R])||(T=!1),delete S[R])}),T?S:void 0}).filter(Boolean);return{recurse:!0,result:v.createValues(g,b)}}return{recurse:!1,result:h}},expression(h,v){if(!f.bindFilter)return{recurse:!1,result:h};if(h.expressionType==="term")return{recurse:!1,result:v.createTermExpression(a(h.term,c))};if(h.expressionType==="operator")return h.operator==="bound"&&h.args.length===1&&h.args[0].expressionType==="term"&&[...c.keys()].some(g=>h.args[0].term.equals(g))?{recurse:!1,result:v.createTermExpression(v.dataFactory.literal("true",v.dataFactory.namedNode("http://www.w3.org/2001/XMLSchema#boolean")))}:{recurse:!0,result:h};if(h.expressionType==="aggregate"&&"variable"in h&&c.has(h.variable)){if(f.strictTargetVariables)throw new Error(`Tried to bind ${(0,n.termToString)(h.variable)} in a ${h.aggregator} aggregate.`);return{recurse:!0,result:h}}return{recurse:!0,result:h}}},l)}MaterializeBindings.materializeOperation=o;function u(s,c,l){const d=[];for(const[f,h]of c)if(!l||l.some(v=>v.equals(f))){const v={[(0,n.termToString)(f)]:h};d.push(s.createValues([f],[v]))}return d}return MaterializeBindings}var hasRequiredLib$43;function requireLib$43(){return hasRequiredLib$43||(hasRequiredLib$43=1,function(n){var t=lib$42&&lib$42.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$42&&lib$42.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireFragmentSelectorShapes(),n),r(requireUtils$5(),n),r(requireMaterializeBindings(),n)}(lib$42)),lib$42}var hasRequiredActorOptimizeQueryOperationGroupSources;function requireActorOptimizeQueryOperationGroupSources(){if(hasRequiredActorOptimizeQueryOperationGroupSources)return ActorOptimizeQueryOperationGroupSources;hasRequiredActorOptimizeQueryOperationGroupSources=1,Object.defineProperty(ActorOptimizeQueryOperationGroupSources,"__esModule",{value:!0}),ActorOptimizeQueryOperationGroupSources.ActorOptimizeQueryOperationGroupSources=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireSparqlalgebrajs();let u=class extends n.ActorOptimizeQueryOperation{constructor(c){super(c)}async test(c){return(0,a.getOperationSource)(c.operation)?(0,r.failTest)(`Actor ${this.name} does not work with top-level operation sources.`):(0,r.passTestVoid)()}async run(c){return{operation:await this.groupOperation(c.operation,c.context),context:c.context}}async groupOperation(c,l){var b;const d=l.getSafe(t.KeysInitQuery.dataFactory),f=new o.Factory(d);if((0,a.getOperationSource)(c)??!("input"in c))return c;if(!Array.isArray(c.input)){const _=await this.groupOperation(c.input,l);if((b=_.metadata)!=null&&b.scopedSource){const S=(0,a.getOperationSource)(_);(0,a.doesShapeAcceptOperation)(await S.source.getSelectorShape(l),c)&&(this.logDebug(l,`Hoist 1 source-specific operation into a single ${c.type} operation for ${S.source.toString()}`),(0,a.removeOperationSource)(_),c=(0,a.assignOperationSource)(c,S))}return{...c,input:_}}const h=await Promise.all(c.input.map(_=>this.groupOperation(_,l))),v=this.clusterOperationsWithEqualSources(h);if(v.length===1){const _=v[0],S=(0,a.getOperationSource)(v[0][0]);return{...await this.moveSourceAnnotationUpwardsIfPossible(c,_,S,l),input:_}}if(v.length===h.length)return{...c,input:h};let g;switch(c.type){case o.Algebra.types.JOIN:g=f.createJoin.bind(f);break;case o.Algebra.types.UNION:g=f.createUnion.bind(f);break;case o.Algebra.types.ALT:g=f.createAlt.bind(f);break;case o.Algebra.types.SEQ:g=f.createSeq.bind(f);break;default:throw new Error(`Unsupported operation '${c.type}' detected while grouping sources`)}return await this.groupOperationMulti(v,g,l)}async groupOperationMulti(c,l,d){let f=!0;const h=await Promise.all(c.map(async v=>{const g=(0,a.getOperationSource)(v[0]),b=await this.moveSourceAnnotationUpwardsIfPossible(l(v,!0),v,g,d);return(0,a.getOperationSource)(b)&&(f=!1),b}));return l(h,f)}clusterOperationsWithEqualSources(c){const l=new Map,d=[];for(const h of c){const v=(0,a.getOperationSource)(h);v?(l.has(v)||l.set(v,[]),l.get(v).push(h)):d.push(h)}const f=[];d.length>0&&f.push(d);for(const[h,v]of l.entries())f.push(v.map(g=>(0,a.assignOperationSource)(g,h)));return f}async moveSourceAnnotationUpwardsIfPossible(c,l,d,f){if(d&&(0,a.doesShapeAcceptOperation)(await d.source.getSelectorShape(f),c)){this.logDebug(f,`Hoist ${l.length} source-specific operations into a single ${c.type} operation for ${d.source.toString()}`),c=(0,a.assignOperationSource)(c,d);for(const h of l)(0,a.removeOperationSource)(h)}return c}};return ActorOptimizeQueryOperationGroupSources.ActorOptimizeQueryOperationGroupSources=u,ActorOptimizeQueryOperationGroupSources}var hasRequiredLib$42;function requireLib$42(){return hasRequiredLib$42||(hasRequiredLib$42=1,function(n){var t=lib$43&&lib$43.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$43&&lib$43.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationGroupSources(),n)}(lib$43)),lib$43}var lib$41={},ActorOptimizeQueryOperationConstructDistinct={},hasRequiredActorOptimizeQueryOperationConstructDistinct;function requireActorOptimizeQueryOperationConstructDistinct(){if(hasRequiredActorOptimizeQueryOperationConstructDistinct)return ActorOptimizeQueryOperationConstructDistinct;hasRequiredActorOptimizeQueryOperationConstructDistinct=1,Object.defineProperty(ActorOptimizeQueryOperationConstructDistinct,"__esModule",{value:!0}),ActorOptimizeQueryOperationConstructDistinct.ActorOptimizeQueryOperationConstructDistinct=void 0;const n=requireLib$47(),t=requireKeys(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{constructor(s){super(s)}async test(s){return s.context.has(t.KeysInitQuery.distinctConstruct)?(0,r.passTestVoid)():(0,r.failTest)(`${this.name} was not enabled by the query.`)}async run(s){return{operation:a.Util.mapOperation(s.operation,{construct(l,d){return{recurse:!1,result:d.createDistinct(d.createConstruct(l.input,l.template))}}}),context:s.context.delete(t.KeysInitQuery.distinctConstruct)}}};return ActorOptimizeQueryOperationConstructDistinct.ActorOptimizeQueryOperationConstructDistinct=o,ActorOptimizeQueryOperationConstructDistinct}var hasRequiredLib$41;function requireLib$41(){return hasRequiredLib$41||(hasRequiredLib$41=1,function(n){var t=lib$41&&lib$41.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$41&&lib$41.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationConstructDistinct(),n)}(lib$41)),lib$41}var lib$40={},ActorQueryParseSparql={},lib$3$={},ActorQueryParse={},hasRequiredActorQueryParse;function requireActorQueryParse(){if(hasRequiredActorQueryParse)return ActorQueryParse;hasRequiredActorQueryParse=1,Object.defineProperty(ActorQueryParse,"__esModule",{value:!0}),ActorQueryParse.ActorQueryParse=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorQueryParse.ActorQueryParse=t,ActorQueryParse}var hasRequiredLib$40;function requireLib$40(){return hasRequiredLib$40||(hasRequiredLib$40=1,function(n){var t=lib$3$&&lib$3$.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3$&&lib$3$.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryParse(),n)}(lib$3$)),lib$3$}var hasRequiredActorQueryParseSparql;function requireActorQueryParseSparql(){if(hasRequiredActorQueryParseSparql)return ActorQueryParseSparql;hasRequiredActorQueryParseSparql=1,Object.defineProperty(ActorQueryParseSparql,"__esModule",{value:!0}),ActorQueryParseSparql.ActorQueryParseSparql=void 0;const n=requireLib$40(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs(),o=requireSparql$1();let u=class extends n.ActorQueryParse{constructor(c){super(c),this.prefixes=Object.freeze(this.prefixes)}async test(c){return c.queryFormat&&c.queryFormat.language!=="sparql"?(0,r.failTest)("This actor can only parse SPARQL queries"):(0,r.passTestVoid)()}async run(c){const l=c.context.getSafe(t.KeysInitQuery.dataFactory),f=new o.Parser({prefixes:this.prefixes,baseIRI:c.baseIRI,sparqlStar:!0,factory:l}).parse(c.query);return{baseIRI:f.type==="query"?f.base:void 0,operation:(0,a.translate)(f,{quads:!0,prefixes:this.prefixes,blankToVariable:!0,baseIRI:c.baseIRI,dataFactory:l})}}};return ActorQueryParseSparql.ActorQueryParseSparql=u,ActorQueryParseSparql}var hasRequiredLib$3$;function requireLib$3$(){return hasRequiredLib$3$||(hasRequiredLib$3$=1,function(n){var t=lib$40&&lib$40.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$40&&lib$40.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryParseSparql(),n)}(lib$40)),lib$40}var lib$3_={},ActorQueryParseGraphql={},graphqlToSparql={},handler$1={},directivenode={},DirectiveNodeHandlerAdapter={},hasRequiredDirectiveNodeHandlerAdapter;function requireDirectiveNodeHandlerAdapter(){if(hasRequiredDirectiveNodeHandlerAdapter)return DirectiveNodeHandlerAdapter;hasRequiredDirectiveNodeHandlerAdapter=1,Object.defineProperty(DirectiveNodeHandlerAdapter,"__esModule",{value:!0}),DirectiveNodeHandlerAdapter.DirectiveNodeHandlerAdapter=void 0;let n=class{constructor(r,a,o){this.targetKind=r,this.util=a,this.settings=o}getDirectiveConditionalValue(r,a){const o=this.util.getArgument(r.arguments,"if");if(!o)throw new Error(`The directive ${r.name.value} is missing an if-argument.`);const u=this.util.handleNodeValue(o.value,o.name.value,a);if(u.terms.length!==1)throw new Error(`Can not apply the directive ${r.name.value} with a list.`);return u.terms[0]}isDirectiveScopeAll(r){const a=this.util.getArgument(r.arguments,"scope");return a&&a.value.kind==="EnumValue"&&a.value.value==="all"}};return DirectiveNodeHandlerAdapter.DirectiveNodeHandlerAdapter=n,DirectiveNodeHandlerAdapter}var DirectiveNodeHandlerInclude={},hasRequiredDirectiveNodeHandlerInclude;function requireDirectiveNodeHandlerInclude(){if(hasRequiredDirectiveNodeHandlerInclude)return DirectiveNodeHandlerInclude;hasRequiredDirectiveNodeHandlerInclude=1,Object.defineProperty(DirectiveNodeHandlerInclude,"__esModule",{value:!0}),DirectiveNodeHandlerInclude.DirectiveNodeHandlerInclude=void 0;const n=requireDirectiveNodeHandlerAdapter();let t=class extends n.DirectiveNodeHandlerAdapter{constructor(a,o){super("include",a,o)}handle(a,o){const u=this.getDirectiveConditionalValue(a.directive,o);return u.termType==="Literal"&&u.value==="false"?{ignore:!0}:{}}};return DirectiveNodeHandlerInclude.DirectiveNodeHandlerInclude=t,DirectiveNodeHandlerInclude}var DirectiveNodeHandlerOptional={},hasRequiredDirectiveNodeHandlerOptional;function requireDirectiveNodeHandlerOptional(){if(hasRequiredDirectiveNodeHandlerOptional)return DirectiveNodeHandlerOptional;hasRequiredDirectiveNodeHandlerOptional=1,Object.defineProperty(DirectiveNodeHandlerOptional,"__esModule",{value:!0}),DirectiveNodeHandlerOptional.DirectiveNodeHandlerOptional=void 0;const n=requireDirectiveNodeHandlerAdapter();let t=class extends n.DirectiveNodeHandlerAdapter{constructor(a,o){super("optional",a,o)}handle(a,o){return{operationOverrider:u=>this.util.operationFactory.createLeftJoin(this.util.operationFactory.createBgp([]),u)}}};return DirectiveNodeHandlerOptional.DirectiveNodeHandlerOptional=t,DirectiveNodeHandlerOptional}var DirectiveNodeHandlerPlural={},IConvertContext={},hasRequiredIConvertContext;function requireIConvertContext(){return hasRequiredIConvertContext||(hasRequiredIConvertContext=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SingularizeState=void 0,function(t){t[t.SINGLE=0]="SINGLE",t[t.PLURAL=1]="PLURAL"}(n.SingularizeState||(n.SingularizeState={}))}(IConvertContext)),IConvertContext}var hasRequiredDirectiveNodeHandlerPlural;function requireDirectiveNodeHandlerPlural(){if(hasRequiredDirectiveNodeHandlerPlural)return DirectiveNodeHandlerPlural;hasRequiredDirectiveNodeHandlerPlural=1,Object.defineProperty(DirectiveNodeHandlerPlural,"__esModule",{value:!0}),DirectiveNodeHandlerPlural.DirectiveNodeHandlerPlural=void 0;const n=requireIConvertContext(),t=requireDirectiveNodeHandlerAdapter();let r=class extends t.DirectiveNodeHandlerAdapter{constructor(o,u){super("plural",o,u)}handle(o,u){return this.isDirectiveScopeAll(o.directive)&&(u.singularizeState=n.SingularizeState.PLURAL),delete u.singularizeVariables[this.util.nameToVariable(o.fieldLabel,u).value],{}}};return DirectiveNodeHandlerPlural.DirectiveNodeHandlerPlural=r,DirectiveNodeHandlerPlural}var DirectiveNodeHandlerSingle={},hasRequiredDirectiveNodeHandlerSingle;function requireDirectiveNodeHandlerSingle(){if(hasRequiredDirectiveNodeHandlerSingle)return DirectiveNodeHandlerSingle;hasRequiredDirectiveNodeHandlerSingle=1,Object.defineProperty(DirectiveNodeHandlerSingle,"__esModule",{value:!0}),DirectiveNodeHandlerSingle.DirectiveNodeHandlerSingle=void 0;const n=requireIConvertContext(),t=requireDirectiveNodeHandlerAdapter();let r=class extends t.DirectiveNodeHandlerAdapter{constructor(o,u){super("single",o,u)}handle(o,u){return this.isDirectiveScopeAll(o.directive)&&(u.singularizeState=n.SingularizeState.SINGLE),u.singularizeVariables[this.util.nameToVariable(o.fieldLabel,u).value]=!0,{}}};return DirectiveNodeHandlerSingle.DirectiveNodeHandlerSingle=r,DirectiveNodeHandlerSingle}var DirectiveNodeHandlerSkip={},hasRequiredDirectiveNodeHandlerSkip;function requireDirectiveNodeHandlerSkip(){if(hasRequiredDirectiveNodeHandlerSkip)return DirectiveNodeHandlerSkip;hasRequiredDirectiveNodeHandlerSkip=1,Object.defineProperty(DirectiveNodeHandlerSkip,"__esModule",{value:!0}),DirectiveNodeHandlerSkip.DirectiveNodeHandlerSkip=void 0;const n=requireDirectiveNodeHandlerAdapter();let t=class extends n.DirectiveNodeHandlerAdapter{constructor(a,o){super("skip",a,o)}handle(a,o){const u=this.getDirectiveConditionalValue(a.directive,o);return u.termType==="Literal"&&u.value==="true"?{ignore:!0}:{}}};return DirectiveNodeHandlerSkip.DirectiveNodeHandlerSkip=t,DirectiveNodeHandlerSkip}var hasRequiredDirectivenode;function requireDirectivenode(){return hasRequiredDirectivenode||(hasRequiredDirectivenode=1,function(n){var t=directivenode&&directivenode.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=directivenode&&directivenode.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireDirectiveNodeHandlerAdapter(),n),r(requireDirectiveNodeHandlerInclude(),n),r(requireDirectiveNodeHandlerOptional(),n),r(requireDirectiveNodeHandlerPlural(),n),r(requireDirectiveNodeHandlerSingle(),n),r(requireDirectiveNodeHandlerSkip(),n)}(directivenode)),directivenode}var valuenode={},NodeValueHandlerAdapter={},hasRequiredNodeValueHandlerAdapter;function requireNodeValueHandlerAdapter(){if(hasRequiredNodeValueHandlerAdapter)return NodeValueHandlerAdapter;hasRequiredNodeValueHandlerAdapter=1,Object.defineProperty(NodeValueHandlerAdapter,"__esModule",{value:!0}),NodeValueHandlerAdapter.NodeValueHandlerAdapter=void 0;let n=class{constructor(r,a,o){this.targetKind=r,this.util=a,this.settings=o}};return NodeValueHandlerAdapter.NodeValueHandlerAdapter=n,NodeValueHandlerAdapter}var NodeValueHandlerBoolean={},hasRequiredNodeValueHandlerBoolean;function requireNodeValueHandlerBoolean(){if(hasRequiredNodeValueHandlerBoolean)return NodeValueHandlerBoolean;hasRequiredNodeValueHandlerBoolean=1,Object.defineProperty(NodeValueHandlerBoolean,"__esModule",{value:!0}),NodeValueHandlerBoolean.NodeValueHandlerBoolean=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("BooleanValue",a,o),this.datatype=this.util.dataFactory.namedNode("http://www.w3.org/2001/XMLSchema#boolean")}handle(a,o,u){return{terms:[this.util.dataFactory.literal(a.value?"true":"false",this.datatype)]}}};return NodeValueHandlerBoolean.NodeValueHandlerBoolean=t,NodeValueHandlerBoolean}var NodeValueHandlerEnum={},hasRequiredNodeValueHandlerEnum;function requireNodeValueHandlerEnum(){if(hasRequiredNodeValueHandlerEnum)return NodeValueHandlerEnum;hasRequiredNodeValueHandlerEnum=1,Object.defineProperty(NodeValueHandlerEnum,"__esModule",{value:!0}),NodeValueHandlerEnum.NodeValueHandlerEnum=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("EnumValue",a,o)}handle(a,o,u){return{terms:[this.util.valueToNamedNode(a.value,u.context)]}}};return NodeValueHandlerEnum.NodeValueHandlerEnum=t,NodeValueHandlerEnum}var NodeValueHandlerFloat={},hasRequiredNodeValueHandlerFloat;function requireNodeValueHandlerFloat(){if(hasRequiredNodeValueHandlerFloat)return NodeValueHandlerFloat;hasRequiredNodeValueHandlerFloat=1,Object.defineProperty(NodeValueHandlerFloat,"__esModule",{value:!0}),NodeValueHandlerFloat.NodeValueHandlerFloat=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("FloatValue",a,o),this.datatype=this.util.dataFactory.namedNode("http://www.w3.org/2001/XMLSchema#float")}handle(a,o,u){return{terms:[this.util.dataFactory.literal(a.value,this.datatype)]}}};return NodeValueHandlerFloat.NodeValueHandlerFloat=t,NodeValueHandlerFloat}var NodeValueHandlerInt={},hasRequiredNodeValueHandlerInt;function requireNodeValueHandlerInt(){if(hasRequiredNodeValueHandlerInt)return NodeValueHandlerInt;hasRequiredNodeValueHandlerInt=1,Object.defineProperty(NodeValueHandlerInt,"__esModule",{value:!0}),NodeValueHandlerInt.NodeValueHandlerInt=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("IntValue",a,o),this.datatype=this.util.dataFactory.namedNode("http://www.w3.org/2001/XMLSchema#integer")}handle(a,o,u){return{terms:[this.util.dataFactory.literal(a.value,this.datatype)]}}};return NodeValueHandlerInt.NodeValueHandlerInt=t,NodeValueHandlerInt}var NodeValueHandlerList={},hasRequiredNodeValueHandlerList;function requireNodeValueHandlerList(){if(hasRequiredNodeValueHandlerList)return NodeValueHandlerList;hasRequiredNodeValueHandlerList=1,Object.defineProperty(NodeValueHandlerList,"__esModule",{value:!0}),NodeValueHandlerList.NodeValueHandlerList=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("ListValue",a,o),this.nodeFirst=this.util.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"),this.nodeRest=this.util.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"),this.nodeNil=this.util.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil")}handle(a,o,u){const s=[];let c=[];for(const l of a.values){const d=this.util.handleNodeValue(l,o,u);for(const f of d.terms)s.push(f);d.auxiliaryPatterns&&(c=c.concat(d.auxiliaryPatterns))}if(this.settings.arraysToRdfLists){const l=this.util.dataFactory.blankNode();let d=l,f=s.length;for(const h of s){c.push(this.util.operationFactory.createPattern(d,this.nodeFirst,h,u.graph));const v=--f===0?this.nodeNil:this.util.dataFactory.blankNode();c.push(this.util.operationFactory.createPattern(d,this.nodeRest,v,u.graph)),d=v}return{terms:[l],auxiliaryPatterns:c}}else return{terms:s,auxiliaryPatterns:c}}};return NodeValueHandlerList.NodeValueHandlerList=t,NodeValueHandlerList}var NodeValueHandlerNull={},hasRequiredNodeValueHandlerNull;function requireNodeValueHandlerNull(){if(hasRequiredNodeValueHandlerNull)return NodeValueHandlerNull;hasRequiredNodeValueHandlerNull=1,Object.defineProperty(NodeValueHandlerNull,"__esModule",{value:!0}),NodeValueHandlerNull.NodeValueHandlerNull=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("NullValue",a,o),this.nil=this.util.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil")}handle(a,o,u){return{terms:[this.nil]}}};return NodeValueHandlerNull.NodeValueHandlerNull=t,NodeValueHandlerNull}var NodeValueHandlerObject={},hasRequiredNodeValueHandlerObject;function requireNodeValueHandlerObject(){if(hasRequiredNodeValueHandlerObject)return NodeValueHandlerObject;hasRequiredNodeValueHandlerObject=1,Object.defineProperty(NodeValueHandlerObject,"__esModule",{value:!0}),NodeValueHandlerObject.NodeValueHandlerObject=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("ObjectValue",a,o)}handle(a,o,u){const s=this.util.dataFactory.blankNode();let c=[];for(const l of a.fields){const d=this.util.handleNodeValue(l.value,o,u);for(const f of d.terms)c.push(this.util.createQuadPattern(s,l.name,f,u.graph,u.context));d.auxiliaryPatterns&&(c=c.concat(d.auxiliaryPatterns))}return{terms:[s],auxiliaryPatterns:c}}};return NodeValueHandlerObject.NodeValueHandlerObject=t,NodeValueHandlerObject}var NodeValueHandlerString={},hasRequiredNodeValueHandlerString;function requireNodeValueHandlerString(){if(hasRequiredNodeValueHandlerString)return NodeValueHandlerString;hasRequiredNodeValueHandlerString=1,Object.defineProperty(NodeValueHandlerString,"__esModule",{value:!0}),NodeValueHandlerString.NodeValueHandlerString=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("StringValue",a,o)}handle(a,o,u){const s=u.context.getContextRaw()[o];let c,l;return s&&typeof s!="string"&&(s["@language"]?c=s["@language"]:s["@type"]&&(l=this.util.dataFactory.namedNode(s["@type"]))),{terms:[this.util.dataFactory.literal(a.value,c||l)]}}};return NodeValueHandlerString.NodeValueHandlerString=t,NodeValueHandlerString}var NodeValueHandlerVariable={},hasRequiredNodeValueHandlerVariable;function requireNodeValueHandlerVariable(){if(hasRequiredNodeValueHandlerVariable)return NodeValueHandlerVariable;hasRequiredNodeValueHandlerVariable=1,Object.defineProperty(NodeValueHandlerVariable,"__esModule",{value:!0}),NodeValueHandlerVariable.NodeValueHandlerVariable=void 0;const n=requireNodeValueHandlerAdapter();let t=class extends n.NodeValueHandlerAdapter{constructor(a,o){super("Variable",a,o)}handle(a,o,u){const s=a.name.value,c=u.variablesDict[s],l=u.variablesMetaDict[s];if(!c){if(!u.ignoreUnknownVariables&&(!l||l.mandatory))throw new Error(`Undefined variable: ${s}`);{const d=this.util.dataFactory.variable(s);return u.terminalVariables.map(f=>f.value).indexOf(s)<0&&u.terminalVariables.push(d),{terms:[d]}}}if(c.kind==="Variable")throw new Error(`Variable refers to another variable: ${s}`);if(l)if(l.list){if(c.kind!=="ListValue")throw new Error(`Expected a list, but got ${c.kind} for ${s}`);if(l.type){const d=c;for(const f of d.values)if(f.kind!==l.type)throw new Error(`Expected ${l.type}, but got ${f.kind} for ${s}`)}}else l.type;return this.util.handleNodeValue(c,o,u)}};return NodeValueHandlerVariable.NodeValueHandlerVariable=t,NodeValueHandlerVariable}var hasRequiredValuenode;function requireValuenode(){return hasRequiredValuenode||(hasRequiredValuenode=1,function(n){var t=valuenode&&valuenode.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=valuenode&&valuenode.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireNodeValueHandlerAdapter(),n),r(requireNodeValueHandlerBoolean(),n),r(requireNodeValueHandlerEnum(),n),r(requireNodeValueHandlerFloat(),n),r(requireNodeValueHandlerInt(),n),r(requireNodeValueHandlerList(),n),r(requireNodeValueHandlerNull(),n),r(requireNodeValueHandlerObject(),n),r(requireNodeValueHandlerString(),n),r(requireNodeValueHandlerVariable(),n)}(valuenode)),valuenode}var NodeHandlerAdapter={},hasRequiredNodeHandlerAdapter;function requireNodeHandlerAdapter(){if(hasRequiredNodeHandlerAdapter)return NodeHandlerAdapter;hasRequiredNodeHandlerAdapter=1,Object.defineProperty(NodeHandlerAdapter,"__esModule",{value:!0}),NodeHandlerAdapter.NodeHandlerAdapter=void 0;let n=class{constructor(r,a,o){this.targetKind=r,this.util=a,this.settings=o}getNodeQuadContextSelectionSet(r,a,o){const u={};if(r){for(const s of r.selections)if(s.kind==="Field"){const c=s;this.handleNodeQuadContextField(c,o,u,"id","subject"),this.handleNodeQuadContextField(c,o,u,"graph","graph")}}return u}handleNodeQuadContextField(r,a,o,u,s){if(!o[s]&&r.name.value===u){if(!o[s]){const c=this.util.getArgument(r.arguments,"_");if(c){const l=this.util.handleNodeValue(c.value,r.name.value,a);if(l.terms.length!==1)throw new Error(`Only single values can be set as ${u}, but got ${l.terms.length} at ${r.name.value}`);o[s]=l.terms[0],l.auxiliaryPatterns&&(o.auxiliaryPatterns||(o.auxiliaryPatterns=[]),o.auxiliaryPatterns.concat(l.auxiliaryPatterns))}}if(!o[s]){const c=this.util.nameToVariable(this.util.getFieldLabel(r),a);a.terminalVariables.push(c),o[s]=c}}}getDirectiveOutputs(r,a,o){const u=[];if(r)for(const s of r){const c=this.util.handleDirectiveNode({directive:s,fieldLabel:a},o);if(c){if(c.ignore)return null;u.push(c)}}return u}handleDirectiveOutputs(r,a){for(const o of r){if(o.ignore)return this.util.operationFactory.createBgp([]);o.operationOverrider&&(a=o.operationOverrider(a))}return a}};return NodeHandlerAdapter.NodeHandlerAdapter=n,NodeHandlerAdapter}var NodeHandlerDefinitionAdapter={},hasRequiredNodeHandlerDefinitionAdapter;function requireNodeHandlerDefinitionAdapter(){if(hasRequiredNodeHandlerDefinitionAdapter)return NodeHandlerDefinitionAdapter;hasRequiredNodeHandlerDefinitionAdapter=1,Object.defineProperty(NodeHandlerDefinitionAdapter,"__esModule",{value:!0}),NodeHandlerDefinitionAdapter.NodeHandlerDefinitionAdapter=void 0;const n=requireNodeHandlerAdapter();let t=class extends n.NodeHandlerAdapter{constructor(a,o,u){super(a,o,u)}};return NodeHandlerDefinitionAdapter.NodeHandlerDefinitionAdapter=t,NodeHandlerDefinitionAdapter}var NodeHandlerDefinitionFragment={},hasRequiredNodeHandlerDefinitionFragment;function requireNodeHandlerDefinitionFragment(){if(hasRequiredNodeHandlerDefinitionFragment)return NodeHandlerDefinitionFragment;hasRequiredNodeHandlerDefinitionFragment=1,Object.defineProperty(NodeHandlerDefinitionFragment,"__esModule",{value:!0}),NodeHandlerDefinitionFragment.NodeHandlerDefinitionFragment=void 0;const n=requireNodeHandlerDefinitionAdapter();let t=class extends n.NodeHandlerDefinitionAdapter{constructor(a,o){super("FragmentDefinition",a,o)}handle(a,o){throw new Error("Illegal state: fragment definitions must be indexed and removed before processing")}};return NodeHandlerDefinitionFragment.NodeHandlerDefinitionFragment=t,NodeHandlerDefinitionFragment}var NodeHandlerDefinitionOperation={},hasRequiredNodeHandlerDefinitionOperation;function requireNodeHandlerDefinitionOperation(){if(hasRequiredNodeHandlerDefinitionOperation)return NodeHandlerDefinitionOperation;hasRequiredNodeHandlerDefinitionOperation=1,Object.defineProperty(NodeHandlerDefinitionOperation,"__esModule",{value:!0}),NodeHandlerDefinitionOperation.NodeHandlerDefinitionOperation=void 0;const n=requireNodeHandlerDefinitionAdapter();let t=class extends n.NodeHandlerDefinitionAdapter{constructor(a,o){super("OperationDefinition",a,o)}handle(a,o){if(a.operation!=="query")throw new Error("Unsupported definition operation: "+a.operation);if(a.variableDefinitions)for(const c of a.variableDefinitions){const l=c.variable.name.value;c.defaultValue&&(o.variablesDict[l]||(o.variablesDict[l]=c.defaultValue));let d=c.type;const f=d.kind==="NonNullType";f&&(d=d.type);const h=d.kind==="ListType";h&&(d=d.type);const v=d.name.value;o.variablesMetaDict[l]={mandatory:f,list:h,type:v}}const u=this.getDirectiveOutputs(a.directives,a.name?a.name.value:"",o);if(!u)return this.util.operationFactory.createBgp([]);const s=this.util.joinOperations(a.selectionSet.selections.map(c=>this.util.handleNode(c,o)));return this.handleDirectiveOutputs(u,s)}};return NodeHandlerDefinitionOperation.NodeHandlerDefinitionOperation=t,NodeHandlerDefinitionOperation}var NodeHandlerDocument={},hasRequiredNodeHandlerDocument;function requireNodeHandlerDocument(){if(hasRequiredNodeHandlerDocument)return NodeHandlerDocument;hasRequiredNodeHandlerDocument=1,Object.defineProperty(NodeHandlerDocument,"__esModule",{value:!0}),NodeHandlerDocument.NodeHandlerDocument=void 0;const n=requireSparqlalgebrajs(),t=requireNodeHandlerAdapter();let r=class extends t.NodeHandlerAdapter{constructor(o,u){super("Document",o,u)}handle(o,u){const s=o.definitions.map(l=>{const d=this.getNodeQuadContextDefinitionNode(l,Object.assign(Object.assign({},u),{ignoreUnknownVariables:!0})),f=Object.assign(Object.assign({},u),{graph:d.graph||u.graph,subject:d.subject||this.util.dataFactory.blankNode()});let h=this.util.handleNode(l,f);return d&&d.auxiliaryPatterns&&(h=this.util.joinOperations([h,this.util.operationFactory.createBgp(d.auxiliaryPatterns)])),h}),c=this.util.operationFactory.createProject(s.length===1?s[0]:this.util.operationFactory.createUnion(s),u.terminalVariables);return this.translateBlankNodesToVariables(c)}getNodeQuadContextDefinitionNode(o,u){if(o.kind==="OperationDefinition")return this.getNodeQuadContextSelectionSet(o.selectionSet,o.name?o.name.value:"",u);throw new Error(`Unsupported definition: ${o.kind}`)}translateBlankNodesToVariables(o){const u=this,s={},c=Array.from(o.variables).reduce((d,f)=>(d[f.value]=!0,d),{});return n.Util.mapOperation(o,{path:(d,f)=>({recurse:!1,result:f.createPath(l(d.subject),d.predicate,l(d.object),l(d.graph))}),pattern:(d,f)=>({recurse:!1,result:f.createPattern(l(d.subject),l(d.predicate),l(d.object),l(d.graph))})});function l(d){if(d.termType==="BlankNode"){let f=s[d.value];return f||(f=n.Util.createUniqueVariable(d.value,c,u.util.dataFactory),c[f.value]=!0,s[d.value]=f),f}return d}}};return NodeHandlerDocument.NodeHandlerDocument=r,NodeHandlerDocument}var NodeHandlerSelectionAdapter={},hasRequiredNodeHandlerSelectionAdapter;function requireNodeHandlerSelectionAdapter(){if(hasRequiredNodeHandlerSelectionAdapter)return NodeHandlerSelectionAdapter;hasRequiredNodeHandlerSelectionAdapter=1,Object.defineProperty(NodeHandlerSelectionAdapter,"__esModule",{value:!0}),NodeHandlerSelectionAdapter.NodeHandlerSelectionAdapter=void 0;const n=requireSparqlalgebrajs(),t=requireIConvertContext(),r=requireNodeHandlerAdapter();let a=class extends r.NodeHandlerAdapter{constructor(u,s,c){super(u,s,c)}getNodeQuadContextFieldNode(u,s,c){return this.getNodeQuadContextSelectionSet(u.selectionSet,s,Object.assign(Object.assign({},c),{path:this.util.appendFieldToPath(c.path,s)}))}fieldToOperation(u,s,c,l){const d=c;let f=0,h;if((s.name.value==="id"||s.name.value==="graph")&&(c=!1,s.arguments))for(const E of s.arguments)E.name.value==="_"&&this.util.handleNodeValue(E.value,s.name.value,u);const v=this.util.getFieldLabel(s);if(u.singularizeState===t.SingularizeState.SINGLE&&(u.singularizeVariables[this.util.nameToVariable(v,u).value]=!0),c){const E=this.handleMetaField(u,v,l);if(E)return E}const g=l?[this.util.operationFactory.createBgp(l)]:[],b=this.getNodeQuadContextFieldNode(s,v,u);let _=b.subject||this.util.nameToVariable(v,u),S=b.graph||u.graph;b.auxiliaryPatterns&&g.push(this.util.operationFactory.createBgp(b.auxiliaryPatterns));let T=!0,w=null;if(c&&s.arguments&&s.arguments.length){for(const E of s.arguments)if(E.name.value==="_"){const I=this.util.handleNodeValue(E.value,s.name.value,u);w=I.terms,g.push(this.util.operationFactory.createBgp(I.terms.map(L=>this.util.createQuadPattern(u.subject,s.name,L,u.graph,u.context)))),I.auxiliaryPatterns&&g.push(this.util.operationFactory.createBgp(I.auxiliaryPatterns)),c=!1;break}else if(E.name.value==="graph"){const I=this.util.handleNodeValue(E.value,s.name.value,u);if(I.terms.length!==1)throw new Error(`Only single values can be set as graph, but got ${I.terms.length} at ${s.name.value}`);S=I.terms[0],u=Object.assign(Object.assign({},u),{graph:S}),I.auxiliaryPatterns&&g.push(this.util.operationFactory.createBgp(I.auxiliaryPatterns));break}else if(E.name.value==="alt"){let I=E.value;I.kind!=="ListValue"&&(I={kind:"ListValue",values:[I]}),g.push(this.util.createQuadPath(u.subject,s.name,I,_,u.graph,u.context)),T=!1;break}}if(c&&T&&g.push(this.util.operationFactory.createBgp([this.util.createQuadPattern(u.subject,s.name,_,u.graph,u.context)])),s.arguments&&s.arguments.length){for(const E of s.arguments)if(!(E.name.value==="_"||E.name.value==="graph"||E.name.value==="alt"))if(E.name.value==="first"){if(E.value.kind!=="IntValue")throw new Error("Invalid value type for 'first' argument: "+E.value.kind);h=parseInt(E.value.value,10)}else if(E.name.value==="offset"){if(E.value.kind!=="IntValue")throw new Error("Invalid value type for 'offset' argument: "+E.value.kind);f=parseInt(E.value.value,10)}else{const I=this.util.handleNodeValue(E.value,E.name.value,u);g.push(this.util.operationFactory.createBgp(I.terms.map(L=>this.util.createQuadPattern(_,E.name,L,u.graph,u.context)))),I.auxiliaryPatterns&&g.push(this.util.operationFactory.createBgp(I.auxiliaryPatterns))}}const A=this.getDirectiveOutputs(s.directives,v,u);if(!A)return this.util.operationFactory.createBgp([]);let R=this.util.joinOperations(g);if(s.selectionSet&&s.selectionSet.selections.length){if(w){if(w.length!==1)throw new Error(`Only single values can be set as id, but got ${w.length} at ${s.name.value}`);_=w[0]}const E=Object.assign(Object.assign(Object.assign({},u),d?{path:this.util.appendFieldToPath(u.path,v)}:{}),{graph:S,subject:d?_:u.subject});let I=!1;const L=s.selectionSet.selections.filter(D=>D.kind==="Field"&&D.name.value==="totalCount"?(I=!0,!1):!0);let F=this.util.joinOperations(g.concat(L.map(D=>this.util.handleNode(D,E))));if(I){const D=this.util.dataFactory.variable("var"+this.settings.expressionVariableCounter++),$=this.util.dataFactory.variable(_.value+this.settings.variableDelimiter+"totalCount"),O=this.util.operationFactory.createBoundAggregate(D,"count",this.util.operationFactory.createTermExpression(_),!1),P=this.util.operationFactory.createProject(this.util.operationFactory.createExtend(this.util.operationFactory.createGroup(R,[],[O]),$,this.util.operationFactory.createTermExpression(D)),[$]);u.terminalVariables.push($),L.length?F=this.util.operationFactory.createJoin([this.util.operationFactory.createProject(F,[]),P]):F=P}R=F}else c&&_.termType==="Variable"&&u.terminalVariables.push(_);return(f||h)&&(R=this.util.operationFactory.createSlice(this.util.operationFactory.createProject(R,n.Util.inScopeVariables(R)),f,h)),this.handleDirectiveOutputs(A,R)}handleMetaField(u,s,c){if(s==="__typename"){const l=this.util.nameToVariable(s,u);return u.terminalVariables.push(l),this.util.operationFactory.createBgp([this.util.operationFactory.createPattern(u.subject,this.util.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.util.nameToVariable(s,u),u.graph)].concat(c||[]))}}};return NodeHandlerSelectionAdapter.NodeHandlerSelectionAdapter=a,NodeHandlerSelectionAdapter}var NodeHandlerSelectionField={},hasRequiredNodeHandlerSelectionField;function requireNodeHandlerSelectionField(){if(hasRequiredNodeHandlerSelectionField)return NodeHandlerSelectionField;hasRequiredNodeHandlerSelectionField=1,Object.defineProperty(NodeHandlerSelectionField,"__esModule",{value:!0}),NodeHandlerSelectionField.NodeHandlerSelectionField=void 0;const n=requireNodeHandlerSelectionAdapter();let t=class extends n.NodeHandlerSelectionAdapter{constructor(a,o){super("Field",a,o)}handle(a,o){return this.fieldToOperation(o,a,!0)}};return NodeHandlerSelectionField.NodeHandlerSelectionField=t,NodeHandlerSelectionField}var NodeHandlerSelectionFragmentSpread={},hasRequiredNodeHandlerSelectionFragmentSpread;function requireNodeHandlerSelectionFragmentSpread(){if(hasRequiredNodeHandlerSelectionFragmentSpread)return NodeHandlerSelectionFragmentSpread;hasRequiredNodeHandlerSelectionFragmentSpread=1,Object.defineProperty(NodeHandlerSelectionFragmentSpread,"__esModule",{value:!0}),NodeHandlerSelectionFragmentSpread.NodeHandlerSelectionFragmentSpread=void 0;const n=requireNodeHandlerSelectionAdapter();let t=class extends n.NodeHandlerSelectionAdapter{constructor(a,o){super("FragmentSpread",a,o)}handle(a,o){const u=o.fragmentDefinitions[a.name.value];if(!u)throw new Error("Undefined fragment definition: "+a.name.value);const s={alias:void 0,arguments:void 0,directives:u.directives,kind:"Field",name:a.name,selectionSet:u.selectionSet},c=[this.util.newTypePattern(o.subject,u.typeCondition,o)];return this.util.operationFactory.createLeftJoin(this.util.operationFactory.createBgp([]),this.fieldToOperation(o,s,!1,c))}};return NodeHandlerSelectionFragmentSpread.NodeHandlerSelectionFragmentSpread=t,NodeHandlerSelectionFragmentSpread}var NodeHandlerSelectionInlineFragment={},hasRequiredNodeHandlerSelectionInlineFragment;function requireNodeHandlerSelectionInlineFragment(){if(hasRequiredNodeHandlerSelectionInlineFragment)return NodeHandlerSelectionInlineFragment;hasRequiredNodeHandlerSelectionInlineFragment=1,Object.defineProperty(NodeHandlerSelectionInlineFragment,"__esModule",{value:!0}),NodeHandlerSelectionInlineFragment.NodeHandlerSelectionInlineFragment=void 0;const n=requireNodeHandlerSelectionAdapter();let t=class extends n.NodeHandlerSelectionAdapter{constructor(a,o){super("InlineFragment",a,o)}handle(a,o){const u={alias:void 0,arguments:void 0,directives:a.directives,kind:"Field",name:{kind:"Name",value:o.subject.value},selectionSet:a.selectionSet},s=a.typeCondition?[this.util.newTypePattern(o.subject,a.typeCondition,o)]:[];return this.util.operationFactory.createLeftJoin(this.util.operationFactory.createBgp([]),this.fieldToOperation(o,u,!1,s))}};return NodeHandlerSelectionInlineFragment.NodeHandlerSelectionInlineFragment=t,NodeHandlerSelectionInlineFragment}var hasRequiredHandler$1;function requireHandler$1(){return hasRequiredHandler$1||(hasRequiredHandler$1=1,function(n){var t=handler$1&&handler$1.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=handler$1&&handler$1.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireDirectivenode(),n),r(requireValuenode(),n),r(requireNodeHandlerAdapter(),n),r(requireNodeHandlerDefinitionAdapter(),n),r(requireNodeHandlerDefinitionFragment(),n),r(requireNodeHandlerDefinitionOperation(),n),r(requireNodeHandlerDocument(),n),r(requireNodeHandlerSelectionAdapter(),n),r(requireNodeHandlerSelectionField(),n),r(requireNodeHandlerSelectionFragmentSpread(),n),r(requireNodeHandlerSelectionInlineFragment(),n)}(handler$1)),handler$1}var Converter$1={},SYMBOL_TO_STRING_TAG=typeof Symbol=="function"&&Symbol.toStringTag!=null?Symbol.toStringTag:"@@toStringTag",nodejsCustomInspectSymbol=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):void 0;function _typeof$3(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$3=function(r){return typeof r}:_typeof$3=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof$3(n)}var MAX_ARRAY_LENGTH=10,MAX_RECURSIVE_DEPTH=2;function inspect$1(n){return formatValue(n,[])}function formatValue(n,t){switch(_typeof$3(n)){case"string":return JSON.stringify(n);case"function":return n.name?"[function ".concat(n.name,"]"):"[function]";case"object":return n===null?"null":formatObjectValue(n,t);default:return String(n)}}function formatObjectValue(n,t){if(t.indexOf(n)!==-1)return"[Circular]";var r=[].concat(t,[n]),a=getCustomFn(n);if(a!==void 0){var o=a.call(n);if(o!==n)return typeof o=="string"?o:formatValue(o,r)}else if(Array.isArray(n))return formatArray(n,r);return formatObject(n,r)}function formatObject(n,t){var r=Object.keys(n);if(r.length===0)return"{}";if(t.length>MAX_RECURSIVE_DEPTH)return"["+getObjectTag(n)+"]";var a=r.map(function(o){var u=formatValue(n[o],t);return o+": "+u});return"{ "+a.join(", ")+" }"}function formatArray(n,t){if(n.length===0)return"[]";if(t.length>MAX_RECURSIVE_DEPTH)return"[Array]";for(var r=Math.min(MAX_ARRAY_LENGTH,n.length),a=n.length-r,o=[],u=0;u<r;++u)o.push(formatValue(n[u],t));return a===1?o.push("... 1 more item"):a>1&&o.push("... ".concat(a," more items")),"["+o.join(", ")+"]"}function getCustomFn(n){var t=n[String(nodejsCustomInspectSymbol)];if(typeof t=="function")return t;if(typeof n.inspect=="function")return n.inspect}function getObjectTag(n){var t=Object.prototype.toString.call(n).replace(/^\[object /,"").replace(/]$/,"");if(t==="Object"&&typeof n.constructor=="function"){var r=n.constructor.name;if(typeof r=="string"&&r!=="")return r}return t}function devAssert(n,t){var r=!!n;if(!r)throw new Error(t)}const instanceOf=function(t,r){return t instanceof r};function _defineProperties$2(n,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}function _createClass$2(n,t,r){return t&&_defineProperties$2(n.prototype,t),n}var Source=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"GraphQL request",a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{line:1,column:1};typeof t=="string"||devAssert(0,"Body must be a string. Received: ".concat(inspect$1(t),".")),this.body=t,this.name=r,this.locationOffset=a,this.locationOffset.line>0||devAssert(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||devAssert(0,"column in locationOffset is 1-indexed and must be positive.")}return _createClass$2(n,[{key:SYMBOL_TO_STRING_TAG,get:function(){return"Source"}}]),n}();function isSource(n){return instanceOf(n,Source)}function getLocation(n,t){for(var r=/\r\n|[\n\r]/g,a=1,o=t+1,u;(u=r.exec(n.body))&&u.index<t;)a+=1,o=t+1-(u.index+u[0].length);return{line:a,column:o}}function printLocation(n){return printSourceLocation(n.source,getLocation(n.source,n.start))}function printSourceLocation(n,t){var r=n.locationOffset.column-1,a=whitespace(r)+n.body,o=t.line-1,u=n.locationOffset.line-1,s=t.line+u,c=t.line===1?r:0,l=t.column+c,d="".concat(n.name,":").concat(s,":").concat(l,`
`),f=a.split(/\r\n|[\n\r]/g),h=f[o];if(h.length>120){for(var v=Math.floor(l/80),g=l%80,b=[],_=0;_<h.length;_+=80)b.push(h.slice(_,_+80));return d+printPrefixedLines([["".concat(s),b[0]]].concat(b.slice(1,v+1).map(function(S){return["",S]}),[[" ",whitespace(g-1)+"^"],["",b[v+1]]]))}return d+printPrefixedLines([["".concat(s-1),f[o-1]],["".concat(s),h],["",whitespace(l-1)+"^"],["".concat(s+1),f[o+1]]])}function printPrefixedLines(n){var t=n.filter(function(a){a[0];var o=a[1];return o!==void 0}),r=Math.max.apply(Math,t.map(function(a){var o=a[0];return o.length}));return t.map(function(a){var o=a[0],u=a[1];return leftPad(r,o)+(u?" | "+u:" |")}).join(`
`)}function whitespace(n){return Array(n+1).join(" ")}function leftPad(n,t){return whitespace(n-t.length)+t}var Kind=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"}),TokenKind=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function _typeof$2(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$2=function(r){return typeof r}:_typeof$2=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof$2(n)}function isObjectLike$1(n){return _typeof$2(n)=="object"&&n!==null}function _typeof$1(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof$1=function(r){return typeof r}:_typeof$1=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof$1(n)}function ownKeys(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),r.push.apply(r,a)}return r}function _objectSpread(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(a){_defineProperty$2(n,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(r,a))})}return n}function _defineProperty$2(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _classCallCheck$1(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(n,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}function _createClass$1(n,t,r){return t&&_defineProperties$1(n.prototype,t),n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&_setPrototypeOf(n,t)}function _createSuper(n){var t=_isNativeReflectConstruct();return function(){var a=_getPrototypeOf(n),o;if(t){var u=_getPrototypeOf(this).constructor;o=Reflect.construct(a,arguments,u)}else o=a.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(n,t){return t&&(_typeof$1(t)==="object"||typeof t=="function")?t:_assertThisInitialized(n)}function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _wrapNativeSuper(n){var t=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(a){if(a===null||!_isNativeFunction(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,o)}function o(){return _construct(a,arguments,_getPrototypeOf(this).constructor)}return o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(o,a)},_wrapNativeSuper(n)}function _construct(n,t,r){return _isNativeReflectConstruct()?_construct=Reflect.construct:_construct=function(o,u,s){var c=[null];c.push.apply(c,u);var l=Function.bind.apply(o,c),d=new l;return s&&_setPrototypeOf(d,s.prototype),d},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function _isNativeFunction(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function _setPrototypeOf(n,t){return _setPrototypeOf=Object.setPrototypeOf||function(a,o){return a.__proto__=o,a},_setPrototypeOf(n,t)}function _getPrototypeOf(n){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},_getPrototypeOf(n)}var GraphQLError=function(n){_inherits(r,n);var t=_createSuper(r);function r(a,o,u,s,c,l,d){var f,h,v,g;_classCallCheck$1(this,r),g=t.call(this,a),g.name="GraphQLError",g.originalError=l??void 0,g.nodes=undefinedIfEmpty(Array.isArray(o)?o:o?[o]:void 0);for(var b=[],_=0,S=(T=g.nodes)!==null&&T!==void 0?T:[];_<S.length;_++){var T,w=S[_],A=w.loc;A!=null&&b.push(A)}b=undefinedIfEmpty(b),g.source=u??((f=b)===null||f===void 0?void 0:f[0].source),g.positions=s??((h=b)===null||h===void 0?void 0:h.map(function(E){return E.start})),g.locations=s&&u?s.map(function(E){return getLocation(u,E)}):(v=b)===null||v===void 0?void 0:v.map(function(E){return getLocation(E.source,E.start)}),g.path=c??void 0;var R=l==null?void 0:l.extensions;return d==null&&isObjectLike$1(R)?g.extensions=_objectSpread({},R):g.extensions=d??{},Object.defineProperties(_assertThisInitialized(g),{message:{enumerable:!0},locations:{enumerable:g.locations!=null},path:{enumerable:g.path!=null},extensions:{enumerable:g.extensions!=null&&Object.keys(g.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),l!=null&&l.stack?(Object.defineProperty(_assertThisInitialized(g),"stack",{value:l.stack,writable:!0,configurable:!0}),_possibleConstructorReturn(g)):(Error.captureStackTrace?Error.captureStackTrace(_assertThisInitialized(g),r):Object.defineProperty(_assertThisInitialized(g),"stack",{value:Error().stack,writable:!0,configurable:!0}),g)}return _createClass$1(r,[{key:"toString",value:function(){return printError(this)}},{key:"toJSON",value:function(){return formatError(this)}},{key:SYMBOL_TO_STRING_TAG,get:function(){return"Object"}}]),r}(_wrapNativeSuper(Error));function undefinedIfEmpty(n){return n===void 0||n.length===0?void 0:n}function printError(n){var t=n.message;if(n.nodes)for(var r=0,a=n.nodes;r<a.length;r++){var o=a[r];o.loc&&(t+=`

`+printLocation(o.loc))}else if(n.source&&n.locations)for(var u=0,s=n.locations;u<s.length;u++){var c=s[u];t+=`

`+printSourceLocation(n.source,c)}return t}function formatError(n){var t;n||devAssert(0,"Received null or undefined error.");var r=(t=n.message)!==null&&t!==void 0?t:"An unknown error occurred.",a=n.locations,o=n.path,u=n.extensions;return u&&Object.keys(u).length>0?{message:r,locations:a,path:o,extensions:u}:{message:r,locations:a,path:o}}function syntaxError(n,t,r){return new GraphQLError("Syntax Error: ".concat(r),void 0,n,[t])}function invariant(n,t){var r=!!n;if(!r)throw new Error("Unexpected invariant triggered.")}function defineInspect(n){var t=n.prototype.toJSON;typeof t=="function"||invariant(0),n.prototype.inspect=t,nodejsCustomInspectSymbol&&(n.prototype[nodejsCustomInspectSymbol]=t)}var Location=function(){function n(r,a,o){this.start=r.start,this.end=a.end,this.startToken=r,this.endToken=a,this.source=o}var t=n.prototype;return t.toJSON=function(){return{start:this.start,end:this.end}},n}();defineInspect(Location);var Token=function(){function n(r,a,o,u,s,c,l){this.kind=r,this.start=a,this.end=o,this.line=u,this.column=s,this.value=l,this.prev=c,this.next=null}var t=n.prototype;return t.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},n}();defineInspect(Token);function isNode(n){return n!=null&&typeof n.kind=="string"}function dedentBlockStringValue(n){var t=n.split(/\r\n|[\n\r]/g),r=getBlockStringIndentation(n);if(r!==0)for(var a=1;a<t.length;a++)t[a]=t[a].slice(r);for(var o=0;o<t.length&&isBlank(t[o]);)++o;for(var u=t.length;u>o&&isBlank(t[u-1]);)--u;return t.slice(o,u).join(`
`)}function isBlank(n){for(var t=0;t<n.length;++t)if(n[t]!==" "&&n[t]!=="	")return!1;return!0}function getBlockStringIndentation(n){for(var t,r=!0,a=!0,o=0,u=null,s=0;s<n.length;++s)switch(n.charCodeAt(s)){case 13:n.charCodeAt(s+1)===10&&++s;case 10:r=!1,a=!0,o=0;break;case 9:case 32:++o;break;default:a&&!r&&(u===null||o<u)&&(u=o),a=!1}return(t=u)!==null&&t!==void 0?t:0}function printBlockString(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=n.indexOf(`
`)===-1,o=n[0]===" "||n[0]==="	",u=n[n.length-1]==='"',s=n[n.length-1]==="\\",c=!a||u||s||r,l="";return c&&!(a&&o)&&(l+=`
`+t),l+=t?n.replace(/\n/g,`
`+t):n,c&&(l+=`
`),'"""'+l.replace(/"""/g,'\\"""')+'"""'}var Lexer=function(){function n(r){var a=new Token(TokenKind.SOF,0,0,0,0,null);this.source=r,this.lastToken=a,this.token=a,this.line=1,this.lineStart=0}var t=n.prototype;return t.advance=function(){this.lastToken=this.token;var a=this.token=this.lookahead();return a},t.lookahead=function(){var a=this.token;if(a.kind!==TokenKind.EOF)do{var o;a=(o=a.next)!==null&&o!==void 0?o:a.next=readToken(this,a)}while(a.kind===TokenKind.COMMENT);return a},n}();function isPunctuatorTokenKind(n){return n===TokenKind.BANG||n===TokenKind.DOLLAR||n===TokenKind.AMP||n===TokenKind.PAREN_L||n===TokenKind.PAREN_R||n===TokenKind.SPREAD||n===TokenKind.COLON||n===TokenKind.EQUALS||n===TokenKind.AT||n===TokenKind.BRACKET_L||n===TokenKind.BRACKET_R||n===TokenKind.BRACE_L||n===TokenKind.PIPE||n===TokenKind.BRACE_R}function printCharCode(n){return isNaN(n)?TokenKind.EOF:n<127?JSON.stringify(String.fromCharCode(n)):'"\\u'.concat(("00"+n.toString(16).toUpperCase()).slice(-4),'"')}function readToken(n,t){for(var r=n.source,a=r.body,o=a.length,u=t.end;u<o;){var s=a.charCodeAt(u),c=n.line,l=1+u-n.lineStart;switch(s){case 65279:case 9:case 32:case 44:++u;continue;case 10:++u,++n.line,n.lineStart=u;continue;case 13:a.charCodeAt(u+1)===10?u+=2:++u,++n.line,n.lineStart=u;continue;case 33:return new Token(TokenKind.BANG,u,u+1,c,l,t);case 35:return readComment(r,u,c,l,t);case 36:return new Token(TokenKind.DOLLAR,u,u+1,c,l,t);case 38:return new Token(TokenKind.AMP,u,u+1,c,l,t);case 40:return new Token(TokenKind.PAREN_L,u,u+1,c,l,t);case 41:return new Token(TokenKind.PAREN_R,u,u+1,c,l,t);case 46:if(a.charCodeAt(u+1)===46&&a.charCodeAt(u+2)===46)return new Token(TokenKind.SPREAD,u,u+3,c,l,t);break;case 58:return new Token(TokenKind.COLON,u,u+1,c,l,t);case 61:return new Token(TokenKind.EQUALS,u,u+1,c,l,t);case 64:return new Token(TokenKind.AT,u,u+1,c,l,t);case 91:return new Token(TokenKind.BRACKET_L,u,u+1,c,l,t);case 93:return new Token(TokenKind.BRACKET_R,u,u+1,c,l,t);case 123:return new Token(TokenKind.BRACE_L,u,u+1,c,l,t);case 124:return new Token(TokenKind.PIPE,u,u+1,c,l,t);case 125:return new Token(TokenKind.BRACE_R,u,u+1,c,l,t);case 34:return a.charCodeAt(u+1)===34&&a.charCodeAt(u+2)===34?readBlockString(r,u,c,l,t,n):readString(r,u,c,l,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return readNumber(r,u,s,c,l,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return readName(r,u,c,l,t)}throw syntaxError(r,u,unexpectedCharacterMessage(s))}var d=n.line,f=1+u-n.lineStart;return new Token(TokenKind.EOF,o,o,d,f,t)}function unexpectedCharacterMessage(n){return n<32&&n!==9&&n!==10&&n!==13?"Cannot contain the invalid character ".concat(printCharCode(n),"."):n===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:"Cannot parse the unexpected character ".concat(printCharCode(n),".")}function readComment(n,t,r,a,o){var u=n.body,s,c=t;do s=u.charCodeAt(++c);while(!isNaN(s)&&(s>31||s===9));return new Token(TokenKind.COMMENT,t,c,r,a,o,u.slice(t+1,c))}function readNumber(n,t,r,a,o,u){var s=n.body,c=r,l=t,d=!1;if(c===45&&(c=s.charCodeAt(++l)),c===48){if(c=s.charCodeAt(++l),c>=48&&c<=57)throw syntaxError(n,l,"Invalid number, unexpected digit after 0: ".concat(printCharCode(c),"."))}else l=readDigits(n,l,c),c=s.charCodeAt(l);if(c===46&&(d=!0,c=s.charCodeAt(++l),l=readDigits(n,l,c),c=s.charCodeAt(l)),(c===69||c===101)&&(d=!0,c=s.charCodeAt(++l),(c===43||c===45)&&(c=s.charCodeAt(++l)),l=readDigits(n,l,c),c=s.charCodeAt(l)),c===46||isNameStart(c))throw syntaxError(n,l,"Invalid number, expected digit but got: ".concat(printCharCode(c),"."));return new Token(d?TokenKind.FLOAT:TokenKind.INT,t,l,a,o,u,s.slice(t,l))}function readDigits(n,t,r){var a=n.body,o=t,u=r;if(u>=48&&u<=57){do u=a.charCodeAt(++o);while(u>=48&&u<=57);return o}throw syntaxError(n,o,"Invalid number, expected digit but got: ".concat(printCharCode(u),"."))}function readString(n,t,r,a,o){for(var u=n.body,s=t+1,c=s,l=0,d="";s<u.length&&!isNaN(l=u.charCodeAt(s))&&l!==10&&l!==13;){if(l===34)return d+=u.slice(c,s),new Token(TokenKind.STRING,t,s+1,r,a,o,d);if(l<32&&l!==9)throw syntaxError(n,s,"Invalid character within String: ".concat(printCharCode(l),"."));if(++s,l===92){switch(d+=u.slice(c,s-1),l=u.charCodeAt(s),l){case 34:d+='"';break;case 47:d+="/";break;case 92:d+="\\";break;case 98:d+="\b";break;case 102:d+="\f";break;case 110:d+=`
`;break;case 114:d+="\r";break;case 116:d+="	";break;case 117:{var f=uniCharCode(u.charCodeAt(s+1),u.charCodeAt(s+2),u.charCodeAt(s+3),u.charCodeAt(s+4));if(f<0){var h=u.slice(s+1,s+5);throw syntaxError(n,s,"Invalid character escape sequence: \\u".concat(h,"."))}d+=String.fromCharCode(f),s+=4;break}default:throw syntaxError(n,s,"Invalid character escape sequence: \\".concat(String.fromCharCode(l),"."))}++s,c=s}}throw syntaxError(n,s,"Unterminated string.")}function readBlockString(n,t,r,a,o,u){for(var s=n.body,c=t+3,l=c,d=0,f="";c<s.length&&!isNaN(d=s.charCodeAt(c));){if(d===34&&s.charCodeAt(c+1)===34&&s.charCodeAt(c+2)===34)return f+=s.slice(l,c),new Token(TokenKind.BLOCK_STRING,t,c+3,r,a,o,dedentBlockStringValue(f));if(d<32&&d!==9&&d!==10&&d!==13)throw syntaxError(n,c,"Invalid character within String: ".concat(printCharCode(d),"."));d===10?(++c,++u.line,u.lineStart=c):d===13?(s.charCodeAt(c+1)===10?c+=2:++c,++u.line,u.lineStart=c):d===92&&s.charCodeAt(c+1)===34&&s.charCodeAt(c+2)===34&&s.charCodeAt(c+3)===34?(f+=s.slice(l,c)+'"""',c+=4,l=c):++c}throw syntaxError(n,c,"Unterminated string.")}function uniCharCode(n,t,r,a){return char2hex(n)<<12|char2hex(t)<<8|char2hex(r)<<4|char2hex(a)}function char2hex(n){return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:-1}function readName(n,t,r,a,o){for(var u=n.body,s=u.length,c=t+1,l=0;c!==s&&!isNaN(l=u.charCodeAt(c))&&(l===95||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122);)++c;return new Token(TokenKind.NAME,t,c,r,a,o,u.slice(t,c))}function isNameStart(n){return n===95||n>=65&&n<=90||n>=97&&n<=122}var DirectiveLocation=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function parse$3(n,t){var r=new Parser$4(n,t);return r.parseDocument()}function parseValue(n,t){var r=new Parser$4(n,t);r.expectToken(TokenKind.SOF);var a=r.parseValueLiteral(!1);return r.expectToken(TokenKind.EOF),a}function parseType(n,t){var r=new Parser$4(n,t);r.expectToken(TokenKind.SOF);var a=r.parseTypeReference();return r.expectToken(TokenKind.EOF),a}var Parser$4=function(){function n(r,a){var o=isSource(r)?r:new Source(r);this._lexer=new Lexer(o),this._options=a}var t=n.prototype;return t.parseName=function(){var a=this.expectToken(TokenKind.NAME);return{kind:Kind.NAME,value:a.value,loc:this.loc(a)}},t.parseDocument=function(){var a=this._lexer.token;return{kind:Kind.DOCUMENT,definitions:this.many(TokenKind.SOF,this.parseDefinition,TokenKind.EOF),loc:this.loc(a)}},t.parseDefinition=function(){if(this.peek(TokenKind.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(TokenKind.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var a=this._lexer.token;if(this.peek(TokenKind.BRACE_L))return{kind:Kind.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(a)};var o=this.parseOperationType(),u;return this.peek(TokenKind.NAME)&&(u=this.parseName()),{kind:Kind.OPERATION_DEFINITION,operation:o,name:u,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(a)}},t.parseOperationType=function(){var a=this.expectToken(TokenKind.NAME);switch(a.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(a)},t.parseVariableDefinitions=function(){return this.optionalMany(TokenKind.PAREN_L,this.parseVariableDefinition,TokenKind.PAREN_R)},t.parseVariableDefinition=function(){var a=this._lexer.token;return{kind:Kind.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(TokenKind.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(TokenKind.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(a)}},t.parseVariable=function(){var a=this._lexer.token;return this.expectToken(TokenKind.DOLLAR),{kind:Kind.VARIABLE,name:this.parseName(),loc:this.loc(a)}},t.parseSelectionSet=function(){var a=this._lexer.token;return{kind:Kind.SELECTION_SET,selections:this.many(TokenKind.BRACE_L,this.parseSelection,TokenKind.BRACE_R),loc:this.loc(a)}},t.parseSelection=function(){return this.peek(TokenKind.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var a=this._lexer.token,o=this.parseName(),u,s;return this.expectOptionalToken(TokenKind.COLON)?(u=o,s=this.parseName()):s=o,{kind:Kind.FIELD,alias:u,name:s,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(TokenKind.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(a)}},t.parseArguments=function(a){var o=a?this.parseConstArgument:this.parseArgument;return this.optionalMany(TokenKind.PAREN_L,o,TokenKind.PAREN_R)},t.parseArgument=function(){var a=this._lexer.token,o=this.parseName();return this.expectToken(TokenKind.COLON),{kind:Kind.ARGUMENT,name:o,value:this.parseValueLiteral(!1),loc:this.loc(a)}},t.parseConstArgument=function(){var a=this._lexer.token;return{kind:Kind.ARGUMENT,name:this.parseName(),value:(this.expectToken(TokenKind.COLON),this.parseValueLiteral(!0)),loc:this.loc(a)}},t.parseFragment=function(){var a=this._lexer.token;this.expectToken(TokenKind.SPREAD);var o=this.expectOptionalKeyword("on");return!o&&this.peek(TokenKind.NAME)?{kind:Kind.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(a)}:{kind:Kind.INLINE_FRAGMENT,typeCondition:o?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(a)}},t.parseFragmentDefinition=function(){var a,o=this._lexer.token;return this.expectKeyword("fragment"),((a=this._options)===null||a===void 0?void 0:a.experimentalFragmentVariables)===!0?{kind:Kind.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(o)}:{kind:Kind.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(o)}},t.parseFragmentName=function(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(a){var o=this._lexer.token;switch(o.kind){case TokenKind.BRACKET_L:return this.parseList(a);case TokenKind.BRACE_L:return this.parseObject(a);case TokenKind.INT:return this._lexer.advance(),{kind:Kind.INT,value:o.value,loc:this.loc(o)};case TokenKind.FLOAT:return this._lexer.advance(),{kind:Kind.FLOAT,value:o.value,loc:this.loc(o)};case TokenKind.STRING:case TokenKind.BLOCK_STRING:return this.parseStringLiteral();case TokenKind.NAME:switch(this._lexer.advance(),o.value){case"true":return{kind:Kind.BOOLEAN,value:!0,loc:this.loc(o)};case"false":return{kind:Kind.BOOLEAN,value:!1,loc:this.loc(o)};case"null":return{kind:Kind.NULL,loc:this.loc(o)};default:return{kind:Kind.ENUM,value:o.value,loc:this.loc(o)}}case TokenKind.DOLLAR:if(!a)return this.parseVariable();break}throw this.unexpected()},t.parseStringLiteral=function(){var a=this._lexer.token;return this._lexer.advance(),{kind:Kind.STRING,value:a.value,block:a.kind===TokenKind.BLOCK_STRING,loc:this.loc(a)}},t.parseList=function(a){var o=this,u=this._lexer.token,s=function(){return o.parseValueLiteral(a)};return{kind:Kind.LIST,values:this.any(TokenKind.BRACKET_L,s,TokenKind.BRACKET_R),loc:this.loc(u)}},t.parseObject=function(a){var o=this,u=this._lexer.token,s=function(){return o.parseObjectField(a)};return{kind:Kind.OBJECT,fields:this.any(TokenKind.BRACE_L,s,TokenKind.BRACE_R),loc:this.loc(u)}},t.parseObjectField=function(a){var o=this._lexer.token,u=this.parseName();return this.expectToken(TokenKind.COLON),{kind:Kind.OBJECT_FIELD,name:u,value:this.parseValueLiteral(a),loc:this.loc(o)}},t.parseDirectives=function(a){for(var o=[];this.peek(TokenKind.AT);)o.push(this.parseDirective(a));return o},t.parseDirective=function(a){var o=this._lexer.token;return this.expectToken(TokenKind.AT),{kind:Kind.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(a),loc:this.loc(o)}},t.parseTypeReference=function(){var a=this._lexer.token,o;return this.expectOptionalToken(TokenKind.BRACKET_L)?(o=this.parseTypeReference(),this.expectToken(TokenKind.BRACKET_R),o={kind:Kind.LIST_TYPE,type:o,loc:this.loc(a)}):o=this.parseNamedType(),this.expectOptionalToken(TokenKind.BANG)?{kind:Kind.NON_NULL_TYPE,type:o,loc:this.loc(a)}:o},t.parseNamedType=function(){var a=this._lexer.token;return{kind:Kind.NAMED_TYPE,name:this.parseName(),loc:this.loc(a)}},t.parseTypeSystemDefinition=function(){var a=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(a.kind===TokenKind.NAME)switch(a.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(a)},t.peekDescription=function(){return this.peek(TokenKind.STRING)||this.peek(TokenKind.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("schema");var u=this.parseDirectives(!0),s=this.many(TokenKind.BRACE_L,this.parseOperationTypeDefinition,TokenKind.BRACE_R);return{kind:Kind.SCHEMA_DEFINITION,description:o,directives:u,operationTypes:s,loc:this.loc(a)}},t.parseOperationTypeDefinition=function(){var a=this._lexer.token,o=this.parseOperationType();this.expectToken(TokenKind.COLON);var u=this.parseNamedType();return{kind:Kind.OPERATION_TYPE_DEFINITION,operation:o,type:u,loc:this.loc(a)}},t.parseScalarTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("scalar");var u=this.parseName(),s=this.parseDirectives(!0);return{kind:Kind.SCALAR_TYPE_DEFINITION,description:o,name:u,directives:s,loc:this.loc(a)}},t.parseObjectTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("type");var u=this.parseName(),s=this.parseImplementsInterfaces(),c=this.parseDirectives(!0),l=this.parseFieldsDefinition();return{kind:Kind.OBJECT_TYPE_DEFINITION,description:o,name:u,interfaces:s,directives:c,fields:l,loc:this.loc(a)}},t.parseImplementsInterfaces=function(){var a;if(!this.expectOptionalKeyword("implements"))return[];if(((a=this._options)===null||a===void 0?void 0:a.allowLegacySDLImplementsInterfaces)===!0){var o=[];this.expectOptionalToken(TokenKind.AMP);do o.push(this.parseNamedType());while(this.expectOptionalToken(TokenKind.AMP)||this.peek(TokenKind.NAME));return o}return this.delimitedMany(TokenKind.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var a;return((a=this._options)===null||a===void 0?void 0:a.allowLegacySDLEmptyFields)===!0&&this.peek(TokenKind.BRACE_L)&&this._lexer.lookahead().kind===TokenKind.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(TokenKind.BRACE_L,this.parseFieldDefinition,TokenKind.BRACE_R)},t.parseFieldDefinition=function(){var a=this._lexer.token,o=this.parseDescription(),u=this.parseName(),s=this.parseArgumentDefs();this.expectToken(TokenKind.COLON);var c=this.parseTypeReference(),l=this.parseDirectives(!0);return{kind:Kind.FIELD_DEFINITION,description:o,name:u,arguments:s,type:c,directives:l,loc:this.loc(a)}},t.parseArgumentDefs=function(){return this.optionalMany(TokenKind.PAREN_L,this.parseInputValueDef,TokenKind.PAREN_R)},t.parseInputValueDef=function(){var a=this._lexer.token,o=this.parseDescription(),u=this.parseName();this.expectToken(TokenKind.COLON);var s=this.parseTypeReference(),c;this.expectOptionalToken(TokenKind.EQUALS)&&(c=this.parseValueLiteral(!0));var l=this.parseDirectives(!0);return{kind:Kind.INPUT_VALUE_DEFINITION,description:o,name:u,type:s,defaultValue:c,directives:l,loc:this.loc(a)}},t.parseInterfaceTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("interface");var u=this.parseName(),s=this.parseImplementsInterfaces(),c=this.parseDirectives(!0),l=this.parseFieldsDefinition();return{kind:Kind.INTERFACE_TYPE_DEFINITION,description:o,name:u,interfaces:s,directives:c,fields:l,loc:this.loc(a)}},t.parseUnionTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("union");var u=this.parseName(),s=this.parseDirectives(!0),c=this.parseUnionMemberTypes();return{kind:Kind.UNION_TYPE_DEFINITION,description:o,name:u,directives:s,types:c,loc:this.loc(a)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(TokenKind.EQUALS)?this.delimitedMany(TokenKind.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("enum");var u=this.parseName(),s=this.parseDirectives(!0),c=this.parseEnumValuesDefinition();return{kind:Kind.ENUM_TYPE_DEFINITION,description:o,name:u,directives:s,values:c,loc:this.loc(a)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(TokenKind.BRACE_L,this.parseEnumValueDefinition,TokenKind.BRACE_R)},t.parseEnumValueDefinition=function(){var a=this._lexer.token,o=this.parseDescription(),u=this.parseName(),s=this.parseDirectives(!0);return{kind:Kind.ENUM_VALUE_DEFINITION,description:o,name:u,directives:s,loc:this.loc(a)}},t.parseInputObjectTypeDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("input");var u=this.parseName(),s=this.parseDirectives(!0),c=this.parseInputFieldsDefinition();return{kind:Kind.INPUT_OBJECT_TYPE_DEFINITION,description:o,name:u,directives:s,fields:c,loc:this.loc(a)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(TokenKind.BRACE_L,this.parseInputValueDef,TokenKind.BRACE_R)},t.parseTypeSystemExtension=function(){var a=this._lexer.lookahead();if(a.kind===TokenKind.NAME)switch(a.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(a)},t.parseSchemaExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var o=this.parseDirectives(!0),u=this.optionalMany(TokenKind.BRACE_L,this.parseOperationTypeDefinition,TokenKind.BRACE_R);if(o.length===0&&u.length===0)throw this.unexpected();return{kind:Kind.SCHEMA_EXTENSION,directives:o,operationTypes:u,loc:this.loc(a)}},t.parseScalarTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var o=this.parseName(),u=this.parseDirectives(!0);if(u.length===0)throw this.unexpected();return{kind:Kind.SCALAR_TYPE_EXTENSION,name:o,directives:u,loc:this.loc(a)}},t.parseObjectTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var o=this.parseName(),u=this.parseImplementsInterfaces(),s=this.parseDirectives(!0),c=this.parseFieldsDefinition();if(u.length===0&&s.length===0&&c.length===0)throw this.unexpected();return{kind:Kind.OBJECT_TYPE_EXTENSION,name:o,interfaces:u,directives:s,fields:c,loc:this.loc(a)}},t.parseInterfaceTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var o=this.parseName(),u=this.parseImplementsInterfaces(),s=this.parseDirectives(!0),c=this.parseFieldsDefinition();if(u.length===0&&s.length===0&&c.length===0)throw this.unexpected();return{kind:Kind.INTERFACE_TYPE_EXTENSION,name:o,interfaces:u,directives:s,fields:c,loc:this.loc(a)}},t.parseUnionTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var o=this.parseName(),u=this.parseDirectives(!0),s=this.parseUnionMemberTypes();if(u.length===0&&s.length===0)throw this.unexpected();return{kind:Kind.UNION_TYPE_EXTENSION,name:o,directives:u,types:s,loc:this.loc(a)}},t.parseEnumTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var o=this.parseName(),u=this.parseDirectives(!0),s=this.parseEnumValuesDefinition();if(u.length===0&&s.length===0)throw this.unexpected();return{kind:Kind.ENUM_TYPE_EXTENSION,name:o,directives:u,values:s,loc:this.loc(a)}},t.parseInputObjectTypeExtension=function(){var a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var o=this.parseName(),u=this.parseDirectives(!0),s=this.parseInputFieldsDefinition();if(u.length===0&&s.length===0)throw this.unexpected();return{kind:Kind.INPUT_OBJECT_TYPE_EXTENSION,name:o,directives:u,fields:s,loc:this.loc(a)}},t.parseDirectiveDefinition=function(){var a=this._lexer.token,o=this.parseDescription();this.expectKeyword("directive"),this.expectToken(TokenKind.AT);var u=this.parseName(),s=this.parseArgumentDefs(),c=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var l=this.parseDirectiveLocations();return{kind:Kind.DIRECTIVE_DEFINITION,description:o,name:u,arguments:s,repeatable:c,locations:l,loc:this.loc(a)}},t.parseDirectiveLocations=function(){return this.delimitedMany(TokenKind.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var a=this._lexer.token,o=this.parseName();if(DirectiveLocation[o.value]!==void 0)return o;throw this.unexpected(a)},t.loc=function(a){var o;if(((o=this._options)===null||o===void 0?void 0:o.noLocation)!==!0)return new Location(a,this._lexer.lastToken,this._lexer.source)},t.peek=function(a){return this._lexer.token.kind===a},t.expectToken=function(a){var o=this._lexer.token;if(o.kind===a)return this._lexer.advance(),o;throw syntaxError(this._lexer.source,o.start,"Expected ".concat(getTokenKindDesc(a),", found ").concat(getTokenDesc(o),"."))},t.expectOptionalToken=function(a){var o=this._lexer.token;if(o.kind===a)return this._lexer.advance(),o},t.expectKeyword=function(a){var o=this._lexer.token;if(o.kind===TokenKind.NAME&&o.value===a)this._lexer.advance();else throw syntaxError(this._lexer.source,o.start,'Expected "'.concat(a,'", found ').concat(getTokenDesc(o),"."))},t.expectOptionalKeyword=function(a){var o=this._lexer.token;return o.kind===TokenKind.NAME&&o.value===a?(this._lexer.advance(),!0):!1},t.unexpected=function(a){var o=a??this._lexer.token;return syntaxError(this._lexer.source,o.start,"Unexpected ".concat(getTokenDesc(o),"."))},t.any=function(a,o,u){this.expectToken(a);for(var s=[];!this.expectOptionalToken(u);)s.push(o.call(this));return s},t.optionalMany=function(a,o,u){if(this.expectOptionalToken(a)){var s=[];do s.push(o.call(this));while(!this.expectOptionalToken(u));return s}return[]},t.many=function(a,o,u){this.expectToken(a);var s=[];do s.push(o.call(this));while(!this.expectOptionalToken(u));return s},t.delimitedMany=function(a,o){this.expectOptionalToken(a);var u=[];do u.push(o.call(this));while(this.expectOptionalToken(a));return u},n}();function getTokenDesc(n){var t=n.value;return getTokenKindDesc(n.kind)+(t!=null?' "'.concat(t,'"'):"")}function getTokenKindDesc(n){return isPunctuatorTokenKind(n)?'"'.concat(n,'"'):n}var QueryDocumentKeys={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},BREAK=Object.freeze({});function visit(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:QueryDocumentKeys,a=void 0,o=Array.isArray(n),u=[n],s=-1,c=[],l=void 0,d=void 0,f=void 0,h=[],v=[],g=n;do{s++;var b=s===u.length,_=b&&c.length!==0;if(b){if(d=v.length===0?void 0:h[h.length-1],l=f,f=v.pop(),_){if(o)l=l.slice();else{for(var S={},T=0,w=Object.keys(l);T<w.length;T++){var A=w[T];S[A]=l[A]}l=S}for(var R=0,E=0;E<c.length;E++){var I=c[E][0],L=c[E][1];o&&(I-=R),o&&L===null?(l.splice(I,1),R++):l[I]=L}}s=a.index,u=a.keys,c=a.edits,o=a.inArray,a=a.prev}else{if(d=f?o?s:u[s]:void 0,l=f?f[d]:g,l==null)continue;f&&h.push(d)}var F=void 0;if(!Array.isArray(l)){if(!isNode(l))throw new Error("Invalid AST Node: ".concat(inspect$1(l),"."));var D=getVisitFn(t,l.kind,b);if(D){if(F=D.call(t,l,d,f,h,v),F===BREAK)break;if(F===!1){if(!b){h.pop();continue}}else if(F!==void 0&&(c.push([d,F]),!b))if(isNode(F))l=F;else{h.pop();continue}}}if(F===void 0&&_&&c.push([d,l]),b)h.pop();else{var $;a={inArray:o,index:s,keys:u,edits:c,prev:a},o=Array.isArray(l),u=o?l:($=r[l.kind])!==null&&$!==void 0?$:[],s=-1,c=[],f&&v.push(f),f=l}}while(a!==void 0);return c.length!==0&&(g=c[c.length-1][1]),g}function visitInParallel(n){var t=new Array(n.length);return{enter:function(a){for(var o=0;o<n.length;o++)if(t[o]==null){var u=getVisitFn(n[o],a.kind,!1);if(u){var s=u.apply(n[o],arguments);if(s===!1)t[o]=a;else if(s===BREAK)t[o]=BREAK;else if(s!==void 0)return s}}},leave:function(a){for(var o=0;o<n.length;o++)if(t[o]==null){var u=getVisitFn(n[o],a.kind,!0);if(u){var s=u.apply(n[o],arguments);if(s===BREAK)t[o]=BREAK;else if(s!==void 0&&s!==!1)return s}}else t[o]===a&&(t[o]=null)}}}function getVisitFn(n,t,r){var a=n[t];if(a){if(!r&&typeof a=="function")return a;var o=r?a.leave:a.enter;if(typeof o=="function")return o}else{var u=r?n.leave:n.enter;if(u){if(typeof u=="function")return u;var s=u[t];if(typeof s=="function")return s}}}function print(n){return visit(n,{leave:printDocASTReducer})}var MAX_LINE_LENGTH=80,printDocASTReducer={Name:function(t){return t.value},Variable:function(t){return"$"+t.name},Document:function(t){return join(t.definitions,`

`)+`
`},OperationDefinition:function(t){var r=t.operation,a=t.name,o=wrap("(",join(t.variableDefinitions,", "),")"),u=join(t.directives," "),s=t.selectionSet;return!a&&!u&&!o&&r==="query"?s:join([r,join([a,o]),u,s]," ")},VariableDefinition:function(t){var r=t.variable,a=t.type,o=t.defaultValue,u=t.directives;return r+": "+a+wrap(" = ",o)+wrap(" ",join(u," "))},SelectionSet:function(t){var r=t.selections;return block(r)},Field:function(t){var r=t.alias,a=t.name,o=t.arguments,u=t.directives,s=t.selectionSet,c=wrap("",r,": ")+a,l=c+wrap("(",join(o,", "),")");return l.length>MAX_LINE_LENGTH&&(l=c+wrap(`(
`,indent(join(o,`
`)),`
)`)),join([l,join(u," "),s]," ")},Argument:function(t){var r=t.name,a=t.value;return r+": "+a},FragmentSpread:function(t){var r=t.name,a=t.directives;return"..."+r+wrap(" ",join(a," "))},InlineFragment:function(t){var r=t.typeCondition,a=t.directives,o=t.selectionSet;return join(["...",wrap("on ",r),join(a," "),o]," ")},FragmentDefinition:function(t){var r=t.name,a=t.typeCondition,o=t.variableDefinitions,u=t.directives,s=t.selectionSet;return"fragment ".concat(r).concat(wrap("(",join(o,", "),")")," ")+"on ".concat(a," ").concat(wrap("",join(u," ")," "))+s},IntValue:function(t){var r=t.value;return r},FloatValue:function(t){var r=t.value;return r},StringValue:function(t,r){var a=t.value,o=t.block;return o?printBlockString(a,r==="description"?"":"  "):JSON.stringify(a)},BooleanValue:function(t){var r=t.value;return r?"true":"false"},NullValue:function(){return"null"},EnumValue:function(t){var r=t.value;return r},ListValue:function(t){var r=t.values;return"["+join(r,", ")+"]"},ObjectValue:function(t){var r=t.fields;return"{"+join(r,", ")+"}"},ObjectField:function(t){var r=t.name,a=t.value;return r+": "+a},Directive:function(t){var r=t.name,a=t.arguments;return"@"+r+wrap("(",join(a,", "),")")},NamedType:function(t){var r=t.name;return r},ListType:function(t){var r=t.type;return"["+r+"]"},NonNullType:function(t){var r=t.type;return r+"!"},SchemaDefinition:addDescription(function(n){var t=n.directives,r=n.operationTypes;return join(["schema",join(t," "),block(r)]," ")}),OperationTypeDefinition:function(t){var r=t.operation,a=t.type;return r+": "+a},ScalarTypeDefinition:addDescription(function(n){var t=n.name,r=n.directives;return join(["scalar",t,join(r," ")]," ")}),ObjectTypeDefinition:addDescription(function(n){var t=n.name,r=n.interfaces,a=n.directives,o=n.fields;return join(["type",t,wrap("implements ",join(r," & ")),join(a," "),block(o)]," ")}),FieldDefinition:addDescription(function(n){var t=n.name,r=n.arguments,a=n.type,o=n.directives;return t+(hasMultilineItems(r)?wrap(`(
`,indent(join(r,`
`)),`
)`):wrap("(",join(r,", "),")"))+": "+a+wrap(" ",join(o," "))}),InputValueDefinition:addDescription(function(n){var t=n.name,r=n.type,a=n.defaultValue,o=n.directives;return join([t+": "+r,wrap("= ",a),join(o," ")]," ")}),InterfaceTypeDefinition:addDescription(function(n){var t=n.name,r=n.interfaces,a=n.directives,o=n.fields;return join(["interface",t,wrap("implements ",join(r," & ")),join(a," "),block(o)]," ")}),UnionTypeDefinition:addDescription(function(n){var t=n.name,r=n.directives,a=n.types;return join(["union",t,join(r," "),a&&a.length!==0?"= "+join(a," | "):""]," ")}),EnumTypeDefinition:addDescription(function(n){var t=n.name,r=n.directives,a=n.values;return join(["enum",t,join(r," "),block(a)]," ")}),EnumValueDefinition:addDescription(function(n){var t=n.name,r=n.directives;return join([t,join(r," ")]," ")}),InputObjectTypeDefinition:addDescription(function(n){var t=n.name,r=n.directives,a=n.fields;return join(["input",t,join(r," "),block(a)]," ")}),DirectiveDefinition:addDescription(function(n){var t=n.name,r=n.arguments,a=n.repeatable,o=n.locations;return"directive @"+t+(hasMultilineItems(r)?wrap(`(
`,indent(join(r,`
`)),`
)`):wrap("(",join(r,", "),")"))+(a?" repeatable":"")+" on "+join(o," | ")}),SchemaExtension:function(t){var r=t.directives,a=t.operationTypes;return join(["extend schema",join(r," "),block(a)]," ")},ScalarTypeExtension:function(t){var r=t.name,a=t.directives;return join(["extend scalar",r,join(a," ")]," ")},ObjectTypeExtension:function(t){var r=t.name,a=t.interfaces,o=t.directives,u=t.fields;return join(["extend type",r,wrap("implements ",join(a," & ")),join(o," "),block(u)]," ")},InterfaceTypeExtension:function(t){var r=t.name,a=t.interfaces,o=t.directives,u=t.fields;return join(["extend interface",r,wrap("implements ",join(a," & ")),join(o," "),block(u)]," ")},UnionTypeExtension:function(t){var r=t.name,a=t.directives,o=t.types;return join(["extend union",r,join(a," "),o&&o.length!==0?"= "+join(o," | "):""]," ")},EnumTypeExtension:function(t){var r=t.name,a=t.directives,o=t.values;return join(["extend enum",r,join(a," "),block(o)]," ")},InputObjectTypeExtension:function(t){var r=t.name,a=t.directives,o=t.fields;return join(["extend input",r,join(a," "),block(o)]," ")}};function addDescription(n){return function(t){return join([t.description,n(t)],`
`)}}function join(n){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t=n==null?void 0:n.filter(function(a){return a}).join(r))!==null&&t!==void 0?t:""}function block(n){return wrap(`{
`,indent(join(n,`
`)),`
}`)}function wrap(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return t!=null&&t!==""?n+t+r:""}function indent(n){return wrap("  ",n.replace(/\n/g,`
  `))}function isMultiline(n){return n.indexOf(`
`)!==-1}function hasMultilineItems(n){return n!=null&&n.some(isMultiline)}function isDefinitionNode(n){return isExecutableDefinitionNode(n)||isTypeSystemDefinitionNode(n)||isTypeSystemExtensionNode(n)}function isExecutableDefinitionNode(n){return n.kind===Kind.OPERATION_DEFINITION||n.kind===Kind.FRAGMENT_DEFINITION}function isSelectionNode(n){return n.kind===Kind.FIELD||n.kind===Kind.FRAGMENT_SPREAD||n.kind===Kind.INLINE_FRAGMENT}function isValueNode(n){return n.kind===Kind.VARIABLE||n.kind===Kind.INT||n.kind===Kind.FLOAT||n.kind===Kind.STRING||n.kind===Kind.BOOLEAN||n.kind===Kind.NULL||n.kind===Kind.ENUM||n.kind===Kind.LIST||n.kind===Kind.OBJECT}function isTypeNode(n){return n.kind===Kind.NAMED_TYPE||n.kind===Kind.LIST_TYPE||n.kind===Kind.NON_NULL_TYPE}function isTypeSystemDefinitionNode(n){return n.kind===Kind.SCHEMA_DEFINITION||isTypeDefinitionNode(n)||n.kind===Kind.DIRECTIVE_DEFINITION}function isTypeDefinitionNode(n){return n.kind===Kind.SCALAR_TYPE_DEFINITION||n.kind===Kind.OBJECT_TYPE_DEFINITION||n.kind===Kind.INTERFACE_TYPE_DEFINITION||n.kind===Kind.UNION_TYPE_DEFINITION||n.kind===Kind.ENUM_TYPE_DEFINITION||n.kind===Kind.INPUT_OBJECT_TYPE_DEFINITION}function isTypeSystemExtensionNode(n){return n.kind===Kind.SCHEMA_EXTENSION||isTypeExtensionNode(n)}function isTypeExtensionNode(n){return n.kind===Kind.SCALAR_TYPE_EXTENSION||n.kind===Kind.OBJECT_TYPE_EXTENSION||n.kind===Kind.INTERFACE_TYPE_EXTENSION||n.kind===Kind.UNION_TYPE_EXTENSION||n.kind===Kind.ENUM_TYPE_EXTENSION||n.kind===Kind.INPUT_OBJECT_TYPE_EXTENSION}const language=Object.freeze(Object.defineProperty({__proto__:null,BREAK,DirectiveLocation,Kind,Lexer,Location,Source,Token,TokenKind,getLocation,getVisitFn,isDefinitionNode,isExecutableDefinitionNode,isSelectionNode,isTypeDefinitionNode,isTypeExtensionNode,isTypeNode,isTypeSystemDefinitionNode,isTypeSystemExtensionNode,isValueNode,parse:parse$3,parseType,parseValue,print,printLocation,printSourceLocation,visit,visitInParallel},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(language);var Util$9={},jsonldContextParser$3={},ContextParser$3={},relativeToAbsoluteIri={},Resolve={},hasRequiredResolve;function requireResolve(){if(hasRequiredResolve)return Resolve;hasRequiredResolve=1,Object.defineProperty(Resolve,"__esModule",{value:!0}),Resolve.removeDotSegmentsOfPath=Resolve.removeDotSegments=Resolve.resolve=void 0;function n(o,u){u=u||"";const s=u.indexOf("#");if(s>0&&(u=u.substr(0,s)),!o.length){if(u.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${u}' for value '${o}'`);return u}if(o.startsWith("?")){const g=u.indexOf("?");return g>0&&(u=u.substr(0,g)),u+o}if(o.startsWith("#"))return u+o;if(!u.length){const g=o.indexOf(":");if(g<0)throw new Error(`Found invalid relative IRI '${o}' for a missing baseIRI`);return r(o,g)}const c=o.indexOf(":");if(c>=0)return r(o,c);const l=u.indexOf(":");if(l<0)throw new Error(`Found invalid baseIRI '${u}' for value '${o}'`);const d=u.substr(0,l+1);if(o.indexOf("//")===0)return d+r(o,c);let f;if(u.indexOf("//",l)===l+1){if(f=u.indexOf("/",l+3),f<0)return u.length>l+3?u+"/"+r(o,c):d+r(o,c)}else if(f=u.indexOf("/",l+1),f<0)return d+r(o,c);if(o.indexOf("/")===0)return u.substr(0,f)+t(o);let h=u.substr(f);const v=h.lastIndexOf("/");return v>=0&&v<h.length-1&&(h=h.substr(0,v+1),o[0]==="."&&o[1]!=="."&&o[1]!=="/"&&o[2]&&(o=o.substr(1))),o=h+o,o=t(o),u.substr(0,f)+o}Resolve.resolve=n;function t(o){const u=[];let s=0;for(;s<o.length;)switch(o[s]){case"/":if(o[s+1]===".")if(o[s+2]==="."){if(!a(o[s+3])){u.push([]),s++;break}u.pop(),o[s+3]||u.push([]),s+=3}else{if(!a(o[s+2])){u.push([]),s++;break}o[s+2]||u.push([]),s+=2}else u.push([]),s++;break;case"#":case"?":u.length||u.push([]),u[u.length-1].push(o.substr(s)),s=o.length;break;default:u.length||u.push([]),u[u.length-1].push(o[s]),s++;break}return"/"+u.map(c=>c.join("")).join("/")}Resolve.removeDotSegments=t;function r(o,u){let s=u+1;u>=0?o[u+1]==="/"&&o[u+2]==="/"&&(s=u+3):o[0]==="/"&&o[1]==="/"&&(s=2);const c=o.indexOf("/",s);if(c<0)return o;const l=o.substr(0,c),d=o.substr(c);return l+t(d)}Resolve.removeDotSegmentsOfPath=r;function a(o){return!o||o==="#"||o==="?"||o==="/"}return Resolve}var hasRequiredRelativeToAbsoluteIri;function requireRelativeToAbsoluteIri(){return hasRequiredRelativeToAbsoluteIri||(hasRequiredRelativeToAbsoluteIri=1,function(n){var t=relativeToAbsoluteIri&&relativeToAbsoluteIri.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u),Object.defineProperty(a,s,{enumerable:!0,get:function(){return o[u]}})}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=relativeToAbsoluteIri&&relativeToAbsoluteIri.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireResolve(),n)}(relativeToAbsoluteIri)),relativeToAbsoluteIri}var ErrorCoded$3={},hasRequiredErrorCoded$3;function requireErrorCoded$3(){return hasRequiredErrorCoded$3||(hasRequiredErrorCoded$3=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_CODES=n.ErrorCoded=void 0;class t extends Error{constructor(a,o){super(a),this.code=o}}n.ErrorCoded=t,function(r){r.COLLIDING_KEYWORDS="colliding keywords",r.CONFLICTING_INDEXES="conflicting indexes",r.CYCLIC_IRI_MAPPING="cyclic IRI mapping",r.INVALID_ID_VALUE="invalid @id value",r.INVALID_INDEX_VALUE="invalid @index value",r.INVALID_NEST_VALUE="invalid @nest value",r.INVALID_PREFIX_VALUE="invalid @prefix value",r.INVALID_PROPAGATE_VALUE="invalid @propagate value",r.INVALID_REVERSE_VALUE="invalid @reverse value",r.INVALID_IMPORT_VALUE="invalid @import value",r.INVALID_VERSION_VALUE="invalid @version value",r.INVALID_BASE_IRI="invalid base IRI",r.INVALID_CONTAINER_MAPPING="invalid container mapping",r.INVALID_CONTEXT_ENTRY="invalid context entry",r.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",r.INVALID_DEFAULT_LANGUAGE="invalid default language",r.INVALID_INCLUDED_VALUE="invalid @included value",r.INVALID_IRI_MAPPING="invalid IRI mapping",r.INVALID_JSON_LITERAL="invalid JSON literal",r.INVALID_KEYWORD_ALIAS="invalid keyword alias",r.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",r.INVALID_LANGUAGE_MAPPING="invalid language mapping",r.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",r.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",r.INVALID_LOCAL_CONTEXT="invalid local context",r.INVALID_REMOTE_CONTEXT="invalid remote context",r.INVALID_REVERSE_PROPERTY="invalid reverse property",r.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",r.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",r.INVALID_SCOPED_CONTEXT="invalid scoped context",r.INVALID_SCRIPT_ELEMENT="invalid script element",r.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",r.INVALID_TERM_DEFINITION="invalid term definition",r.INVALID_TYPE_MAPPING="invalid type mapping",r.INVALID_TYPE_VALUE="invalid type value",r.INVALID_TYPED_VALUE="invalid typed value",r.INVALID_VALUE_OBJECT="invalid value object",r.INVALID_VALUE_OBJECT_VALUE="invalid value object value",r.INVALID_VOCAB_MAPPING="invalid vocab mapping",r.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",r.KEYWORD_REDEFINITION="keyword redefinition",r.LOADING_DOCUMENT_FAILED="loading document failed",r.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",r.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",r.PROCESSING_MODE_CONFLICT="processing mode conflict",r.PROTECTED_TERM_REDEFINITION="protected term redefinition",r.CONTEXT_OVERFLOW="context overflow",r.INVALID_BASE_DIRECTION="invalid base direction",r.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",r.INVALID_STREAMING_KEY_ORDER="invalid streaming key order",r.INVALID_EMBEDDED_NODE="invalid embedded node",r.INVALID_ANNOTATION="invalid annotation"}(n.ERROR_CODES||(n.ERROR_CODES={}))}(ErrorCoded$3)),ErrorCoded$3}var FetchDocumentLoader$3={},link,hasRequiredLink;function requireLink(){if(hasRequiredLink)return link;hasRequiredLink=1;var n=/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i,t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,r=/\s|\uFEFF|\xA0/,a=/\r?\n[\x20\x09]+/g,o=/[;,"]/,u=/[;,"]|\s/,s=/^[!#$%&'*+\-\.^_`|~\da-zA-Z]+$/,c={IDLE:1,URI:2,ATTR:4};function l(b){return b.replace(t,"")}function d(b){return r.test(b)}function f(b,_){for(;d(b[_]);)_++;return _}function h(b){return u.test(b)||!s.test(b)}function v(b,_){return Object.keys(b).length===Object.keys(_).length&&Object.keys(b).every(S=>S in _&&b[S]===_[S])}class g{constructor(_){this.refs=[],_&&this.parse(_)}rel(_){for(var S=[],T=_.toLowerCase(),w=0;w<this.refs.length;w++)typeof this.refs[w].rel=="string"&&this.refs[w].rel.toLowerCase()===T&&S.push(this.refs[w]);return S}get(_,S){_=_.toLowerCase(),S=S.toLowerCase();for(var T=[],w=0;w<this.refs.length;w++)typeof this.refs[w][_]=="string"&&this.refs[w][_].toLowerCase()===S&&T.push(this.refs[w]);return T}set(_){return this.refs.push(_),this}setUnique(_){return this.refs.some(S=>v(S,_))||this.refs.push(_),this}has(_,S){_=_.toLowerCase(),S=S.toLowerCase();for(var T=0;T<this.refs.length;T++)if(typeof this.refs[T][_]=="string"&&this.refs[T][_].toLowerCase()===S)return!0;return!1}parse(_,A){A=A||0,_=A?_.slice(A):_,_=l(_).replace(a,"");for(var T=c.IDLE,w=_.length,A=0,R=null;A<w;)if(T===c.IDLE){if(d(_[A])){A++;continue}else if(_[A]==="<"){R!=null&&(R.rel!=null?this.refs.push(...g.expandRelations(R)):this.refs.push(R));var E=_.indexOf(">",A);if(E===-1)throw new Error("Expected end of URI delimiter at offset "+A);R={uri:_.slice(A+1,E)},A=E,T=c.URI}else throw new Error('Unexpected character "'+_[A]+'" at offset '+A);A++}else if(T===c.URI)if(d(_[A])){A++;continue}else if(_[A]===";")T=c.ATTR,A++;else if(_[A]===",")T=c.IDLE,A++;else throw new Error('Unexpected character "'+_[A]+'" at offset '+A);else if(T===c.ATTR){if(_[A]===";"||d(_[A])){A++;continue}var E=_.indexOf("=",A);E===-1&&(E=_.indexOf(";",A)),E===-1&&(E=_.length);var I=l(_.slice(A,E)).toLowerCase(),L="";if(A=E+1,A=f(_,A),_[A]==='"')for(A++;A<w;){if(_[A]==='"'){A++;break}_[A]==="\\"&&A++,L+=_[A],A++}else{for(var E=A+1;!o.test(_[E])&&E<w;)E++;L=_.slice(A,E),A=E}switch(R[I]&&g.isSingleOccurenceAttr(I)||(I[I.length-1]==="*"?R[I]=g.parseExtendedValue(L):(L=I==="type"?L.toLowerCase():L,R[I]!=null?Array.isArray(R[I])?R[I].push(L):R[I]=[R[I],L]:R[I]=L)),_[A]){case",":T=c.IDLE;break;case";":T=c.ATTR;break}A++}else throw new Error('Unknown parser state "'+T+'"');return R!=null&&(R.rel!=null?this.refs.push(...g.expandRelations(R)):this.refs.push(R)),R=null,this}toString(){for(var _=[],S="",T=null,w=0;w<this.refs.length;w++)T=this.refs[w],S=Object.keys(this.refs[w]).reduce(function(A,R){return R==="uri"?A:A+"; "+g.formatAttribute(R,T[R])},"<"+T.uri+">"),_.push(S);return _.join(", ")}}return g.isCompatibleEncoding=function(b){return n.test(b)},g.parse=function(b,_){return new g().parse(b,_)},g.isSingleOccurenceAttr=function(b){return b==="rel"||b==="type"||b==="media"||b==="title"||b==="title*"},g.isTokenAttr=function(b){return b==="rel"||b==="type"||b==="anchor"},g.escapeQuotes=function(b){return b.replace(/"/g,'\\"')},g.expandRelations=function(b){var _=b.rel.split(" ");return _.map(function(S){var T=Object.assign({},b);return T.rel=S,T})},g.parseExtendedValue=function(b){var _=/([^']+)?(?:'([^']*)')?(.+)/.exec(b);return{language:_[2].toLowerCase(),encoding:g.isCompatibleEncoding(_[1])?null:_[1].toLowerCase(),value:g.isCompatibleEncoding(_[1])?decodeURIComponent(_[3]):_[3]}},g.formatExtendedAttribute=function(b,_){var S=(_.encoding||"utf-8").toUpperCase(),T=_.language||"en",w="";return Buffer.isBuffer(_.value)&&g.isCompatibleEncoding(S)?w=_.value.toString(S):Buffer.isBuffer(_.value)?w=_.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):w=encodeURIComponent(_.value),b+"="+S+"'"+T+"'"+w},g.formatAttribute=function(b,_){return Array.isArray(_)?_.map(S=>g.formatAttribute(b,S)).join("; "):b[b.length-1]==="*"||typeof _!="string"?g.formatExtendedAttribute(b,_):(g.isTokenAttr(b)?_=h(_)?'"'+g.escapeQuotes(_)+'"':g.escapeQuotes(_):h(_)&&(_=encodeURIComponent(_),_=_.replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"),_='"'+_+'"'),b+"="+_)},link=g,link}var hasRequiredFetchDocumentLoader$3;function requireFetchDocumentLoader$3(){if(hasRequiredFetchDocumentLoader$3)return FetchDocumentLoader$3;hasRequiredFetchDocumentLoader$3=1,Object.defineProperty(FetchDocumentLoader$3,"__esModule",{value:!0}),FetchDocumentLoader$3.FetchDocumentLoader=void 0;const n=requireErrorCoded$3(),t=requireLink(),r=requireRelativeToAbsoluteIri();class a{constructor(u){this.fetcher=u}async load(u){const s=await(this.fetcher||fetch)(u,{headers:new Headers({accept:"application/ld+json"})});if(s.ok&&s.headers){let c=s.headers.get("Content-Type");if(c){const l=c.indexOf(";");l>0&&(c=c.substr(0,l))}if(c==="application/ld+json")return await s.json();if(s.headers.has("Link")){let l;if(s.headers.forEach((d,f)=>{if(f==="link"){const h=(0,t.parse)(d);for(const v of h.get("type","application/ld+json"))if(v.rel==="alternate"){if(l)throw new Error("Multiple JSON-LD alternate links were found on "+u);l=(0,r.resolve)(v.uri,u)}}}),l)return this.load(l)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${c}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}else throw new Error(s.statusText||`Status code: ${s.status}`)}}return FetchDocumentLoader$3.FetchDocumentLoader=a,FetchDocumentLoader$3}var JsonLdContextNormalized$3={},Util$8={},hasRequiredUtil$9;function requireUtil$9(){if(hasRequiredUtil$9)return Util$8;hasRequiredUtil$9=1,Object.defineProperty(Util$8,"__esModule",{value:!0}),Util$8.Util=void 0;class n{static isCompactIri(r){return r.indexOf(":")>0&&!(r&&r[0]==="#")}static getPrefix(r,a){if(r&&r[0]==="#")return null;const o=r.indexOf(":");if(o>=0){if(r.length>o+1&&r.charAt(o+1)==="/"&&r.charAt(o+2)==="/")return null;const u=r.substr(0,o);if(u==="_")return null;if(a[u])return u}return null}static getContextValueId(r){if(r===null||typeof r=="string")return r;const a=r["@id"];return a||null}static isSimpleTermDefinitionPrefix(r,a){return!n.isPotentialKeyword(r)&&(a.allowPrefixNonGenDelims||typeof r=="string"&&(r[0]==="_"||n.isPrefixIriEndingWithGenDelim(r)))}static isPotentialKeyword(r){return typeof r=="string"&&n.KEYWORD_REGEX.test(r)}static isPrefixIriEndingWithGenDelim(r){return n.ENDS_WITH_GEN_DELIM.test(r)}static isPrefixValue(r){return r&&(typeof r=="string"||r&&typeof r=="object")}static isValidIri(r){return!!(r&&n.IRI_REGEX.test(r))}static isValidIriWeak(r){return!!r&&r[0]!==":"&&n.IRI_REGEX_WEAK.test(r)}static isValidKeyword(r){return n.VALID_KEYWORDS[r]}static isTermProtected(r,a){const o=r[a];return typeof o!="string"&&o&&o["@protected"]}static hasProtectedTerms(r){for(const a of Object.keys(r))if(n.isTermProtected(r,a))return!0;return!1}static isReservedInternalKeyword(r){return r.startsWith("@__")}static deepEqual(r,a){const o=Object.keys(r),u=Object.keys(a);return o.length!==u.length?!1:o.every(s=>{const c=r[s],l=a[s];return c===l||c!==null&&l!==null&&typeof c=="object"&&typeof l=="object"&&this.deepEqual(c,l)})}}return n.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,n.IRI_REGEX_WEAK=/(?::[^:])|\//,n.KEYWORD_REGEX=/^@[a-z]+$/i,n.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,n.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,n.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,n.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},n.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],n.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],n.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],n.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],n.CONTAINERS_1_0=["@list","@set","@index"],Util$8.Util=n,Util$8}var hasRequiredJsonLdContextNormalized$3;function requireJsonLdContextNormalized$3(){return hasRequiredJsonLdContextNormalized$3||(hasRequiredJsonLdContextNormalized$3=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.defaultExpandOptions=n.JsonLdContextNormalized=void 0;const t=requireRelativeToAbsoluteIri(),r=requireErrorCoded$3(),a=requireUtil$9();class o{constructor(s){this.contextRaw=s}getContextRaw(){return this.contextRaw}expandTerm(s,c,l=n.defaultExpandOptions){const d=this.contextRaw[s];if(d===null||d&&d["@id"]===null)return null;let f=!0;if(d&&c){const S=a.Util.getContextValueId(d);if(S&&S!==s)if(typeof S!="string"||!a.Util.isValidIri(S)&&!a.Util.isValidKeyword(S))a.Util.isPotentialKeyword(S)||(f=!1);else return S}const h=a.Util.getPrefix(s,this.contextRaw),v=this.contextRaw["@vocab"],g=(!!v||v==="")&&v.indexOf(":")<0,b=this.contextRaw["@base"],_=a.Util.isPotentialKeyword(s);if(h){const S=this.contextRaw[h],T=a.Util.getContextValueId(S);if(T){if(typeof S=="string"||!l.allowPrefixForcing){if(!a.Util.isSimpleTermDefinitionPrefix(T,l))return s}else if(T[0]!=="_"&&!_&&!S["@prefix"]&&!(s in this.contextRaw))return s;return T+s.substr(h.length+1)}}else if(c&&(v||v===""||l.allowVocabRelativeToBase&&b&&g)&&!_&&!a.Util.isCompactIri(s))if(g){if(l.allowVocabRelativeToBase)return(v||b?(0,t.resolve)(v,b):"")+s;throw new r.ErrorCoded(`Relative vocab expansion for term '${s}' with vocab '${v}' is not allowed.`,r.ERROR_CODES.INVALID_VOCAB_MAPPING)}else return v+s;else if(!c&&b&&!_&&!a.Util.isCompactIri(s))return(0,t.resolve)(s,b);if(f)return s;throw new r.ErrorCoded(`Invalid IRI mapping found for context entry '${s}': '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(s,c){if(c&&this.contextRaw["@vocab"]&&s.startsWith(this.contextRaw["@vocab"]))return s.substr(this.contextRaw["@vocab"].length);if(!c&&this.contextRaw["@base"]&&s.startsWith(this.contextRaw["@base"]))return s.substr(this.contextRaw["@base"].length);const l={prefix:"",suffix:s};for(const d in this.contextRaw){const f=this.contextRaw[d];if(f&&!a.Util.isPotentialKeyword(d)){const h=a.Util.getContextValueId(f);if(s.startsWith(h)){const v=s.substr(h.length);if(v)v.length<l.suffix.length&&(l.prefix=d,l.suffix=v);else if(c)return d}}}return l.prefix?l.prefix+":"+l.suffix:s}}n.JsonLdContextNormalized=o,n.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}(JsonLdContextNormalized$3)),JsonLdContextNormalized$3}var hasRequiredContextParser$3;function requireContextParser$3(){if(hasRequiredContextParser$3)return ContextParser$3;hasRequiredContextParser$3=1,Object.defineProperty(ContextParser$3,"__esModule",{value:!0}),ContextParser$3.ContextParser=void 0;const n=requireRelativeToAbsoluteIri(),t=requireErrorCoded$3(),r=requireFetchDocumentLoader$3(),a=requireJsonLdContextNormalized$3(),o=requireUtil$9();class u{constructor(c){c=c||{},this.documentLoader=c.documentLoader||new r.FetchDocumentLoader,this.documentCache={},this.validateContext=!c.skipValidation,this.expandContentTypeToBase=!!c.expandContentTypeToBase,this.remoteContextsDepthLimit=c.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps="redirectSchemaOrgHttps"in c?!!c.redirectSchemaOrgHttps:!0}static validateLanguage(c,l,d){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(c)}'`,d);if(!o.Util.REGEX_LANGUAGE_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(c)}'`,d);return!1}return!0}static validateDirection(c,l){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(c){for(const l of Object.keys(c)){let d=c[l];if(d&&typeof d=="object"&&d["@reverse"]&&!d["@id"]){if(typeof d["@reverse"]!="string"||o.Util.isValidKeyword(d["@reverse"]))throw new t.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${d["@reverse"]}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);d=c[l]=Object.assign(Object.assign({},d),{"@id":d["@reverse"]}),d["@id"]=d["@reverse"],o.Util.isPotentialKeyword(d["@reverse"])?delete d["@reverse"]:d["@reverse"]=!0}}return c}expandPrefixedTerms(c,l,d){const f=c.getContextRaw();for(const h of d||Object.keys(f))if(o.Util.EXPAND_KEYS_BLACKLIST.indexOf(h)<0&&!o.Util.isReservedInternalKeyword(h)){const v=f[h];if(o.Util.isPotentialKeyword(h)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(h)>=0&&(h!=="@type"||typeof f[h]=="object"&&!(f[h]["@protected"]||f[h]["@container"]==="@set")))throw new t.ErrorCoded(`Keywords can not be aliased to something else.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(v))>=0)throw new t.ErrorCoded(`Aliasing to certain keywords is not allowed.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(v&&o.Util.isPotentialKeyword(o.Util.getContextValueId(v))&&v["@prefix"]===!0)throw new t.ErrorCoded(`Tried to use keyword aliases as prefix: '${h}': '${JSON.stringify(v)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);for(;o.Util.isPrefixValue(f[h]);){const g=f[h];let b=!1;if(typeof g=="string")f[h]=c.expandTerm(g,!0),b=b||g!==f[h];else{const _=g["@id"],S=g["@type"],T=!("@prefix"in g)||o.Util.isValidIri(h);if("@id"in g)_!=null&&typeof _=="string"&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":c.expandTerm(_,!0)}),b=b||_!==f[h]["@id"]);else if(!o.Util.isPotentialKeyword(h)&&T){const w=c.expandTerm(h,!0);w!==h&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":w}),b=!0)}if(S&&typeof S=="string"&&S!=="@vocab"&&(!g["@container"]||!g["@container"]["@type"])&&T){let w=c.expandTerm(S,!0);l&&S===w&&(w=c.expandTerm(S,!1)),w!==S&&(b=!0,f[h]=Object.assign(Object.assign({},f[h]),{"@type":w}))}}if(!b)break}}}normalize(c,{processingMode:l,normalizeLanguageTags:d}){if(d||l===1)for(const f of Object.keys(c))if(f==="@language"&&typeof c[f]=="string")c[f]=c[f].toLowerCase();else{const h=c[f];if(h&&typeof h=="object"&&typeof h["@language"]=="string"){const v=h["@language"].toLowerCase();v!==h["@language"]&&(c[f]=Object.assign(Object.assign({},h),{"@language":v}))}}}containersToHash(c){for(const l of Object.keys(c)){const d=c[l];if(d&&typeof d=="object"){if(typeof d["@container"]=="string")c[l]=Object.assign(Object.assign({},d),{"@container":{[d["@container"]]:!0}});else if(Array.isArray(d["@container"])){const f={};for(const h of d["@container"])f[h]=!0;c[l]=Object.assign(Object.assign({},d),{"@container":f})}}}}applyScopedProtected(c,{processingMode:l},d){if(l&&l>=1.1&&c["@protected"]){for(const f of Object.keys(c))if(!o.Util.isReservedInternalKeyword(f)&&!o.Util.isPotentialKeyword(f)&&!o.Util.isTermProtected(c,f)){const h=c[f];h&&typeof h=="object"?"@protected"in c[f]||(c[f]=Object.assign(Object.assign({},c[f]),{"@protected":!0})):(c[f]={"@id":h,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(h,d)&&(c[f]=Object.assign(Object.assign({},c[f]),{"@prefix":!0})))}delete c["@protected"]}}validateKeywordRedefinitions(c,l,d,f){for(const h of f??Object.keys(l))if(o.Util.isTermProtected(c,h)&&(typeof l[h]=="string"?l[h]={"@id":l[h],"@protected":!0}:l[h]=Object.assign(Object.assign({},l[h]),{"@protected":!0}),!o.Util.deepEqual(c[h],l[h])))throw new t.ErrorCoded(`Attempted to override the protected keyword ${h} from ${JSON.stringify(o.Util.getContextValueId(c[h]))} to ${JSON.stringify(o.Util.getContextValueId(l[h]))}`,t.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(c,{processingMode:l}){for(const d of Object.keys(c)){if(o.Util.isReservedInternalKeyword(d))continue;if(d==="")throw new t.ErrorCoded(`The empty term is not allowed, got: '${d}': '${JSON.stringify(c[d])}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);const f=c[d],h=typeof f;if(o.Util.isPotentialKeyword(d)){switch(d.substr(1)){case"vocab":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @vocab IRI: ${f}`,t.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @base IRI: ${c[d]}`,t.ERROR_CODES.INVALID_BASE_IRI);break;case"language":f!==null&&u.validateLanguage(f,!0,t.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(f!==null&&h!=="number")throw new t.ErrorCoded(`Found an invalid @version number: ${f}`,t.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":f!==null&&u.validateDirection(f,!0);break;case"propagate":if(l===1)throw new t.ErrorCoded(`Found an illegal @propagate keyword: ${f}`,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(f!==null&&h!=="boolean")throw new t.ErrorCoded(`Found an invalid @propagate value: ${f}`,t.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(o.Util.isValidKeyword(d)&&o.Util.isValidKeyword(o.Util.getContextValueId(f)))throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${o.Util.getContextValueId(f)}'`,t.ERROR_CODES.KEYWORD_REDEFINITION);continue}if(f!==null)switch(h){case"string":if(o.Util.getPrefix(f,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(f==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(f)&&f!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(d)&&!("@id"in f)&&(f["@type"]==="@id"?!c["@base"]:!c["@vocab"]))throw new t.ErrorCoded(`Missing @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);for(const v of Object.keys(f)){const g=f[v];if(g)switch(v){case"@id":if(o.Util.isValidKeyword(g)&&g!=="@type"&&g!=="@id"&&g!=="@graph"&&g!=="@nest")throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(g==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(g)&&g!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}if(typeof g!="string")throw new t.ErrorCoded(`Detected non-string @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(g,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if(f["@container"]==="@type"&&g!=="@id"&&g!=="@vocab")throw new t.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(typeof g!="string")throw new t.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(h)}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(g!=="@id"&&g!=="@vocab"&&(l===1||g!=="@json")&&(l===1||g!=="@none")&&(g[0]==="_"||!o.Util.isValidIri(g)))throw new t.ErrorCoded(`A context @type must be an absolute IRI, found: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if(typeof g=="string"&&f["@id"]&&f["@id"]!==g)throw new t.ErrorCoded(`Found non-matching @id and @reverse term values in '${d}':'${g}' and '${f["@id"]}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in f)throw new t.ErrorCoded(`@nest is not allowed in the reverse property '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(l===1&&(Object.keys(g).length>1||o.Util.CONTAINERS_1_0.indexOf(Object.keys(g)[0])<0))throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${Object.keys(g)}') in 1.0, must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const b of Object.keys(g)){if(b==="@list"&&f["@reverse"])throw new t.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(o.Util.CONTAINERS.indexOf(b)<0)throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${b}'), must be one of ${o.Util.CONTAINERS.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":u.validateLanguage(g,!0,t.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":u.validateDirection(g,!0);break;case"@prefix":if(g!==null&&typeof g!="boolean")throw new t.ErrorCoded(`Found an invalid term @prefix boolean in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in f)&&!o.Util.isValidIri(d))throw new t.ErrorCoded(`Invalid @prefix definition for '${d}' ('${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(l===1||!f["@container"]||!f["@container"]["@index"])throw new t.ErrorCoded(`Attempt to add illegal key to value object: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(g)&&g!=="@nest")throw new t.ErrorCoded(`Found an invalid term @nest value in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new t.ErrorCoded(`Found an invalid term value: '${d}': '${f}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(c,l,d){return typeof c=="string"||(d&&!("@base"in c)&&l.parentContext&&typeof l.parentContext=="object"&&"@base"in l.parentContext&&(c["@base"]=l.parentContext["@base"],l.parentContext["@__baseDocument"]&&(c["@__baseDocument"]=!0)),l.baseIRI&&!l.external&&("@base"in c?c["@base"]!==null&&typeof c["@base"]=="string"&&!o.Util.isValidIri(c["@base"])&&(c["@base"]=(0,n.resolve)(c["@base"],l.parentContext&&l.parentContext["@base"]||l.baseIRI)):(c["@base"]=l.baseIRI,c["@__baseDocument"]=!0))),c}normalizeContextIri(c,l){if(!o.Util.isValidIri(c))try{c=(0,n.resolve)(c,l)}catch{throw new Error(`Invalid context IRI: ${c}`)}return this.redirectSchemaOrgHttps&&c.startsWith("http://schema.org")&&(c="https://schema.org/"),c}async parseInnerContexts(c,l,d){for(const f of d??Object.keys(c)){const h=c[f];if(h&&typeof h=="object"&&"@context"in h&&h["@context"]!==null&&!l.ignoreScopedContexts){if(this.validateContext)try{const v=Object.assign(Object.assign({},c),{[f]:Object.assign({},c[f])});delete v[f]["@context"],await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,parentContext:v,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(v){throw new t.ErrorCoded(v.message,t.ERROR_CODES.INVALID_SCOPED_CONTEXT)}c[f]=Object.assign(Object.assign({},h),{"@context":(await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:c}))).getContextRaw()})}}return c}async parse(c,l={},d={}){const{baseIRI:f,parentContext:h,external:v,processingMode:g=u.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:b,ignoreProtection:_,minimalProcessing:S}=l,T=l.remoteContexts||{};if(Object.keys(T).length>=this.remoteContextsDepthLimit)throw new t.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(T),t.ERROR_CODES.CONTEXT_OVERFLOW);if(c==null){if(!_&&h&&o.Util.hasProtectedTerms(h))throw new t.ErrorCoded("Illegal context nullification when terms are protected",t.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},l,!1))}else if(typeof c=="string"){const w=this.normalizeContextIri(c,f),A=this.getOverriddenLoad(w,l);if(A)return new a.JsonLdContextNormalized(A);const R=await this.parse(await this.load(w),Object.assign(Object.assign({},l),{baseIRI:w,external:!0,remoteContexts:Object.assign(Object.assign({},T),{[w]:!0})}));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(Array.isArray(c)){const w=[],A=await Promise.all(c.map((E,I)=>{if(typeof E=="string"){const L=this.normalizeContextIri(E,f);w[I]=L;const F=this.getOverriddenLoad(L,l);return F||this.load(L)}else return E}));if(S)return new a.JsonLdContextNormalized(A);const R=await A.reduce((E,I,L)=>E.then(F=>this.parse(I,Object.assign(Object.assign({},l),{baseIRI:w[L]||l.baseIRI,external:!!w[L]||l.external,parentContext:F.getContextRaw(),remoteContexts:w[L]?Object.assign(Object.assign({},T),{[w[L]]:!0}):T}),{skipValidation:L<A.length-1})),Promise.resolve(new a.JsonLdContextNormalized(h||{})));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(typeof c=="object"){if("@context"in c)return await this.parse(c["@context"],l);if(c=Object.assign({},c),v&&delete c["@base"],this.applyBaseEntry(c,l,!0),this.containersToHash(c),S)return new a.JsonLdContextNormalized(c);let w={};if("@import"in c)if(g>=1.1){if(typeof c["@import"]!="string")throw new t.ErrorCoded("An @import value must be a string, but got "+typeof c["@import"],t.ERROR_CODES.INVALID_IMPORT_VALUE);w=await this.loadImportContext(this.normalizeContextIri(c["@import"],f)),delete c["@import"]}else throw new t.ErrorCoded("Context importing is not supported in JSON-LD 1.0",t.ERROR_CODES.INVALID_CONTEXT_ENTRY);this.applyScopedProtected(w,{processingMode:g},a.defaultExpandOptions);const A=Object.assign(w,c);this.idifyReverseTerms(A),this.normalize(A,{processingMode:g,normalizeLanguageTags:b}),this.applyScopedProtected(A,{processingMode:g},a.defaultExpandOptions);const R=Object.keys(A),E=[];if(typeof h=="object")for(const L in h)L in A?E.push(L):A[L]=h[L];await this.parseInnerContexts(A,l,R);const I=new a.JsonLdContextNormalized(A);return(A&&A["@version"]||u.DEFAULT_PROCESSING_MODE)>=1.1&&(c["@vocab"]&&typeof c["@vocab"]=="string"||c["@vocab"]==="")&&(h&&"@vocab"in h&&c["@vocab"].indexOf(":")<0?A["@vocab"]=h["@vocab"]+c["@vocab"]:(o.Util.isCompactIri(c["@vocab"])||c["@vocab"]in A)&&(A["@vocab"]=I.expandTerm(c["@vocab"],!0))),this.expandPrefixedTerms(I,this.expandContentTypeToBase,R),!_&&h&&g>=1.1&&this.validateKeywordRedefinitions(h,A,a.defaultExpandOptions,E),this.validateContext&&!d.skipValidation&&this.validate(A,{processingMode:g}),I}else throw new t.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${c}`,t.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(c){const l=this.documentCache[c];if(l)return l;let d;try{d=await this.documentLoader.load(c)}catch(f){throw new t.ErrorCoded(`Failed to load remote context ${c}: ${f.message}`,t.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in d))throw new t.ErrorCoded(`Missing @context in remote context at ${c}`,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[c]=d["@context"]}getOverriddenLoad(c,l){if(c in(l.remoteContexts||{})){if(l.ignoreRemoteScopedContexts)return c;throw new t.ErrorCoded("Detected a cyclic context inclusion of "+c,t.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(c){let l=await this.load(c);if(typeof l!="object"||Array.isArray(l))throw new t.ErrorCoded("An imported context must be a single object: "+c,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in l)throw new t.ErrorCoded("An imported context can not import another context: "+c,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);return l=Object.assign({},l),this.containersToHash(l),l}}return u.DEFAULT_PROCESSING_MODE=1.1,ContextParser$3.ContextParser=u,ContextParser$3}var IDocumentLoader$3={},hasRequiredIDocumentLoader$3;function requireIDocumentLoader$3(){return hasRequiredIDocumentLoader$3||(hasRequiredIDocumentLoader$3=1,Object.defineProperty(IDocumentLoader$3,"__esModule",{value:!0})),IDocumentLoader$3}var JsonLdContext$3={},hasRequiredJsonLdContext$3;function requireJsonLdContext$3(){return hasRequiredJsonLdContext$3||(hasRequiredJsonLdContext$3=1,Object.defineProperty(JsonLdContext$3,"__esModule",{value:!0})),JsonLdContext$3}var hasRequiredJsonldContextParser$3;function requireJsonldContextParser$3(){return hasRequiredJsonldContextParser$3||(hasRequiredJsonldContextParser$3=1,function(n){var t=jsonldContextParser$3&&jsonldContextParser$3.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldContextParser$3&&jsonldContextParser$3.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireContextParser$3(),n),r(requireErrorCoded$3(),n),r(requireFetchDocumentLoader$3(),n),r(requireIDocumentLoader$3(),n),r(requireJsonLdContext$3(),n),r(requireJsonLdContextNormalized$3(),n),r(requireUtil$9(),n)}(jsonldContextParser$3)),jsonldContextParser$3}var hasRequiredUtil$8;function requireUtil$8(){if(hasRequiredUtil$8)return Util$9;hasRequiredUtil$8=1,Object.defineProperty(Util$9,"__esModule",{value:!0}),Util$9.Util=void 0;const n=requireRdfDataFactory(),t=requireJsonldContextParser$3(),r=requireSparqlalgebrajs();class a{constructor(u){this.nodeHandlers={},this.nodeValueHandlers={},this.directiveNodeHandlers={},this.settings=u,this.dataFactory=u.dataFactory||new n.DataFactory,this.operationFactory=new r.Factory(this.dataFactory),this.contextParser=new t.ContextParser}registerNodeHandler(u){this.nodeHandlers[u.targetKind]=u}registerNodeValueHandler(u){this.nodeValueHandlers[u.targetKind]=u}registerDirectiveNodeHandler(u){this.directiveNodeHandlers[u.targetKind]=u}handleNode(u,s){const c=this.nodeHandlers[u.kind];if(!c)throw new Error(`Unsupported GraphQL node '${u.kind}'`);return c.handle(u,s)}handleNodeValue(u,s,c){const l=this.nodeValueHandlers[u.kind];if(!l)throw new Error(`Unsupported GraphQL value node '${u.kind}'`);return l.handle(u,s,c)}handleDirectiveNode(u,s){const c=this.directiveNodeHandlers[u.directive.name.value];return c?c.handle(u,s):null}joinOperations(u){if(u.length===1)return u[0];const s=[],c=[];for(const l of u)l.type==="bgp"?s.push(l):c.push(l);if(s.length===u.length)return this.joinOperationsAsBgp(s);if(s.length===u.length-1&&c[0].type==="leftjoin"&&c[0].input[0].type==="bgp"){const l=c[0];return s.push(l.input[0]),this.operationFactory.createLeftJoin(this.joinOperationsAsBgp(s),l.input[1])}else return c.length===u.length?this.joinOperationsAsNestedJoin(c):this.joinOperationsAsNestedJoin([this.joinOperationsAsBgp(s),this.joinOperationsAsNestedJoin(c)])}joinOperationsAsBgp(u){return this.operationFactory.createBgp([].concat.apply([],u.map(s=>s.patterns)))}joinOperationsAsNestedJoin(u){return this.operationFactory.createJoin(u)}appendFieldToPath(u,s){return u.concat([s])}getFieldLabel(u){return(u.alias?u.alias:u.name).value}nameToVariable(u,s){return this.dataFactory.variable((s.path.length?s.path.join(this.settings.variableDelimiter)+this.settings.variableDelimiter:"")+u)}valueToNamedNode(u,s){const c=s.expandTerm(u,!0);if(this.settings.requireContext&&!c)throw new Error("No context entry was found for "+u);return this.dataFactory.namedNode(c||u)}getArgument(u,s){if(u){for(const c of u)if(c.name.value===s)return c}}newTypePattern(u,s,c){return this.operationFactory.createPattern(u,this.dataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.valueToNamedNode(s.name.value,c.context),c.graph)}createQuadPattern(u,s,c,l,d){const f=this.valueToNamedNode(s.value,d);return d&&d.getContextRaw()[s.value]&&d.getContextRaw()[s.value]["@reverse"]?this.operationFactory.createPattern(c,f,u,l):this.operationFactory.createPattern(u,f,c,l)}createQuadPath(u,s,c,l,d,f){const h=this.valueToNamedNode(s.value,f);let v=this.operationFactory.createLink(h);for(const g of c.values){if(g.kind!=="EnumValue")throw new Error("Invalid value type for 'alt' argument, must be EnumValue, but got "+g.kind);v=this.operationFactory.createAlt([v,this.operationFactory.createLink(this.valueToNamedNode(g.value,f))])}return f&&f.getContextRaw()[s.value]&&f.getContextRaw()[s.value]["@reverse"]?this.operationFactory.createPath(l,v,u,d):this.operationFactory.createPath(u,v,l,d)}}return Util$9.Util=a,Util$9}var hasRequiredConverter$1;function requireConverter$1(){if(hasRequiredConverter$1)return Converter$1;hasRequiredConverter$1=1;var n=Converter$1&&Converter$1.__awaiter||function(c,l,d,f){function h(v){return v instanceof d?v:new d(function(g){g(v)})}return new(d||(d=Promise))(function(v,g){function b(T){try{S(f.next(T))}catch(w){g(w)}}function _(T){try{S(f.throw(T))}catch(w){g(w)}}function S(T){T.done?v(T.value):h(T.value).then(b,_)}S((f=f.apply(c,l||[])).next())})};Object.defineProperty(Converter$1,"__esModule",{value:!0}),Converter$1.Converter=void 0;const t=require$$0$1,r=requireHandler$1(),a=requireDirectivenode(),o=requireIConvertContext(),u=requireUtil$8();class s{constructor(l){l=l||{},l.variableDelimiter=l.variableDelimiter||"_",l.expressionVariableCounter=l.expressionVariableCounter||0,this.util=new u.Util(l),this.initializeNodeHandlers(l)}static registerNodeHandlers(l,d){l.registerNodeHandler(new r.NodeHandlerDocument(l,d)),l.registerNodeHandler(new r.NodeHandlerDefinitionOperation(l,d)),l.registerNodeHandler(new r.NodeHandlerDefinitionFragment(l,d)),l.registerNodeHandler(new r.NodeHandlerSelectionFragmentSpread(l,d)),l.registerNodeHandler(new r.NodeHandlerSelectionInlineFragment(l,d)),l.registerNodeHandler(new r.NodeHandlerSelectionField(l,d))}static registerNodeValueHandlers(l,d){l.registerNodeValueHandler(new r.NodeValueHandlerVariable(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerInt(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerFloat(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerString(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerBoolean(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerNull(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerEnum(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerList(l,d)),l.registerNodeValueHandler(new r.NodeValueHandlerObject(l,d))}static registerDirectiveNodeHandlers(l,d){l.registerDirectiveNodeHandler(new a.DirectiveNodeHandlerInclude(l,d)),l.registerDirectiveNodeHandler(new a.DirectiveNodeHandlerOptional(l,d)),l.registerDirectiveNodeHandler(new a.DirectiveNodeHandlerPlural(l,d)),l.registerDirectiveNodeHandler(new a.DirectiveNodeHandlerSingle(l,d)),l.registerDirectiveNodeHandler(new a.DirectiveNodeHandlerSkip(l,d))}graphqlToSparqlAlgebra(l,d,f){return n(this,void 0,void 0,function*(){return this.graphqlToSparqlAlgebraRawContext(l,yield this.util.contextParser.parse(d),f)})}graphqlToSparqlAlgebraRawContext(l,d,f){f=f||{};const h=typeof l=="string"?(0,t.parse)(l):l,v=this.indexFragments(h),g={context:d,fragmentDefinitions:v,graph:this.util.dataFactory.defaultGraph(),path:[],singularizeState:o.SingularizeState.PLURAL,singularizeVariables:f.singularizeVariables||{},subject:null,terminalVariables:[],variablesDict:f.variablesDict||{},variablesMetaDict:{}};return this.util.handleNode(h,g)}indexFragments(l){const d={},f=[];for(const h of l.definitions)h.kind==="FragmentDefinition"?d[h.name.value]=h:f.push(h);return l.definitions=f,d}initializeNodeHandlers(l){s.registerNodeHandlers(this.util,l),s.registerNodeValueHandlers(this.util,l),s.registerDirectiveNodeHandlers(this.util,l)}}return Converter$1.Converter=s,Converter$1}var IConvertSettings={},hasRequiredIConvertSettings;function requireIConvertSettings(){return hasRequiredIConvertSettings||(hasRequiredIConvertSettings=1,Object.defineProperty(IConvertSettings,"__esModule",{value:!0})),IConvertSettings}var hasRequiredGraphqlToSparql;function requireGraphqlToSparql(){return hasRequiredGraphqlToSparql||(hasRequiredGraphqlToSparql=1,function(n){var t=graphqlToSparql&&graphqlToSparql.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=graphqlToSparql&&graphqlToSparql.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireHandler$1(),n),r(requireConverter$1(),n),r(requireIConvertContext(),n),r(requireIConvertSettings(),n),r(requireUtil$8(),n)}(graphqlToSparql)),graphqlToSparql}var hasRequiredActorQueryParseGraphql;function requireActorQueryParseGraphql(){if(hasRequiredActorQueryParseGraphql)return ActorQueryParseGraphql;hasRequiredActorQueryParseGraphql=1,Object.defineProperty(ActorQueryParseGraphql,"__esModule",{value:!0}),ActorQueryParseGraphql.ActorQueryParseGraphql=void 0;const n=requireLib$40(),t=requireLib$4q(),r=requireLib$4s(),a=requireGraphqlToSparql();let o=class extends n.ActorQueryParse{constructor(s){super(s),this.graphqlToSparql=new a.Converter({requireContext:!0})}async test(s){var c;return((c=s.queryFormat)==null?void 0:c.language)!=="graphql"?(0,r.failTest)("This actor can only parse GraphQL queries"):(0,r.passTestVoid)()}async run(s){const c=s.context.get(t.KeysInitQuery.jsonLdContext)||{},l={singularizeVariables:s.context.get(t.KeysInitQuery.graphqlSingularizeVariables)};return{operation:await this.graphqlToSparql.graphqlToSparqlAlgebra(s.query,c,l)}}};return ActorQueryParseGraphql.ActorQueryParseGraphql=o,ActorQueryParseGraphql}var hasRequiredLib$3_;function requireLib$3_(){return hasRequiredLib$3_||(hasRequiredLib$3_=1,function(n){var t=lib$3_&&lib$3_.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3_&&lib$3_.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryParseGraphql(),n)}(lib$3_)),lib$3_}var lib$3Z={},ActorQueryResultSerializeJson={},lib$3Y={},ActorQueryResultSerialize={},lib$3X={},ActorAbstractMediaTyped={},hasRequiredActorAbstractMediaTyped;function requireActorAbstractMediaTyped(){if(hasRequiredActorAbstractMediaTyped)return ActorAbstractMediaTyped;hasRequiredActorAbstractMediaTyped=1,Object.defineProperty(ActorAbstractMediaTyped,"__esModule",{value:!0}),ActorAbstractMediaTyped.ActorAbstractMediaTyped=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}async run(a){if("handle"in a){const o=a;return{handle:await this.runHandle(o.handle,o.handleMediaType,a.context)}}if("mediaTypes"in a)return{mediaTypes:await this.getMediaTypes(a.context)};if("mediaTypeFormats"in a)return{mediaTypeFormats:await this.getMediaTypeFormats(a.context)};throw new Error("Either a handle, mediaTypes or mediaTypeFormats action needs to be provided")}async test(a){if("handle"in a){const o=a;return(await this.testHandle(o.handle,o.handleMediaType,a.context)).map(u=>({handle:u}))}return"mediaTypes"in a?(await this.testMediaType(a.context)).map(o=>({mediaTypes:o})):"mediaTypeFormats"in a?(await this.testMediaTypeFormats(a.context)).map(o=>({mediaTypeFormats:o})):(0,n.failTest)("Either a handle, mediaTypes or mediaTypeFormats action needs to be provided")}};return ActorAbstractMediaTyped.ActorAbstractMediaTyped=t,ActorAbstractMediaTyped}var ActorAbstractMediaTypedFixed={},hasRequiredActorAbstractMediaTypedFixed;function requireActorAbstractMediaTypedFixed(){if(hasRequiredActorAbstractMediaTypedFixed)return ActorAbstractMediaTypedFixed;hasRequiredActorAbstractMediaTypedFixed=1,Object.defineProperty(ActorAbstractMediaTypedFixed,"__esModule",{value:!0}),ActorAbstractMediaTypedFixed.ActorAbstractMediaTypedFixed=void 0;const n=requireLib$4s(),t=requireActorAbstractMediaTyped();let r=class extends t.ActorAbstractMediaTyped{constructor(o){super(o);const u=this.priorityScale||this.priorityScale===0?this.priorityScale:1;if(this.mediaTypePriorities)for(const[s,[c,l]]of Object.entries(this.mediaTypePriorities).entries())this.mediaTypePriorities[c]=u*l;this.mediaTypePriorities=Object.freeze(this.mediaTypePriorities),this.mediaTypeFormats=Object.freeze(this.mediaTypeFormats)}async testHandle(o,u,s){return!u||!(u in this.mediaTypePriorities)?(0,n.failTest)(`Unrecognized media type: ${u}`):await this.testHandleChecked(o,s)}async testMediaType(o){return(0,n.passTestVoid)()}async getMediaTypes(o){return this.mediaTypePriorities}async testMediaTypeFormats(o){return(0,n.passTestVoid)()}async getMediaTypeFormats(o){return this.mediaTypeFormats}};return ActorAbstractMediaTypedFixed.ActorAbstractMediaTypedFixed=r,ActorAbstractMediaTypedFixed}var hasRequiredLib$3Z;function requireLib$3Z(){return hasRequiredLib$3Z||(hasRequiredLib$3Z=1,function(n){var t=lib$3X&&lib$3X.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3X&&lib$3X.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorAbstractMediaTyped(),n),r(requireActorAbstractMediaTypedFixed(),n)}(lib$3X)),lib$3X}var hasRequiredActorQueryResultSerialize;function requireActorQueryResultSerialize(){if(hasRequiredActorQueryResultSerialize)return ActorQueryResultSerialize;hasRequiredActorQueryResultSerialize=1,Object.defineProperty(ActorQueryResultSerialize,"__esModule",{value:!0}),ActorQueryResultSerialize.ActorQueryResultSerialize=void 0;const n=requireLib$3Z();let t=class extends n.ActorAbstractMediaTyped{constructor(a){super(a)}};return ActorQueryResultSerialize.ActorQueryResultSerialize=t,ActorQueryResultSerialize}var ActorQueryResultSerializeFixedMediaTypes={},hasRequiredActorQueryResultSerializeFixedMediaTypes;function requireActorQueryResultSerializeFixedMediaTypes(){if(hasRequiredActorQueryResultSerializeFixedMediaTypes)return ActorQueryResultSerializeFixedMediaTypes;hasRequiredActorQueryResultSerializeFixedMediaTypes=1,Object.defineProperty(ActorQueryResultSerializeFixedMediaTypes,"__esModule",{value:!0}),ActorQueryResultSerializeFixedMediaTypes.ActorQueryResultSerializeFixedMediaTypes=void 0;const n=requireLib$3Z(),t=requireLib$4s();let r=class extends n.ActorAbstractMediaTypedFixed{constructor(o){super(o)}async testHandleChecked(o,u){return(0,t.passTestVoid)()}};return ActorQueryResultSerializeFixedMediaTypes.ActorQueryResultSerializeFixedMediaTypes=r,ActorQueryResultSerializeFixedMediaTypes}var hasRequiredLib$3Y;function requireLib$3Y(){return hasRequiredLib$3Y||(hasRequiredLib$3Y=1,function(n){var t=lib$3Y&&lib$3Y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3Y&&lib$3Y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerialize(),n),r(requireActorQueryResultSerializeFixedMediaTypes(),n)}(lib$3Y)),lib$3Y}var browser$1={exports:{}},stream={exports:{}},buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=c,base64Js.toByteArray=d,base64Js.fromByteArray=v;for(var n=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=a.length;o<u;++o)n[o]=a[o],t[a.charCodeAt(o)]=o;t[45]=62,t[95]=63;function s(g){var b=g.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=g.indexOf("=");_===-1&&(_=b);var S=_===b?0:4-_%4;return[_,S]}function c(g){var b=s(g),_=b[0],S=b[1];return(_+S)*3/4-S}function l(g,b,_){return(b+_)*3/4-_}function d(g){var b,_=s(g),S=_[0],T=_[1],w=new r(l(g,S,T)),A=0,R=T>0?S-4:S,E;for(E=0;E<R;E+=4)b=t[g.charCodeAt(E)]<<18|t[g.charCodeAt(E+1)]<<12|t[g.charCodeAt(E+2)]<<6|t[g.charCodeAt(E+3)],w[A++]=b>>16&255,w[A++]=b>>8&255,w[A++]=b&255;return T===2&&(b=t[g.charCodeAt(E)]<<2|t[g.charCodeAt(E+1)]>>4,w[A++]=b&255),T===1&&(b=t[g.charCodeAt(E)]<<10|t[g.charCodeAt(E+1)]<<4|t[g.charCodeAt(E+2)]>>2,w[A++]=b>>8&255,w[A++]=b&255),w}function f(g){return n[g>>18&63]+n[g>>12&63]+n[g>>6&63]+n[g&63]}function h(g,b,_){for(var S,T=[],w=b;w<_;w+=3)S=(g[w]<<16&16711680)+(g[w+1]<<8&65280)+(g[w+2]&255),T.push(f(S));return T.join("")}function v(g){for(var b,_=g.length,S=_%3,T=[],w=16383,A=0,R=_-S;A<R;A+=w)T.push(h(g,A,A+w>R?R:A+w));return S===1?(b=g[_-1],T.push(n[b>>2]+n[b<<4&63]+"==")):S===2&&(b=(g[_-2]<<8)+g[_-1],T.push(n[b>>10]+n[b>>4&63]+n[b<<2&63]+"=")),T.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(n,t,r,a,o){var u,s,c=o*8-a-1,l=(1<<c)-1,d=l>>1,f=-7,h=r?o-1:0,v=r?-1:1,g=n[t+h];for(h+=v,u=g&(1<<-f)-1,g>>=-f,f+=c;f>0;u=u*256+n[t+h],h+=v,f-=8);for(s=u&(1<<-f)-1,u>>=-f,f+=a;f>0;s=s*256+n[t+h],h+=v,f-=8);if(u===0)u=1-d;else{if(u===l)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,a),u=u-d}return(g?-1:1)*s*Math.pow(2,u-a)},ieee754.write=function(n,t,r,a,o,u){var s,c,l,d=u*8-o-1,f=(1<<d)-1,h=f>>1,v=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=a?0:u-1,b=a?1:-1,_=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(c=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?t+=v/l:t+=v*Math.pow(2,1-h),t*l>=2&&(s++,l/=2),s+h>=f?(c=0,s=f):s+h>=1?(c=(t*l-1)*Math.pow(2,o),s=s+h):(c=t*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;n[r+g]=c&255,g+=b,c/=256,o-=8);for(s=s<<o|c,d+=o;d>0;n[r+g]=s&255,g+=b,s/=256,d-=8);n[r+g-b]|=_*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(n){const t=requireBase64Js(),r=requireIeee754(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=c,n.SlowBuffer=w,n.INSPECT_MAX_BYTES=50;const o=2147483647;n.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=u(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{const H=new Uint8Array(1),V={foo:function(){return 42}};return Object.setPrototypeOf(V,Uint8Array.prototype),Object.setPrototypeOf(H,V),H.foo()===42}catch{return!1}}Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}});function s(H){if(H>o)throw new RangeError('The value "'+H+'" is invalid for option "size"');const V=new Uint8Array(H);return Object.setPrototypeOf(V,c.prototype),V}function c(H,V,Q){if(typeof H=="number"){if(typeof V=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(H)}return l(H,V,Q)}c.poolSize=8192;function l(H,V,Q){if(typeof H=="string")return v(H,V);if(ArrayBuffer.isView(H))return b(H);if(H==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if(me(H,ArrayBuffer)||H&&me(H.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(me(H,SharedArrayBuffer)||H&&me(H.buffer,SharedArrayBuffer)))return _(H,V,Q);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ee=H.valueOf&&H.valueOf();if(ee!=null&&ee!==H)return c.from(ee,V,Q);const ae=S(H);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return c.from(H[Symbol.toPrimitive]("string"),V,Q);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}c.from=function(H,V,Q){return l(H,V,Q)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function d(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function f(H,V,Q){return d(H),H<=0?s(H):V!==void 0?typeof Q=="string"?s(H).fill(V,Q):s(H).fill(V):s(H)}c.alloc=function(H,V,Q){return f(H,V,Q)};function h(H){return d(H),s(H<0?0:T(H)|0)}c.allocUnsafe=function(H){return h(H)},c.allocUnsafeSlow=function(H){return h(H)};function v(H,V){if((typeof V!="string"||V==="")&&(V="utf8"),!c.isEncoding(V))throw new TypeError("Unknown encoding: "+V);const Q=A(H,V)|0;let ee=s(Q);const ae=ee.write(H,V);return ae!==Q&&(ee=ee.slice(0,ae)),ee}function g(H){const V=H.length<0?0:T(H.length)|0,Q=s(V);for(let ee=0;ee<V;ee+=1)Q[ee]=H[ee]&255;return Q}function b(H){if(me(H,Uint8Array)){const V=new Uint8Array(H);return _(V.buffer,V.byteOffset,V.byteLength)}return g(H)}function _(H,V,Q){if(V<0||H.byteLength<V)throw new RangeError('"offset" is outside of buffer bounds');if(H.byteLength<V+(Q||0))throw new RangeError('"length" is outside of buffer bounds');let ee;return V===void 0&&Q===void 0?ee=new Uint8Array(H):Q===void 0?ee=new Uint8Array(H,V):ee=new Uint8Array(H,V,Q),Object.setPrototypeOf(ee,c.prototype),ee}function S(H){if(c.isBuffer(H)){const V=T(H.length)|0,Q=s(V);return Q.length===0||H.copy(Q,0,0,V),Q}if(H.length!==void 0)return typeof H.length!="number"||Ie(H.length)?s(0):g(H);if(H.type==="Buffer"&&Array.isArray(H.data))return g(H.data)}function T(H){if(H>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return H|0}function w(H){return+H!=H&&(H=0),c.alloc(+H)}c.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==c.prototype},c.compare=function(V,Q){if(me(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),me(Q,Uint8Array)&&(Q=c.from(Q,Q.offset,Q.byteLength)),!c.isBuffer(V)||!c.isBuffer(Q))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===Q)return 0;let ee=V.length,ae=Q.length;for(let be=0,le=Math.min(ee,ae);be<le;++be)if(V[be]!==Q[be]){ee=V[be],ae=Q[be];break}return ee<ae?-1:ae<ee?1:0},c.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(V,Q){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return c.alloc(0);let ee;if(Q===void 0)for(Q=0,ee=0;ee<V.length;++ee)Q+=V[ee].length;const ae=c.allocUnsafe(Q);let be=0;for(ee=0;ee<V.length;++ee){let le=V[ee];if(me(le,Uint8Array))be+le.length>ae.length?(c.isBuffer(le)||(le=c.from(le)),le.copy(ae,be)):Uint8Array.prototype.set.call(ae,le,be);else if(c.isBuffer(le))le.copy(ae,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=le.length}return ae};function A(H,V){if(c.isBuffer(H))return H.length;if(ArrayBuffer.isView(H)||me(H,ArrayBuffer))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);const Q=H.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&Q===0)return 0;let ae=!1;for(;;)switch(V){case"ascii":case"latin1":case"binary":return Q;case"utf8":case"utf-8":return ie(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q*2;case"hex":return Q>>>1;case"base64":return he(H).length;default:if(ae)return ee?-1:ie(H).length;V=(""+V).toLowerCase(),ae=!0}}c.byteLength=A;function R(H,V,Q){let ee=!1;if((V===void 0||V<0)&&(V=0),V>this.length||((Q===void 0||Q>this.length)&&(Q=this.length),Q<=0)||(Q>>>=0,V>>>=0,Q<=V))return"";for(H||(H="utf8");;)switch(H){case"hex":return Y(this,V,Q);case"utf8":case"utf-8":return q(this,V,Q);case"ascii":return G(this,V,Q);case"latin1":case"binary":return X(this,V,Q);case"base64":return C(this,V,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,V,Q);default:if(ee)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),ee=!0}}c.prototype._isBuffer=!0;function E(H,V,Q){const ee=H[V];H[V]=H[Q],H[Q]=ee}c.prototype.swap16=function(){const V=this.length;if(V%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Q=0;Q<V;Q+=2)E(this,Q,Q+1);return this},c.prototype.swap32=function(){const V=this.length;if(V%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Q=0;Q<V;Q+=4)E(this,Q,Q+3),E(this,Q+1,Q+2);return this},c.prototype.swap64=function(){const V=this.length;if(V%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Q=0;Q<V;Q+=8)E(this,Q,Q+7),E(this,Q+1,Q+6),E(this,Q+2,Q+5),E(this,Q+3,Q+4);return this},c.prototype.toString=function(){const V=this.length;return V===0?"":arguments.length===0?q(this,0,V):R.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(V){if(!c.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V?!0:c.compare(this,V)===0},c.prototype.inspect=function(){let V="";const Q=n.INSPECT_MAX_BYTES;return V=this.toString("hex",0,Q).replace(/(.{2})/g,"$1 ").trim(),this.length>Q&&(V+=" ... "),"<Buffer "+V+">"},a&&(c.prototype[a]=c.prototype.inspect),c.prototype.compare=function(V,Q,ee,ae,be){if(me(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),!c.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(Q===void 0&&(Q=0),ee===void 0&&(ee=V?V.length:0),ae===void 0&&(ae=0),be===void 0&&(be=this.length),Q<0||ee>V.length||ae<0||be>this.length)throw new RangeError("out of range index");if(ae>=be&&Q>=ee)return 0;if(ae>=be)return-1;if(Q>=ee)return 1;if(Q>>>=0,ee>>>=0,ae>>>=0,be>>>=0,this===V)return 0;let le=be-ae,we=ee-Q;const De=Math.min(le,we),Fe=this.slice(ae,be),Ne=V.slice(Q,ee);for(let de=0;de<De;++de)if(Fe[de]!==Ne[de]){le=Fe[de],we=Ne[de];break}return le<we?-1:we<le?1:0};function I(H,V,Q,ee,ae){if(H.length===0)return-1;if(typeof Q=="string"?(ee=Q,Q=0):Q>2147483647?Q=2147483647:Q<-2147483648&&(Q=-2147483648),Q=+Q,Ie(Q)&&(Q=ae?0:H.length-1),Q<0&&(Q=H.length+Q),Q>=H.length){if(ae)return-1;Q=H.length-1}else if(Q<0)if(ae)Q=0;else return-1;if(typeof V=="string"&&(V=c.from(V,ee)),c.isBuffer(V))return V.length===0?-1:L(H,V,Q,ee,ae);if(typeof V=="number")return V=V&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(H,V,Q):Uint8Array.prototype.lastIndexOf.call(H,V,Q):L(H,[V],Q,ee,ae);throw new TypeError("val must be string, number or Buffer")}function L(H,V,Q,ee,ae){let be=1,le=H.length,we=V.length;if(ee!==void 0&&(ee=String(ee).toLowerCase(),ee==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(H.length<2||V.length<2)return-1;be=2,le/=2,we/=2,Q/=2}function De(Ne,de){return be===1?Ne[de]:Ne.readUInt16BE(de*be)}let Fe;if(ae){let Ne=-1;for(Fe=Q;Fe<le;Fe++)if(De(H,Fe)===De(V,Ne===-1?0:Fe-Ne)){if(Ne===-1&&(Ne=Fe),Fe-Ne+1===we)return Ne*be}else Ne!==-1&&(Fe-=Fe-Ne),Ne=-1}else for(Q+we>le&&(Q=le-we),Fe=Q;Fe>=0;Fe--){let Ne=!0;for(let de=0;de<we;de++)if(De(H,Fe+de)!==De(V,de)){Ne=!1;break}if(Ne)return Fe}return-1}c.prototype.includes=function(V,Q,ee){return this.indexOf(V,Q,ee)!==-1},c.prototype.indexOf=function(V,Q,ee){return I(this,V,Q,ee,!0)},c.prototype.lastIndexOf=function(V,Q,ee){return I(this,V,Q,ee,!1)};function F(H,V,Q,ee){Q=Number(Q)||0;const ae=H.length-Q;ee?(ee=Number(ee),ee>ae&&(ee=ae)):ee=ae;const be=V.length;ee>be/2&&(ee=be/2);let le;for(le=0;le<ee;++le){const we=parseInt(V.substr(le*2,2),16);if(Ie(we))return le;H[Q+le]=we}return le}function D(H,V,Q,ee){return xe(ie(V,H.length-Q),H,Q,ee)}function $(H,V,Q,ee){return xe(se(V),H,Q,ee)}function O(H,V,Q,ee){return xe(he(V),H,Q,ee)}function P(H,V,Q,ee){return xe(ne(V,H.length-Q),H,Q,ee)}c.prototype.write=function(V,Q,ee,ae){if(Q===void 0)ae="utf8",ee=this.length,Q=0;else if(ee===void 0&&typeof Q=="string")ae=Q,ee=this.length,Q=0;else if(isFinite(Q))Q=Q>>>0,isFinite(ee)?(ee=ee>>>0,ae===void 0&&(ae="utf8")):(ae=ee,ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const be=this.length-Q;if((ee===void 0||ee>be)&&(ee=be),V.length>0&&(ee<0||Q<0)||Q>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");let le=!1;for(;;)switch(ae){case"hex":return F(this,V,Q,ee);case"utf8":case"utf-8":return D(this,V,Q,ee);case"ascii":case"latin1":case"binary":return $(this,V,Q,ee);case"base64":return O(this,V,Q,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,V,Q,ee);default:if(le)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),le=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(H,V,Q){return V===0&&Q===H.length?t.fromByteArray(H):t.fromByteArray(H.slice(V,Q))}function q(H,V,Q){Q=Math.min(H.length,Q);const ee=[];let ae=V;for(;ae<Q;){const be=H[ae];let le=null,we=be>239?4:be>223?3:be>191?2:1;if(ae+we<=Q){let De,Fe,Ne,de;switch(we){case 1:be<128&&(le=be);break;case 2:De=H[ae+1],(De&192)===128&&(de=(be&31)<<6|De&63,de>127&&(le=de));break;case 3:De=H[ae+1],Fe=H[ae+2],(De&192)===128&&(Fe&192)===128&&(de=(be&15)<<12|(De&63)<<6|Fe&63,de>2047&&(de<55296||de>57343)&&(le=de));break;case 4:De=H[ae+1],Fe=H[ae+2],Ne=H[ae+3],(De&192)===128&&(Fe&192)===128&&(Ne&192)===128&&(de=(be&15)<<18|(De&63)<<12|(Fe&63)<<6|Ne&63,de>65535&&de<1114112&&(le=de))}}le===null?(le=65533,we=1):le>65535&&(le-=65536,ee.push(le>>>10&1023|55296),le=56320|le&1023),ee.push(le),ae+=we}return N(ee)}const M=4096;function N(H){const V=H.length;if(V<=M)return String.fromCharCode.apply(String,H);let Q="",ee=0;for(;ee<V;)Q+=String.fromCharCode.apply(String,H.slice(ee,ee+=M));return Q}function G(H,V,Q){let ee="";Q=Math.min(H.length,Q);for(let ae=V;ae<Q;++ae)ee+=String.fromCharCode(H[ae]&127);return ee}function X(H,V,Q){let ee="";Q=Math.min(H.length,Q);for(let ae=V;ae<Q;++ae)ee+=String.fromCharCode(H[ae]);return ee}function Y(H,V,Q){const ee=H.length;(!V||V<0)&&(V=0),(!Q||Q<0||Q>ee)&&(Q=ee);let ae="";for(let be=V;be<Q;++be)ae+=Pe[H[be]];return ae}function W(H,V,Q){const ee=H.slice(V,Q);let ae="";for(let be=0;be<ee.length-1;be+=2)ae+=String.fromCharCode(ee[be]+ee[be+1]*256);return ae}c.prototype.slice=function(V,Q){const ee=this.length;V=~~V,Q=Q===void 0?ee:~~Q,V<0?(V+=ee,V<0&&(V=0)):V>ee&&(V=ee),Q<0?(Q+=ee,Q<0&&(Q=0)):Q>ee&&(Q=ee),Q<V&&(Q=V);const ae=this.subarray(V,Q);return Object.setPrototypeOf(ae,c.prototype),ae};function te(H,V,Q){if(H%1!==0||H<0)throw new RangeError("offset is not uint");if(H+V>Q)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUintLE=c.prototype.readUIntLE=function(V,Q,ee){V=V>>>0,Q=Q>>>0,ee||te(V,Q,this.length);let ae=this[V],be=1,le=0;for(;++le<Q&&(be*=256);)ae+=this[V+le]*be;return ae},c.prototype.readUintBE=c.prototype.readUIntBE=function(V,Q,ee){V=V>>>0,Q=Q>>>0,ee||te(V,Q,this.length);let ae=this[V+--Q],be=1;for(;Q>0&&(be*=256);)ae+=this[V+--Q]*be;return ae},c.prototype.readUint8=c.prototype.readUInt8=function(V,Q){return V=V>>>0,Q||te(V,1,this.length),this[V]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(V,Q){return V=V>>>0,Q||te(V,2,this.length),this[V]|this[V+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(V,Q){return V=V>>>0,Q||te(V,2,this.length),this[V]<<8|this[V+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+this[V+3]*16777216},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),this[V]*16777216+(this[V+1]<<16|this[V+2]<<8|this[V+3])},c.prototype.readBigUInt64LE=Ce(function(V){V=V>>>0,B(V,"offset");const Q=this[V],ee=this[V+7];(Q===void 0||ee===void 0)&&U(V,this.length-8);const ae=Q+this[++V]*2**8+this[++V]*2**16+this[++V]*2**24,be=this[++V]+this[++V]*2**8+this[++V]*2**16+ee*2**24;return BigInt(ae)+(BigInt(be)<<BigInt(32))}),c.prototype.readBigUInt64BE=Ce(function(V){V=V>>>0,B(V,"offset");const Q=this[V],ee=this[V+7];(Q===void 0||ee===void 0)&&U(V,this.length-8);const ae=Q*2**24+this[++V]*2**16+this[++V]*2**8+this[++V],be=this[++V]*2**24+this[++V]*2**16+this[++V]*2**8+ee;return(BigInt(ae)<<BigInt(32))+BigInt(be)}),c.prototype.readIntLE=function(V,Q,ee){V=V>>>0,Q=Q>>>0,ee||te(V,Q,this.length);let ae=this[V],be=1,le=0;for(;++le<Q&&(be*=256);)ae+=this[V+le]*be;return be*=128,ae>=be&&(ae-=Math.pow(2,8*Q)),ae},c.prototype.readIntBE=function(V,Q,ee){V=V>>>0,Q=Q>>>0,ee||te(V,Q,this.length);let ae=Q,be=1,le=this[V+--ae];for(;ae>0&&(be*=256);)le+=this[V+--ae]*be;return be*=128,le>=be&&(le-=Math.pow(2,8*Q)),le},c.prototype.readInt8=function(V,Q){return V=V>>>0,Q||te(V,1,this.length),this[V]&128?(255-this[V]+1)*-1:this[V]},c.prototype.readInt16LE=function(V,Q){V=V>>>0,Q||te(V,2,this.length);const ee=this[V]|this[V+1]<<8;return ee&32768?ee|4294901760:ee},c.prototype.readInt16BE=function(V,Q){V=V>>>0,Q||te(V,2,this.length);const ee=this[V+1]|this[V]<<8;return ee&32768?ee|4294901760:ee},c.prototype.readInt32LE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},c.prototype.readInt32BE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},c.prototype.readBigInt64LE=Ce(function(V){V=V>>>0,B(V,"offset");const Q=this[V],ee=this[V+7];(Q===void 0||ee===void 0)&&U(V,this.length-8);const ae=this[V+4]+this[V+5]*2**8+this[V+6]*2**16+(ee<<24);return(BigInt(ae)<<BigInt(32))+BigInt(Q+this[++V]*2**8+this[++V]*2**16+this[++V]*2**24)}),c.prototype.readBigInt64BE=Ce(function(V){V=V>>>0,B(V,"offset");const Q=this[V],ee=this[V+7];(Q===void 0||ee===void 0)&&U(V,this.length-8);const ae=(Q<<24)+this[++V]*2**16+this[++V]*2**8+this[++V];return(BigInt(ae)<<BigInt(32))+BigInt(this[++V]*2**24+this[++V]*2**16+this[++V]*2**8+ee)}),c.prototype.readFloatLE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),r.read(this,V,!0,23,4)},c.prototype.readFloatBE=function(V,Q){return V=V>>>0,Q||te(V,4,this.length),r.read(this,V,!1,23,4)},c.prototype.readDoubleLE=function(V,Q){return V=V>>>0,Q||te(V,8,this.length),r.read(this,V,!0,52,8)},c.prototype.readDoubleBE=function(V,Q){return V=V>>>0,Q||te(V,8,this.length),r.read(this,V,!1,52,8)};function ue(H,V,Q,ee,ae,be){if(!c.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(V>ae||V<be)throw new RangeError('"value" argument is out of bounds');if(Q+ee>H.length)throw new RangeError("Index out of range")}c.prototype.writeUintLE=c.prototype.writeUIntLE=function(V,Q,ee,ae){if(V=+V,Q=Q>>>0,ee=ee>>>0,!ae){const we=Math.pow(2,8*ee)-1;ue(this,V,Q,ee,we,0)}let be=1,le=0;for(this[Q]=V&255;++le<ee&&(be*=256);)this[Q+le]=V/be&255;return Q+ee},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(V,Q,ee,ae){if(V=+V,Q=Q>>>0,ee=ee>>>0,!ae){const we=Math.pow(2,8*ee)-1;ue(this,V,Q,ee,we,0)}let be=ee-1,le=1;for(this[Q+be]=V&255;--be>=0&&(le*=256);)this[Q+be]=V/le&255;return Q+ee},c.prototype.writeUint8=c.prototype.writeUInt8=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,1,255,0),this[Q]=V&255,Q+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,2,65535,0),this[Q]=V&255,this[Q+1]=V>>>8,Q+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,2,65535,0),this[Q]=V>>>8,this[Q+1]=V&255,Q+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,4,4294967295,0),this[Q+3]=V>>>24,this[Q+2]=V>>>16,this[Q+1]=V>>>8,this[Q]=V&255,Q+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,4,4294967295,0),this[Q]=V>>>24,this[Q+1]=V>>>16,this[Q+2]=V>>>8,this[Q+3]=V&255,Q+4};function fe(H,V,Q,ee,ae){z(V,ee,ae,H,Q,7);let be=Number(V&BigInt(4294967295));H[Q++]=be,be=be>>8,H[Q++]=be,be=be>>8,H[Q++]=be,be=be>>8,H[Q++]=be;let le=Number(V>>BigInt(32)&BigInt(4294967295));return H[Q++]=le,le=le>>8,H[Q++]=le,le=le>>8,H[Q++]=le,le=le>>8,H[Q++]=le,Q}function re(H,V,Q,ee,ae){z(V,ee,ae,H,Q,7);let be=Number(V&BigInt(4294967295));H[Q+7]=be,be=be>>8,H[Q+6]=be,be=be>>8,H[Q+5]=be,be=be>>8,H[Q+4]=be;let le=Number(V>>BigInt(32)&BigInt(4294967295));return H[Q+3]=le,le=le>>8,H[Q+2]=le,le=le>>8,H[Q+1]=le,le=le>>8,H[Q]=le,Q+8}c.prototype.writeBigUInt64LE=Ce(function(V,Q=0){return fe(this,V,Q,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=Ce(function(V,Q=0){return re(this,V,Q,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(V,Q,ee,ae){if(V=+V,Q=Q>>>0,!ae){const De=Math.pow(2,8*ee-1);ue(this,V,Q,ee,De-1,-De)}let be=0,le=1,we=0;for(this[Q]=V&255;++be<ee&&(le*=256);)V<0&&we===0&&this[Q+be-1]!==0&&(we=1),this[Q+be]=(V/le>>0)-we&255;return Q+ee},c.prototype.writeIntBE=function(V,Q,ee,ae){if(V=+V,Q=Q>>>0,!ae){const De=Math.pow(2,8*ee-1);ue(this,V,Q,ee,De-1,-De)}let be=ee-1,le=1,we=0;for(this[Q+be]=V&255;--be>=0&&(le*=256);)V<0&&we===0&&this[Q+be+1]!==0&&(we=1),this[Q+be]=(V/le>>0)-we&255;return Q+ee},c.prototype.writeInt8=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,1,127,-128),V<0&&(V=255+V+1),this[Q]=V&255,Q+1},c.prototype.writeInt16LE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,2,32767,-32768),this[Q]=V&255,this[Q+1]=V>>>8,Q+2},c.prototype.writeInt16BE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,2,32767,-32768),this[Q]=V>>>8,this[Q+1]=V&255,Q+2},c.prototype.writeInt32LE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,4,2147483647,-2147483648),this[Q]=V&255,this[Q+1]=V>>>8,this[Q+2]=V>>>16,this[Q+3]=V>>>24,Q+4},c.prototype.writeInt32BE=function(V,Q,ee){return V=+V,Q=Q>>>0,ee||ue(this,V,Q,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[Q]=V>>>24,this[Q+1]=V>>>16,this[Q+2]=V>>>8,this[Q+3]=V&255,Q+4},c.prototype.writeBigInt64LE=Ce(function(V,Q=0){return fe(this,V,Q,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=Ce(function(V,Q=0){return re(this,V,Q,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ye(H,V,Q,ee,ae,be){if(Q+ee>H.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("Index out of range")}function Te(H,V,Q,ee,ae){return V=+V,Q=Q>>>0,ae||ye(H,V,Q,4),r.write(H,V,Q,ee,23,4),Q+4}c.prototype.writeFloatLE=function(V,Q,ee){return Te(this,V,Q,!0,ee)},c.prototype.writeFloatBE=function(V,Q,ee){return Te(this,V,Q,!1,ee)};function Re(H,V,Q,ee,ae){return V=+V,Q=Q>>>0,ae||ye(H,V,Q,8),r.write(H,V,Q,ee,52,8),Q+8}c.prototype.writeDoubleLE=function(V,Q,ee){return Re(this,V,Q,!0,ee)},c.prototype.writeDoubleBE=function(V,Q,ee){return Re(this,V,Q,!1,ee)},c.prototype.copy=function(V,Q,ee,ae){if(!c.isBuffer(V))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),!ae&&ae!==0&&(ae=this.length),Q>=V.length&&(Q=V.length),Q||(Q=0),ae>0&&ae<ee&&(ae=ee),ae===ee||V.length===0||this.length===0)return 0;if(Q<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),V.length-Q<ae-ee&&(ae=V.length-Q+ee);const be=ae-ee;return this===V&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Q,ee,ae):Uint8Array.prototype.set.call(V,this.subarray(ee,ae),Q),be},c.prototype.fill=function(V,Q,ee,ae){if(typeof V=="string"){if(typeof Q=="string"?(ae=Q,Q=0,ee=this.length):typeof ee=="string"&&(ae=ee,ee=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!c.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(V.length===1){const le=V.charCodeAt(0);(ae==="utf8"&&le<128||ae==="latin1")&&(V=le)}}else typeof V=="number"?V=V&255:typeof V=="boolean"&&(V=Number(V));if(Q<0||this.length<Q||this.length<ee)throw new RangeError("Out of range index");if(ee<=Q)return this;Q=Q>>>0,ee=ee===void 0?this.length:ee>>>0,V||(V=0);let be;if(typeof V=="number")for(be=Q;be<ee;++be)this[be]=V;else{const le=c.isBuffer(V)?V:c.from(V,ae),we=le.length;if(we===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(be=0;be<ee-Q;++be)this[be+Q]=le[be%we]}return this};const ve={};function ce(H,V,Q){ve[H]=class extends Q{constructor(){super(),Object.defineProperty(this,"message",{value:V.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${H}]`,this.stack,delete this.name}get code(){return H}set code(ae){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ae,writable:!0})}toString(){return`${this.name} [${H}]: ${this.message}`}}}ce("ERR_BUFFER_OUT_OF_BOUNDS",function(H){return H?`${H} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ce("ERR_INVALID_ARG_TYPE",function(H,V){return`The "${H}" argument must be of type number. Received type ${typeof V}`},TypeError),ce("ERR_OUT_OF_RANGE",function(H,V,Q){let ee=`The value of "${H}" is out of range.`,ae=Q;return Number.isInteger(Q)&&Math.abs(Q)>2**32?ae=J(String(Q)):typeof Q=="bigint"&&(ae=String(Q),(Q>BigInt(2)**BigInt(32)||Q<-(BigInt(2)**BigInt(32)))&&(ae=J(ae)),ae+="n"),ee+=` It must be ${V}. Received ${ae}`,ee},RangeError);function J(H){let V="",Q=H.length;const ee=H[0]==="-"?1:0;for(;Q>=ee+4;Q-=3)V=`_${H.slice(Q-3,Q)}${V}`;return`${H.slice(0,Q)}${V}`}function j(H,V,Q){B(V,"offset"),(H[V]===void 0||H[V+Q]===void 0)&&U(V,H.length-(Q+1))}function z(H,V,Q,ee,ae,be){if(H>Q||H<V){const le=typeof V=="bigint"?"n":"";let we;throw V===0||V===BigInt(0)?we=`>= 0${le} and < 2${le} ** ${(be+1)*8}${le}`:we=`>= -(2${le} ** ${(be+1)*8-1}${le}) and < 2 ** ${(be+1)*8-1}${le}`,new ve.ERR_OUT_OF_RANGE("value",we,H)}j(ee,ae,be)}function B(H,V){if(typeof H!="number")throw new ve.ERR_INVALID_ARG_TYPE(V,"number",H)}function U(H,V,Q){throw Math.floor(H)!==H?(B(H,Q),new ve.ERR_OUT_OF_RANGE("offset","an integer",H)):V<0?new ve.ERR_BUFFER_OUT_OF_BOUNDS:new ve.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${V}`,H)}const Z=/[^+/0-9A-Za-z-_]/g;function oe(H){if(H=H.split("=")[0],H=H.trim().replace(Z,""),H.length<2)return"";for(;H.length%4!==0;)H=H+"=";return H}function ie(H,V){V=V||1/0;let Q;const ee=H.length;let ae=null;const be=[];for(let le=0;le<ee;++le){if(Q=H.charCodeAt(le),Q>55295&&Q<57344){if(!ae){if(Q>56319){(V-=3)>-1&&be.push(239,191,189);continue}else if(le+1===ee){(V-=3)>-1&&be.push(239,191,189);continue}ae=Q;continue}if(Q<56320){(V-=3)>-1&&be.push(239,191,189),ae=Q;continue}Q=(ae-55296<<10|Q-56320)+65536}else ae&&(V-=3)>-1&&be.push(239,191,189);if(ae=null,Q<128){if((V-=1)<0)break;be.push(Q)}else if(Q<2048){if((V-=2)<0)break;be.push(Q>>6|192,Q&63|128)}else if(Q<65536){if((V-=3)<0)break;be.push(Q>>12|224,Q>>6&63|128,Q&63|128)}else if(Q<1114112){if((V-=4)<0)break;be.push(Q>>18|240,Q>>12&63|128,Q>>6&63|128,Q&63|128)}else throw new Error("Invalid code point")}return be}function se(H){const V=[];for(let Q=0;Q<H.length;++Q)V.push(H.charCodeAt(Q)&255);return V}function ne(H,V){let Q,ee,ae;const be=[];for(let le=0;le<H.length&&!((V-=2)<0);++le)Q=H.charCodeAt(le),ee=Q>>8,ae=Q%256,be.push(ae),be.push(ee);return be}function he(H){return t.toByteArray(oe(H))}function xe(H,V,Q,ee){let ae;for(ae=0;ae<ee&&!(ae+Q>=V.length||ae>=H.length);++ae)V[ae+Q]=H[ae];return ae}function me(H,V){return H instanceof V||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===V.name}function Ie(H){return H!==H}const Pe=function(){const H="0123456789abcdef",V=new Array(256);for(let Q=0;Q<16;++Q){const ee=Q*16;for(let ae=0;ae<16;++ae)V[ee+ae]=H[Q]+H[ae]}return V}();function Ce(H){return typeof BigInt>"u"?pe:H}function pe(){throw new Error("BigInt not supported")}}(buffer)),buffer}var primordials,hasRequiredPrimordials;function requirePrimordials(){if(hasRequiredPrimordials)return primordials;hasRequiredPrimordials=1;class n extends Error{constructor(r){if(!Array.isArray(r))throw new TypeError(`Expected input to be an Array, got ${typeof r}`);let a="";for(let o=0;o<r.length;o++)a+=`    ${r[o].stack}
`;super(a),this.name="AggregateError",this.errors=r}}return primordials={AggregateError:n,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,r){return t.includes(r)},ArrayPrototypeIndexOf(t,r){return t.indexOf(r)},ArrayPrototypeJoin(t,r){return t.join(r)},ArrayPrototypeMap(t,r){return t.map(r)},ArrayPrototypePop(t,r){return t.pop(r)},ArrayPrototypePush(t,r){return t.push(r)},ArrayPrototypeSlice(t,r,a){return t.slice(r,a)},Error,FunctionPrototypeCall(t,r,...a){return t.call(r,...a)},FunctionPrototypeSymbolHasInstance(t,r){return Function.prototype[Symbol.hasInstance].call(t,r)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,r){return Object.defineProperties(t,r)},ObjectDefineProperty(t,r,a){return Object.defineProperty(t,r,a)},ObjectGetOwnPropertyDescriptor(t,r){return Object.getOwnPropertyDescriptor(t,r)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,r){return Object.setPrototypeOf(t,r)},Promise,PromisePrototypeCatch(t,r){return t.catch(r)},PromisePrototypeThen(t,r,a){return t.then(r,a)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,r){return t.test(r)},SafeSet:Set,String,StringPrototypeSlice(t,r,a){return t.slice(r,a)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,r,a){return t.set(r,a)},Boolean,Uint8Array},primordials}var util={exports:{}},inspect,hasRequiredInspect;function requireInspect(){return hasRequiredInspect||(hasRequiredInspect=1,inspect={format(n,...t){return n.replace(/%([sdifj])/g,function(...[r,a]){const o=t.shift();return a==="f"?o.toFixed(6):a==="j"?JSON.stringify(o):a==="s"&&typeof o=="object"?`${o.constructor!==Object?o.constructor.name:""} {}`.trim():o.toString()})},inspect(n){switch(typeof n){case"string":if(n.includes("'"))if(n.includes('"')){if(!n.includes("`")&&!n.includes("${"))return`\`${n}\``}else return`"${n}"`;return`'${n}'`;case"number":return isNaN(n)?"NaN":Object.is(n,-0)?String(n):n;case"bigint":return`${String(n)}n`;case"boolean":case"undefined":return String(n);case"object":return"{}"}}}),inspect}var errors,hasRequiredErrors;function requireErrors(){if(hasRequiredErrors)return errors;hasRequiredErrors=1;const{format:n,inspect:t}=requireInspect(),{AggregateError:r}=requirePrimordials(),a=globalThis.AggregateError||r,o=Symbol("kIsNodeError"),u=["string","function","number","object","Function","Object","boolean","bigint","symbol"],s=/^([A-Z][a-z0-9]*)+$/,c="__node_internal_",l={};function d(S,T){if(!S)throw new l.ERR_INTERNAL_ASSERTION(T)}function f(S){let T="",w=S.length;const A=S[0]==="-"?1:0;for(;w>=A+4;w-=3)T=`_${S.slice(w-3,w)}${T}`;return`${S.slice(0,w)}${T}`}function h(S,T,w){if(typeof T=="function")return d(T.length<=w.length,`Code: ${S}; The provided arguments length (${w.length}) does not match the required ones (${T.length}).`),T(...w);const A=(T.match(/%[dfijoOs]/g)||[]).length;return d(A===w.length,`Code: ${S}; The provided arguments length (${w.length}) does not match the required ones (${A}).`),w.length===0?T:n(T,...w)}function v(S,T,w){w||(w=Error);class A extends w{constructor(...E){super(h(S,T,E))}toString(){return`${this.name} [${S}]: ${this.message}`}}Object.defineProperties(A.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${S}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),A.prototype.code=S,A.prototype[o]=!0,l[S]=A}function g(S){const T=c+S.name;return Object.defineProperty(S,"name",{value:T}),S}function b(S,T){if(S&&T&&S!==T){if(Array.isArray(T.errors))return T.errors.push(S),T;const w=new a([T,S],T.message);return w.code=T.code,w}return S||T}class _ extends Error{constructor(T="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(T,w),this.code="ABORT_ERR",this.name="AbortError"}}return v("ERR_ASSERTION","%s",Error),v("ERR_INVALID_ARG_TYPE",(S,T,w)=>{d(typeof S=="string","'name' must be a string"),Array.isArray(T)||(T=[T]);let A="The ";S.endsWith(" argument")?A+=`${S} `:A+=`"${S}" ${S.includes(".")?"property":"argument"} `,A+="must be ";const R=[],E=[],I=[];for(const F of T)d(typeof F=="string","All expected entries have to be of type string"),u.includes(F)?R.push(F.toLowerCase()):s.test(F)?E.push(F):(d(F!=="object",'The value "object" should be written as "Object"'),I.push(F));if(E.length>0){const F=R.indexOf("object");F!==-1&&(R.splice(R,F,1),E.push("Object"))}if(R.length>0){switch(R.length){case 1:A+=`of type ${R[0]}`;break;case 2:A+=`one of type ${R[0]} or ${R[1]}`;break;default:{const F=R.pop();A+=`one of type ${R.join(", ")}, or ${F}`}}(E.length>0||I.length>0)&&(A+=" or ")}if(E.length>0){switch(E.length){case 1:A+=`an instance of ${E[0]}`;break;case 2:A+=`an instance of ${E[0]} or ${E[1]}`;break;default:{const F=E.pop();A+=`an instance of ${E.join(", ")}, or ${F}`}}I.length>0&&(A+=" or ")}switch(I.length){case 0:break;case 1:I[0].toLowerCase()!==I[0]&&(A+="an "),A+=`${I[0]}`;break;case 2:A+=`one of ${I[0]} or ${I[1]}`;break;default:{const F=I.pop();A+=`one of ${I.join(", ")}, or ${F}`}}if(w==null)A+=`. Received ${w}`;else if(typeof w=="function"&&w.name)A+=`. Received function ${w.name}`;else if(typeof w=="object"){var L;if((L=w.constructor)!==null&&L!==void 0&&L.name)A+=`. Received an instance of ${w.constructor.name}`;else{const F=t(w,{depth:-1});A+=`. Received ${F}`}}else{let F=t(w,{colors:!1});F.length>25&&(F=`${F.slice(0,25)}...`),A+=`. Received type ${typeof w} (${F})`}return A},TypeError),v("ERR_INVALID_ARG_VALUE",(S,T,w="is invalid")=>{let A=t(T);return A.length>128&&(A=A.slice(0,128)+"..."),`The ${S.includes(".")?"property":"argument"} '${S}' ${w}. Received ${A}`},TypeError),v("ERR_INVALID_RETURN_VALUE",(S,T,w)=>{var A;const R=w!=null&&(A=w.constructor)!==null&&A!==void 0&&A.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${S} to be returned from the "${T}" function but got ${R}.`},TypeError),v("ERR_MISSING_ARGS",(...S)=>{d(S.length>0,"At least one arg needs to be specified");let T;const w=S.length;switch(S=(Array.isArray(S)?S:[S]).map(A=>`"${A}"`).join(" or "),w){case 1:T+=`The ${S[0]} argument`;break;case 2:T+=`The ${S[0]} and ${S[1]} arguments`;break;default:{const A=S.pop();T+=`The ${S.join(", ")}, and ${A} arguments`}break}return`${T} must be specified`},TypeError),v("ERR_OUT_OF_RANGE",(S,T,w)=>{d(T,'Missing "range" argument');let A;if(Number.isInteger(w)&&Math.abs(w)>2**32)A=f(String(w));else if(typeof w=="bigint"){A=String(w);const R=BigInt(2)**BigInt(32);(w>R||w<-R)&&(A=f(A)),A+="n"}else A=t(w);return`The value of "${S}" is out of range. It must be ${T}. Received ${A}`},RangeError),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),v("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),v("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),v("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),v("ERR_STREAM_WRITE_AFTER_END","write after end",Error),v("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),errors={AbortError:_,aggregateTwoErrors:g(b),hideStackFrames:g,codes:l},errors}var browser={exports:{}},hasRequiredBrowser$1;function requireBrowser$1(){if(hasRequiredBrowser$1)return browser.exports;hasRequiredBrowser$1=1;const{AbortController:n,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser.exports=n,browser.exports.AbortSignal=t,browser.exports.default=n,browser.exports}var hasRequiredUtil$7;function requireUtil$7(){return hasRequiredUtil$7||(hasRequiredUtil$7=1,function(n){const t=requireBuffer(),{format:r,inspect:a}=requireInspect(),{codes:{ERR_INVALID_ARG_TYPE:o}}=requireErrors(),{kResistStopPropagation:u,AggregateError:s,SymbolDispose:c}=requirePrimordials(),l=globalThis.AbortSignal||requireBrowser$1().AbortSignal,d=globalThis.AbortController||requireBrowser$1().AbortController,f=Object.getPrototypeOf(async function(){}).constructor,h=globalThis.Blob||t.Blob,v=typeof h<"u"?function(S){return S instanceof h}:function(S){return!1},g=(_,S)=>{if(_!==void 0&&(_===null||typeof _!="object"||!("aborted"in _)))throw new o(S,"AbortSignal",_)},b=(_,S)=>{if(typeof _!="function")throw new o(S,"Function",_)};n.exports={AggregateError:s,kEmptyObject:Object.freeze({}),once(_){let S=!1;return function(...T){S||(S=!0,_.apply(this,T))}},createDeferredPromise:function(){let _,S;return{promise:new Promise((w,A)=>{_=w,S=A}),resolve:_,reject:S}},promisify(_){return new Promise((S,T)=>{_((w,...A)=>w?T(w):S(...A))})},debuglog(){return function(){}},format:r,inspect:a,types:{isAsyncFunction(_){return _ instanceof f},isArrayBufferView(_){return ArrayBuffer.isView(_)}},isBlob:v,deprecate(_,S){return _},addAbortListener:requireEvents().addAbortListener||function(S,T){if(S===void 0)throw new o("signal","AbortSignal",S);g(S,"signal"),b(T,"listener");let w;return S.aborted?queueMicrotask(()=>T()):(S.addEventListener("abort",T,{__proto__:null,once:!0,[u]:!0}),w=()=>{S.removeEventListener("abort",T)}),{__proto__:null,[c](){var A;(A=w)===null||A===void 0||A()}}},AbortSignalAny:l.any||function(S){if(S.length===1)return S[0];const T=new d,w=()=>T.abort();return S.forEach(A=>{g(A,"signals"),A.addEventListener("abort",w,{once:!0})}),T.signal.addEventListener("abort",()=>{S.forEach(A=>A.removeEventListener("abort",w))},{once:!0}),T.signal}},n.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(util)),util.exports}var operators={},validators,hasRequiredValidators;function requireValidators(){if(hasRequiredValidators)return validators;hasRequiredValidators=1;const{ArrayIsArray:n,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:r,ArrayPrototypeMap:a,NumberIsInteger:o,NumberIsNaN:u,NumberMAX_SAFE_INTEGER:s,NumberMIN_SAFE_INTEGER:c,NumberParseInt:l,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:f,String:h,StringPrototypeToUpperCase:v,StringPrototypeTrim:g}=requirePrimordials(),{hideStackFrames:b,codes:{ERR_SOCKET_BAD_PORT:_,ERR_INVALID_ARG_TYPE:S,ERR_INVALID_ARG_VALUE:T,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:A}}=requireErrors(),{normalizeEncoding:R}=requireUtil$7(),{isAsyncFunction:E,isArrayBufferView:I}=requireUtil$7().types,L={};function F(ne){return ne===(ne|0)}function D(ne){return ne===ne>>>0}const $=/^[0-7]+$/,O="must be a 32-bit unsigned integer or an octal string";function P(ne,he,xe){if(typeof ne>"u"&&(ne=xe),typeof ne=="string"){if(f($,ne)===null)throw new T(he,ne,O);ne=l(ne,8)}return M(ne,he),ne}const C=b((ne,he,xe=c,me=s)=>{if(typeof ne!="number")throw new S(he,"number",ne);if(!o(ne))throw new w(he,"an integer",ne);if(ne<xe||ne>me)throw new w(he,`>= ${xe} && <= ${me}`,ne)}),q=b((ne,he,xe=-2147483648,me=2147483647)=>{if(typeof ne!="number")throw new S(he,"number",ne);if(!o(ne))throw new w(he,"an integer",ne);if(ne<xe||ne>me)throw new w(he,`>= ${xe} && <= ${me}`,ne)}),M=b((ne,he,xe=!1)=>{if(typeof ne!="number")throw new S(he,"number",ne);if(!o(ne))throw new w(he,"an integer",ne);const me=xe?1:0,Ie=4294967295;if(ne<me||ne>Ie)throw new w(he,`>= ${me} && <= ${Ie}`,ne)});function N(ne,he){if(typeof ne!="string")throw new S(he,"string",ne)}function G(ne,he,xe=void 0,me){if(typeof ne!="number")throw new S(he,"number",ne);if(xe!=null&&ne<xe||me!=null&&ne>me||(xe!=null||me!=null)&&u(ne))throw new w(he,`${xe!=null?`>= ${xe}`:""}${xe!=null&&me!=null?" && ":""}${me!=null?`<= ${me}`:""}`,ne)}const X=b((ne,he,xe)=>{if(!t(xe,ne)){const Ie="must be one of: "+r(a(xe,Pe=>typeof Pe=="string"?`'${Pe}'`:h(Pe)),", ");throw new T(he,ne,Ie)}});function Y(ne,he){if(typeof ne!="boolean")throw new S(he,"boolean",ne)}function W(ne,he,xe){return ne==null||!d(ne,he)?xe:ne[he]}const te=b((ne,he,xe=null)=>{const me=W(xe,"allowArray",!1),Ie=W(xe,"allowFunction",!1);if(!W(xe,"nullable",!1)&&ne===null||!me&&n(ne)||typeof ne!="object"&&(!Ie||typeof ne!="function"))throw new S(he,"Object",ne)}),ue=b((ne,he)=>{if(ne!=null&&typeof ne!="object"&&typeof ne!="function")throw new S(he,"a dictionary",ne)}),fe=b((ne,he,xe=0)=>{if(!n(ne))throw new S(he,"Array",ne);if(ne.length<xe){const me=`must be longer than ${xe}`;throw new T(he,ne,me)}});function re(ne,he){fe(ne,he);for(let xe=0;xe<ne.length;xe++)N(ne[xe],`${he}[${xe}]`)}function ye(ne,he){fe(ne,he);for(let xe=0;xe<ne.length;xe++)Y(ne[xe],`${he}[${xe}]`)}function Te(ne,he){fe(ne,he);for(let xe=0;xe<ne.length;xe++){const me=ne[xe],Ie=`${he}[${xe}]`;if(me==null)throw new S(Ie,"AbortSignal",me);j(me,Ie)}}function Re(ne,he="signal"){if(N(ne,he),L[ne]===void 0)throw L[v(ne)]!==void 0?new A(ne+" (signals must use all capital letters)"):new A(ne)}const ve=b((ne,he="buffer")=>{if(!I(ne))throw new S(he,["Buffer","TypedArray","DataView"],ne)});function ce(ne,he){const xe=R(he),me=ne.length;if(xe==="hex"&&me%2!==0)throw new T("encoding",he,`is invalid for data of length ${me}`)}function J(ne,he="Port",xe=!0){if(typeof ne!="number"&&typeof ne!="string"||typeof ne=="string"&&g(ne).length===0||+ne!==+ne>>>0||ne>65535||ne===0&&!xe)throw new _(he,ne,xe);return ne|0}const j=b((ne,he)=>{if(ne!==void 0&&(ne===null||typeof ne!="object"||!("aborted"in ne)))throw new S(he,"AbortSignal",ne)}),z=b((ne,he)=>{if(typeof ne!="function")throw new S(he,"Function",ne)}),B=b((ne,he)=>{if(typeof ne!="function"||E(ne))throw new S(he,"Function",ne)}),U=b((ne,he)=>{if(ne!==void 0)throw new S(he,"undefined",ne)});function Z(ne,he,xe){if(!t(xe,ne))throw new S(he,`('${r(xe,"|")}')`,ne)}const oe=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ie(ne,he){if(typeof ne>"u"||!f(oe,ne))throw new T(he,ne,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function se(ne){if(typeof ne=="string")return ie(ne,"hints"),ne;if(n(ne)){const he=ne.length;let xe="";if(he===0)return xe;for(let me=0;me<he;me++){const Ie=ne[me];ie(Ie,"hints"),xe+=Ie,me!==he-1&&(xe+=", ")}return xe}throw new T("hints",ne,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return validators={isInt32:F,isUint32:D,parseFileMode:P,validateArray:fe,validateStringArray:re,validateBooleanArray:ye,validateAbortSignalArray:Te,validateBoolean:Y,validateBuffer:ve,validateDictionary:ue,validateEncoding:ce,validateFunction:z,validateInt32:q,validateInteger:C,validateNumber:G,validateObject:te,validateOneOf:X,validatePlainFunction:B,validatePort:J,validateSignalName:Re,validateString:N,validateUint32:M,validateUndefined:U,validateUnion:Z,validateAbortSignal:j,validateLinkHeaderValue:se},validators}var endOfStream={exports:{}},utils$3,hasRequiredUtils$4;function requireUtils$4(){if(hasRequiredUtils$4)return utils$3;hasRequiredUtils$4=1;const{SymbolAsyncIterator:n,SymbolIterator:t,SymbolFor:r}=requirePrimordials(),a=r("nodejs.stream.destroyed"),o=r("nodejs.stream.errored"),u=r("nodejs.stream.readable"),s=r("nodejs.stream.writable"),c=r("nodejs.stream.disturbed"),l=r("nodejs.webstream.isClosedPromise"),d=r("nodejs.webstream.controllerErrorFunction");function f(W,te=!1){var ue;return!!(W&&typeof W.pipe=="function"&&typeof W.on=="function"&&(!te||typeof W.pause=="function"&&typeof W.resume=="function")&&(!W._writableState||((ue=W._readableState)===null||ue===void 0?void 0:ue.readable)!==!1)&&(!W._writableState||W._readableState))}function h(W){var te;return!!(W&&typeof W.write=="function"&&typeof W.on=="function"&&(!W._readableState||((te=W._writableState)===null||te===void 0?void 0:te.writable)!==!1))}function v(W){return!!(W&&typeof W.pipe=="function"&&W._readableState&&typeof W.on=="function"&&typeof W.write=="function")}function g(W){return W&&(W._readableState||W._writableState||typeof W.write=="function"&&typeof W.on=="function"||typeof W.pipe=="function"&&typeof W.on=="function")}function b(W){return!!(W&&!g(W)&&typeof W.pipeThrough=="function"&&typeof W.getReader=="function"&&typeof W.cancel=="function")}function _(W){return!!(W&&!g(W)&&typeof W.getWriter=="function"&&typeof W.abort=="function")}function S(W){return!!(W&&!g(W)&&typeof W.readable=="object"&&typeof W.writable=="object")}function T(W){return b(W)||_(W)||S(W)}function w(W,te){return W==null?!1:te===!0?typeof W[n]=="function":te===!1?typeof W[t]=="function":typeof W[n]=="function"||typeof W[t]=="function"}function A(W){if(!g(W))return null;const te=W._writableState,ue=W._readableState,fe=te||ue;return!!(W.destroyed||W[a]||fe!=null&&fe.destroyed)}function R(W){if(!h(W))return null;if(W.writableEnded===!0)return!0;const te=W._writableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.ended)!="boolean"?null:te.ended}function E(W,te){if(!h(W))return null;if(W.writableFinished===!0)return!0;const ue=W._writableState;return ue!=null&&ue.errored?!1:typeof(ue==null?void 0:ue.finished)!="boolean"?null:!!(ue.finished||te===!1&&ue.ended===!0&&ue.length===0)}function I(W){if(!f(W))return null;if(W.readableEnded===!0)return!0;const te=W._readableState;return!te||te.errored?!1:typeof(te==null?void 0:te.ended)!="boolean"?null:te.ended}function L(W,te){if(!f(W))return null;const ue=W._readableState;return ue!=null&&ue.errored?!1:typeof(ue==null?void 0:ue.endEmitted)!="boolean"?null:!!(ue.endEmitted||te===!1&&ue.ended===!0&&ue.length===0)}function F(W){return W&&W[u]!=null?W[u]:typeof(W==null?void 0:W.readable)!="boolean"?null:A(W)?!1:f(W)&&W.readable&&!L(W)}function D(W){return W&&W[s]!=null?W[s]:typeof(W==null?void 0:W.writable)!="boolean"?null:A(W)?!1:h(W)&&W.writable&&!R(W)}function $(W,te){return g(W)?A(W)?!0:!((te==null?void 0:te.readable)!==!1&&F(W)||(te==null?void 0:te.writable)!==!1&&D(W)):null}function O(W){var te,ue;return g(W)?W.writableErrored?W.writableErrored:(te=(ue=W._writableState)===null||ue===void 0?void 0:ue.errored)!==null&&te!==void 0?te:null:null}function P(W){var te,ue;return g(W)?W.readableErrored?W.readableErrored:(te=(ue=W._readableState)===null||ue===void 0?void 0:ue.errored)!==null&&te!==void 0?te:null:null}function C(W){if(!g(W))return null;if(typeof W.closed=="boolean")return W.closed;const te=W._writableState,ue=W._readableState;return typeof(te==null?void 0:te.closed)=="boolean"||typeof(ue==null?void 0:ue.closed)=="boolean"?(te==null?void 0:te.closed)||(ue==null?void 0:ue.closed):typeof W._closed=="boolean"&&q(W)?W._closed:null}function q(W){return typeof W._closed=="boolean"&&typeof W._defaultKeepAlive=="boolean"&&typeof W._removedConnection=="boolean"&&typeof W._removedContLen=="boolean"}function M(W){return typeof W._sent100=="boolean"&&q(W)}function N(W){var te;return typeof W._consuming=="boolean"&&typeof W._dumped=="boolean"&&((te=W.req)===null||te===void 0?void 0:te.upgradeOrConnect)===void 0}function G(W){if(!g(W))return null;const te=W._writableState,ue=W._readableState,fe=te||ue;return!fe&&M(W)||!!(fe&&fe.autoDestroy&&fe.emitClose&&fe.closed===!1)}function X(W){var te;return!!(W&&((te=W[c])!==null&&te!==void 0?te:W.readableDidRead||W.readableAborted))}function Y(W){var te,ue,fe,re,ye,Te,Re,ve,ce,J;return!!(W&&((te=(ue=(fe=(re=(ye=(Te=W[o])!==null&&Te!==void 0?Te:W.readableErrored)!==null&&ye!==void 0?ye:W.writableErrored)!==null&&re!==void 0?re:(Re=W._readableState)===null||Re===void 0?void 0:Re.errorEmitted)!==null&&fe!==void 0?fe:(ve=W._writableState)===null||ve===void 0?void 0:ve.errorEmitted)!==null&&ue!==void 0?ue:(ce=W._readableState)===null||ce===void 0?void 0:ce.errored)!==null&&te!==void 0?te:!((J=W._writableState)===null||J===void 0)&&J.errored))}return utils$3={isDestroyed:A,kIsDestroyed:a,isDisturbed:X,kIsDisturbed:c,isErrored:Y,kIsErrored:o,isReadable:F,kIsReadable:u,kIsClosedPromise:l,kControllerErrorFunction:d,kIsWritable:s,isClosed:C,isDuplexNodeStream:v,isFinished:$,isIterable:w,isReadableNodeStream:f,isReadableStream:b,isReadableEnded:I,isReadableFinished:L,isReadableErrored:P,isNodeStream:g,isWebStream:T,isWritable:D,isWritableNodeStream:h,isWritableStream:_,isWritableEnded:R,isWritableFinished:E,isWritableErrored:O,isServerRequest:N,isServerResponse:M,willEmitClose:G,isTransformStream:S},utils$3}var hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream.exports;hasRequiredEndOfStream=1;const n=requireBrowser$2(),{AbortError:t,codes:r}=requireErrors(),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_PREMATURE_CLOSE:o}=r,{kEmptyObject:u,once:s}=requireUtil$7(),{validateAbortSignal:c,validateFunction:l,validateObject:d,validateBoolean:f}=requireValidators(),{Promise:h,PromisePrototypeThen:v,SymbolDispose:g}=requirePrimordials(),{isClosed:b,isReadable:_,isReadableNodeStream:S,isReadableStream:T,isReadableFinished:w,isReadableErrored:A,isWritable:R,isWritableNodeStream:E,isWritableStream:I,isWritableFinished:L,isWritableErrored:F,isNodeStream:D,willEmitClose:$,kIsClosedPromise:O}=requireUtils$4();let P;function C(X){return X.setHeader&&typeof X.abort=="function"}const q=()=>{};function M(X,Y,W){var te,ue;if(arguments.length===2?(W=Y,Y=u):Y==null?Y=u:d(Y,"options"),l(W,"callback"),c(Y.signal,"options.signal"),W=s(W),T(X)||I(X))return N(X,Y,W);if(!D(X))throw new a("stream",["ReadableStream","WritableStream","Stream"],X);const fe=(te=Y.readable)!==null&&te!==void 0?te:S(X),re=(ue=Y.writable)!==null&&ue!==void 0?ue:E(X),ye=X._writableState,Te=X._readableState,Re=()=>{X.writable||J()};let ve=$(X)&&S(X)===fe&&E(X)===re,ce=L(X,!1);const J=()=>{ce=!0,X.destroyed&&(ve=!1),!(ve&&(!X.readable||fe))&&(!fe||j)&&W.call(X)};let j=w(X,!1);const z=()=>{j=!0,X.destroyed&&(ve=!1),!(ve&&(!X.writable||re))&&(!re||ce)&&W.call(X)},B=ne=>{W.call(X,ne)};let U=b(X);const Z=()=>{U=!0;const ne=F(X)||A(X);if(ne&&typeof ne!="boolean")return W.call(X,ne);if(fe&&!j&&S(X,!0)&&!w(X,!1))return W.call(X,new o);if(re&&!ce&&!L(X,!1))return W.call(X,new o);W.call(X)},oe=()=>{U=!0;const ne=F(X)||A(X);if(ne&&typeof ne!="boolean")return W.call(X,ne);W.call(X)},ie=()=>{X.req.on("finish",J)};C(X)?(X.on("complete",J),ve||X.on("abort",Z),X.req?ie():X.on("request",ie)):re&&!ye&&(X.on("end",Re),X.on("close",Re)),!ve&&typeof X.aborted=="boolean"&&X.on("aborted",Z),X.on("end",z),X.on("finish",J),Y.error!==!1&&X.on("error",B),X.on("close",Z),U?n.nextTick(Z):ye!=null&&ye.errorEmitted||Te!=null&&Te.errorEmitted?ve||n.nextTick(oe):(!fe&&(!ve||_(X))&&(ce||R(X)===!1)||!re&&(!ve||R(X))&&(j||_(X)===!1)||Te&&X.req&&X.aborted)&&n.nextTick(oe);const se=()=>{W=q,X.removeListener("aborted",Z),X.removeListener("complete",J),X.removeListener("abort",Z),X.removeListener("request",ie),X.req&&X.req.removeListener("finish",J),X.removeListener("end",Re),X.removeListener("close",Re),X.removeListener("finish",J),X.removeListener("end",z),X.removeListener("error",B),X.removeListener("close",Z)};if(Y.signal&&!U){const ne=()=>{const he=W;se(),he.call(X,new t(void 0,{cause:Y.signal.reason}))};if(Y.signal.aborted)n.nextTick(ne);else{P=P||requireUtil$7().addAbortListener;const he=P(Y.signal,ne),xe=W;W=s((...me)=>{he[g](),xe.apply(X,me)})}}return se}function N(X,Y,W){let te=!1,ue=q;if(Y.signal)if(ue=()=>{te=!0,W.call(X,new t(void 0,{cause:Y.signal.reason}))},Y.signal.aborted)n.nextTick(ue);else{P=P||requireUtil$7().addAbortListener;const re=P(Y.signal,ue),ye=W;W=s((...Te)=>{re[g](),ye.apply(X,Te)})}const fe=(...re)=>{te||n.nextTick(()=>W.apply(X,re))};return v(X[O].promise,fe,fe),q}function G(X,Y){var W;let te=!1;return Y===null&&(Y=u),(W=Y)!==null&&W!==void 0&&W.cleanup&&(f(Y.cleanup,"cleanup"),te=Y.cleanup),new h((ue,fe)=>{const re=M(X,Y,ye=>{te&&re(),ye?fe(ye):ue()})})}return endOfStream.exports=M,endOfStream.exports.finished=G,endOfStream.exports}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;const n=requireBrowser$2(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:r},AbortError:a}=requireErrors(),{Symbol:o}=requirePrimordials(),{kIsDestroyed:u,isDestroyed:s,isFinished:c,isServerRequest:l}=requireUtils$4(),d=o("kDestroy"),f=o("kConstruct");function h($,O,P){$&&($.stack,O&&!O.errored&&(O.errored=$),P&&!P.errored&&(P.errored=$))}function v($,O){const P=this._readableState,C=this._writableState,q=C||P;return C!=null&&C.destroyed||P!=null&&P.destroyed?(typeof O=="function"&&O(),this):(h($,C,P),C&&(C.destroyed=!0),P&&(P.destroyed=!0),q.constructed?g(this,$,O):this.once(d,function(M){g(this,t(M,$),O)}),this)}function g($,O,P){let C=!1;function q(M){if(C)return;C=!0;const N=$._readableState,G=$._writableState;h(M,G,N),G&&(G.closed=!0),N&&(N.closed=!0),typeof P=="function"&&P(M),M?n.nextTick(b,$,M):n.nextTick(_,$)}try{$._destroy(O||null,q)}catch(M){q(M)}}function b($,O){S($,O),_($)}function _($){const O=$._readableState,P=$._writableState;P&&(P.closeEmitted=!0),O&&(O.closeEmitted=!0),(P!=null&&P.emitClose||O!=null&&O.emitClose)&&$.emit("close")}function S($,O){const P=$._readableState,C=$._writableState;C!=null&&C.errorEmitted||P!=null&&P.errorEmitted||(C&&(C.errorEmitted=!0),P&&(P.errorEmitted=!0),$.emit("error",O))}function T(){const $=this._readableState,O=this._writableState;$&&($.constructed=!0,$.closed=!1,$.closeEmitted=!1,$.destroyed=!1,$.errored=null,$.errorEmitted=!1,$.reading=!1,$.ended=$.readable===!1,$.endEmitted=$.readable===!1),O&&(O.constructed=!0,O.destroyed=!1,O.closed=!1,O.closeEmitted=!1,O.errored=null,O.errorEmitted=!1,O.finalCalled=!1,O.prefinished=!1,O.ended=O.writable===!1,O.ending=O.writable===!1,O.finished=O.writable===!1)}function w($,O,P){const C=$._readableState,q=$._writableState;if(q!=null&&q.destroyed||C!=null&&C.destroyed)return this;C!=null&&C.autoDestroy||q!=null&&q.autoDestroy?$.destroy(O):O&&(O.stack,q&&!q.errored&&(q.errored=O),C&&!C.errored&&(C.errored=O),P?n.nextTick(S,$,O):S($,O))}function A($,O){if(typeof $._construct!="function")return;const P=$._readableState,C=$._writableState;P&&(P.constructed=!1),C&&(C.constructed=!1),$.once(f,O),!($.listenerCount(f)>1)&&n.nextTick(R,$)}function R($){let O=!1;function P(C){if(O){w($,C??new r);return}O=!0;const q=$._readableState,M=$._writableState,N=M||q;q&&(q.constructed=!0),M&&(M.constructed=!0),N.destroyed?$.emit(d,C):C?w($,C,!0):n.nextTick(E,$)}try{$._construct(C=>{n.nextTick(P,C)})}catch(C){n.nextTick(P,C)}}function E($){$.emit(f)}function I($){return($==null?void 0:$.setHeader)&&typeof $.abort=="function"}function L($){$.emit("close")}function F($,O){$.emit("error",O),n.nextTick(L,$)}function D($,O){!$||s($)||(!O&&!c($)&&(O=new a),l($)?($.socket=null,$.destroy(O)):I($)?$.abort():I($.req)?$.req.abort():typeof $.destroy=="function"?$.destroy(O):typeof $.close=="function"?$.close():O?n.nextTick(F,$,O):n.nextTick(L,$),$.destroyed||($[u]=!0))}return destroy_1={construct:A,destroyer:D,destroy:v,undestroy:T,errorOrDestroy:w},destroy_1}var legacy$1,hasRequiredLegacy$1;function requireLegacy$1(){if(hasRequiredLegacy$1)return legacy$1;hasRequiredLegacy$1=1;const{ArrayIsArray:n,ObjectSetPrototypeOf:t}=requirePrimordials(),{EventEmitter:r}=requireEvents();function a(u){r.call(this,u)}t(a.prototype,r.prototype),t(a,r),a.prototype.pipe=function(u,s){const c=this;function l(_){u.writable&&u.write(_)===!1&&c.pause&&c.pause()}c.on("data",l);function d(){c.readable&&c.resume&&c.resume()}u.on("drain",d),!u._isStdio&&(!s||s.end!==!1)&&(c.on("end",h),c.on("close",v));let f=!1;function h(){f||(f=!0,u.end())}function v(){f||(f=!0,typeof u.destroy=="function"&&u.destroy())}function g(_){b(),r.listenerCount(this,"error")===0&&this.emit("error",_)}o(c,"error",g),o(u,"error",g);function b(){c.removeListener("data",l),u.removeListener("drain",d),c.removeListener("end",h),c.removeListener("close",v),c.removeListener("error",g),u.removeListener("error",g),c.removeListener("end",b),c.removeListener("close",b),u.removeListener("close",b)}return c.on("end",b),c.on("close",b),u.on("close",b),u.emit("pipe",c),u};function o(u,s,c){if(typeof u.prependListener=="function")return u.prependListener(s,c);!u._events||!u._events[s]?u.on(s,c):n(u._events[s])?u._events[s].unshift(c):u._events[s]=[c,u._events[s]]}return legacy$1={Stream:a,prependListener:o},legacy$1}var addAbortSignal={exports:{}},hasRequiredAddAbortSignal;function requireAddAbortSignal(){return hasRequiredAddAbortSignal||(hasRequiredAddAbortSignal=1,function(n){const{SymbolDispose:t}=requirePrimordials(),{AbortError:r,codes:a}=requireErrors(),{isNodeStream:o,isWebStream:u,kControllerErrorFunction:s}=requireUtils$4(),c=requireEndOfStream(),{ERR_INVALID_ARG_TYPE:l}=a;let d;const f=(h,v)=>{if(typeof h!="object"||!("aborted"in h))throw new l(v,"AbortSignal",h)};n.exports.addAbortSignal=function(v,g){if(f(v,"signal"),!o(g)&&!u(g))throw new l("stream",["ReadableStream","WritableStream","Stream"],g);return n.exports.addAbortSignalNoValidate(v,g)},n.exports.addAbortSignalNoValidate=function(h,v){if(typeof h!="object"||!("aborted"in h))return v;const g=o(v)?()=>{v.destroy(new r(void 0,{cause:h.reason}))}:()=>{v[s](new r(void 0,{cause:h.reason}))};if(h.aborted)g();else{d=d||requireUtil$7().addAbortListener;const b=d(h,g);c(v,b[t])}return v}}(addAbortSignal)),addAbortSignal.exports}var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;const{StringPrototypeSlice:n,SymbolIterator:t,TypedArrayPrototypeSet:r,Uint8Array:a}=requirePrimordials(),{Buffer:o}=requireBuffer(),{inspect:u}=requireUtil$7();return buffer_list=class{constructor(){this.head=null,this.tail=null,this.length=0}push(c){const l={data:c,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(c){const l={data:c,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}clear(){this.head=this.tail=null,this.length=0}join(c){if(this.length===0)return"";let l=this.head,d=""+l.data;for(;(l=l.next)!==null;)d+=c+l.data;return d}concat(c){if(this.length===0)return o.alloc(0);const l=o.allocUnsafe(c>>>0);let d=this.head,f=0;for(;d;)r(l,d.data,f),f+=d.data.length,d=d.next;return l}consume(c,l){const d=this.head.data;if(c<d.length){const f=d.slice(0,c);return this.head.data=d.slice(c),f}return c===d.length?this.shift():l?this._getString(c):this._getBuffer(c)}first(){return this.head.data}*[t](){for(let c=this.head;c;c=c.next)yield c.data}_getString(c){let l="",d=this.head,f=0;do{const h=d.data;if(c>h.length)l+=h,c-=h.length;else{c===h.length?(l+=h,++f,d.next?this.head=d.next:this.head=this.tail=null):(l+=n(h,0,c),this.head=d,d.data=n(h,c));break}++f}while((d=d.next)!==null);return this.length-=f,l}_getBuffer(c){const l=o.allocUnsafe(c),d=c;let f=this.head,h=0;do{const v=f.data;if(c>v.length)r(l,v,d-c),c-=v.length;else{c===v.length?(r(l,v,d-c),++h,f.next?this.head=f.next:this.head=this.tail=null):(r(l,new a(v.buffer,v.byteOffset,c),d-c),this.head=f,f.data=v.slice(c));break}++h}while((f=f.next)!==null);return this.length-=h,l}[Symbol.for("nodejs.util.inspect.custom")](c,l){return u(this,{...l,depth:0,customInspect:!1})}},buffer_list}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;const{MathFloor:n,NumberIsInteger:t}=requirePrimordials(),{validateInteger:r}=requireValidators(),{ERR_INVALID_ARG_VALUE:a}=requireErrors().codes;let o=16*1024,u=16;function s(f,h,v){return f.highWaterMark!=null?f.highWaterMark:h?f[v]:null}function c(f){return f?u:o}function l(f,h){r(h,"value",0),f?u=h:o=h}function d(f,h,v,g){const b=s(h,g,v);if(b!=null){if(!t(b)||b<0){const _=g?`options.${v}`:"options.highWaterMark";throw new a(_,b)}return n(b)}return c(f.objectMode)}return state={getHighWaterMark:d,getDefaultHighWaterMark:c,setDefaultHighWaterMark:l},state}var string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(n,t){var r=requireBuffer(),a=r.Buffer;function o(s,c){for(var l in s)c[l]=s[l]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?n.exports=r:(o(r,t),t.Buffer=u);function u(s,c,l){return a(s,c,l)}u.prototype=Object.create(a.prototype),o(a,u),u.from=function(s,c,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return a(s,c,l)},u.alloc=function(s,c,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var d=a(s);return c!==void 0?typeof l=="string"?d.fill(c,l):d.fill(c):d.fill(0),d},u.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return a(s)},u.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(s)}}(safeBuffer,safeBuffer.exports)),safeBuffer.exports}var hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var n=requireSafeBuffer().Buffer,t=n.isEncoding||function(T){switch(T=""+T,T&&T.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(T){if(!T)return"utf8";for(var w;;)switch(T){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return T;default:if(w)return;T=(""+T).toLowerCase(),w=!0}}function a(T){var w=r(T);if(typeof w!="string"&&(n.isEncoding===t||!t(T)))throw new Error("Unknown encoding: "+T);return w||T}string_decoder.StringDecoder=o;function o(T){this.encoding=a(T);var w;switch(this.encoding){case"utf16le":this.text=h,this.end=v,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=g,this.end=b,w=3;break;default:this.write=_,this.end=S;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(w)}o.prototype.write=function(T){if(T.length===0)return"";var w,A;if(this.lastNeed){if(w=this.fillLast(T),w===void 0)return"";A=this.lastNeed,this.lastNeed=0}else A=0;return A<T.length?w?w+this.text(T,A):this.text(T,A):w||""},o.prototype.end=f,o.prototype.text=d,o.prototype.fillLast=function(T){if(this.lastNeed<=T.length)return T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);T.copy(this.lastChar,this.lastTotal-this.lastNeed,0,T.length),this.lastNeed-=T.length};function u(T){return T<=127?0:T>>5===6?2:T>>4===14?3:T>>3===30?4:T>>6===2?-1:-2}function s(T,w,A){var R=w.length-1;if(R<A)return 0;var E=u(w[R]);return E>=0?(E>0&&(T.lastNeed=E-1),E):--R<A||E===-2?0:(E=u(w[R]),E>=0?(E>0&&(T.lastNeed=E-2),E):--R<A||E===-2?0:(E=u(w[R]),E>=0?(E>0&&(E===2?E=0:T.lastNeed=E-3),E):0))}function c(T,w,A){if((w[0]&192)!==128)return T.lastNeed=0,"";if(T.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return T.lastNeed=1,"";if(T.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return T.lastNeed=2,""}}function l(T){var w=this.lastTotal-this.lastNeed,A=c(this,T);if(A!==void 0)return A;if(this.lastNeed<=T.length)return T.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);T.copy(this.lastChar,w,0,T.length),this.lastNeed-=T.length}function d(T,w){var A=s(this,T,w);if(!this.lastNeed)return T.toString("utf8",w);this.lastTotal=A;var R=T.length-(A-this.lastNeed);return T.copy(this.lastChar,0,R),T.toString("utf8",w,R)}function f(T){var w=T&&T.length?this.write(T):"";return this.lastNeed?w+"":w}function h(T,w){if((T.length-w)%2===0){var A=T.toString("utf16le",w);if(A){var R=A.charCodeAt(A.length-1);if(R>=55296&&R<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1],A.slice(0,-1)}return A}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=T[T.length-1],T.toString("utf16le",w,T.length-1)}function v(T){var w=T&&T.length?this.write(T):"";if(this.lastNeed){var A=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,A)}return w}function g(T,w){var A=(T.length-w)%3;return A===0?T.toString("base64",w):(this.lastNeed=3-A,this.lastTotal=3,A===1?this.lastChar[0]=T[T.length-1]:(this.lastChar[0]=T[T.length-2],this.lastChar[1]=T[T.length-1]),T.toString("base64",w,T.length-A))}function b(T){var w=T&&T.length?this.write(T):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function _(T){return T.toString(this.encoding)}function S(T){return T&&T.length?this.write(T):""}return string_decoder}var from_1,hasRequiredFrom;function requireFrom(){if(hasRequiredFrom)return from_1;hasRequiredFrom=1;const n=requireBrowser$2(),{PromisePrototypeThen:t,SymbolAsyncIterator:r,SymbolIterator:a}=requirePrimordials(),{Buffer:o}=requireBuffer(),{ERR_INVALID_ARG_TYPE:u,ERR_STREAM_NULL_VALUES:s}=requireErrors().codes;function c(l,d,f){let h;if(typeof d=="string"||d instanceof o)return new l({objectMode:!0,...f,read(){this.push(d),this.push(null)}});let v;if(d&&d[r])v=!0,h=d[r]();else if(d&&d[a])v=!1,h=d[a]();else throw new u("iterable",["Iterable"],d);const g=new l({objectMode:!0,highWaterMark:1,...f});let b=!1;g._read=function(){b||(b=!0,S())},g._destroy=function(T,w){t(_(T),()=>n.nextTick(w,T),A=>n.nextTick(w,A||T))};async function _(T){const w=T!=null,A=typeof h.throw=="function";if(w&&A){const{value:R,done:E}=await h.throw(T);if(await R,E)return}if(typeof h.return=="function"){const{value:R}=await h.return();await R}}async function S(){for(;;){try{const{value:T,done:w}=v?await h.next():h.next();if(w)g.push(null);else{const A=T&&typeof T.then=="function"?await T:T;if(A===null)throw b=!1,new s;if(g.push(A))continue;b=!1}}catch(T){g.destroy(T)}break}}return g}return from_1=c,from_1}var readable,hasRequiredReadable;function requireReadable(){if(hasRequiredReadable)return readable;hasRequiredReadable=1;const n=requireBrowser$2(),{ArrayPrototypeIndexOf:t,NumberIsInteger:r,NumberIsNaN:a,NumberParseInt:o,ObjectDefineProperties:u,ObjectKeys:s,ObjectSetPrototypeOf:c,Promise:l,SafeSet:d,SymbolAsyncDispose:f,SymbolAsyncIterator:h,Symbol:v}=requirePrimordials();readable=me,me.ReadableState=xe;const{EventEmitter:g}=requireEvents(),{Stream:b,prependListener:_}=requireLegacy$1(),{Buffer:S}=requireBuffer(),{addAbortSignal:T}=requireAddAbortSignal(),w=requireEndOfStream();let A=requireUtil$7().debuglog("stream",_e=>{A=_e});const R=requireBuffer_list(),E=requireDestroy(),{getHighWaterMark:I,getDefaultHighWaterMark:L}=requireState(),{aggregateTwoErrors:F,codes:{ERR_INVALID_ARG_TYPE:D,ERR_METHOD_NOT_IMPLEMENTED:$,ERR_OUT_OF_RANGE:O,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:C},AbortError:q}=requireErrors(),{validateObject:M}=requireValidators(),N=v("kPaused"),{StringDecoder:G}=requireString_decoder(),X=requireFrom();c(me.prototype,b.prototype),c(me,b);const Y=()=>{},{errorOrDestroy:W}=E,te=1,ue=2,fe=4,re=8,ye=16,Te=32,Re=64,ve=128,ce=256,J=512,j=1024,z=2048,B=4096,U=8192,Z=16384,oe=32768,ie=65536,se=1<<17,ne=1<<18;function he(_e){return{enumerable:!1,get(){return(this.state&_e)!==0},set(Ae){Ae?this.state|=_e:this.state&=~_e}}}u(xe.prototype,{objectMode:he(te),ended:he(ue),endEmitted:he(fe),reading:he(re),constructed:he(ye),sync:he(Te),needReadable:he(Re),emittedReadable:he(ve),readableListening:he(ce),resumeScheduled:he(J),errorEmitted:he(j),emitClose:he(z),autoDestroy:he(B),destroyed:he(U),closed:he(Z),closeEmitted:he(oe),multiAwaitDrain:he(ie),readingMore:he(se),dataEmitted:he(ne)});function xe(_e,Ae,Ve){typeof Ve!="boolean"&&(Ve=Ae instanceof requireDuplex()),this.state=z|B|ye|Te,_e&&_e.objectMode&&(this.state|=te),Ve&&_e&&_e.readableObjectMode&&(this.state|=te),this.highWaterMark=_e?I(this,_e,"readableHighWaterMark",Ve):L(!1),this.buffer=new R,this.length=0,this.pipes=[],this.flowing=null,this[N]=null,_e&&_e.emitClose===!1&&(this.state&=-2049),_e&&_e.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=_e&&_e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,_e&&_e.encoding&&(this.decoder=new G(_e.encoding),this.encoding=_e.encoding)}function me(_e){if(!(this instanceof me))return new me(_e);const Ae=this instanceof requireDuplex();this._readableState=new xe(_e,this,Ae),_e&&(typeof _e.read=="function"&&(this._read=_e.read),typeof _e.destroy=="function"&&(this._destroy=_e.destroy),typeof _e.construct=="function"&&(this._construct=_e.construct),_e.signal&&!Ae&&T(_e.signal,this)),b.call(this,_e),E.construct(this,()=>{this._readableState.needReadable&&ae(this,this._readableState)})}me.prototype.destroy=E.destroy,me.prototype._undestroy=E.undestroy,me.prototype._destroy=function(_e,Ae){Ae(_e)},me.prototype[g.captureRejectionSymbol]=function(_e){this.destroy(_e)},me.prototype[f]=function(){let _e;return this.destroyed||(_e=this.readableEnded?null:new q,this.destroy(_e)),new l((Ae,Ve)=>w(this,Ue=>Ue&&Ue!==_e?Ve(Ue):Ae(null)))},me.prototype.push=function(_e,Ae){return Ie(this,_e,Ae,!1)},me.prototype.unshift=function(_e,Ae){return Ie(this,_e,Ae,!0)};function Ie(_e,Ae,Ve,Ue){A("readableAddChunk",Ae);const We=_e._readableState;let pt;if(We.state&te||(typeof Ae=="string"?(Ve=Ve||We.defaultEncoding,We.encoding!==Ve&&(Ue&&We.encoding?Ae=S.from(Ae,Ve).toString(We.encoding):(Ae=S.from(Ae,Ve),Ve=""))):Ae instanceof S?Ve="":b._isUint8Array(Ae)?(Ae=b._uint8ArrayToBuffer(Ae),Ve=""):Ae!=null&&(pt=new D("chunk",["string","Buffer","Uint8Array"],Ae))),pt)W(_e,pt);else if(Ae===null)We.state&=-9,V(_e,We);else if(We.state&te||Ae&&Ae.length>0)if(Ue)if(We.state&fe)W(_e,new C);else{if(We.destroyed||We.errored)return!1;Pe(_e,We,Ae,!0)}else if(We.ended)W(_e,new P);else{if(We.destroyed||We.errored)return!1;We.state&=-9,We.decoder&&!Ve?(Ae=We.decoder.write(Ae),We.objectMode||Ae.length!==0?Pe(_e,We,Ae,!1):ae(_e,We)):Pe(_e,We,Ae,!1)}else Ue||(We.state&=-9,ae(_e,We));return!We.ended&&(We.length<We.highWaterMark||We.length===0)}function Pe(_e,Ae,Ve,Ue){Ae.flowing&&Ae.length===0&&!Ae.sync&&_e.listenerCount("data")>0?(Ae.state&ie?Ae.awaitDrainWriters.clear():Ae.awaitDrainWriters=null,Ae.dataEmitted=!0,_e.emit("data",Ve)):(Ae.length+=Ae.objectMode?1:Ve.length,Ue?Ae.buffer.unshift(Ve):Ae.buffer.push(Ve),Ae.state&Re&&Q(_e)),ae(_e,Ae)}me.prototype.isPaused=function(){const _e=this._readableState;return _e[N]===!0||_e.flowing===!1},me.prototype.setEncoding=function(_e){const Ae=new G(_e);this._readableState.decoder=Ae,this._readableState.encoding=this._readableState.decoder.encoding;const Ve=this._readableState.buffer;let Ue="";for(const We of Ve)Ue+=Ae.write(We);return Ve.clear(),Ue!==""&&Ve.push(Ue),this._readableState.length=Ue.length,this};const Ce=1073741824;function pe(_e){if(_e>Ce)throw new O("size","<= 1GiB",_e);return _e--,_e|=_e>>>1,_e|=_e>>>2,_e|=_e>>>4,_e|=_e>>>8,_e|=_e>>>16,_e++,_e}function H(_e,Ae){return _e<=0||Ae.length===0&&Ae.ended?0:Ae.state&te?1:a(_e)?Ae.flowing&&Ae.length?Ae.buffer.first().length:Ae.length:_e<=Ae.length?_e:Ae.ended?Ae.length:0}me.prototype.read=function(_e){A("read",_e),_e===void 0?_e=NaN:r(_e)||(_e=o(_e,10));const Ae=this._readableState,Ve=_e;if(_e>Ae.highWaterMark&&(Ae.highWaterMark=pe(_e)),_e!==0&&(Ae.state&=-129),_e===0&&Ae.needReadable&&((Ae.highWaterMark!==0?Ae.length>=Ae.highWaterMark:Ae.length>0)||Ae.ended))return A("read: emitReadable",Ae.length,Ae.ended),Ae.length===0&&Ae.ended?Me(this):Q(this),null;if(_e=H(_e,Ae),_e===0&&Ae.ended)return Ae.length===0&&Me(this),null;let Ue=(Ae.state&Re)!==0;if(A("need readable",Ue),(Ae.length===0||Ae.length-_e<Ae.highWaterMark)&&(Ue=!0,A("length less than watermark",Ue)),Ae.ended||Ae.reading||Ae.destroyed||Ae.errored||!Ae.constructed)Ue=!1,A("reading, ended or constructing",Ue);else if(Ue){A("do read"),Ae.state|=re|Te,Ae.length===0&&(Ae.state|=Re);try{this._read(Ae.highWaterMark)}catch(pt){W(this,pt)}Ae.state&=-33,Ae.reading||(_e=H(Ve,Ae))}let We;return _e>0?We=je(_e,Ae):We=null,We===null?(Ae.needReadable=Ae.length<=Ae.highWaterMark,_e=0):(Ae.length-=_e,Ae.multiAwaitDrain?Ae.awaitDrainWriters.clear():Ae.awaitDrainWriters=null),Ae.length===0&&(Ae.ended||(Ae.needReadable=!0),Ve!==_e&&Ae.ended&&Me(this)),We!==null&&!Ae.errorEmitted&&!Ae.closeEmitted&&(Ae.dataEmitted=!0,this.emit("data",We)),We};function V(_e,Ae){if(A("onEofChunk"),!Ae.ended){if(Ae.decoder){const Ve=Ae.decoder.end();Ve&&Ve.length&&(Ae.buffer.push(Ve),Ae.length+=Ae.objectMode?1:Ve.length)}Ae.ended=!0,Ae.sync?Q(_e):(Ae.needReadable=!1,Ae.emittedReadable=!0,ee(_e))}}function Q(_e){const Ae=_e._readableState;A("emitReadable",Ae.needReadable,Ae.emittedReadable),Ae.needReadable=!1,Ae.emittedReadable||(A("emitReadable",Ae.flowing),Ae.emittedReadable=!0,n.nextTick(ee,_e))}function ee(_e){const Ae=_e._readableState;A("emitReadable_",Ae.destroyed,Ae.length,Ae.ended),!Ae.destroyed&&!Ae.errored&&(Ae.length||Ae.ended)&&(_e.emit("readable"),Ae.emittedReadable=!1),Ae.needReadable=!Ae.flowing&&!Ae.ended&&Ae.length<=Ae.highWaterMark,de(_e)}function ae(_e,Ae){!Ae.readingMore&&Ae.constructed&&(Ae.readingMore=!0,n.nextTick(be,_e,Ae))}function be(_e,Ae){for(;!Ae.reading&&!Ae.ended&&(Ae.length<Ae.highWaterMark||Ae.flowing&&Ae.length===0);){const Ve=Ae.length;if(A("maybeReadMore read 0"),_e.read(0),Ve===Ae.length)break}Ae.readingMore=!1}me.prototype._read=function(_e){throw new $("_read()")},me.prototype.pipe=function(_e,Ae){const Ve=this,Ue=this._readableState;Ue.pipes.length===1&&(Ue.multiAwaitDrain||(Ue.multiAwaitDrain=!0,Ue.awaitDrainWriters=new d(Ue.awaitDrainWriters?[Ue.awaitDrainWriters]:[]))),Ue.pipes.push(_e),A("pipe count=%d opts=%j",Ue.pipes.length,Ae);const pt=(!Ae||Ae.end!==!1)&&_e!==n.stdout&&_e!==n.stderr?ct:Ee;Ue.endEmitted?n.nextTick(pt):Ve.once("end",pt),_e.on("unpipe",Ge);function Ge(qe,Be){A("onunpipe"),qe===Ve&&Be&&Be.hasUnpiped===!1&&(Be.hasUnpiped=!0,nt())}function ct(){A("onend"),_e.end()}let Xe,Ye=!1;function nt(){A("cleanup"),_e.removeListener("close",Ct),_e.removeListener("finish",Ze),Xe&&_e.removeListener("drain",Xe),_e.removeListener("error",tt),_e.removeListener("unpipe",Ge),Ve.removeListener("end",ct),Ve.removeListener("end",Ee),Ve.removeListener("data",ut),Ye=!0,Xe&&Ue.awaitDrainWriters&&(!_e._writableState||_e._writableState.needDrain)&&Xe()}function gt(){Ye||(Ue.pipes.length===1&&Ue.pipes[0]===_e?(A("false write response, pause",0),Ue.awaitDrainWriters=_e,Ue.multiAwaitDrain=!1):Ue.pipes.length>1&&Ue.pipes.includes(_e)&&(A("false write response, pause",Ue.awaitDrainWriters.size),Ue.awaitDrainWriters.add(_e)),Ve.pause()),Xe||(Xe=le(Ve,_e),_e.on("drain",Xe))}Ve.on("data",ut);function ut(qe){A("ondata");const Be=_e.write(qe);A("dest.write",Be),Be===!1&&gt()}function tt(qe){if(A("onerror",qe),Ee(),_e.removeListener("error",tt),_e.listenerCount("error")===0){const Be=_e._writableState||_e._readableState;Be&&!Be.errorEmitted?W(_e,qe):_e.emit("error",qe)}}_(_e,"error",tt);function Ct(){_e.removeListener("finish",Ze),Ee()}_e.once("close",Ct);function Ze(){A("onfinish"),_e.removeListener("close",Ct),Ee()}_e.once("finish",Ze);function Ee(){A("unpipe"),Ve.unpipe(_e)}return _e.emit("pipe",Ve),_e.writableNeedDrain===!0?gt():Ue.flowing||(A("pipe resume"),Ve.resume()),_e};function le(_e,Ae){return function(){const Ue=_e._readableState;Ue.awaitDrainWriters===Ae?(A("pipeOnDrain",1),Ue.awaitDrainWriters=null):Ue.multiAwaitDrain&&(A("pipeOnDrain",Ue.awaitDrainWriters.size),Ue.awaitDrainWriters.delete(Ae)),(!Ue.awaitDrainWriters||Ue.awaitDrainWriters.size===0)&&_e.listenerCount("data")&&_e.resume()}}me.prototype.unpipe=function(_e){const Ae=this._readableState,Ve={hasUnpiped:!1};if(Ae.pipes.length===0)return this;if(!_e){const We=Ae.pipes;Ae.pipes=[],this.pause();for(let pt=0;pt<We.length;pt++)We[pt].emit("unpipe",this,{hasUnpiped:!1});return this}const Ue=t(Ae.pipes,_e);return Ue===-1?this:(Ae.pipes.splice(Ue,1),Ae.pipes.length===0&&this.pause(),_e.emit("unpipe",this,Ve),this)},me.prototype.on=function(_e,Ae){const Ve=b.prototype.on.call(this,_e,Ae),Ue=this._readableState;return _e==="data"?(Ue.readableListening=this.listenerCount("readable")>0,Ue.flowing!==!1&&this.resume()):_e==="readable"&&!Ue.endEmitted&&!Ue.readableListening&&(Ue.readableListening=Ue.needReadable=!0,Ue.flowing=!1,Ue.emittedReadable=!1,A("on readable",Ue.length,Ue.reading),Ue.length?Q(this):Ue.reading||n.nextTick(De,this)),Ve},me.prototype.addListener=me.prototype.on,me.prototype.removeListener=function(_e,Ae){const Ve=b.prototype.removeListener.call(this,_e,Ae);return _e==="readable"&&n.nextTick(we,this),Ve},me.prototype.off=me.prototype.removeListener,me.prototype.removeAllListeners=function(_e){const Ae=b.prototype.removeAllListeners.apply(this,arguments);return(_e==="readable"||_e===void 0)&&n.nextTick(we,this),Ae};function we(_e){const Ae=_e._readableState;Ae.readableListening=_e.listenerCount("readable")>0,Ae.resumeScheduled&&Ae[N]===!1?Ae.flowing=!0:_e.listenerCount("data")>0?_e.resume():Ae.readableListening||(Ae.flowing=null)}function De(_e){A("readable nexttick read 0"),_e.read(0)}me.prototype.resume=function(){const _e=this._readableState;return _e.flowing||(A("resume"),_e.flowing=!_e.readableListening,Fe(this,_e)),_e[N]=!1,this};function Fe(_e,Ae){Ae.resumeScheduled||(Ae.resumeScheduled=!0,n.nextTick(Ne,_e,Ae))}function Ne(_e,Ae){A("resume",Ae.reading),Ae.reading||_e.read(0),Ae.resumeScheduled=!1,_e.emit("resume"),de(_e),Ae.flowing&&!Ae.reading&&_e.read(0)}me.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[N]=!0,this};function de(_e){const Ae=_e._readableState;for(A("flow",Ae.flowing);Ae.flowing&&_e.read()!==null;);}me.prototype.wrap=function(_e){let Ae=!1;_e.on("data",Ue=>{!this.push(Ue)&&_e.pause&&(Ae=!0,_e.pause())}),_e.on("end",()=>{this.push(null)}),_e.on("error",Ue=>{W(this,Ue)}),_e.on("close",()=>{this.destroy()}),_e.on("destroy",()=>{this.destroy()}),this._read=()=>{Ae&&_e.resume&&(Ae=!1,_e.resume())};const Ve=s(_e);for(let Ue=1;Ue<Ve.length;Ue++){const We=Ve[Ue];this[We]===void 0&&typeof _e[We]=="function"&&(this[We]=_e[We].bind(_e))}return this},me.prototype[h]=function(){return Le(this)},me.prototype.iterator=function(_e){return _e!==void 0&&M(_e,"options"),Le(this,_e)};function Le(_e,Ae){typeof _e.read!="function"&&(_e=me.wrap(_e,{objectMode:!0}));const Ve=$e(_e,Ae);return Ve.stream=_e,Ve}async function*$e(_e,Ae){let Ve=Y;function Ue(Ge){this===_e?(Ve(),Ve=Y):Ve=Ge}_e.on("readable",Ue);let We;const pt=w(_e,{writable:!1},Ge=>{We=Ge?F(We,Ge):null,Ve(),Ve=Y});try{for(;;){const Ge=_e.destroyed?null:_e.read();if(Ge!==null)yield Ge;else{if(We)throw We;if(We===null)return;await new l(Ue)}}}catch(Ge){throw We=F(We,Ge),We}finally{(We||(Ae==null?void 0:Ae.destroyOnReturn)!==!1)&&(We===void 0||_e._readableState.autoDestroy)?E.destroyer(_e,null):(_e.off("readable",Ue),pt())}}u(me.prototype,{readable:{__proto__:null,get(){const _e=this._readableState;return!!_e&&_e.readable!==!1&&!_e.destroyed&&!_e.errorEmitted&&!_e.endEmitted},set(_e){this._readableState&&(this._readableState.readable=!!_e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(_e){this._readableState&&(this._readableState.flowing=_e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(_e){this._readableState&&(this._readableState.destroyed=_e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),u(xe.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[N]!==!1},set(_e){this[N]=!!_e}}}),me._fromList=je;function je(_e,Ae){if(Ae.length===0)return null;let Ve;return Ae.objectMode?Ve=Ae.buffer.shift():!_e||_e>=Ae.length?(Ae.decoder?Ve=Ae.buffer.join(""):Ae.buffer.length===1?Ve=Ae.buffer.first():Ve=Ae.buffer.concat(Ae.length),Ae.buffer.clear()):Ve=Ae.buffer.consume(_e,Ae.decoder),Ve}function Me(_e){const Ae=_e._readableState;A("endReadable",Ae.endEmitted),Ae.endEmitted||(Ae.ended=!0,n.nextTick(ze,Ae,_e))}function ze(_e,Ae){if(A("endReadableNT",_e.endEmitted,_e.length),!_e.errored&&!_e.closeEmitted&&!_e.endEmitted&&_e.length===0){if(_e.endEmitted=!0,Ae.emit("end"),Ae.writable&&Ae.allowHalfOpen===!1)n.nextTick(Je,Ae);else if(_e.autoDestroy){const Ve=Ae._writableState;(!Ve||Ve.autoDestroy&&(Ve.finished||Ve.writable===!1))&&Ae.destroy()}}}function Je(_e){_e.writable&&!_e.writableEnded&&!_e.destroyed&&_e.end()}me.from=function(_e,Ae){return X(me,_e,Ae)};let Ke;function ot(){return Ke===void 0&&(Ke={}),Ke}return me.fromWeb=function(_e,Ae){return ot().newStreamReadableFromReadableStream(_e,Ae)},me.toWeb=function(_e,Ae){return ot().newReadableStreamFromStreamReadable(_e,Ae)},me.wrap=function(_e,Ae){var Ve,Ue;return new me({objectMode:(Ve=(Ue=_e.readableObjectMode)!==null&&Ue!==void 0?Ue:_e.objectMode)!==null&&Ve!==void 0?Ve:!0,...Ae,destroy(We,pt){E.destroyer(_e,We),pt(We)}}).wrap(_e)},readable}var writable,hasRequiredWritable;function requireWritable(){if(hasRequiredWritable)return writable;hasRequiredWritable=1;const n=requireBrowser$2(),{ArrayPrototypeSlice:t,Error:r,FunctionPrototypeSymbolHasInstance:a,ObjectDefineProperty:o,ObjectDefineProperties:u,ObjectSetPrototypeOf:s,StringPrototypeToLowerCase:c,Symbol:l,SymbolHasInstance:d}=requirePrimordials();writable=M,M.WritableState=C;const{EventEmitter:f}=requireEvents(),h=requireLegacy$1().Stream,{Buffer:v}=requireBuffer(),g=requireDestroy(),{addAbortSignal:b}=requireAddAbortSignal(),{getHighWaterMark:_,getDefaultHighWaterMark:S}=requireState(),{ERR_INVALID_ARG_TYPE:T,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:A,ERR_STREAM_CANNOT_PIPE:R,ERR_STREAM_DESTROYED:E,ERR_STREAM_ALREADY_FINISHED:I,ERR_STREAM_NULL_VALUES:L,ERR_STREAM_WRITE_AFTER_END:F,ERR_UNKNOWN_ENCODING:D}=requireErrors().codes,{errorOrDestroy:$}=g;s(M.prototype,h.prototype),s(M,h);function O(){}const P=l("kOnFinished");function C(B,U,Z){typeof Z!="boolean"&&(Z=U instanceof requireDuplex()),this.objectMode=!!(B&&B.objectMode),Z&&(this.objectMode=this.objectMode||!!(B&&B.writableObjectMode)),this.highWaterMark=B?_(this,B,"writableHighWaterMark",Z):S(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const oe=!!(B&&B.decodeStrings===!1);this.decodeStrings=!oe,this.defaultEncoding=B&&B.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,U),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,q(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!B||B.emitClose!==!1,this.autoDestroy=!B||B.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function q(B){B.buffered=[],B.bufferedIndex=0,B.allBuffers=!0,B.allNoop=!0}C.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(C.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function M(B){const U=this instanceof requireDuplex();if(!U&&!a(M,this))return new M(B);this._writableState=new C(B,this,U),B&&(typeof B.write=="function"&&(this._write=B.write),typeof B.writev=="function"&&(this._writev=B.writev),typeof B.destroy=="function"&&(this._destroy=B.destroy),typeof B.final=="function"&&(this._final=B.final),typeof B.construct=="function"&&(this._construct=B.construct),B.signal&&b(B.signal,this)),h.call(this,B),g.construct(this,()=>{const Z=this._writableState;Z.writing||re(this,Z),ve(this,Z)})}o(M,d,{__proto__:null,value:function(B){return a(this,B)?!0:this!==M?!1:B&&B._writableState instanceof C}}),M.prototype.pipe=function(){$(this,new R)};function N(B,U,Z,oe){const ie=B._writableState;if(typeof Z=="function")oe=Z,Z=ie.defaultEncoding;else{if(!Z)Z=ie.defaultEncoding;else if(Z!=="buffer"&&!v.isEncoding(Z))throw new D(Z);typeof oe!="function"&&(oe=O)}if(U===null)throw new L;if(!ie.objectMode)if(typeof U=="string")ie.decodeStrings!==!1&&(U=v.from(U,Z),Z="buffer");else if(U instanceof v)Z="buffer";else if(h._isUint8Array(U))U=h._uint8ArrayToBuffer(U),Z="buffer";else throw new T("chunk",["string","Buffer","Uint8Array"],U);let se;return ie.ending?se=new F:ie.destroyed&&(se=new E("write")),se?(n.nextTick(oe,se),$(B,se,!0),se):(ie.pendingcb++,G(B,ie,U,Z,oe))}M.prototype.write=function(B,U,Z){return N(this,B,U,Z)===!0},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){const B=this._writableState;B.corked&&(B.corked--,B.writing||re(this,B))},M.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=c(U)),!v.isEncoding(U))throw new D(U);return this._writableState.defaultEncoding=U,this};function G(B,U,Z,oe,ie){const se=U.objectMode?1:Z.length;U.length+=se;const ne=U.length<U.highWaterMark;return ne||(U.needDrain=!0),U.writing||U.corked||U.errored||!U.constructed?(U.buffered.push({chunk:Z,encoding:oe,callback:ie}),U.allBuffers&&oe!=="buffer"&&(U.allBuffers=!1),U.allNoop&&ie!==O&&(U.allNoop=!1)):(U.writelen=se,U.writecb=ie,U.writing=!0,U.sync=!0,B._write(Z,oe,U.onwrite),U.sync=!1),ne&&!U.errored&&!U.destroyed}function X(B,U,Z,oe,ie,se,ne){U.writelen=oe,U.writecb=ne,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new E("write")):Z?B._writev(ie,U.onwrite):B._write(ie,se,U.onwrite),U.sync=!1}function Y(B,U,Z,oe){--U.pendingcb,oe(Z),fe(U),$(B,Z)}function W(B,U){const Z=B._writableState,oe=Z.sync,ie=Z.writecb;if(typeof ie!="function"){$(B,new A);return}Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0,U?(U.stack,Z.errored||(Z.errored=U),B._readableState&&!B._readableState.errored&&(B._readableState.errored=U),oe?n.nextTick(Y,B,Z,U,ie):Y(B,Z,U,ie)):(Z.buffered.length>Z.bufferedIndex&&re(B,Z),oe?Z.afterWriteTickInfo!==null&&Z.afterWriteTickInfo.cb===ie?Z.afterWriteTickInfo.count++:(Z.afterWriteTickInfo={count:1,cb:ie,stream:B,state:Z},n.nextTick(te,Z.afterWriteTickInfo)):ue(B,Z,1,ie))}function te({stream:B,state:U,count:Z,cb:oe}){return U.afterWriteTickInfo=null,ue(B,U,Z,oe)}function ue(B,U,Z,oe){for(!U.ending&&!B.destroyed&&U.length===0&&U.needDrain&&(U.needDrain=!1,B.emit("drain"));Z-- >0;)U.pendingcb--,oe();U.destroyed&&fe(U),ve(B,U)}function fe(B){if(B.writing)return;for(let ie=B.bufferedIndex;ie<B.buffered.length;++ie){var U;const{chunk:se,callback:ne}=B.buffered[ie],he=B.objectMode?1:se.length;B.length-=he,ne((U=B.errored)!==null&&U!==void 0?U:new E("write"))}const Z=B[P].splice(0);for(let ie=0;ie<Z.length;ie++){var oe;Z[ie]((oe=B.errored)!==null&&oe!==void 0?oe:new E("end"))}q(B)}function re(B,U){if(U.corked||U.bufferProcessing||U.destroyed||!U.constructed)return;const{buffered:Z,bufferedIndex:oe,objectMode:ie}=U,se=Z.length-oe;if(!se)return;let ne=oe;if(U.bufferProcessing=!0,se>1&&B._writev){U.pendingcb-=se-1;const he=U.allNoop?O:me=>{for(let Ie=ne;Ie<Z.length;++Ie)Z[Ie].callback(me)},xe=U.allNoop&&ne===0?Z:t(Z,ne);xe.allBuffers=U.allBuffers,X(B,U,!0,U.length,xe,"",he),q(U)}else{do{const{chunk:he,encoding:xe,callback:me}=Z[ne];Z[ne++]=null;const Ie=ie?1:he.length;X(B,U,!1,Ie,he,xe,me)}while(ne<Z.length&&!U.writing);ne===Z.length?q(U):ne>256?(Z.splice(0,ne),U.bufferedIndex=0):U.bufferedIndex=ne}U.bufferProcessing=!1}M.prototype._write=function(B,U,Z){if(this._writev)this._writev([{chunk:B,encoding:U}],Z);else throw new w("_write()")},M.prototype._writev=null,M.prototype.end=function(B,U,Z){const oe=this._writableState;typeof B=="function"?(Z=B,B=null,U=null):typeof U=="function"&&(Z=U,U=null);let ie;if(B!=null){const se=N(this,B,U);se instanceof r&&(ie=se)}return oe.corked&&(oe.corked=1,this.uncork()),ie||(!oe.errored&&!oe.ending?(oe.ending=!0,ve(this,oe,!0),oe.ended=!0):oe.finished?ie=new I("end"):oe.destroyed&&(ie=new E("end"))),typeof Z=="function"&&(ie||oe.finished?n.nextTick(Z,ie):oe[P].push(Z)),this};function ye(B){return B.ending&&!B.destroyed&&B.constructed&&B.length===0&&!B.errored&&B.buffered.length===0&&!B.finished&&!B.writing&&!B.errorEmitted&&!B.closeEmitted}function Te(B,U){let Z=!1;function oe(ie){if(Z){$(B,ie??A());return}if(Z=!0,U.pendingcb--,ie){const se=U[P].splice(0);for(let ne=0;ne<se.length;ne++)se[ne](ie);$(B,ie,U.sync)}else ye(U)&&(U.prefinished=!0,B.emit("prefinish"),U.pendingcb++,n.nextTick(ce,B,U))}U.sync=!0,U.pendingcb++;try{B._final(oe)}catch(ie){oe(ie)}U.sync=!1}function Re(B,U){!U.prefinished&&!U.finalCalled&&(typeof B._final=="function"&&!U.destroyed?(U.finalCalled=!0,Te(B,U)):(U.prefinished=!0,B.emit("prefinish")))}function ve(B,U,Z){ye(U)&&(Re(B,U),U.pendingcb===0&&(Z?(U.pendingcb++,n.nextTick((oe,ie)=>{ye(ie)?ce(oe,ie):ie.pendingcb--},B,U)):ye(U)&&(U.pendingcb++,ce(B,U))))}function ce(B,U){U.pendingcb--,U.finished=!0;const Z=U[P].splice(0);for(let oe=0;oe<Z.length;oe++)Z[oe]();if(B.emit("finish"),U.autoDestroy){const oe=B._readableState;(!oe||oe.autoDestroy&&(oe.endEmitted||oe.readable===!1))&&B.destroy()}}u(M.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(B){this._writableState&&(this._writableState.destroyed=B)}},writable:{__proto__:null,get(){const B=this._writableState;return!!B&&B.writable!==!1&&!B.destroyed&&!B.errored&&!B.ending&&!B.ended},set(B){this._writableState&&(this._writableState.writable=!!B)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const B=this._writableState;return B?!B.destroyed&&!B.ending&&B.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const J=g.destroy;M.prototype.destroy=function(B,U){const Z=this._writableState;return!Z.destroyed&&(Z.bufferedIndex<Z.buffered.length||Z[P].length)&&n.nextTick(fe,Z),J.call(this,B,U),this},M.prototype._undestroy=g.undestroy,M.prototype._destroy=function(B,U){U(B)},M.prototype[f.captureRejectionSymbol]=function(B){this.destroy(B)};let j;function z(){return j===void 0&&(j={}),j}return M.fromWeb=function(B,U){return z().newStreamWritableFromWritableStream(B,U)},M.toWeb=function(B){return z().newWritableStreamFromStreamWritable(B)},writable}var duplexify,hasRequiredDuplexify;function requireDuplexify(){if(hasRequiredDuplexify)return duplexify;hasRequiredDuplexify=1;const n=requireBrowser$2(),t=requireBuffer(),{isReadable:r,isWritable:a,isIterable:o,isNodeStream:u,isReadableNodeStream:s,isWritableNodeStream:c,isDuplexNodeStream:l,isReadableStream:d,isWritableStream:f}=requireUtils$4(),h=requireEndOfStream(),{AbortError:v,codes:{ERR_INVALID_ARG_TYPE:g,ERR_INVALID_RETURN_VALUE:b}}=requireErrors(),{destroyer:_}=requireDestroy(),S=requireDuplex(),T=requireReadable(),w=requireWritable(),{createDeferredPromise:A}=requireUtil$7(),R=requireFrom(),E=globalThis.Blob||t.Blob,I=typeof E<"u"?function(C){return C instanceof E}:function(C){return!1},L=globalThis.AbortController||requireBrowser$1().AbortController,{FunctionPrototypeCall:F}=requirePrimordials();class D extends S{constructor(C){super(C),(C==null?void 0:C.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(C==null?void 0:C.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}duplexify=function P(C,q){if(l(C))return C;if(s(C))return O({readable:C});if(c(C))return O({writable:C});if(u(C))return O({writable:!1,readable:!1});if(d(C))return O({readable:T.fromWeb(C)});if(f(C))return O({writable:w.fromWeb(C)});if(typeof C=="function"){const{value:N,write:G,final:X,destroy:Y}=$(C);if(o(N))return R(D,N,{objectMode:!0,write:G,final:X,destroy:Y});const W=N==null?void 0:N.then;if(typeof W=="function"){let te;const ue=F(W,N,fe=>{if(fe!=null)throw new b("nully","body",fe)},fe=>{_(te,fe)});return te=new D({objectMode:!0,readable:!1,write:G,final(fe){X(async()=>{try{await ue,n.nextTick(fe,null)}catch(re){n.nextTick(fe,re)}})},destroy:Y})}throw new b("Iterable, AsyncIterable or AsyncFunction",q,N)}if(I(C))return P(C.arrayBuffer());if(o(C))return R(D,C,{objectMode:!0,writable:!1});if(d(C==null?void 0:C.readable)&&f(C==null?void 0:C.writable))return D.fromWeb(C);if(typeof(C==null?void 0:C.writable)=="object"||typeof(C==null?void 0:C.readable)=="object"){const N=C!=null&&C.readable?s(C==null?void 0:C.readable)?C==null?void 0:C.readable:P(C.readable):void 0,G=C!=null&&C.writable?c(C==null?void 0:C.writable)?C==null?void 0:C.writable:P(C.writable):void 0;return O({readable:N,writable:G})}const M=C==null?void 0:C.then;if(typeof M=="function"){let N;return F(M,C,G=>{G!=null&&N.push(G),N.push(null)},G=>{_(N,G)}),N=new D({objectMode:!0,writable:!1,read(){}})}throw new g(q,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],C)};function $(P){let{promise:C,resolve:q}=A();const M=new L,N=M.signal;return{value:P(async function*(){for(;;){const X=C;C=null;const{chunk:Y,done:W,cb:te}=await X;if(n.nextTick(te),W)return;if(N.aborted)throw new v(void 0,{cause:N.reason});({promise:C,resolve:q}=A()),yield Y}}(),{signal:N}),write(X,Y,W){const te=q;q=null,te({chunk:X,done:!1,cb:W})},final(X){const Y=q;q=null,Y({done:!0,cb:X})},destroy(X,Y){M.abort(),Y(X)}}}function O(P){const C=P.readable&&typeof P.readable.read!="function"?T.wrap(P.readable):P.readable,q=P.writable;let M=!!r(C),N=!!a(q),G,X,Y,W,te;function ue(fe){const re=W;W=null,re?re(fe):fe&&te.destroy(fe)}return te=new D({readableObjectMode:!!(C!=null&&C.readableObjectMode),writableObjectMode:!!(q!=null&&q.writableObjectMode),readable:M,writable:N}),N&&(h(q,fe=>{N=!1,fe&&_(C,fe),ue(fe)}),te._write=function(fe,re,ye){q.write(fe,re)?ye():G=ye},te._final=function(fe){q.end(),X=fe},q.on("drain",function(){if(G){const fe=G;G=null,fe()}}),q.on("finish",function(){if(X){const fe=X;X=null,fe()}})),M&&(h(C,fe=>{M=!1,fe&&_(C,fe),ue(fe)}),C.on("readable",function(){if(Y){const fe=Y;Y=null,fe()}}),C.on("end",function(){te.push(null)}),te._read=function(){for(;;){const fe=C.read();if(fe===null){Y=te._read;return}if(!te.push(fe))return}}),te._destroy=function(fe,re){!fe&&W!==null&&(fe=new v),Y=null,G=null,X=null,W===null?re(fe):(W=re,_(q,fe),_(C,fe))},te}return duplexify}var duplex,hasRequiredDuplex;function requireDuplex(){if(hasRequiredDuplex)return duplex;hasRequiredDuplex=1;const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:r,ObjectSetPrototypeOf:a}=requirePrimordials();duplex=s;const o=requireReadable(),u=requireWritable();a(s.prototype,o.prototype),a(s,o);{const f=r(u.prototype);for(let h=0;h<f.length;h++){const v=f[h];s.prototype[v]||(s.prototype[v]=u.prototype[v])}}function s(f){if(!(this instanceof s))return new s(f);o.call(this,f),u.call(this,f),f?(this.allowHalfOpen=f.allowHalfOpen!==!1,f.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),f.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}n(s.prototype,{writable:{__proto__:null,...t(u.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(u.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(u.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(u.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(u.prototype,"writableLength")},writableFinished:{__proto__:null,...t(u.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(u.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(u.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(u.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(f){this._readableState&&this._writableState&&(this._readableState.destroyed=f,this._writableState.destroyed=f)}}});let c;function l(){return c===void 0&&(c={}),c}s.fromWeb=function(f,h){return l().newStreamDuplexFromReadableWritablePair(f,h)},s.toWeb=function(f){return l().newReadableWritablePairFromDuplex(f)};let d;return s.from=function(f){return d||(d=requireDuplexify()),d(f,"body")},duplex}var transform,hasRequiredTransform;function requireTransform(){if(hasRequiredTransform)return transform;hasRequiredTransform=1;const{ObjectSetPrototypeOf:n,Symbol:t}=requirePrimordials();transform=s;const{ERR_METHOD_NOT_IMPLEMENTED:r}=requireErrors().codes,a=requireDuplex(),{getHighWaterMark:o}=requireState();n(s.prototype,a.prototype),n(s,a);const u=t("kCallback");function s(d){if(!(this instanceof s))return new s(d);const f=d?o(this,d,"readableHighWaterMark",!0):null;f===0&&(d={...d,highWaterMark:null,readableHighWaterMark:f,writableHighWaterMark:d.writableHighWaterMark||0}),a.call(this,d),this._readableState.sync=!1,this[u]=null,d&&(typeof d.transform=="function"&&(this._transform=d.transform),typeof d.flush=="function"&&(this._flush=d.flush)),this.on("prefinish",l)}function c(d){typeof this._flush=="function"&&!this.destroyed?this._flush((f,h)=>{if(f){d?d(f):this.destroy(f);return}h!=null&&this.push(h),this.push(null),d&&d()}):(this.push(null),d&&d())}function l(){this._final!==c&&c.call(this)}return s.prototype._final=c,s.prototype._transform=function(d,f,h){throw new r("_transform()")},s.prototype._write=function(d,f,h){const v=this._readableState,g=this._writableState,b=v.length;this._transform(d,f,(_,S)=>{if(_){h(_);return}S!=null&&this.push(S),g.ended||b===v.length||v.length<v.highWaterMark?h():this[u]=h})},s.prototype._read=function(){if(this[u]){const d=this[u];this[u]=null,d()}},transform}var passthrough,hasRequiredPassthrough;function requirePassthrough(){if(hasRequiredPassthrough)return passthrough;hasRequiredPassthrough=1;const{ObjectSetPrototypeOf:n}=requirePrimordials();passthrough=r;const t=requireTransform();n(r.prototype,t.prototype),n(r,t);function r(a){if(!(this instanceof r))return new r(a);t.call(this,a)}return r.prototype._transform=function(a,o,u){u(null,a)},passthrough}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;const n=requireBrowser$2(),{ArrayIsArray:t,Promise:r,SymbolAsyncIterator:a,SymbolDispose:o}=requirePrimordials(),u=requireEndOfStream(),{once:s}=requireUtil$7(),c=requireDestroy(),l=requireDuplex(),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:f,ERR_INVALID_RETURN_VALUE:h,ERR_MISSING_ARGS:v,ERR_STREAM_DESTROYED:g,ERR_STREAM_PREMATURE_CLOSE:b},AbortError:_}=requireErrors(),{validateFunction:S,validateAbortSignal:T}=requireValidators(),{isIterable:w,isReadable:A,isReadableNodeStream:R,isNodeStream:E,isTransformStream:I,isWebStream:L,isReadableStream:F,isReadableFinished:D}=requireUtils$4(),$=globalThis.AbortController||requireBrowser$1().AbortController;let O,P,C;function q(fe,re,ye){let Te=!1;fe.on("close",()=>{Te=!0});const Re=u(fe,{readable:re,writable:ye},ve=>{Te=!ve});return{destroy:ve=>{Te||(Te=!0,c.destroyer(fe,ve||new g("pipe")))},cleanup:Re}}function M(fe){return S(fe[fe.length-1],"streams[stream.length - 1]"),fe.pop()}function N(fe){if(w(fe))return fe;if(R(fe))return G(fe);throw new f("val",["Readable","Iterable","AsyncIterable"],fe)}async function*G(fe){P||(P=requireReadable()),yield*P.prototype[a].call(fe)}async function X(fe,re,ye,{end:Te}){let Re,ve=null;const ce=z=>{if(z&&(Re=z),ve){const B=ve;ve=null,B()}},J=()=>new r((z,B)=>{Re?B(Re):ve=()=>{Re?B(Re):z()}});re.on("drain",ce);const j=u(re,{readable:!1},ce);try{re.writableNeedDrain&&await J();for await(const z of fe)re.write(z)||await J();Te&&(re.end(),await J()),ye()}catch(z){ye(Re!==z?d(Re,z):z)}finally{j(),re.off("drain",ce)}}async function Y(fe,re,ye,{end:Te}){I(re)&&(re=re.writable);const Re=re.getWriter();try{for await(const ve of fe)await Re.ready,Re.write(ve).catch(()=>{});await Re.ready,Te&&await Re.close(),ye()}catch(ve){try{await Re.abort(ve),ye(ve)}catch(ce){ye(ce)}}}function W(...fe){return te(fe,s(M(fe)))}function te(fe,re,ye){if(fe.length===1&&t(fe[0])&&(fe=fe[0]),fe.length<2)throw new v("streams");const Te=new $,Re=Te.signal,ve=ye==null?void 0:ye.signal,ce=[];T(ve,"options.signal");function J(){ie(new _)}C=C||requireUtil$7().addAbortListener;let j;ve&&(j=C(ve,J));let z,B;const U=[];let Z=0;function oe(me){ie(me,--Z===0)}function ie(me,Ie){var Pe;if(me&&(!z||z.code==="ERR_STREAM_PREMATURE_CLOSE")&&(z=me),!(!z&&!Ie)){for(;U.length;)U.shift()(z);(Pe=j)===null||Pe===void 0||Pe[o](),Te.abort(),Ie&&(z||ce.forEach(Ce=>Ce()),n.nextTick(re,z,B))}}let se;for(let me=0;me<fe.length;me++){const Ie=fe[me],Pe=me<fe.length-1,Ce=me>0,pe=Pe||(ye==null?void 0:ye.end)!==!1,H=me===fe.length-1;if(E(Ie)){let V=function(Q){Q&&Q.name!=="AbortError"&&Q.code!=="ERR_STREAM_PREMATURE_CLOSE"&&oe(Q)};var xe=V;if(pe){const{destroy:Q,cleanup:ee}=q(Ie,Pe,Ce);U.push(Q),A(Ie)&&H&&ce.push(ee)}Ie.on("error",V),A(Ie)&&H&&ce.push(()=>{Ie.removeListener("error",V)})}if(me===0)if(typeof Ie=="function"){if(se=Ie({signal:Re}),!w(se))throw new h("Iterable, AsyncIterable or Stream","source",se)}else w(Ie)||R(Ie)||I(Ie)?se=Ie:se=l.from(Ie);else if(typeof Ie=="function"){if(I(se)){var ne;se=N((ne=se)===null||ne===void 0?void 0:ne.readable)}else se=N(se);if(se=Ie(se,{signal:Re}),Pe){if(!w(se,!0))throw new h("AsyncIterable",`transform[${me-1}]`,se)}else{var he;O||(O=requirePassthrough());const V=new O({objectMode:!0}),Q=(he=se)===null||he===void 0?void 0:he.then;if(typeof Q=="function")Z++,Q.call(se,be=>{B=be,be!=null&&V.write(be),pe&&V.end(),n.nextTick(oe)},be=>{V.destroy(be),n.nextTick(oe,be)});else if(w(se,!0))Z++,X(se,V,oe,{end:pe});else if(F(se)||I(se)){const be=se.readable||se;Z++,X(be,V,oe,{end:pe})}else throw new h("AsyncIterable or Promise","destination",se);se=V;const{destroy:ee,cleanup:ae}=q(se,!1,!0);U.push(ee),H&&ce.push(ae)}}else if(E(Ie)){if(R(se)){Z+=2;const V=ue(se,Ie,oe,{end:pe});A(Ie)&&H&&ce.push(V)}else if(I(se)||F(se)){const V=se.readable||se;Z++,X(V,Ie,oe,{end:pe})}else if(w(se))Z++,X(se,Ie,oe,{end:pe});else throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],se);se=Ie}else if(L(Ie)){if(R(se))Z++,Y(N(se),Ie,oe,{end:pe});else if(F(se)||w(se))Z++,Y(se,Ie,oe,{end:pe});else if(I(se))Z++,Y(se.readable,Ie,oe,{end:pe});else throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],se);se=Ie}else se=l.from(Ie)}return(Re!=null&&Re.aborted||ve!=null&&ve.aborted)&&n.nextTick(J),se}function ue(fe,re,ye,{end:Te}){let Re=!1;if(re.on("close",()=>{Re||ye(new b)}),fe.pipe(re,{end:!1}),Te){let ce=function(){Re=!0,re.end()};var ve=ce;D(fe)?n.nextTick(ce):fe.once("end",ce)}else ye();return u(fe,{readable:!0,writable:!1},ce=>{const J=fe._readableState;ce&&ce.code==="ERR_STREAM_PREMATURE_CLOSE"&&J&&J.ended&&!J.errored&&!J.errorEmitted?fe.once("end",ye).once("error",ye):ye(ce)}),u(re,{readable:!1,writable:!0},ye)}return pipeline_1={pipelineImpl:te,pipeline:W},pipeline_1}var compose,hasRequiredCompose;function requireCompose(){if(hasRequiredCompose)return compose;hasRequiredCompose=1;const{pipeline:n}=requirePipeline(),t=requireDuplex(),{destroyer:r}=requireDestroy(),{isNodeStream:a,isReadable:o,isWritable:u,isWebStream:s,isTransformStream:c,isWritableStream:l,isReadableStream:d}=requireUtils$4(),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:h,ERR_MISSING_ARGS:v}}=requireErrors(),g=requireEndOfStream();return compose=function(..._){if(_.length===0)throw new v("streams");if(_.length===1)return t.from(_[0]);const S=[..._];if(typeof _[0]=="function"&&(_[0]=t.from(_[0])),typeof _[_.length-1]=="function"){const O=_.length-1;_[O]=t.from(_[O])}for(let O=0;O<_.length;++O)if(!(!a(_[O])&&!s(_[O]))){if(O<_.length-1&&!(o(_[O])||d(_[O])||c(_[O])))throw new h(`streams[${O}]`,S[O],"must be readable");if(O>0&&!(u(_[O])||l(_[O])||c(_[O])))throw new h(`streams[${O}]`,S[O],"must be writable")}let T,w,A,R,E;function I(O){const P=R;R=null,P?P(O):O?E.destroy(O):!$&&!D&&E.destroy()}const L=_[0],F=n(_,I),D=!!(u(L)||l(L)||c(L)),$=!!(o(F)||d(F)||c(F));if(E=new t({writableObjectMode:!!(L!=null&&L.writableObjectMode),readableObjectMode:!!(F!=null&&F.readableObjectMode),writable:D,readable:$}),D){if(a(L))E._write=function(P,C,q){L.write(P,C)?q():T=q},E._final=function(P){L.end(),w=P},L.on("drain",function(){if(T){const P=T;T=null,P()}});else if(s(L)){const C=(c(L)?L.writable:L).getWriter();E._write=async function(q,M,N){try{await C.ready,C.write(q).catch(()=>{}),N()}catch(G){N(G)}},E._final=async function(q){try{await C.ready,C.close().catch(()=>{}),w=q}catch(M){q(M)}}}const O=c(F)?F.readable:F;g(O,()=>{if(w){const P=w;w=null,P()}})}if($){if(a(F))F.on("readable",function(){if(A){const O=A;A=null,O()}}),F.on("end",function(){E.push(null)}),E._read=function(){for(;;){const O=F.read();if(O===null){A=E._read;return}if(!E.push(O))return}};else if(s(F)){const P=(c(F)?F.readable:F).getReader();E._read=async function(){for(;;)try{const{value:C,done:q}=await P.read();if(!E.push(C))return;if(q){E.push(null);return}}catch{return}}}}return E._destroy=function(O,P){!O&&R!==null&&(O=new f),A=null,T=null,w=null,R===null?P(O):(R=P,a(F)&&r(F,O))},E},compose}var hasRequiredOperators;function requireOperators(){if(hasRequiredOperators)return operators;hasRequiredOperators=1;const n=globalThis.AbortController||requireBrowser$1().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:r,ERR_MISSING_ARGS:a,ERR_OUT_OF_RANGE:o},AbortError:u}=requireErrors(),{validateAbortSignal:s,validateInteger:c,validateObject:l}=requireValidators(),d=requirePrimordials().Symbol("kWeak"),f=requirePrimordials().Symbol("kResistStopPropagation"),{finished:h}=requireEndOfStream(),v=requireCompose(),{addAbortSignalNoValidate:g}=requireAddAbortSignal(),{isWritable:b,isNodeStream:_}=requireUtils$4(),{deprecate:S}=requireUtil$7(),{ArrayPrototypePush:T,Boolean:w,MathFloor:A,Number:R,NumberIsNaN:E,Promise:I,PromiseReject:L,PromiseResolve:F,PromisePrototypeThen:D,Symbol:$}=requirePrimordials(),O=$("kEmpty"),P=$("kEof");function C(ve,ce){if(ce!=null&&l(ce,"options"),(ce==null?void 0:ce.signal)!=null&&s(ce.signal,"options.signal"),_(ve)&&!b(ve))throw new t("stream",ve,"must be writable");const J=v(this,ve);return ce!=null&&ce.signal&&g(ce.signal,J),J}function q(ve,ce){if(typeof ve!="function")throw new r("fn",["Function","AsyncFunction"],ve);ce!=null&&l(ce,"options"),(ce==null?void 0:ce.signal)!=null&&s(ce.signal,"options.signal");let J=1;(ce==null?void 0:ce.concurrency)!=null&&(J=A(ce.concurrency));let j=J-1;return(ce==null?void 0:ce.highWaterMark)!=null&&(j=A(ce.highWaterMark)),c(J,"options.concurrency",1),c(j,"options.highWaterMark",0),j+=J,(async function*(){const B=requireUtil$7().AbortSignalAny([ce==null?void 0:ce.signal].filter(w)),U=this,Z=[],oe={signal:B};let ie,se,ne=!1,he=0;function xe(){ne=!0,me()}function me(){he-=1,Ie()}function Ie(){se&&!ne&&he<J&&Z.length<j&&(se(),se=null)}async function Pe(){try{for await(let Ce of U){if(ne)return;if(B.aborted)throw new u;try{if(Ce=ve(Ce,oe),Ce===O)continue;Ce=F(Ce)}catch(pe){Ce=L(pe)}he+=1,D(Ce,me,xe),Z.push(Ce),ie&&(ie(),ie=null),!ne&&(Z.length>=j||he>=J)&&await new I(pe=>{se=pe})}Z.push(P)}catch(Ce){const pe=L(Ce);D(pe,me,xe),Z.push(pe)}finally{ne=!0,ie&&(ie(),ie=null)}}Pe();try{for(;;){for(;Z.length>0;){const Ce=await Z[0];if(Ce===P)return;if(B.aborted)throw new u;Ce!==O&&(yield Ce),Z.shift(),Ie()}await new I(Ce=>{ie=Ce})}}finally{ne=!0,se&&(se(),se=null)}}).call(this)}function M(ve=void 0){return ve!=null&&l(ve,"options"),(ve==null?void 0:ve.signal)!=null&&s(ve.signal,"options.signal"),(async function*(){let J=0;for await(const z of this){var j;if(ve!=null&&(j=ve.signal)!==null&&j!==void 0&&j.aborted)throw new u({cause:ve.signal.reason});yield[J++,z]}}).call(this)}async function N(ve,ce=void 0){for await(const J of W.call(this,ve,ce))return!0;return!1}async function G(ve,ce=void 0){if(typeof ve!="function")throw new r("fn",["Function","AsyncFunction"],ve);return!await N.call(this,async(...J)=>!await ve(...J),ce)}async function X(ve,ce){for await(const J of W.call(this,ve,ce))return J}async function Y(ve,ce){if(typeof ve!="function")throw new r("fn",["Function","AsyncFunction"],ve);async function J(j,z){return await ve(j,z),O}for await(const j of q.call(this,J,ce));}function W(ve,ce){if(typeof ve!="function")throw new r("fn",["Function","AsyncFunction"],ve);async function J(j,z){return await ve(j,z)?j:O}return q.call(this,J,ce)}class te extends a{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ue(ve,ce,J){var j;if(typeof ve!="function")throw new r("reducer",["Function","AsyncFunction"],ve);J!=null&&l(J,"options"),(J==null?void 0:J.signal)!=null&&s(J.signal,"options.signal");let z=arguments.length>1;if(J!=null&&(j=J.signal)!==null&&j!==void 0&&j.aborted){const ie=new u(void 0,{cause:J.signal.reason});throw this.once("error",()=>{}),await h(this.destroy(ie)),ie}const B=new n,U=B.signal;if(J!=null&&J.signal){const ie={once:!0,[d]:this,[f]:!0};J.signal.addEventListener("abort",()=>B.abort(),ie)}let Z=!1;try{for await(const ie of this){var oe;if(Z=!0,J!=null&&(oe=J.signal)!==null&&oe!==void 0&&oe.aborted)throw new u;z?ce=await ve(ce,ie,{signal:U}):(ce=ie,z=!0)}if(!Z&&!z)throw new te}finally{B.abort()}return ce}async function fe(ve){ve!=null&&l(ve,"options"),(ve==null?void 0:ve.signal)!=null&&s(ve.signal,"options.signal");const ce=[];for await(const j of this){var J;if(ve!=null&&(J=ve.signal)!==null&&J!==void 0&&J.aborted)throw new u(void 0,{cause:ve.signal.reason});T(ce,j)}return ce}function re(ve,ce){const J=q.call(this,ve,ce);return(async function*(){for await(const z of J)yield*z}).call(this)}function ye(ve){if(ve=R(ve),E(ve))return 0;if(ve<0)throw new o("number",">= 0",ve);return ve}function Te(ve,ce=void 0){return ce!=null&&l(ce,"options"),(ce==null?void 0:ce.signal)!=null&&s(ce.signal,"options.signal"),ve=ye(ve),(async function*(){var j;if(ce!=null&&(j=ce.signal)!==null&&j!==void 0&&j.aborted)throw new u;for await(const B of this){var z;if(ce!=null&&(z=ce.signal)!==null&&z!==void 0&&z.aborted)throw new u;ve--<=0&&(yield B)}}).call(this)}function Re(ve,ce=void 0){return ce!=null&&l(ce,"options"),(ce==null?void 0:ce.signal)!=null&&s(ce.signal,"options.signal"),ve=ye(ve),(async function*(){var j;if(ce!=null&&(j=ce.signal)!==null&&j!==void 0&&j.aborted)throw new u;for await(const B of this){var z;if(ce!=null&&(z=ce.signal)!==null&&z!==void 0&&z.aborted)throw new u;if(ve-- >0&&(yield B),ve<=0)return}}).call(this)}return operators.streamReturningOperators={asIndexedPairs:S(M,"readable.asIndexedPairs will be removed in a future version."),drop:Te,filter:W,flatMap:re,map:q,take:Re,compose:C},operators.promiseReturningOperators={every:G,forEach:Y,reduce:ue,toArray:fe,some:N,find:X},operators}var promises,hasRequiredPromises;function requirePromises(){if(hasRequiredPromises)return promises;hasRequiredPromises=1;const{ArrayPrototypePop:n,Promise:t}=requirePrimordials(),{isIterable:r,isNodeStream:a,isWebStream:o}=requireUtils$4(),{pipelineImpl:u}=requirePipeline(),{finished:s}=requireEndOfStream();requireStream();function c(...l){return new t((d,f)=>{let h,v;const g=l[l.length-1];if(g&&typeof g=="object"&&!a(g)&&!r(g)&&!o(g)){const b=n(l);h=b.signal,v=b.end}u(l,(b,_)=>{b?f(b):d(_)},{signal:h,end:v})})}return promises={finished:s,pipeline:c},promises}var hasRequiredStream;function requireStream(){if(hasRequiredStream)return stream.exports;hasRequiredStream=1;const{Buffer:n}=requireBuffer(),{ObjectDefineProperty:t,ObjectKeys:r,ReflectApply:a}=requirePrimordials(),{promisify:{custom:o}}=requireUtil$7(),{streamReturningOperators:u,promiseReturningOperators:s}=requireOperators(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=requireErrors(),l=requireCompose(),{setDefaultHighWaterMark:d,getDefaultHighWaterMark:f}=requireState(),{pipeline:h}=requirePipeline(),{destroyer:v}=requireDestroy(),g=requireEndOfStream(),b=requirePromises(),_=requireUtils$4(),S=stream.exports=requireLegacy$1().Stream;S.isDestroyed=_.isDestroyed,S.isDisturbed=_.isDisturbed,S.isErrored=_.isErrored,S.isReadable=_.isReadable,S.isWritable=_.isWritable,S.Readable=requireReadable();for(const A of r(u)){let E=function(...I){if(new.target)throw c();return S.Readable.from(a(R,this,I))};var w=E;const R=u[A];t(E,"name",{__proto__:null,value:R.name}),t(E,"length",{__proto__:null,value:R.length}),t(S.Readable.prototype,A,{__proto__:null,value:E,enumerable:!1,configurable:!0,writable:!0})}for(const A of r(s)){let E=function(...L){if(new.target)throw c();return a(R,this,L)};var w=E;const R=s[A];t(E,"name",{__proto__:null,value:R.name}),t(E,"length",{__proto__:null,value:R.length}),t(S.Readable.prototype,A,{__proto__:null,value:E,enumerable:!1,configurable:!0,writable:!0})}S.Writable=requireWritable(),S.Duplex=requireDuplex(),S.Transform=requireTransform(),S.PassThrough=requirePassthrough(),S.pipeline=h;const{addAbortSignal:T}=requireAddAbortSignal();return S.addAbortSignal=T,S.finished=g,S.destroy=v,S.compose=l,S.setDefaultHighWaterMark=d,S.getDefaultHighWaterMark=f,t(S,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return b}}),t(h,o,{__proto__:null,enumerable:!0,get(){return b.pipeline}}),t(g,o,{__proto__:null,enumerable:!0,get(){return b.finished}}),S.Stream=S,S._isUint8Array=function(R){return R instanceof Uint8Array},S._uint8ArrayToBuffer=function(R){return n.from(R.buffer,R.byteOffset,R.byteLength)},stream.exports}browser$1.exports;var hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,function(n){const t=requireStream(),r=requirePromises(),a=t.Readable.destroy;n.exports=t.Readable,n.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,n.exports._isUint8Array=t._isUint8Array,n.exports.isDisturbed=t.isDisturbed,n.exports.isErrored=t.isErrored,n.exports.isReadable=t.isReadable,n.exports.Readable=t.Readable,n.exports.Writable=t.Writable,n.exports.Duplex=t.Duplex,n.exports.Transform=t.Transform,n.exports.PassThrough=t.PassThrough,n.exports.addAbortSignal=t.addAbortSignal,n.exports.finished=t.finished,n.exports.destroy=t.destroy,n.exports.destroy=a,n.exports.pipeline=t.pipeline,n.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return r}}),n.exports.Stream=t.Stream,n.exports.default=n.exports}(browser$1)),browser$1.exports}var hasRequiredActorQueryResultSerializeJson;function requireActorQueryResultSerializeJson(){if(hasRequiredActorQueryResultSerializeJson)return ActorQueryResultSerializeJson;hasRequiredActorQueryResultSerializeJson=1,Object.defineProperty(ActorQueryResultSerializeJson,"__esModule",{value:!0}),ActorQueryResultSerializeJson.ActorQueryResultSerializeJson=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireAsynciterator(),a=requireRdfString(),o=requireBrowser();let u=class extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c)}async testHandleChecked(c,l){return["bindings","quads","boolean"].includes(c.type)?(0,t.passTestVoid)():(0,t.failTest)("This actor can only handle bindings or quad streams.")}async runHandle(c,l,d){const f=new o.Readable;if(f._read=()=>{},c.type==="bindings"||c.type==="quads"){let h=c.type==="bindings"?(0,r.wrap)(c.bindingsStream).map(g=>JSON.stringify(Object.fromEntries([...g].map(([b,_])=>[b.value,a.termToString(_)])))):(0,r.wrap)(c.quadStream).map(g=>JSON.stringify(a.quadToStringQuad(g))),v=!0;h=h.map(g=>{const b=`${v?"":","}
${g}`;return v=!1,b}).prepend(["["]).append([`
]
`]),f.wrap(h)}else try{f.push(`${JSON.stringify(await c.execute())}
`),f.push(null)}catch(h){setTimeout(()=>f.emit("error",h))}return{data:f}}};return ActorQueryResultSerializeJson.ActorQueryResultSerializeJson=u,ActorQueryResultSerializeJson}var hasRequiredLib$3X;function requireLib$3X(){return hasRequiredLib$3X||(hasRequiredLib$3X=1,function(n){var t=lib$3Z&&lib$3Z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3Z&&lib$3Z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeJson(),n)}(lib$3Z)),lib$3Z}var lib$3W={},ActorQueryResultSerializeSimple={},hasRequiredActorQueryResultSerializeSimple;function requireActorQueryResultSerializeSimple(){if(hasRequiredActorQueryResultSerializeSimple)return ActorQueryResultSerializeSimple;hasRequiredActorQueryResultSerializeSimple=1,Object.defineProperty(ActorQueryResultSerializeSimple,"__esModule",{value:!0}),ActorQueryResultSerializeSimple.ActorQueryResultSerializeSimple=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireAsynciterator(),a=requireRdfString(),o=requireBrowser();let u=class Ur extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c)}async testHandleChecked(c,l){return["bindings","quads","boolean","void"].includes(c.type)?(0,t.passTestVoid)():(0,t.failTest)("This actor can only handle bindings streams, quad streams, booleans, or updates.")}static termToString(c){return c.termType==="Quad"?(0,a.termToString)(c):c.value}async runHandle(c,l,d){const f=new o.Readable;return c.type==="bindings"?f.wrap(c.bindingsStream.map(h=>`${[...h].map(([v,g])=>`?${v.value}: ${Ur.termToString(g)}`).join(`
`)}

`)):c.type==="quads"?f.wrap(c.quadStream.map(h=>`subject: ${Ur.termToString(h.subject)}
predicate: ${Ur.termToString(h.predicate)}
object: ${Ur.termToString(h.object)}
graph: ${Ur.termToString(h.graph)}

`)):f.wrap((0,r.wrap)(c.type==="boolean"?c.execute().then(h=>[`${h}
`]):c.execute().then(()=>[`ok
`]))),{data:f}}};return ActorQueryResultSerializeSimple.ActorQueryResultSerializeSimple=u,ActorQueryResultSerializeSimple}var hasRequiredLib$3W;function requireLib$3W(){return hasRequiredLib$3W||(hasRequiredLib$3W=1,function(n){var t=lib$3W&&lib$3W.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3W&&lib$3W.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeSimple(),n)}(lib$3W)),lib$3W}var lib$3V={},ActorQueryResultSerializeSparqlCsv={},hasRequiredActorQueryResultSerializeSparqlCsv;function requireActorQueryResultSerializeSparqlCsv(){if(hasRequiredActorQueryResultSerializeSparqlCsv)return ActorQueryResultSerializeSparqlCsv;hasRequiredActorQueryResultSerializeSparqlCsv=1,Object.defineProperty(ActorQueryResultSerializeSparqlCsv,"__esModule",{value:!0}),ActorQueryResultSerializeSparqlCsv.ActorQueryResultSerializeSparqlCsv=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireBrowser();let a=class rn extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(u){super(u)}static bindingToCsvBindings(u){if(!u)return"";let s=u.value;if(u.termType==="Literal")s=`${s}`;else if(u.termType==="BlankNode")s=`_:${s}`;else if(u.termType==="Quad"){let c=rn.bindingToCsvBindings(u.object);u.object.termType==="Literal"&&(c=`"${c.replaceAll('"','""')}"`),s=`<< ${rn.bindingToCsvBindings(u.subject)} ${rn.bindingToCsvBindings(u.predicate)} ${c} >>`}else s=`<${s}>`;return/[",\n\r]/u.test(s)&&(s=`"${s.replaceAll('"','""')}"`),s}async testHandleChecked(u,s){return u.type!=="bindings"?(0,t.failTest)("This actor can only handle bindings streams."):(0,t.passTestVoid)()}async runHandle(u,s,c){const l=u,d=new r.Readable,f=await l.metadata();return d.push(`${f.variables.map(h=>h.variable.value).join(",")}\r
`),d.wrap(l.bindingsStream.map(h=>`${f.variables.map(v=>rn.bindingToCsvBindings(h.get(v.variable))).join(",")}\r
`)),{data:d}}};return ActorQueryResultSerializeSparqlCsv.ActorQueryResultSerializeSparqlCsv=a,ActorQueryResultSerializeSparqlCsv}var hasRequiredLib$3V;function requireLib$3V(){return hasRequiredLib$3V||(hasRequiredLib$3V=1,function(n){var t=lib$3V&&lib$3V.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3V&&lib$3V.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeSparqlCsv(),n)}(lib$3V)),lib$3V}var lib$3U={},ActorQueryResultSerializeSparqlTsv={},rdfStringTtl={},TermUtil={},hasRequiredTermUtil;function requireTermUtil(){if(hasRequiredTermUtil)return TermUtil;hasRequiredTermUtil=1,Object.defineProperty(TermUtil,"__esModule",{value:!0}),TermUtil.stringQuadToQuad=TermUtil.quadToStringQuad=TermUtil.stringToTerm=TermUtil.getLiteralLanguage=TermUtil.getLiteralType=TermUtil.getLiteralValue=TermUtil.termToString=void 0;const n=requireRdfDataFactory(),t=new n.DataFactory;function r(b){if(b)switch(b.termType){case"NamedNode":return`<${d(b.value)}>`;case"BlankNode":return`_:${b.value}`;case"Literal":{const _=b;return`"${f(_.value)}"${_.datatype&&_.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"&&_.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"?`^^<${_.datatype.value}>`:""}${_.language?`@${_.language}`:""}`}case"Quad":return`<<${r(b.subject)} ${r(b.predicate)} ${r(b.object)}${b.graph.termType==="DefaultGraph"?"":` ${r(b.graph)}`}>>`;case"Variable":return`?${b.value}`;case"DefaultGraph":return b.value}}TermUtil.termToString=r;function a(b){const _=/^"([^]*)"((\^\^.*)|(@.*))?$/u.exec(b);if(!_)throw new Error(`${b} is not a literal`);return _[1].replace(/\\"/ug,'"')}TermUtil.getLiteralValue=a;function o(b){const _=/^"[^]*"(?:\^\^<([^"]+)>|(@)[^@"]+)?$/u.exec(b);if(!_)throw new Error(`${b} is not a literal`);return _[1]||(_[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}TermUtil.getLiteralType=o;function u(b){const _=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/u.exec(b);if(!_)throw new Error(`${b} is not a literal`);return _[1]?_[1].toLowerCase():""}TermUtil.getLiteralLanguage=u;function s(b,_){if(_=_||t,!b||b.length===0)return _.defaultGraph();switch(b[0]){case"_":return _.blankNode(b.slice(2));case"?":if(!_.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return _.variable(b.slice(1));case'"':{const S=u(b),T=_.namedNode(o(b));return _.literal(a(b),S||T)}case"<":default:if(b.startsWith("<<")&&b.endsWith(">>")){const S=b.slice(2,-2),T=[];let w=0,A=0;for(let R=0;R<S.length;R++){const E=S[R];if(E==="<"&&w++,E===">"){if(w===0)throw new Error(`Found closing tag without opening tag in ${b}`);w--}E===" "&&w===0&&(T.push(S.slice(A,R)),A=R+1)}if(w!==0)throw new Error(`Found opening tag without closing tag in ${b}`);if(T.push(S.slice(A,S.length)),T.length!==3&&T.length!==4)throw new Error(`Nested quad syntax error ${b}`);return _.quad(s(T[0]),s(T[1]),s(T[2]),T[3]?s(T[3]):void 0)}if(!b.startsWith("<")||!b.endsWith(">"))throw new Error(`Detected invalid iri for named node (must be wrapped in <>): ${b}`);return _.namedNode(b.slice(1,-1))}}TermUtil.stringToTerm=s;function c(b){return{subject:r(b.subject),predicate:r(b.predicate),object:r(b.object),graph:r(b.graph)}}TermUtil.quadToStringQuad=c;function l(b,_){return _=_||t,_.quad(s(b.subject,_),s(b.predicate,_),s(b.object,_),s(b.graph,_))}TermUtil.stringQuadToQuad=l;function d(b){return b.replace(h,g)}function f(b){return h.test(b)&&(b=b.replace(h,g)),b}const h=/["\\\t\n\r\b\f\u0000-\u0019]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v=new Map([["\\","\\\\"],['"','\\"'],["	","\\t"],[`
`,"\\n"],["\r","\\r"],["\b","\\b"],["\f","\\f"]]);function g(b){const _=v.get(b);if(!_){if(b.length===1){const T=b.charCodeAt(0).toString(16);return`${"\\u0000".slice(0,-T.length)}${T}`}const S=((b.charCodeAt(0)-55296)*1024+b.charCodeAt(1)+9216).toString(16);return`${"\\U00000000".slice(0,-S.length)}${S}`}return _}return TermUtil}var hasRequiredRdfStringTtl;function requireRdfStringTtl(){return hasRequiredRdfStringTtl||(hasRequiredRdfStringTtl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.termToString=n.stringToTerm=n.stringQuadToQuad=n.quadToStringQuad=n.getLiteralValue=n.getLiteralType=n.getLiteralLanguage=void 0;const t=requireTermUtil();Object.defineProperty(n,"getLiteralLanguage",{enumerable:!0,get:function(){return t.getLiteralLanguage}}),Object.defineProperty(n,"getLiteralType",{enumerable:!0,get:function(){return t.getLiteralType}}),Object.defineProperty(n,"getLiteralValue",{enumerable:!0,get:function(){return t.getLiteralValue}}),Object.defineProperty(n,"quadToStringQuad",{enumerable:!0,get:function(){return t.quadToStringQuad}}),Object.defineProperty(n,"stringQuadToQuad",{enumerable:!0,get:function(){return t.stringQuadToQuad}}),Object.defineProperty(n,"stringToTerm",{enumerable:!0,get:function(){return t.stringToTerm}}),Object.defineProperty(n,"termToString",{enumerable:!0,get:function(){return t.termToString}})}(rdfStringTtl)),rdfStringTtl}var hasRequiredActorQueryResultSerializeSparqlTsv;function requireActorQueryResultSerializeSparqlTsv(){if(hasRequiredActorQueryResultSerializeSparqlTsv)return ActorQueryResultSerializeSparqlTsv;hasRequiredActorQueryResultSerializeSparqlTsv=1,Object.defineProperty(ActorQueryResultSerializeSparqlTsv,"__esModule",{value:!0}),ActorQueryResultSerializeSparqlTsv.ActorQueryResultSerializeSparqlTsv=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireRdfStringTtl(),a=requireBrowser();let o=class Wi extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(s){super(s)}static bindingToTsvBindings(s){return s?(0,r.termToString)(s).replaceAll("	","\\t").replaceAll(`
`,"\\n").replaceAll("\r","\\r"):""}async testHandleChecked(s,c){return s.type!=="bindings"?(0,t.failTest)("This actor can only handle bindings streams."):(0,t.passTestVoid)()}async runHandle(s,c,l){const d=s,f=new a.Readable,h=await d.metadata();return f.push(`${h.variables.map(v=>v.variable.value).join("	")}
`),f.wrap(d.bindingsStream.map(v=>`${h.variables.map(g=>Wi.bindingToTsvBindings(v.get(g.variable))).join("	")}
`)),{data:f}}};return ActorQueryResultSerializeSparqlTsv.ActorQueryResultSerializeSparqlTsv=o,ActorQueryResultSerializeSparqlTsv}var hasRequiredLib$3U;function requireLib$3U(){return hasRequiredLib$3U||(hasRequiredLib$3U=1,function(n){var t=lib$3U&&lib$3U.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3U&&lib$3U.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeSparqlTsv(),n)}(lib$3U)),lib$3U}var lib$3T={},ActorQueryResultSerializeSparqlXml={},XmlSerializer={},hasRequiredXmlSerializer;function requireXmlSerializer(){if(hasRequiredXmlSerializer)return XmlSerializer;hasRequiredXmlSerializer=1,Object.defineProperty(XmlSerializer,"__esModule",{value:!0}),XmlSerializer.XmlSerializer=void 0;let n=class{constructor(){this.stack=[]}open(r,a){const o=`${this.identation()+this.formatTag(r,a,"open")}
`;return this.stack.push(r),o}close(){const r=this.stack.pop();if(r===void 0)throw new Error("There is no tag left to close");return`${this.identation()+this.formatTag(r,{},"close")}
`}serializeNode(r){if(r.children===void 0)return`${this.identation()+this.formatTag(r.name,r.attributes,"self-closing")}
`;if(typeof r.children=="string")return`${this.identation()+this.formatTag(r.name,r.attributes,"open")+this.escape(r.children)+this.formatTag(r.name,{},"close")}
`;const a=[];a.push(`${this.identation()+this.formatTag(r.name,r.attributes,"open")}
`),this.stack.push(r.name);for(const o of r.children)a.push(this.serializeNode(o));return this.stack.pop(),a.push(`${this.identation()+this.formatTag(r.name,{},"close")}
`),a.join("")}identation(){return this.stack.map(r=>"  ").join("")}formatTag(r,a,o){return`<${o==="close"?"/":""}${r}${Object.entries(a??{}).map(u=>` ${u[0]}="${this.escape(u[1])}"`)}${o==="self-closing"?"/":""}>`}escape(r){return r.replaceAll(/["&'<>]/gu,a=>{switch(a){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})}};return XmlSerializer.XmlSerializer=n,n.header=`<?xml version="1.0" encoding="UTF-8"?>
`,XmlSerializer}var hasRequiredActorQueryResultSerializeSparqlXml;function requireActorQueryResultSerializeSparqlXml(){if(hasRequiredActorQueryResultSerializeSparqlXml)return ActorQueryResultSerializeSparqlXml;hasRequiredActorQueryResultSerializeSparqlXml=1,Object.defineProperty(ActorQueryResultSerializeSparqlXml,"__esModule",{value:!0}),ActorQueryResultSerializeSparqlXml.ActorQueryResultSerializeSparqlXml=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireAsynciterator(),a=requireBrowser(),o=requireXmlSerializer();let u=class Yi extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c)}static bindingToXmlBindings(c,l){return{name:"binding",attributes:{name:l.value},children:[this.valueToXmlValue(c)]}}static valueToXmlValue(c){let l;switch(c.termType){case"Literal":return c.language?l={"xml:lang":c.language}:c.datatype&&c.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"?l={datatype:c.datatype.value}:l={},{name:"literal",attributes:l,children:c.value};case"BlankNode":return{name:"bnode",children:c.value};case"Quad":return{name:"triple",children:[{name:"subject",children:[this.valueToXmlValue(c.subject)]},{name:"predicate",children:[this.valueToXmlValue(c.predicate)]},{name:"object",children:[this.valueToXmlValue(c.object)]}]};default:return{name:"uri",children:c.value}}}async testHandleChecked(c,l){return["bindings","boolean"].includes(c.type)?(0,t.passTestVoid)():(0,t.failTest)("This actor can only handle bindings streams or booleans.")}async runHandle(c,l,d){const f=new a.Readable;f._read=()=>{};const h=new o.XmlSerializer,v=await c.metadata();if(f.push(o.XmlSerializer.header),f.push(h.open("sparql",{xmlns:"http://www.w3.org/2005/sparql-results#"})),f.push(h.serializeNode({name:"head",children:v.variables.map(g=>({name:"variable",attributes:{name:g.variable.value}}))})),c.type==="bindings"){function*g(){yield h.close(),yield h.close()}f.push(h.open("results"));const b=(0,r.wrap)(c.bindingsStream).map(_=>h.serializeNode({name:"result",children:[..._].map(([S,T])=>Yi.bindingToXmlBindings(T,S))})).append((0,r.wrap)(g()));f.wrap(b)}else try{const g=await c.execute();f.push(h.serializeNode({name:"boolean",children:g.toString()})),f.push(h.close()),setTimeout(()=>f.push(null))}catch(g){setTimeout(()=>f.emit("error",g))}return{data:f}}};return ActorQueryResultSerializeSparqlXml.ActorQueryResultSerializeSparqlXml=u,ActorQueryResultSerializeSparqlXml}var hasRequiredLib$3T;function requireLib$3T(){return hasRequiredLib$3T||(hasRequiredLib$3T=1,function(n){var t=lib$3T&&lib$3T.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3T&&lib$3T.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeSparqlXml(),n)}(lib$3T)),lib$3T}var lib$3S={},ActorQueryResultSerializeTable={},hasRequiredActorQueryResultSerializeTable;function requireActorQueryResultSerializeTable(){if(hasRequiredActorQueryResultSerializeTable)return ActorQueryResultSerializeTable;hasRequiredActorQueryResultSerializeTable=1,Object.defineProperty(ActorQueryResultSerializeTable,"__esModule",{value:!0}),ActorQueryResultSerializeTable.ActorQueryResultSerializeTable=void 0;const n=requireLib$3Y(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfString(),o=requireRdfTerms(),u=requireBrowser();let s=class li extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(l){super(l),this.padding=li.repeat(" ",this.columnWidth)}static repeat(l,d){return l.repeat(d)}async testHandleChecked(l,d){return["bindings","quads"].includes(l.type)?(0,r.passTestVoid)():(0,r.failTest)("This actor can only handle bindings or quad streams.")}termToString(l){return l.termType==="Quad"?(0,a.termToString)(l):l.value}pad(l){return l.length<=this.columnWidth?l+this.padding.slice(l.length):`${l.slice(0,this.columnWidth-1)}`}pushHeader(l,d){const f=d.map(h=>this.pad(h.value)).join(" ");l.push(`${f}
${li.repeat("-",f.length)}
`)}createRow(l,d){return`${l.map(f=>d.has(f)?this.termToString(d.get(f)):"").map(f=>this.pad(f)).join(" ")}
`}async runHandle(l,d,f){const h=new u.Readable;let v;if(l.type==="bindings"){v=l.bindingsStream.map(b=>this.createRow(g,b));const g=(await l.metadata()).variables.map(b=>b.variable);this.pushHeader(h,g)}else{v=l.quadStream.map(b=>`${(0,o.getTerms)(b).map(_=>this.pad(this.termToString(_))).join(" ")}
`);const g=l.context.getSafe(t.KeysInitQuery.dataFactory);this.pushHeader(h,o.QUAD_TERM_NAMES.map(b=>g.variable(b)))}return h.wrap(v),{data:h}}};return ActorQueryResultSerializeTable.ActorQueryResultSerializeTable=s,ActorQueryResultSerializeTable}var hasRequiredLib$3S;function requireLib$3S(){return hasRequiredLib$3S||(hasRequiredLib$3S=1,function(n){var t=lib$3S&&lib$3S.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3S&&lib$3S.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeTable(),n)}(lib$3S)),lib$3S}var lib$3R={},ActorQueryResultSerializeTree={},sparqljsonToTree={},Converter={},rdfLiteral={},handler={},TypeHandlerBoolean={},Translator={},hasRequiredTranslator;function requireTranslator(){if(hasRequiredTranslator)return Translator;hasRequiredTranslator=1,Object.defineProperty(Translator,"__esModule",{value:!0}),Translator.Translator=void 0;let n=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(r){throw new Error(`Invalid RDF ${r.datatype.value} value: '${r.value}'`)}registerHandler(r,a,o){for(const u of a)this.supportedRdfDatatypes.push(u),this.fromRdfHandlers[u.value]=r;for(const u of o){let s=this.toRdfHandlers[u];s||(this.toRdfHandlers[u]=s=[]),s.push(r)}}fromRdf(r,a){const o=this.fromRdfHandlers[r.datatype.value];return o?o.fromRdf(r,a):r.value}toRdf(r,a){const o=this.toRdfHandlers[typeof r];if(o)for(const u of o){const s=u.toRdf(r,a);if(s)return s}throw new Error(`Invalid JavaScript value: '${r}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}};return Translator.Translator=n,Translator}var hasRequiredTypeHandlerBoolean;function requireTypeHandlerBoolean(){if(hasRequiredTypeHandlerBoolean)return TypeHandlerBoolean;hasRequiredTypeHandlerBoolean=1,Object.defineProperty(TypeHandlerBoolean,"__esModule",{value:!0}),TypeHandlerBoolean.TypeHandlerBoolean=void 0;const n=requireTranslator();let t=class Ji{fromRdf(a,o){switch(a.value){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1}return o&&n.Translator.incorrectRdfDataType(a),!1}toRdf(a,{datatype:o,dataFactory:u}){return u.literal(a?"true":"false",o||u.namedNode(Ji.TYPE))}};return t.TYPE="http://www.w3.org/2001/XMLSchema#boolean",TypeHandlerBoolean.TypeHandlerBoolean=t,TypeHandlerBoolean}var TypeHandlerDate={},hasRequiredTypeHandlerDate;function requireTypeHandlerDate(){if(hasRequiredTypeHandlerDate)return TypeHandlerDate;hasRequiredTypeHandlerDate=1,Object.defineProperty(TypeHandlerDate,"__esModule",{value:!0}),TypeHandlerDate.TypeHandlerDate=void 0;const n=requireTranslator();let t=class di{fromRdf(a,o){switch(o&&!a.value.match(di.VALIDATORS[a.datatype.value.substr(33,a.datatype.value.length)])&&n.Translator.incorrectRdfDataType(a),a.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(a.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const u=a.value.split("-");return new Date(0,parseInt(u[0],10)-1,parseInt(u[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(a.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(a.value+"-01");default:return new Date(a.value)}}toRdf(a,{datatype:o,dataFactory:u}){if(o=o||u.namedNode(di.TYPES[0]),!(a instanceof Date))return null;const s=a;let c;switch(o.value){case"http://www.w3.org/2001/XMLSchema#gDay":c=String(s.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":c=s.getUTCMonth()+1+"-"+s.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":c=String(s.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":c=s.getUTCFullYear()+"-"+(s.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":c=s.toISOString().replace(/T.*$/,"");break;default:c=s.toISOString()}return u.literal(c,o)}};return t.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],t.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/},TypeHandlerDate.TypeHandlerDate=t,TypeHandlerDate}var TypeHandlerNumberDouble={},hasRequiredTypeHandlerNumberDouble;function requireTypeHandlerNumberDouble(){if(hasRequiredTypeHandlerNumberDouble)return TypeHandlerNumberDouble;hasRequiredTypeHandlerNumberDouble=1,Object.defineProperty(TypeHandlerNumberDouble,"__esModule",{value:!0}),TypeHandlerNumberDouble.TypeHandlerNumberDouble=void 0;const n=requireTranslator();let t=class Zi{fromRdf(a,o){const u=parseFloat(a.value);return o&&isNaN(u)&&n.Translator.incorrectRdfDataType(a),u}toRdf(a,{datatype:o,dataFactory:u}){return o=o||u.namedNode(Zi.TYPES[0]),isNaN(a)?u.literal("NaN",o):isFinite(a)?a%1===0?null:u.literal(a.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),o):u.literal(a>0?"INF":"-INF",o)}};return t.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"],TypeHandlerNumberDouble.TypeHandlerNumberDouble=t,TypeHandlerNumberDouble}var TypeHandlerNumberInteger={},hasRequiredTypeHandlerNumberInteger;function requireTypeHandlerNumberInteger(){if(hasRequiredTypeHandlerNumberInteger)return TypeHandlerNumberInteger;hasRequiredTypeHandlerNumberInteger=1,Object.defineProperty(TypeHandlerNumberInteger,"__esModule",{value:!0}),TypeHandlerNumberInteger.TypeHandlerNumberInteger=void 0;const n=requireTranslator();let t=class nn{fromRdf(a,o){const u=parseInt(a.value,10);return o&&(isNaN(u)||a.value.indexOf(".")>=0)&&n.Translator.incorrectRdfDataType(a),u}toRdf(a,{datatype:o,dataFactory:u}){return u.literal(String(a),o||(a<=nn.MAX_INT&&a>=nn.MIN_INT?u.namedNode(nn.TYPES[0]):u.namedNode(nn.TYPES[1])))}};return t.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],t.MAX_INT=2147483647,t.MIN_INT=-2147483648,TypeHandlerNumberInteger.TypeHandlerNumberInteger=t,TypeHandlerNumberInteger}var TypeHandlerString={},hasRequiredTypeHandlerString;function requireTypeHandlerString(){if(hasRequiredTypeHandlerString)return TypeHandlerString;hasRequiredTypeHandlerString=1,Object.defineProperty(TypeHandlerString,"__esModule",{value:!0}),TypeHandlerString.TypeHandlerString=void 0;let n=class{fromRdf(r){return r.value}toRdf(r,{datatype:a,dataFactory:o}){return o.literal(r,a)}};return n.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"],TypeHandlerString.TypeHandlerString=n,TypeHandlerString}var hasRequiredHandler;function requireHandler(){return hasRequiredHandler||(hasRequiredHandler=1,function(n){var t=handler&&handler.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=handler&&handler.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireTypeHandlerBoolean(),n),r(requireTypeHandlerDate(),n),r(requireTypeHandlerNumberDouble(),n),r(requireTypeHandlerNumberInteger(),n),r(requireTypeHandlerString(),n)}(handler)),handler}var ITypeHandler={},hasRequiredITypeHandler;function requireITypeHandler(){return hasRequiredITypeHandler||(hasRequiredITypeHandler=1,Object.defineProperty(ITypeHandler,"__esModule",{value:!0})),ITypeHandler}var hasRequiredRdfLiteral;function requireRdfLiteral(){return hasRequiredRdfLiteral||(hasRequiredRdfLiteral=1,function(n){var t=rdfLiteral&&rdfLiteral.__createBinding||(Object.create?function(g,b,_,S){S===void 0&&(S=_);var T=Object.getOwnPropertyDescriptor(b,_);(!T||("get"in T?!b.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return b[_]}}),Object.defineProperty(g,S,T)}:function(g,b,_,S){S===void 0&&(S=_),g[S]=b[_]}),r=rdfLiteral&&rdfLiteral.__exportStar||function(g,b){for(var _ in g)_!=="default"&&!Object.prototype.hasOwnProperty.call(b,_)&&t(b,g,_)};Object.defineProperty(n,"__esModule",{value:!0}),n.getSupportedJavaScriptPrimitives=n.getSupportedRdfDatatypes=n.getTermRaw=n.toRdf=n.fromRdf=void 0;const a=requireRdfDataFactory(),o=requireHandler(),u=requireTranslator();r(requireHandler(),n),r(requireITypeHandler(),n),r(requireTranslator(),n);const s=new a.DataFactory,c=new u.Translator;c.registerHandler(new o.TypeHandlerString,o.TypeHandlerString.TYPES.map(g=>s.namedNode(g)),["string"]),c.registerHandler(new o.TypeHandlerBoolean,[o.TypeHandlerBoolean.TYPE].map(g=>s.namedNode(g)),["boolean"]),c.registerHandler(new o.TypeHandlerNumberDouble,o.TypeHandlerNumberDouble.TYPES.map(g=>s.namedNode(g)),["number"]),c.registerHandler(new o.TypeHandlerNumberInteger,o.TypeHandlerNumberInteger.TYPES.map(g=>s.namedNode(g)),["number"]),c.registerHandler(new o.TypeHandlerDate,o.TypeHandlerDate.TYPES.map(g=>s.namedNode(g)),["object"]);function l(g,b){return c.fromRdf(g,b)}n.fromRdf=l;function d(g,b){return b&&"namedNode"in b&&(b={dataFactory:b}),b=b||{},b&&!b.dataFactory&&(b.dataFactory=s),c.toRdf(g,b)}n.toRdf=d;function f(g,b){return g.termType==="Literal"?l(g,b):g.value}n.getTermRaw=f;function h(){return c.getSupportedRdfDatatypes()}n.getSupportedRdfDatatypes=h;function v(){return c.getSupportedJavaScriptPrimitives()}n.getSupportedJavaScriptPrimitives=v}(rdfLiteral)),rdfLiteral}var sparqljsonParse={},SparqlJsonParser={},jsonparse,hasRequiredJsonparse;function requireJsonparse(){if(hasRequiredJsonparse)return jsonparse;hasRequiredJsonparse=1;var{Buffer:n}=requireBuffer(),t={},r=t.LEFT_BRACE=1,a=t.RIGHT_BRACE=2,o=t.LEFT_BRACKET=3,u=t.RIGHT_BRACKET=4,s=t.COLON=5,c=t.COMMA=6,l=t.TRUE=7,d=t.FALSE=8,f=t.NULL=9,h=t.STRING=10,v=t.NUMBER=11,g=t.START=17,b=t.STOP=18,_=t.TRUE1=33,S=t.TRUE2=34,T=t.TRUE3=35,w=t.FALSE1=49,A=t.FALSE2=50,R=t.FALSE3=51,E=t.FALSE4=52,I=t.NULL1=65,L=t.NULL2=66,F=t.NULL3=67,D=t.NUMBER1=81,$=t.NUMBER3=83,O=t.STRING1=97,P=t.STRING2=98,C=t.STRING3=99,q=t.STRING4=100,M=t.STRING5=101,N=t.STRING6=102,G=t.VALUE=113,X=t.KEY=114,Y=t.OBJECT=129,W=t.ARRAY=130,te=92,ue=47,fe=8,re=12,ye=10,Te=13,Re=9,ve=64*1024;function ce(z){return n.alloc?n.alloc(z):new n(z)}function J(){this.tState=g,this.value=void 0,this.string=void 0,this.stringBuffer=ce(ve),this.stringBufferOffset=0,this.unicode=void 0,this.highSurrogate=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=G,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:ce(2),3:ce(3),4:ce(4)},this.offset=-1}J.toknam=function(z){for(var B=Object.keys(t),U=0,Z=B.length;U<Z;U++){var oe=B[U];if(t[oe]===z)return oe}return z&&"0x"+z.toString(16)};var j=J.prototype;return j.onError=function(z){throw z},j.charError=function(z,B){this.tState=b,this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(z[B]))+" at position "+B+" in state "+J.toknam(this.tState)))},j.appendStringChar=function(z){this.stringBufferOffset>=ve&&(this.string+=this.stringBuffer.toString("utf8"),this.stringBufferOffset=0),this.stringBuffer[this.stringBufferOffset++]=z},j.appendStringBuf=function(z,B,U){var Z=z.length;typeof B=="number"&&(typeof U=="number"?U<0?Z=z.length-B+U:Z=U-B:Z=z.length-B),Z<0&&(Z=0),this.stringBufferOffset+Z>ve&&(this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0),z.copy(this.stringBuffer,this.stringBufferOffset,B,U),this.stringBufferOffset+=Z},j.write=function(z){typeof z=="string"&&(z=new n(z));for(var B,U=0,Z=z.length;U<Z;U++)if(this.tState===g){if(B=z[U],this.offset++,B===123)this.onToken(r,"{");else if(B===125)this.onToken(a,"}");else if(B===91)this.onToken(o,"[");else if(B===93)this.onToken(u,"]");else if(B===58)this.onToken(s,":");else if(B===44)this.onToken(c,",");else if(B===116)this.tState=_;else if(B===102)this.tState=w;else if(B===110)this.tState=I;else if(B===34)this.string="",this.stringBufferOffset=0,this.tState=O;else if(B===45)this.string="-",this.tState=D;else if(B>=48&&B<64)this.string=String.fromCharCode(B),this.tState=$;else if(!(B===32||B===9||B===10||B===13))return this.charError(z,U)}else if(this.tState===O)if(B=z[U],this.bytes_remaining>0){for(var oe=0;oe<this.bytes_remaining;oe++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+oe]=z[oe];this.appendStringBuf(this.temp_buffs[this.bytes_in_sequence]),this.bytes_in_sequence=this.bytes_remaining=0,U=U+oe-1}else if(this.bytes_remaining===0&&B>=128){if(B<=193||B>244)return this.onError(new Error("Invalid UTF-8 character at position "+U+" in state "+J.toknam(this.tState)));if(B>=194&&B<=223&&(this.bytes_in_sequence=2),B>=224&&B<=239&&(this.bytes_in_sequence=3),B>=240&&B<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+U>z.length){for(var ie=0;ie<=z.length-1-U;ie++)this.temp_buffs[this.bytes_in_sequence][ie]=z[U+ie];this.bytes_remaining=U+this.bytes_in_sequence-z.length,U=z.length-1}else this.appendStringBuf(z,U,U+this.bytes_in_sequence),U=U+this.bytes_in_sequence-1}else if(B===34)this.tState=g,this.string+=this.stringBuffer.toString("utf8",0,this.stringBufferOffset),this.stringBufferOffset=0,this.onToken(h,this.string),this.offset+=n.byteLength(this.string,"utf8")+1,this.string=void 0;else if(B===92)this.tState=P;else if(B>=32)this.appendStringChar(B);else return this.charError(z,U);else if(this.tState===P)if(B=z[U],B===34)this.appendStringChar(B),this.tState=O;else if(B===92)this.appendStringChar(te),this.tState=O;else if(B===47)this.appendStringChar(ue),this.tState=O;else if(B===98)this.appendStringChar(fe),this.tState=O;else if(B===102)this.appendStringChar(re),this.tState=O;else if(B===110)this.appendStringChar(ye),this.tState=O;else if(B===114)this.appendStringChar(Te),this.tState=O;else if(B===116)this.appendStringChar(Re),this.tState=O;else if(B===117)this.unicode="",this.tState=C;else return this.charError(z,U);else if(this.tState===C||this.tState===q||this.tState===M||this.tState===N)if(B=z[U],B>=48&&B<64||B>64&&B<=70||B>96&&B<=102){if(this.unicode+=String.fromCharCode(B),this.tState++===N){var se=parseInt(this.unicode,16);this.unicode=void 0,this.highSurrogate!==void 0&&se>=56320&&se<57344?(this.appendStringBuf(new n(String.fromCharCode(this.highSurrogate,se))),this.highSurrogate=void 0):this.highSurrogate===void 0&&se>=55296&&se<56320?this.highSurrogate=se:(this.highSurrogate!==void 0&&(this.appendStringBuf(new n(String.fromCharCode(this.highSurrogate))),this.highSurrogate=void 0),this.appendStringBuf(new n(String.fromCharCode(se)))),this.tState=O}}else return this.charError(z,U);else if(this.tState===D||this.tState===$)switch(B=z[U],B){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 46:case 101:case 69:case 43:case 45:this.string+=String.fromCharCode(B),this.tState=$;break;default:this.tState=g;var ne=this.numberReviver(this.string,z,U);if(ne)return ne;this.offset+=this.string.length-1,this.string=void 0,U--;break}else if(this.tState===_)if(z[U]===114)this.tState=S;else return this.charError(z,U);else if(this.tState===S)if(z[U]===117)this.tState=T;else return this.charError(z,U);else if(this.tState===T)if(z[U]===101)this.tState=g,this.onToken(l,!0),this.offset+=3;else return this.charError(z,U);else if(this.tState===w)if(z[U]===97)this.tState=A;else return this.charError(z,U);else if(this.tState===A)if(z[U]===108)this.tState=R;else return this.charError(z,U);else if(this.tState===R)if(z[U]===115)this.tState=E;else return this.charError(z,U);else if(this.tState===E)if(z[U]===101)this.tState=g,this.onToken(d,!1),this.offset+=4;else return this.charError(z,U);else if(this.tState===I)if(z[U]===117)this.tState=L;else return this.charError(z,U);else if(this.tState===L)if(z[U]===108)this.tState=F;else return this.charError(z,U);else if(this.tState===F)if(z[U]===108)this.tState=g,this.onToken(f,null),this.offset+=3;else return this.charError(z,U)},j.onToken=function(z,B){},j.parseError=function(z,B){this.tState=b,this.onError(new Error("Unexpected "+J.toknam(z)+(B?"("+JSON.stringify(B)+")":"")+" in state "+J.toknam(this.state)))},j.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},j.pop=function(){var z=this.value,B=this.stack.pop();this.value=B.value,this.key=B.key,this.mode=B.mode,this.emit(z),this.mode||(this.state=G)},j.emit=function(z){this.mode&&(this.state=c),this.onValue(z)},j.onValue=function(z){},j.onToken=function(z,B){if(this.state===G)if(z===h||z===v||z===l||z===d||z===f)this.value&&(this.value[this.key]=B),this.emit(B);else if(z===r)this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=X,this.mode=Y;else if(z===o)this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=W,this.state=G;else if(z===a)if(this.mode===Y)this.pop();else return this.parseError(z,B);else if(z===u)if(this.mode===W)this.pop();else return this.parseError(z,B);else return this.parseError(z,B);else if(this.state===X)if(z===h)this.key=B,this.state=s;else if(z===a)this.pop();else return this.parseError(z,B);else if(this.state===s)if(z===s)this.state=G;else return this.parseError(z,B);else if(this.state===c)if(z===c)this.mode===W?(this.key++,this.state=G):this.mode===Y&&(this.state=X);else if(z===u&&this.mode===W||z===a&&this.mode===Y)this.pop();else return this.parseError(z,B);else return this.parseError(z,B)},j.numberReviver=function(z,B,U){var Z=Number(z);if(isNaN(Z))return this.charError(B,U);z.match(/[0-9]+/)==z&&Z.toString()!=z?this.onToken(h,z):this.onToken(v,Z)},J.C=t,jsonparse=J,jsonparse}var hasRequiredSparqlJsonParser;function requireSparqlJsonParser(){if(hasRequiredSparqlJsonParser)return SparqlJsonParser;hasRequiredSparqlJsonParser=1,Object.defineProperty(SparqlJsonParser,"__esModule",{value:!0}),SparqlJsonParser.SparqlJsonParser=void 0;const n=requireRdfDataFactory(),t=requireBrowser(),r=requireJsonparse();let a=class{constructor(u){var s;u=u||{},this.dataFactory=u.dataFactory||new n.DataFactory,this.prefixVariableQuestionMark=!!u.prefixVariableQuestionMark,this.suppressMissingStreamResultsError=(s=u.suppressMissingStreamResultsError)!==null&&s!==void 0?s:!0}parseJsonResults(u){return u.results.bindings.map(s=>this.parseJsonBindings(s))}parseJsonResultsStream(u){const s=h=>f.emit("error",h);u.on("error",s);const c=new r;c.onError=s;let l=!1,d=!1;c.onValue=h=>{if(c.key==="vars"&&c.stack.length===2&&c.stack[1].key==="head")f.emit("variables",h.map(v=>this.dataFactory.variable(v))),l=!0;else if(c.key==="results"&&c.stack.length===1)d=!0;else if(typeof c.key=="number"&&c.stack.length===3&&c.stack[1].key==="results"&&c.stack[2].key==="bindings")try{f.push(this.parseJsonBindings(h))}catch(v){f.emit("error",v)}else c.key==="metadata"&&c.stack.length===1&&f.emit("metadata",h)};const f=u.on("end",h=>{!d&&!this.suppressMissingStreamResultsError?f.emit("error",new Error("No valid SPARQL query results were found.")):l||f.emit("variables",[])}).pipe(new t.Transform({objectMode:!0,transform(h,v,g){c.write(h),g()}}));return f}parseJsonBindings(u){const s={};for(const c in u){const l=u[c];s[this.prefixVariableQuestionMark?"?"+c:c]=this.parseJsonValue(l)}return s}parseJsonValue(u){let s;switch(u.type){case"bnode":s=this.dataFactory.blankNode(u.value);break;case"literal":u["xml:lang"]?s=this.dataFactory.literal(u.value,u["xml:lang"]):u.datatype?s=this.dataFactory.literal(u.value,this.dataFactory.namedNode(u.datatype)):s=this.dataFactory.literal(u.value);break;case"typed-literal":s=this.dataFactory.literal(u.value,this.dataFactory.namedNode(u.datatype));break;case"triple":const c=u.value;if(!c||!c.subject||!c.predicate||!c.object)throw new Error("Invalid quoted triple: "+JSON.stringify(u));s=this.dataFactory.quad(this.parseJsonValue(c.subject),this.parseJsonValue(c.predicate),this.parseJsonValue(c.object));break;default:s=this.dataFactory.namedNode(u.value);break}return s}parseJsonBoolean(u){if("boolean"in u)return u.boolean;throw new Error("No valid ASK response was found.")}parseJsonBooleanStream(u){return new Promise((s,c)=>{const l=new r;l.onError=c,l.onValue=d=>{l.key==="boolean"&&typeof d=="boolean"&&l.stack.length===1&&s(d)},u.on("error",c).on("data",d=>l.write(d)).on("end",()=>c(new Error("No valid ASK response was found.")))})}};return SparqlJsonParser.SparqlJsonParser=a,SparqlJsonParser}var hasRequiredSparqljsonParse;function requireSparqljsonParse(){return hasRequiredSparqljsonParse||(hasRequiredSparqljsonParse=1,function(n){var t=sparqljsonParse&&sparqljsonParse.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=sparqljsonParse&&sparqljsonParse.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireSparqlJsonParser(),n)}(sparqljsonParse)),sparqljsonParse}var hasRequiredConverter;function requireConverter(){if(hasRequiredConverter)return Converter;hasRequiredConverter=1,Object.defineProperty(Converter,"__esModule",{value:!0}),Converter.Converter=void 0;const n=requireRdfLiteral(),t=requireSparqljsonParse();let r=class or{constructor(o){o=o||{delimiter:"_"},o.prefixVariableQuestionMark=!1,this.delimiter=o.delimiter||"_",this.parser=new t.SparqlJsonParser(o),this.materializeRdfJsTerms=o.materializeRdfJsTerms}static addValueToTree(o,u,s,c,l,d){const f=u[0],h=c?c+d+f:f,v=l.singularizeVariables[h];if(u.length===1)v?o[f]||(o[f]=s):(o[f]||(o[f]=[]),o[f].push(s));else{let g;v?(o[f]||(o[f]={}),g=o[f]):(o[f]||(o[f]=[{}]),g=o[f][0]),or.addValueToTree(g,u.slice(1),s,h,l,d)}}static mergeTrees(o,u){if(typeof o!=typeof u)throw new Error(`Two incompatible tree nodes were found: ${typeof o} and ${typeof u}`);if(Array.isArray(o)!==Array.isArray(u))throw new Error(`Two incompatible tree nodes were found: Array?${Array.isArray(o)} and Array?${Array.isArray(u)}`);if(typeof o=="object"&&typeof u=="object"){if(o.termType&&u.termType)return o.equals(u)?{valid:!0,result:o}:{valid:!1,result:o};if(Array.isArray(o)&&Array.isArray(u)){if(o.length>0){const s=[];let c=!1;for(const l of o){const d=or.mergeTrees(l,u[0]);d.valid?(c=!0,s.push(d.result)):s.push(l)}if(c)return{valid:!0,result:s}}return{valid:!0,result:o.concat(u)}}else{const s={};for(const c in u)s[c]=u[c];for(const c in o)if(s[c]){const l=or.mergeTrees(o[c],s[c]);if(l.valid)s[c]=l.result;else return{valid:!1,result:o}}else s[c]=o[c];return{valid:!0,result:s}}}else throw new Error(`Unmergable tree types: ${typeof o} and ${typeof u}`)}static materializeTree(o){if(o.termType)return(0,n.getTermRaw)(o);if(Array.isArray(o))return o.map(or.materializeTree);{const u={};for(const s in o)u[s]=or.materializeTree(o[s]);return u}}sparqlJsonResultsToTree(o,u){return this.bindingsToTree(this.parser.parseJsonResults(o),u||{singularizeVariables:{}})}bindingsToTree(o,u){const s=u&&u.singularizeVariables[""];let c=s?{}:[];for(const l of o){const d=s?{}:[{}];for(const f in l){const h=f.split(this.delimiter),v=l[f];or.addValueToTree(s?d:d[0],h,v,"",u,this.delimiter)}c=or.mergeTrees(c,d).result}return this.materializeRdfJsTerms&&(c=or.materializeTree(c)),c}};return Converter.Converter=r,Converter}var hasRequiredSparqljsonToTree;function requireSparqljsonToTree(){return hasRequiredSparqljsonToTree||(hasRequiredSparqljsonToTree=1,function(n){var t=sparqljsonToTree&&sparqljsonToTree.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=sparqljsonToTree&&sparqljsonToTree.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireConverter(),n)}(sparqljsonToTree)),sparqljsonToTree}var hasRequiredActorQueryResultSerializeTree;function requireActorQueryResultSerializeTree(){if(hasRequiredActorQueryResultSerializeTree)return ActorQueryResultSerializeTree;hasRequiredActorQueryResultSerializeTree=1,Object.defineProperty(ActorQueryResultSerializeTree,"__esModule",{value:!0}),ActorQueryResultSerializeTree.ActorQueryResultSerializeTree=void 0;const n=requireLib$3Y(),t=requireLib$4q(),r=requireLib$4s(),a=requireBrowser(),o=requireSparqljsonToTree();let u=class ea extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c)}static async bindingsStreamToGraphQl(c,l,d){const f=r.ActionContext.ensureActionContext(l),h=new o.Converter(d),v={singularizeVariables:f.get(t.KeysInitQuery.graphqlSingularizeVariables)??{}};return h.bindingsToTree(await c.map(g=>Object.fromEntries([...g].map(([b,_])=>[b.value,_]))).toArray(),v)}async testHandleChecked(c){return c.type!=="bindings"?(0,r.failTest)("This actor can only handle bindings streams."):(0,r.passTestVoid)()}async runHandle(c,l){const d=new a.Readable;return d._read=()=>{d._read=()=>{},ea.bindingsStreamToGraphQl(c.bindingsStream,c.context,{materializeRdfJsTerms:!0}).then(f=>{d.push(JSON.stringify(f,null,"  ")),d.push(null)}).catch(f=>d.emit("error",f))},{data:d}}};return ActorQueryResultSerializeTree.ActorQueryResultSerializeTree=u,ActorQueryResultSerializeTree}var hasRequiredLib$3R;function requireLib$3R(){return hasRequiredLib$3R||(hasRequiredLib$3R=1,function(n){var t=lib$3R&&lib$3R.__createBinding||(Object.create?function(u,s,c,l){l===void 0&&(l=c);var d=Object.getOwnPropertyDescriptor(s,c);(!d||("get"in d?!s.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return s[c]}}),Object.defineProperty(u,l,d)}:function(u,s,c,l){l===void 0&&(l=c),u[l]=s[c]}),r=lib$3R&&lib$3R.__exportStar||function(u,s){for(var c in u)c!=="default"&&!Object.prototype.hasOwnProperty.call(s,c)&&t(s,u,c)};Object.defineProperty(n,"__esModule",{value:!0}),n.bindingsStreamToGraphQl=void 0;const a=requireActorQueryResultSerializeTree(),{bindingsStreamToGraphQl:o}=a.ActorQueryResultSerializeTree;n.bindingsStreamToGraphQl=o,r(requireActorQueryResultSerializeTree(),n)}(lib$3R)),lib$3R}var lib$3Q={},MediatorCombineUnion={},hasRequiredMediatorCombineUnion;function requireMediatorCombineUnion(){if(hasRequiredMediatorCombineUnion)return MediatorCombineUnion;hasRequiredMediatorCombineUnion=1,Object.defineProperty(MediatorCombineUnion,"__esModule",{value:!0}),MediatorCombineUnion.MediatorCombineUnion=void 0;const n=requireLib$4s();let t=class extends n.Mediator{constructor(a){super(a),this.combiner=this.createCombiner()}async mediate(a){let o;try{o=this.publish(a)}catch{o=[]}if(this.filterFailures){const c=[];for(const l of o)(await l.reply).isPassed()&&c.push(l);o=c}const u=[];await Promise.all(o.map(async({reply:c},l)=>{const d=await c,f=d.getOrThrow();return u[l]=d.getSideData(),f}));const s=await Promise.all(o.map((c,l)=>c.actor.runObservable(a,u[l])));return this.combiner(s)}mediateWith(){throw new Error("Method not supported.")}createCombiner(){return a=>{const o={};return o[this.field]={},[{}].concat(a.map(u=>u[this.field])).forEach(u=>{o[this.field]={...u,...o[this.field]}}),o}}};return MediatorCombineUnion.MediatorCombineUnion=t,MediatorCombineUnion}var hasRequiredLib$3Q;function requireLib$3Q(){return hasRequiredLib$3Q||(hasRequiredLib$3Q=1,function(n){var t=lib$3Q&&lib$3Q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3Q&&lib$3Q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorCombineUnion(),n)}(lib$3Q)),lib$3Q}var lib$3P={},MediatorNumber={},hasRequiredMediatorNumber;function requireMediatorNumber(){if(hasRequiredMediatorNumber)return MediatorNumber;hasRequiredMediatorNumber=1,Object.defineProperty(MediatorNumber,"__esModule",{value:!0}),MediatorNumber.MediatorNumber=void 0;const n=requireLib$4s();let t=class extends n.Mediator{constructor(a){super(a),this.indexPicker=this.createIndexPicker()}createIndexPicker(){switch(this.type){case"min":return a=>a.reduce((o,u,s)=>{const c=this.getOrDefault(u[this.field],Number.POSITIVE_INFINITY);return c!==null&&(Number.isNaN(o[0])||o[0]>c)?[c,s]:o},[Number.NaN,-1])[1];case"max":return a=>a.reduce((o,u,s)=>{const c=this.getOrDefault(u[this.field],Number.NEGATIVE_INFINITY);return c!==null&&(Number.isNaN(o[0])||o[0]<c)?[c,s]:o},[Number.NaN,-1])[1];default:throw new Error(`No valid "type" value was given, must be either 'min' or 'max', but got: ${this.type}`)}}getOrDefault(a,o){return a===void 0?o:a}async mediateWith(a,o){let u=await Promise.all(o.map(({reply:f})=>f));const s=[];if(this.ignoreFailures){const f={};f[this.field]=null,u=u.map(h=>h.isFailed()?(s.push(h.getFailMessage()),(0,n.passTestWithSideData)(f,void 0)):h)}const c=[],l=u.map((f,h)=>{const v=f.getOrThrow();return c[h]=f.getSideData(),v}),d=this.indexPicker(l);return d<0?(0,n.failTest)(this.constructFailureMessage(a,s)):(0,n.passTestWithSideData)(o[d].actor,c[d])}};return MediatorNumber.MediatorNumber=t,MediatorNumber}var hasRequiredLib$3P;function requireLib$3P(){return hasRequiredLib$3P||(hasRequiredLib$3P=1,function(n){var t=lib$3P&&lib$3P.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3P&&lib$3P.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorNumber(),n)}(lib$3P)),lib$3P}var lib$3O={},ActorDereferenceFallback={},lib$3N={},ActorDereference={},ActorDereferenceBase={},hasRequiredActorDereferenceBase;function requireActorDereferenceBase(){if(hasRequiredActorDereferenceBase)return ActorDereferenceBase;hasRequiredActorDereferenceBase=1,Object.defineProperty(ActorDereferenceBase,"__esModule",{value:!0}),ActorDereferenceBase.ActorDereferenceBase=ActorDereferenceBase.isHardError=ActorDereferenceBase.emptyReadable=void 0;const n=requireLib$4q(),t=requireLib$4s(),r=requireBrowser();function a(){const s=new r.Readable;return s.push(null),s}ActorDereferenceBase.emptyReadable=a;function o(s){return!s.get(n.KeysInitQuery.lenient)}ActorDereferenceBase.isHardError=o;let u=class extends t.Actor{constructor(c){super(c)}async dereferenceErrorHandler(c,l,d){if(o(c.context))throw l;return this.logWarn(c.context,l.message),{...d,data:a()}}};return ActorDereferenceBase.ActorDereferenceBase=u,ActorDereferenceBase}var hasRequiredActorDereference;function requireActorDereference(){if(hasRequiredActorDereference)return ActorDereference;hasRequiredActorDereference=1,Object.defineProperty(ActorDereference,"__esModule",{value:!0}),ActorDereference.ActorDereference=void 0;const n=requireActorDereferenceBase();let t=class extends n.ActorDereferenceBase{constructor(a){super(a)}async handleDereferenceErrors(a,o,u,s=0){return this.dereferenceErrorHandler(a,o,{url:a.url,exists:!1,headers:u,requestTime:s})}};return ActorDereference.ActorDereference=t,ActorDereference}var ActorDereferenceParse={},hasRequiredActorDereferenceParse;function requireActorDereferenceParse(){if(hasRequiredActorDereferenceParse)return ActorDereferenceParse;hasRequiredActorDereferenceParse=1,Object.defineProperty(ActorDereferenceParse,"__esModule",{value:!0}),ActorDereferenceParse.ActorDereferenceParse=ActorDereferenceParse.getMediaTypeFromExtension=void 0;const n=requireLib$4s(),t=requireBrowser(),r=requireActorDereferenceBase();function a(u,s){const c=u.lastIndexOf(".");return c>=0&&(s==null?void 0:s[u.slice(c+1)])||""}ActorDereferenceParse.getMediaTypeFromExtension=a;let o=class extends r.ActorDereferenceBase{constructor(s){super(s)}async test(s){return(0,n.passTestVoid)()}handleDereferenceStreamErrors(s,c){return(0,r.isHardError)(s.context)||(c.on("error",l=>{this.logWarn(s.context,l.message,()=>({url:s.url})),c.push(null)}),c=c.pipe(new t.PassThrough({objectMode:!0}))),c}async run(s){var f,h;const{context:c}=s,l=await this.mediatorDereference.mediate({...s,mediaTypes:async()=>{var v,g;return(g=await((v=this.mediatorParseMediatypes)==null?void 0:v.mediate({context:c,mediaTypes:!0})))==null?void 0:g.mediaTypes}});let d;try{d=(await this.mediatorParse.mediate({context:c,handle:{context:c,...l,metadata:await this.getMetadata(l)},handleMediaType:l.mediaType||a(l.url,this.mediaMappings)||s.mediaType})).handle,d.data=this.handleDereferenceStreamErrors(s,d.data)}catch(v){await((h=(f=l.data).close)==null?void 0:h.call(f)),d=await this.dereferenceErrorHandler(s,v,{})}return{...l,...d}}};return ActorDereferenceParse.ActorDereferenceParse=o,ActorDereferenceParse}var hasRequiredLib$3O;function requireLib$3O(){return hasRequiredLib$3O||(hasRequiredLib$3O=1,function(n){var t=lib$3N&&lib$3N.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3N&&lib$3N.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorDereference(),n),r(requireActorDereferenceParse(),n),r(requireActorDereferenceBase(),n)}(lib$3N)),lib$3N}var hasRequiredActorDereferenceFallback;function requireActorDereferenceFallback(){if(hasRequiredActorDereferenceFallback)return ActorDereferenceFallback;hasRequiredActorDereferenceFallback=1,Object.defineProperty(ActorDereferenceFallback,"__esModule",{value:!0}),ActorDereferenceFallback.ActorDereferenceFallback=void 0;const n=requireLib$3O(),t=requireLib$4s();let r=class extends n.ActorDereference{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return this.handleDereferenceErrors(o,new Error(`Could not dereference '${o.url}'`))}};return ActorDereferenceFallback.ActorDereferenceFallback=r,ActorDereferenceFallback}var hasRequiredLib$3N;function requireLib$3N(){return hasRequiredLib$3N||(hasRequiredLib$3N=1,function(n){var t=lib$3O&&lib$3O.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3O&&lib$3O.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorDereferenceFallback(),n)}(lib$3O)),lib$3O}var lib$3M={},ActorRdfJoinEntriesSortCardinality={},lib$3L={},ActorRdfJoinEntriesSort={},hasRequiredActorRdfJoinEntriesSort;function requireActorRdfJoinEntriesSort(){if(hasRequiredActorRdfJoinEntriesSort)return ActorRdfJoinEntriesSort;hasRequiredActorRdfJoinEntriesSort=1,Object.defineProperty(ActorRdfJoinEntriesSort,"__esModule",{value:!0}),ActorRdfJoinEntriesSort.ActorRdfJoinEntriesSort=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfJoinEntriesSort.ActorRdfJoinEntriesSort=t,ActorRdfJoinEntriesSort}var hasRequiredLib$3M;function requireLib$3M(){return hasRequiredLib$3M||(hasRequiredLib$3M=1,function(n){var t=lib$3L&&lib$3L.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3L&&lib$3L.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinEntriesSort(),n)}(lib$3L)),lib$3L}var hasRequiredActorRdfJoinEntriesSortCardinality;function requireActorRdfJoinEntriesSortCardinality(){if(hasRequiredActorRdfJoinEntriesSortCardinality)return ActorRdfJoinEntriesSortCardinality;hasRequiredActorRdfJoinEntriesSortCardinality=1,Object.defineProperty(ActorRdfJoinEntriesSortCardinality,"__esModule",{value:!0}),ActorRdfJoinEntriesSortCardinality.ActorRdfJoinEntriesSortCardinality=void 0;const n=requireLib$3M(),t=requireLib$4s();let r=class extends n.ActorRdfJoinEntriesSort{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return{entries:[...o.entries].sort((s,c)=>s.metadata.cardinality.value-c.metadata.cardinality.value)}}};return ActorRdfJoinEntriesSortCardinality.ActorRdfJoinEntriesSortCardinality=r,ActorRdfJoinEntriesSortCardinality}var hasRequiredLib$3L;function requireLib$3L(){return hasRequiredLib$3L||(hasRequiredLib$3L=1,function(n){var t=lib$3M&&lib$3M.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3M&&lib$3M.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinEntriesSortCardinality(),n)}(lib$3M)),lib$3M}var lib$3K={},ActorRdfJoinSelectivityVariableCounting={},lib$3J={},ActorRdfJoinSelectivity={},hasRequiredActorRdfJoinSelectivity;function requireActorRdfJoinSelectivity(){if(hasRequiredActorRdfJoinSelectivity)return ActorRdfJoinSelectivity;hasRequiredActorRdfJoinSelectivity=1,Object.defineProperty(ActorRdfJoinSelectivity,"__esModule",{value:!0}),ActorRdfJoinSelectivity.ActorRdfJoinSelectivity=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfJoinSelectivity.ActorRdfJoinSelectivity=t,ActorRdfJoinSelectivity}var hasRequiredLib$3K;function requireLib$3K(){return hasRequiredLib$3K||(hasRequiredLib$3K=1,function(n){var t=lib$3J&&lib$3J.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3J&&lib$3J.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinSelectivity(),n)}(lib$3J)),lib$3J}var hasRequiredActorRdfJoinSelectivityVariableCounting;function requireActorRdfJoinSelectivityVariableCounting(){if(hasRequiredActorRdfJoinSelectivityVariableCounting)return ActorRdfJoinSelectivityVariableCounting;hasRequiredActorRdfJoinSelectivityVariableCounting=1,Object.defineProperty(ActorRdfJoinSelectivityVariableCounting,"__esModule",{value:!0}),ActorRdfJoinSelectivityVariableCounting.JoinTypes=ActorRdfJoinSelectivityVariableCounting.ActorRdfJoinSelectivityVariableCounting=void 0;const n=requireLib$3K(),t=requireLib$4s(),r=requireSparqlalgebrajs();let a=class Or extends n.ActorRdfJoinSelectivity{constructor(s){super(s)}async test(s){return(0,t.passTest)({accuracy:.5})}static getPatternCost(s){let c=1;return s.subject.termType==="Variable"&&(c+=4),(s.predicate.termType==="Variable"||s.type===r.Algebra.types.PATH)&&(c+=1),s.object.termType==="Variable"&&(c+=2),s.graph.termType==="Variable"&&(c+=1),c/9}static getJoinTypes(s,c){const l=[];return s.subject.termType==="Variable"?(s.subject.equals(c.subject)&&l.push(o.unboundSS),c.type==="pattern"&&s.subject.equals(c.predicate)&&l.push(o.unboundSP),s.subject.equals(c.object)&&l.push(o.unboundSO),s.subject.equals(c.graph)&&l.push(o.unboundSG)):(s.subject.equals(c.subject)&&l.push(o.boundSS),c.type==="pattern"&&s.subject.equals(c.predicate)&&l.push(o.boundSP),s.subject.equals(c.object)&&l.push(o.boundSO),s.subject.equals(c.graph)&&l.push(o.boundSG)),s.type==="pattern"&&(s.predicate.termType==="Variable"?(s.predicate.equals(c.subject)&&l.push(o.unboundPS),c.type==="pattern"&&s.predicate.equals(c.predicate)&&l.push(o.unboundPP),s.predicate.equals(c.object)&&l.push(o.unboundPO),s.predicate.equals(c.graph)&&l.push(o.unboundPG)):(s.predicate.equals(c.subject)&&l.push(o.boundPS),c.type==="pattern"&&s.predicate.equals(c.predicate)&&l.push(o.boundPP),s.predicate.equals(c.object)&&l.push(o.boundPO),s.predicate.equals(c.graph)&&l.push(o.boundPG))),s.object.termType==="Variable"?(s.object.equals(c.subject)&&l.push(o.unboundOS),c.type==="pattern"&&s.object.equals(c.predicate)&&l.push(o.unboundOP),s.object.equals(c.object)&&l.push(o.unboundOO),s.object.equals(c.graph)&&l.push(o.unboundOG)):(s.object.equals(c.subject)&&l.push(o.boundOS),c.type==="pattern"&&s.object.equals(c.predicate)&&l.push(o.boundOP),s.object.equals(c.object)&&l.push(o.boundOO),s.object.equals(c.graph)&&l.push(o.boundOG)),s.graph.termType==="Variable"?(s.graph.equals(c.subject)&&l.push(o.unboundGS),c.type==="pattern"&&s.graph.equals(c.predicate)&&l.push(o.unboundGP),s.graph.equals(c.object)&&l.push(o.unboundGO),s.graph.equals(c.graph)&&l.push(o.unboundGG)):(s.graph.equals(c.subject)&&l.push(o.boundGS),c.type==="pattern"&&s.graph.equals(c.predicate)&&l.push(o.boundGP),s.graph.equals(c.object)&&l.push(o.boundGO),s.graph.equals(c.graph)&&l.push(o.boundGG)),l}static getOperationsPairwiseJoinCost(s,c){let l=Or.MAX_PAIRWISE_COST;for(const d of Or.getJoinTypes(s,c))switch(d){case o.boundSS:l-=2*2;break;case o.boundSP:l-=3*2;break;case o.boundSO:l-=1*2;break;case o.boundSG:l-=3*2;break;case o.boundPS:l-=3*2;break;case o.boundPP:return 1;case o.boundPO:l-=3*2;break;case o.boundPG:l-=3*2;break;case o.boundOS:l-=1*2;break;case o.boundOP:l-=3*2;break;case o.boundOO:l-=1*2;break;case o.boundOG:l-=3*2;break;case o.boundGS:l-=3*2;break;case o.boundGP:l-=3*2;break;case o.boundGO:l-=3*2;break;case o.boundGG:l-=3*2;break;case o.unboundSS:l-=2;break;case o.unboundSP:l-=3;break;case o.unboundSO:l-=1;break;case o.unboundSG:l-=3;break;case o.unboundPS:l-=3;break;case o.unboundPP:l-=3;break;case o.unboundPO:l-=3;break;case o.unboundPG:l-=3;break;case o.unboundOS:l-=1;break;case o.unboundOP:l-=3;break;case o.unboundOO:l-=1;break;case o.unboundOG:l-=3;break;case o.unboundGS:l-=3;break;case o.unboundGP:l-=3;break;case o.unboundGO:l-=3;break;case o.unboundGG:l-=3;break}return l/Or.MAX_PAIRWISE_COST}static getOperationsJoinCost(s){const c=[];for(const f of s)r.Util.recurseOperation(f,{[r.Algebra.types.PATTERN](h){return c.push(h),!1},[r.Algebra.types.PATH](h){return c.push(h),!1}});let l=0,d=0;for(const f of c)for(const h of c)f!==h&&(l+=Or.getOperationsPairwiseJoinCost(f,h),d++);return d===0?1:l/d*c.reduce((f,h)=>f*Or.getPatternCost(h),1)}async run(s){return s.entries.length<=1?{selectivity:1}:{selectivity:Or.getOperationsJoinCost(s.entries.map(c=>c.operation))}}};ActorRdfJoinSelectivityVariableCounting.ActorRdfJoinSelectivityVariableCounting=a,a.MAX_PAIRWISE_COST=41*2;var o;return function(u){u[u.boundSS=0]="boundSS",u[u.boundSP=1]="boundSP",u[u.boundSO=2]="boundSO",u[u.boundSG=3]="boundSG",u[u.boundPS=4]="boundPS",u[u.boundPP=5]="boundPP",u[u.boundPO=6]="boundPO",u[u.boundPG=7]="boundPG",u[u.boundOS=8]="boundOS",u[u.boundOP=9]="boundOP",u[u.boundOO=10]="boundOO",u[u.boundOG=11]="boundOG",u[u.boundGS=12]="boundGS",u[u.boundGP=13]="boundGP",u[u.boundGO=14]="boundGO",u[u.boundGG=15]="boundGG",u[u.unboundSS=16]="unboundSS",u[u.unboundSP=17]="unboundSP",u[u.unboundSO=18]="unboundSO",u[u.unboundSG=19]="unboundSG",u[u.unboundPS=20]="unboundPS",u[u.unboundPP=21]="unboundPP",u[u.unboundPO=22]="unboundPO",u[u.unboundPG=23]="unboundPG",u[u.unboundOS=24]="unboundOS",u[u.unboundOP=25]="unboundOP",u[u.unboundOO=26]="unboundOO",u[u.unboundOG=27]="unboundOG",u[u.unboundGS=28]="unboundGS",u[u.unboundGP=29]="unboundGP",u[u.unboundGO=30]="unboundGO",u[u.unboundGG=31]="unboundGG"}(o||(ActorRdfJoinSelectivityVariableCounting.JoinTypes=o={})),ActorRdfJoinSelectivityVariableCounting}var hasRequiredLib$3J;function requireLib$3J(){return hasRequiredLib$3J||(hasRequiredLib$3J=1,function(n){var t=lib$3K&&lib$3K.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3K&&lib$3K.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinSelectivityVariableCounting(),n)}(lib$3K)),lib$3K}var lib$3I={},ActorRdfMetadataPrimaryTopic={},lib$3H={},ActorRdfMetadata={},hasRequiredActorRdfMetadata;function requireActorRdfMetadata(){if(hasRequiredActorRdfMetadata)return ActorRdfMetadata;hasRequiredActorRdfMetadata=1,Object.defineProperty(ActorRdfMetadata,"__esModule",{value:!0}),ActorRdfMetadata.ActorRdfMetadata=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfMetadata.ActorRdfMetadata=t,ActorRdfMetadata}var hasRequiredLib$3I;function requireLib$3I(){return hasRequiredLib$3I||(hasRequiredLib$3I=1,function(n){var t=lib$3H&&lib$3H.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3H&&lib$3H.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadata(),n)}(lib$3H)),lib$3H}var hasRequiredActorRdfMetadataPrimaryTopic;function requireActorRdfMetadataPrimaryTopic(){if(hasRequiredActorRdfMetadataPrimaryTopic)return ActorRdfMetadataPrimaryTopic;hasRequiredActorRdfMetadataPrimaryTopic=1,Object.defineProperty(ActorRdfMetadataPrimaryTopic,"__esModule",{value:!0}),ActorRdfMetadataPrimaryTopic.ActorRdfMetadataPrimaryTopic=void 0;const n=requireLib$3I(),t=requireLib$4s(),r=requireBrowser();let a=class extends n.ActorRdfMetadata{constructor(u){super(u)}async test(u){return u.triples?(0,t.failTest)("This actor only supports non-triple quad streams."):(0,t.passTestVoid)()}async run(u){const s=new r.Readable({objectMode:!0}),c=new r.Readable({objectMode:!0}),l=()=>{s._read=c._read=()=>{},u.quads.on("error",v=>{s.emit("error",v),c.emit("error",v)});const d={};let f;const h={};u.quads.on("data",v=>{v.predicate.value==="http://rdfs.org/ns/void#subset"&&v.object.value===u.url?f=v.subject.value:v.predicate.value==="http://xmlns.com/foaf/0.1/primaryTopic"&&(h[v.object.value]=v.subject.value);let g=d[v.graph.value];g||(g=d[v.graph.value]=[]),g.push(v)}),u.quads.on("end",()=>{const v=f?h[f]:void 0;for(const g in d)if(g===v){for(const b of d[g])c.push(b);if(this.metadataToData)for(const b of d[g])s.push(b)}else{for(const b of d[g])s.push(b);if(!v&&this.dataToMetadataOnInvalidMetadataGraph)for(const b of d[g])c.push(b)}s.push(null),c.push(null)})};return s._read=c._read=()=>{l()},{data:s,metadata:c}}};return ActorRdfMetadataPrimaryTopic.ActorRdfMetadataPrimaryTopic=a,ActorRdfMetadataPrimaryTopic}var hasRequiredLib$3H;function requireLib$3H(){return hasRequiredLib$3H||(hasRequiredLib$3H=1,function(n){var t=lib$3I&&lib$3I.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3I&&lib$3I.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataPrimaryTopic(),n)}(lib$3I)),lib$3I}var lib$3G={},ActorRdfMetadataAll={},hasRequiredActorRdfMetadataAll;function requireActorRdfMetadataAll(){if(hasRequiredActorRdfMetadataAll)return ActorRdfMetadataAll;hasRequiredActorRdfMetadataAll=1,Object.defineProperty(ActorRdfMetadataAll,"__esModule",{value:!0}),ActorRdfMetadataAll.ActorRdfMetadataAll=void 0;const n=requireLib$3I(),t=requireLib$4s(),r=requireBrowser();let a=class extends n.ActorRdfMetadata{constructor(u){super(u)}async test(u){return(0,t.passTestVoid)()}async run(u){const s=new r.Readable({objectMode:!0}),c=new r.Readable({objectMode:!0});u.quads.on("error",d=>{s.emit("error",d),c.emit("error",d)}),u.quads.on("end",()=>{s.push(null),c.push(null)});const l=s._read=c._read=d=>{for(;d>0;){const f=u.quads.read();if(f===null)return u.quads.once("readable",()=>l(d));d--,s.push(f),c.push(f)}};return{data:s,metadata:c}}};return ActorRdfMetadataAll.ActorRdfMetadataAll=a,ActorRdfMetadataAll}var hasRequiredLib$3G;function requireLib$3G(){return hasRequiredLib$3G||(hasRequiredLib$3G=1,function(n){var t=lib$3G&&lib$3G.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3G&&lib$3G.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataAll(),n)}(lib$3G)),lib$3G}var lib$3F={},ActorRdfMetadataAccumulateCardinality={},lib$3E={},ActorRdfMetadataAccumulate={},hasRequiredActorRdfMetadataAccumulate;function requireActorRdfMetadataAccumulate(){if(hasRequiredActorRdfMetadataAccumulate)return ActorRdfMetadataAccumulate;hasRequiredActorRdfMetadataAccumulate=1,Object.defineProperty(ActorRdfMetadataAccumulate,"__esModule",{value:!0}),ActorRdfMetadataAccumulate.ActorRdfMetadataAccumulate=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfMetadataAccumulate.ActorRdfMetadataAccumulate=t,ActorRdfMetadataAccumulate}var hasRequiredLib$3F;function requireLib$3F(){return hasRequiredLib$3F||(hasRequiredLib$3F=1,function(n){var t=lib$3E&&lib$3E.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3E&&lib$3E.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataAccumulate(),n)}(lib$3E)),lib$3E}var hasRequiredActorRdfMetadataAccumulateCardinality;function requireActorRdfMetadataAccumulateCardinality(){if(hasRequiredActorRdfMetadataAccumulateCardinality)return ActorRdfMetadataAccumulateCardinality;hasRequiredActorRdfMetadataAccumulateCardinality=1,Object.defineProperty(ActorRdfMetadataAccumulateCardinality,"__esModule",{value:!0}),ActorRdfMetadataAccumulateCardinality.ActorRdfMetadataAccumulateCardinality=void 0;const n=requireLib$3F(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataAccumulate{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){if(o.mode==="initialize")return{metadata:{cardinality:{type:"exact",value:0}}};const u={...o.accumulatedMetadata.cardinality};if(u.dataset){if(o.accumulatedMetadata.defaultGraph===u.dataset&&u.dataset!==o.appendingMetadata.cardinality.dataset)return{metadata:{cardinality:o.appendingMetadata.cardinality}};if(o.appendingMetadata.cardinality.dataset){if(u.dataset!==o.appendingMetadata.cardinality.dataset&&o.appendingMetadata.subsetOf===u.dataset)return{metadata:{cardinality:o.appendingMetadata.cardinality}};if(u.dataset===o.appendingMetadata.cardinality.dataset)return{metadata:{cardinality:u}};delete u.dataset}else return{metadata:{cardinality:u}}}return!o.appendingMetadata.cardinality||!Number.isFinite(o.appendingMetadata.cardinality.value)?(u.type="estimate",u.value=Number.POSITIVE_INFINITY):(o.appendingMetadata.cardinality.type==="estimate"&&(u.type="estimate"),u.value+=o.appendingMetadata.cardinality.value),{metadata:{cardinality:u}}}};return ActorRdfMetadataAccumulateCardinality.ActorRdfMetadataAccumulateCardinality=r,ActorRdfMetadataAccumulateCardinality}var hasRequiredLib$3E;function requireLib$3E(){return hasRequiredLib$3E||(hasRequiredLib$3E=1,function(n){var t=lib$3F&&lib$3F.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3F&&lib$3F.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataAccumulateCardinality(),n)}(lib$3F)),lib$3F}var lib$3D={},ActorRdfMetadataAccumulatePageSize={},hasRequiredActorRdfMetadataAccumulatePageSize;function requireActorRdfMetadataAccumulatePageSize(){if(hasRequiredActorRdfMetadataAccumulatePageSize)return ActorRdfMetadataAccumulatePageSize;hasRequiredActorRdfMetadataAccumulatePageSize=1,Object.defineProperty(ActorRdfMetadataAccumulatePageSize,"__esModule",{value:!0}),ActorRdfMetadataAccumulatePageSize.ActorRdfMetadataAccumulatePageSize=void 0;const n=requireLib$3F(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataAccumulate{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return o.mode==="initialize"?{metadata:{}}:{metadata:{..."pageSize"in o.accumulatedMetadata||"pageSize"in o.appendingMetadata?{pageSize:(o.accumulatedMetadata.pageSize??0)+(o.appendingMetadata.pageSize??0)}:{}}}}};return ActorRdfMetadataAccumulatePageSize.ActorRdfMetadataAccumulatePageSize=r,ActorRdfMetadataAccumulatePageSize}var hasRequiredLib$3D;function requireLib$3D(){return hasRequiredLib$3D||(hasRequiredLib$3D=1,function(n){var t=lib$3D&&lib$3D.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3D&&lib$3D.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataAccumulatePageSize(),n)}(lib$3D)),lib$3D}var lib$3C={},ActorRdfMetadataAccumulateRequestTime={},hasRequiredActorRdfMetadataAccumulateRequestTime;function requireActorRdfMetadataAccumulateRequestTime(){if(hasRequiredActorRdfMetadataAccumulateRequestTime)return ActorRdfMetadataAccumulateRequestTime;hasRequiredActorRdfMetadataAccumulateRequestTime=1,Object.defineProperty(ActorRdfMetadataAccumulateRequestTime,"__esModule",{value:!0}),ActorRdfMetadataAccumulateRequestTime.ActorRdfMetadataAccumulateRequestTime=void 0;const n=requireLib$3F(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataAccumulate{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return o.mode==="initialize"?{metadata:{}}:{metadata:{..."requestTime"in o.accumulatedMetadata||"requestTime"in o.appendingMetadata?{requestTime:(o.accumulatedMetadata.requestTime??0)+(o.appendingMetadata.requestTime??0)}:{}}}}};return ActorRdfMetadataAccumulateRequestTime.ActorRdfMetadataAccumulateRequestTime=r,ActorRdfMetadataAccumulateRequestTime}var hasRequiredLib$3C;function requireLib$3C(){return hasRequiredLib$3C||(hasRequiredLib$3C=1,function(n){var t=lib$3C&&lib$3C.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3C&&lib$3C.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataAccumulateRequestTime(),n)}(lib$3C)),lib$3C}var lib$3B={},ActorRdfMetadataExtractHydraControls={},lib$3A={},ActorRdfMetadataExtract={},hasRequiredActorRdfMetadataExtract;function requireActorRdfMetadataExtract(){if(hasRequiredActorRdfMetadataExtract)return ActorRdfMetadataExtract;hasRequiredActorRdfMetadataExtract=1,Object.defineProperty(ActorRdfMetadataExtract,"__esModule",{value:!0}),ActorRdfMetadataExtract.ActorRdfMetadataExtract=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfMetadataExtract.ActorRdfMetadataExtract=t,ActorRdfMetadataExtract}var hasRequiredLib$3B;function requireLib$3B(){return hasRequiredLib$3B||(hasRequiredLib$3B=1,function(n){var t=lib$3A&&lib$3A.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3A&&lib$3A.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtract(),n)}(lib$3A)),lib$3A}var uritemplate={exports:{}},hasRequiredUritemplate;function requireUritemplate(){return hasRequiredUritemplate||(hasRequiredUritemplate=1,function(n){(function(t){var r=function(){function b(_){this.options=_}return b.prototype.toString=function(){return JSON&&JSON.stringify?JSON.stringify(this.options):this.options},b}(),a=function(){function b(L){return Object.prototype.toString.apply(L)==="[object Array]"}function _(L){return Object.prototype.toString.apply(L)==="[object String]"}function S(L){return Object.prototype.toString.apply(L)==="[object Number]"}function T(L){return Object.prototype.toString.apply(L)==="[object Boolean]"}function w(L,F){var D="",$=!0,O;for(O=0;O<L.length;O+=1)$?$=!1:D+=F,D+=L[O];return D}function A(L,F){for(var D=[],$=0;$<L.length;$+=1)D.push(F(L[$]));return D}function R(L,F){for(var D=[],$=0;$<L.length;$+=1)F(L[$])&&D.push(L[$]);return D}function E(L){if(typeof L!="object"||L===null)return L;Object.freeze(L);var F,D;for(D in L)L.hasOwnProperty(D)&&(F=L[D],typeof F=="object"&&I(F));return L}function I(L){return typeof Object.freeze=="function"?E(L):L}return{isArray:b,isString:_,isNumber:S,isBoolean:T,join:w,map:A,filter:R,deepFreeze:I}}(),o=function(){function b(T){return T>="a"&&T<="z"||T>="A"&&T<="Z"}function _(T){return T>="0"&&T<="9"}function S(T){return _(T)||T>="a"&&T<="f"||T>="A"&&T<="F"}return{isAlpha:b,isDigit:_,isHexDigit:S}}(),u=function(){var b={encode:function(R){return unescape(encodeURIComponent(R))},numBytes:function(R){return R<=127?1:194<=R&&R<=223?2:224<=R&&R<=239?3:240<=R&&R<=244?4:0},isValidFollowingCharCode:function(R){return 128<=R&&R<=191}};function _(R){var E="",I=b.encode(R),L,F;for(F=0;F<I.length;F+=1)L=I.charCodeAt(F),E+="%"+(L<16?"0":"")+L.toString(16).toUpperCase();return E}function S(R,E){return R.charAt(E)==="%"&&o.isHexDigit(R.charAt(E+1))&&o.isHexDigit(R.charAt(E+2))}function T(R,E){return parseInt(R.substr(E,2),16)}function w(R){if(!S(R,0))return!1;var E=T(R,1),I=b.numBytes(E);if(I===0)return!1;for(var L=1;L<I;L+=1)if(!S(R,3*L)||!b.isValidFollowingCharCode(T(R,3*L+1)))return!1;return!0}function A(R,E){var I=R.charAt(E);if(!S(R,E))return I;var L=T(R,E+1),F=b.numBytes(L);if(F===0)return I;for(var D=1;D<F;D+=1)if(!S(R,E+3*D)||!b.isValidFollowingCharCode(T(R,E+3*D+1)))return I;return R.substr(E,3*F)}return{encodeCharacter:_,isPctEncoded:w,pctCharAt:A}}(),s=function(){function b(T){return o.isAlpha(T)||o.isDigit(T)||T==="_"||u.isPctEncoded(T)}function _(T){return o.isAlpha(T)||o.isDigit(T)||T==="-"||T==="."||T==="_"||T==="~"}function S(T){return T===":"||T==="/"||T==="?"||T==="#"||T==="["||T==="]"||T==="@"||T==="!"||T==="$"||T==="&"||T==="("||T===")"||T==="*"||T==="+"||T===","||T===";"||T==="="||T==="'"}return{isVarchar:b,isUnreserved:_,isReserved:S}}(),c=function(){function b(w,A){var R="",E,I="";for((typeof w=="number"||typeof w=="boolean")&&(w=w.toString()),E=0;E<w.length;E+=I.length)I=w.charAt(E),R+=s.isUnreserved(I)||A&&s.isReserved(I)?I:u.encodeCharacter(I);return R}function _(w){return b(w,!0)}function S(w,A){var R=u.pctCharAt(w,A);return R.length>1||s.isReserved(R)||s.isUnreserved(R)?R:u.encodeCharacter(R)}function T(w){var A="",R,E="";for(R=0;R<w.length;R+=E.length)E=u.pctCharAt(w,R),E.length>1?A+=E:A+=s.isReserved(E)||s.isUnreserved(E)?E:u.encodeCharacter(E);return A}return{encode:b,encodePassReserved:_,encodeLiteral:T,encodeLiteralCharacter:S}}(),l=function(){var b={};function _(S){b[S]={symbol:S,separator:S==="?"?"&":S===""||S==="+"||S==="#"?",":S,named:S===";"||S==="&"||S==="?",ifEmpty:S==="&"||S==="?"?"=":"",first:S==="+"?"":S,encode:S==="+"||S==="#"?c.encodePassReserved:c.encode,toString:function(){return this.symbol}}}return _(""),_("+"),_("#"),_("."),_("/"),_(";"),_("?"),_("&"),{valueOf:function(S){return b[S]?b[S]:"=,!@|".indexOf(S)>=0?null:b[""]}}}();function d(b){var _;if(b==null)return!1;if(a.isArray(b))return b.length>0;if(typeof b=="string"||typeof b=="number"||typeof b=="boolean")return!0;for(_ in b)if(b.hasOwnProperty(_)&&d(b[_]))return!0;return!1}var f=function(){function b(_){this.literal=c.encodeLiteral(_)}return b.prototype.expand=function(){return this.literal},b.prototype.toString=b.prototype.expand,b}(),h=function(){function b(S){var T,w=[],A=null,R=null,E=null,I,L="";function F(){var $=S.substring(R,I);if($.length===0)throw new r({expressionText:S,message:"a varname must be specified",position:I});A={varname:$,exploded:!1,maxLength:null},R=null}function D(){if(E===I)throw new r({expressionText:S,message:"after a ':' you have to specify the length",position:I});A.maxLength=parseInt(S.substring(E,I),10),E=null}for(T=function($){var O=l.valueOf($);if(O===null)throw new r({expressionText:S,message:"illegal use of reserved operator",position:I,operator:$});return O}(S.charAt(0)),I=T.symbol.length,R=I;I<S.length;I+=L.length){if(L=u.pctCharAt(S,I),R!==null){if(L==="."){if(R===I)throw new r({expressionText:S,message:"a varname MUST NOT start with a dot",position:I});continue}if(s.isVarchar(L))continue;F()}if(E!==null){if(I===E&&L==="0")throw new r({expressionText:S,message:"A :prefix must not start with digit 0",position:I});if(o.isDigit(L)){if(I-E>=4)throw new r({expressionText:S,message:"A :prefix must have max 4 digits",position:I});continue}D()}if(L===":"){if(A.maxLength!==null)throw new r({expressionText:S,message:"only one :maxLength is allowed per varspec",position:I});if(A.exploded)throw new r({expressionText:S,message:"an exploeded varspec MUST NOT be varspeced",position:I});E=I+1;continue}if(L==="*"){if(A===null)throw new r({expressionText:S,message:"exploded without varspec",position:I});if(A.exploded)throw new r({expressionText:S,message:"exploded twice",position:I});if(A.maxLength)throw new r({expressionText:S,message:"an explode (*) MUST NOT follow to a prefix",position:I});A.exploded=!0;continue}if(L===","){w.push(A),A=null,R=I+1;continue}throw new r({expressionText:S,message:"illegal character",character:L,position:I})}return R!==null&&F(),E!==null&&D(),w.push(A),new v(S,T,w)}function _(S){var T,w,A=[],R=null,E=0;for(T=0;T<S.length;T+=1){if(w=S.charAt(T),E!==null){if(w==="}")throw new r({templateText:S,message:"unopened brace closed",position:T});w==="{"&&(E<T&&A.push(new f(S.substring(E,T))),E=null,R=T);continue}if(R!==null){if(w==="{")throw new r({templateText:S,message:"brace already opened",position:T});if(w==="}"){if(R+1===T)throw new r({templateText:S,message:"empty braces",position:R});try{A.push(b(S.substring(R+1,T)))}catch(I){throw I.prototype===r.prototype?new r({templateText:S,message:I.options.message,position:R+I.options.position,details:I.options}):I}R=null,E=T+1}continue}throw new Error("reached unreachable code")}if(R!==null)throw new r({templateText:S,message:"unclosed brace",position:R});return E<S.length&&A.push(new f(S.substr(E))),new g(S,A)}return _}(),v=function(){function b(L){return JSON&&JSON.stringify?JSON.stringify(L):L}function _(L){if(!d(L))return!0;if(a.isString(L))return L==="";if(a.isNumber(L)||a.isBoolean(L))return!1;if(a.isArray(L))return L.length===0;for(var F in L)if(L.hasOwnProperty(F))return!1;return!0}function S(L){var F=[],D;for(D in L)L.hasOwnProperty(D)&&F.push({name:D,value:L[D]});return F}function T(L,F,D){this.templateText=L,this.operator=F,this.varspecs=D}T.prototype.toString=function(){return this.templateText};function w(L,F,D){var $="";if(D=D.toString(),F.named){if($+=c.encodeLiteral(L.varname),D==="")return $+=F.ifEmpty,$;$+="="}return L.maxLength!==null&&(D=D.substr(0,L.maxLength)),$+=F.encode(D),$}function A(L){return d(L.value)}function R(L,F,D){var $=[],O="";if(F.named){if(O+=c.encodeLiteral(L.varname),_(D))return O+=F.ifEmpty,O;O+="="}return a.isArray(D)?($=D,$=a.filter($,d),$=a.map($,F.encode),O+=a.join($,",")):($=S(D),$=a.filter($,A),$=a.map($,function(P){return F.encode(P.name)+","+F.encode(P.value)}),O+=a.join($,",")),O}function E(L,F,D){var $=a.isArray(D),O=[];return $?(O=D,O=a.filter(O,d),O=a.map(O,function(P){var C=c.encodeLiteral(L.varname);return _(P)?C+=F.ifEmpty:C+="="+F.encode(P),C})):(O=S(D),O=a.filter(O,A),O=a.map(O,function(P){var C=c.encodeLiteral(P.name);return _(P.value)?C+=F.ifEmpty:C+="="+F.encode(P.value),C})),a.join(O,F.separator)}function I(L,F){var D=[],$="";return a.isArray(F)?(D=F,D=a.filter(D,d),D=a.map(D,L.encode),$+=a.join(D,L.separator)):(D=S(F),D=a.filter(D,function(O){return d(O.value)}),D=a.map(D,function(O){return L.encode(O.name)+"="+L.encode(O.value)}),$+=a.join(D,L.separator)),$}return T.prototype.expand=function(L){var F=[],D,$,O,P=this.operator;for(D=0;D<this.varspecs.length;D+=1)if($=this.varspecs[D],O=L[$.varname],O!=null)if($.exploded,a.isArray(O),typeof O=="string"||typeof O=="number"||typeof O=="boolean")F.push(w($,P,O));else{if($.maxLength&&d(O))throw new Error("Prefix modifiers are not applicable to variables that have composite values. You tried to expand "+this+" with "+b(O));$.exploded?d(O)&&(P.named?F.push(E($,P,O)):F.push(I(P,O))):(P.named||!_(O))&&F.push(R($,P,O))}return F.length===0?"":P.first+a.join(F,P.separator)},T}(),g=function(){function b(_,S){this.templateText=_,this.expressions=S,a.deepFreeze(this)}return b.prototype.toString=function(){return this.templateText},b.prototype.expand=function(_){var S,T="";for(S=0;S<this.expressions.length;S+=1)T+=this.expressions[S].expand(_);return T},b.parse=h,b.UriTemplateError=r,b}();t(g)})(function(t){n.exports=t})}(uritemplate)),uritemplate.exports}var hasRequiredActorRdfMetadataExtractHydraControls;function requireActorRdfMetadataExtractHydraControls(){if(hasRequiredActorRdfMetadataExtractHydraControls)return ActorRdfMetadataExtractHydraControls;hasRequiredActorRdfMetadataExtractHydraControls=1,Object.defineProperty(ActorRdfMetadataExtractHydraControls,"__esModule",{value:!0}),ActorRdfMetadataExtractHydraControls.ActorRdfMetadataExtractHydraControls=void 0;const n=requireLib$3B(),t=requireLib$4s(),r=requireUritemplate();let a=class Dn extends n.ActorRdfMetadataExtract{constructor(u){super(u),this.parsedUriTemplateCache={}}async test(u){return(0,t.passTestVoid)()}getLinks(u,s){return Object.fromEntries(Dn.LINK_TYPES.map(c=>{const l=s[c]||s[`${c}Page`],d=l&&l[u];return[c,d&&d.length>0?[d[0]]:[]]}))}parseUriTemplateCached(u){const s=this.parsedUriTemplateCache[u];return s||(this.parsedUriTemplateCache[u]=(0,r.parse)(u))}getSearchForms(u){const s=u.search,c=[];if(s)for(const l in s)for(const d of s[l]){const f=(u.template||{})[d]||[];if(f.length!==1)throw new Error(`Expected 1 hydra:template for ${d}`);const h=f[0],v=this.parseUriTemplateCached(h),g=Object.fromEntries(((u.mapping||{})[d]||[]).map(_=>{const S=((u.variable||{})[_]||[])[0],T=((u.property||{})[_]||[])[0];if(!S)throw new Error(`Expected a hydra:variable for ${_}`);if(!T)throw new Error(`Expected a hydra:property for ${_}`);return[T,S]})),b=_=>v.expand(Object.fromEntries(Object.keys(_).map(S=>[g[S],_[S]])));c.push({dataset:l,template:h,mappings:g,getUri:b})}return{values:c}}getHydraProperties(u){return new Promise((s,c)=>{u.on("error",c);const l={};u.on("data",d=>{if(d.predicate.value.startsWith(Dn.HYDRA)){const f=d.predicate.value.slice(Dn.HYDRA.length),h=l[f]||(l[f]={});(h[d.subject.value]||(h[d.subject.value]=[])).push(d.object.value)}}),u.on("end",()=>s(l))})}async run(u){const s={},c=await this.getHydraProperties(u.metadata);return Object.assign(s,this.getLinks(u.url,c)),s.searchForms=this.getSearchForms(c),{metadata:s}}};return ActorRdfMetadataExtractHydraControls.ActorRdfMetadataExtractHydraControls=a,a.HYDRA="http://www.w3.org/ns/hydra/core#",a.LINK_TYPES=["first","next","previous","last"],ActorRdfMetadataExtractHydraControls}var hasRequiredLib$3A;function requireLib$3A(){return hasRequiredLib$3A||(hasRequiredLib$3A=1,function(n){var t=lib$3B&&lib$3B.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3B&&lib$3B.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractHydraControls(),n)}(lib$3B)),lib$3B}var lib$3z={},ActorRdfMetadataExtractHydraCount={},hasRequiredActorRdfMetadataExtractHydraCount;function requireActorRdfMetadataExtractHydraCount(){if(hasRequiredActorRdfMetadataExtractHydraCount)return ActorRdfMetadataExtractHydraCount;hasRequiredActorRdfMetadataExtractHydraCount=1,Object.defineProperty(ActorRdfMetadataExtractHydraCount,"__esModule",{value:!0}),ActorRdfMetadataExtractHydraCount.ActorRdfMetadataExtractHydraCount=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}run(o){return new Promise((u,s)=>{o.metadata.on("error",s),o.metadata.on("data",c=>{this.predicates.includes(c.predicate.value)&&u({metadata:{cardinality:{type:"estimate",value:Number.parseInt(c.object.value,10),dataset:c.subject.value}}})}),o.metadata.on("end",()=>{u({metadata:{cardinality:{type:"estimate",value:0}}})})})}};return ActorRdfMetadataExtractHydraCount.ActorRdfMetadataExtractHydraCount=r,ActorRdfMetadataExtractHydraCount}var hasRequiredLib$3z;function requireLib$3z(){return hasRequiredLib$3z||(hasRequiredLib$3z=1,function(n){var t=lib$3z&&lib$3z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3z&&lib$3z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractHydraCount(),n)}(lib$3z)),lib$3z}var lib$3y={},ActorRdfMetadataExtractHydraPagesize={},hasRequiredActorRdfMetadataExtractHydraPagesize;function requireActorRdfMetadataExtractHydraPagesize(){if(hasRequiredActorRdfMetadataExtractHydraPagesize)return ActorRdfMetadataExtractHydraPagesize;hasRequiredActorRdfMetadataExtractHydraPagesize=1,Object.defineProperty(ActorRdfMetadataExtractHydraPagesize,"__esModule",{value:!0}),ActorRdfMetadataExtractHydraPagesize.ActorRdfMetadataExtractHydraPagesize=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return new Promise((u,s)=>{o.metadata.on("error",s),o.metadata.on("data",c=>{this.predicates.includes(c.predicate.value)&&u({metadata:{pageSize:Number.parseInt(c.object.value,10)}})}),o.metadata.on("end",()=>{u({metadata:{}})})})}};return ActorRdfMetadataExtractHydraPagesize.ActorRdfMetadataExtractHydraPagesize=r,ActorRdfMetadataExtractHydraPagesize}var hasRequiredLib$3y;function requireLib$3y(){return hasRequiredLib$3y||(hasRequiredLib$3y=1,function(n){var t=lib$3y&&lib$3y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3y&&lib$3y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractHydraPagesize(),n)}(lib$3y)),lib$3y}var lib$3x={},ActorRdfMetadataExtractRequestTime={},hasRequiredActorRdfMetadataExtractRequestTime;function requireActorRdfMetadataExtractRequestTime(){if(hasRequiredActorRdfMetadataExtractRequestTime)return ActorRdfMetadataExtractRequestTime;hasRequiredActorRdfMetadataExtractRequestTime=1,Object.defineProperty(ActorRdfMetadataExtractRequestTime,"__esModule",{value:!0}),ActorRdfMetadataExtractRequestTime.ActorRdfMetadataExtractRequestTime=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){return{metadata:{requestTime:o.requestTime}}}};return ActorRdfMetadataExtractRequestTime.ActorRdfMetadataExtractRequestTime=r,ActorRdfMetadataExtractRequestTime}var hasRequiredLib$3x;function requireLib$3x(){return hasRequiredLib$3x||(hasRequiredLib$3x=1,function(n){var t=lib$3x&&lib$3x.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3x&&lib$3x.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractRequestTime(),n)}(lib$3x)),lib$3x}var lib$3w={},ActorRdfMetadataExtractAllowHttpMethods={},hasRequiredActorRdfMetadataExtractAllowHttpMethods;function requireActorRdfMetadataExtractAllowHttpMethods(){if(hasRequiredActorRdfMetadataExtractAllowHttpMethods)return ActorRdfMetadataExtractAllowHttpMethods;hasRequiredActorRdfMetadataExtractAllowHttpMethods=1,Object.defineProperty(ActorRdfMetadataExtractAllowHttpMethods,"__esModule",{value:!0}),ActorRdfMetadataExtractAllowHttpMethods.ActorRdfMetadataExtractAllowHttpMethods=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){var s,c;const u={};return(s=o.headers)!=null&&s.get("allow")&&(u.allowHttpMethods=(c=o.headers.get("allow"))==null?void 0:c.split(/, */u)),{metadata:u}}};return ActorRdfMetadataExtractAllowHttpMethods.ActorRdfMetadataExtractAllowHttpMethods=r,ActorRdfMetadataExtractAllowHttpMethods}var hasRequiredLib$3w;function requireLib$3w(){return hasRequiredLib$3w||(hasRequiredLib$3w=1,function(n){var t=lib$3w&&lib$3w.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3w&&lib$3w.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractAllowHttpMethods(),n)}(lib$3w)),lib$3w}var lib$3v={},ActorRdfMetadataExtractPutAccepted={},hasRequiredActorRdfMetadataExtractPutAccepted;function requireActorRdfMetadataExtractPutAccepted(){if(hasRequiredActorRdfMetadataExtractPutAccepted)return ActorRdfMetadataExtractPutAccepted;hasRequiredActorRdfMetadataExtractPutAccepted=1,Object.defineProperty(ActorRdfMetadataExtractPutAccepted,"__esModule",{value:!0}),ActorRdfMetadataExtractPutAccepted.ActorRdfMetadataExtractPutAccepted=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){var s,c;const u={};return(s=o.headers)!=null&&s.get("accept-put")&&(u.putAccepted=(c=o.headers.get("accept-put"))==null?void 0:c.split(/, */u)),{metadata:u}}};return ActorRdfMetadataExtractPutAccepted.ActorRdfMetadataExtractPutAccepted=r,ActorRdfMetadataExtractPutAccepted}var hasRequiredLib$3v;function requireLib$3v(){return hasRequiredLib$3v||(hasRequiredLib$3v=1,function(n){var t=lib$3v&&lib$3v.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3v&&lib$3v.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractPutAccepted(),n)}(lib$3v)),lib$3v}var lib$3u={},ActorRdfMetadataExtractPatchSparqlUpdate={},hasRequiredActorRdfMetadataExtractPatchSparqlUpdate;function requireActorRdfMetadataExtractPatchSparqlUpdate(){if(hasRequiredActorRdfMetadataExtractPatchSparqlUpdate)return ActorRdfMetadataExtractPatchSparqlUpdate;hasRequiredActorRdfMetadataExtractPatchSparqlUpdate=1,Object.defineProperty(ActorRdfMetadataExtractPatchSparqlUpdate,"__esModule",{value:!0}),ActorRdfMetadataExtractPatchSparqlUpdate.ActorRdfMetadataExtractPatchSparqlUpdate=void 0;const n=requireLib$3B(),t=requireLib$4s();let r=class extends n.ActorRdfMetadataExtract{constructor(o){super(o)}async test(o){return(0,t.passTestVoid)()}async run(o){var s,c,l,d;const u={};return(((c=(s=o.headers)==null?void 0:s.get("accept-patch"))==null?void 0:c.includes("application/sparql-update"))??((d=(l=o.headers)==null?void 0:l.get("ms-author-via"))==null?void 0:d.includes("SPARQL")))&&(u.patchSparqlUpdate=!0),{metadata:u}}};return ActorRdfMetadataExtractPatchSparqlUpdate.ActorRdfMetadataExtractPatchSparqlUpdate=r,ActorRdfMetadataExtractPatchSparqlUpdate}var hasRequiredLib$3u;function requireLib$3u(){return hasRequiredLib$3u||(hasRequiredLib$3u=1,function(n){var t=lib$3u&&lib$3u.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3u&&lib$3u.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractPatchSparqlUpdate(),n)}(lib$3u)),lib$3u}var lib$3t={},ActorRdfMetadataExtractSparqlService={},hasRequiredActorRdfMetadataExtractSparqlService;function requireActorRdfMetadataExtractSparqlService(){if(hasRequiredActorRdfMetadataExtractSparqlService)return ActorRdfMetadataExtractSparqlService;hasRequiredActorRdfMetadataExtractSparqlService=1,Object.defineProperty(ActorRdfMetadataExtractSparqlService,"__esModule",{value:!0}),ActorRdfMetadataExtractSparqlService.ActorRdfMetadataExtractSparqlService=void 0;const n=requireLib$3B(),t=requireLib$4s(),r=requireRelativeToAbsoluteIri();let a=class extends n.ActorRdfMetadataExtract{constructor(u){super(u)}async test(u){return(0,t.passTestVoid)()}async run(u){return new Promise((s,c)=>{u.metadata.on("error",c);const l=new Set([u.url]),d={},f=new Set,h=new Set,v=new Set;u.metadata.on("data",g=>{if(g.predicate.value==="http://rdfs.org/ns/void#subset"&&g.object.value===u.url)l.add(g.subject.value);else if(g.subject.value===d.defaultDataset||g.subject.termType==="BlankNode"||l.has(g.subject.value))switch(g.predicate.value){case"http://www.w3.org/ns/sparql-service-description#endpoint":d.sparqlService=g.object.termType==="Literal"?(0,r.resolve)(g.object.value,u.url):g.object.value,this.inferHttpsEndpoint&&u.url.startsWith("https")&&!g.object.value.startsWith("https")&&(d.sparqlService=d.sparqlService.replace(/^http:/u,"https:"));break;case"http://www.w3.org/ns/sparql-service-description#defaultDataset":d.defaultDataset=g.object.value;break;case"http://www.w3.org/ns/sparql-service-description#defaultGraph":d.defaultGraph=g.object.value;break;case"http://www.w3.org/ns/sparql-service-description#inputFormat":f.add(g.object.value);break;case"http://www.w3.org/ns/sparql-service-description#resultFormat":h.add(g.object.value);break;case"http://www.w3.org/ns/sparql-service-description#supportedLanguage":v.add(g.object.value);break;case"http://www.w3.org/ns/sparql-service-description#feature":g.object.value==="http://www.w3.org/ns/sparql-service-description#UnionDefaultGraph"?d.unionDefaultGraph=!0:g.object.value==="http://www.w3.org/ns/sparql-service-description#BasicFederatedQuery"&&(d.basicFederatedQuery=!0);break}}),u.metadata.on("end",()=>{s({metadata:{...d,...f.size>0?{inputFormats:[...f.values()]}:{},...h.size>0?{resultFormats:[...h.values()]}:{},...v.size>0?{supportedLanguages:[...v.values()]}:{}}})})})}};return ActorRdfMetadataExtractSparqlService.ActorRdfMetadataExtractSparqlService=a,ActorRdfMetadataExtractSparqlService}var hasRequiredLib$3t;function requireLib$3t(){return hasRequiredLib$3t||(hasRequiredLib$3t=1,function(n){var t=lib$3t&&lib$3t.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3t&&lib$3t.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfMetadataExtractSparqlService(),n)}(lib$3t)),lib$3t}var lib$3s={},ActorRdfParseN3={},lib$3r={},ActorRdfParse={},hasRequiredActorRdfParse;function requireActorRdfParse(){if(hasRequiredActorRdfParse)return ActorRdfParse;hasRequiredActorRdfParse=1,Object.defineProperty(ActorRdfParse,"__esModule",{value:!0}),ActorRdfParse.ActorRdfParse=void 0;const n=requireLib$3Z();let t=class extends n.ActorAbstractMediaTyped{constructor(a){super(a)}};return ActorRdfParse.ActorRdfParse=t,ActorRdfParse}var ActorRdfParseFixedMediaTypes={},hasRequiredActorRdfParseFixedMediaTypes;function requireActorRdfParseFixedMediaTypes(){if(hasRequiredActorRdfParseFixedMediaTypes)return ActorRdfParseFixedMediaTypes;hasRequiredActorRdfParseFixedMediaTypes=1,Object.defineProperty(ActorRdfParseFixedMediaTypes,"__esModule",{value:!0}),ActorRdfParseFixedMediaTypes.ActorRdfParseFixedMediaTypes=void 0;const n=requireLib$3Z(),t=requireLib$4s();let r=class extends n.ActorAbstractMediaTypedFixed{constructor(o){super(o)}async testHandleChecked(o){return(0,t.passTestVoid)()}};return ActorRdfParseFixedMediaTypes.ActorRdfParseFixedMediaTypes=r,ActorRdfParseFixedMediaTypes}var hasRequiredLib$3s;function requireLib$3s(){return hasRequiredLib$3s||(hasRequiredLib$3s=1,function(n){var t=lib$3r&&lib$3r.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3r&&lib$3r.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParse(),n),r(requireActorRdfParseFixedMediaTypes(),n)}(lib$3r)),lib$3r}var bufferExports=requireBuffer();/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var queueMicrotask_1,hasRequiredQueueMicrotask;function requireQueueMicrotask(){if(hasRequiredQueueMicrotask)return queueMicrotask_1;hasRequiredQueueMicrotask=1;let n;return queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal$1):t=>(n||(n=Promise.resolve())).then(t).catch(r=>setTimeout(()=>{throw r},0)),queueMicrotask_1}var queueMicrotaskExports=requireQueueMicrotask();const queueMicrotask$1=getDefaultExportFromCjs(queueMicrotaskExports),RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",XSD="http://www.w3.org/2001/XMLSchema#",SWAP="http://www.w3.org/2000/10/swap/",namespaces={xsd:{decimal:`${XSD}decimal`,boolean:`${XSD}boolean`,double:`${XSD}double`,integer:`${XSD}integer`,string:`${XSD}string`},rdf:{type:`${RDF}type`,nil:`${RDF}nil`,first:`${RDF}first`,rest:`${RDF}rest`,langString:`${RDF}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${SWAP}reify#forSome`,forAll:`${SWAP}reify#forAll`},log:{implies:`${SWAP}log#implies`,isImpliedBy:`${SWAP}log#isImpliedBy`}},{xsd:xsd$2}=namespaces,escapeSequence=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,escapeReplacements={"\\":"\\","'":"'",'"':'"',n:`
`,r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},illegalIriChars=/[\x00-\x20<>\\"\{\}\|\^\`]/,lineModeRegExps={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},invalidRegExp=/$0^/;class N3Lexer{constructor(t){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,t=t||{},this._isImpliedBy=t.isImpliedBy,this._lineMode=!!t.lineMode){this._n3Mode=!1;for(const r in this)!(r in lineModeRegExps)&&this[r]instanceof RegExp&&(this[r]=invalidRegExp)}else this._n3Mode=t.n3!==!1;this.comments=!!t.comments,this._literalClosingPos=0}_tokenizeToEnd(t,r){let a=this._input,o=a.length;for(;;){let c,l;for(;c=this._newline.exec(a);)this.comments&&(l=this._comment.exec(c[0]))&&u("comment",l[1],"",this._line,c[0].length),a=a.substr(c[0].length,a.length),o=a.length,this._line++;if(!c&&(c=this._whitespace.exec(a))&&(a=a.substr(c[0].length,a.length)),this._endOfFile.test(a))return r&&(this.comments&&(l=this._comment.exec(a))&&u("comment",l[1],"",this._line,a.length),a=null,u("eof","","",this._line,0)),this._input=a;const d=this._line,f=a[0];let h="",v="",g="",b=null,_=0,S=!1;switch(f){case"^":if(a.length<3)break;if(a[1]==="^"){if(this._previousMarker="^^",a=a.substr(2),a[0]!=="<"){S=!0;break}}else{this._n3Mode&&(_=1,h="^");break}case"<":if(b=this._unescapedIri.exec(a))h="IRI",v=b[1];else if(b=this._iri.exec(a)){if(v=this._unescape(b[1]),v===null||illegalIriChars.test(v))return s(this);h="IRI"}else a.length>1&&a[1]==="<"?(h="<<",_=2):this._n3Mode&&a.length>1&&a[1]==="="&&(_=2,this._isImpliedBy?(h="abbreviation",v="<"):(h="inverse",v=">"));break;case">":a.length>1&&a[1]===">"&&(h=">>",_=2);break;case"_":((b=this._blank.exec(a))||r&&(b=this._blank.exec(`${a} `)))&&(h="blank",g="_",v=b[1]);break;case'"':if(b=this._simpleQuotedString.exec(a))v=b[1];else if({value:v,matchLength:_}=this._parseLiteral(a),v===null)return s(this);(b!==null||_!==0)&&(h="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(b=this._simpleApostropheString.exec(a))v=b[1];else if({value:v,matchLength:_}=this._parseLiteral(a),v===null)return s(this);(b!==null||_!==0)&&(h="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(b=this._variable.exec(a))&&(h="var",v=b[0]);break;case"@":this._previousMarker==="literal"&&(b=this._langcode.exec(a))?(h="langcode",v=b[1]):(b=this._keyword.exec(a))&&(h=b[0]);break;case".":if(a.length===1?r:a[1]<"0"||a[1]>"9"){h=".",_=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(b=this._number.exec(a)||r&&(b=this._number.exec(`${a} `)))&&(h="literal",v=b[0],g=typeof b[1]=="string"?xsd$2.double:typeof b[2]=="string"?xsd$2.decimal:xsd$2.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(b=this._sparqlKeyword.exec(a))?h=b[0].toUpperCase():S=!0;break;case"f":case"t":(b=this._boolean.exec(a))?(h="literal",v=b[0],g=xsd$2.boolean):S=!0;break;case"a":(b=this._shortPredicates.exec(a))?(h="abbreviation",v="a"):S=!0;break;case"=":this._n3Mode&&a.length>1&&(h="abbreviation",a[1]!==">"?(_=1,v="="):(_=2,v=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(_=1,h=f);break;case"{":!this._lineMode&&a.length>=2&&(a[1]==="|"?(h="{|",_=2):(h=f,_=1));break;case"|":a.length>=2&&a[1]==="}"&&(h="|}",_=2);break;default:S=!0}if(S&&((this._previousMarker==="@prefix"||this._previousMarker==="PREFIX")&&(b=this._prefix.exec(a))?(h="prefix",v=b[1]||""):((b=this._prefixed.exec(a))||r&&(b=this._prefixed.exec(`${a} `)))&&(h="prefixed",g=b[1]||"",v=this._unescape(b[2]))),this._previousMarker==="^^")switch(h){case"prefixed":h="type";break;case"IRI":h="typeIRI";break;default:h=""}if(!h)return r||!/^'''|^"""/.test(a)&&/\n|\r/.test(a)?s(this):this._input=a;const T=_||b[0].length,w=u(h,v,g,d,T);this.previousToken=w,this._previousMarker=h,a=a.substr(T,a.length)}function u(c,l,d,f,h){const v=a?o-a.length:o,g=v+h,b={type:c,value:l,prefix:d,line:f,start:v,end:g};return t(null,b),b}function s(c){t(c._syntaxError(/^\S*/.exec(a)[0]))}}_unescape(t){let r=!1;const a=t.replace(escapeSequence,(o,u,s,c)=>{if(typeof u=="string")return String.fromCharCode(Number.parseInt(u,16));if(typeof s=="string"){let l=Number.parseInt(s,16);return l<=65535?String.fromCharCode(Number.parseInt(s,16)):String.fromCharCode(55296+((l-=65536)>>10),56320+(l&1023))}return c in escapeReplacements?escapeReplacements[c]:(r=!0,"")});return r?null:a}_parseLiteral(t){if(t.length>=3){const r=t.match(/^(?:"""|"|'''|'|)/)[0],a=r.length;let o=Math.max(this._literalClosingPos,a);for(;(o=t.indexOf(r,o))>0;){let u=0;for(;t[o-u-1]==="\\";)u++;if(u%2===0){const s=t.substring(a,o),c=s.split(/\r\n|\r|\n/).length-1,l=o+a;if(a===1&&c!==0||a===3&&this._lineMode)break;return this._line+=c,{value:this._unescape(s),matchLength:l}}o++}this._literalClosingPos=t.length-a+1}return{value:"",matchLength:0}}_syntaxError(t){this._input=null;const r=new Error(`Unexpected "${t}" on line ${this._line}.`);return r.context={token:void 0,line:this._line,previousToken:this.previousToken},r}_readStartingBom(t){return t.startsWith("\uFEFF")?t.substr(1):t}tokenize(t,r){if(this._line=1,typeof t=="string")if(this._input=this._readStartingBom(t),typeof r=="function")queueMicrotask$1(()=>this._tokenizeToEnd(r,!0));else{const a=[];let o;if(this._tokenizeToEnd((u,s)=>u?o=u:a.push(s),!0),o)throw o;return a}else this._pendingBuffer=null,typeof t.setEncoding=="function"&&t.setEncoding("utf8"),t.on("data",a=>{this._input!==null&&a.length!==0&&(this._pendingBuffer&&(a=bufferExports.Buffer.concat([this._pendingBuffer,a]),this._pendingBuffer=null),a[a.length-1]&128?this._pendingBuffer=a:(typeof this._input>"u"?this._input=this._readStartingBom(typeof a=="string"?a:a.toString()):this._input+=a,this._tokenizeToEnd(r,!1)))}),t.on("end",()=>{typeof this._input=="string"&&this._tokenizeToEnd(r,!0)}),t.on("error",r)}}const{rdf:rdf$1,xsd:xsd$1}=namespaces;let DEFAULTGRAPH$1,_blankNodeCounter=0;const DataFactory$1={namedNode:namedNode$1,blankNode,variable,literal:literal$1,defaultGraph,quad:quad$1,triple:quad$1,fromTerm,fromQuad};class Term{constructor(t){this.id=t}get value(){return this.id}equals(t){return t instanceof Term?this.id===t.id:!!t&&this.termType===t.termType&&this.value===t.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}class NamedNode extends Term{get termType(){return"NamedNode"}}class Literal extends Term{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const t=this.id;let r=t.lastIndexOf('"')+1;return r<t.length&&t[r++]==="@"?t.substr(r).toLowerCase():""}get datatype(){return new NamedNode(this.datatypeString)}get datatypeString(){const t=this.id,r=t.lastIndexOf('"')+1,a=r<t.length?t[r]:"";return a==="^"?t.substr(r+2):a!=="@"?xsd$1.string:rdf$1.langString}equals(t){return t instanceof Literal?this.id===t.id:!!t&&!!t.datatype&&this.termType===t.termType&&this.value===t.value&&this.language===t.language&&this.datatype.value===t.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class BlankNode extends Term{constructor(t){super(`_:${t}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Variable extends Term{constructor(t){super(`?${t}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}class DefaultGraph extends Term{constructor(){return super(""),DEFAULTGRAPH$1||this}get termType(){return"DefaultGraph"}equals(t){return this===t||!!t&&this.termType===t.termType}}DEFAULTGRAPH$1=new DefaultGraph;function termFromId(n,t,r){if(t=t||DataFactory$1,!n)return t.defaultGraph();switch(n[0]){case"?":return t.variable(n.substr(1));case"_":return t.blankNode(n.substr(2));case'"':if(t===DataFactory$1)return new Literal(n);if(n[n.length-1]==='"')return t.literal(n.substr(1,n.length-2));const a=n.lastIndexOf('"',n.length-1);return t.literal(n.substr(1,a-1),n[a+1]==="@"?n.substr(a+2):t.namedNode(n.substr(a+3)));case"[":n=JSON.parse(n);break;default:if(!r||!Array.isArray(n))return t.namedNode(n)}return t.quad(termFromId(n[0],t,!0),termFromId(n[1],t,!0),termFromId(n[2],t,!0),n[3]&&termFromId(n[3],t,!0))}function termToId(n,t){if(typeof n=="string")return n;if(n instanceof Term&&n.termType!=="Quad")return n.id;if(!n)return DEFAULTGRAPH$1.id;switch(n.termType){case"NamedNode":return n.value;case"BlankNode":return`_:${n.value}`;case"Variable":return`?${n.value}`;case"DefaultGraph":return"";case"Literal":return`"${n.value}"${n.language?`@${n.language}`:n.datatype&&n.datatype.value!==xsd$1.string?`^^${n.datatype.value}`:""}`;case"Quad":const r=[termToId(n.subject,!0),termToId(n.predicate,!0),termToId(n.object,!0)];return n.graph&&n.graph.termType!=="DefaultGraph"&&r.push(termToId(n.graph,!0)),t?r:JSON.stringify(r);default:throw new Error(`Unexpected termType: ${n.termType}`)}}class Quad extends Term{constructor(t,r,a,o){super(""),this._subject=t,this._predicate=r,this._object=a,this._graph=o||DEFAULTGRAPH$1}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(t){return!!t&&this._subject.equals(t.subject)&&this._predicate.equals(t.predicate)&&this._object.equals(t.object)&&this._graph.equals(t.graph)}}function namedNode$1(n){return new NamedNode(n)}function blankNode(n){return new BlankNode(n||`n3-${_blankNodeCounter++}`)}function literal$1(n,t){if(typeof t=="string")return new Literal(`"${n}"@${t.toLowerCase()}`);let r=t?t.value:"";return r===""&&(typeof n=="boolean"?r=xsd$1.boolean:typeof n=="number"&&(Number.isFinite(n)?r=Number.isInteger(n)?xsd$1.integer:xsd$1.double:(r=xsd$1.double,Number.isNaN(n)||(n=n>0?"INF":"-INF")))),r===""||r===xsd$1.string?new Literal(`"${n}"`):new Literal(`"${n}"^^${r}`)}function variable(n){return new Variable(n)}function defaultGraph(){return DEFAULTGRAPH$1}function quad$1(n,t,r,a){return new Quad(n,t,r,a)}function fromTerm(n){if(n instanceof Term)return n;switch(n.termType){case"NamedNode":return namedNode$1(n.value);case"BlankNode":return blankNode(n.value);case"Variable":return variable(n.value);case"DefaultGraph":return DEFAULTGRAPH$1;case"Literal":return literal$1(n.value,n.language||n.datatype);case"Quad":return fromQuad(n);default:throw new Error(`Unexpected termType: ${n.termType}`)}}function fromQuad(n){if(n instanceof Quad)return n;if(n.termType!=="Quad")throw new Error(`Unexpected termType: ${n.termType}`);return quad$1(fromTerm(n.subject),fromTerm(n.predicate),fromTerm(n.object),fromTerm(n.graph))}let blankNodePrefix=0;class N3Parser{constructor(t){this._contextStack=[],this._graph=null,t=t||{},this._setBase(t.baseIRI),t.factory&&initDataFactory(this,t.factory);const r=typeof t.format=="string"?t.format.match(/\w*$/)[0].toLowerCase():"",a=/turtle/.test(r),o=/trig/.test(r),u=/triple/.test(r),s=/quad/.test(r),c=this._n3Mode=/n3/.test(r),l=u||s;(this._supportsNamedGraphs=!(a||c))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(a||o||u||c),this._isImpliedBy=t.isImpliedBy,this._supportsRDFStar=r===""||/star|\*$/.test(r),l&&(this._resolveRelativeIRI=d=>null),this._blankNodePrefix=typeof t.blankNodePrefix!="string"?"":t.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=t.lexer||new N3Lexer({lineMode:l,n3:c,isImpliedBy:this._isImpliedBy}),this._explicitQuantifiers=!!t.explicitQuantifiers}static _resetBlankNodePrefix(){blankNodePrefix=0}_setBase(t){if(!t)this._base="",this._basePath="";else{const r=t.indexOf("#");r>=0&&(t=t.substr(0,r)),this._base=t,this._basePath=t.indexOf("/")<0?t:t.replace(/[^\/?]*(?:\?.*)?$/,""),t=t.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=t[0],this._baseScheme=t[1]}}_saveContext(t,r,a,o,u){const s=this._n3Mode;this._contextStack.push({type:t,subject:a,predicate:o,object:u,graph:r,inverse:s?this._inversePredicate:!1,blankPrefix:s?this._prefixes._:"",quantified:s?this._quantified:null}),s&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(t,r){const a=this._contextStack.pop();if(!a||a.type!==t)return this._error(`Unexpected ${r.type}`,r);this._subject=a.subject,this._predicate=a.predicate,this._object=a.object,this._graph=a.graph,this._n3Mode&&(this._inversePredicate=a.inverse,this._prefixes._=a.blankPrefix,this._quantified=a.quantified)}_readInTopContext(t){switch(t.type){case"eof":return this._graph!==null?this._error("Unclosed graph",t):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(t)}}_readEntity(t,r){let a;switch(t.type){case"IRI":case"typeIRI":const o=this._resolveIRI(t.value);if(o===null)return this._error("Invalid IRI",t);a=this._factory.namedNode(o);break;case"type":case"prefixed":const u=this._prefixes[t.prefix];if(u===void 0)return this._error(`Undefined prefix "${t.prefix}:"`,t);a=this._factory.namedNode(u+t.value);break;case"blank":a=this._factory.blankNode(this._prefixes[t.prefix]+t.value);break;case"var":a=this._factory.variable(t.value.substr(1));break;default:return this._error(`Expected entity but got ${t.type}`,t)}return!r&&this._n3Mode&&a.id in this._quantified&&(a=this._quantified[a.id]),a}_readSubject(t){switch(this._predicate=null,t.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._factory.blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._factory.blankNode(),null,null),this._readSubject):this._error("Unexpected graph",t);case"}":return this._readPunctuation(t);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier="blankNode",this._readQuantifierList):this._error('Unexpected "@forSome"',t);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier="variable",this._readQuantifierList):this._error('Unexpected "@forAll"',t);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",t);if(t.prefix.length===0)return this._literalValue=t.value,this._completeSubjectLiteral;this._subject=this._factory.literal(t.value,this._factory.namedNode(t.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",t);default:if((this._subject=this._readEntity(t))===void 0)return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(t){const r=t.type;switch(r){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[t.value];break;case".":case"]":case"}":return this._predicate===null?this._error(`Unexpected ${r}`,t):(this._subject=null,r==="]"?this._readBlankNodeTail(t):this._readPunctuation(t));case";":return this._predicate!==null?this._readPredicate:this._error("Expected predicate but got ;",t);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._factory.blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",t);default:if((this._predicate=this._readEntity(t))===void 0)return}return this._readObject}_readObject(t){switch(t.type){case"literal":if(t.prefix.length===0)return this._literalValue=t.value,this._readDataTypeOrLang;this._object=this._factory.literal(t.value,this._factory.namedNode(t.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._factory.blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",t);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",t);default:if((this._object=this._readEntity(t))===void 0)return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(t){return t.type==="{"?this._readGraph(t):this._readPredicate(t)}_readGraph(t){return t.type!=="{"?this._error(`Expected graph but got ${t.type}`,t):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(t){return t.type==="]"?(this._subject=null,this._readBlankNodeTail(t)):(this._predicate=null,this._readPredicate(t))}_readBlankNodeTail(t){if(t.type!=="]")return this._readBlankNodePunctuation(t);this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph);const r=this._predicate===null;return this._restoreContext("blank",t),this._object!==null?this._getContextEndReader():this._predicate!==null?this._readObject:r?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(t){switch(t.type){case".":case"}":return this._subject=null,this._readPunctuation(t);default:return this._readPredicate(t)}}_readListItem(t){let r=null,a=null,o=this._readListItem;const u=this._subject,s=this._contextStack,c=s[s.length-1];switch(t.type){case"[":this._saveContext("blank",this._graph,a=this._factory.blankNode(),this.RDF_FIRST,this._subject=r=this._factory.blankNode()),o=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,a=this._factory.blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",t),s.length!==0&&s[s.length-1].type==="list"&&this._emit(this._subject,this._predicate,this._object,this._graph),this._predicate===null){if(o=this._readPredicate,this._subject===this.RDF_NIL)return o}else if(o=this._getContextEndReader(),this._object===this.RDF_NIL)return o;a=this.RDF_NIL;break;case"literal":t.prefix.length===0?(this._literalValue=t.value,o=this._readListItemDataTypeOrLang):(r=this._factory.literal(t.value,this._factory.namedNode(t.prefix)),o=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",t);default:if((r=this._readEntity(t))===void 0)return}if(a===null&&(this._subject=a=this._factory.blankNode()),u===null?c.predicate===null?c.subject=a:c.object=a:this._emit(u,this.RDF_REST,a,this._graph),r!==null){if(this._n3Mode&&(t.type==="IRI"||t.type==="prefixed"))return this._saveContext("item",this._graph,a,this.RDF_FIRST,r),this._subject=r,this._predicate=null,this._getPathReader(this._readListItem);this._emit(a,this.RDF_FIRST,r,this._graph)}return o}_readDataTypeOrLang(t){return this._completeObjectLiteral(t,!1)}_readListItemDataTypeOrLang(t){return this._completeObjectLiteral(t,!0)}_completeLiteral(t){let r=this._factory.literal(this._literalValue);switch(t.type){case"type":case"typeIRI":const a=this._readEntity(t);if(a===void 0)return;r=this._factory.literal(this._literalValue,a),t=null;break;case"langcode":r=this._factory.literal(this._literalValue,t.value),t=null;break}return{token:t,literal:r}}_completeSubjectLiteral(t){return this._subject=this._completeLiteral(t).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(t,r){const a=this._completeLiteral(t);if(a)return this._object=a.literal,r&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),a.token===null?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(a.token))}_readFormulaTail(t){return t.type!=="}"?this._readPunctuation(t):(this._subject!==null&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",t),this._object===null?this._readPredicate:this._getContextEndReader())}_readPunctuation(t){let r,a=this._graph;const o=this._subject,u=this._inversePredicate;switch(t.type){case"}":if(this._graph===null)return this._error("Unexpected graph closing",t);if(this._n3Mode)return this._readFormulaTail(t);this._graph=null;case".":this._subject=null,r=this._contextStack.length?this._readSubject:this._readInTopContext,u&&(this._inversePredicate=!1);break;case";":r=this._readPredicate;break;case",":r=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",t);const s=this._predicate,c=this._object;this._subject=this._factory.quad(o,s,c,this.DEFAULTGRAPH),r=this._readPredicate;break;case"|}":if(this._subject.termType!=="Quad")return this._error("Unexpected asserted triple closing",t);this._subject=null,r=this._readPunctuation;break;default:if(this._supportsQuads&&this._graph===null&&(a=this._readEntity(t))!==void 0){r=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}if(o!==null){const s=this._predicate,c=this._object;u?this._emit(c,s,o,a):this._emit(o,s,c,a)}return r}_readBlankNodePunctuation(t){let r;switch(t.type){case";":r=this._readPredicate;break;case",":r=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,t)}return this._emit(this._subject,this._predicate,this._object,this._graph),r}_readQuadPunctuation(t){return t.type!=="."?this._error("Expected dot to follow quad",t):this._readInTopContext}_readPrefix(t){return t.type!=="prefix"?this._error("Expected prefix to follow @prefix",t):(this._prefix=t.value,this._readPrefixIRI)}_readPrefixIRI(t){if(t.type!=="IRI")return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,t);const r=this._readEntity(t);return this._prefixes[this._prefix]=r.value,this._prefixCallback(this._prefix,r),this._readDeclarationPunctuation}_readBaseIRI(t){const r=t.type==="IRI"&&this._resolveIRI(t.value);return r?(this._setBase(r),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",t)}_readNamedGraphLabel(t){switch(t.type){case"IRI":case"blank":case"prefixed":return this._readSubject(t),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",t)}}_readNamedGraphBlankLabel(t){return t.type!=="]"?this._error("Invalid graph label",t):(this._subject=this._factory.blankNode(),this._readGraph)}_readDeclarationPunctuation(t){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(t)):t.type!=="."?this._error("Expected declaration to end with a dot",t):this._readInTopContext}_readQuantifierList(t){let r;switch(t.type){case"IRI":case"prefixed":if((r=this._readEntity(t,!0))!==void 0)break;default:return this._error(`Unexpected ${t.type}`,t)}return this._explicitQuantifiers?(this._subject===null?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,r,this.QUANTIFIERS_GRAPH)):this._quantified[r.id]=this._factory[this._quantifier](this._factory.blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(t){return t.type===","?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(t))}_getPathReader(t){return this._afterPath=t,this._readPath}_readPath(t){switch(t.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const r=this._contextStack,a=r.length&&r[r.length-1];if(a&&a.type==="item"){const o=this._subject;this._restoreContext("item",t),this._emit(this._subject,this.RDF_FIRST,o,this._graph)}return this._afterPath(t)}}_readForwardPath(t){let r,a;const o=this._factory.blankNode();if((a=this._readEntity(t))!==void 0)return this._predicate===null?(r=this._subject,this._subject=o):(r=this._object,this._object=o),this._emit(r,a,o,this._graph),this._readPath}_readBackwardPath(t){const r=this._factory.blankNode();let a,o;if((a=this._readEntity(t))!==void 0)return this._predicate===null?(o=this._subject,this._subject=r):(o=this._object,this._object=r),this._emit(r,a,o,this._graph),this._readPath}_readRDFStarTailOrGraph(t){return t.type!==">>"?this._supportsQuads&&this._graph===null&&(this._graph=this._readEntity(t))!==void 0?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,t):this._readRDFStarTail(t)}_readRDFStarTail(t){if(t.type!==">>")return this._error(`Expected >> but got ${t.type}`,t);const r=this._factory.quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",t),this._subject===null?(this._subject=r,this._readPredicate):(this._object=r,this._getContextEndReader())}_getContextEndReader(){const t=this._contextStack;if(!t.length)return this._readPunctuation;switch(t[t.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(t,r,a,o){this._callback(null,this._factory.quad(t,r,a,o||this.DEFAULTGRAPH))}_error(t,r){const a=new Error(`${t} on line ${r.line}.`);a.context={token:r,line:r.line,previousToken:this._lexer.previousToken},this._callback(a),this._callback=noop$2}_resolveIRI(t){return/^[a-z][a-z0-9+.-]*:/i.test(t)?t:this._resolveRelativeIRI(t)}_resolveRelativeIRI(t){if(!t.length)return this._base;switch(t[0]){case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return(t[1]==="/"?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return/^[^/:]*:/.test(t)?null:this._removeDotSegments(this._basePath+t)}}_removeDotSegments(t){if(!/(^|\/)\.\.?($|[/#?])/.test(t))return t;const r=t.length;let a="",o=-1,u=-1,s=0,c="/";for(;o<r;){switch(c){case":":if(u<0&&t[++o]==="/"&&t[++o]==="/")for(;(u=o+1)<r&&t[u]!=="/";)o=u;break;case"?":case"#":o=r;break;case"/":if(t[o+1]===".")switch(c=t[++o+1],c){case"/":a+=t.substring(s,o-1),s=o+1;break;case void 0:case"?":case"#":return a+t.substring(s,o)+t.substr(o+1);case".":if(c=t[++o+1],c===void 0||c==="/"||c==="?"||c==="#"){if(a+=t.substring(s,o-2),(s=a.lastIndexOf("/"))>=u&&(a=a.substr(0,s)),c!=="/")return`${a}/${t.substr(o+1)}`;s=o+1}}}c=t[++o]}return a+t.substring(s)}parse(t,r,a){let o,u,s;if(r&&(r.onQuad||r.onPrefix||r.onComment)?(o=r.onQuad,u=r.onPrefix,s=r.onComment):(o=r,u=a),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${blankNodePrefix++}_`,this._prefixCallback=u||noop$2,this._inversePredicate=!1,this._quantified=Object.create(null),!o){const l=[];let d;if(this._callback=(f,h)=>{f?d=f:h&&l.push(h)},this._lexer.tokenize(t).every(f=>this._readCallback=this._readCallback(f)),d)throw d;return l}let c=(l,d)=>{l!==null?(this._callback(l),this._callback=noop$2):this._readCallback&&(this._readCallback=this._readCallback(d))};s&&(this._lexer.comments=!0,c=(l,d)=>{l!==null?(this._callback(l),this._callback=noop$2):this._readCallback&&(d.type==="comment"?s(d.value):this._readCallback=this._readCallback(d))}),this._callback=o,this._lexer.tokenize(t,c)}}function noop$2(){}function initDataFactory(n,t){n._factory=t,n.DEFAULTGRAPH=t.defaultGraph(),n.RDF_FIRST=t.namedNode(namespaces.rdf.first),n.RDF_REST=t.namedNode(namespaces.rdf.rest),n.RDF_NIL=t.namedNode(namespaces.rdf.nil),n.N3_FORALL=t.namedNode(namespaces.r.forAll),n.N3_FORSOME=t.namedNode(namespaces.r.forSome),n.ABBREVIATIONS={a:t.namedNode(namespaces.rdf.type),"=":t.namedNode(namespaces.owl.sameAs),">":t.namedNode(namespaces.log.implies),"<":t.namedNode(namespaces.log.isImpliedBy)},n.QUANTIFIERS_GRAPH=t.namedNode("urn:n3:quantifiers")}initDataFactory(N3Parser.prototype,DataFactory$1);function isNamedNode(n){return!!n&&n.termType==="NamedNode"}function isBlankNode(n){return!!n&&n.termType==="BlankNode"}function isLiteral(n){return!!n&&n.termType==="Literal"}function isVariable(n){return!!n&&n.termType==="Variable"}function isDefaultGraph(n){return!!n&&n.termType==="DefaultGraph"}function inDefaultGraph(n){return isDefaultGraph(n.graph)}function prefix(n,t){return prefixes({"":n.value||n},t)("")}function prefixes(n,t){const r=Object.create(null);for(const o in n)a(o,n[o]);t=t||DataFactory$1;function a(o,u){if(typeof u=="string"){const s=Object.create(null);r[o]=c=>s[c]||(s[c]=t.namedNode(u+c))}else if(!(o in r))throw new Error(`Unknown prefix: ${o}`);return r[o]}return a}const Util$7=Object.freeze(Object.defineProperty({__proto__:null,inDefaultGraph,isBlankNode,isDefaultGraph,isLiteral,isNamedNode,isVariable,prefix,prefixes},Symbol.toStringTag,{value:"Module"})),DEFAULTGRAPH=DataFactory$1.defaultGraph(),{rdf,xsd}=namespaces,escape=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,escapeAll=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,escapedCharacters={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class SerializedTerm extends Term{equals(t){return t===this}}class N3Writer{constructor(t,r){if(this._prefixRegex=/$0^/,t&&typeof t.write!="function"&&(r=t,t=null),r=r||{},this._lists=r.lists,t)this._outputStream=t,this._endStream=r.end===void 0?!0:!!r.end;else{let a="";this._outputStream={write(o,u,s){a+=o,s&&s()},end:o=>{o&&o(null,a)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(r.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=DEFAULTGRAPH,this._prefixIRIs=Object.create(null),r.prefixes&&this.addPrefixes(r.prefixes),r.baseIRI&&(this._baseMatcher=new RegExp(`^${escapeRegex(r.baseIRI)}${r.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=r.baseIRI.length))}get _inDefaultGraph(){return DEFAULTGRAPH.equals(this._graph)}_write(t,r){this._outputStream.write(t,"utf8",r)}_writeQuad(t,r,a,o,u){try{o.equals(this._graph)||(this._write((this._subject===null?"":this._inDefaultGraph?`.
`:`
}
`)+(DEFAULTGRAPH.equals(o)?"":`${this._encodeIriOrBlank(o)} {
`)),this._graph=o,this._subject=null),t.equals(this._subject)?r.equals(this._predicate)?this._write(`, ${this._encodeObject(a)}`,u):this._write(`;
    ${this._encodePredicate(this._predicate=r)} ${this._encodeObject(a)}`,u):this._write(`${(this._subject===null?"":`.
`)+this._encodeSubject(this._subject=t)} ${this._encodePredicate(this._predicate=r)} ${this._encodeObject(a)}`,u)}catch(s){u&&u(s)}}_writeQuadLine(t,r,a,o,u){delete this._prefixMatch,this._write(this.quadToString(t,r,a,o),u)}quadToString(t,r,a,o){return`${this._encodeSubject(t)} ${this._encodeIriOrBlank(r)} ${this._encodeObject(a)}${o&&o.value?` ${this._encodeIriOrBlank(o)} .
`:` .
`}`}quadsToString(t){let r="";for(const a of t)r+=this.quadToString(a.subject,a.predicate,a.object,a.graph);return r}_encodeSubject(t){return t.termType==="Quad"?this._encodeQuad(t):this._encodeIriOrBlank(t)}_encodeIriOrBlank(t){if(t.termType!=="NamedNode")return this._lists&&t.value in this._lists&&(t=this.list(this._lists[t.value])),"id"in t?t.id:`_:${t.value}`;let r=t.value;this._baseMatcher&&this._baseMatcher.test(r)&&(r=r.substr(this._baseLength)),escape.test(r)&&(r=r.replace(escapeAll,characterReplacer));const a=this._prefixRegex.exec(r);return a?a[1]?this._prefixIRIs[a[1]]+a[2]:r:`<${r}>`}_encodeLiteral(t){let r=t.value;if(escape.test(r)&&(r=r.replace(escapeAll,characterReplacer)),t.language)return`"${r}"@${t.language}`;if(this._lineMode){if(t.datatype.value===xsd.string)return`"${r}"`}else switch(t.datatype.value){case xsd.string:return`"${r}"`;case xsd.boolean:if(r==="true"||r==="false")return r;break;case xsd.integer:if(/^[+-]?\d+$/.test(r))return r;break;case xsd.decimal:if(/^[+-]?\d*\.\d+$/.test(r))return r;break;case xsd.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(r))return r;break}return`"${r}"^^${this._encodeIriOrBlank(t.datatype)}`}_encodePredicate(t){return t.value===rdf.type?"a":this._encodeIriOrBlank(t)}_encodeObject(t){switch(t.termType){case"Quad":return this._encodeQuad(t);case"Literal":return this._encodeLiteral(t);default:return this._encodeIriOrBlank(t)}}_encodeQuad({subject:t,predicate:r,object:a,graph:o}){return`<<${this._encodeSubject(t)} ${this._encodePredicate(r)} ${this._encodeObject(a)}${isDefaultGraph(o)?"":` ${this._encodeIriOrBlank(o)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(t,r,a,o,u){a===void 0?this._writeQuad(t.subject,t.predicate,t.object,t.graph,r):typeof o=="function"?this._writeQuad(t,r,a,DEFAULTGRAPH,o):this._writeQuad(t,r,a,o||DEFAULTGRAPH,u)}addQuads(t){for(let r=0;r<t.length;r++)this.addQuad(t[r])}addPrefix(t,r,a){const o={};o[t]=r,this.addPrefixes(o,a)}addPrefixes(t,r){if(!this._prefixIRIs)return r&&r();let a=!1;for(let o in t){let u=t[o];typeof u!="string"&&(u=u.value),a=!0,this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null,this._graph=""),this._prefixIRIs[u]=o+=":",this._write(`@prefix ${o} <${u}>.
`)}if(a){let o="",u="";for(const s in this._prefixIRIs)o+=o?`|${s}`:s,u+=(u?"|":"")+this._prefixIRIs[s];o=escapeRegex(o),this._prefixRegex=new RegExp(`^(?:${u})[^/]*$|^(${o})([_a-zA-Z0-9][\\-_a-zA-Z0-9]*)$`)}this._write(a?`
`:"",r)}blank(t,r){let a=t,o,u;switch(t===void 0?a=[]:t.termType?a=[{predicate:t,object:r}]:"length"in t||(a=[t]),u=a.length){case 0:return new SerializedTerm("[]");case 1:if(o=a[0],!(o.object instanceof SerializedTerm))return new SerializedTerm(`[ ${this._encodePredicate(o.predicate)} ${this._encodeObject(o.object)} ]`);default:let s="[";for(let c=0;c<u;c++)o=a[c],o.predicate.equals(t)?s+=`, ${this._encodeObject(o.object)}`:(s+=`${(c?`;
  `:`
  `)+this._encodePredicate(o.predicate)} ${this._encodeObject(o.object)}`,t=o.predicate);return new SerializedTerm(`${s}
]`)}}list(t){const r=t&&t.length||0,a=new Array(r);for(let o=0;o<r;o++)a[o]=this._encodeObject(t[o]);return new SerializedTerm(`(${a.join(" ")})`)}end(t){this._subject!==null&&(this._write(this._inDefaultGraph?`.
`:`
}
`),this._subject=null),this._write=this._blockedWrite;let r=t&&((a,o)=>{r=null,t(a,o)});if(this._endStream)try{return this._outputStream.end(r)}catch{}r&&r()}}function characterReplacer(n){let t=escapedCharacters[n];return t===void 0&&(n.length===1?(t=n.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=((n.charCodeAt(0)-55296)*1024+n.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function escapeRegex(n){return n.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}var browserExports=requireBrowser();const ITERATOR=Symbol("iter");function merge$1(n,t,r=4){if(r===0)return Object.assign(n,t);for(const a in t)n[a]=merge$1(n[a]||Object.create(null),t[a],r-1);return n}function intersect(n,t,r=4){let a=!1;for(const o in n)if(o in t){const u=r===0?null:intersect(n[o],t[o],r-1);if(u!==!1)a=a||Object.create(null),a[o]=u;else if(r===3)return!1}return a}function difference(n,t,r=4){let a=!1;for(const o in n)if(!(o in t))a=a||Object.create(null),a[o]=r===0?null:merge$1({},n[o],r-1);else if(r!==0){const u=difference(n[o],t[o],r-1);if(u!==!1)a=a||Object.create(null),a[o]=u;else if(r===3)return!1}return a}class N3EntityIndex{constructor(t={}){this._id=1,this._ids=Object.create(null),this._ids[""]=1,this._entities=Object.create(null),this._entities[1]="",this._blankNodeIndex=0,this._factory=t.factory||DataFactory$1}_termFromId(t){if(t[0]==="."){const r=this._entities,a=t.split(".");return this._factory.quad(this._termFromId(r[a[1]]),this._termFromId(r[a[2]]),this._termFromId(r[a[3]]),a[4]&&this._termFromId(r[a[4]]))}return termFromId(t,this._factory)}_termToNumericId(t){if(t.termType==="Quad"){const r=this._termToNumericId(t.subject),a=this._termToNumericId(t.predicate),o=this._termToNumericId(t.object);let u;return r&&a&&o&&(isDefaultGraph(t.graph)||(u=this._termToNumericId(t.graph)))&&this._ids[u?`.${r}.${a}.${o}.${u}`:`.${r}.${a}.${o}`]}return this._ids[termToId(t)]}_termToNewNumericId(t){const r=t&&t.termType==="Quad"?`.${this._termToNewNumericId(t.subject)}.${this._termToNewNumericId(t.predicate)}.${this._termToNewNumericId(t.object)}${isDefaultGraph(t.graph)?"":`.${this._termToNewNumericId(t.graph)}`}`:termToId(t);return this._ids[r]||(this._ids[this._entities[++this._id]=r]=this._id)}createBlankNode(t){let r,a;if(t)for(r=t=`_:${t}`,a=1;this._ids[r];)r=t+a++;else do r=`_:b${this._blankNodeIndex++}`;while(this._ids[r]);return this._ids[r]=++this._id,this._entities[this._id]=r,this._factory.blankNode(r.substr(2))}}class N3Store{constructor(t,r){this._size=0,this._graphs=Object.create(null),!r&&t&&!t[0]&&typeof t.match!="function"&&(r=t,t=null),r=r||{},this._factory=r.factory||DataFactory$1,this._entityIndex=r.entityIndex||new N3EntityIndex({factory:this._factory}),this._entities=this._entityIndex._entities,this._termFromId=this._entityIndex._termFromId.bind(this._entityIndex),this._termToNumericId=this._entityIndex._termToNumericId.bind(this._entityIndex),this._termToNewNumericId=this._entityIndex._termToNewNumericId.bind(this._entityIndex),t&&this.addAll(t)}get size(){let t=this._size;if(t!==null)return t;t=0;const r=this._graphs;let a,o;for(const u in r)for(const s in a=r[u].subjects)for(const c in o=a[s])t+=Object.keys(o[c]).length;return this._size=t}_addToIndex(t,r,a,o){const u=t[r]||(t[r]={}),s=u[a]||(u[a]={}),c=o in s;return c||(s[o]=null),!c}_removeFromIndex(t,r,a,o){const u=t[r],s=u[a];delete s[o];for(const c in s)return;delete u[a];for(const c in u)return;delete t[r]}*_findInIndex(t,r,a,o,u,s,c,l){let d,f,h;const v=this._entities,g=this._termFromId(v[l]),b={subject:null,predicate:null,object:null};r&&((d=t,t={})[r]=d[r]);for(const _ in t)if(f=t[_]){b[u]=this._termFromId(v[_]),a&&((d=f,f={})[a]=d[a]);for(const S in f)if(h=f[S]){b[s]=this._termFromId(v[S]);const T=o?o in h?[o]:[]:Object.keys(h);for(let w=0;w<T.length;w++)b[c]=this._termFromId(v[T[w]]),yield this._factory.quad(b.subject,b.predicate,b.object,g)}}}_loop(t,r){for(const a in t)r(a)}_loopByKey0(t,r,a){let o,u;if(o=t[r])for(u in o)a(u)}_loopByKey1(t,r,a){let o,u;for(o in t)u=t[o],u[r]&&a(o)}_loopBy2Keys(t,r,a,o){let u,s,c;if((u=t[r])&&(s=u[a]))for(c in s)o(c)}_countInIndex(t,r,a,o){let u=0,s,c,l;r&&((s=t,t={})[r]=s[r]);for(const d in t)if(c=t[d]){a&&((s=c,c={})[a]=s[a]);for(const f in c)(l=c[f])&&(o?o in l&&u++:u+=Object.keys(l).length)}return u}_getGraphs(t){return t=t===""?1:t&&(this._termToNumericId(t)||-1),typeof t!="number"?this._graphs:{[t]:this._graphs[t]}}_uniqueEntities(t){const r=Object.create(null);return a=>{a in r||(r[a]=!0,t(this._termFromId(this._entities[a],this._factory)))}}add(t){return this.addQuad(t),this}addQuad(t,r,a,o){r||(o=t.graph,a=t.object,r=t.predicate,t=t.subject),o=o?this._termToNewNumericId(o):1;let u=this._graphs[o];return u||(u=this._graphs[o]={subjects:{},predicates:{},objects:{}},Object.freeze(u)),t=this._termToNewNumericId(t),r=this._termToNewNumericId(r),a=this._termToNewNumericId(a),this._addToIndex(u.subjects,t,r,a)?(this._addToIndex(u.predicates,r,a,t),this._addToIndex(u.objects,a,t,r),this._size=null,!0):!1}addQuads(t){for(let r=0;r<t.length;r++)this.addQuad(t[r])}delete(t){return this.removeQuad(t),this}has(t,r,a,o){return t&&t.subject&&({subject:t,predicate:r,object:a,graph:o}=t),!this.readQuads(t,r,a,o).next().done}import(t){return t.on("data",r=>{this.addQuad(r)}),t}removeQuad(t,r,a,o){r||({subject:t,predicate:r,object:a,graph:o}=t),o=o?this._termToNumericId(o):1;const u=this._graphs;let s,c,l;if(!(t=t&&this._termToNumericId(t))||!(r=r&&this._termToNumericId(r))||!(a=a&&this._termToNumericId(a))||!(s=u[o])||!(c=s.subjects[t])||!(l=c[r])||!(a in l))return!1;this._removeFromIndex(s.subjects,t,r,a),this._removeFromIndex(s.predicates,r,a,t),this._removeFromIndex(s.objects,a,t,r),this._size!==null&&this._size--;for(t in s.subjects)return!0;return delete u[o],!0}removeQuads(t){for(let r=0;r<t.length;r++)this.removeQuad(t[r])}remove(t){return t.on("data",r=>{this.removeQuad(r)}),t}removeMatches(t,r,a,o){const u=new browserExports.Readable({objectMode:!0}),s=this.readQuads(t,r,a,o);return u._read=c=>{for(;--c>=0;){const{done:l,value:d}=s.next();if(l){u.push(null);return}u.push(d)}},this.remove(u)}deleteGraph(t){return this.removeMatches(null,null,null,t)}getQuads(t,r,a,o){return[...this.readQuads(t,r,a,o)]}*readQuads(t,r,a,o){const u=this._getGraphs(o);let s,c,l,d;if(!(t&&!(c=this._termToNumericId(t))||r&&!(l=this._termToNumericId(r))||a&&!(d=this._termToNumericId(a))))for(const f in u)(s=u[f])&&(c?d?yield*this._findInIndex(s.objects,d,c,l,"object","subject","predicate",f):yield*this._findInIndex(s.subjects,c,l,null,"subject","predicate","object",f):l?yield*this._findInIndex(s.predicates,l,d,null,"predicate","object","subject",f):d?yield*this._findInIndex(s.objects,d,null,null,"object","subject","predicate",f):yield*this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",f))}match(t,r,a,o){return new DatasetCoreAndReadableStream(this,t,r,a,o,{entityIndex:this._entityIndex})}countQuads(t,r,a,o){const u=this._getGraphs(o);let s=0,c,l,d,f;if(t&&!(l=this._termToNumericId(t))||r&&!(d=this._termToNumericId(r))||a&&!(f=this._termToNumericId(a)))return 0;for(const h in u)(c=u[h])&&(t?a?s+=this._countInIndex(c.objects,f,l,d):s+=this._countInIndex(c.subjects,l,d,f):r?s+=this._countInIndex(c.predicates,d,f,l):s+=this._countInIndex(c.objects,f,l,d));return s}forEach(t,r,a,o,u){this.some(s=>(t(s,this),!1),r,a,o,u)}every(t,r,a,o,u){return!this.some(s=>!t(s,this),r,a,o,u)}some(t,r,a,o,u){for(const s of this.readQuads(r,a,o,u))if(t(s,this))return!0;return!1}getSubjects(t,r,a){const o=[];return this.forSubjects(u=>{o.push(u)},t,r,a),o}forSubjects(t,r,a,o){const u=this._getGraphs(o);let s,c,l;if(t=this._uniqueEntities(t),!(r&&!(c=this._termToNumericId(r))||a&&!(l=this._termToNumericId(a))))for(o in u)(s=u[o])&&(c?l?this._loopBy2Keys(s.predicates,c,l,t):this._loopByKey1(s.subjects,c,t):l?this._loopByKey0(s.objects,l,t):this._loop(s.subjects,t))}getPredicates(t,r,a){const o=[];return this.forPredicates(u=>{o.push(u)},t,r,a),o}forPredicates(t,r,a,o){const u=this._getGraphs(o);let s,c,l;if(t=this._uniqueEntities(t),!(r&&!(c=this._termToNumericId(r))||a&&!(l=this._termToNumericId(a))))for(o in u)(s=u[o])&&(c?l?this._loopBy2Keys(s.objects,l,c,t):this._loopByKey0(s.subjects,c,t):l?this._loopByKey1(s.predicates,l,t):this._loop(s.predicates,t))}getObjects(t,r,a){const o=[];return this.forObjects(u=>{o.push(u)},t,r,a),o}forObjects(t,r,a,o){const u=this._getGraphs(o);let s,c,l;if(t=this._uniqueEntities(t),!(r&&!(c=this._termToNumericId(r))||a&&!(l=this._termToNumericId(a))))for(o in u)(s=u[o])&&(c?l?this._loopBy2Keys(s.subjects,c,l,t):this._loopByKey1(s.objects,c,t):l?this._loopByKey0(s.predicates,l,t):this._loop(s.objects,t))}getGraphs(t,r,a){const o=[];return this.forGraphs(u=>{o.push(u)},t,r,a),o}forGraphs(t,r,a,o){for(const u in this._graphs)this.some(s=>(t(s.graph),!0),r,a,o,this._termFromId(this._entities[u]))}createBlankNode(t){return this._entityIndex.createBlankNode(t)}extractLists({remove:t=!1,ignoreErrors:r=!1}={}){const a={},o=r?()=>!0:(c,l)=>{throw new Error(`${c.value} ${l}`)},u=this.getQuads(null,namespaces.rdf.rest,namespaces.rdf.nil,null),s=t?[...u]:[];return u.forEach(c=>{const l=[];let d=!1,f,h;const v=c.graph;let g=c.subject;for(;g&&!d;){const b=this.getQuads(null,null,g,null),_=this.getQuads(g,null,null,null);let S,T=null,w=null,A=null;for(let R=0;R<_.length&&!d;R++)S=_[R],S.graph.equals(v)?f?d=o(g,"has non-list arcs out"):S.predicate.value===namespaces.rdf.first?T?d=o(g,"has multiple rdf:first arcs"):s.push(T=S):S.predicate.value===namespaces.rdf.rest?w?d=o(g,"has multiple rdf:rest arcs"):s.push(w=S):b.length?d=o(g,"can't be subject and object"):(f=S,h="subject"):d=o(g,"not confined to single graph");for(let R=0;R<b.length&&!d;++R)S=b[R],f?d=o(g,"can't have coreferences"):S.predicate.value===namespaces.rdf.rest?A?d=o(g,"has incoming rdf:rest arcs"):A=S:(f=S,h="object");T?l.unshift(T.object):d=o(g,"has no list head"),g=A&&A.subject}d?t=!1:f&&(a[f[h].value]=l)}),t&&this.removeQuads(s),a}addAll(t){if(t instanceof DatasetCoreAndReadableStream&&(t=t.filtered),Array.isArray(t))this.addQuads(t);else if(t instanceof N3Store&&t._entityIndex===this._entityIndex)t._size!==0&&(this._graphs=merge$1(this._graphs,t._graphs),this._size=null);else for(const r of t)this.add(r);return this}contains(t){if(t instanceof DatasetCoreAndReadableStream&&(t=t.filtered),t===this)return!0;if(!(t instanceof N3Store)||this._entityIndex!==t._entityIndex)return t.every(d=>this.has(d));const r=this._graphs,a=t._graphs;let o,u,s,c,l;for(const d in a){if(!(o=r[d]))return!1;o=o.subjects;for(const f in u=a[d].subjects){if(!(s=o[f]))return!1;for(const h in c=u[f]){if(!(l=s[h]))return!1;for(const v in c[h])if(!(v in l))return!1}}}return!0}deleteMatches(t,r,a,o){for(const u of this.match(t,r,a,o))this.removeQuad(u);return this}difference(t){if(t&&t instanceof DatasetCoreAndReadableStream&&(t=t.filtered),t===this)return new N3Store({entityIndex:this._entityIndex});if(t instanceof N3Store&&t._entityIndex===this._entityIndex){const r=new N3Store({entityIndex:this._entityIndex}),a=difference(this._graphs,t._graphs);return a&&(r._graphs=a,r._size=null),r}return this.filter(r=>!t.has(r))}equals(t){return t instanceof DatasetCoreAndReadableStream&&(t=t.filtered),t===this||this.size===t.size&&this.contains(t)}filter(t){const r=new N3Store({entityIndex:this._entityIndex});for(const a of this)t(a,this)&&r.add(a);return r}intersection(t){if(t instanceof DatasetCoreAndReadableStream&&(t=t.filtered),t===this){const r=new N3Store({entityIndex:this._entityIndex});return r._graphs=merge$1(Object.create(null),this._graphs),r._size=this._size,r}else if(t instanceof N3Store&&this._entityIndex===t._entityIndex){const r=new N3Store({entityIndex:this._entityIndex}),a=intersect(t._graphs,this._graphs);return a&&(r._graphs=a,r._size=null),r}return this.filter(r=>t.has(r))}map(t){const r=new N3Store({entityIndex:this._entityIndex});for(const a of this)r.add(t(a,this));return r}reduce(t,r){const a=this.readQuads();let o=r===void 0?a.next().value:r;for(const u of a)o=t(o,u,this);return o}toArray(){return this.getQuads()}toCanonical(){throw new Error("not implemented")}toStream(){return this.match()}toString(){return new N3Writer().quadsToString(this)}union(t){const r=new N3Store({entityIndex:this._entityIndex});return r._graphs=merge$1(Object.create(null),this._graphs),r._size=this._size,r.addAll(t),r}*[Symbol.iterator](){yield*this.readQuads()}}function indexMatch(n,t,r=0){const a=t[r];if(a&&!(a in n))return!1;let o=!1;for(const u in a?{[a]:n[a]}:n){const s=r===2?null:indexMatch(n[u],t,r+1);s!==!1&&(o=o||Object.create(null),o[u]=s)}return o}class DatasetCoreAndReadableStream extends browserExports.Readable{constructor(t,r,a,o,u,s){super({objectMode:!0}),Object.assign(this,{n3Store:t,subject:r,predicate:a,object:o,graph:u,options:s})}get filtered(){if(!this._filtered){const{n3Store:t,graph:r,object:a,predicate:o,subject:u}=this,s=this._filtered=new N3Store({factory:t._factory,entityIndex:this.options.entityIndex});let c,l,d;if(u&&!(c=s._termToNumericId(u))||o&&!(l=s._termToNumericId(o))||a&&!(d=s._termToNumericId(a)))return s;const f=t._getGraphs(r);for(const h in f){let v,g,b,_;(_=f[h])&&(!c&&l?(g=indexMatch(_.predicates,[l,d,c]))&&(v=indexMatch(_.subjects,[c,l,d]),b=indexMatch(_.objects,[d,c,l])):d?(b=indexMatch(_.objects,[d,c,l]))&&(v=indexMatch(_.subjects,[c,l,d]),g=indexMatch(_.predicates,[l,d,c])):(v=indexMatch(_.subjects,[c,l,d]))&&(g=indexMatch(_.predicates,[l,d,c]),b=indexMatch(_.objects,[d,c,l])),v&&(s._graphs[h]={subjects:v,predicates:g,objects:b}))}s._size=null}return this._filtered}get size(){return this.filtered.size}_read(t){t>0&&!this[ITERATOR]&&(this[ITERATOR]=this[Symbol.iterator]());const r=this[ITERATOR];for(;--t>=0;){const{done:a,value:o}=r.next();if(a){this.push(null);return}this.push(o)}}addAll(t){return this.filtered.addAll(t)}contains(t){return this.filtered.contains(t)}deleteMatches(t,r,a,o){return this.filtered.deleteMatches(t,r,a,o)}difference(t){return this.filtered.difference(t)}equals(t){return this.filtered.equals(t)}every(t,r,a,o,u){return this.filtered.every(t,r,a,o,u)}filter(t){return this.filtered.filter(t)}forEach(t,r,a,o,u){return this.filtered.forEach(t,r,a,o,u)}import(t){return this.filtered.import(t)}intersection(t){return this.filtered.intersection(t)}map(t){return this.filtered.map(t)}some(t,r,a,o,u){return this.filtered.some(t,r,a,o,u)}toCanonical(){return this.filtered.toCanonical()}toStream(){return this._filtered?this._filtered.toStream():this.n3Store.match(this.subject,this.predicate,this.object,this.graph)}union(t){return this._filtered?this._filtered.union(t):this.n3Store.match(this.subject,this.predicate,this.object,this.graph).addAll(t)}toArray(){return this._filtered?this._filtered.toArray():this.n3Store.getQuads(this.subject,this.predicate,this.object,this.graph)}reduce(t,r){return this.filtered.reduce(t,r)}toString(){return new N3Writer().quadsToString(this)}add(t){return this.filtered.add(t)}delete(t){return this.filtered.delete(t)}has(t){return this.filtered.has(t)}match(t,r,a,o){return new DatasetCoreAndReadableStream(this.filtered,t,r,a,o,this.options)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class N3DatasetCoreFactory{dataset(t){return new N3Store(t)}}function getRulesFromDataset(n){const t=[];for(const{subject:r,object:a}of n.match(null,DataFactory$1.namedNode("http://www.w3.org/2000/10/swap/log#implies"),null,DataFactory$1.defaultGraph())){const o=[...n.match(null,null,null,r)],u=[...n.match(null,null,null,a)];t.push({premise:o,conclusion:u})}return t}class N3Reasoner{constructor(t){this._store=t}_add(t,r,a,o,u){this._store._addToIndex(o.subjects,t,r,a)&&(this._store._addToIndex(o.predicates,r,a,t),this._store._addToIndex(o.objects,a,t,r),u())}_evaluatePremise(t,r,a,o=0){let u,s,c,l,d;const[f,h,v]=t.premise[o].value,g=r[t.premise[o].content],b=!(c=f.value);for(c in b?g:{[c]:g[c]})if(l=g[c]){b&&(f.value=Number(c)),u=!(c=h.value);for(c in u?l:{[c]:l[c]})if(d=l[c]){u&&(h.value=Number(c)),s=!(c=v.value);for(c in s?d:{[c]:d[c]})s&&(v.value=Number(c)),o===t.premise.length-1?t.conclusion.forEach(_=>{this._add(_.subject.value,_.predicate.value,_.object.value,r,()=>{a(_)})}):this._evaluatePremise(t,r,a,o+1);s&&(v.value=null)}u&&(h.value=null)}b&&(f.value=null)}_evaluateRules(t,r,a){for(let o=0;o<t.length;o++)this._evaluatePremise(t[o],r,a)}_reasonGraphNaive(t,r){const a=[];function o(c){c.next&&c.next.forEach(l=>{a.push([c.subject.value,c.predicate.value,c.object.value,l])})}const u=c=>{c.forEach(l=>{this._add(l.subject.value,l.predicate.value,l.object.value,r,()=>{o(l)})})};this._evaluateRules(t,r,o);let s;for(;(s=a.pop())!==void 0;){const[c,l,d,f]=s,h=f.basePremise.subject.value;h||(f.basePremise.subject.value=c);const v=f.basePremise.predicate.value;v||(f.basePremise.predicate.value=l);const g=f.basePremise.object.value;g||(f.basePremise.object.value=d),f.premise.length===0?u(f.conclusion):this._evaluatePremise(f,r,o),h||(f.basePremise.subject.value=null),v||(f.basePremise.predicate.value=null),g||(f.basePremise.object.value=null)}}_createRule({premise:t,conclusion:r}){const a={},o=s=>s.termType==="Variable"?a[s.value]=a[s.value]||{}:{value:this._store._termToNewNumericId(s)},u=s=>({subject:o(s.subject),predicate:o(s.predicate),object:o(s.object)});return{premise:t.map(s=>u(s)),conclusion:r.map(s=>u(s)),variables:Object.values(a)}}reason(t){Array.isArray(t)||(t=getRulesFromDataset(t)),t=t.map(a=>this._createRule(a));for(const a of t)for(const o of t)for(let u=0;u<o.premise.length;u++){const s=o.premise[u];for(const c of a.conclusion){if(termEq(s.subject,c.subject)&&termEq(s.predicate,c.predicate)&&termEq(s.object,c.object)){const l=new Set,d=[];s.subject.value=s.subject.value||1,s.object.value=s.object.value||1,s.predicate.value=s.predicate.value||1;for(let f=0;f<o.premise.length;f++)f!==u&&d.push(getIndex(o.premise[f],l));(c.next=c.next||[]).push({premise:d,conclusion:o.conclusion,basePremise:s})}o.variables.forEach(l=>{l.value=null})}}for(const a of t){const o=new Set;a.premise=a.premise.map(u=>getIndex(u,o))}const r=this._store._getGraphs();for(const a in r)this._reasonGraphNaive(t,r[a]);this._store._size=null}}function getIndex({subject:n,predicate:t,object:r},a){const o=n.value||a.has(n)||(a.add(n),!1),u=t.value||a.has(t)||(a.add(t),!1),s=r.value||a.has(r)||(a.add(r),!1);return!o&&u?{content:"predicates",value:[t,r,n]}:s?{content:"objects",value:[r,n,t]}:{content:"subjects",value:[n,t,r]}}function termEq(n,t){return n.value===null&&(n.value=t.value),n.value===t.value}class N3StreamParser extends browserExports.Transform{constructor(t){super({decodeStrings:!0}),this._readableState.objectMode=!0;const r=new N3Parser(t);let a,o;const u={onQuad:(s,c)=>{s&&this.emit("error",s)||c&&this.push(c)},onPrefix:(s,c)=>{this.emit("prefix",s,c)}};t&&t.comments&&(u.onComment=s=>{this.emit("comment",s)}),r.parse({on:(s,c)=>{switch(s){case"data":a=c;break;case"end":o=c;break}}},u),this._transform=(s,c,l)=>{a(s),l()},this._flush=s=>{o(),s()}}import(t){return t.on("data",r=>{this.write(r)}),t.on("end",()=>{this.end()}),t.on("error",r=>{this.emit("error",r)}),this}}class N3StreamWriter extends browserExports.Transform{constructor(t){super({encoding:"utf8",writableObjectMode:!0});const r=this._writer=new N3Writer({write:(a,o,u)=>{this.push(a),u&&u()},end:a=>{this.push(null),a&&a()}},t);this._transform=(a,o,u)=>{r.addQuad(a,u)},this._flush=a=>{r.end(a)}}import(t){return t.on("data",r=>{this.write(r)}),t.on("end",()=>{this.end()}),t.on("error",r=>{this.emit("error",r)}),t.on("prefix",(r,a)=>{this._writer.addPrefix(r,a)}),this}}const N3={Lexer:N3Lexer,Parser:N3Parser,Writer:N3Writer,Store:N3Store,StoreFactory:N3DatasetCoreFactory,EntityIndex:N3EntityIndex,StreamParser:N3StreamParser,StreamWriter:N3StreamWriter,Util:Util$7,Reasoner:N3Reasoner,DataFactory:DataFactory$1,Term,NamedNode,Literal,BlankNode,Variable,DefaultGraph,Quad,Triple:Quad,termFromId,termToId},src=Object.freeze(Object.defineProperty({__proto__:null,BlankNode,DataFactory:DataFactory$1,DefaultGraph,EntityIndex:N3EntityIndex,Lexer:N3Lexer,Literal,NamedNode,Parser:N3Parser,Quad,Reasoner:N3Reasoner,Store:N3Store,StoreFactory:N3DatasetCoreFactory,StreamParser:N3StreamParser,StreamWriter:N3StreamWriter,Term,Triple:Quad,Util:Util$7,Variable,Writer:N3Writer,default:N3,getRulesFromDataset,termFromId,termToId},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(src);var hasRequiredActorRdfParseN3;function requireActorRdfParseN3(){if(hasRequiredActorRdfParseN3)return ActorRdfParseN3;hasRequiredActorRdfParseN3=1,Object.defineProperty(ActorRdfParseN3,"__esModule",{value:!0}),ActorRdfParseN3.ActorRdfParseN3=void 0;const n=requireLib$3s(),t=requireLib$4q(),r=require$$0;let a=class extends n.ActorRdfParseFixedMediaTypes{constructor(u){super(u)}async runHandle(u,s,c){var f;const l=u.context.getSafe(t.KeysInitQuery.dataFactory);u.data.on("error",h=>d.emit("error",h));const d=u.data.pipe(new r.StreamParser({factory:l,baseIRI:(f=u.metadata)==null?void 0:f.baseIRI,format:s.endsWith("n3")?s:`${s}*`}));return{data:d,metadata:{triples:s==="text/turtle"||s==="application/n-triples"||s==="text/n3"}}}};return ActorRdfParseN3.ActorRdfParseN3=a,ActorRdfParseN3}var hasRequiredLib$3r;function requireLib$3r(){return hasRequiredLib$3r||(hasRequiredLib$3r=1,function(n){var t=lib$3s&&lib$3s.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3s&&lib$3s.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseN3(),n)}(lib$3s)),lib$3s}var lib$3q={},ActorRdfParseRdfXml={},rdfxmlStreamingParser={},RdfXmlParser={},saxes={},ed5={},hasRequiredEd5;function requireEd5(){return hasRequiredEd5||(hasRequiredEd5=1,function(n){/**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR=`	
\r ---`,n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");var t=9,r=10,a=13,o=32;n.S_LIST=[o,r,a,t];function u(d){return d>=o&&d<=55295||d===r||d===a||d===t||d>=57344&&d<=65533||d>=65536&&d<=1114111}n.isChar=u;function s(d){return d===o||d===r||d===a||d===t}n.isS=s;function c(d){return d>=65&&d<=90||d>=97&&d<=122||d===58||d===95||d===8204||d===8205||d>=192&&d<=214||d>=216&&d<=246||d>=248&&d<=767||d>=880&&d<=893||d>=895&&d<=8191||d>=8304&&d<=8591||d>=11264&&d<=12271||d>=12289&&d<=55295||d>=63744&&d<=64975||d>=65008&&d<=65533||d>=65536&&d<=983039}n.isNameStartChar=c;function l(d){return c(d)||d>=48&&d<=57||d===45||d===46||d===183||d>=768&&d<=879||d>=8255&&d<=8256}n.isNameChar=l}(ed5)),ed5}var ed2={},hasRequiredEd2;function requireEd2(){return hasRequiredEd2||(hasRequiredEd2=1,function(n){/**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR="---",n.RESTRICTED_CHAR="-\b\v\f---",n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.RESTRICTED_CHAR_RE=new RegExp("^["+n.RESTRICTED_CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");var t=9,r=10,a=13,o=32;n.S_LIST=[o,r,a,t];function u(h){return h>=1&&h<=55295||h>=57344&&h<=65533||h>=65536&&h<=1114111}n.isChar=u;function s(h){return h>=1&&h<=8||h===11||h===12||h>=14&&h<=31||h>=127&&h<=132||h>=134&&h<=159}n.isRestrictedChar=s;function c(h){return h===9||h===10||h===13||h>31&&h<127||h===133||h>159&&h<=55295||h>=57344&&h<=65533||h>=65536&&h<=1114111}n.isCharAndNotRestricted=c;function l(h){return h===o||h===r||h===a||h===t}n.isS=l;function d(h){return h>=65&&h<=90||h>=97&&h<=122||h===58||h===95||h===8204||h===8205||h>=192&&h<=214||h>=216&&h<=246||h>=248&&h<=767||h>=880&&h<=893||h>=895&&h<=8191||h>=8304&&h<=8591||h>=11264&&h<=12271||h>=12289&&h<=55295||h>=63744&&h<=64975||h>=65008&&h<=65533||h>=65536&&h<=983039}n.isNameStartChar=d;function f(h){return d(h)||h>=48&&h<=57||h===45||h===46||h===183||h>=768&&h<=879||h>=8255&&h<=8256}n.isNameChar=f}(ed2)),ed2}var ed3={},hasRequiredEd3;function requireEd3(){return hasRequiredEd3||(hasRequiredEd3=1,function(n){/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(n,"__esModule",{value:!0}),n.NC_NAME_START_CHAR="A-Z_a-z------------",n.NC_NAME_CHAR="-"+n.NC_NAME_START_CHAR+".0-9--",n.NC_NAME_START_CHAR_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]$","u"),n.NC_NAME_CHAR_RE=new RegExp("^["+n.NC_NAME_CHAR+"]$","u"),n.NC_NAME_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]["+n.NC_NAME_CHAR+"]*$","u");function t(a){return a>=65&&a<=90||a===95||a>=97&&a<=122||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8204&&a<=8205||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}n.isNCNameStartChar=t;function r(a){return t(a)||a===45||a===46||a>=48&&a<=57||a===183||a>=768&&a<=879||a>=8255&&a<=8256}n.isNCNameChar=r}(ed3)),ed3}var hasRequiredSaxes;function requireSaxes(){if(hasRequiredSaxes)return saxes;hasRequiredSaxes=1,Object.defineProperty(saxes,"__esModule",{value:!0}),saxes.SaxesParser=saxes.EVENTS=void 0;const n=requireEd5(),t=requireEd2(),r=requireEd3();var a=n.isS,o=n.isChar,u=n.isNameStartChar,s=n.isNameChar,c=n.S_LIST,l=n.NAME_RE,d=t.isChar,f=r.isNCNameStartChar,h=r.isNCNameChar,v=r.NC_NAME_RE;const g="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",_={__proto__:null,xml:g,xmlns:b},S={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},T=-1,w=-2,A=0,R=1,E=2,I=3,L=4,F=5,D=6,$=7,O=8,P=9,C=10,q=11,M=12,N=13,G=14,X=15,Y=16,W=17,te=18,ue=19,fe=20,re=21,ye=22,Te=23,Re=24,ve=25,ce=26,J=27,j=28,z=29,B=30,U=31,Z=32,oe=33,ie=34,se=35,ne=36,he=37,xe=38,me=39,Ie=40,Pe=41,Ce=42,pe=43,H=44,V=9,Q=10,ee=13,ae=32,be=33,le=34,we=38,De=39,Fe=45,Ne=47,de=59,Le=60,$e=61,je=62,Me=63,ze=91,Je=93,Ke=133,ot=8232,_e=Ze=>Ze===le||Ze===De,Ae=[le,De],Ve=[...Ae,ze,je],Ue=[...Ae,Le,Je],We=[$e,Me,...c],pt=[...c,je,we,Le];function Ge(Ze,Ee,qe){switch(Ee){case"xml":qe!==g&&Ze.fail(`xml prefix must be bound to ${g}.`);break;case"xmlns":qe!==b&&Ze.fail(`xmlns prefix must be bound to ${b}.`);break}switch(qe){case b:Ze.fail(Ee===""?`the default namespace may not be set to ${qe}.`:`may not assign a prefix (even "xmlns") to the URI ${b}.`);break;case g:switch(Ee){case"xml":break;case"":Ze.fail(`the default namespace may not be set to ${qe}.`);break;default:Ze.fail("may not assign the xml namespace to another prefix.")}break}}function ct(Ze,Ee){for(const qe of Object.keys(Ee))Ge(Ze,qe,Ee[qe])}const Xe=Ze=>v.test(Ze),Ye=Ze=>l.test(Ze),nt=0,gt=1,ut=2;saxes.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const tt={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class Ct{get closed(){return this._closed}constructor(Ee){this.opt=Ee??{},this.fragmentOpt=!!this.opt.fragment;const qe=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,qe){this.nameStartCheck=f,this.nameCheck=h,this.isName=Xe,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},_);const Be=this.opt.additionalNamespaces;Be!=null&&(ct(this,Be),Object.assign(this.ns,Be))}else this.nameStartCheck=u,this.nameCheck=s,this.isName=Ye,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}_init(){var Ee;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=nt,this.attribList=[];const{fragmentOpt:qe}=this;this.state=qe?N:A,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=qe,this.xmlDeclPossible=!qe,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:Be}=this.opt;if(Be===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");Be="1.0"}this.setXMLVersion(Be),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(S),(Ee=this.readyHandler)===null||Ee===void 0||Ee.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(Ee,qe){this[tt[Ee]]=qe}off(Ee){this[tt[Ee]]=void 0}makeError(Ee){var qe;let Be=(qe=this.fileName)!==null&&qe!==void 0?qe:"";return this.trackPosition&&(Be.length>0&&(Be+=":"),Be+=`${this.line}:${this.column}`),Be.length>0&&(Be+=": "),new Error(Be+Ee)}fail(Ee){const qe=this.makeError(Ee),Be=this.errorHandler;if(Be===void 0)throw qe;return Be(qe),this}write(Ee){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let qe=!1;Ee===null?(qe=!0,Ee=""):typeof Ee=="object"&&(Ee=Ee.toString()),this.carriedFromPrevious!==void 0&&(Ee=`${this.carriedFromPrevious}${Ee}`,this.carriedFromPrevious=void 0);let Be=Ee.length;const it=Ee.charCodeAt(Be-1);!qe&&(it===ee||it>=55296&&it<=56319)&&(this.carriedFromPrevious=Ee[Be-1],Be--,Ee=Ee.slice(0,Be));const{stateTable:at}=this;for(this.chunk=Ee,this.i=0;this.i<Be;)at[this.state].call(this);return this.chunkPosition+=Be,qe?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:Ee,i:qe}=this;if(this.prevI=qe,this.i=qe+1,qe>=Ee.length)return T;const Be=Ee.charCodeAt(qe);if(this.column++,Be<55296){if(Be>=ae||Be===V)return Be;switch(Be){case Q:return this.line++,this.column=0,this.positionAtNewLine=this.position,Q;case ee:return Ee.charCodeAt(qe+1)===Q&&(this.i=qe+2),this.line++,this.column=0,this.positionAtNewLine=this.position,w;default:return this.fail("disallowed character."),Be}}if(Be>56319)return Be>=57344&&Be<=65533||this.fail("disallowed character."),Be;const it=65536+(Be-55296)*1024+(Ee.charCodeAt(qe+1)-56320);return this.i=qe+2,it>1114111&&this.fail("disallowed character."),it}getCode11(){const{chunk:Ee,i:qe}=this;if(this.prevI=qe,this.i=qe+1,qe>=Ee.length)return T;const Be=Ee.charCodeAt(qe);if(this.column++,Be<55296){if(Be>31&&Be<127||Be>159&&Be!==ot||Be===V)return Be;switch(Be){case Q:return this.line++,this.column=0,this.positionAtNewLine=this.position,Q;case ee:{const at=Ee.charCodeAt(qe+1);(at===Q||at===Ke)&&(this.i=qe+2)}case Ke:case ot:return this.line++,this.column=0,this.positionAtNewLine=this.position,w;default:return this.fail("disallowed character."),Be}}if(Be>56319)return Be>=57344&&Be<=65533||this.fail("disallowed character."),Be;const it=65536+(Be-55296)*1024+(Ee.charCodeAt(qe+1)-56320);return this.i=qe+2,it>1114111&&this.fail("disallowed character."),it}getCodeNorm(){const Ee=this.getCode();return Ee===w?Q:Ee}unget(){this.i=this.prevI,this.column--}captureTo(Ee){let{i:qe}=this;const{chunk:Be}=this;for(;;){const it=this.getCode(),at=it===w,vt=at?Q:it;if(vt===T||Ee.includes(vt))return this.text+=Be.slice(qe,this.prevI),vt;at&&(this.text+=`${Be.slice(qe,this.prevI)}
`,qe=this.i)}}captureToChar(Ee){let{i:qe}=this;const{chunk:Be}=this;for(;;){let it=this.getCode();switch(it){case w:this.text+=`${Be.slice(qe,this.prevI)}
`,qe=this.i,it=Q;break;case T:return this.text+=Be.slice(qe),!1}if(it===Ee)return this.text+=Be.slice(qe,this.prevI),!0}}captureNameChars(){const{chunk:Ee,i:qe}=this;for(;;){const Be=this.getCode();if(Be===T)return this.name+=Ee.slice(qe),T;if(!s(Be))return this.name+=Ee.slice(qe,this.prevI),Be===w?Q:Be}}skipSpaces(){for(;;){const Ee=this.getCodeNorm();if(Ee===T||!a(Ee))return Ee}}setXMLVersion(Ee){this.currentXMLVersion=Ee,Ee==="1.0"?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=R}sBeginWhitespace(){const Ee=this.i,qe=this.skipSpaces();switch(this.prevI!==Ee&&(this.xmlDeclPossible=!1),qe){case Le:if(this.state=X,this.text.length!==0)throw new Error("no-empty text at start");break;case T:break;default:this.unget(),this.state=N,this.xmlDeclPossible=!1}}sDoctype(){var Ee;const qe=this.captureTo(Ve);switch(qe){case je:{(Ee=this.doctypeHandler)===null||Ee===void 0||Ee.call(this,this.text),this.text="",this.state=N,this.doctype=!0;break}case T:break;default:this.text+=String.fromCodePoint(qe),qe===ze?this.state=L:_e(qe)&&(this.state=I,this.q=qe)}}sDoctypeQuote(){const Ee=this.q;this.captureToChar(Ee)&&(this.text+=String.fromCodePoint(Ee),this.q=null,this.state=E)}sDTD(){const Ee=this.captureTo(Ue);Ee!==T&&(this.text+=String.fromCodePoint(Ee),Ee===Je?this.state=E:Ee===Le?this.state=D:_e(Ee)&&(this.state=F,this.q=Ee))}sDTDQuoted(){const Ee=this.q;this.captureToChar(Ee)&&(this.text+=String.fromCodePoint(Ee),this.state=L,this.q=null)}sDTDOpenWaka(){const Ee=this.getCodeNorm();switch(this.text+=String.fromCodePoint(Ee),Ee){case be:this.state=$,this.openWakaBang="";break;case Me:this.state=q;break;default:this.state=L}}sDTDOpenWakaBang(){const Ee=String.fromCodePoint(this.getCodeNorm()),qe=this.openWakaBang+=Ee;this.text+=Ee,qe!=="-"&&(this.state=qe==="--"?O:L,this.openWakaBang="")}sDTDComment(){this.captureToChar(Fe)&&(this.text+="-",this.state=P)}sDTDCommentEnding(){const Ee=this.getCodeNorm();this.text+=String.fromCodePoint(Ee),this.state=Ee===Fe?C:O}sDTDCommentEnded(){const Ee=this.getCodeNorm();this.text+=String.fromCodePoint(Ee),Ee===je?this.state=L:(this.fail("malformed comment."),this.state=O)}sDTDPI(){this.captureToChar(Me)&&(this.text+="?",this.state=M)}sDTDPIEnding(){const Ee=this.getCodeNorm();this.text+=String.fromCodePoint(Ee),Ee===je&&(this.state=L)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:Ee}=this;const{chunk:qe}=this;e:for(;;)switch(this.getCode()){case w:this.entity+=`${qe.slice(Ee,this.prevI)}
`,Ee=this.i;break;case de:{const{entityReturnState:Be}=this,it=this.entity+qe.slice(Ee,this.prevI);this.state=Be;let at;it===""?(this.fail("empty entity name."),at="&;"):(at=this.parseEntity(it),this.entity=""),(Be!==N||this.textHandler!==void 0)&&(this.text+=at);break e}case T:this.entity+=qe.slice(Ee);break e}}sOpenWaka(){const Ee=this.getCode();if(u(Ee))this.state=ie,this.unget(),this.xmlDeclPossible=!1;else switch(Ee){case Ne:this.state=pe,this.xmlDeclPossible=!1;break;case be:this.state=Y,this.openWakaBang="",this.xmlDeclPossible=!1;break;case Me:this.state=Te;break;default:this.fail("disallowed character in tag name"),this.state=N,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=fe,this.openWakaBang="";break;case"--":this.state=W,this.openWakaBang="";break;case"DOCTYPE":this.state=E,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(Fe)&&(this.state=te)}sCommentEnding(){var Ee;const qe=this.getCodeNorm();qe===Fe?(this.state=ue,(Ee=this.commentHandler)===null||Ee===void 0||Ee.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(qe)}`,this.state=W)}sCommentEnded(){const Ee=this.getCodeNorm();Ee!==je?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(Ee)}`,this.state=W):this.state=N}sCData(){this.captureToChar(Je)&&(this.state=re)}sCDataEnding(){const Ee=this.getCodeNorm();Ee===Je?this.state=ye:(this.text+=`]${String.fromCodePoint(Ee)}`,this.state=fe)}sCDataEnding2(){var Ee;const qe=this.getCodeNorm();switch(qe){case je:{(Ee=this.cdataHandler)===null||Ee===void 0||Ee.call(this,this.text),this.text="",this.state=N;break}case Je:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(qe)}`,this.state=fe}}sPIFirstChar(){const Ee=this.getCodeNorm();this.nameStartCheck(Ee)?(this.piTarget+=String.fromCodePoint(Ee),this.state=Re):Ee===Me||a(Ee)?(this.fail("processing instruction without a target."),this.state=Ee===Me?ce:ve):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(Ee),this.state=Re)}sPIRest(){const{chunk:Ee,i:qe}=this;for(;;){const Be=this.getCodeNorm();if(Be===T){this.piTarget+=Ee.slice(qe);return}if(!this.nameCheck(Be)){this.piTarget+=Ee.slice(qe,this.prevI);const it=Be===Me;it||a(Be)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=it?oe:J):this.state=it?ce:ve:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(Be));break}}}sPIBody(){if(this.text.length===0){const Ee=this.getCodeNorm();Ee===Me?this.state=ce:a(Ee)||(this.text=String.fromCodePoint(Ee))}else this.captureToChar(Me)&&(this.state=ce)}sPIEnding(){var Ee;const qe=this.getCodeNorm();if(qe===je){const{piTarget:Be}=this;Be.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(Ee=this.piHandler)===null||Ee===void 0||Ee.call(this,{target:Be,body:this.text}),this.piTarget=this.text="",this.state=N}else qe===Me?this.text+="?":(this.text+=`?${String.fromCodePoint(qe)}`,this.state=ve);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const Ee=this.skipSpaces();if(Ee===Me){this.state=oe;return}Ee!==T&&(this.state=j,this.name=String.fromCodePoint(Ee))}sXMLDeclName(){const Ee=this.captureTo(We);if(Ee===Me){this.state=oe,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(a(Ee)||Ee===$e){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=Ee===$e?B:z}}sXMLDeclEq(){const Ee=this.getCodeNorm();if(Ee===Me){this.state=oe,this.fail("XML declaration is incomplete.");return}a(Ee)||(Ee!==$e&&this.fail("value required."),this.state=B)}sXMLDeclValueStart(){const Ee=this.getCodeNorm();if(Ee===Me){this.state=oe,this.fail("XML declaration is incomplete.");return}a(Ee)||(_e(Ee)?this.q=Ee:(this.fail("value must be quoted."),this.q=ae),this.state=U)}sXMLDeclValue(){const Ee=this.captureTo([this.q,Me]);if(Ee===Me){this.state=oe,this.text="",this.fail("XML declaration is incomplete.");return}if(Ee===T)return;const qe=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const Be=qe;this.xmlDecl.version=Be,/^1\.[0-9]+$/.test(Be)?this.opt.forceXMLVersion||this.setXMLVersion(Be):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(qe)||this.fail("encoding value must match 	/^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=qe;break;case"standalone":qe!=="yes"&&qe!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=qe;break}this.name="",this.state=Z}sXMLDeclSeparator(){const Ee=this.getCodeNorm();if(Ee===Me){this.state=oe;return}a(Ee)||(this.fail("whitespace required."),this.unget()),this.state=J}sXMLDeclEnding(){var Ee;this.getCodeNorm()===je?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(Ee=this.xmldeclHandler)===null||Ee===void 0||Ee.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=N):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var Ee;const qe=this.captureNameChars();if(qe===T)return;const Be=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=Be.ns=Object.create(null)),(Ee=this.openTagStartHandler)===null||Ee===void 0||Ee.call(this,Be),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),qe){case je:this.openTag();break;case Ne:this.state=se;break;default:a(qe)||this.fail("disallowed character in tag name."),this.state=ne}}sOpenTagSlash(){this.getCode()===je?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=ne)}sAttrib(){const Ee=this.skipSpaces();Ee!==T&&(u(Ee)?(this.unget(),this.state=he):Ee===je?this.openTag():Ee===Ne?this.state=se:this.fail("disallowed character in attribute name."))}sAttribName(){const Ee=this.captureNameChars();Ee===$e?this.state=me:a(Ee)?this.state=xe:Ee===je?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):Ee!==T&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const Ee=this.skipSpaces();switch(Ee){case T:return;case $e:this.state=me;break;default:this.fail("attribute without value."),this.text="",this.name="",Ee===je?this.openTag():u(Ee)?(this.unget(),this.state=he):(this.fail("disallowed character in attribute name."),this.state=ne)}}sAttribValue(){const Ee=this.getCodeNorm();_e(Ee)?(this.q=Ee,this.state=Ie):a(Ee)||(this.fail("unquoted attribute value."),this.state=Ce,this.unget())}sAttribValueQuoted(){const{q:Ee,chunk:qe}=this;let{i:Be}=this;for(;;)switch(this.getCode()){case Ee:this.pushAttrib(this.name,this.text+qe.slice(Be,this.prevI)),this.name=this.text="",this.q=null,this.state=Pe;return;case we:this.text+=qe.slice(Be,this.prevI),this.state=G,this.entityReturnState=Ie;return;case Q:case w:case V:this.text+=`${qe.slice(Be,this.prevI)} `,Be=this.i;break;case Le:this.text+=qe.slice(Be,this.prevI),this.fail("disallowed character.");return;case T:this.text+=qe.slice(Be);return}}sAttribValueClosed(){const Ee=this.getCodeNorm();a(Ee)?this.state=ne:Ee===je?this.openTag():Ee===Ne?this.state=se:u(Ee)?(this.fail("no whitespace between attributes."),this.unget(),this.state=he):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const Ee=this.captureTo(pt);switch(Ee){case we:this.state=G,this.entityReturnState=Ce;break;case Le:this.fail("disallowed character.");break;case T:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",Ee===je?this.openTag():this.state=ne}}sCloseTag(){const Ee=this.captureNameChars();Ee===je?this.closeTag():a(Ee)?this.state=H:Ee!==T&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case je:this.closeTag();break;case T:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:Ee,forbiddenState:qe}=this;const{chunk:Be,textHandler:it}=this;e:for(;;)switch(this.getCode()){case Le:{if(this.state=X,it!==void 0){const{text:at}=this,vt=Be.slice(Ee,this.prevI);at.length!==0?(it(at+vt),this.text=""):vt.length!==0&&it(vt)}qe=nt;break e}case we:this.state=G,this.entityReturnState=N,it!==void 0&&(this.text+=Be.slice(Ee,this.prevI)),qe=nt;break e;case Je:switch(qe){case nt:qe=gt;break;case gt:qe=ut;break;case ut:break;default:throw new Error("impossible state")}break;case je:qe===ut&&this.fail('the string "]]>" is disallowed in char data.'),qe=nt;break;case w:it!==void 0&&(this.text+=`${Be.slice(Ee,this.prevI)}
`),Ee=this.i,qe=nt;break;case T:it!==void 0&&(this.text+=Be.slice(Ee));break e;default:qe=nt}this.forbiddenState=qe}handleTextOutsideRoot(){let{i:Ee}=this;const{chunk:qe,textHandler:Be}=this;let it=!1;e:for(;;){const at=this.getCode();switch(at){case Le:{if(this.state=X,Be!==void 0){const{text:vt}=this,At=qe.slice(Ee,this.prevI);vt.length!==0?(Be(vt+At),this.text=""):At.length!==0&&Be(At)}break e}case we:this.state=G,this.entityReturnState=N,Be!==void 0&&(this.text+=qe.slice(Ee,this.prevI)),it=!0;break e;case w:Be!==void 0&&(this.text+=`${qe.slice(Ee,this.prevI)}
`),Ee=this.i;break;case T:Be!==void 0&&(this.text+=qe.slice(Ee));break e;default:a(at)||(it=!0)}}it&&(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(Ee,qe){var Be;const{prefix:it,local:at}=this.qname(Ee),vt={name:Ee,prefix:it,local:at,value:qe};if(this.attribList.push(vt),(Be=this.attributeHandler)===null||Be===void 0||Be.call(this,vt),it==="xmlns"){const At=qe.trim();this.currentXMLVersion==="1.0"&&At===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[at]=At,Ge(this,at,At)}else if(Ee==="xmlns"){const At=qe.trim();this.topNS[""]=At,Ge(this,"",At)}}pushAttribPlain(Ee,qe){var Be;const it={name:Ee,value:qe};this.attribList.push(it),(Be=this.attributeHandler)===null||Be===void 0||Be.call(this,it)}end(){var Ee,qe;this.sawRoot||this.fail("document must contain a root element.");const{tags:Be}=this;for(;Be.length>0;){const at=Be.pop();this.fail(`unclosed tag: ${at.name}`)}this.state!==A&&this.state!==N&&this.fail("unexpected end.");const{text:it}=this;return it.length!==0&&((Ee=this.textHandler)===null||Ee===void 0||Ee.call(this,it),this.text=""),this._closed=!0,(qe=this.endHandler)===null||qe===void 0||qe.call(this),this._init(),this}resolve(Ee){var qe,Be;let it=this.topNS[Ee];if(it!==void 0)return it;const{tags:at}=this;for(let vt=at.length-1;vt>=0;vt--)if(it=at[vt].ns[Ee],it!==void 0)return it;return it=this.ns[Ee],it!==void 0?it:(Be=(qe=this.opt).resolvePrefix)===null||Be===void 0?void 0:Be.call(qe,Ee)}qname(Ee){const qe=Ee.indexOf(":");if(qe===-1)return{prefix:"",local:Ee};const Be=Ee.slice(qe+1),it=Ee.slice(0,qe);return(it===""||Be===""||Be.includes(":"))&&this.fail(`malformed name: ${Ee}.`),{prefix:it,local:Be}}processAttribsNS(){var Ee;const{attribList:qe}=this,Be=this.tag;{const{prefix:vt,local:At}=this.qname(Be.name);Be.prefix=vt,Be.local=At;const St=Be.uri=(Ee=this.resolve(vt))!==null&&Ee!==void 0?Ee:"";vt!==""&&(vt==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),St===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(vt)}.`),Be.uri=vt))}if(qe.length===0)return;const{attributes:it}=Be,at=new Set;for(const vt of qe){const{name:At,prefix:St,local:Xt}=vt;let jt,xt;St===""?(jt=At==="xmlns"?b:"",xt=At):(jt=this.resolve(St),jt===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(St)}.`),jt=St),xt=`{${jt}}${Xt}`),at.has(xt)&&this.fail(`duplicate attribute: ${xt}.`),at.add(xt),vt.uri=jt,it[At]=vt}this.attribList=[]}processAttribsPlain(){const{attribList:Ee}=this,qe=this.tag.attributes;for(const{name:Be,value:it}of Ee)qe[Be]!==void 0&&this.fail(`duplicate attribute: ${Be}.`),qe[Be]=it;this.attribList=[]}openTag(){var Ee;this.processAttribs();const{tags:qe}=this,Be=this.tag;Be.isSelfClosing=!1,(Ee=this.openTagHandler)===null||Ee===void 0||Ee.call(this,Be),qe.push(Be),this.state=N,this.name=""}openSelfClosingTag(){var Ee,qe,Be;this.processAttribs();const{tags:it}=this,at=this.tag;at.isSelfClosing=!0,(Ee=this.openTagHandler)===null||Ee===void 0||Ee.call(this,at),(qe=this.closeTagHandler)===null||qe===void 0||qe.call(this,at),(this.tag=(Be=it[it.length-1])!==null&&Be!==void 0?Be:null)===null&&(this.closedRoot=!0),this.state=N,this.name=""}closeTag(){const{tags:Ee,name:qe}=this;if(this.state=N,this.name="",qe===""){this.fail("weird empty close tag."),this.text+="</>";return}const Be=this.closeTagHandler;let it=Ee.length;for(;it-- >0;){const at=this.tag=Ee.pop();if(this.topNS=at.ns,Be==null||Be(at),at.name===qe)break;this.fail("unexpected close tag.")}it===0?this.closedRoot=!0:it<0&&(this.fail(`unmatched closing tag: ${qe}.`),this.text+=`</${qe}>`)}parseEntity(Ee){if(Ee[0]!=="#"){const Be=this.ENTITIES[Ee];return Be!==void 0?Be:(this.fail(this.isName(Ee)?"undefined entity.":"disallowed character in entity name."),`&${Ee};`)}let qe=NaN;return Ee[1]==="x"&&/^#x[0-9a-f]+$/i.test(Ee)?qe=parseInt(Ee.slice(2),16):/^#[0-9]+$/.test(Ee)&&(qe=parseInt(Ee.slice(1),10)),this.isChar(qe)?String.fromCodePoint(qe):(this.fail("malformed character entity."),`&${Ee};`)}}return saxes.SaxesParser=Ct,saxes}var ParseError={},hasRequiredParseError;function requireParseError(){if(hasRequiredParseError)return ParseError;hasRequiredParseError=1,Object.defineProperty(ParseError,"__esModule",{value:!0}),ParseError.ParseError=void 0;let n=class extends Error{constructor(r,a){const o=r.saxParser;super(r.trackPosition?`Line ${o.line} column ${o.column+1}: ${a}`:a)}};return ParseError.ParseError=n,ParseError}var validateIri={},Validate={},hasRequiredValidate$1;function requireValidate$1(){return hasRequiredValidate$1||(hasRequiredValidate$1=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateIri=n.IriValidationStrategy=void 0;function t(){const c="[!$&'()*+,;=]",l="%[a-fA-F0-9]{2}",d="([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",f=`${d}\\.${d}\\.${d}\\.${d}`,h="[a-fA-F0-9]{1,4}",v=`(${h}:${h}|${f})`,g=`((${h}:){6}${v}|::(${h}:){5}${v}|(${h})?::(${h}:){4}${v}|((${h}:){0,1}${h})?::(${h}:){3}${v}|((${h}:){0,2}${h})?::(${h}:){2}${v}|((${h}:){0,3}${h})?::${h}:${v}|((${h}:){0,4}${h})?::${v}|((${h}:){0,5}${h})?::${h}|((${h}:){0,6}${h})?::)`,b=`v[a-fA-F0-9]+\\.(${c}|${c}|":)+`,_=`\\[(${g}|${b})\\]`,S="[0-9]*",T="[a-zA-Z][a-zA-Z0-9+\\-.]*",A="[---]",I="[a-zA-Z0-9\\-._~-----------------]",L=`(${I}|${l}|${c}|[:@])*`,F=`(${L}|[\\/?])*`,D=`(${L}|${A}|[\\/?])*`,$=`(${L})+`,O=`(${L})*`,P="",C=`${$}(\\/${O})*`,q=`\\/(${$}(\\/${O})*)?`,M=`(\\/${O})*`,N=`(${I}|${l}|${c})*`,G=`(${_}|${f}|${N})`,W=`(\\/\\/${`(${`(${I}|${l}|${c}|:)*`}@)?${G}(:${S})?`}${M}|${q}|${C}|${P})`,te=`^${T}:${W}(\\?${D})?(#${F})?$`;return new RegExp(te,"u")}const r=t(),a=/^[A-Za-z][\d+-.A-Za-z]*:[^\u0000-\u0020"<>\\^`{|}]*$/u;var o;(function(s){s.Strict="strict",s.Pragmatic="pragmatic",s.None="none"})(o=n.IriValidationStrategy||(n.IriValidationStrategy={}));function u(s,c=o.Strict){switch(c){case o.Strict:return r.test(s)?void 0:new Error(`Invalid IRI according to RFC 3987: '${s}'`);case o.Pragmatic:return a.test(s)?void 0:new Error(`Invalid IRI according to RDF Turtle: '${s}'`);case o.None:return;default:return new Error(`Not supported validation strategy "${c}"`)}}n.validateIri=u}(Validate)),Validate}var hasRequiredValidateIri;function requireValidateIri(){return hasRequiredValidateIri||(hasRequiredValidateIri=1,function(n){var t=validateIri&&validateIri.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=validateIri&&validateIri.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireValidate$1(),n)}(validateIri)),validateIri}var hasRequiredRdfXmlParser;function requireRdfXmlParser(){if(hasRequiredRdfXmlParser)return RdfXmlParser;hasRequiredRdfXmlParser=1,Object.defineProperty(RdfXmlParser,"__esModule",{value:!0}),RdfXmlParser.ParseType=RdfXmlParser.RdfXmlParser=void 0;const n=requireRelativeToAbsoluteIri(),t=requireSaxes(),r=requireBrowser(),a=requireParseError(),o=requireRdfDataFactory(),u=requireValidateIri();let s=class Ot extends r.Transform{constructor(d){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},d&&(Object.assign(this,d),this.options=d),this.dataFactory||(this.dataFactory=new o.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.validateUri!==!1&&(this.validateUri=!0),this.iriValidationStrategy||(this.iriValidationStrategy=this.validateUri?u.IriValidationStrategy.Pragmatic:u.IriValidationStrategy.None),this.saxParser=new t.SaxesParser({xmlns:!0,position:this.trackPosition}),this.attachSaxListeners()}import(d){const f=new r.PassThrough({readableObjectMode:!0});d.on("error",v=>h.emit("error",v)),d.on("data",v=>f.push(v)),d.on("end",()=>f.push(null));const h=f.pipe(new Ot(this.options));return h}_transform(d,f,h){try{this.saxParser.write(d)}catch(v){return h(v)}h()}newParseError(d){return new a.ParseError(this,d)}valueToUri(d,f){return this.uriToNamedNode((0,n.resolve)(d,f.baseIRI))}uriToNamedNode(d){const f=(0,u.validateIri)(d,this.iriValidationStrategy);if(f instanceof Error)throw this.newParseError(f.message);return this.dataFactory.namedNode(d)}validateNcname(d){if(!Ot.NCNAME_MATCHER.test(d))throw this.newParseError(`Not a valid NCName: ${d}`)}attachSaxListeners(){this.saxParser.on("error",d=>this.emit("error",d)),this.saxParser.on("opentag",this.onTag.bind(this)),this.saxParser.on("text",this.onText.bind(this)),this.saxParser.on("cdata",this.onText.bind(this)),this.saxParser.on("closetag",this.onCloseTag.bind(this)),this.saxParser.on("doctype",this.onDoctype.bind(this))}onTag(d){const f=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let h=c.RESOURCE;if(f&&(f.hadChildren=!0,h=f.childrenParseType),f&&f.childrenStringTags){const g=d.name;let b="";for(const w in d.attributes)b+=` ${w}="${d.attributes[w].value}"`;const S=`<${`${g}${b}`}>`;f.childrenStringTags.push(S);const T={childrenStringTags:f.childrenStringTags};T.childrenStringEmitClosingTag=`</${g}>`,this.activeTagStack.push(T);return}const v={};f?(v.language=f.language,v.baseIRI=f.baseIRI):v.baseIRI=this.baseIRI,this.activeTagStack.push(v),h===c.RESOURCE?this.onTagResource(d,v,f,!f):this.onTagProperty(d,v,f)}onTagResource(d,f,h,v){f.childrenParseType=c.PROPERTY;let g=!0;if(d.uri===Ot.RDF){if(!v&&Ot.FORBIDDEN_NODE_ELEMENTS.indexOf(d.local)>=0)throw this.newParseError(`Illegal node element name: ${d.local}`);switch(d.local){case"RDF":f.childrenParseType=c.RESOURCE;case"Description":g=!1}}const b=[],_=[];let S=null,T=!1,w=!1,A=null;for(const R in d.attributes){const E=d.attributes[R];if(h&&E.uri===Ot.RDF)switch(E.local){case"about":if(S)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${E.value} and ${S} where found.`);S=E.value;continue;case"ID":if(S)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${E.value} and ${S} where found.`);this.validateNcname(E.value),S="#"+E.value,T=!0;continue;case"nodeID":if(S)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${E.value} and ${S} where found.`);this.validateNcname(E.value),S=E.value,w=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":A=E.value;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(E.uri===Ot.XML){if(E.local==="lang"){f.language=E.value===""?null:E.value.toLowerCase();continue}else if(E.local==="base"){f.baseIRI=(0,n.resolve)(E.value,f.baseIRI);continue}}E.prefix!=="xml"&&E.prefix!=="xmlns"&&(E.prefix!==""||E.local!=="xmlns")&&E.uri&&(b.push(this.uriToNamedNode(E.uri+E.local)),_.push(E.value))}if(S!==null&&(f.subject=w?this.dataFactory.blankNode(S):this.valueToUri(S,f),T&&this.claimNodeId(f.subject)),f.subject||(f.subject=this.dataFactory.blankNode()),g){const R=this.uriToNamedNode(d.uri+d.local);this.emitTriple(f.subject,this.dataFactory.namedNode(Ot.RDF+"type"),R,h?h.reifiedStatementId:null)}if(h){if(h.predicate)if(h.childrenCollectionSubject){const R=this.dataFactory.blankNode();this.emitTriple(h.childrenCollectionSubject,h.childrenCollectionPredicate,R,h.reifiedStatementId),this.emitTriple(R,this.dataFactory.namedNode(Ot.RDF+"first"),f.subject,f.reifiedStatementId),h.childrenCollectionSubject=R,h.childrenCollectionPredicate=this.dataFactory.namedNode(Ot.RDF+"rest")}else{this.emitTriple(h.subject,h.predicate,f.subject,h.reifiedStatementId);for(let R=0;R<h.predicateSubPredicates.length;R++)this.emitTriple(f.subject,h.predicateSubPredicates[R],h.predicateSubObjects[R],null);h.predicateSubPredicates=[],h.predicateSubObjects=[],h.predicateEmitted=!0}for(let R=0;R<b.length;R++){const E=this.dataFactory.literal(_[R],f.datatype||f.language);this.emitTriple(f.subject,b[R],E,h.reifiedStatementId)}A&&this.emitTriple(f.subject,this.dataFactory.namedNode(Ot.RDF+"type"),this.uriToNamedNode(A),null)}}onTagProperty(d,f,h){if(f.childrenParseType=c.RESOURCE,f.subject=h.subject,d.uri===Ot.RDF&&d.local==="li"?(h.listItemCounter||(h.listItemCounter=1),f.predicate=this.uriToNamedNode(d.uri+"_"+h.listItemCounter++)):f.predicate=this.uriToNamedNode(d.uri+d.local),d.uri===Ot.RDF&&Ot.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(d.local)>=0)throw this.newParseError(`Illegal property element name: ${d.local}`);f.predicateSubPredicates=[],f.predicateSubObjects=[];let v=!1,g=!1,b=null,_=!0;const S=[],T=[];for(const w in d.attributes){const A=d.attributes[w];if(A.uri===Ot.RDF)switch(A.local){case"resource":if(b)throw this.newParseError(`Found both rdf:resource (${A.value}) and rdf:nodeID (${b}).`);if(v)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${A.value})`);f.hadChildren=!0,b=A.value,_=!1;continue;case"datatype":if(g)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${A.value}).`);if(v)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${A.value})`);f.datatype=this.valueToUri(A.value,f);continue;case"nodeID":if(g)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${A.value}).`);if(f.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${A.value}).`);if(v)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${A.value})`);this.validateNcname(A.value),f.hadChildren=!0,b=A.value,_=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(g)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(f.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${f.datatype.value})`);if(b)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${b})`);if(A.value==="Resource"){v=!0,f.childrenParseType=c.PROPERTY;const R=this.dataFactory.blankNode();this.emitTriple(f.subject,f.predicate,R,f.reifiedStatementId),f.subject=R,f.predicate=null}else A.value==="Collection"?(v=!0,f.hadChildren=!0,f.childrenCollectionSubject=f.subject,f.childrenCollectionPredicate=f.predicate,_=!1):A.value==="Literal"&&(v=!0,f.childrenTagsToString=!0,f.childrenStringTags=[]);continue;case"ID":this.validateNcname(A.value),f.reifiedStatementId=this.valueToUri("#"+A.value,f),this.claimNodeId(f.reifiedStatementId);continue}else if(A.uri===Ot.XML&&A.local==="lang"){f.language=A.value===""?null:A.value.toLowerCase();continue}if(A.prefix!=="xml"&&A.prefix!=="xmlns"&&(A.prefix!==""||A.local!=="xmlns")&&A.uri){if(v||f.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${A.value}`);f.hadChildren=!0,g=!0,S.push(this.uriToNamedNode(A.uri+A.local)),T.push(this.dataFactory.literal(A.value,f.datatype||f.language))}}if(b!==null){const w=f.subject;f.subject=_?this.dataFactory.blankNode(b):this.valueToUri(b,f),this.emitTriple(w,f.predicate,f.subject,f.reifiedStatementId);for(let A=0;A<S.length;A++)this.emitTriple(f.subject,S[A],T[A],null);f.predicateEmitted=!0}else _&&(f.predicateSubPredicates=S,f.predicateSubObjects=T,f.predicateEmitted=!1)}emitTriple(d,f,h,v){this.push(this.dataFactory.quad(d,f,h,this.defaultGraph)),v&&(this.push(this.dataFactory.quad(v,this.dataFactory.namedNode(Ot.RDF+"type"),this.dataFactory.namedNode(Ot.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(v,this.dataFactory.namedNode(Ot.RDF+"subject"),d,this.defaultGraph)),this.push(this.dataFactory.quad(v,this.dataFactory.namedNode(Ot.RDF+"predicate"),f,this.defaultGraph)),this.push(this.dataFactory.quad(v,this.dataFactory.namedNode(Ot.RDF+"object"),h,this.defaultGraph)))}claimNodeId(d){if(!this.allowDuplicateRdfIds){if(this.nodeIds[d.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${d.value}'.`);this.nodeIds[d.value]=!0}}onText(d){const f=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;f&&(f.childrenStringTags?f.childrenStringTags.push(d):f.predicate&&(f.text=d))}onCloseTag(){const d=this.activeTagStack.pop();if(d.childrenStringEmitClosingTag&&d.childrenStringTags.push(d.childrenStringEmitClosingTag),d.childrenTagsToString&&(d.datatype=this.dataFactory.namedNode(Ot.RDF+"XMLLiteral"),d.text=d.childrenStringTags.join(""),d.hadChildren=!1),d.childrenCollectionSubject)this.emitTriple(d.childrenCollectionSubject,d.childrenCollectionPredicate,this.dataFactory.namedNode(Ot.RDF+"nil"),d.reifiedStatementId);else if(d.predicate){if(!d.hadChildren&&d.childrenParseType!==c.PROPERTY)this.emitTriple(d.subject,d.predicate,this.dataFactory.literal(d.text||"",d.datatype||d.language),d.reifiedStatementId);else if(!d.predicateEmitted){const f=this.dataFactory.blankNode();this.emitTriple(d.subject,d.predicate,f,d.reifiedStatementId);for(let h=0;h<d.predicateSubPredicates.length;h++)this.emitTriple(f,d.predicateSubPredicates[h],d.predicateSubObjects[h],null)}}}onDoctype(d){d.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(f,h,v)=>(this.saxParser.ENTITIES[h]=v,""))}};RdfXmlParser.RdfXmlParser=s,s.MIME_TYPE="application/rdf+xml",s.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",s.XML="http://www.w3.org/XML/1998/namespace",s.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],s.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],s.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u;var c;return function(l){l[l.RESOURCE=0]="RESOURCE",l[l.PROPERTY=1]="PROPERTY"}(c||(RdfXmlParser.ParseType=c={})),RdfXmlParser}var hasRequiredRdfxmlStreamingParser;function requireRdfxmlStreamingParser(){return hasRequiredRdfxmlStreamingParser||(hasRequiredRdfxmlStreamingParser=1,function(n){var t=rdfxmlStreamingParser&&rdfxmlStreamingParser.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfxmlStreamingParser&&rdfxmlStreamingParser.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireRdfXmlParser(),n)}(rdfxmlStreamingParser)),rdfxmlStreamingParser}var hasRequiredActorRdfParseRdfXml;function requireActorRdfParseRdfXml(){if(hasRequiredActorRdfParseRdfXml)return ActorRdfParseRdfXml;hasRequiredActorRdfParseRdfXml=1,Object.defineProperty(ActorRdfParseRdfXml,"__esModule",{value:!0}),ActorRdfParseRdfXml.ActorRdfParseRdfXml=void 0;const n=requireLib$3s(),t=requireLib$4q(),r=requireRdfxmlStreamingParser();let a=class extends n.ActorRdfParseFixedMediaTypes{constructor(u){super(u)}async runHandle(u){var l;const s=u.context.getSafe(t.KeysInitQuery.dataFactory);u.data.on("error",d=>c.emit("error",d));const c=u.data.pipe(new r.RdfXmlParser({dataFactory:s,baseIRI:(l=u.metadata)==null?void 0:l.baseIRI}));return{data:c,metadata:{triples:!0}}}};return ActorRdfParseRdfXml.ActorRdfParseRdfXml=a,ActorRdfParseRdfXml}var hasRequiredLib$3q;function requireLib$3q(){return hasRequiredLib$3q||(hasRequiredLib$3q=1,function(n){var t=lib$3q&&lib$3q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3q&&lib$3q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseRdfXml(),n)}(lib$3q)),lib$3q}var lib$3p={},ActorRdfParseXmlRdfa={},rdfaStreamingParser={},IActiveTag={},hasRequiredIActiveTag;function requireIActiveTag(){return hasRequiredIActiveTag||(hasRequiredIActiveTag=1,Object.defineProperty(IActiveTag,"__esModule",{value:!0})),IActiveTag}var IHtmlParseListener$1={},hasRequiredIHtmlParseListener$1;function requireIHtmlParseListener$1(){return hasRequiredIHtmlParseListener$1||(hasRequiredIHtmlParseListener$1=1,Object.defineProperty(IHtmlParseListener$1,"__esModule",{value:!0})),IHtmlParseListener$1}var IRdfaPattern={},hasRequiredIRdfaPattern;function requireIRdfaPattern(){return hasRequiredIRdfaPattern||(hasRequiredIRdfaPattern=1,Object.defineProperty(IRdfaPattern,"__esModule",{value:!0})),IRdfaPattern}var RdfaParser={},lib$3o={},Parser$3={},Tokenizer$2={},decode$3={},decodeDataHtml$3={},hasRequiredDecodeDataHtml$3;function requireDecodeDataHtml$3(){return hasRequiredDecodeDataHtml$3||(hasRequiredDecodeDataHtml$3=1,Object.defineProperty(decodeDataHtml$3,"__esModule",{value:!0}),decodeDataHtml$3.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(n){return n.charCodeAt(0)}))),decodeDataHtml$3}var decodeDataXml$3={},hasRequiredDecodeDataXml$3;function requireDecodeDataXml$3(){return hasRequiredDecodeDataXml$3||(hasRequiredDecodeDataXml$3=1,Object.defineProperty(decodeDataXml$3,"__esModule",{value:!0}),decodeDataXml$3.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(n){return n.charCodeAt(0)}))),decodeDataXml$3}var decode_codepoint$2={},hasRequiredDecode_codepoint$2;function requireDecode_codepoint$2(){return hasRequiredDecode_codepoint$2||(hasRequiredDecode_codepoint$2=1,function(n){var t;Object.defineProperty(n,"__esModule",{value:!0}),n.replaceCodePoint=n.fromCodePoint=void 0;var r=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);n.fromCodePoint=(t=String.fromCodePoint)!==null&&t!==void 0?t:function(u){var s="";return u>65535&&(u-=65536,s+=String.fromCharCode(u>>>10&1023|55296),u=56320|u&1023),s+=String.fromCharCode(u),s};function a(u){var s;return u>=55296&&u<=57343||u>1114111?65533:(s=r.get(u))!==null&&s!==void 0?s:u}n.replaceCodePoint=a;function o(u){return(0,n.fromCodePoint)(a(u))}n.default=o}(decode_codepoint$2)),decode_codepoint$2}var hasRequiredDecode$3;function requireDecode$3(){return hasRequiredDecode$3||(hasRequiredDecode$3=1,function(n){var t=decode$3&&decode$3.__createBinding||(Object.create?function(O,P,C,q){q===void 0&&(q=C);var M=Object.getOwnPropertyDescriptor(P,C);(!M||("get"in M?!P.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return P[C]}}),Object.defineProperty(O,q,M)}:function(O,P,C,q){q===void 0&&(q=C),O[q]=P[C]}),r=decode$3&&decode$3.__setModuleDefault||(Object.create?function(O,P){Object.defineProperty(O,"default",{enumerable:!0,value:P})}:function(O,P){O.default=P}),a=decode$3&&decode$3.__importStar||function(O){if(O&&O.__esModule)return O;var P={};if(O!=null)for(var C in O)C!=="default"&&Object.prototype.hasOwnProperty.call(O,C)&&t(P,O,C);return r(P,O),P},o=decode$3&&decode$3.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXML=n.decodeHTMLStrict=n.decodeHTMLAttribute=n.decodeHTML=n.determineBranch=n.EntityDecoder=n.DecodingMode=n.BinTrieFlags=n.fromCodePoint=n.replaceCodePoint=n.decodeCodePoint=n.xmlDecodeTree=n.htmlDecodeTree=void 0;var u=o(requireDecodeDataHtml$3());n.htmlDecodeTree=u.default;var s=o(requireDecodeDataXml$3());n.xmlDecodeTree=s.default;var c=a(requireDecode_codepoint$2());n.decodeCodePoint=c.default;var l=requireDecode_codepoint$2();Object.defineProperty(n,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(n,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var d;(function(O){O[O.NUM=35]="NUM",O[O.SEMI=59]="SEMI",O[O.EQUALS=61]="EQUALS",O[O.ZERO=48]="ZERO",O[O.NINE=57]="NINE",O[O.LOWER_A=97]="LOWER_A",O[O.LOWER_F=102]="LOWER_F",O[O.LOWER_X=120]="LOWER_X",O[O.LOWER_Z=122]="LOWER_Z",O[O.UPPER_A=65]="UPPER_A",O[O.UPPER_F=70]="UPPER_F",O[O.UPPER_Z=90]="UPPER_Z"})(d||(d={}));var f=32,h;(function(O){O[O.VALUE_LENGTH=49152]="VALUE_LENGTH",O[O.BRANCH_LENGTH=16256]="BRANCH_LENGTH",O[O.JUMP_TABLE=127]="JUMP_TABLE"})(h=n.BinTrieFlags||(n.BinTrieFlags={}));function v(O){return O>=d.ZERO&&O<=d.NINE}function g(O){return O>=d.UPPER_A&&O<=d.UPPER_F||O>=d.LOWER_A&&O<=d.LOWER_F}function b(O){return O>=d.UPPER_A&&O<=d.UPPER_Z||O>=d.LOWER_A&&O<=d.LOWER_Z||v(O)}function _(O){return O===d.EQUALS||b(O)}var S;(function(O){O[O.EntityStart=0]="EntityStart",O[O.NumericStart=1]="NumericStart",O[O.NumericDecimal=2]="NumericDecimal",O[O.NumericHex=3]="NumericHex",O[O.NamedEntity=4]="NamedEntity"})(S||(S={}));var T;(function(O){O[O.Legacy=0]="Legacy",O[O.Strict=1]="Strict",O[O.Attribute=2]="Attribute"})(T=n.DecodingMode||(n.DecodingMode={}));var w=function(){function O(P,C,q){this.decodeTree=P,this.emitCodePoint=C,this.errors=q,this.state=S.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=T.Strict}return O.prototype.startEntity=function(P){this.decodeMode=P,this.state=S.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},O.prototype.write=function(P,C){switch(this.state){case S.EntityStart:return P.charCodeAt(C)===d.NUM?(this.state=S.NumericStart,this.consumed+=1,this.stateNumericStart(P,C+1)):(this.state=S.NamedEntity,this.stateNamedEntity(P,C));case S.NumericStart:return this.stateNumericStart(P,C);case S.NumericDecimal:return this.stateNumericDecimal(P,C);case S.NumericHex:return this.stateNumericHex(P,C);case S.NamedEntity:return this.stateNamedEntity(P,C)}},O.prototype.stateNumericStart=function(P,C){return C>=P.length?-1:(P.charCodeAt(C)|f)===d.LOWER_X?(this.state=S.NumericHex,this.consumed+=1,this.stateNumericHex(P,C+1)):(this.state=S.NumericDecimal,this.stateNumericDecimal(P,C))},O.prototype.addToNumericResult=function(P,C,q,M){if(C!==q){var N=q-C;this.result=this.result*Math.pow(M,N)+parseInt(P.substr(C,N),M),this.consumed+=N}},O.prototype.stateNumericHex=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M)||g(M))C+=1;else return this.addToNumericResult(P,q,C,16),this.emitNumericEntity(M,3)}return this.addToNumericResult(P,q,C,16),-1},O.prototype.stateNumericDecimal=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M))C+=1;else return this.addToNumericResult(P,q,C,10),this.emitNumericEntity(M,2)}return this.addToNumericResult(P,q,C,10),-1},O.prototype.emitNumericEntity=function(P,C){var q;if(this.consumed<=C)return(q=this.errors)===null||q===void 0||q.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(P===d.SEMI)this.consumed+=1;else if(this.decodeMode===T.Strict)return 0;return this.emitCodePoint((0,c.replaceCodePoint)(this.result),this.consumed),this.errors&&(P!==d.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},O.prototype.stateNamedEntity=function(P,C){for(var q=this.decodeTree,M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14;C<P.length;C++,this.excess++){var G=P.charCodeAt(C);if(this.treeIndex=R(q,M,this.treeIndex+Math.max(1,N),G),this.treeIndex<0)return this.result===0||this.decodeMode===T.Attribute&&(N===0||_(G))?0:this.emitNotTerminatedNamedEntity();if(M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14,N!==0){if(G===d.SEMI)return this.emitNamedEntityData(this.treeIndex,N,this.consumed+this.excess);this.decodeMode!==T.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},O.prototype.emitNotTerminatedNamedEntity=function(){var P,C=this,q=C.result,M=C.decodeTree,N=(M[q]&h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(q,N,this.consumed),(P=this.errors)===null||P===void 0||P.missingSemicolonAfterCharacterReference(),this.consumed},O.prototype.emitNamedEntityData=function(P,C,q){var M=this.decodeTree;return this.emitCodePoint(C===1?M[P]&~h.VALUE_LENGTH:M[P+1],q),C===3&&this.emitCodePoint(M[P+2],q),q},O.prototype.end=function(){var P;switch(this.state){case S.NamedEntity:return this.result!==0&&(this.decodeMode!==T.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case S.NumericDecimal:return this.emitNumericEntity(0,2);case S.NumericHex:return this.emitNumericEntity(0,3);case S.NumericStart:return(P=this.errors)===null||P===void 0||P.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case S.EntityStart:return 0}},O}();n.EntityDecoder=w;function A(O){var P="",C=new w(O,function(q){return P+=(0,c.fromCodePoint)(q)});return function(M,N){for(var G=0,X=0;(X=M.indexOf("&",X))>=0;){P+=M.slice(G,X),C.startEntity(N);var Y=C.write(M,X+1);if(Y<0){G=X+C.end();break}G=X+Y,X=Y===0?G+1:G}var W=P+M.slice(G);return P="",W}}function R(O,P,C,q){var M=(P&h.BRANCH_LENGTH)>>7,N=P&h.JUMP_TABLE;if(M===0)return N!==0&&q===N?C:-1;if(N){var G=q-N;return G<0||G>=M?-1:O[C+G]-1}for(var X=C,Y=X+M-1;X<=Y;){var W=X+Y>>>1,te=O[W];if(te<q)X=W+1;else if(te>q)Y=W-1;else return O[W+M]}return-1}n.determineBranch=R;var E=A(u.default),I=A(s.default);function L(O,P){return P===void 0&&(P=T.Legacy),E(O,P)}n.decodeHTML=L;function F(O){return E(O,T.Attribute)}n.decodeHTMLAttribute=F;function D(O){return E(O,T.Strict)}n.decodeHTMLStrict=D;function $(O){return I(O,T.Strict)}n.decodeXML=$}(decode$3)),decode$3}var hasRequiredTokenizer$2;function requireTokenizer$2(){return hasRequiredTokenizer$2||(hasRequiredTokenizer$2=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuoteType=void 0;var t=requireDecode$3(),r;(function(v){v[v.Tab=9]="Tab",v[v.NewLine=10]="NewLine",v[v.FormFeed=12]="FormFeed",v[v.CarriageReturn=13]="CarriageReturn",v[v.Space=32]="Space",v[v.ExclamationMark=33]="ExclamationMark",v[v.Number=35]="Number",v[v.Amp=38]="Amp",v[v.SingleQuote=39]="SingleQuote",v[v.DoubleQuote=34]="DoubleQuote",v[v.Dash=45]="Dash",v[v.Slash=47]="Slash",v[v.Zero=48]="Zero",v[v.Nine=57]="Nine",v[v.Semi=59]="Semi",v[v.Lt=60]="Lt",v[v.Eq=61]="Eq",v[v.Gt=62]="Gt",v[v.Questionmark=63]="Questionmark",v[v.UpperA=65]="UpperA",v[v.LowerA=97]="LowerA",v[v.UpperF=70]="UpperF",v[v.LowerF=102]="LowerF",v[v.UpperZ=90]="UpperZ",v[v.LowerZ=122]="LowerZ",v[v.LowerX=120]="LowerX",v[v.OpeningSquareBracket=91]="OpeningSquareBracket"})(r||(r={}));var a;(function(v){v[v.Text=1]="Text",v[v.BeforeTagName=2]="BeforeTagName",v[v.InTagName=3]="InTagName",v[v.InSelfClosingTag=4]="InSelfClosingTag",v[v.BeforeClosingTagName=5]="BeforeClosingTagName",v[v.InClosingTagName=6]="InClosingTagName",v[v.AfterClosingTagName=7]="AfterClosingTagName",v[v.BeforeAttributeName=8]="BeforeAttributeName",v[v.InAttributeName=9]="InAttributeName",v[v.AfterAttributeName=10]="AfterAttributeName",v[v.BeforeAttributeValue=11]="BeforeAttributeValue",v[v.InAttributeValueDq=12]="InAttributeValueDq",v[v.InAttributeValueSq=13]="InAttributeValueSq",v[v.InAttributeValueNq=14]="InAttributeValueNq",v[v.BeforeDeclaration=15]="BeforeDeclaration",v[v.InDeclaration=16]="InDeclaration",v[v.InProcessingInstruction=17]="InProcessingInstruction",v[v.BeforeComment=18]="BeforeComment",v[v.CDATASequence=19]="CDATASequence",v[v.InSpecialComment=20]="InSpecialComment",v[v.InCommentLike=21]="InCommentLike",v[v.BeforeSpecialS=22]="BeforeSpecialS",v[v.SpecialStartSequence=23]="SpecialStartSequence",v[v.InSpecialTag=24]="InSpecialTag",v[v.BeforeEntity=25]="BeforeEntity",v[v.BeforeNumericEntity=26]="BeforeNumericEntity",v[v.InNamedEntity=27]="InNamedEntity",v[v.InNumericEntity=28]="InNumericEntity",v[v.InHexEntity=29]="InHexEntity"})(a||(a={}));function o(v){return v===r.Space||v===r.NewLine||v===r.Tab||v===r.FormFeed||v===r.CarriageReturn}function u(v){return v===r.Slash||v===r.Gt||o(v)}function s(v){return v>=r.Zero&&v<=r.Nine}function c(v){return v>=r.LowerA&&v<=r.LowerZ||v>=r.UpperA&&v<=r.UpperZ}function l(v){return v>=r.UpperA&&v<=r.UpperF||v>=r.LowerA&&v<=r.LowerF}var d;(function(v){v[v.NoValue=0]="NoValue",v[v.Unquoted=1]="Unquoted",v[v.Single=2]="Single",v[v.Double=3]="Double"})(d=n.QuoteType||(n.QuoteType={}));var f={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},h=function(){function v(g,b){var _=g.xmlMode,S=_===void 0?!1:_,T=g.decodeEntities,w=T===void 0?!0:T;this.cbs=b,this.state=a.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=a.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=S,this.decodeEntities=w,this.entityTrie=S?t.xmlDecodeTree:t.htmlDecodeTree}return v.prototype.reset=function(){this.state=a.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=a.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},v.prototype.write=function(g){this.offset+=this.buffer.length,this.buffer=g,this.parse()},v.prototype.end=function(){this.running&&this.finish()},v.prototype.pause=function(){this.running=!1},v.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},v.prototype.getIndex=function(){return this.index},v.prototype.getSectionStart=function(){return this.sectionStart},v.prototype.stateText=function(g){g===r.Lt||!this.decodeEntities&&this.fastForwardTo(r.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=a.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&g===r.Amp&&(this.state=a.BeforeEntity)},v.prototype.stateSpecialStartSequence=function(g){var b=this.sequenceIndex===this.currentSequence.length,_=b?u(g):(g|32)===this.currentSequence[this.sequenceIndex];if(!_)this.isSpecial=!1;else if(!b){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=a.InTagName,this.stateInTagName(g)},v.prototype.stateInSpecialTag=function(g){if(this.sequenceIndex===this.currentSequence.length){if(g===r.Gt||o(g)){var b=this.index-this.currentSequence.length;if(this.sectionStart<b){var _=this.index;this.index=b,this.cbs.ontext(this.sectionStart,b),this.index=_}this.isSpecial=!1,this.sectionStart=b+2,this.stateInClosingTagName(g);return}this.sequenceIndex=0}(g|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===f.TitleEnd?this.decodeEntities&&g===r.Amp&&(this.state=a.BeforeEntity):this.fastForwardTo(r.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(g===r.Lt)},v.prototype.stateCDATASequence=function(g){g===f.Cdata[this.sequenceIndex]?++this.sequenceIndex===f.Cdata.length&&(this.state=a.InCommentLike,this.currentSequence=f.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=a.InDeclaration,this.stateInDeclaration(g))},v.prototype.fastForwardTo=function(g){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===g)return!0;return this.index=this.buffer.length+this.offset-1,!1},v.prototype.stateInCommentLike=function(g){g===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===f.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=a.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):g!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},v.prototype.isTagStartChar=function(g){return this.xmlMode?!u(g):c(g)},v.prototype.startSpecial=function(g,b){this.isSpecial=!0,this.currentSequence=g,this.sequenceIndex=b,this.state=a.SpecialStartSequence},v.prototype.stateBeforeTagName=function(g){if(g===r.ExclamationMark)this.state=a.BeforeDeclaration,this.sectionStart=this.index+1;else if(g===r.Questionmark)this.state=a.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(g)){var b=g|32;this.sectionStart=this.index,!this.xmlMode&&b===f.TitleEnd[2]?this.startSpecial(f.TitleEnd,3):this.state=!this.xmlMode&&b===f.ScriptEnd[2]?a.BeforeSpecialS:a.InTagName}else g===r.Slash?this.state=a.BeforeClosingTagName:(this.state=a.Text,this.stateText(g))},v.prototype.stateInTagName=function(g){u(g)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g))},v.prototype.stateBeforeClosingTagName=function(g){o(g)||(g===r.Gt?this.state=a.Text:(this.state=this.isTagStartChar(g)?a.InClosingTagName:a.InSpecialComment,this.sectionStart=this.index))},v.prototype.stateInClosingTagName=function(g){(g===r.Gt||o(g))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.AfterClosingTagName,this.stateAfterClosingTagName(g))},v.prototype.stateAfterClosingTagName=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.state=a.Text,this.baseState=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeAttributeName=function(g){g===r.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=a.InSpecialTag,this.sequenceIndex=0):this.state=a.Text,this.baseState=this.state,this.sectionStart=this.index+1):g===r.Slash?this.state=a.InSelfClosingTag:o(g)||(this.state=a.InAttributeName,this.sectionStart=this.index)},v.prototype.stateInSelfClosingTag=function(g){g===r.Gt?(this.cbs.onselfclosingtag(this.index),this.state=a.Text,this.baseState=a.Text,this.sectionStart=this.index+1,this.isSpecial=!1):o(g)||(this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g))},v.prototype.stateInAttributeName=function(g){(g===r.Eq||u(g))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.AfterAttributeName,this.stateAfterAttributeName(g))},v.prototype.stateAfterAttributeName=function(g){g===r.Eq?this.state=a.BeforeAttributeValue:g===r.Slash||g===r.Gt?(this.cbs.onattribend(d.NoValue,this.index),this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g)):o(g)||(this.cbs.onattribend(d.NoValue,this.index),this.state=a.InAttributeName,this.sectionStart=this.index)},v.prototype.stateBeforeAttributeValue=function(g){g===r.DoubleQuote?(this.state=a.InAttributeValueDq,this.sectionStart=this.index+1):g===r.SingleQuote?(this.state=a.InAttributeValueSq,this.sectionStart=this.index+1):o(g)||(this.sectionStart=this.index,this.state=a.InAttributeValueNq,this.stateInAttributeValueNoQuotes(g))},v.prototype.handleInAttributeValue=function(g,b){g===b||!this.decodeEntities&&this.fastForwardTo(b)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(b===r.DoubleQuote?d.Double:d.Single,this.index),this.state=a.BeforeAttributeName):this.decodeEntities&&g===r.Amp&&(this.baseState=this.state,this.state=a.BeforeEntity)},v.prototype.stateInAttributeValueDoubleQuotes=function(g){this.handleInAttributeValue(g,r.DoubleQuote)},v.prototype.stateInAttributeValueSingleQuotes=function(g){this.handleInAttributeValue(g,r.SingleQuote)},v.prototype.stateInAttributeValueNoQuotes=function(g){o(g)||g===r.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(d.Unquoted,this.index),this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g)):this.decodeEntities&&g===r.Amp&&(this.baseState=this.state,this.state=a.BeforeEntity)},v.prototype.stateBeforeDeclaration=function(g){g===r.OpeningSquareBracket?(this.state=a.CDATASequence,this.sequenceIndex=0):this.state=g===r.Dash?a.BeforeComment:a.InDeclaration},v.prototype.stateInDeclaration=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateInProcessingInstruction=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeComment=function(g){g===r.Dash?(this.state=a.InCommentLike,this.currentSequence=f.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=a.InDeclaration},v.prototype.stateInSpecialComment=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeSpecialS=function(g){var b=g|32;b===f.ScriptEnd[3]?this.startSpecial(f.ScriptEnd,4):b===f.StyleEnd[3]?this.startSpecial(f.StyleEnd,4):(this.state=a.InTagName,this.stateInTagName(g))},v.prototype.stateBeforeEntity=function(g){this.entityExcess=1,this.entityResult=0,g===r.Number?this.state=a.BeforeNumericEntity:g===r.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=a.InNamedEntity,this.stateInNamedEntity(g))},v.prototype.stateInNamedEntity=function(g){if(this.entityExcess+=1,this.trieIndex=(0,t.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,g),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var b=this.trieCurrent&t.BinTrieFlags.VALUE_LENGTH;if(b){var _=(b>>14)-1;if(!this.allowLegacyEntity()&&g!==r.Semi)this.trieIndex+=_;else{var S=this.index-this.entityExcess+1;S>this.sectionStart&&this.emitPartial(this.sectionStart,S),this.entityResult=this.trieIndex,this.trieIndex+=_,this.entityExcess=0,this.sectionStart=this.index+1,_===0&&this.emitNamedEntity()}}},v.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var g=(this.entityTrie[this.entityResult]&t.BinTrieFlags.VALUE_LENGTH)>>14;switch(g){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~t.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},v.prototype.stateBeforeNumericEntity=function(g){(g|32)===r.LowerX?(this.entityExcess++,this.state=a.InHexEntity):(this.state=a.InNumericEntity,this.stateInNumericEntity(g))},v.prototype.emitNumericEntity=function(g){var b=this.index-this.entityExcess-1,_=b+2+ +(this.state===a.InHexEntity);_!==this.index&&(b>this.sectionStart&&this.emitPartial(this.sectionStart,b),this.sectionStart=this.index+Number(g),this.emitCodePoint((0,t.replaceCodePoint)(this.entityResult))),this.state=this.baseState},v.prototype.stateInNumericEntity=function(g){g===r.Semi?this.emitNumericEntity(!0):s(g)?(this.entityResult=this.entityResult*10+(g-r.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},v.prototype.stateInHexEntity=function(g){g===r.Semi?this.emitNumericEntity(!0):s(g)?(this.entityResult=this.entityResult*16+(g-r.Zero),this.entityExcess++):l(g)?(this.entityResult=this.entityResult*16+((g|32)-r.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},v.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===a.Text||this.baseState===a.InSpecialTag)},v.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===a.Text||this.state===a.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===a.InAttributeValueDq||this.state===a.InAttributeValueSq||this.state===a.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},v.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},v.prototype.parse=function(){for(;this.shouldContinue();){var g=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case a.Text:{this.stateText(g);break}case a.SpecialStartSequence:{this.stateSpecialStartSequence(g);break}case a.InSpecialTag:{this.stateInSpecialTag(g);break}case a.CDATASequence:{this.stateCDATASequence(g);break}case a.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(g);break}case a.InAttributeName:{this.stateInAttributeName(g);break}case a.InCommentLike:{this.stateInCommentLike(g);break}case a.InSpecialComment:{this.stateInSpecialComment(g);break}case a.BeforeAttributeName:{this.stateBeforeAttributeName(g);break}case a.InTagName:{this.stateInTagName(g);break}case a.InClosingTagName:{this.stateInClosingTagName(g);break}case a.BeforeTagName:{this.stateBeforeTagName(g);break}case a.AfterAttributeName:{this.stateAfterAttributeName(g);break}case a.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(g);break}case a.BeforeAttributeValue:{this.stateBeforeAttributeValue(g);break}case a.BeforeClosingTagName:{this.stateBeforeClosingTagName(g);break}case a.AfterClosingTagName:{this.stateAfterClosingTagName(g);break}case a.BeforeSpecialS:{this.stateBeforeSpecialS(g);break}case a.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(g);break}case a.InSelfClosingTag:{this.stateInSelfClosingTag(g);break}case a.InDeclaration:{this.stateInDeclaration(g);break}case a.BeforeDeclaration:{this.stateBeforeDeclaration(g);break}case a.BeforeComment:{this.stateBeforeComment(g);break}case a.InProcessingInstruction:{this.stateInProcessingInstruction(g);break}case a.InNamedEntity:{this.stateInNamedEntity(g);break}case a.BeforeEntity:{this.stateBeforeEntity(g);break}case a.InHexEntity:{this.stateInHexEntity(g);break}case a.InNumericEntity:{this.stateInNumericEntity(g);break}default:this.stateBeforeNumericEntity(g)}this.index++}this.cleanup()},v.prototype.finish=function(){this.state===a.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},v.prototype.handleTrailingData=function(){var g=this.buffer.length+this.offset;this.state===a.InCommentLike?this.currentSequence===f.CdataEnd?this.cbs.oncdata(this.sectionStart,g,0):this.cbs.oncomment(this.sectionStart,g,0):this.state===a.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===a.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===a.InTagName||this.state===a.BeforeAttributeName||this.state===a.BeforeAttributeValue||this.state===a.AfterAttributeName||this.state===a.InAttributeName||this.state===a.InAttributeValueSq||this.state===a.InAttributeValueDq||this.state===a.InAttributeValueNq||this.state===a.InClosingTagName||this.cbs.ontext(this.sectionStart,g)},v.prototype.emitPartial=function(g,b){this.baseState!==a.Text&&this.baseState!==a.InSpecialTag?this.cbs.onattribdata(g,b):this.cbs.ontext(g,b)},v.prototype.emitCodePoint=function(g){this.baseState!==a.Text&&this.baseState!==a.InSpecialTag?this.cbs.onattribentity(g):this.cbs.ontextentity(g)},v}();n.default=h}(Tokenizer$2)),Tokenizer$2}var hasRequiredParser$2;function requireParser$2(){if(hasRequiredParser$2)return Parser$3;hasRequiredParser$2=1;var n=Parser$3&&Parser$3.__createBinding||(Object.create?function(S,T,w,A){A===void 0&&(A=w);var R=Object.getOwnPropertyDescriptor(T,w);(!R||("get"in R?!T.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return T[w]}}),Object.defineProperty(S,A,R)}:function(S,T,w,A){A===void 0&&(A=w),S[A]=T[w]}),t=Parser$3&&Parser$3.__setModuleDefault||(Object.create?function(S,T){Object.defineProperty(S,"default",{enumerable:!0,value:T})}:function(S,T){S.default=T}),r=Parser$3&&Parser$3.__importStar||function(S){if(S&&S.__esModule)return S;var T={};if(S!=null)for(var w in S)w!=="default"&&Object.prototype.hasOwnProperty.call(S,w)&&n(T,S,w);return t(T,S),T};Object.defineProperty(Parser$3,"__esModule",{value:!0}),Parser$3.Parser=void 0;var a=r(requireTokenizer$2()),o=requireDecode$3(),u=new Set(["input","option","optgroup","select","button","datalist","textarea"]),s=new Set(["p"]),c=new Set(["thead","tbody"]),l=new Set(["dd","dt"]),d=new Set(["rt","rp"]),f=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",s],["h1",s],["h2",s],["h3",s],["h4",s],["h5",s],["h6",s],["select",u],["input",u],["output",u],["button",u],["datalist",u],["textarea",u],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",l],["dt",l],["address",s],["article",s],["aside",s],["blockquote",s],["details",s],["div",s],["dl",s],["fieldset",s],["figcaption",s],["figure",s],["footer",s],["form",s],["header",s],["hr",s],["main",s],["nav",s],["ol",s],["pre",s],["section",s],["table",s],["ul",s],["rt",d],["rp",d],["tbody",c],["tfoot",c]]),h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),v=new Set(["math","svg"]),g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),b=/\s|\//,_=function(){function S(T,w){w===void 0&&(w={});var A,R,E,I,L;this.options=w,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=T??{},this.lowerCaseTagNames=(A=w.lowerCaseTags)!==null&&A!==void 0?A:!w.xmlMode,this.lowerCaseAttributeNames=(R=w.lowerCaseAttributeNames)!==null&&R!==void 0?R:!w.xmlMode,this.tokenizer=new((E=w.Tokenizer)!==null&&E!==void 0?E:a.default)(this.options,this),(L=(I=this.cbs).onparserinit)===null||L===void 0||L.call(I,this)}return S.prototype.ontext=function(T,w){var A,R,E=this.getSlice(T,w);this.endIndex=w-1,(R=(A=this.cbs).ontext)===null||R===void 0||R.call(A,E),this.startIndex=w},S.prototype.ontextentity=function(T){var w,A,R=this.tokenizer.getSectionStart();this.endIndex=R-1,(A=(w=this.cbs).ontext)===null||A===void 0||A.call(w,(0,o.fromCodePoint)(T)),this.startIndex=R},S.prototype.isVoidElement=function(T){return!this.options.xmlMode&&h.has(T)},S.prototype.onopentagname=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);this.lowerCaseTagNames&&(A=A.toLowerCase()),this.emitOpenTag(A)},S.prototype.emitOpenTag=function(T){var w,A,R,E;this.openTagStart=this.startIndex,this.tagname=T;var I=!this.options.xmlMode&&f.get(T);if(I)for(;this.stack.length>0&&I.has(this.stack[this.stack.length-1]);){var L=this.stack.pop();(A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,L,!0)}this.isVoidElement(T)||(this.stack.push(T),v.has(T)?this.foreignContext.push(!0):g.has(T)&&this.foreignContext.push(!1)),(E=(R=this.cbs).onopentagname)===null||E===void 0||E.call(R,T),this.cbs.onopentag&&(this.attribs={})},S.prototype.endOpenTag=function(T){var w,A;this.startIndex=this.openTagStart,this.attribs&&((A=(w=this.cbs).onopentag)===null||A===void 0||A.call(w,this.tagname,this.attribs,T),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},S.prototype.onopentagend=function(T){this.endIndex=T,this.endOpenTag(!1),this.startIndex=T+1},S.prototype.onclosetag=function(T,w){var A,R,E,I,L,F;this.endIndex=w;var D=this.getSlice(T,w);if(this.lowerCaseTagNames&&(D=D.toLowerCase()),(v.has(D)||g.has(D))&&this.foreignContext.pop(),this.isVoidElement(D))!this.options.xmlMode&&D==="br"&&((R=(A=this.cbs).onopentagname)===null||R===void 0||R.call(A,"br"),(I=(E=this.cbs).onopentag)===null||I===void 0||I.call(E,"br",{},!0),(F=(L=this.cbs).onclosetag)===null||F===void 0||F.call(L,"br",!1));else{var $=this.stack.lastIndexOf(D);if($!==-1)if(this.cbs.onclosetag)for(var O=this.stack.length-$;O--;)this.cbs.onclosetag(this.stack.pop(),O!==0);else this.stack.length=$;else!this.options.xmlMode&&D==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=w+1},S.prototype.onselfclosingtag=function(T){this.endIndex=T,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=T+1):this.onopentagend(T)},S.prototype.closeCurrentTag=function(T){var w,A,R=this.tagname;this.endOpenTag(T),this.stack[this.stack.length-1]===R&&((A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,R,!T),this.stack.pop())},S.prototype.onattribname=function(T,w){this.startIndex=T;var A=this.getSlice(T,w);this.attribname=this.lowerCaseAttributeNames?A.toLowerCase():A},S.prototype.onattribdata=function(T,w){this.attribvalue+=this.getSlice(T,w)},S.prototype.onattribentity=function(T){this.attribvalue+=(0,o.fromCodePoint)(T)},S.prototype.onattribend=function(T,w){var A,R;this.endIndex=w,(R=(A=this.cbs).onattribute)===null||R===void 0||R.call(A,this.attribname,this.attribvalue,T===a.QuoteType.Double?'"':T===a.QuoteType.Single?"'":T===a.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},S.prototype.getInstructionName=function(T){var w=T.search(b),A=w<0?T:T.substr(0,w);return this.lowerCaseTagNames&&(A=A.toLowerCase()),A},S.prototype.ondeclaration=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){var R=this.getInstructionName(A);this.cbs.onprocessinginstruction("!".concat(R),"!".concat(A))}this.startIndex=w+1},S.prototype.onprocessinginstruction=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){var R=this.getInstructionName(A);this.cbs.onprocessinginstruction("?".concat(R),"?".concat(A))}this.startIndex=w+1},S.prototype.oncomment=function(T,w,A){var R,E,I,L;this.endIndex=w,(E=(R=this.cbs).oncomment)===null||E===void 0||E.call(R,this.getSlice(T,w-A)),(L=(I=this.cbs).oncommentend)===null||L===void 0||L.call(I),this.startIndex=w+1},S.prototype.oncdata=function(T,w,A){var R,E,I,L,F,D,$,O,P,C;this.endIndex=w;var q=this.getSlice(T,w-A);this.options.xmlMode||this.options.recognizeCDATA?((E=(R=this.cbs).oncdatastart)===null||E===void 0||E.call(R),(L=(I=this.cbs).ontext)===null||L===void 0||L.call(I,q),(D=(F=this.cbs).oncdataend)===null||D===void 0||D.call(F)):((O=($=this.cbs).oncomment)===null||O===void 0||O.call($,"[CDATA[".concat(q,"]]")),(C=(P=this.cbs).oncommentend)===null||C===void 0||C.call(P)),this.startIndex=w+1},S.prototype.onend=function(){var T,w;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var A=this.stack.length;A>0;this.cbs.onclosetag(this.stack[--A],!0));}(w=(T=this.cbs).onend)===null||w===void 0||w.call(T)},S.prototype.reset=function(){var T,w,A,R;(w=(T=this.cbs).onreset)===null||w===void 0||w.call(T),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(R=(A=this.cbs).onparserinit)===null||R===void 0||R.call(A,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},S.prototype.parseComplete=function(T){this.reset(),this.end(T)},S.prototype.getSlice=function(T,w){for(;T-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var A=this.buffers[0].slice(T-this.bufferOffset,w-this.bufferOffset);w-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),A+=this.buffers[0].slice(0,w-this.bufferOffset);return A},S.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},S.prototype.write=function(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".write() after done!"));return}this.buffers.push(T),this.tokenizer.running&&(this.tokenizer.write(T),this.writeIndex++)},S.prototype.end=function(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".end() after done!"));return}T&&this.write(T),this.ended=!0,this.tokenizer.end()},S.prototype.pause=function(){this.tokenizer.pause()},S.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},S.prototype.parseChunk=function(T){this.write(T)},S.prototype.done=function(T){this.end(T)},S}();return Parser$3.Parser=_,Parser$3}var lib$3n={},lib$3m={},hasRequiredLib$3p;function requireLib$3p(){return hasRequiredLib$3p||(hasRequiredLib$3p=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Doctype=n.CDATA=n.Tag=n.Style=n.Script=n.Comment=n.Directive=n.Text=n.Root=n.isTag=n.ElementType=void 0;var t;(function(a){a.Root="root",a.Text="text",a.Directive="directive",a.Comment="comment",a.Script="script",a.Style="style",a.Tag="tag",a.CDATA="cdata",a.Doctype="doctype"})(t=n.ElementType||(n.ElementType={}));function r(a){return a.type===t.Tag||a.type===t.Script||a.type===t.Style}n.isTag=r,n.Root=t.Root,n.Text=t.Text,n.Directive=t.Directive,n.Comment=t.Comment,n.Script=t.Script,n.Style=t.Style,n.Tag=t.Tag,n.CDATA=t.CDATA,n.Doctype=t.Doctype}(lib$3m)),lib$3m}var node={},hasRequiredNode;function requireNode(){if(hasRequiredNode)return node;hasRequiredNode=1;var n=node&&node.__extends||function(){var E=function(I,L){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,D){F.__proto__=D}||function(F,D){for(var $ in D)Object.prototype.hasOwnProperty.call(D,$)&&(F[$]=D[$])},E(I,L)};return function(I,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");E(I,L);function F(){this.constructor=I}I.prototype=L===null?Object.create(L):(F.prototype=L.prototype,new F)}}(),t=node&&node.__assign||function(){return t=Object.assign||function(E){for(var I,L=1,F=arguments.length;L<F;L++){I=arguments[L];for(var D in I)Object.prototype.hasOwnProperty.call(I,D)&&(E[D]=I[D])}return E},t.apply(this,arguments)};Object.defineProperty(node,"__esModule",{value:!0}),node.cloneNode=node.hasChildren=node.isDocument=node.isDirective=node.isComment=node.isText=node.isCDATA=node.isTag=node.Element=node.Document=node.CDATA=node.NodeWithChildren=node.ProcessingInstruction=node.Comment=node.Text=node.DataNode=node.Node=void 0;var r=requireLib$3p(),a=function(){function E(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(E.prototype,"parentNode",{get:function(){return this.parent},set:function(I){this.parent=I},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"previousSibling",{get:function(){return this.prev},set:function(I){this.prev=I},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"nextSibling",{get:function(){return this.next},set:function(I){this.next=I},enumerable:!1,configurable:!0}),E.prototype.cloneNode=function(I){return I===void 0&&(I=!1),A(this,I)},E}();node.Node=a;var o=function(E){n(I,E);function I(L){var F=E.call(this)||this;return F.data=L,F}return Object.defineProperty(I.prototype,"nodeValue",{get:function(){return this.data},set:function(L){this.data=L},enumerable:!1,configurable:!0}),I}(a);node.DataNode=o;var u=function(E){n(I,E);function I(){var L=E!==null&&E.apply(this,arguments)||this;return L.type=r.ElementType.Text,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),I}(o);node.Text=u;var s=function(E){n(I,E);function I(){var L=E!==null&&E.apply(this,arguments)||this;return L.type=r.ElementType.Comment,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),I}(o);node.Comment=s;var c=function(E){n(I,E);function I(L,F){var D=E.call(this,F)||this;return D.name=L,D.type=r.ElementType.Directive,D}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),I}(o);node.ProcessingInstruction=c;var l=function(E){n(I,E);function I(L){var F=E.call(this)||this;return F.children=L,F}return Object.defineProperty(I.prototype,"firstChild",{get:function(){var L;return(L=this.children[0])!==null&&L!==void 0?L:null},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"childNodes",{get:function(){return this.children},set:function(L){this.children=L},enumerable:!1,configurable:!0}),I}(a);node.NodeWithChildren=l;var d=function(E){n(I,E);function I(){var L=E!==null&&E.apply(this,arguments)||this;return L.type=r.ElementType.CDATA,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),I}(l);node.CDATA=d;var f=function(E){n(I,E);function I(){var L=E!==null&&E.apply(this,arguments)||this;return L.type=r.ElementType.Root,L}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),I}(l);node.Document=f;var h=function(E){n(I,E);function I(L,F,D,$){D===void 0&&(D=[]),$===void 0&&($=L==="script"?r.ElementType.Script:L==="style"?r.ElementType.Style:r.ElementType.Tag);var O=E.call(this,D)||this;return O.name=L,O.attribs=F,O.type=$,O}return Object.defineProperty(I.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"tagName",{get:function(){return this.name},set:function(L){this.name=L},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"attributes",{get:function(){var L=this;return Object.keys(this.attribs).map(function(F){var D,$;return{name:F,value:L.attribs[F],namespace:(D=L["x-attribsNamespace"])===null||D===void 0?void 0:D[F],prefix:($=L["x-attribsPrefix"])===null||$===void 0?void 0:$[F]}})},enumerable:!1,configurable:!0}),I}(l);node.Element=h;function v(E){return(0,r.isTag)(E)}node.isTag=v;function g(E){return E.type===r.ElementType.CDATA}node.isCDATA=g;function b(E){return E.type===r.ElementType.Text}node.isText=b;function _(E){return E.type===r.ElementType.Comment}node.isComment=_;function S(E){return E.type===r.ElementType.Directive}node.isDirective=S;function T(E){return E.type===r.ElementType.Root}node.isDocument=T;function w(E){return Object.prototype.hasOwnProperty.call(E,"children")}node.hasChildren=w;function A(E,I){I===void 0&&(I=!1);var L;if(b(E))L=new u(E.data);else if(_(E))L=new s(E.data);else if(v(E)){var F=I?R(E.children):[],D=new h(E.name,t({},E.attribs),F);F.forEach(function(C){return C.parent=D}),E.namespace!=null&&(D.namespace=E.namespace),E["x-attribsNamespace"]&&(D["x-attribsNamespace"]=t({},E["x-attribsNamespace"])),E["x-attribsPrefix"]&&(D["x-attribsPrefix"]=t({},E["x-attribsPrefix"])),L=D}else if(g(E)){var F=I?R(E.children):[],$=new d(F);F.forEach(function(q){return q.parent=$}),L=$}else if(T(E)){var F=I?R(E.children):[],O=new f(F);F.forEach(function(q){return q.parent=O}),E["x-mode"]&&(O["x-mode"]=E["x-mode"]),L=O}else if(S(E)){var P=new c(E.name,E.data);E["x-name"]!=null&&(P["x-name"]=E["x-name"],P["x-publicId"]=E["x-publicId"],P["x-systemId"]=E["x-systemId"]),L=P}else throw new Error("Not implemented yet: ".concat(E.type));return L.startIndex=E.startIndex,L.endIndex=E.endIndex,E.sourceCodeLocation!=null&&(L.sourceCodeLocation=E.sourceCodeLocation),L}node.cloneNode=A;function R(E){for(var I=E.map(function(F){return A(F,!0)}),L=1;L<I.length;L++)I[L].prev=I[L-1],I[L-1].next=I[L];return I}return node}var hasRequiredLib$3o;function requireLib$3o(){return hasRequiredLib$3o||(hasRequiredLib$3o=1,function(n){var t=lib$3n&&lib$3n.__createBinding||(Object.create?function(c,l,d,f){f===void 0&&(f=d);var h=Object.getOwnPropertyDescriptor(l,d);(!h||("get"in h?!l.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return l[d]}}),Object.defineProperty(c,f,h)}:function(c,l,d,f){f===void 0&&(f=d),c[f]=l[d]}),r=lib$3n&&lib$3n.__exportStar||function(c,l){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(l,d)&&t(l,c,d)};Object.defineProperty(n,"__esModule",{value:!0}),n.DomHandler=void 0;var a=requireLib$3p(),o=requireNode();r(requireNode(),n);var u={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},s=function(){function c(l,d,f){this.dom=[],this.root=new o.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof d=="function"&&(f=d,d=u),typeof l=="object"&&(d=l,l=void 0),this.callback=l??null,this.options=d??u,this.elementCB=f??null}return c.prototype.onparserinit=function(l){this.parser=l},c.prototype.onreset=function(){this.dom=[],this.root=new o.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},c.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},c.prototype.onerror=function(l){this.handleCallback(l)},c.prototype.onclosetag=function(){this.lastNode=null;var l=this.tagStack.pop();this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(l)},c.prototype.onopentag=function(l,d){var f=this.options.xmlMode?a.ElementType.Tag:void 0,h=new o.Element(l,d,void 0,f);this.addNode(h),this.tagStack.push(h)},c.prototype.ontext=function(l){var d=this.lastNode;if(d&&d.type===a.ElementType.Text)d.data+=l,this.options.withEndIndices&&(d.endIndex=this.parser.endIndex);else{var f=new o.Text(l);this.addNode(f),this.lastNode=f}},c.prototype.oncomment=function(l){if(this.lastNode&&this.lastNode.type===a.ElementType.Comment){this.lastNode.data+=l;return}var d=new o.Comment(l);this.addNode(d),this.lastNode=d},c.prototype.oncommentend=function(){this.lastNode=null},c.prototype.oncdatastart=function(){var l=new o.Text(""),d=new o.CDATA([l]);this.addNode(d),l.parent=d,this.lastNode=l},c.prototype.oncdataend=function(){this.lastNode=null},c.prototype.onprocessinginstruction=function(l,d){var f=new o.ProcessingInstruction(l,d);this.addNode(f)},c.prototype.handleCallback=function(l){if(typeof this.callback=="function")this.callback(l,this.dom);else if(l)throw l},c.prototype.addNode=function(l){var d=this.tagStack[this.tagStack.length-1],f=d.children[d.children.length-1];this.options.withStartIndices&&(l.startIndex=this.parser.startIndex),this.options.withEndIndices&&(l.endIndex=this.parser.endIndex),d.children.push(l),f&&(l.prev=f,f.next=l),l.parent=d,this.lastNode=null},c}();n.DomHandler=s,n.default=s}(lib$3n)),lib$3n}var lib$3l={},stringify$1={},lib$3k={},lib$3j={},decode$2={},decodeDataHtml$2={},hasRequiredDecodeDataHtml$2;function requireDecodeDataHtml$2(){return hasRequiredDecodeDataHtml$2||(hasRequiredDecodeDataHtml$2=1,Object.defineProperty(decodeDataHtml$2,"__esModule",{value:!0}),decodeDataHtml$2.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(n){return n.charCodeAt(0)}))),decodeDataHtml$2}var decodeDataXml$2={},hasRequiredDecodeDataXml$2;function requireDecodeDataXml$2(){return hasRequiredDecodeDataXml$2||(hasRequiredDecodeDataXml$2=1,Object.defineProperty(decodeDataXml$2,"__esModule",{value:!0}),decodeDataXml$2.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(n){return n.charCodeAt(0)}))),decodeDataXml$2}var decode_codepoint$1={},hasRequiredDecode_codepoint$1;function requireDecode_codepoint$1(){return hasRequiredDecode_codepoint$1||(hasRequiredDecode_codepoint$1=1,function(n){var t;Object.defineProperty(n,"__esModule",{value:!0}),n.replaceCodePoint=n.fromCodePoint=void 0;var r=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);n.fromCodePoint=(t=String.fromCodePoint)!==null&&t!==void 0?t:function(u){var s="";return u>65535&&(u-=65536,s+=String.fromCharCode(u>>>10&1023|55296),u=56320|u&1023),s+=String.fromCharCode(u),s};function a(u){var s;return u>=55296&&u<=57343||u>1114111?65533:(s=r.get(u))!==null&&s!==void 0?s:u}n.replaceCodePoint=a;function o(u){return(0,n.fromCodePoint)(a(u))}n.default=o}(decode_codepoint$1)),decode_codepoint$1}var hasRequiredDecode$2;function requireDecode$2(){return hasRequiredDecode$2||(hasRequiredDecode$2=1,function(n){var t=decode$2&&decode$2.__createBinding||(Object.create?function(O,P,C,q){q===void 0&&(q=C);var M=Object.getOwnPropertyDescriptor(P,C);(!M||("get"in M?!P.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return P[C]}}),Object.defineProperty(O,q,M)}:function(O,P,C,q){q===void 0&&(q=C),O[q]=P[C]}),r=decode$2&&decode$2.__setModuleDefault||(Object.create?function(O,P){Object.defineProperty(O,"default",{enumerable:!0,value:P})}:function(O,P){O.default=P}),a=decode$2&&decode$2.__importStar||function(O){if(O&&O.__esModule)return O;var P={};if(O!=null)for(var C in O)C!=="default"&&Object.prototype.hasOwnProperty.call(O,C)&&t(P,O,C);return r(P,O),P},o=decode$2&&decode$2.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXML=n.decodeHTMLStrict=n.decodeHTMLAttribute=n.decodeHTML=n.determineBranch=n.EntityDecoder=n.DecodingMode=n.BinTrieFlags=n.fromCodePoint=n.replaceCodePoint=n.decodeCodePoint=n.xmlDecodeTree=n.htmlDecodeTree=void 0;var u=o(requireDecodeDataHtml$2());n.htmlDecodeTree=u.default;var s=o(requireDecodeDataXml$2());n.xmlDecodeTree=s.default;var c=a(requireDecode_codepoint$1());n.decodeCodePoint=c.default;var l=requireDecode_codepoint$1();Object.defineProperty(n,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(n,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var d;(function(O){O[O.NUM=35]="NUM",O[O.SEMI=59]="SEMI",O[O.EQUALS=61]="EQUALS",O[O.ZERO=48]="ZERO",O[O.NINE=57]="NINE",O[O.LOWER_A=97]="LOWER_A",O[O.LOWER_F=102]="LOWER_F",O[O.LOWER_X=120]="LOWER_X",O[O.LOWER_Z=122]="LOWER_Z",O[O.UPPER_A=65]="UPPER_A",O[O.UPPER_F=70]="UPPER_F",O[O.UPPER_Z=90]="UPPER_Z"})(d||(d={}));var f=32,h;(function(O){O[O.VALUE_LENGTH=49152]="VALUE_LENGTH",O[O.BRANCH_LENGTH=16256]="BRANCH_LENGTH",O[O.JUMP_TABLE=127]="JUMP_TABLE"})(h=n.BinTrieFlags||(n.BinTrieFlags={}));function v(O){return O>=d.ZERO&&O<=d.NINE}function g(O){return O>=d.UPPER_A&&O<=d.UPPER_F||O>=d.LOWER_A&&O<=d.LOWER_F}function b(O){return O>=d.UPPER_A&&O<=d.UPPER_Z||O>=d.LOWER_A&&O<=d.LOWER_Z||v(O)}function _(O){return O===d.EQUALS||b(O)}var S;(function(O){O[O.EntityStart=0]="EntityStart",O[O.NumericStart=1]="NumericStart",O[O.NumericDecimal=2]="NumericDecimal",O[O.NumericHex=3]="NumericHex",O[O.NamedEntity=4]="NamedEntity"})(S||(S={}));var T;(function(O){O[O.Legacy=0]="Legacy",O[O.Strict=1]="Strict",O[O.Attribute=2]="Attribute"})(T=n.DecodingMode||(n.DecodingMode={}));var w=function(){function O(P,C,q){this.decodeTree=P,this.emitCodePoint=C,this.errors=q,this.state=S.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=T.Strict}return O.prototype.startEntity=function(P){this.decodeMode=P,this.state=S.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},O.prototype.write=function(P,C){switch(this.state){case S.EntityStart:return P.charCodeAt(C)===d.NUM?(this.state=S.NumericStart,this.consumed+=1,this.stateNumericStart(P,C+1)):(this.state=S.NamedEntity,this.stateNamedEntity(P,C));case S.NumericStart:return this.stateNumericStart(P,C);case S.NumericDecimal:return this.stateNumericDecimal(P,C);case S.NumericHex:return this.stateNumericHex(P,C);case S.NamedEntity:return this.stateNamedEntity(P,C)}},O.prototype.stateNumericStart=function(P,C){return C>=P.length?-1:(P.charCodeAt(C)|f)===d.LOWER_X?(this.state=S.NumericHex,this.consumed+=1,this.stateNumericHex(P,C+1)):(this.state=S.NumericDecimal,this.stateNumericDecimal(P,C))},O.prototype.addToNumericResult=function(P,C,q,M){if(C!==q){var N=q-C;this.result=this.result*Math.pow(M,N)+parseInt(P.substr(C,N),M),this.consumed+=N}},O.prototype.stateNumericHex=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M)||g(M))C+=1;else return this.addToNumericResult(P,q,C,16),this.emitNumericEntity(M,3)}return this.addToNumericResult(P,q,C,16),-1},O.prototype.stateNumericDecimal=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M))C+=1;else return this.addToNumericResult(P,q,C,10),this.emitNumericEntity(M,2)}return this.addToNumericResult(P,q,C,10),-1},O.prototype.emitNumericEntity=function(P,C){var q;if(this.consumed<=C)return(q=this.errors)===null||q===void 0||q.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(P===d.SEMI)this.consumed+=1;else if(this.decodeMode===T.Strict)return 0;return this.emitCodePoint((0,c.replaceCodePoint)(this.result),this.consumed),this.errors&&(P!==d.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},O.prototype.stateNamedEntity=function(P,C){for(var q=this.decodeTree,M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14;C<P.length;C++,this.excess++){var G=P.charCodeAt(C);if(this.treeIndex=R(q,M,this.treeIndex+Math.max(1,N),G),this.treeIndex<0)return this.result===0||this.decodeMode===T.Attribute&&(N===0||_(G))?0:this.emitNotTerminatedNamedEntity();if(M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14,N!==0){if(G===d.SEMI)return this.emitNamedEntityData(this.treeIndex,N,this.consumed+this.excess);this.decodeMode!==T.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},O.prototype.emitNotTerminatedNamedEntity=function(){var P,C=this,q=C.result,M=C.decodeTree,N=(M[q]&h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(q,N,this.consumed),(P=this.errors)===null||P===void 0||P.missingSemicolonAfterCharacterReference(),this.consumed},O.prototype.emitNamedEntityData=function(P,C,q){var M=this.decodeTree;return this.emitCodePoint(C===1?M[P]&~h.VALUE_LENGTH:M[P+1],q),C===3&&this.emitCodePoint(M[P+2],q),q},O.prototype.end=function(){var P;switch(this.state){case S.NamedEntity:return this.result!==0&&(this.decodeMode!==T.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case S.NumericDecimal:return this.emitNumericEntity(0,2);case S.NumericHex:return this.emitNumericEntity(0,3);case S.NumericStart:return(P=this.errors)===null||P===void 0||P.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case S.EntityStart:return 0}},O}();n.EntityDecoder=w;function A(O){var P="",C=new w(O,function(q){return P+=(0,c.fromCodePoint)(q)});return function(M,N){for(var G=0,X=0;(X=M.indexOf("&",X))>=0;){P+=M.slice(G,X),C.startEntity(N);var Y=C.write(M,X+1);if(Y<0){G=X+C.end();break}G=X+Y,X=Y===0?G+1:G}var W=P+M.slice(G);return P="",W}}function R(O,P,C,q){var M=(P&h.BRANCH_LENGTH)>>7,N=P&h.JUMP_TABLE;if(M===0)return N!==0&&q===N?C:-1;if(N){var G=q-N;return G<0||G>=M?-1:O[C+G]-1}for(var X=C,Y=X+M-1;X<=Y;){var W=X+Y>>>1,te=O[W];if(te<q)X=W+1;else if(te>q)Y=W-1;else return O[W+M]}return-1}n.determineBranch=R;var E=A(u.default),I=A(s.default);function L(O,P){return P===void 0&&(P=T.Legacy),E(O,P)}n.decodeHTML=L;function F(O){return E(O,T.Attribute)}n.decodeHTMLAttribute=F;function D(O){return E(O,T.Strict)}n.decodeHTMLStrict=D;function $(O){return I(O,T.Strict)}n.decodeXML=$}(decode$2)),decode$2}var encode={},encodeHtml={},hasRequiredEncodeHtml;function requireEncodeHtml(){if(hasRequiredEncodeHtml)return encodeHtml;hasRequiredEncodeHtml=1,Object.defineProperty(encodeHtml,"__esModule",{value:!0});function n(t){for(var r=1;r<t.length;r++)t[r][0]+=t[r-1][0]+1;return t}return encodeHtml.default=new Map(n([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(n([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(n([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(n([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]])),encodeHtml}var _escape={},hasRequired_escape;function require_escape(){return hasRequired_escape||(hasRequired_escape=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.escapeText=n.escapeAttribute=n.escapeUTF8=n.escape=n.encodeXML=n.getCodePoint=n.xmlReplacer=void 0,n.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var t=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);n.getCodePoint=String.prototype.codePointAt!=null?function(o,u){return o.codePointAt(u)}:function(o,u){return(o.charCodeAt(u)&64512)===55296?(o.charCodeAt(u)-55296)*1024+o.charCodeAt(u+1)-56320+65536:o.charCodeAt(u)};function r(o){for(var u="",s=0,c;(c=n.xmlReplacer.exec(o))!==null;){var l=c.index,d=o.charCodeAt(l),f=t.get(d);f!==void 0?(u+=o.substring(s,l)+f,s=l+1):(u+="".concat(o.substring(s,l),"&#x").concat((0,n.getCodePoint)(o,l).toString(16),";"),s=n.xmlReplacer.lastIndex+=+((d&64512)===55296))}return u+o.substr(s)}n.encodeXML=r,n.escape=r;function a(o,u){return function(c){for(var l,d=0,f="";l=o.exec(c);)d!==l.index&&(f+=c.substring(d,l.index)),f+=u.get(l[0].charCodeAt(0)),d=l.index+1;return f+c.substring(d)}}n.escapeUTF8=a(/[&<>'"]/g,t),n.escapeAttribute=a(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),n.escapeText=a(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))}(_escape)),_escape}var hasRequiredEncode;function requireEncode(){if(hasRequiredEncode)return encode;hasRequiredEncode=1;var n=encode&&encode.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(encode,"__esModule",{value:!0}),encode.encodeNonAsciiHTML=encode.encodeHTML=void 0;var t=n(requireEncodeHtml()),r=require_escape(),a=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function o(c){return s(a,c)}encode.encodeHTML=o;function u(c){return s(r.xmlReplacer,c)}encode.encodeNonAsciiHTML=u;function s(c,l){for(var d="",f=0,h;(h=c.exec(l))!==null;){var v=h.index;d+=l.substring(f,v);var g=l.charCodeAt(v),b=t.default.get(g);if(typeof b=="object"){if(v+1<l.length){var _=l.charCodeAt(v+1),S=typeof b.n=="number"?b.n===_?b.o:void 0:b.n.get(_);if(S!==void 0){d+=S,f=c.lastIndex+=1;continue}}b=b.v}if(b!==void 0)d+=b,f=v+1;else{var T=(0,r.getCodePoint)(l,v);d+="&#x".concat(T.toString(16),";"),f=c.lastIndex+=+(T!==g)}}return d+l.substr(f)}return encode}var hasRequiredLib$3n;function requireLib$3n(){return hasRequiredLib$3n||(hasRequiredLib$3n=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXMLStrict=n.decodeHTML5Strict=n.decodeHTML4Strict=n.decodeHTML5=n.decodeHTML4=n.decodeHTMLAttribute=n.decodeHTMLStrict=n.decodeHTML=n.decodeXML=n.DecodingMode=n.EntityDecoder=n.encodeHTML5=n.encodeHTML4=n.encodeNonAsciiHTML=n.encodeHTML=n.escapeText=n.escapeAttribute=n.escapeUTF8=n.escape=n.encodeXML=n.encode=n.decodeStrict=n.decode=n.EncodingMode=n.EntityLevel=void 0;var t=requireDecode$2(),r=requireEncode(),a=require_escape(),o;(function(v){v[v.XML=0]="XML",v[v.HTML=1]="HTML"})(o=n.EntityLevel||(n.EntityLevel={}));var u;(function(v){v[v.UTF8=0]="UTF8",v[v.ASCII=1]="ASCII",v[v.Extensive=2]="Extensive",v[v.Attribute=3]="Attribute",v[v.Text=4]="Text"})(u=n.EncodingMode||(n.EncodingMode={}));function s(v,g){g===void 0&&(g=o.XML);var b=typeof g=="number"?g:g.level;if(b===o.HTML){var _=typeof g=="object"?g.mode:void 0;return(0,t.decodeHTML)(v,_)}return(0,t.decodeXML)(v)}n.decode=s;function c(v,g){var b;g===void 0&&(g=o.XML);var _=typeof g=="number"?{level:g}:g;return(b=_.mode)!==null&&b!==void 0||(_.mode=t.DecodingMode.Strict),s(v,_)}n.decodeStrict=c;function l(v,g){g===void 0&&(g=o.XML);var b=typeof g=="number"?{level:g}:g;return b.mode===u.UTF8?(0,a.escapeUTF8)(v):b.mode===u.Attribute?(0,a.escapeAttribute)(v):b.mode===u.Text?(0,a.escapeText)(v):b.level===o.HTML?b.mode===u.ASCII?(0,r.encodeNonAsciiHTML)(v):(0,r.encodeHTML)(v):(0,a.encodeXML)(v)}n.encode=l;var d=require_escape();Object.defineProperty(n,"encodeXML",{enumerable:!0,get:function(){return d.encodeXML}}),Object.defineProperty(n,"escape",{enumerable:!0,get:function(){return d.escape}}),Object.defineProperty(n,"escapeUTF8",{enumerable:!0,get:function(){return d.escapeUTF8}}),Object.defineProperty(n,"escapeAttribute",{enumerable:!0,get:function(){return d.escapeAttribute}}),Object.defineProperty(n,"escapeText",{enumerable:!0,get:function(){return d.escapeText}});var f=requireEncode();Object.defineProperty(n,"encodeHTML",{enumerable:!0,get:function(){return f.encodeHTML}}),Object.defineProperty(n,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return f.encodeNonAsciiHTML}}),Object.defineProperty(n,"encodeHTML4",{enumerable:!0,get:function(){return f.encodeHTML}}),Object.defineProperty(n,"encodeHTML5",{enumerable:!0,get:function(){return f.encodeHTML}});var h=requireDecode$2();Object.defineProperty(n,"EntityDecoder",{enumerable:!0,get:function(){return h.EntityDecoder}}),Object.defineProperty(n,"DecodingMode",{enumerable:!0,get:function(){return h.DecodingMode}}),Object.defineProperty(n,"decodeXML",{enumerable:!0,get:function(){return h.decodeXML}}),Object.defineProperty(n,"decodeHTML",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(n,"decodeHTMLStrict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTMLAttribute",{enumerable:!0,get:function(){return h.decodeHTMLAttribute}}),Object.defineProperty(n,"decodeHTML4",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(n,"decodeHTML5",{enumerable:!0,get:function(){return h.decodeHTML}}),Object.defineProperty(n,"decodeHTML4Strict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(n,"decodeHTML5Strict",{enumerable:!0,get:function(){return h.decodeHTMLStrict}}),Object.defineProperty(n,"decodeXMLStrict",{enumerable:!0,get:function(){return h.decodeXML}})}(lib$3j)),lib$3j}var foreignNames={},hasRequiredForeignNames;function requireForeignNames(){return hasRequiredForeignNames||(hasRequiredForeignNames=1,Object.defineProperty(foreignNames,"__esModule",{value:!0}),foreignNames.attributeNames=foreignNames.elementNames=void 0,foreignNames.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(n){return[n.toLowerCase(),n]})),foreignNames.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(n){return[n.toLowerCase(),n]}))),foreignNames}var hasRequiredLib$3m;function requireLib$3m(){if(hasRequiredLib$3m)return lib$3k;hasRequiredLib$3m=1;var n=lib$3k&&lib$3k.__assign||function(){return n=Object.assign||function(R){for(var E,I=1,L=arguments.length;I<L;I++){E=arguments[I];for(var F in E)Object.prototype.hasOwnProperty.call(E,F)&&(R[F]=E[F])}return R},n.apply(this,arguments)},t=lib$3k&&lib$3k.__createBinding||(Object.create?function(R,E,I,L){L===void 0&&(L=I);var F=Object.getOwnPropertyDescriptor(E,I);(!F||("get"in F?!E.__esModule:F.writable||F.configurable))&&(F={enumerable:!0,get:function(){return E[I]}}),Object.defineProperty(R,L,F)}:function(R,E,I,L){L===void 0&&(L=I),R[L]=E[I]}),r=lib$3k&&lib$3k.__setModuleDefault||(Object.create?function(R,E){Object.defineProperty(R,"default",{enumerable:!0,value:E})}:function(R,E){R.default=E}),a=lib$3k&&lib$3k.__importStar||function(R){if(R&&R.__esModule)return R;var E={};if(R!=null)for(var I in R)I!=="default"&&Object.prototype.hasOwnProperty.call(R,I)&&t(E,R,I);return r(E,R),E};Object.defineProperty(lib$3k,"__esModule",{value:!0}),lib$3k.render=void 0;var o=a(requireLib$3p()),u=requireLib$3n(),s=requireForeignNames(),c=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function l(R){return R.replace(/"/g,"&quot;")}function d(R,E){var I;if(R){var L=((I=E.encodeEntities)!==null&&I!==void 0?I:E.decodeEntities)===!1?l:E.xmlMode||E.encodeEntities!=="utf8"?u.encodeXML:u.escapeAttribute;return Object.keys(R).map(function(F){var D,$,O=(D=R[F])!==null&&D!==void 0?D:"";return E.xmlMode==="foreign"&&(F=($=s.attributeNames.get(F))!==null&&$!==void 0?$:F),!E.emptyAttrs&&!E.xmlMode&&O===""?F:"".concat(F,'="').concat(L(O),'"')}).join(" ")}}var f=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function h(R,E){E===void 0&&(E={});for(var I=("length"in R)?R:[R],L="",F=0;F<I.length;F++)L+=v(I[F],E);return L}lib$3k.render=h,lib$3k.default=h;function v(R,E){switch(R.type){case o.Root:return h(R.children,E);case o.Doctype:case o.Directive:return S(R);case o.Comment:return A(R);case o.CDATA:return w(R);case o.Script:case o.Style:case o.Tag:return _(R,E);case o.Text:return T(R,E)}}var g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),b=new Set(["svg","math"]);function _(R,E){var I;E.xmlMode==="foreign"&&(R.name=(I=s.elementNames.get(R.name))!==null&&I!==void 0?I:R.name,R.parent&&g.has(R.parent.name)&&(E=n(n({},E),{xmlMode:!1}))),!E.xmlMode&&b.has(R.name)&&(E=n(n({},E),{xmlMode:"foreign"}));var L="<".concat(R.name),F=d(R.attribs,E);return F&&(L+=" ".concat(F)),R.children.length===0&&(E.xmlMode?E.selfClosingTags!==!1:E.selfClosingTags&&f.has(R.name))?(E.xmlMode||(L+=" "),L+="/>"):(L+=">",R.children.length>0&&(L+=h(R.children,E)),(E.xmlMode||!f.has(R.name))&&(L+="</".concat(R.name,">"))),L}function S(R){return"<".concat(R.data,">")}function T(R,E){var I,L=R.data||"";return((I=E.encodeEntities)!==null&&I!==void 0?I:E.decodeEntities)!==!1&&!(!E.xmlMode&&R.parent&&c.has(R.parent.name))&&(L=E.xmlMode||E.encodeEntities!=="utf8"?(0,u.encodeXML)(L):(0,u.escapeText)(L)),L}function w(R){return"<![CDATA[".concat(R.children[0].data,"]]>")}function A(R){return"<!--".concat(R.data,"-->")}return lib$3k}var hasRequiredStringify$1;function requireStringify$1(){if(hasRequiredStringify$1)return stringify$1;hasRequiredStringify$1=1;var n=stringify$1&&stringify$1.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(stringify$1,"__esModule",{value:!0}),stringify$1.getOuterHTML=o,stringify$1.getInnerHTML=u,stringify$1.getText=s,stringify$1.textContent=c,stringify$1.innerText=l;var t=requireLib$3o(),r=n(requireLib$3m()),a=requireLib$3p();function o(d,f){return(0,r.default)(d,f)}function u(d,f){return(0,t.hasChildren)(d)?d.children.map(function(h){return o(h,f)}).join(""):""}function s(d){return Array.isArray(d)?d.map(s).join(""):(0,t.isTag)(d)?d.name==="br"?`
`:s(d.children):(0,t.isCDATA)(d)?s(d.children):(0,t.isText)(d)?d.data:""}function c(d){return Array.isArray(d)?d.map(c).join(""):(0,t.hasChildren)(d)&&!(0,t.isComment)(d)?c(d.children):(0,t.isText)(d)?d.data:""}function l(d){return Array.isArray(d)?d.map(l).join(""):(0,t.hasChildren)(d)&&(d.type===a.ElementType.Tag||(0,t.isCDATA)(d))?l(d.children):(0,t.isText)(d)?d.data:""}return stringify$1}var traversal={},hasRequiredTraversal;function requireTraversal(){if(hasRequiredTraversal)return traversal;hasRequiredTraversal=1,Object.defineProperty(traversal,"__esModule",{value:!0}),traversal.getChildren=t,traversal.getParent=r,traversal.getSiblings=a,traversal.getAttributeValue=o,traversal.hasAttrib=u,traversal.getName=s,traversal.nextElementSibling=c,traversal.prevElementSibling=l;var n=requireLib$3o();function t(d){return(0,n.hasChildren)(d)?d.children:[]}function r(d){return d.parent||null}function a(d){var f,h,v=r(d);if(v!=null)return t(v);for(var g=[d],b=d.prev,_=d.next;b!=null;)g.unshift(b),f=b,b=f.prev;for(;_!=null;)g.push(_),h=_,_=h.next;return g}function o(d,f){var h;return(h=d.attribs)===null||h===void 0?void 0:h[f]}function u(d,f){return d.attribs!=null&&Object.prototype.hasOwnProperty.call(d.attribs,f)&&d.attribs[f]!=null}function s(d){return d.name}function c(d){for(var f,h=d.next;h!==null&&!(0,n.isTag)(h);)f=h,h=f.next;return h}function l(d){for(var f,h=d.prev;h!==null&&!(0,n.isTag)(h);)f=h,h=f.prev;return h}return traversal}var manipulation={},hasRequiredManipulation;function requireManipulation(){if(hasRequiredManipulation)return manipulation;hasRequiredManipulation=1,Object.defineProperty(manipulation,"__esModule",{value:!0}),manipulation.removeElement=n,manipulation.replaceElement=t,manipulation.appendChild=r,manipulation.append=a,manipulation.prependChild=o,manipulation.prepend=u;function n(s){if(s.prev&&(s.prev.next=s.next),s.next&&(s.next.prev=s.prev),s.parent){var c=s.parent.children,l=c.lastIndexOf(s);l>=0&&c.splice(l,1)}s.next=null,s.prev=null,s.parent=null}function t(s,c){var l=c.prev=s.prev;l&&(l.next=c);var d=c.next=s.next;d&&(d.prev=c);var f=c.parent=s.parent;if(f){var h=f.children;h[h.lastIndexOf(s)]=c,s.parent=null}}function r(s,c){if(n(c),c.next=null,c.parent=s,s.children.push(c)>1){var l=s.children[s.children.length-2];l.next=c,c.prev=l}else c.prev=null}function a(s,c){n(c);var l=s.parent,d=s.next;if(c.next=d,c.prev=s,s.next=c,c.parent=l,d){if(d.prev=c,l){var f=l.children;f.splice(f.lastIndexOf(d),0,c)}}else l&&l.children.push(c)}function o(s,c){if(n(c),c.parent=s,c.prev=null,s.children.unshift(c)!==1){var l=s.children[1];l.prev=c,c.next=l}else c.next=null}function u(s,c){n(c);var l=s.parent;if(l){var d=l.children;d.splice(d.indexOf(s),0,c)}s.prev&&(s.prev.next=c),c.parent=l,c.prev=s.prev,c.next=s,s.prev=c}return manipulation}var querying={},hasRequiredQuerying;function requireQuerying(){if(hasRequiredQuerying)return querying;hasRequiredQuerying=1,Object.defineProperty(querying,"__esModule",{value:!0}),querying.filter=t,querying.find=r,querying.findOneChild=a,querying.findOne=o,querying.existsOne=u,querying.findAll=s;var n=requireLib$3o();function t(c,l,d,f){return d===void 0&&(d=!0),f===void 0&&(f=1/0),r(c,Array.isArray(l)?l:[l],d,f)}function r(c,l,d,f){for(var h=[],v=[Array.isArray(l)?l:[l]],g=[0];;){if(g[0]>=v[0].length){if(g.length===1)return h;v.shift(),g.shift();continue}var b=v[0][g[0]++];if(c(b)&&(h.push(b),--f<=0))return h;d&&(0,n.hasChildren)(b)&&b.children.length>0&&(g.unshift(0),v.unshift(b.children))}}function a(c,l){return l.find(c)}function o(c,l,d){d===void 0&&(d=!0);for(var f=Array.isArray(l)?l:[l],h=0;h<f.length;h++){var v=f[h];if((0,n.isTag)(v)&&c(v))return v;if(d&&(0,n.hasChildren)(v)&&v.children.length>0){var g=o(c,v.children,!0);if(g)return g}}return null}function u(c,l){return(Array.isArray(l)?l:[l]).some(function(d){return(0,n.isTag)(d)&&c(d)||(0,n.hasChildren)(d)&&u(c,d.children)})}function s(c,l){for(var d=[],f=[Array.isArray(l)?l:[l]],h=[0];;){if(h[0]>=f[0].length){if(f.length===1)return d;f.shift(),h.shift();continue}var v=f[0][h[0]++];(0,n.isTag)(v)&&c(v)&&d.push(v),(0,n.hasChildren)(v)&&v.children.length>0&&(h.unshift(0),f.unshift(v.children))}}return querying}var legacy={},hasRequiredLegacy;function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1,Object.defineProperty(legacy,"__esModule",{value:!0}),legacy.testElement=s,legacy.getElements=c,legacy.getElementById=l,legacy.getElementsByTagName=d,legacy.getElementsByClassName=f,legacy.getElementsByTagType=h;var n=requireLib$3o(),t=requireQuerying(),r={tag_name:function(v){return typeof v=="function"?function(g){return(0,n.isTag)(g)&&v(g.name)}:v==="*"?n.isTag:function(g){return(0,n.isTag)(g)&&g.name===v}},tag_type:function(v){return typeof v=="function"?function(g){return v(g.type)}:function(g){return g.type===v}},tag_contains:function(v){return typeof v=="function"?function(g){return(0,n.isText)(g)&&v(g.data)}:function(g){return(0,n.isText)(g)&&g.data===v}}};function a(v,g){return typeof g=="function"?function(b){return(0,n.isTag)(b)&&g(b.attribs[v])}:function(b){return(0,n.isTag)(b)&&b.attribs[v]===g}}function o(v,g){return function(b){return v(b)||g(b)}}function u(v){var g=Object.keys(v).map(function(b){var _=v[b];return Object.prototype.hasOwnProperty.call(r,b)?r[b](_):a(b,_)});return g.length===0?null:g.reduce(o)}function s(v,g){var b=u(v);return b?b(g):!0}function c(v,g,b,_){_===void 0&&(_=1/0);var S=u(v);return S?(0,t.filter)(S,g,b,_):[]}function l(v,g,b){return b===void 0&&(b=!0),Array.isArray(g)||(g=[g]),(0,t.findOne)(a("id",v),g,b)}function d(v,g,b,_){return b===void 0&&(b=!0),_===void 0&&(_=1/0),(0,t.filter)(r.tag_name(v),g,b,_)}function f(v,g,b,_){return b===void 0&&(b=!0),_===void 0&&(_=1/0),(0,t.filter)(a("class",v),g,b,_)}function h(v,g,b,_){return b===void 0&&(b=!0),_===void 0&&(_=1/0),(0,t.filter)(r.tag_type(v),g,b,_)}return legacy}var helpers={},hasRequiredHelpers;function requireHelpers(){if(hasRequiredHelpers)return helpers;hasRequiredHelpers=1,Object.defineProperty(helpers,"__esModule",{value:!0}),helpers.DocumentPosition=void 0,helpers.removeSubsets=t,helpers.compareDocumentPosition=a,helpers.uniqueSort=o;var n=requireLib$3o();function t(u){for(var s=u.length;--s>=0;){var c=u[s];if(s>0&&u.lastIndexOf(c,s-1)>=0){u.splice(s,1);continue}for(var l=c.parent;l;l=l.parent)if(u.includes(l)){u.splice(s,1);break}}return u}var r;(function(u){u[u.DISCONNECTED=1]="DISCONNECTED",u[u.PRECEDING=2]="PRECEDING",u[u.FOLLOWING=4]="FOLLOWING",u[u.CONTAINS=8]="CONTAINS",u[u.CONTAINED_BY=16]="CONTAINED_BY"})(r||(helpers.DocumentPosition=r={}));function a(u,s){var c=[],l=[];if(u===s)return 0;for(var d=(0,n.hasChildren)(u)?u:u.parent;d;)c.unshift(d),d=d.parent;for(d=(0,n.hasChildren)(s)?s:s.parent;d;)l.unshift(d),d=d.parent;for(var f=Math.min(c.length,l.length),h=0;h<f&&c[h]===l[h];)h++;if(h===0)return r.DISCONNECTED;var v=c[h-1],g=v.children,b=c[h],_=l[h];return g.indexOf(b)>g.indexOf(_)?v===s?r.FOLLOWING|r.CONTAINED_BY:r.FOLLOWING:v===u?r.PRECEDING|r.CONTAINS:r.PRECEDING}function o(u){return u=u.filter(function(s,c,l){return!l.includes(s,c+1)}),u.sort(function(s,c){var l=a(s,c);return l&r.PRECEDING?-1:l&r.FOLLOWING?1:0}),u}return helpers}var feeds={},hasRequiredFeeds;function requireFeeds(){if(hasRequiredFeeds)return feeds;hasRequiredFeeds=1,Object.defineProperty(feeds,"__esModule",{value:!0}),feeds.getFeed=r;var n=requireStringify$1(),t=requireLegacy();function r(v){var g=l(h,v);return g?g.name==="feed"?a(g):o(g):null}function a(v){var g,b=v.children,_={type:"atom",items:(0,t.getElementsByTagName)("entry",b).map(function(w){var A,R=w.children,E={media:c(R)};f(E,"id","id",R),f(E,"title","title",R);var I=(A=l("link",R))===null||A===void 0?void 0:A.attribs.href;I&&(E.link=I);var L=d("summary",R)||d("content",R);L&&(E.description=L);var F=d("updated",R);return F&&(E.pubDate=new Date(F)),E})};f(_,"id","id",b),f(_,"title","title",b);var S=(g=l("link",b))===null||g===void 0?void 0:g.attribs.href;S&&(_.link=S),f(_,"description","subtitle",b);var T=d("updated",b);return T&&(_.updated=new Date(T)),f(_,"author","email",b,!0),_}function o(v){var g,b,_=(b=(g=l("channel",v.children))===null||g===void 0?void 0:g.children)!==null&&b!==void 0?b:[],S={type:v.name.substr(0,3),id:"",items:(0,t.getElementsByTagName)("item",v.children).map(function(w){var A=w.children,R={media:c(A)};f(R,"id","guid",A),f(R,"title","title",A),f(R,"link","link",A),f(R,"description","description",A);var E=d("pubDate",A)||d("dc:date",A);return E&&(R.pubDate=new Date(E)),R})};f(S,"title","title",_),f(S,"link","link",_),f(S,"description","description",_);var T=d("lastBuildDate",_);return T&&(S.updated=new Date(T)),f(S,"author","managingEditor",_,!0),S}var u=["url","type","lang"],s=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function c(v){return(0,t.getElementsByTagName)("media:content",v).map(function(g){for(var b=g.attribs,_={medium:b.medium,isDefault:!!b.isDefault},S=0,T=u;S<T.length;S++){var w=T[S];b[w]&&(_[w]=b[w])}for(var A=0,R=s;A<R.length;A++){var w=R[A];b[w]&&(_[w]=parseInt(b[w],10))}return b.expression&&(_.expression=b.expression),_})}function l(v,g){return(0,t.getElementsByTagName)(v,g,!0,1)[0]}function d(v,g,b){return b===void 0&&(b=!1),(0,n.textContent)((0,t.getElementsByTagName)(v,g,b,1)).trim()}function f(v,g,b,_,S){S===void 0&&(S=!1);var T=d(b,_,S);T&&(v[g]=T)}function h(v){return v==="rss"||v==="feed"||v==="rdf:RDF"}return feeds}var hasRequiredLib$3l;function requireLib$3l(){return hasRequiredLib$3l||(hasRequiredLib$3l=1,function(n){var t=lib$3l&&lib$3l.__createBinding||(Object.create?function(o,u,s,c){c===void 0&&(c=s);var l=Object.getOwnPropertyDescriptor(u,s);(!l||("get"in l?!u.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return u[s]}}),Object.defineProperty(o,c,l)}:function(o,u,s,c){c===void 0&&(c=s),o[c]=u[s]}),r=lib$3l&&lib$3l.__exportStar||function(o,u){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(u,s)&&t(u,o,s)};Object.defineProperty(n,"__esModule",{value:!0}),n.hasChildren=n.isDocument=n.isComment=n.isText=n.isCDATA=n.isTag=void 0,r(requireStringify$1(),n),r(requireTraversal(),n),r(requireManipulation(),n),r(requireQuerying(),n),r(requireLegacy(),n),r(requireHelpers(),n),r(requireFeeds(),n);var a=requireLib$3o();Object.defineProperty(n,"isTag",{enumerable:!0,get:function(){return a.isTag}}),Object.defineProperty(n,"isCDATA",{enumerable:!0,get:function(){return a.isCDATA}}),Object.defineProperty(n,"isText",{enumerable:!0,get:function(){return a.isText}}),Object.defineProperty(n,"isComment",{enumerable:!0,get:function(){return a.isComment}}),Object.defineProperty(n,"isDocument",{enumerable:!0,get:function(){return a.isDocument}}),Object.defineProperty(n,"hasChildren",{enumerable:!0,get:function(){return a.hasChildren}})}(lib$3l)),lib$3l}var hasRequiredLib$3k;function requireLib$3k(){return hasRequiredLib$3k||(hasRequiredLib$3k=1,function(n){var t=lib$3o&&lib$3o.__createBinding||(Object.create?function(T,w,A,R){R===void 0&&(R=A);var E=Object.getOwnPropertyDescriptor(w,A);(!E||("get"in E?!w.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return w[A]}}),Object.defineProperty(T,R,E)}:function(T,w,A,R){R===void 0&&(R=A),T[R]=w[A]}),r=lib$3o&&lib$3o.__setModuleDefault||(Object.create?function(T,w){Object.defineProperty(T,"default",{enumerable:!0,value:w})}:function(T,w){T.default=w}),a=lib$3o&&lib$3o.__importStar||function(T){if(T&&T.__esModule)return T;var w={};if(T!=null)for(var A in T)A!=="default"&&Object.prototype.hasOwnProperty.call(T,A)&&t(w,T,A);return r(w,T),w},o=lib$3o&&lib$3o.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomUtils=n.parseFeed=n.getFeed=n.ElementType=n.Tokenizer=n.createDomStream=n.parseDOM=n.parseDocument=n.DefaultHandler=n.DomHandler=n.Parser=void 0;var u=requireParser$2(),s=requireParser$2();Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return s.Parser}});var c=requireLib$3o(),l=requireLib$3o();Object.defineProperty(n,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(n,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function d(T,w){var A=new c.DomHandler(void 0,w);return new u.Parser(A,w).end(T),A.root}n.parseDocument=d;function f(T,w){return d(T,w).children}n.parseDOM=f;function h(T,w,A){var R=new c.DomHandler(T,w,A);return new u.Parser(R,w)}n.createDomStream=h;var v=requireTokenizer$2();Object.defineProperty(n,"Tokenizer",{enumerable:!0,get:function(){return o(v).default}}),n.ElementType=a(requireLib$3p());var g=requireLib$3l(),b=requireLib$3l();Object.defineProperty(n,"getFeed",{enumerable:!0,get:function(){return b.getFeed}});var _={xmlMode:!0};function S(T,w){return w===void 0&&(w=_),(0,g.getFeed)(f(T,w))}n.parseFeed=S,n.DomUtils=a(requireLib$3l())}(lib$3o)),lib$3o}const require$$2={"@context":{alternate:"http://www.w3.org/1999/xhtml/vocab#alternate",appendix:"http://www.w3.org/1999/xhtml/vocab#appendix",cite:"http://www.w3.org/1999/xhtml/vocab#cite",bookmark:"http://www.w3.org/1999/xhtml/vocab#bookmark",contents:"http://www.w3.org/1999/xhtml/vocab#contents",chapter:"http://www.w3.org/1999/xhtml/vocab#chapter",copyright:"http://www.w3.org/1999/xhtml/vocab#copyright",first:"http://www.w3.org/1999/xhtml/vocab#first",glossary:"http://www.w3.org/1999/xhtml/vocab#glossary",help:"http://www.w3.org/1999/xhtml/vocab#help",icon:"http://www.w3.org/1999/xhtml/vocab#icon",index:"http://www.w3.org/1999/xhtml/vocab#index",last:"http://www.w3.org/1999/xhtml/vocab#last",license:"http://www.w3.org/1999/xhtml/vocab#license",meta:"http://www.w3.org/1999/xhtml/vocab#meta",next:"http://www.w3.org/1999/xhtml/vocab#next",prev:"http://www.w3.org/1999/xhtml/vocab#prev",previous:"http://www.w3.org/1999/xhtml/vocab#previous",section:"http://www.w3.org/1999/xhtml/vocab#section",start:"http://www.w3.org/1999/xhtml/vocab#start",stylesheet:"http://www.w3.org/1999/xhtml/vocab#stylesheet",subsection:"http://www.w3.org/1999/xhtml/vocab#subsection",top:"http://www.w3.org/1999/xhtml/vocab#top",up:"http://www.w3.org/1999/xhtml/vocab#up",p3pv1:"http://www.w3.org/1999/xhtml/vocab#p3pv1"}},require$$3$1={"@context":{as:"https://www.w3.org/ns/activitystreams#",cat:"http://www.w3.org/ns/dcat#",cc:"http://creativecommons.org/ns#",cnt:"http://www.w3.org/2008/content#",csvw:"http://www.w3.org/ns/csvw#",ctag:"http://commontag.org/ns#",dc:"http://purl.org/dc/terms/",dc11:"http://purl.org/dc/elements/1.1/",dcat:"http://www.w3.org/ns/dcat#",dcterms:"http://purl.org/dc/terms/",dqv:"http://www.w3.org/ns/dqv#",duv:"https://www.w3.org/TR/vocab-duv#",earl:"http://www.w3.org/ns/earl#",foaf:"http://xmlns.com/foaf/0.1/",gldp:"http://www.w3.org/ns/people#",gr:"http://purl.org/goodrelations/v1#",grddl:"http://www.w3.org/2003/g/data-view#",ht:"http://www.w3.org/2006/http#",ical:"http://www.w3.org/2002/12/cal/icaltzd#",ldp:"http://www.w3.org/ns/ldp#",ma:"http://www.w3.org/ns/ma-ont#",oa:"http://www.w3.org/ns/oa#",odrl:"http://www.w3.org/ns/odrl/2/",og:"http://ogp.me/ns#",org:"http://www.w3.org/ns/org#",owl:"http://www.w3.org/2002/07/owl#",prov:"http://www.w3.org/ns/prov#",ptr:"http://www.w3.org/2009/pointers#",qb:"http://purl.org/linked-data/cube#",rev:"http://purl.org/stuff/rev#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfa:"http://www.w3.org/ns/rdfa#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rif:"http://www.w3.org/2007/rif#",rr:"http://www.w3.org/ns/r2rml#",schema:"http://schema.org/",sd:"http://www.w3.org/ns/sparql-service-description#",sioc:"http://rdfs.org/sioc/ns#",skos:"http://www.w3.org/2004/02/skos/core#",skosxl:"http://www.w3.org/2008/05/skos-xl#",ssn:"http://www.w3.org/ns/ssn/",sosa:"http://www.w3.org/ns/sosa/",time:"http://www.w3.org/2006/time#",v:"http://rdf.data-vocabulary.org/#",vcard:"http://www.w3.org/2006/vcard/ns#",void:"http://rdfs.org/ns/void#",wdr:"http://www.w3.org/2007/05/powder#",wdrs:"http://www.w3.org/2007/05/powder-s#",xhv:"http://www.w3.org/1999/xhtml/vocab#",xml:"http://www.w3.org/XML/1998/namespace",xsd:"http://www.w3.org/2001/XMLSchema#",describedby:"http://www.w3.org/2007/05/powder-s#describedby",license:"http://www.w3.org/1999/xhtml/vocab#license",role:"http://www.w3.org/1999/xhtml/vocab#role"}};var RdfaProfile={},hasRequiredRdfaProfile;function requireRdfaProfile(){return hasRequiredRdfaProfile||(hasRequiredRdfaProfile=1,Object.defineProperty(RdfaProfile,"__esModule",{value:!0}),RdfaProfile.RDFA_CONTENTTYPES=RdfaProfile.RDFA_FEATURES=void 0,RdfaProfile.RDFA_FEATURES={"":{baseTag:!0,xmlBase:!0,langAttribute:!0,onlyAllowUriRelRevIfProperty:!0,inheritSubjectInHeadBody:!0,datetimeAttribute:!0,timeTag:!0,htmlDatatype:!0,copyRdfaPatterns:!0,xmlnsPrefixMappings:!0,xhtmlInitialContext:!0,roleAttribute:!0},core:{baseTag:!1,xmlBase:!1,langAttribute:!0,onlyAllowUriRelRevIfProperty:!0,inheritSubjectInHeadBody:!1,datetimeAttribute:!1,timeTag:!1,htmlDatatype:!1,copyRdfaPatterns:!0,xmlnsPrefixMappings:!0,xhtmlInitialContext:!1,roleAttribute:!1},html:{baseTag:!0,xmlBase:!1,langAttribute:!0,onlyAllowUriRelRevIfProperty:!0,inheritSubjectInHeadBody:!0,datetimeAttribute:!0,timeTag:!0,htmlDatatype:!0,copyRdfaPatterns:!0,xmlnsPrefixMappings:!0,xhtmlInitialContext:!1,roleAttribute:!0},xhtml:{baseTag:!0,xmlBase:!1,langAttribute:!0,onlyAllowUriRelRevIfProperty:!0,inheritSubjectInHeadBody:!0,datetimeAttribute:!0,timeTag:!0,htmlDatatype:!0,copyRdfaPatterns:!0,xmlnsPrefixMappings:!0,xhtmlInitialContext:!0,roleAttribute:!0},xml:{baseTag:!1,xmlBase:!0,langAttribute:!0,onlyAllowUriRelRevIfProperty:!1,inheritSubjectInHeadBody:!1,datetimeAttribute:!0,timeTag:!0,htmlDatatype:!1,copyRdfaPatterns:!1,xmlnsPrefixMappings:!0,xhtmlInitialContext:!1,roleAttribute:!0}},RdfaProfile.RDFA_CONTENTTYPES={"text/html":"html","application/xhtml+xml":"xhtml","application/xml":"xml","text/xml":"xml","image/svg+xml":"xml"}),RdfaProfile}var Util$6={},hasRequiredUtil$6;function requireUtil$6(){if(hasRequiredUtil$6)return Util$6;hasRequiredUtil$6=1,Object.defineProperty(Util$6,"__esModule",{value:!0}),Util$6.Util=void 0;const n=requireRelativeToAbsoluteIri(),t=requireRdfaProfile(),r=requireRdfDataFactory();class a{constructor(u,s){this.dataFactory=u||new r.DataFactory,this.baseIRI=this.dataFactory.namedNode(s||""),this.baseIRIDocument=this.baseIRI}static parsePrefixes(u,s,c){const l={};if(c)for(const d in u)d.startsWith("xmlns")&&(l[d.substr(6)]=u[d]);if(u.prefix||Object.keys(l).length>0){const d=Object.assign(Object.assign({},s),l);if(u.prefix){let f;for(;f=a.PREFIX_REGEX.exec(u.prefix);)d[f[1]]=f[2]}return d}else return s}static expandPrefixedTerm(u,s){const c=u.indexOf(":");let l,d;if(c>=0&&(l=u.substr(0,c),d=u.substr(c+1)),l==="")return"http://www.w3.org/1999/xhtml/vocab#"+d;if(l){const f=s.prefixesAll[l];if(f)return f+d}if(u){const f=s.prefixesAll[u.toLocaleLowerCase()];if(f)return f}return u}static isValidIri(u){return a.IRI_REGEX.test(u)}static contentTypeToProfile(u){return t.RDFA_CONTENTTYPES[u]||""}getBaseIRI(u){let s=u;const c=s.indexOf("#");return c>=0&&(s=s.substr(0,c)),this.dataFactory.namedNode((0,n.resolve)(s,this.baseIRI.value))}getResourceOrBaseIri(u,s){return u===!0?this.getBaseIriTerm(s):u}getBaseIriTerm(u){return u.localBaseIRI||this.baseIRI}createVocabIris(u,s,c,l){return u.split(/\s+/).filter(d=>d&&(c||d.indexOf(":")>=0)).map(d=>this.createIri(d,s,!0,!0,l)).filter(d=>d!=null)}createLiteral(u,s){if(s.interpretObjectAsTime&&!s.datatype){for(const c of a.TIME_REGEXES)if(u.match(c.regex)){s.datatype=this.dataFactory.namedNode(a.XSD+c.type);break}}return this.dataFactory.literal(u,s.datatype||s.language)}createBlankNode(){return this.blankNodeFactory?this.blankNodeFactory():this.dataFactory.blankNode()}createIri(u,s,c,l,d){if(u=u||"",!l)return c||(u=(0,n.resolve)(u,this.getBaseIriTerm(s).value)),a.isValidIri(u)?this.dataFactory.namedNode(u):null;if(u.length>0&&u[0]==="["&&u[u.length-1]==="]"&&(u=u.substr(1,u.length-2),u.indexOf(":")<0))return null;if(u.startsWith("_:"))return d?this.dataFactory.blankNode(u.substr(2)||"b_identity"):null;if(c&&s.vocab&&u.indexOf(":")<0)return this.dataFactory.namedNode(s.vocab+u);let f=a.expandPrefixedTerm(u,s);return c?u!==f&&(f=(0,n.resolve)(f,this.baseIRIDocument.value)):f=(0,n.resolve)(f,this.getBaseIriTerm(s).value),a.isValidIri(f)?this.dataFactory.namedNode(f):null}}return Util$6.Util=a,a.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",a.XSD="http://www.w3.org/2001/XMLSchema#",a.RDFA="http://www.w3.org/ns/rdfa#",a.PREFIX_REGEX=/\s*([^:\s]*)*:\s*([^\s]*)*\s*/g,a.TIME_REGEXES=[{regex:/^-?P([0-9]+Y)?([0-9]+M)?([0-9]+D)?(T([0-9]+H)?([0-9]+M)?([0-9]+(\.[0-9])?S)?)?$/,type:"duration"},{regex:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9]((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,type:"dateTime"},{regex:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,type:"date"},{regex:/^[0-9][0-9]:[0-9][0-9]:[0-9][0-9]((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,type:"time"},{regex:/^[0-9]+-[0-9][0-9]$/,type:"gYearMonth"},{regex:/^[0-9]+$/,type:"gYear"}],a.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`]*$/,Util$6}var hasRequiredRdfaParser;function requireRdfaParser(){if(hasRequiredRdfaParser)return RdfaParser;hasRequiredRdfaParser=1,Object.defineProperty(RdfaParser,"__esModule",{value:!0}),RdfaParser.RdfaParser=void 0;const n=requireLib$3k(),t=requireBrowser(),r=require$$2,a=require$$3$1,o=requireRdfaProfile(),u=requireUtil$6();let s=class ta extends t.Transform{constructor(l){super({readableObjectMode:!0}),this.activeTagStack=[],l=l||{},this.options=l,this.util=new u.Util(l.dataFactory,l.baseIRI),this.defaultGraph=l.defaultGraph||this.util.dataFactory.defaultGraph();const d=l.contentType?u.Util.contentTypeToProfile(l.contentType):l.profile||"";this.features=l.features||o.RDFA_FEATURES[d],this.htmlParseListener=l.htmlParseListener,this.rdfaPatterns=this.features.copyRdfaPatterns?{}:null,this.pendingRdfaPatternCopies=this.features.copyRdfaPatterns?{}:null,this.parser=this.initializeParser(d==="xml"),this.activeTagStack.push({incompleteTriples:[],inlist:!1,language:l.language,listMapping:{},listMappingLocal:{},name:"",prefixesAll:Object.assign(Object.assign({},a["@context"]),this.features.xhtmlInitialContext?r["@context"]:{}),prefixesCustom:{},skipElement:!1,vocab:l.vocab})}import(l){const d=new t.PassThrough({readableObjectMode:!0});l.on("error",h=>f.emit("error",h)),l.on("data",h=>d.push(h)),l.on("end",()=>d.push(null));const f=d.pipe(new ta(this.options));return f}_transform(l,d,f){this.parser.write(l.toString()),f()}_flush(l){this.parser.end(),l()}onTagOpen(l,d){let f=this.activeTagStack.length-1;for(;f>0&&this.activeTagStack[f].skipElement;)f--;let h=this.activeTagStack[f];f!==this.activeTagStack.length-1&&(h=Object.assign(Object.assign({},h),{language:this.activeTagStack[this.activeTagStack.length-1].language,prefixesAll:this.activeTagStack[this.activeTagStack.length-1].prefixesAll,prefixesCustom:this.activeTagStack[this.activeTagStack.length-1].prefixesCustom,vocab:this.activeTagStack[this.activeTagStack.length-1].vocab}));const v={collectChildTags:h.collectChildTags,incompleteTriples:[],inlist:"inlist"in d,listMapping:[],listMappingLocal:h.listMapping,localBaseIRI:h.localBaseIRI,name:l,prefixesAll:null,prefixesCustom:null,skipElement:!1};if(this.activeTagStack.push(v),v.collectChildTags){for(const E of Object.keys(h.prefixesCustom).sort()){const I=h.prefixesCustom[E],L=E===""?"xmlns":"xmlns:"+E;L in d||(d[L]=I)}const R=Object.keys(d).map(E=>`${E}="${d[E]}"`).join(" ");if(v.text=[`<${l}${R?" "+R:""}>`],this.features.skipHandlingXmlLiteralChildren)return}let g=!0,b=!0;if(this.features.onlyAllowUriRelRevIfProperty&&("property"in d&&"rel"in d&&(g=!1,d.rel.indexOf(":")<0&&delete d.rel),"property"in d&&"rev"in d&&(b=!1,d.rev.indexOf(":")<0&&delete d.rev)),this.features.copyRdfaPatterns){if(h.collectedPatternTag){const R={attributes:d,children:[],name:l,referenced:!1,rootPattern:!1,text:[]};h.collectedPatternTag.children.push(R),v.collectedPatternTag=R;return}if(d.typeof==="rdfa:Pattern"){v.collectedPatternTag={attributes:d,children:[],name:l,parentTag:h,referenced:!1,rootPattern:!0,text:[]};return}if(d.property==="rdfa:copy"){const R=d.resource||d.href||d.src;this.rdfaPatterns[R]?this.emitPatternCopy(h,this.rdfaPatterns[R],R):(this.pendingRdfaPatternCopies[R]||(this.pendingRdfaPatternCopies[R]=[]),this.pendingRdfaPatternCopies[R].push(h));return}}this.features.baseTag&&l==="base"&&d.href&&(this.util.baseIRI=this.util.getBaseIRI(d.href)),this.features.xmlBase&&d["xml:base"]&&(v.localBaseIRI=this.util.getBaseIRI(d["xml:base"])),this.features.timeTag&&l==="time"&&!d.datatype&&(v.interpretObjectAsTime=!0);let _,S,T;if("vocab"in d?d.vocab?(v.vocab=d.vocab,this.emitTriple(this.util.getBaseIriTerm(v),this.util.dataFactory.namedNode(u.Util.RDFA+"usesVocabulary"),this.util.dataFactory.namedNode(v.vocab))):v.vocab=this.activeTagStack[0].vocab:v.vocab=h.vocab,v.prefixesCustom=u.Util.parsePrefixes(d,h.prefixesCustom,this.features.xmlnsPrefixMappings),v.prefixesAll=Object.keys(v.prefixesCustom).length>0?Object.assign(Object.assign({},h.prefixesAll),v.prefixesCustom):h.prefixesAll,this.features.roleAttribute&&d.role){const R=d.id?this.util.createIri("#"+d.id,v,!1,!1,!1):this.util.createBlankNode(),E=v.vocab;v.vocab="http://www.w3.org/1999/xhtml/vocab#";for(const I of this.util.createVocabIris(d.role,v,!0,!1))this.emitTriple(R,this.util.dataFactory.namedNode("http://www.w3.org/1999/xhtml/vocab#role"),I);v.vocab=E}"xml:lang"in d||this.features.langAttribute&&"lang"in d?v.language=d["xml:lang"]||d.lang:v.language=h.language;const w=this.activeTagStack.length===2;if(!("rel"in d)&&!("rev"in d)?"property"in d&&!("content"in d)&&!("datatype"in d)?("about"in d?(_=this.util.createIri(d.about,v,!1,!0,!0),v.explicitNewSubject=!!_):w?_=!0:h.object&&(_=h.object),"typeof"in d&&("about"in d&&(T=this.util.createIri(d.about,v,!1,!0,!0)),!T&&w&&(T=!0),!T&&"resource"in d&&(T=this.util.createIri(d.resource,v,!1,!0,!0)),!T&&("href"in d||"src"in d)&&(T=this.util.createIri(d.href||d.src,v,!1,!1,!0)),!T&&this.isInheritSubjectInHeadBody(l)&&(T=_),T||(T=this.util.createBlankNode()),S=T)):(("about"in d||"resource"in d)&&(_=this.util.createIri(d.about||d.resource,v,!1,!0,!0),v.explicitNewSubject=!!_),!_&&("href"in d||"src"in d)&&(_=this.util.createIri(d.href||d.src,v,!1,!1,!0),v.explicitNewSubject=!!_),_||(w?_=!0:this.isInheritSubjectInHeadBody(l)?_=h.object:"typeof"in d?(_=this.util.createBlankNode(),v.explicitNewSubject=!0):h.object&&(_=h.object,"property"in d||(v.skipElement=!0))),"typeof"in d&&(T=_)):("about"in d?(_=this.util.createIri(d.about,v,!1,!0,!0),v.explicitNewSubject=!!_,"typeof"in d&&(T=_)):w?_=!0:h.object&&(_=h.object),"resource"in d&&(S=this.util.createIri(d.resource,v,!1,!0,!0)),S||("href"in d||"src"in d?S=this.util.createIri(d.href||d.src,v,!1,!1,!0):"typeof"in d&&!("about"in d)&&!this.isInheritSubjectInHeadBody(l)&&(S=this.util.createBlankNode())),"typeof"in d&&!("about"in d)&&(this.isInheritSubjectInHeadBody(l)?T=_:T=S)),T)for(const R of this.util.createVocabIris(d.typeof,v,!0,!0))this.emitTriple(this.util.getResourceOrBaseIri(T,v),this.util.dataFactory.namedNode(u.Util.RDF+"type"),R);if(_&&(v.listMapping={}),S){if("rel"in d&&"inlist"in d)for(const R of this.util.createVocabIris(d.rel,v,g,!1))this.addListMapping(v,_,R,S);if(!("rel"in d&&"inlist"in d)){if("rel"in d)for(const R of this.util.createVocabIris(d.rel,v,g,!1))this.emitTriple(this.util.getResourceOrBaseIri(_,v),R,this.util.getResourceOrBaseIri(S,v));if("rev"in d)for(const R of this.util.createVocabIris(d.rev,v,b,!1))this.emitTriple(this.util.getResourceOrBaseIri(S,v),R,this.util.getResourceOrBaseIri(_,v))}}if(!S){if("rel"in d)if("inlist"in d)for(const R of this.util.createVocabIris(d.rel,v,g,!1))this.addListMapping(v,_,R,null),v.incompleteTriples.push({predicate:R,reverse:!1,list:!0});else for(const R of this.util.createVocabIris(d.rel,v,g,!1))v.incompleteTriples.push({predicate:R,reverse:!1});if("rev"in d)for(const R of this.util.createVocabIris(d.rev,v,b,!1))v.incompleteTriples.push({predicate:R,reverse:!0});v.incompleteTriples.length>0&&(S=this.util.createBlankNode())}if("property"in d){v.predicates=this.util.createVocabIris(d.property,v,!0,!1);let R;if("datatype"in d?(v.datatype=this.util.createIri(d.datatype,v,!0,!0,!1),v.datatype&&(v.datatype.value===u.Util.RDF+"XMLLiteral"||this.features.htmlDatatype&&v.datatype.value===u.Util.RDF+"HTML")&&(v.collectChildTags=!0)):(!("rev"in d)&&!("rel"in d)&&!("content"in d)&&("resource"in d&&(R=this.util.createIri(d.resource,v,!1,!0,!0)),!R&&"href"in d&&(R=this.util.createIri(d.href,v,!1,!1,!0)),!R&&"src"in d&&(R=this.util.createIri(d.src,v,!1,!1,!0))),"typeof"in d&&!("about"in d)&&(R=T)),"content"in d){const E=this.util.createLiteral(d.content,v);if("inlist"in d)for(const I of v.predicates)this.addListMapping(v,_,I,E);else{const I=this.util.getResourceOrBaseIri(_,v);for(const L of v.predicates)this.emitTriple(I,L,E)}v.predicates=null}else if(this.features.datetimeAttribute&&"datetime"in d){v.interpretObjectAsTime=!0;const E=this.util.createLiteral(d.datetime,v);if("inlist"in d)for(const I of v.predicates)this.addListMapping(v,_,I,E);else{const I=this.util.getResourceOrBaseIri(_,v);for(const L of v.predicates)this.emitTriple(I,L,E)}v.predicates=null}else if(R){const E=this.util.getResourceOrBaseIri(R,v);if("inlist"in d)for(const I of v.predicates)this.addListMapping(v,_,I,E);else{const I=this.util.getResourceOrBaseIri(_,v);for(const L of v.predicates)this.emitTriple(I,L,E)}v.predicates=null}}let A=!1;if(!v.skipElement&&_&&h.incompleteTriples.length>0){A=!0;const R=this.util.getResourceOrBaseIri(h.subject,v),E=this.util.getResourceOrBaseIri(_,v);for(const I of h.incompleteTriples)if(I.reverse)this.emitTriple(E,I.predicate,R);else if(I.list){let L=null;for(let F=this.activeTagStack.length-1;F>=0;F--)if(this.activeTagStack[F].inlist){L=this.activeTagStack[F];break}this.addListMapping(L,_,I.predicate,E)}else this.emitTriple(R,I.predicate,E)}!A&&h.incompleteTriples.length>0&&(v.incompleteTriples=v.incompleteTriples.concat(h.incompleteTriples)),v.subject=_||h.subject,v.object=S||_}onText(l){const d=this.activeTagStack[this.activeTagStack.length-1];if(this.features.copyRdfaPatterns&&d.collectedPatternTag){d.collectedPatternTag.text.push(l);return}d.text||(d.text=[]),d.text.push(l)}onTagClose(){const l=this.activeTagStack[this.activeTagStack.length-1],d=this.activeTagStack[this.activeTagStack.length-2];if(!(l.collectChildTags&&d.collectChildTags&&this.features.skipHandlingXmlLiteralChildren)){if(this.features.copyRdfaPatterns&&l.collectedPatternTag&&l.collectedPatternTag.rootPattern){const f=l.collectedPatternTag.attributes.resource;if(delete l.collectedPatternTag.attributes.resource,delete l.collectedPatternTag.attributes.typeof,this.rdfaPatterns[f]=l.collectedPatternTag,this.pendingRdfaPatternCopies[f]){for(const h of this.pendingRdfaPatternCopies[f])this.emitPatternCopy(h,l.collectedPatternTag,f);delete this.pendingRdfaPatternCopies[f]}this.activeTagStack.pop();return}if(l.predicates){const f=this.util.getResourceOrBaseIri(l.subject,l);let h=l.text||[];l.collectChildTags&&d.collectChildTags&&(h=h.slice(1));const v=this.util.createLiteral(h.join(""),l);if(l.inlist)for(const g of l.predicates)this.addListMapping(l,f,g,v);else for(const g of l.predicates)this.emitTriple(f,g,v);d.predicates||(l.text=null)}if(l.object&&Object.keys(l.listMapping).length>0){const f=this.util.getResourceOrBaseIri(l.object,l);for(const h in l.listMapping){const v=this.util.dataFactory.namedNode(h),g=l.listMapping[h];if(g.length>0){const b=g.map(()=>this.util.createBlankNode());for(let _=0;_<g.length;_++){const S=this.util.getResourceOrBaseIri(g[_],l);this.emitTriple(b[_],this.util.dataFactory.namedNode(u.Util.RDF+"first"),S),this.emitTriple(b[_],this.util.dataFactory.namedNode(u.Util.RDF+"rest"),_<g.length-1?b[_+1]:this.util.dataFactory.namedNode(u.Util.RDF+"nil"))}this.emitTriple(f,v,b[0])}else this.emitTriple(f,v,this.util.dataFactory.namedNode(u.Util.RDF+"nil"))}}}this.activeTagStack.pop(),l.collectChildTags&&l.text&&l.text.push(`</${l.name}>`),l.text&&d&&(d.text?d.text=d.text.concat(l.text):d.text=l.text)}onEnd(){if(this.features.copyRdfaPatterns){this.features.copyRdfaPatterns=!1;for(const l in this.rdfaPatterns){const d=this.rdfaPatterns[l];d.referenced||(d.attributes.typeof="rdfa:Pattern",d.attributes.resource=l,this.emitPatternCopy(d.parentTag,d,l),d.referenced=!1,delete d.attributes.typeof,delete d.attributes.resource)}for(const l in this.pendingRdfaPatternCopies)for(const d of this.pendingRdfaPatternCopies[l])this.activeTagStack.push(d),this.onTagOpen("link",{property:"rdfa:copy",href:l}),this.onTagClose(),this.activeTagStack.pop();this.features.copyRdfaPatterns=!0}}isInheritSubjectInHeadBody(l){return this.features.inheritSubjectInHeadBody&&(l==="head"||l==="body")}addListMapping(l,d,f,h){if(l.explicitNewSubject){const v=this.util.createBlankNode();this.emitTriple(this.util.getResourceOrBaseIri(d,l),f,v),this.emitTriple(v,this.util.dataFactory.namedNode(u.Util.RDF+"first"),this.util.getResourceOrBaseIri(h,l)),this.emitTriple(v,this.util.dataFactory.namedNode(u.Util.RDF+"rest"),this.util.dataFactory.namedNode(u.Util.RDF+"nil"))}else{let v=l.listMappingLocal[f.value];v||(l.listMappingLocal[f.value]=v=[]),h&&v.push(h)}}emitTriple(l,d,f){l.termType==="NamedNode"&&l.value.indexOf(":")<0||d.termType==="NamedNode"&&d.value.indexOf(":")<0||f.termType==="NamedNode"&&f.value.indexOf(":")<0||this.push(this.util.dataFactory.quad(l,d,f,this.defaultGraph))}emitPatternCopy(l,d,f){if(this.activeTagStack.push(l),d.referenced=!0,!d.constructedBlankNodes)d.constructedBlankNodes=[],this.util.blankNodeFactory=()=>{const h=this.util.dataFactory.blankNode();return d.constructedBlankNodes.push(h),h};else{let h=0;this.util.blankNodeFactory=()=>d.constructedBlankNodes[h++]}this.emitPatternCopyAbsolute(d,!0,f),this.util.blankNodeFactory=null,this.activeTagStack.pop()}emitPatternCopyAbsolute(l,d,f){if(!(!d&&l.attributes.property==="rdfa:copy"&&l.attributes.href===f)){this.onTagOpen(l.name,l.attributes);for(const h of l.text)this.onText(h);for(const h of l.children)this.emitPatternCopyAbsolute(h,!1,f);this.onTagClose()}}initializeParser(l){return new n.Parser({onclosetag:()=>{try{this.onTagClose(),this.htmlParseListener&&this.htmlParseListener.onTagClose()}catch(d){this.emit("error",d)}},onend:()=>{try{this.onEnd(),this.htmlParseListener&&this.htmlParseListener.onEnd()}catch(d){this.emit("error",d)}},onopentag:(d,f)=>{try{this.onTagOpen(d,f),this.htmlParseListener&&this.htmlParseListener.onTagOpen(d,f)}catch(h){this.emit("error",h)}},ontext:d=>{try{this.onText(d),this.htmlParseListener&&this.htmlParseListener.onText(d)}catch(f){this.emit("error",f)}}},{decodeEntities:!0,recognizeSelfClosing:!0,xmlMode:l})}};return RdfaParser.RdfaParser=s,RdfaParser}var hasRequiredRdfaStreamingParser;function requireRdfaStreamingParser(){return hasRequiredRdfaStreamingParser||(hasRequiredRdfaStreamingParser=1,function(n){var t=rdfaStreamingParser&&rdfaStreamingParser.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfaStreamingParser&&rdfaStreamingParser.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireIActiveTag(),n),r(requireIHtmlParseListener$1(),n),r(requireIRdfaPattern(),n),r(requireRdfaParser(),n),r(requireRdfaProfile(),n),r(requireUtil$6(),n)}(rdfaStreamingParser)),rdfaStreamingParser}var hasRequiredActorRdfParseXmlRdfa;function requireActorRdfParseXmlRdfa(){if(hasRequiredActorRdfParseXmlRdfa)return ActorRdfParseXmlRdfa;hasRequiredActorRdfParseXmlRdfa=1,Object.defineProperty(ActorRdfParseXmlRdfa,"__esModule",{value:!0}),ActorRdfParseXmlRdfa.ActorRdfParseXmlRdfa=void 0;const n=requireLib$3s(),t=requireLib$4q(),r=requireRdfaStreamingParser();let a=class extends n.ActorRdfParseFixedMediaTypes{constructor(u){super(u)}async runHandle(u,s,c){var h;const l=u.context.getSafe(t.KeysInitQuery.dataFactory),d=(u.headers&&u.headers.get("content-language"))??void 0;u.data.on("error",v=>f.emit("error",v));const f=u.data.pipe(new r.RdfaParser({dataFactory:l,baseIRI:(h=u.metadata)==null?void 0:h.baseIRI,profile:"xml",language:d}));return{data:f,metadata:{triples:!0}}}};return ActorRdfParseXmlRdfa.ActorRdfParseXmlRdfa=a,ActorRdfParseXmlRdfa}var hasRequiredLib$3j;function requireLib$3j(){return hasRequiredLib$3j||(hasRequiredLib$3j=1,function(n){var t=lib$3p&&lib$3p.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3p&&lib$3p.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseXmlRdfa(),n)}(lib$3p)),lib$3p}var lib$3i={},ActorRdfParseShaclc={},dist$5={},dist$4={},hasRequiredDist$4;function requireDist$4(){if(hasRequiredDist$4)return dist$4;hasRequiredDist$4=1,Object.defineProperty(dist$4,"__esModule",{value:!0}),dist$4.promisifyEventEmitter=void 0;function n(t,r){return new Promise((a,o)=>{t.on("end",()=>a(r)),t.on("error",o)})}return dist$4.promisifyEventEmitter=n,dist$4}var hasRequiredDist$3;function requireDist$3(){if(hasRequiredDist$3)return dist$5;hasRequiredDist$3=1;var n=dist$5&&dist$5.__awaiter||function(a,o,u,s){function c(l){return l instanceof u?l:new u(function(d){d(l)})}return new(u||(u=Promise))(function(l,d){function f(g){try{v(s.next(g))}catch(b){d(b)}}function h(g){try{v(s.throw(g))}catch(b){d(b)}}function v(g){g.done?l(g.value):c(g.value).then(f,h)}v((s=s.apply(a,o||[])).next())})};Object.defineProperty(dist$5,"__esModule",{value:!0}),dist$5.stringify=r;const t=requireDist$4();function r(a){return n(this,void 0,void 0,function*(){let o="";return a.on("data",u=>{o+=u}),yield(0,t.promisifyEventEmitter)(a),o})}return dist$5}var lib$3h={},ShaclcParser_1,hasRequiredShaclcParser;function requireShaclcParser(){if(hasRequiredShaclcParser)return ShaclcParser_1;hasRequiredShaclcParser=1;var n=function(){var t=function(ct,Xe,Ye,nt){for(Ye=Ye||{},nt=ct.length;nt--;Ye[ct[nt]]=Xe);return Ye},r=[7,12,13,14,15,16,20,25,115,130],a=[7,13,16,20,25,115,130],o=[7,13,16,115,130],u=[1,25],s=[1,29],c=[1,27],l=[1,28],d=[13,16,115,130],f=[13,16,28,38,40,42,44,46,48,53,56,61,67,85,87,92,93,95,96,102,110,111,115,119,120,126,128,129,130,131,132,133,134,135,136],h=[28,56],v=[1,42],g=[46,48,53,56],b=[1,54],_=[1,60],S=[1,56],T=[1,57],w=[1,58],A=[1,63],R=[1,64],E=[1,65],I=[1,66],L=[1,67],F=[1,68],D=[1,75],$=[28,46,48,53,56],O=[28,42,46,48,53,56],P=[13,16,28,38,40,42,44,46,48,53,56,92,115,119,120,130,131,132,133,134,135,136],C=[13,16,28,38,40,42,44,46,48,53,56,67,85,87,92,95,96,115,119,120,126,128,129,130,131,132,133,134,135,136],q=[13,16,38,40,44,92,115,119,120,130,131,132,133,134,135,136],M=[13,16,28,38,40,42,44,46,48,53,56,67,85,87,92,95,96,115,117,118,119,120,126,128,129,130,131,132,133,134,135,136],N=[13,16,28,56,115,130],G=[13,16,38,58,87,96,109,115,126,130],X=[1,116],Y=[1,112],W=[1,108],te=[1,114],ue=[1,111],fe=[7,13,16,20,25,44,48,53,56,67,85,87,95,96,115,128,129,130],re=[48,53],ye=[48,53,87,96,126],Te=[13,16,44,48,53,56,85,87,95,96,115,128,129,130],Re=[1,126],ve=[13,16,40,44,48,53,56,85,87,95,96,115,128,129,130],ce=[1,129],J=[48,53,67,87,96,126],j=[13,16,40,44,48,53,56,67,85,87,95,96,115,128,129,130],z=[1,133],B=[13,16,40,44,48,53,56,67,85,87,95,96,102,115,128,129,130],U=[13,16,40,44,48,53,56,67,85,87,93,95,96,102,110,111,115,128,129,130],Z=[1,151],oe=[1,153],ie=[1,156],se=[1,157],ne=[1,158],he=[1,167],xe=[1,175],me=[13,16,44,48,53,56,67,85,87,95,96,115,128,129,130],Ie=[13,16,44,48,53,56,67,85,87,95,96,115,126,128,129,130],Pe=[13,16,46,92,115,119,120,130,131,132,133,134,135,136],Ce={trace:function(){},yy:{},symbols_:{error:2,shaclDoc:3,shaclDoc_repetition0:4,shaclDoc_repetition1:5,ttlSection:6,EOF:7,directive:8,baseDecl:9,importsDecl:10,prefixDecl:11,KW_BASE:12,IRIREF:13,KW_IMPORTS:14,KW_PREFIX:15,PNAME_NS:16,nodeShapeIri:17,iri:18,nodeShape:19,KW_SHAPE:20,nodeShape_option0:21,nodeShape_option1:22,nodeShapeBody:23,shapeClass:24,KW_SHAPE_CLASS:25,shapeClass_option0:26,turtleAnnotation:27,";":28,turtleAnnotation2:29,predicate:30,turtleAnnotation2_option0:31,objectList:32,object:33,objectList_repetition0:34,iriOrLiteral:35,blankNodeSection:36,list:37,"(":38,list_repetition0:39,")":40,objectTail:41,",":42,LB:43,"[":44,RB:45,"]":46,LP:47,"%":48,RP:49,pcSection:50,iriHead:51,ttlStatement:52,".":53,ttlSection_repetition0:54,startNodeShape:55,"{":56,endNodeShape:57,"}":58,nodeShapeBody_repetition0:59,targetClass:60,"->":61,targetClass_repetition_plus0:62,constraint:63,constraint_group0:64,constraint_option0:65,orNotComponent:66,"|":67,nodeNot:68,nodeOrEmit:69,nodeOr:70,nodeOr_repetition_plus0:71,nodeValue:72,negation:73,nodeValue_group0:74,"=":75,iriOrLiteralOrArray:76,propertyShape:77,path:78,propertyShape_repetition0:79,propertyOrComponent:80,propertyNot:81,propertyOr:82,propertyOr_repetition_plus0:83,propertyAtom:84,NODEKIND:85,shapeRef:86,PARAM:87,propertyCount:88,propertyMinCount:89,"..":90,propertyMaxCount:91,INTEGER:92,"*":93,shapeRef_group0:94,"@":95,"!":96,pathAlternative:97,additionalAlternative:98,pathSequence:99,pathAlternative_repetition_plus0:100,additionalSequence:101,"/":102,pathEltOrInverse:103,pathSequence_repetition_plus0:104,pathElt:105,pathPrimary:106,pathMod:107,pathInverse:108,"^":109,"?":110,"+":111,iriOrLiteralOrArray_repetition0:112,literal:113,iri_group0:114,a:115,string:116,LANGTAG:117,"^^":118,DECIMAL:119,DOUBLE:120,literal_group0:121,string_group0:122,string_group1:123,shaclDoc_repetition1_group0:124,constraint_group0_repetition_plus0:125,TARGET:126,propertyShape_repetition0_group0:127,ATPNAME_LN:128,ATPNAME_NS:129,PNAME_LN:130,KW_TRUE:131,KW_FALSE:132,STRING_LITERAL1:133,STRING_LITERAL2:134,STRING_LITERAL_LONG1:135,STRING_LITERAL_LONG2:136,$accept:0,$end:1},terminals_:{2:"error",7:"EOF",12:"KW_BASE",13:"IRIREF",14:"KW_IMPORTS",15:"KW_PREFIX",16:"PNAME_NS",20:"KW_SHAPE",25:"KW_SHAPE_CLASS",28:";",38:"(",40:")",42:",",44:"[",46:"]",48:"%",53:".",56:"{",58:"}",61:"->",67:"|",75:"=",85:"NODEKIND",87:"PARAM",90:"..",92:"INTEGER",93:"*",95:"@",96:"!",102:"/",109:"^",110:"?",111:"+",115:"a",117:"LANGTAG",118:"^^",119:"DECIMAL",120:"DOUBLE",126:"TARGET",128:"ATPNAME_LN",129:"ATPNAME_NS",130:"PNAME_LN",131:"KW_TRUE",132:"KW_FALSE",133:"STRING_LITERAL1",134:"STRING_LITERAL2",135:"STRING_LITERAL_LONG1",136:"STRING_LITERAL_LONG2"},productions_:[0,[3,4],[8,1],[8,1],[8,1],[9,2],[10,2],[11,3],[17,1],[19,5],[24,4],[27,2],[29,2],[30,2],[32,2],[33,1],[33,1],[33,1],[37,3],[41,2],[43,1],[45,1],[36,3],[47,1],[49,1],[50,3],[51,1],[52,3],[6,1],[55,1],[57,1],[23,3],[60,2],[63,3],[66,2],[69,1],[70,1],[70,2],[68,1],[68,2],[72,3],[77,2],[80,2],[82,1],[82,2],[81,1],[81,2],[84,1],[84,1],[84,1],[84,3],[84,1],[88,5],[89,1],[91,1],[91,1],[86,1],[86,2],[73,1],[78,1],[98,2],[97,1],[97,2],[101,2],[99,1],[99,2],[105,1],[105,2],[103,1],[103,2],[108,1],[107,1],[107,1],[107,1],[106,1],[106,3],[76,1],[76,3],[35,1],[35,1],[18,1],[18,1],[18,1],[113,1],[113,2],[113,3],[113,1],[113,1],[113,1],[113,1],[116,1],[116,1],[4,0],[4,2],[124,1],[124,1],[5,0],[5,2],[21,0],[21,1],[22,0],[22,1],[26,0],[26,1],[31,0],[31,1],[34,0],[34,2],[39,0],[39,2],[54,0],[54,2],[59,0],[59,2],[62,1],[62,2],[125,1],[125,2],[64,1],[64,1],[65,0],[65,1],[71,1],[71,2],[74,1],[74,1],[127,1],[127,1],[79,0],[79,2],[83,1],[83,2],[94,1],[94,1],[100,1],[100,2],[104,1],[104,2],[112,0],[112,2],[114,1],[114,1],[121,1],[121,1],[122,1],[122,1],[123,1],[123,1]],performAction:function(Xe,Ye,nt,gt,ut,tt,Ct){var Ze=tt.length-1;switch(ut){case 1:this.$=Ae(Ge.factory.namedNode(je("")),Ge.factory.namedNode(H),Ge.factory.namedNode(Ne+"Ontology"));break;case 5:Ge.base=Ge.factory.namedNode(tt[Ze].slice(1,-1)),Ge.n3Parser._setBase(Ge.base.value);break;case 6:this.$=Ae(Ge.base,Ge.factory.namedNode(Ne+"imports"),Ge.factory.namedNode(tt[Ze].slice(1,-1)));break;case 7:this.$=Ge.prefixes[tt[Ze-1].substr(0,tt[Ze-1].length-1)]=je(tt[Ze]);break;case 8:Ge.nodeShapeStack=!1,Ae(Ge.currentNodeShape=tt[Ze],Ge.factory.namedNode(H),Ge.factory.namedNode(Fe+"NodeShape"));break;case 10:this.$=Ae(Ge.currentNodeShape,Ge.factory.namedNode(H),Ge.factory.namedNode(de+"Class"));break;case 11:this.$=We();break;case 13:this.$=tt[Ze].forEach(Be=>Ae(Ge.currentNodeShape,tt[Ze-1],Be));break;case 14:this.$=[tt[Ze-1],...tt[Ze]];break;case 18:this.$=$e(tt[Ze-1],!0);break;case 19:case 34:case 42:case 60:case 63:this.$=tt[Ze];break;case 20:Ge.tempCurrentNodeShape=Ge.currentNodeShape,this.$=Ge.currentNodeShape=Ke();break;case 21:Ge.currentNodeShape=Ge.tempCurrentNodeShape;break;case 22:case 31:this.$=tt[Ze-2];break;case 23:Ge.tempCurrentNodeShape=Ge.currentNodeShape,Ge.currentNodeShape=Ge.currentPropertyNode;break;case 24:Ge.currentNodeShape=Ge.tempCurrentNodeShape;break;case 26:Ge.currentNodeShape=tt[Ze];break;case 29:Ge.nodeShapeStack?(Ge.nodeShapeStack.push(Ge.currentNodeShape),Ae(Ge.currentPropertyNode,Ge.factory.namedNode(Fe+"node"),Ge.currentNodeShape=Ke())):Ge.nodeShapeStack=[],this.$=Ge.currentNodeShape;break;case 30:Ge.nodeShapeStack.length>0&&(Ge.currentNodeShape=Ge.nodeShapeStack.pop());break;case 32:this.$=tt[Ze].forEach(Be=>{Ae(Ge.currentNodeShape,Ge.factory.namedNode(Fe+"targetClass"),Be)});break;case 35:this.$=Ae(Ge.currentNodeShape,Ge.factory.namedNode(Fe+tt[Ze][0]),tt[Ze][1]);break;case 36:break;case 37:const Ee=$e([tt[Ze-1],...tt[Ze]].map(Be=>{const it=Ke();return Ae(it,Ge.factory.namedNode(Fe+Be[0]),Be[1]),it}));this.$=["or",Ee];break;case 39:case 46:this.$=Ue("not",...tt[Ze]);break;case 40:case 50:this.$=[tt[Ze-2],tt[Ze]];break;case 43:this.$=tt[Ze]&&Ve(...tt[Ze]);break;case 44:this.$=Ve("or",$e([tt[Ze-1],...tt[Ze]].map(Be=>{const it=Ke();return Ae(it,Ge.factory.namedNode(Fe+Be[0]),Be[1]),it})));break;case 47:this.$=[Le[tt[Ze].value]?"datatype":"class",tt[Ze]];break;case 48:this.$=["nodeKind",Ge.factory.namedNode(Fe+tt[Ze])];break;case 49:this.$=["node",Ge.factory.namedNode(tt[Ze])];break;case 51:this.$=void 0;break;case 53:this.$=tt[Ze]>0&&Ve("minCount",ze(tt[Ze],be));break;case 54:this.$=Ve("maxCount",ze(tt[Ze],be));break;case 56:this.$=Me(tt[Ze].slice(1));break;case 57:this.$=je(tt[Ze]);break;case 59:Ae(Ge.currentNodeShape,Ge.factory.namedNode(Fe+"property"),Ge.currentPropertyNode=Ke()),Ve("path",tt[Ze]);break;case 62:const qe=Ke();Ae(qe,Ge.factory.namedNode(Fe+"alternativePath"),$e([tt[Ze-1],...tt[Ze]])),this.$=qe;break;case 65:this.$=$e([tt[Ze-1],...tt[Ze]]);break;case 67:Ae(this.$=Ke(),Ge.factory.namedNode(Fe+tt[Ze]),tt[Ze-1]);break;case 69:Ae(this.$=Ke(),Ge.factory.namedNode(Fe+"inversePath"),tt[Ze]);break;case 71:this.$="zeroOrOnePath";break;case 72:this.$="zeroOrMorePath";break;case 73:this.$="oneOrMorePath";break;case 75:this.$=tt[Ze-1];break;case 77:this.$=$e(tt[Ze-1]);break;case 80:this.$=Ge.factory.namedNode(je(tt[Ze]));break;case 81:this.$=Ge.factory.namedNode(Me(tt[Ze]));break;case 82:this.$=We(Ge.factory.namedNode(H));break;case 83:this.$=ze(tt[Ze]);break;case 84:this.$=Je(tt[Ze-1],lowercase(tt[Ze].substr(1)));break;case 85:this.$=ze(tt[Ze-2],tt[Ze]);break;case 86:this.$=ze(tt[Ze],be);break;case 87:this.$=ze(tt[Ze],le);break;case 88:this.$=ze(tt[Ze].toLowerCase(),we);break;case 89:this.$=ze(tt[Ze].toLowerCase(),De);break;case 90:this.$=_e(tt[Ze],1);break;case 91:this.$=_e(tt[Ze],3);break;case 92:case 96:case 106:case 108:case 110:case 112:case 128:case 138:this.$=[];break;case 93:case 97:case 107:case 109:case 111:case 113:case 115:case 117:case 123:case 129:case 131:case 135:case 137:case 139:tt[Ze-1].push(tt[Ze]);break;case 114:case 116:case 122:case 130:case 134:case 136:this.$=[tt[Ze]];break}},table:[t(r,[2,92],{3:1,4:2}),{1:[3]},t(a,[2,96],{5:3,8:4,9:5,10:6,11:7,12:[1,8],14:[1,9],15:[1,10]}),t(o,[2,110],{6:11,124:12,54:13,19:14,24:15,20:[1,16],25:[1,17]}),t(r,[2,93]),t(r,[2,2]),t(r,[2,3]),t(r,[2,4]),{13:[1,18]},{13:[1,19]},{16:[1,20]},{7:[1,21]},t(a,[2,97]),{7:[2,28],13:u,16:s,18:24,51:23,52:22,114:26,115:c,130:l},t(a,[2,94]),t(a,[2,95]),{13:u,16:s,17:30,18:31,114:26,115:c,130:l},{13:u,16:s,17:32,18:31,114:26,115:c,130:l},t(r,[2,5]),t(r,[2,6]),{13:[1,33]},{1:[2,1]},t(o,[2,111]),{13:u,16:s,18:36,29:34,30:35,114:26,115:c,130:l},t(d,[2,26]),t(f,[2,80]),t(f,[2,81]),t(f,[2,82]),t(f,[2,140]),t(f,[2,141]),t(h,[2,98],{21:37,60:38,61:[1,39]}),t([28,56,61],[2,8]),{26:40,27:41,28:v,56:[2,102]},t(r,[2,7]),{53:[1,43]},t(g,[2,104],{31:44,27:45,28:v}),{13:u,16:s,18:51,32:46,33:47,35:48,36:49,37:50,38:b,43:53,44:_,92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},{22:69,27:70,28:v,56:[2,100]},t(h,[2,99]),{13:u,16:s,18:72,62:71,114:26,115:c,130:l},{23:73,55:74,56:D},{56:[2,103]},{13:u,16:s,18:36,29:76,30:35,114:26,115:c,130:l},t(o,[2,27]),t(g,[2,12]),t(g,[2,105]),t($,[2,13]),t(O,[2,106],{34:77}),t(P,[2,15]),t(P,[2,16]),t(P,[2,17]),t(C,[2,78]),t(C,[2,79]),{13:u,16:s,18:36,29:78,30:35,114:26,115:c,130:l},t(q,[2,108],{39:79}),t(C,[2,83],{117:[1,80],118:[1,81]}),t(C,[2,86]),t(C,[2,87]),t(C,[2,88]),t(C,[2,89]),t(d,[2,20]),t(M,[2,90]),t(M,[2,91]),t(C,[2,142]),t(C,[2,143]),t(M,[2,144]),t(M,[2,145]),t(M,[2,146]),t(M,[2,147]),{23:82,55:74,56:D},{56:[2,101]},t(h,[2,32],{114:26,18:83,13:u,16:s,115:c,130:l}),t(N,[2,114]),t(a,[2,10]),t(G,[2,112],{59:84}),t(G,[2,29]),t(g,[2,11]),t($,[2,14],{41:85,42:[1,86]}),{45:87,46:[1,88]},{13:u,16:s,18:51,33:90,35:48,36:49,37:50,38:b,40:[1,89],43:53,44:_,92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},t(C,[2,84]),{13:u,16:s,18:91,114:26,115:c,130:l},t(a,[2,9]),t(N,[2,115]),{13:u,16:s,18:115,38:X,57:92,58:[1,94],63:93,64:95,68:102,69:98,70:100,72:104,73:105,74:107,77:97,78:99,87:Y,96:W,97:101,99:103,103:106,105:109,106:113,108:110,109:te,114:26,115:c,125:96,126:ue,130:l},t(O,[2,107]),{13:u,16:s,18:51,33:117,35:48,36:49,37:50,38:b,43:53,44:_,92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},t(P,[2,22]),t(P,[2,21]),t(P,[2,18]),t(q,[2,109]),t(C,[2,85]),t(fe,[2,31]),t(G,[2,113]),t(fe,[2,30]),{47:120,48:[1,121],50:119,53:[2,120],65:118},t(re,[2,118],{70:100,68:102,72:104,73:105,74:107,69:122,87:Y,96:W,126:ue}),t(re,[2,119]),t(ye,[2,116]),t(Te,[2,128],{79:123}),t(ye,[2,35]),t(Te,[2,59]),t(ye,[2,36],{71:124,66:125,67:Re}),t(ve,[2,61],{100:127,98:128,67:ce}),t(J,[2,38]),{72:130,74:107,87:Y,126:ue},t(j,[2,64],{104:131,101:132,102:z}),{75:[1,134]},t([13,16,56,85,87,95,115,126,128,129,130],[2,58]),t(B,[2,68]),{13:u,16:s,18:115,38:X,105:135,106:113,114:26,115:c,130:l},{75:[2,124]},{75:[2,125]},t(B,[2,66],{107:136,93:[1,138],110:[1,137],111:[1,139]}),t([13,16,38,115,130],[2,70]),t(U,[2,74]),{13:u,16:s,18:115,38:X,97:140,99:103,103:106,105:109,106:113,108:110,109:te,114:26,115:c,130:l},t(O,[2,19]),{53:[1,141]},{53:[2,121]},{13:u,16:s,18:36,29:142,30:35,114:26,115:c,130:l},t(d,[2,23]),t(ye,[2,117]),t(re,[2,41],{114:26,55:74,127:143,88:144,82:145,81:147,84:148,73:149,18:150,86:152,23:154,94:155,13:u,16:s,44:[1,146],56:D,85:Z,87:oe,95:ie,96:W,115:c,128:se,129:ne,130:l}),t(ye,[2,37],{66:159,67:Re}),t(J,[2,122]),{68:160,72:104,73:105,74:107,87:Y,96:W,126:ue},t(ve,[2,62],{98:161,67:ce}),t(j,[2,134]),{13:u,16:s,18:115,38:X,99:162,103:106,105:109,106:113,108:110,109:te,114:26,115:c,130:l},t(J,[2,39]),t(j,[2,65],{101:163,102:z}),t(B,[2,136]),{13:u,16:s,18:115,38:X,103:164,105:109,106:113,108:110,109:te,114:26,115:c,130:l},{13:u,16:s,18:51,35:166,44:he,76:165,92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},t(B,[2,69]),t(B,[2,67]),t(B,[2,71]),t(B,[2,72]),t(B,[2,73]),{40:[1,168]},t(G,[2,33]),{48:[1,170],49:169},t(Te,[2,129]),t(Te,[2,126]),t(Te,[2,127]),{89:171,92:[1,172]},t(Te,[2,43],{83:173,80:174,67:xe}),t(me,[2,45]),{13:u,16:s,18:150,23:154,55:74,56:D,84:176,85:Z,86:152,87:oe,94:155,95:ie,114:26,115:c,128:se,129:ne,130:l},t(me,[2,47]),t(me,[2,48]),t(me,[2,49]),{75:[1,177]},t(me,[2,51]),t(me,[2,56]),{13:[1,178]},t(me,[2,132]),t(me,[2,133]),t(J,[2,123]),t(J,[2,34]),t(j,[2,135]),t(j,[2,60]),t(B,[2,137]),t(B,[2,63]),t(J,[2,40]),t(Ie,[2,76]),t(Pe,[2,138],{112:179}),t(U,[2,75]),{53:[2,25]},{53:[2,24]},{90:[1,180]},{90:[2,53]},t(Te,[2,44],{80:181,67:xe}),t(me,[2,130]),{13:u,16:s,18:150,23:154,55:74,56:D,73:149,81:182,84:148,85:Z,86:152,87:oe,94:155,95:ie,96:W,114:26,115:c,128:se,129:ne,130:l},t(me,[2,46]),{13:u,16:s,18:51,35:166,44:he,76:183,92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},t(me,[2,57]),{13:u,16:s,18:51,35:185,46:[1,184],92:S,113:52,114:26,115:c,116:55,119:T,120:w,121:59,122:61,123:62,130:l,131:A,132:R,133:E,134:I,135:L,136:F},{91:186,92:[1,187],93:[1,188]},t(me,[2,131]),t(me,[2,42]),t(me,[2,50]),t(Ie,[2,77]),t(Pe,[2,139]),{46:[1,189]},{46:[2,54]},{46:[2,55]},t(Te,[2,52])],defaultActions:{21:[2,1],41:[2,103],70:[2,101],111:[2,124],112:[2,125],119:[2,121],169:[2,25],170:[2,24],172:[2,53],187:[2,54],188:[2,55]},parseError:function(Xe,Ye){if(Ye.recoverable)this.trace(Xe);else{var nt=new Error(Xe);throw nt.hash=Ye,nt}},parse:function(Xe){var Ye=this,nt=[0],gt=[null],ut=[],tt=this.table,Ct="",Ze=0,Ee=0,qe=2,Be=1,it=ut.slice.call(arguments,1),at=Object.create(this.lexer),vt={yy:{}};for(var At in this.yy)Object.prototype.hasOwnProperty.call(this.yy,At)&&(vt.yy[At]=this.yy[At]);at.setInput(Xe,vt.yy),vt.yy.lexer=at,vt.yy.parser=this,typeof at.yylloc>"u"&&(at.yylloc={});var St=at.yylloc;ut.push(St);var Xt=at.options&&at.options.ranges;typeof vt.yy.parseError=="function"?this.parseError=vt.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var jt=function(){var Ut;return Ut=at.lex()||Be,typeof Ut!="number"&&(Ut=Ye.symbols_[Ut]||Ut),Ut},xt,Rt,Lt,Ht,It={},Ft,qt,Fr,br;;){if(Rt=nt[nt.length-1],this.defaultActions[Rt]?Lt=this.defaultActions[Rt]:((xt===null||typeof xt>"u")&&(xt=jt()),Lt=tt[Rt]&&tt[Rt][xt]),typeof Lt>"u"||!Lt.length||!Lt[0]){var Gt="";br=[];for(Ft in tt[Rt])this.terminals_[Ft]&&Ft>qe&&br.push("'"+this.terminals_[Ft]+"'");at.showPosition?Gt="Parse error on line "+(Ze+1)+`:
`+at.showPosition()+`
Expecting `+br.join(", ")+", got '"+(this.terminals_[xt]||xt)+"'":Gt="Parse error on line "+(Ze+1)+": Unexpected "+(xt==Be?"end of input":"'"+(this.terminals_[xt]||xt)+"'"),this.parseError(Gt,{text:at.match,token:this.terminals_[xt]||xt,line:at.yylineno,loc:St,expected:br})}if(Lt[0]instanceof Array&&Lt.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Rt+", token: "+xt);switch(Lt[0]){case 1:nt.push(xt),gt.push(at.yytext),ut.push(at.yylloc),nt.push(Lt[1]),xt=null,Ee=at.yyleng,Ct=at.yytext,Ze=at.yylineno,St=at.yylloc;break;case 2:if(qt=this.productions_[Lt[1]][1],It.$=gt[gt.length-qt],It._$={first_line:ut[ut.length-(qt||1)].first_line,last_line:ut[ut.length-1].last_line,first_column:ut[ut.length-(qt||1)].first_column,last_column:ut[ut.length-1].last_column},Xt&&(It._$.range=[ut[ut.length-(qt||1)].range[0],ut[ut.length-1].range[1]]),Ht=this.performAction.apply(It,[Ct,Ee,Ze,vt.yy,Lt[1],gt,ut].concat(it)),typeof Ht<"u")return Ht;qt&&(nt=nt.slice(0,-1*qt*2),gt=gt.slice(0,-1*qt),ut=ut.slice(0,-1*qt)),nt.push(this.productions_[Lt[1]][0]),gt.push(It.$),ut.push(It._$),Fr=tt[nt[nt.length-2]][nt[nt.length-1]],nt.push(Fr);break;case 3:return!0}}return!0}};const pe="http://www.w3.org/1999/02/22-rdf-syntax-ns#",H=pe+"type",V=pe+"first",Q=pe+"rest",ee=pe+"nil",ae="http://www.w3.org/2001/XMLSchema#",be=ae+"integer",le=ae+"decimal",we=ae+"double",De=ae+"boolean",Fe="http://www.w3.org/ns/shacl#",Ne="http://www.w3.org/2002/07/owl#",de="http://www.w3.org/2000/01/rdf-schema#",Le={[be]:!0,[le]:!0,[ae+"float"]:!0,[we]:!0,[ae+"string"]:!0,[De]:!0,[ae+"dateTime"]:!0,[ae+"nonPositiveInteger"]:!0,[ae+"negativeInteger"]:!0,[ae+"long"]:!0,[ae+"int"]:!0,[ae+"short"]:!0,[ae+"byte"]:!0,[ae+"nonNegativeInteger"]:!0,[ae+"unsignedLong"]:!0,[ae+"unsignedShort"]:!0,[ae+"unsignedByte"]:!0,[ae+"positiveInteger"]:!0,[pe+"langString"]:!0};function $e(ct,Xe=!1){let Ye=0,nt=ct.length;if(Xe&&nt===0)return Ge.factory.namedNode(ee);const gt=head=Ke();return nt===0&&Ae(head,Ge.factory.namedNode(Q),Ge.factory.namedNode(ee)),ct.forEach(ut=>{if(ut===void 0)throw new Error("b");Ae(head,Ge.factory.namedNode(V),ut),Ae(head,Ge.factory.namedNode(Q),head=++Ye<nt?Ke():Ge.factory.namedNode(ee))}),gt}function je(ct){return Ge.n3Parser._resolveIRI(ct[0]==="<"?ct.substring(1,ct.length-1):ct)}function Me(ct){const Xe=ct.indexOf(":"),Ye=ct.substr(0,Xe),nt=Ge.prefixes[Ye];if(!nt)throw new Error("Unknown prefix: "+Ye);return je(nt+ct.substr(Xe+1))}function ze(ct,Xe){return Xe&&Xe.termType!=="NamedNode"&&(Xe=Ge.factory.namedNode(Xe)),Ge.factory.literal(ct,Xe)}function Je(ct,Xe){return Ge.factory.literal(ct,Xe)}function Ke(ct){return Ge.factory.blankNode("g_"+ot++)}var ot=0;Ge._resetBlanks=function(){ot=0};function _e(ct,Xe){return Ge.n3Parser._lexer._unescape(ct.substring(Xe,ct.length-Xe))}function Ae(ct,Xe,Ye){if(!ct.termType||!Xe.termType||Xe.value.includes(",")||!Ye.termType)throw new Error(`boo ${ct.value} ${Xe.value} ${Ye.value}`);Ge.onQuad(Ge.factory.quad(ct,Xe,Ye))}function Ve(ct,Xe){Ae(Ge.currentPropertyNode,Ge.factory.namedNode(Fe+ct),Xe)}function Ue(ct,Xe,Ye){const nt=Ke();return Ae(nt,Ge.factory.namedNode(Fe+Xe),Ye),[ct,nt]}function We(ct){if(!Ge.extended)throw new Error("Encountered extended SHACLC syntax; but extended parsing is disabled");return ct}var pt=function(){var ct={EOF:1,parseError:function(Ye,nt){if(this.yy.parser)this.yy.parser.parseError(Ye,nt);else throw new Error(Ye)},setInput:function(Xe,Ye){return this.yy=Ye||this.yy||{},this._input=Xe,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Xe=this._input[0];this.yytext+=Xe,this.yyleng++,this.offset++,this.match+=Xe,this.matched+=Xe;var Ye=Xe.match(/(?:\r\n?|\n).*/g);return Ye?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Xe},unput:function(Xe){var Ye=Xe.length,nt=Xe.split(/(?:\r\n?|\n)/g);this._input=Xe+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Ye),this.offset-=Ye;var gt=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),nt.length-1&&(this.yylineno-=nt.length-1);var ut=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:nt?(nt.length===gt.length?this.yylloc.first_column:0)+gt[gt.length-nt.length].length-nt[0].length:this.yylloc.first_column-Ye},this.options.ranges&&(this.yylloc.range=[ut[0],ut[0]+this.yyleng-Ye]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Xe){this.unput(this.match.slice(Xe))},pastInput:function(){var Xe=this.matched.substr(0,this.matched.length-this.match.length);return(Xe.length>20?"...":"")+Xe.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Xe=this.match;return Xe.length<20&&(Xe+=this._input.substr(0,20-Xe.length)),(Xe.substr(0,20)+(Xe.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Xe=this.pastInput(),Ye=new Array(Xe.length+1).join("-");return Xe+this.upcomingInput()+`
`+Ye+"^"},test_match:function(Xe,Ye){var nt,gt,ut;if(this.options.backtrack_lexer&&(ut={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ut.yylloc.range=this.yylloc.range.slice(0))),gt=Xe[0].match(/(?:\r\n?|\n).*/g),gt&&(this.yylineno+=gt.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:gt?gt[gt.length-1].length-gt[gt.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Xe[0].length},this.yytext+=Xe[0],this.match+=Xe[0],this.matches=Xe,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Xe[0].length),this.matched+=Xe[0],nt=this.performAction.call(this,this.yy,this,Ye,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),nt)return nt;if(this._backtrack){for(var tt in ut)this[tt]=ut[tt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Xe,Ye,nt,gt;this._more||(this.yytext="",this.match="");for(var ut=this._currentRules(),tt=0;tt<ut.length;tt++)if(nt=this._input.match(this.rules[ut[tt]]),nt&&(!Ye||nt[0].length>Ye[0].length)){if(Ye=nt,gt=tt,this.options.backtrack_lexer){if(Xe=this.test_match(nt,ut[tt]),Xe!==!1)return Xe;if(this._backtrack){Ye=!1;continue}else return!1}else if(!this.options.flex)break}return Ye?(Xe=this.test_match(Ye,ut[gt]),Xe!==!1?Xe:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Ye=this.next();return Ye||this.lex()},begin:function(Ye){this.conditionStack.push(Ye)},popState:function(){var Ye=this.conditionStack.length-1;return Ye>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Ye){return Ye=this.conditionStack.length-1-Math.abs(Ye||0),Ye>=0?this.conditionStack[Ye]:"INITIAL"},pushState:function(Ye){this.begin(Ye)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0,"case-insensitive":!0},performAction:function(Ye,nt,gt,ut){switch(gt){case 0:break;case 1:return 12;case 2:return 14;case 3:return 15;case 4:return 25;case 5:return 20;case 6:return 131;case 7:return 132;case 8:return 85;case 9:return 126;case 10:return 87;case 11:return"PASS";case 12:return"COMMENT";case 13:return 13;case 14:return 16;case 15:return 130;case 16:return 129;case 17:return 128;case 18:return 117;case 19:return 92;case 20:return 119;case 21:return 120;case 22:return"EXPONENT";case 23:return 133;case 24:return 134;case 25:return 135;case 26:return 136;case 27:return 61;case 28:return 90;case 29:return 58;case 30:return 56;case 31:return 38;case 32:return 40;case 33:return 44;case 34:return 46;case 35:return 110;case 36:return 93;case 37:return 111;case 38:return 67;case 39:return 118;case 40:return 53;case 41:return 96;case 42:return 102;case 43:return 75;case 44:return 95;case 45:return 109;case 46:return 28;case 47:return 42;case 48:return 48;case 49:return 115;case 50:return 7;case 51:console.log(nt.yytext);break}},rules:[/^(?:\s+|#[^\n\r]*)/i,/^(?:BASE)/i,/^(?:IMPORTS)/i,/^(?:PREFIX)/i,/^(?:shapeClass)/i,/^(?:shape)/i,/^(?:true)/i,/^(?:false)/i,/^(?:(BlankNode|IRI|Literal|BlankNodeOrIRI|BlankNodeOrLiteral|IRIOrLiteral\b))/i,/^(?:(targetNode|targetObjectsOf|targetSubjectsOf\b))/i,/^(?:(deactivated|severity|message|class|datatype|nodeKind|minExclusive|minInclusive|maxExclusive|maxInclusive|minLength|maxLength|pattern|flags|languageIn|uniqueLang|equals|disjoint|lessThan|lessThanOrEquals|qualifiedValueShape|qualifiedMinCount|qualifiedMaxCount|qualifiedValueShapesDisjoint|closed|ignoredProperties|hasValue|in))/i,/^(?:([ \t\r\n]+))/i,/^(?:(#[\r\n]*))/i,/^(?:(<([^=<>\"\{\}\|\^`\\\u0000-\u0020]|(\\u([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])|\\U([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f])))*>))/i,/^(?:((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.)*((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.)*((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040]))?)?:)(((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|:|[0-9]|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.|:|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|:|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(@(([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.)*((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040]))?)?:))/i,/^(?:(@((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.)*((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040]))?)?:)(((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|:|[0-9]|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))((((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|\.|:|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(((([A-Z]|[a-z]|[\u00C0-\u00D6]|[\u00D8-\u00F6]|[\u00F8-\u02FF]|[\u0370-\u037D]|[\u037F-\u1FFF]|[\u200C-\u200D]|[\u2070-\u218F]|[\u2C00-\u2FEF]|[\u3001-\uD7FF]|[\uF900-\uFDCF]|[\uFDF0-\uFFFD])|_\b)|-|[0-9]|[\u00B7]|[\u0300-\u036F]|[\u203F-\u2040])|:|((%([0-9]|[A-F]|[a-f])([0-9]|[A-F]|[a-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(@[a-zA-Z]+(-[a-zA-Z0-9]+)*))/i,/^(?:([+-]?[0-9]+))/i,/^(?:([+-]?[0-9]*\.[0-9]+))/i,/^(?:([+-]?([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.?[0-9]+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"\']))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"\']))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"\'])))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"\'])))*"""))/i,/^(?:->)/i,/^(?:\.\.)/i,/^(?:\})/i,/^(?:\{)/i,/^(?:\()/i,/^(?:\))/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\?)/i,/^(?:\*)/i,/^(?:\+)/i,/^(?:\|)/i,/^(?:\^\^)/i,/^(?:\.)/i,/^(?:!)/i,/^(?:\/)/i,/^(?:=)/i,/^(?:@)/i,/^(?:\^)/i,/^(?:;)/i,/^(?:,)/i,/^(?:%)/i,/^(?:a)/i,/^(?:$)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],inclusive:!0}}};return ct}();Ce.lexer=pt;function Ge(){this.yy={}}return Ge.prototype=Ce,Ce.Parser=Ge,new Ge}();return ShaclcParser_1=n,ShaclcParser_1}var hasRequiredLib$3i;function requireLib$3i(){if(hasRequiredLib$3i)return lib$3h;hasRequiredLib$3i=1;const n=requireShaclcParser().Parser,t=require$$0;class r{constructor(){}parse(o,{extendedSyntax:u,baseIRI:s}={}){this._parser=new n,this._parser.Parser.factory=t.DataFactory,this._parser.Parser.base=t.DataFactory.namedNode(s||"urn:x-base:default"),this._parser.Parser.extended=u===!0,this._parser.Parser.prefixes={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",sh:"http://www.w3.org/ns/shacl#",xsd:"http://www.w3.org/2001/XMLSchema#"},this._parser.Parser.currentNodeShape=void 0,this._parser.Parser.currentPropertyNode=void 0,this._parser.Parser.nodeShapeStack=[],this._parser.Parser.tempCurrentNodeShape=void 0,this._parser.Parser.n3Parser=new t.Parser({baseIRI:s||"urn:x-base:default"});const c=[];return this._parser.Parser.onQuad=l=>{c.push(l)},this._parser.parse(o),c.prefixes=this._parser.Parser.prefixes,c}}return lib$3h.Parser=r,lib$3h.parse=function(o,u){return new r().parse(o,u)},lib$3h}var PrefixWrappingIterator={},hasRequiredPrefixWrappingIterator;function requirePrefixWrappingIterator(){if(hasRequiredPrefixWrappingIterator)return PrefixWrappingIterator;hasRequiredPrefixWrappingIterator=1,Object.defineProperty(PrefixWrappingIterator,"__esModule",{value:!0}),PrefixWrappingIterator.PrefixWrappingIterator=void 0;const n=requireAsynciterator();let t=class extends n.WrappingIterator{constructor(a){super(a==null?void 0:a.then(o=>(this.prefixes=o.prefixes,o)))}read(){if(this.prefixes){for(const a of Object.entries(this.prefixes))this.emit("prefix",...a);delete this.prefixes}return super.read()}};return PrefixWrappingIterator.PrefixWrappingIterator=t,PrefixWrappingIterator}var hasRequiredActorRdfParseShaclc;function requireActorRdfParseShaclc(){if(hasRequiredActorRdfParseShaclc)return ActorRdfParseShaclc;hasRequiredActorRdfParseShaclc=1,Object.defineProperty(ActorRdfParseShaclc,"__esModule",{value:!0}),ActorRdfParseShaclc.ActorRdfParseShaclc=void 0;const n=requireLib$3s(),t=requireDist$3(),r=requireBrowser(),a=requireLib$3i(),o=requirePrefixWrappingIterator();let u=class extends n.ActorRdfParseFixedMediaTypes{constructor(c){super(c)}async runHandle(c,l,d){const f=new o.PrefixWrappingIterator((0,t.stringify)(c.data).then(v=>{var g;return(0,a.parse)(v,{extendedSyntax:l==="text/shaclc-ext",baseIRI:(g=c.metadata)==null?void 0:g.baseIRI})})),h=new r.Readable({objectMode:!0});return f.on("prefix",(...v)=>h.emit("prefix",...v)),{data:h.wrap(f),metadata:{triples:!0}}}};return ActorRdfParseShaclc.ActorRdfParseShaclc=u,ActorRdfParseShaclc}var hasRequiredLib$3h;function requireLib$3h(){return hasRequiredLib$3h||(hasRequiredLib$3h=1,function(n){var t=lib$3i&&lib$3i.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3i&&lib$3i.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseShaclc(),n)}(lib$3i)),lib$3i}var lib$3g={},ActorRdfParseHtml$1={},commonjs={},Parser$2={},Tokenizer$1={},decode$1={},decodeDataHtml$1={},hasRequiredDecodeDataHtml$1;function requireDecodeDataHtml$1(){return hasRequiredDecodeDataHtml$1||(hasRequiredDecodeDataHtml$1=1,Object.defineProperty(decodeDataHtml$1,"__esModule",{value:!0}),decodeDataHtml$1.htmlDecodeTree=void 0,decodeDataHtml$1.htmlDecodeTree=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(n=>n.charCodeAt(0)))),decodeDataHtml$1}var decodeDataXml$1={},hasRequiredDecodeDataXml$1;function requireDecodeDataXml$1(){return hasRequiredDecodeDataXml$1||(hasRequiredDecodeDataXml$1=1,Object.defineProperty(decodeDataXml$1,"__esModule",{value:!0}),decodeDataXml$1.xmlDecodeTree=void 0,decodeDataXml$1.xmlDecodeTree=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(n=>n.charCodeAt(0)))),decodeDataXml$1}var decodeCodepoint={},hasRequiredDecodeCodepoint;function requireDecodeCodepoint(){return hasRequiredDecodeCodepoint||(hasRequiredDecodeCodepoint=1,function(n){var t;Object.defineProperty(n,"__esModule",{value:!0}),n.fromCodePoint=void 0,n.replaceCodePoint=a,n.decodeCodePoint=o;const r=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);n.fromCodePoint=(t=String.fromCodePoint)!==null&&t!==void 0?t:function(u){let s="";return u>65535&&(u-=65536,s+=String.fromCharCode(u>>>10&1023|55296),u=56320|u&1023),s+=String.fromCharCode(u),s};function a(u){var s;return u>=55296&&u<=57343||u>1114111?65533:(s=r.get(u))!==null&&s!==void 0?s:u}function o(u){return(0,n.fromCodePoint)(a(u))}}(decodeCodepoint)),decodeCodepoint}var hasRequiredDecode$1;function requireDecode$1(){return hasRequiredDecode$1||(hasRequiredDecode$1=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.fromCodePoint=n.replaceCodePoint=n.decodeCodePoint=n.xmlDecodeTree=n.htmlDecodeTree=n.EntityDecoder=n.DecodingMode=n.BinTrieFlags=void 0,n.determineBranch=_,n.decodeHTML=w,n.decodeHTMLAttribute=A,n.decodeHTMLStrict=R,n.decodeXML=E;const t=requireDecodeDataHtml$1(),r=requireDecodeDataXml$1(),a=requireDecodeCodepoint();var o;(function(D){D[D.NUM=35]="NUM",D[D.SEMI=59]="SEMI",D[D.EQUALS=61]="EQUALS",D[D.ZERO=48]="ZERO",D[D.NINE=57]="NINE",D[D.LOWER_A=97]="LOWER_A",D[D.LOWER_F=102]="LOWER_F",D[D.LOWER_X=120]="LOWER_X",D[D.LOWER_Z=122]="LOWER_Z",D[D.UPPER_A=65]="UPPER_A",D[D.UPPER_F=70]="UPPER_F",D[D.UPPER_Z=90]="UPPER_Z"})(o||(o={}));const u=32;var s;(function(D){D[D.VALUE_LENGTH=49152]="VALUE_LENGTH",D[D.BRANCH_LENGTH=16256]="BRANCH_LENGTH",D[D.JUMP_TABLE=127]="JUMP_TABLE"})(s||(n.BinTrieFlags=s={}));function c(D){return D>=o.ZERO&&D<=o.NINE}function l(D){return D>=o.UPPER_A&&D<=o.UPPER_F||D>=o.LOWER_A&&D<=o.LOWER_F}function d(D){return D>=o.UPPER_A&&D<=o.UPPER_Z||D>=o.LOWER_A&&D<=o.LOWER_Z||c(D)}function f(D){return D===o.EQUALS||d(D)}var h;(function(D){D[D.EntityStart=0]="EntityStart",D[D.NumericStart=1]="NumericStart",D[D.NumericDecimal=2]="NumericDecimal",D[D.NumericHex=3]="NumericHex",D[D.NamedEntity=4]="NamedEntity"})(h||(h={}));var v;(function(D){D[D.Legacy=0]="Legacy",D[D.Strict=1]="Strict",D[D.Attribute=2]="Attribute"})(v||(n.DecodingMode=v={}));class g{constructor($,O,P){this.decodeTree=$,this.emitCodePoint=O,this.errors=P,this.state=h.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=v.Strict}startEntity($){this.decodeMode=$,this.state=h.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write($,O){switch(this.state){case h.EntityStart:return $.charCodeAt(O)===o.NUM?(this.state=h.NumericStart,this.consumed+=1,this.stateNumericStart($,O+1)):(this.state=h.NamedEntity,this.stateNamedEntity($,O));case h.NumericStart:return this.stateNumericStart($,O);case h.NumericDecimal:return this.stateNumericDecimal($,O);case h.NumericHex:return this.stateNumericHex($,O);case h.NamedEntity:return this.stateNamedEntity($,O)}}stateNumericStart($,O){return O>=$.length?-1:($.charCodeAt(O)|u)===o.LOWER_X?(this.state=h.NumericHex,this.consumed+=1,this.stateNumericHex($,O+1)):(this.state=h.NumericDecimal,this.stateNumericDecimal($,O))}addToNumericResult($,O,P,C){if(O!==P){const q=P-O;this.result=this.result*Math.pow(C,q)+Number.parseInt($.substr(O,q),C),this.consumed+=q}}stateNumericHex($,O){const P=O;for(;O<$.length;){const C=$.charCodeAt(O);if(c(C)||l(C))O+=1;else return this.addToNumericResult($,P,O,16),this.emitNumericEntity(C,3)}return this.addToNumericResult($,P,O,16),-1}stateNumericDecimal($,O){const P=O;for(;O<$.length;){const C=$.charCodeAt(O);if(c(C))O+=1;else return this.addToNumericResult($,P,O,10),this.emitNumericEntity(C,2)}return this.addToNumericResult($,P,O,10),-1}emitNumericEntity($,O){var P;if(this.consumed<=O)return(P=this.errors)===null||P===void 0||P.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if($===o.SEMI)this.consumed+=1;else if(this.decodeMode===v.Strict)return 0;return this.emitCodePoint((0,a.replaceCodePoint)(this.result),this.consumed),this.errors&&($!==o.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity($,O){const{decodeTree:P}=this;let C=P[this.treeIndex],q=(C&s.VALUE_LENGTH)>>14;for(;O<$.length;O++,this.excess++){const M=$.charCodeAt(O);if(this.treeIndex=_(P,C,this.treeIndex+Math.max(1,q),M),this.treeIndex<0)return this.result===0||this.decodeMode===v.Attribute&&(q===0||f(M))?0:this.emitNotTerminatedNamedEntity();if(C=P[this.treeIndex],q=(C&s.VALUE_LENGTH)>>14,q!==0){if(M===o.SEMI)return this.emitNamedEntityData(this.treeIndex,q,this.consumed+this.excess);this.decodeMode!==v.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var $;const{result:O,decodeTree:P}=this,C=(P[O]&s.VALUE_LENGTH)>>14;return this.emitNamedEntityData(O,C,this.consumed),($=this.errors)===null||$===void 0||$.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData($,O,P){const{decodeTree:C}=this;return this.emitCodePoint(O===1?C[$]&~s.VALUE_LENGTH:C[$+1],P),O===3&&this.emitCodePoint(C[$+2],P),P}end(){var $;switch(this.state){case h.NamedEntity:return this.result!==0&&(this.decodeMode!==v.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case h.NumericDecimal:return this.emitNumericEntity(0,2);case h.NumericHex:return this.emitNumericEntity(0,3);case h.NumericStart:return($=this.errors)===null||$===void 0||$.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case h.EntityStart:return 0}}}n.EntityDecoder=g;function b(D){let $="";const O=new g(D,P=>$+=(0,a.fromCodePoint)(P));return function(C,q){let M=0,N=0;for(;(N=C.indexOf("&",N))>=0;){$+=C.slice(M,N),O.startEntity(q);const X=O.write(C,N+1);if(X<0){M=N+O.end();break}M=N+X,N=X===0?M+1:M}const G=$+C.slice(M);return $="",G}}function _(D,$,O,P){const C=($&s.BRANCH_LENGTH)>>7,q=$&s.JUMP_TABLE;if(C===0)return q!==0&&P===q?O:-1;if(q){const G=P-q;return G<0||G>=C?-1:D[O+G]-1}let M=O,N=M+C-1;for(;M<=N;){const G=M+N>>>1,X=D[G];if(X<P)M=G+1;else if(X>P)N=G-1;else return D[G+C]}return-1}const S=b(t.htmlDecodeTree),T=b(r.xmlDecodeTree);function w(D,$=v.Legacy){return S(D,$)}function A(D){return S(D,v.Attribute)}function R(D){return S(D,v.Strict)}function E(D){return T(D,v.Strict)}var I=requireDecodeDataHtml$1();Object.defineProperty(n,"htmlDecodeTree",{enumerable:!0,get:function(){return I.htmlDecodeTree}});var L=requireDecodeDataXml$1();Object.defineProperty(n,"xmlDecodeTree",{enumerable:!0,get:function(){return L.xmlDecodeTree}});var F=requireDecodeCodepoint();Object.defineProperty(n,"decodeCodePoint",{enumerable:!0,get:function(){return F.decodeCodePoint}}),Object.defineProperty(n,"replaceCodePoint",{enumerable:!0,get:function(){return F.replaceCodePoint}}),Object.defineProperty(n,"fromCodePoint",{enumerable:!0,get:function(){return F.fromCodePoint}})}(decode$1)),decode$1}var hasRequiredTokenizer$1;function requireTokenizer$1(){if(hasRequiredTokenizer$1)return Tokenizer$1;hasRequiredTokenizer$1=1,Object.defineProperty(Tokenizer$1,"__esModule",{value:!0}),Tokenizer$1.QuoteType=void 0;const n=requireDecode$1();var t;(function(d){d[d.Tab=9]="Tab",d[d.NewLine=10]="NewLine",d[d.FormFeed=12]="FormFeed",d[d.CarriageReturn=13]="CarriageReturn",d[d.Space=32]="Space",d[d.ExclamationMark=33]="ExclamationMark",d[d.Number=35]="Number",d[d.Amp=38]="Amp",d[d.SingleQuote=39]="SingleQuote",d[d.DoubleQuote=34]="DoubleQuote",d[d.Dash=45]="Dash",d[d.Slash=47]="Slash",d[d.Zero=48]="Zero",d[d.Nine=57]="Nine",d[d.Semi=59]="Semi",d[d.Lt=60]="Lt",d[d.Eq=61]="Eq",d[d.Gt=62]="Gt",d[d.Questionmark=63]="Questionmark",d[d.UpperA=65]="UpperA",d[d.LowerA=97]="LowerA",d[d.UpperF=70]="UpperF",d[d.LowerF=102]="LowerF",d[d.UpperZ=90]="UpperZ",d[d.LowerZ=122]="LowerZ",d[d.LowerX=120]="LowerX",d[d.OpeningSquareBracket=91]="OpeningSquareBracket"})(t||(t={}));var r;(function(d){d[d.Text=1]="Text",d[d.BeforeTagName=2]="BeforeTagName",d[d.InTagName=3]="InTagName",d[d.InSelfClosingTag=4]="InSelfClosingTag",d[d.BeforeClosingTagName=5]="BeforeClosingTagName",d[d.InClosingTagName=6]="InClosingTagName",d[d.AfterClosingTagName=7]="AfterClosingTagName",d[d.BeforeAttributeName=8]="BeforeAttributeName",d[d.InAttributeName=9]="InAttributeName",d[d.AfterAttributeName=10]="AfterAttributeName",d[d.BeforeAttributeValue=11]="BeforeAttributeValue",d[d.InAttributeValueDq=12]="InAttributeValueDq",d[d.InAttributeValueSq=13]="InAttributeValueSq",d[d.InAttributeValueNq=14]="InAttributeValueNq",d[d.BeforeDeclaration=15]="BeforeDeclaration",d[d.InDeclaration=16]="InDeclaration",d[d.InProcessingInstruction=17]="InProcessingInstruction",d[d.BeforeComment=18]="BeforeComment",d[d.CDATASequence=19]="CDATASequence",d[d.InSpecialComment=20]="InSpecialComment",d[d.InCommentLike=21]="InCommentLike",d[d.BeforeSpecialS=22]="BeforeSpecialS",d[d.BeforeSpecialT=23]="BeforeSpecialT",d[d.SpecialStartSequence=24]="SpecialStartSequence",d[d.InSpecialTag=25]="InSpecialTag",d[d.InEntity=26]="InEntity"})(r||(r={}));function a(d){return d===t.Space||d===t.NewLine||d===t.Tab||d===t.FormFeed||d===t.CarriageReturn}function o(d){return d===t.Slash||d===t.Gt||a(d)}function u(d){return d>=t.LowerA&&d<=t.LowerZ||d>=t.UpperA&&d<=t.UpperZ}var s;(function(d){d[d.NoValue=0]="NoValue",d[d.Unquoted=1]="Unquoted",d[d.Single=2]="Single",d[d.Double=3]="Double"})(s||(Tokenizer$1.QuoteType=s={}));const c={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97]),XmpEnd:new Uint8Array([60,47,120,109,112])};class l{constructor({xmlMode:f=!1,decodeEntities:h=!0},v){this.cbs=v,this.state=r.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=r.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=f,this.decodeEntities=h,this.entityDecoder=new n.EntityDecoder(f?n.xmlDecodeTree:n.htmlDecodeTree,(g,b)=>this.emitCodePoint(g,b))}reset(){this.state=r.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=r.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(f){this.offset+=this.buffer.length,this.buffer=f,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(f){f===t.Lt||!this.decodeEntities&&this.fastForwardTo(t.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=r.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&f===t.Amp&&this.startEntity()}stateSpecialStartSequence(f){const h=this.sequenceIndex===this.currentSequence.length;if(!(h?o(f):(f|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!h){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=r.InTagName,this.stateInTagName(f)}stateInSpecialTag(f){if(this.sequenceIndex===this.currentSequence.length){if(f===t.Gt||a(f)){const h=this.index-this.currentSequence.length;if(this.sectionStart<h){const v=this.index;this.index=h,this.cbs.ontext(this.sectionStart,h),this.index=v}this.isSpecial=!1,this.sectionStart=h+2,this.stateInClosingTagName(f);return}this.sequenceIndex=0}(f|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===c.TitleEnd?this.decodeEntities&&f===t.Amp&&this.startEntity():this.fastForwardTo(t.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(f===t.Lt)}stateCDATASequence(f){f===c.Cdata[this.sequenceIndex]?++this.sequenceIndex===c.Cdata.length&&(this.state=r.InCommentLike,this.currentSequence=c.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=r.InDeclaration,this.stateInDeclaration(f))}fastForwardTo(f){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===f)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(f){f===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===c.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=r.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):f!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(f){return this.xmlMode?!o(f):u(f)}startSpecial(f,h){this.isSpecial=!0,this.currentSequence=f,this.sequenceIndex=h,this.state=r.SpecialStartSequence}stateBeforeTagName(f){if(f===t.ExclamationMark)this.state=r.BeforeDeclaration,this.sectionStart=this.index+1;else if(f===t.Questionmark)this.state=r.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(f)){const h=f|32;this.sectionStart=this.index,this.xmlMode?this.state=r.InTagName:h===c.ScriptEnd[2]?this.state=r.BeforeSpecialS:h===c.TitleEnd[2]||h===c.XmpEnd[2]?this.state=r.BeforeSpecialT:this.state=r.InTagName}else f===t.Slash?this.state=r.BeforeClosingTagName:(this.state=r.Text,this.stateText(f))}stateInTagName(f){o(f)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(f))}stateBeforeClosingTagName(f){a(f)||(f===t.Gt?this.state=r.Text:(this.state=this.isTagStartChar(f)?r.InClosingTagName:r.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(f){(f===t.Gt||a(f))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=r.AfterClosingTagName,this.stateAfterClosingTagName(f))}stateAfterClosingTagName(f){(f===t.Gt||this.fastForwardTo(t.Gt))&&(this.state=r.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(f){f===t.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=r.InSpecialTag,this.sequenceIndex=0):this.state=r.Text,this.sectionStart=this.index+1):f===t.Slash?this.state=r.InSelfClosingTag:a(f)||(this.state=r.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(f){f===t.Gt?(this.cbs.onselfclosingtag(this.index),this.state=r.Text,this.sectionStart=this.index+1,this.isSpecial=!1):a(f)||(this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(f))}stateInAttributeName(f){(f===t.Eq||o(f))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=r.AfterAttributeName,this.stateAfterAttributeName(f))}stateAfterAttributeName(f){f===t.Eq?this.state=r.BeforeAttributeValue:f===t.Slash||f===t.Gt?(this.cbs.onattribend(s.NoValue,this.sectionStart),this.sectionStart=-1,this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(f)):a(f)||(this.cbs.onattribend(s.NoValue,this.sectionStart),this.state=r.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(f){f===t.DoubleQuote?(this.state=r.InAttributeValueDq,this.sectionStart=this.index+1):f===t.SingleQuote?(this.state=r.InAttributeValueSq,this.sectionStart=this.index+1):a(f)||(this.sectionStart=this.index,this.state=r.InAttributeValueNq,this.stateInAttributeValueNoQuotes(f))}handleInAttributeValue(f,h){f===h||!this.decodeEntities&&this.fastForwardTo(h)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(h===t.DoubleQuote?s.Double:s.Single,this.index+1),this.state=r.BeforeAttributeName):this.decodeEntities&&f===t.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(f){this.handleInAttributeValue(f,t.DoubleQuote)}stateInAttributeValueSingleQuotes(f){this.handleInAttributeValue(f,t.SingleQuote)}stateInAttributeValueNoQuotes(f){a(f)||f===t.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(s.Unquoted,this.index),this.state=r.BeforeAttributeName,this.stateBeforeAttributeName(f)):this.decodeEntities&&f===t.Amp&&this.startEntity()}stateBeforeDeclaration(f){f===t.OpeningSquareBracket?(this.state=r.CDATASequence,this.sequenceIndex=0):this.state=f===t.Dash?r.BeforeComment:r.InDeclaration}stateInDeclaration(f){(f===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=r.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(f){(f===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=r.Text,this.sectionStart=this.index+1)}stateBeforeComment(f){f===t.Dash?(this.state=r.InCommentLike,this.currentSequence=c.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=r.InDeclaration}stateInSpecialComment(f){(f===t.Gt||this.fastForwardTo(t.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=r.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(f){const h=f|32;h===c.ScriptEnd[3]?this.startSpecial(c.ScriptEnd,4):h===c.StyleEnd[3]?this.startSpecial(c.StyleEnd,4):(this.state=r.InTagName,this.stateInTagName(f))}stateBeforeSpecialT(f){switch(f|32){case c.TitleEnd[3]:{this.startSpecial(c.TitleEnd,4);break}case c.TextareaEnd[3]:{this.startSpecial(c.TextareaEnd,4);break}case c.XmpEnd[3]:{this.startSpecial(c.XmpEnd,4);break}default:this.state=r.InTagName,this.stateInTagName(f)}}startEntity(){this.baseState=this.state,this.state=r.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?n.DecodingMode.Strict:this.baseState===r.Text||this.baseState===r.InSpecialTag?n.DecodingMode.Legacy:n.DecodingMode.Attribute)}stateInEntity(){const f=this.entityDecoder.write(this.buffer,this.index-this.offset);f>=0?(this.state=this.baseState,f===0&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===r.Text||this.state===r.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===r.InAttributeValueDq||this.state===r.InAttributeValueSq||this.state===r.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const f=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case r.Text:{this.stateText(f);break}case r.SpecialStartSequence:{this.stateSpecialStartSequence(f);break}case r.InSpecialTag:{this.stateInSpecialTag(f);break}case r.CDATASequence:{this.stateCDATASequence(f);break}case r.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(f);break}case r.InAttributeName:{this.stateInAttributeName(f);break}case r.InCommentLike:{this.stateInCommentLike(f);break}case r.InSpecialComment:{this.stateInSpecialComment(f);break}case r.BeforeAttributeName:{this.stateBeforeAttributeName(f);break}case r.InTagName:{this.stateInTagName(f);break}case r.InClosingTagName:{this.stateInClosingTagName(f);break}case r.BeforeTagName:{this.stateBeforeTagName(f);break}case r.AfterAttributeName:{this.stateAfterAttributeName(f);break}case r.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(f);break}case r.BeforeAttributeValue:{this.stateBeforeAttributeValue(f);break}case r.BeforeClosingTagName:{this.stateBeforeClosingTagName(f);break}case r.AfterClosingTagName:{this.stateAfterClosingTagName(f);break}case r.BeforeSpecialS:{this.stateBeforeSpecialS(f);break}case r.BeforeSpecialT:{this.stateBeforeSpecialT(f);break}case r.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(f);break}case r.InSelfClosingTag:{this.stateInSelfClosingTag(f);break}case r.InDeclaration:{this.stateInDeclaration(f);break}case r.BeforeDeclaration:{this.stateBeforeDeclaration(f);break}case r.BeforeComment:{this.stateBeforeComment(f);break}case r.InProcessingInstruction:{this.stateInProcessingInstruction(f);break}case r.InEntity:{this.stateInEntity();break}}this.index++}this.cleanup()}finish(){this.state===r.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const f=this.buffer.length+this.offset;this.sectionStart>=f||(this.state===r.InCommentLike?this.currentSequence===c.CdataEnd?this.cbs.oncdata(this.sectionStart,f,0):this.cbs.oncomment(this.sectionStart,f,0):this.state===r.InTagName||this.state===r.BeforeAttributeName||this.state===r.BeforeAttributeValue||this.state===r.AfterAttributeName||this.state===r.InAttributeName||this.state===r.InAttributeValueSq||this.state===r.InAttributeValueDq||this.state===r.InAttributeValueNq||this.state===r.InClosingTagName||this.cbs.ontext(this.sectionStart,f))}emitCodePoint(f,h){this.baseState!==r.Text&&this.baseState!==r.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+h,this.index=this.sectionStart-1,this.cbs.onattribentity(f)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+h,this.index=this.sectionStart-1,this.cbs.ontextentity(f,this.sectionStart))}}return Tokenizer$1.default=l,Tokenizer$1}var hasRequiredParser$1;function requireParser$1(){if(hasRequiredParser$1)return Parser$2;hasRequiredParser$1=1;var n=Parser$2&&Parser$2.__createBinding||(Object.create?function(S,T,w,A){A===void 0&&(A=w);var R=Object.getOwnPropertyDescriptor(T,w);(!R||("get"in R?!T.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return T[w]}}),Object.defineProperty(S,A,R)}:function(S,T,w,A){A===void 0&&(A=w),S[A]=T[w]}),t=Parser$2&&Parser$2.__setModuleDefault||(Object.create?function(S,T){Object.defineProperty(S,"default",{enumerable:!0,value:T})}:function(S,T){S.default=T}),r=Parser$2&&Parser$2.__importStar||function(){var S=function(T){return S=Object.getOwnPropertyNames||function(w){var A=[];for(var R in w)Object.prototype.hasOwnProperty.call(w,R)&&(A[A.length]=R);return A},S(T)};return function(T){if(T&&T.__esModule)return T;var w={};if(T!=null)for(var A=S(T),R=0;R<A.length;R++)A[R]!=="default"&&n(w,T,A[R]);return t(w,T),w}}();Object.defineProperty(Parser$2,"__esModule",{value:!0}),Parser$2.Parser=void 0;const a=r(requireTokenizer$1()),o=requireDecode$1(),u=new Set(["input","option","optgroup","select","button","datalist","textarea"]),s=new Set(["p"]),c=new Set(["thead","tbody"]),l=new Set(["dd","dt"]),d=new Set(["rt","rp"]),f=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",s],["h1",s],["h2",s],["h3",s],["h4",s],["h5",s],["h6",s],["select",u],["input",u],["output",u],["button",u],["datalist",u],["textarea",u],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",l],["dt",l],["address",s],["article",s],["aside",s],["blockquote",s],["details",s],["div",s],["dl",s],["fieldset",s],["figcaption",s],["figure",s],["footer",s],["form",s],["header",s],["hr",s],["main",s],["nav",s],["ol",s],["pre",s],["section",s],["table",s],["ul",s],["rt",d],["rp",d],["tbody",c],["tfoot",c]]),h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),v=new Set(["math","svg"]),g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),b=/\s|\//;class _{constructor(T,w={}){var A,R,E,I,L,F;this.options=w,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=T??{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=(A=w.lowerCaseTags)!==null&&A!==void 0?A:this.htmlMode,this.lowerCaseAttributeNames=(R=w.lowerCaseAttributeNames)!==null&&R!==void 0?R:this.htmlMode,this.recognizeSelfClosing=(E=w.recognizeSelfClosing)!==null&&E!==void 0?E:!this.htmlMode,this.tokenizer=new((I=w.Tokenizer)!==null&&I!==void 0?I:a.default)(this.options,this),this.foreignContext=[!this.htmlMode],(F=(L=this.cbs).onparserinit)===null||F===void 0||F.call(L,this)}ontext(T,w){var A,R;const E=this.getSlice(T,w);this.endIndex=w-1,(R=(A=this.cbs).ontext)===null||R===void 0||R.call(A,E),this.startIndex=w}ontextentity(T,w){var A,R;this.endIndex=w-1,(R=(A=this.cbs).ontext)===null||R===void 0||R.call(A,(0,o.fromCodePoint)(T)),this.startIndex=w}isVoidElement(T){return this.htmlMode&&h.has(T)}onopentagname(T,w){this.endIndex=w;let A=this.getSlice(T,w);this.lowerCaseTagNames&&(A=A.toLowerCase()),this.emitOpenTag(A)}emitOpenTag(T){var w,A,R,E;this.openTagStart=this.startIndex,this.tagname=T;const I=this.htmlMode&&f.get(T);if(I)for(;this.stack.length>0&&I.has(this.stack[0]);){const L=this.stack.shift();(A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,L,!0)}this.isVoidElement(T)||(this.stack.unshift(T),this.htmlMode&&(v.has(T)?this.foreignContext.unshift(!0):g.has(T)&&this.foreignContext.unshift(!1))),(E=(R=this.cbs).onopentagname)===null||E===void 0||E.call(R,T),this.cbs.onopentag&&(this.attribs={})}endOpenTag(T){var w,A;this.startIndex=this.openTagStart,this.attribs&&((A=(w=this.cbs).onopentag)===null||A===void 0||A.call(w,this.tagname,this.attribs,T),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(T){this.endIndex=T,this.endOpenTag(!1),this.startIndex=T+1}onclosetag(T,w){var A,R,E,I,L,F,D,$;this.endIndex=w;let O=this.getSlice(T,w);if(this.lowerCaseTagNames&&(O=O.toLowerCase()),this.htmlMode&&(v.has(O)||g.has(O))&&this.foreignContext.shift(),this.isVoidElement(O))this.htmlMode&&O==="br"&&((I=(E=this.cbs).onopentagname)===null||I===void 0||I.call(E,"br"),(F=(L=this.cbs).onopentag)===null||F===void 0||F.call(L,"br",{},!0),($=(D=this.cbs).onclosetag)===null||$===void 0||$.call(D,"br",!1));else{const P=this.stack.indexOf(O);if(P!==-1)for(let C=0;C<=P;C++){const q=this.stack.shift();(R=(A=this.cbs).onclosetag)===null||R===void 0||R.call(A,q,C!==P)}else this.htmlMode&&O==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=w+1}onselfclosingtag(T){this.endIndex=T,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=T+1):this.onopentagend(T)}closeCurrentTag(T){var w,A;const R=this.tagname;this.endOpenTag(T),this.stack[0]===R&&((A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,R,!T),this.stack.shift())}onattribname(T,w){this.startIndex=T;const A=this.getSlice(T,w);this.attribname=this.lowerCaseAttributeNames?A.toLowerCase():A}onattribdata(T,w){this.attribvalue+=this.getSlice(T,w)}onattribentity(T){this.attribvalue+=(0,o.fromCodePoint)(T)}onattribend(T,w){var A,R;this.endIndex=w,(R=(A=this.cbs).onattribute)===null||R===void 0||R.call(A,this.attribname,this.attribvalue,T===a.QuoteType.Double?'"':T===a.QuoteType.Single?"'":T===a.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(T){const w=T.search(b);let A=w<0?T:T.substr(0,w);return this.lowerCaseTagNames&&(A=A.toLowerCase()),A}ondeclaration(T,w){this.endIndex=w;const A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){const R=this.getInstructionName(A);this.cbs.onprocessinginstruction(`!${R}`,`!${A}`)}this.startIndex=w+1}onprocessinginstruction(T,w){this.endIndex=w;const A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){const R=this.getInstructionName(A);this.cbs.onprocessinginstruction(`?${R}`,`?${A}`)}this.startIndex=w+1}oncomment(T,w,A){var R,E,I,L;this.endIndex=w,(E=(R=this.cbs).oncomment)===null||E===void 0||E.call(R,this.getSlice(T,w-A)),(L=(I=this.cbs).oncommentend)===null||L===void 0||L.call(I),this.startIndex=w+1}oncdata(T,w,A){var R,E,I,L,F,D,$,O,P,C;this.endIndex=w;const q=this.getSlice(T,w-A);!this.htmlMode||this.options.recognizeCDATA?((E=(R=this.cbs).oncdatastart)===null||E===void 0||E.call(R),(L=(I=this.cbs).ontext)===null||L===void 0||L.call(I,q),(D=(F=this.cbs).oncdataend)===null||D===void 0||D.call(F)):((O=($=this.cbs).oncomment)===null||O===void 0||O.call($,`[CDATA[${q}]]`),(C=(P=this.cbs).oncommentend)===null||C===void 0||C.call(P)),this.startIndex=w+1}onend(){var T,w;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let A=0;A<this.stack.length;A++)this.cbs.onclosetag(this.stack[A],!0)}(w=(T=this.cbs).onend)===null||w===void 0||w.call(T)}reset(){var T,w,A,R;(w=(T=this.cbs).onreset)===null||w===void 0||w.call(T),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(R=(A=this.cbs).onparserinit)===null||R===void 0||R.call(A,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(T){this.reset(),this.end(T)}getSlice(T,w){for(;T-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let A=this.buffers[0].slice(T-this.bufferOffset,w-this.bufferOffset);for(;w-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),A+=this.buffers[0].slice(0,w-this.bufferOffset);return A}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".write() after done!"));return}this.buffers.push(T),this.tokenizer.running&&(this.tokenizer.write(T),this.writeIndex++)}end(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".end() after done!"));return}T&&this.write(T),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(T){this.write(T)}done(T){this.end(T)}}return Parser$2.Parser=_,Parser$2}var hasRequiredCommonjs;function requireCommonjs(){return hasRequiredCommonjs||(hasRequiredCommonjs=1,function(n){var t=commonjs&&commonjs.__createBinding||(Object.create?function(w,A,R,E){E===void 0&&(E=R);var I=Object.getOwnPropertyDescriptor(A,R);(!I||("get"in I?!A.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return A[R]}}),Object.defineProperty(w,E,I)}:function(w,A,R,E){E===void 0&&(E=R),w[E]=A[R]}),r=commonjs&&commonjs.__setModuleDefault||(Object.create?function(w,A){Object.defineProperty(w,"default",{enumerable:!0,value:A})}:function(w,A){w.default=A}),a=commonjs&&commonjs.__importStar||function(){var w=function(A){return w=Object.getOwnPropertyNames||function(R){var E=[];for(var I in R)Object.prototype.hasOwnProperty.call(R,I)&&(E[E.length]=I);return E},w(A)};return function(A){if(A&&A.__esModule)return A;var R={};if(A!=null)for(var E=w(A),I=0;I<E.length;I++)E[I]!=="default"&&t(R,A,E[I]);return r(R,A),R}}(),o=commonjs&&commonjs.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomUtils=n.getFeed=n.ElementType=n.QuoteType=n.Tokenizer=n.DefaultHandler=n.DomHandler=n.Parser=void 0,n.parseDocument=d,n.parseDOM=f,n.createDocumentStream=h,n.createDomStream=v,n.parseFeed=T;const u=requireParser$1();var s=requireParser$1();Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return s.Parser}});const c=requireLib$3o();var l=requireLib$3o();Object.defineProperty(n,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(n,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function d(w,A){const R=new c.DomHandler(void 0,A);return new u.Parser(R,A).end(w),R.root}function f(w,A){return d(w,A).children}function h(w,A,R){const E=new c.DomHandler(I=>w(I,E.root),A,R);return new u.Parser(E,A)}function v(w,A,R){const E=new c.DomHandler(w,A,R);return new u.Parser(E,A)}var g=requireTokenizer$1();Object.defineProperty(n,"Tokenizer",{enumerable:!0,get:function(){return o(g).default}}),Object.defineProperty(n,"QuoteType",{enumerable:!0,get:function(){return g.QuoteType}}),n.ElementType=a(requireLib$3p());const b=requireLib$3l();var _=requireLib$3l();Object.defineProperty(n,"getFeed",{enumerable:!0,get:function(){return _.getFeed}});const S={xmlMode:!0};function T(w,A=S){return(0,b.getFeed)(f(w,A))}n.DomUtils=a(requireLib$3l())}(commonjs)),commonjs}var hasRequiredActorRdfParseHtml$1;function requireActorRdfParseHtml$1(){if(hasRequiredActorRdfParseHtml$1)return ActorRdfParseHtml$1;hasRequiredActorRdfParseHtml$1=1,Object.defineProperty(ActorRdfParseHtml$1,"__esModule",{value:!0}),ActorRdfParseHtml$1.ActorRdfParseHtml=void 0;const n=requireLib$3s(),t=requireCommonjs(),r=requireBrowser();class a extends n.ActorRdfParseFixedMediaTypes{constructor(u){super(u)}async runHandle(u,s,c){var b;const l=new r.Readable({objectMode:!0});l._read=()=>{};let d=0,f=1;function h(_){l.emit("error",_)}function v(){--f===0&&l.push(null)}const g={baseIRI:((b=u.metadata)==null?void 0:b.baseIRI)??"",context:c,emit:_=>{d--,l.push(_)},end:v,error:h,headers:u.headers};try{const _=await Promise.all(this.busRdfParseHtml.publish(g));f+=_.length;const S=[];for(const A of _){const{htmlParseListener:R}=await A.actor.run(g,void 0);S.push(R)}const T=new t.Parser({onclosetag(){try{for(const A of S)A.onTagClose()}catch(A){h(A)}},onend(){try{for(const A of S)A.onEnd()}catch(A){h(A)}v()},onopentag(A,R){try{for(const E of S)E.onTagOpen(A,R)}catch(E){h(E)}},ontext(A){try{for(const R of S)R.onText(A)}catch(R){h(R)}}},{decodeEntities:!0,recognizeSelfClosing:!0,xmlMode:!1}),w=l._read=A=>{for(d=Math.max(A,d);d>0;){const R=u.data.read();if(R===null){u.data.once("readable",()=>w(0));return}T.write(R.toString())}};u.data.on("error",h).on("end",()=>T.end())}catch(_){setTimeout(()=>{l.emit("error",_)})}return{data:l}}}return ActorRdfParseHtml$1.ActorRdfParseHtml=a,ActorRdfParseHtml$1}var hasRequiredLib$3g;function requireLib$3g(){return hasRequiredLib$3g||(hasRequiredLib$3g=1,function(n){var t=lib$3g&&lib$3g.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3g&&lib$3g.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseHtml$1(),n)}(lib$3g)),lib$3g}var lib$3f={},ActorRdfParseHtmlMicrodata={},lib$3e={},ActorRdfParseHtml={},hasRequiredActorRdfParseHtml;function requireActorRdfParseHtml(){if(hasRequiredActorRdfParseHtml)return ActorRdfParseHtml;hasRequiredActorRdfParseHtml=1,Object.defineProperty(ActorRdfParseHtml,"__esModule",{value:!0}),ActorRdfParseHtml.ActorRdfParseHtml=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfParseHtml.ActorRdfParseHtml=t,ActorRdfParseHtml}var hasRequiredLib$3f;function requireLib$3f(){return hasRequiredLib$3f||(hasRequiredLib$3f=1,function(n){var t=lib$3e&&lib$3e.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3e&&lib$3e.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseHtml(),n)}(lib$3e)),lib$3e}var microdataRdfStreamingParser={},IItemPropertyHandler={},hasRequiredIItemPropertyHandler;function requireIItemPropertyHandler(){return hasRequiredIItemPropertyHandler||(hasRequiredIItemPropertyHandler=1,Object.defineProperty(IItemPropertyHandler,"__esModule",{value:!0})),IItemPropertyHandler}var ItemPropertyHandlerContent={},hasRequiredItemPropertyHandlerContent;function requireItemPropertyHandlerContent(){if(hasRequiredItemPropertyHandlerContent)return ItemPropertyHandlerContent;hasRequiredItemPropertyHandlerContent=1,Object.defineProperty(ItemPropertyHandlerContent,"__esModule",{value:!0}),ItemPropertyHandlerContent.ItemPropertyHandlerContent=void 0;let n=class{canHandle(r,a){return"content"in a}getObject(r,a,o){return a.createLiteral(r.content,o)}};return ItemPropertyHandlerContent.ItemPropertyHandlerContent=n,ItemPropertyHandlerContent}var ItemPropertyHandlerNumber={},Util$5={},hasRequiredUtil$5;function requireUtil$5(){if(hasRequiredUtil$5)return Util$5;hasRequiredUtil$5=1,Object.defineProperty(Util$5,"__esModule",{value:!0}),Util$5.Util=void 0;const n=requireRdfDataFactory(),t=requireRelativeToAbsoluteIri();class r{constructor(o,u){this.dataFactory=o||new n.DataFactory,this.baseIRI=u||""}static isValidIri(o){return r.IRI_REGEX.test(o)}createVocabIris(o,u,s){return o.split(/\s+/u).filter(c=>!!c).map(c=>{if(!r.isValidIri(c)){if(!s)return;c=`${u.vocab||`${this.baseIRI}#`}${c}`}return this.dataFactory.namedNode(c)}).filter(c=>!!c)}getVocabularyExpansionType(o,u,s){const c=o.split(/\s+/u);if(c.includes("subPropertyOf")||c.includes("equivalentProperty"))return[this.dataFactory.namedNode(`${r.RDF}type`)];if(u.vocab&&u.vocab in s&&s[u.vocab].properties){let l=[];for(const[d,f]of Object.entries(s[u.vocab].properties))c.includes(d)&&(l=[...Object.values(f).map(h=>this.dataFactory.namedNode(h))]);return l}return[]}createSubject(o){if(!r.isValidIri(o))try{o=(0,t.resolve)(o,this.baseIRI)}catch{return}return this.dataFactory.namedNode(o)}createLiteral(o,u){return this.dataFactory.literal(o,u.language)}deriveVocab(o,u){let s;for(const c in u)if(o.startsWith(c)){s=c,s.endsWith("/")||(s+="#");break}if(!s){const c=o.indexOf("#");c>0?s=o.slice(0,c+1):s=(0,t.resolve)(".",o)}return s}}return Util$5.Util=r,r.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r.XSD="http://www.w3.org/2001/XMLSchema#",r.RDFA="http://www.w3.org/ns/rdfa#",r.IRI_REGEX=/^([A-Za-z][\d+-.A-Za-z]*|_):[^ "<>[\\\]`{|}]*$/u,Util$5}var hasRequiredItemPropertyHandlerNumber;function requireItemPropertyHandlerNumber(){if(hasRequiredItemPropertyHandlerNumber)return ItemPropertyHandlerNumber;hasRequiredItemPropertyHandlerNumber=1,Object.defineProperty(ItemPropertyHandlerNumber,"__esModule",{value:!0}),ItemPropertyHandlerNumber.ItemPropertyHandlerNumber=void 0;const n=requireUtil$5();let t=class{constructor(a,o){this.tagName=a,this.attributeName=o}canHandle(a,o){return this.tagName===a&&this.attributeName in o}getObject(a,o,u){const s=a[this.attributeName];let c;return!Number.isNaN(Number.parseInt(s,10))&&!s.includes(".")?c=`${n.Util.XSD}integer`:Number.isNaN(Number.parseFloat(s))||(c=`${n.Util.XSD}double`),o.dataFactory.literal(s,c&&o.dataFactory.namedNode(c))}};return ItemPropertyHandlerNumber.ItemPropertyHandlerNumber=t,ItemPropertyHandlerNumber}var ItemPropertyHandlerTime={},hasRequiredItemPropertyHandlerTime;function requireItemPropertyHandlerTime(){if(hasRequiredItemPropertyHandlerTime)return ItemPropertyHandlerTime;hasRequiredItemPropertyHandlerTime=1,Object.defineProperty(ItemPropertyHandlerTime,"__esModule",{value:!0}),ItemPropertyHandlerTime.ItemPropertyHandlerTime=void 0;const n=requireUtil$5();let t=class ra{canHandle(a,o){return a==="time"&&"datetime"in o}getObject(a,o,u){const s=a.datetime;let c;for(const l of ra.TIME_REGEXES)if(l.regex.test(s)){c=o.dataFactory.namedNode(n.Util.XSD+l.type);break}return o.dataFactory.literal(s,c)}};return ItemPropertyHandlerTime.ItemPropertyHandlerTime=t,t.TIME_REGEXES=[{regex:/^-?P(\d+Y)?(\d+M)?(\d+D)?(T(\d+H)?(\d+M)?(\d+(\.\d)?S)?)?$/u,type:"duration"},{regex:/^\d+-\d\d-\d\dT\d\d:\d\d:\d\d((Z?)|([+-]\d\d:\d\d))$/u,type:"dateTime"},{regex:/^\d+-\d\d-\d\dZ?$/u,type:"date"},{regex:/^\d\d:\d\d:\d\d((Z?)|([+-]\d\d:\d\d))$/u,type:"time"},{regex:/^\d+-\d\d$/u,type:"gYearMonth"},{regex:/^\d+$/u,type:"gYear"}],ItemPropertyHandlerTime}var ItemPropertyHandlerUrl={},hasRequiredItemPropertyHandlerUrl;function requireItemPropertyHandlerUrl(){if(hasRequiredItemPropertyHandlerUrl)return ItemPropertyHandlerUrl;hasRequiredItemPropertyHandlerUrl=1,Object.defineProperty(ItemPropertyHandlerUrl,"__esModule",{value:!0}),ItemPropertyHandlerUrl.ItemPropertyHandlerUrl=void 0;const n=requireRelativeToAbsoluteIri();let t=class{constructor(a,o){this.tagName=a,this.attributeName=o}canHandle(a,o){return this.tagName===a&&this.attributeName in o}getObject(a,o,u){return o.dataFactory.namedNode((0,n.resolve)(a[this.attributeName],o.baseIRI))}};return ItemPropertyHandlerUrl.ItemPropertyHandlerUrl=t,ItemPropertyHandlerUrl}var IHtmlParseListener={},hasRequiredIHtmlParseListener;function requireIHtmlParseListener(){return hasRequiredIHtmlParseListener||(hasRequiredIHtmlParseListener=1,Object.defineProperty(IHtmlParseListener,"__esModule",{value:!0})),IHtmlParseListener}var IItemScope={},hasRequiredIItemScope;function requireIItemScope(){return hasRequiredIItemScope||(hasRequiredIItemScope=1,Object.defineProperty(IItemScope,"__esModule",{value:!0})),IItemScope}var IVocabRegistry={},hasRequiredIVocabRegistry;function requireIVocabRegistry(){return hasRequiredIVocabRegistry||(hasRequiredIVocabRegistry=1,Object.defineProperty(IVocabRegistry,"__esModule",{value:!0})),IVocabRegistry}var MicrodataRdfParser={},lib$3d={},Parser$1={},Tokenizer={},decode={},decodeDataHtml={},hasRequiredDecodeDataHtml;function requireDecodeDataHtml(){return hasRequiredDecodeDataHtml||(hasRequiredDecodeDataHtml=1,Object.defineProperty(decodeDataHtml,"__esModule",{value:!0}),decodeDataHtml.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(n){return n.charCodeAt(0)}))),decodeDataHtml}var decodeDataXml={},hasRequiredDecodeDataXml;function requireDecodeDataXml(){return hasRequiredDecodeDataXml||(hasRequiredDecodeDataXml=1,Object.defineProperty(decodeDataXml,"__esModule",{value:!0}),decodeDataXml.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(n){return n.charCodeAt(0)}))),decodeDataXml}var decode_codepoint={},hasRequiredDecode_codepoint;function requireDecode_codepoint(){return hasRequiredDecode_codepoint||(hasRequiredDecode_codepoint=1,function(n){var t;Object.defineProperty(n,"__esModule",{value:!0}),n.replaceCodePoint=n.fromCodePoint=void 0;var r=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);n.fromCodePoint=(t=String.fromCodePoint)!==null&&t!==void 0?t:function(u){var s="";return u>65535&&(u-=65536,s+=String.fromCharCode(u>>>10&1023|55296),u=56320|u&1023),s+=String.fromCharCode(u),s};function a(u){var s;return u>=55296&&u<=57343||u>1114111?65533:(s=r.get(u))!==null&&s!==void 0?s:u}n.replaceCodePoint=a;function o(u){return(0,n.fromCodePoint)(a(u))}n.default=o}(decode_codepoint)),decode_codepoint}var hasRequiredDecode;function requireDecode(){return hasRequiredDecode||(hasRequiredDecode=1,function(n){var t=decode&&decode.__createBinding||(Object.create?function(O,P,C,q){q===void 0&&(q=C);var M=Object.getOwnPropertyDescriptor(P,C);(!M||("get"in M?!P.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return P[C]}}),Object.defineProperty(O,q,M)}:function(O,P,C,q){q===void 0&&(q=C),O[q]=P[C]}),r=decode&&decode.__setModuleDefault||(Object.create?function(O,P){Object.defineProperty(O,"default",{enumerable:!0,value:P})}:function(O,P){O.default=P}),a=decode&&decode.__importStar||function(O){if(O&&O.__esModule)return O;var P={};if(O!=null)for(var C in O)C!=="default"&&Object.prototype.hasOwnProperty.call(O,C)&&t(P,O,C);return r(P,O),P},o=decode&&decode.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(n,"__esModule",{value:!0}),n.decodeXML=n.decodeHTMLStrict=n.decodeHTMLAttribute=n.decodeHTML=n.determineBranch=n.EntityDecoder=n.DecodingMode=n.BinTrieFlags=n.fromCodePoint=n.replaceCodePoint=n.decodeCodePoint=n.xmlDecodeTree=n.htmlDecodeTree=void 0;var u=o(requireDecodeDataHtml());n.htmlDecodeTree=u.default;var s=o(requireDecodeDataXml());n.xmlDecodeTree=s.default;var c=a(requireDecode_codepoint());n.decodeCodePoint=c.default;var l=requireDecode_codepoint();Object.defineProperty(n,"replaceCodePoint",{enumerable:!0,get:function(){return l.replaceCodePoint}}),Object.defineProperty(n,"fromCodePoint",{enumerable:!0,get:function(){return l.fromCodePoint}});var d;(function(O){O[O.NUM=35]="NUM",O[O.SEMI=59]="SEMI",O[O.EQUALS=61]="EQUALS",O[O.ZERO=48]="ZERO",O[O.NINE=57]="NINE",O[O.LOWER_A=97]="LOWER_A",O[O.LOWER_F=102]="LOWER_F",O[O.LOWER_X=120]="LOWER_X",O[O.LOWER_Z=122]="LOWER_Z",O[O.UPPER_A=65]="UPPER_A",O[O.UPPER_F=70]="UPPER_F",O[O.UPPER_Z=90]="UPPER_Z"})(d||(d={}));var f=32,h;(function(O){O[O.VALUE_LENGTH=49152]="VALUE_LENGTH",O[O.BRANCH_LENGTH=16256]="BRANCH_LENGTH",O[O.JUMP_TABLE=127]="JUMP_TABLE"})(h=n.BinTrieFlags||(n.BinTrieFlags={}));function v(O){return O>=d.ZERO&&O<=d.NINE}function g(O){return O>=d.UPPER_A&&O<=d.UPPER_F||O>=d.LOWER_A&&O<=d.LOWER_F}function b(O){return O>=d.UPPER_A&&O<=d.UPPER_Z||O>=d.LOWER_A&&O<=d.LOWER_Z||v(O)}function _(O){return O===d.EQUALS||b(O)}var S;(function(O){O[O.EntityStart=0]="EntityStart",O[O.NumericStart=1]="NumericStart",O[O.NumericDecimal=2]="NumericDecimal",O[O.NumericHex=3]="NumericHex",O[O.NamedEntity=4]="NamedEntity"})(S||(S={}));var T;(function(O){O[O.Legacy=0]="Legacy",O[O.Strict=1]="Strict",O[O.Attribute=2]="Attribute"})(T=n.DecodingMode||(n.DecodingMode={}));var w=function(){function O(P,C,q){this.decodeTree=P,this.emitCodePoint=C,this.errors=q,this.state=S.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=T.Strict}return O.prototype.startEntity=function(P){this.decodeMode=P,this.state=S.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},O.prototype.write=function(P,C){switch(this.state){case S.EntityStart:return P.charCodeAt(C)===d.NUM?(this.state=S.NumericStart,this.consumed+=1,this.stateNumericStart(P,C+1)):(this.state=S.NamedEntity,this.stateNamedEntity(P,C));case S.NumericStart:return this.stateNumericStart(P,C);case S.NumericDecimal:return this.stateNumericDecimal(P,C);case S.NumericHex:return this.stateNumericHex(P,C);case S.NamedEntity:return this.stateNamedEntity(P,C)}},O.prototype.stateNumericStart=function(P,C){return C>=P.length?-1:(P.charCodeAt(C)|f)===d.LOWER_X?(this.state=S.NumericHex,this.consumed+=1,this.stateNumericHex(P,C+1)):(this.state=S.NumericDecimal,this.stateNumericDecimal(P,C))},O.prototype.addToNumericResult=function(P,C,q,M){if(C!==q){var N=q-C;this.result=this.result*Math.pow(M,N)+parseInt(P.substr(C,N),M),this.consumed+=N}},O.prototype.stateNumericHex=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M)||g(M))C+=1;else return this.addToNumericResult(P,q,C,16),this.emitNumericEntity(M,3)}return this.addToNumericResult(P,q,C,16),-1},O.prototype.stateNumericDecimal=function(P,C){for(var q=C;C<P.length;){var M=P.charCodeAt(C);if(v(M))C+=1;else return this.addToNumericResult(P,q,C,10),this.emitNumericEntity(M,2)}return this.addToNumericResult(P,q,C,10),-1},O.prototype.emitNumericEntity=function(P,C){var q;if(this.consumed<=C)return(q=this.errors)===null||q===void 0||q.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(P===d.SEMI)this.consumed+=1;else if(this.decodeMode===T.Strict)return 0;return this.emitCodePoint((0,c.replaceCodePoint)(this.result),this.consumed),this.errors&&(P!==d.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},O.prototype.stateNamedEntity=function(P,C){for(var q=this.decodeTree,M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14;C<P.length;C++,this.excess++){var G=P.charCodeAt(C);if(this.treeIndex=R(q,M,this.treeIndex+Math.max(1,N),G),this.treeIndex<0)return this.result===0||this.decodeMode===T.Attribute&&(N===0||_(G))?0:this.emitNotTerminatedNamedEntity();if(M=q[this.treeIndex],N=(M&h.VALUE_LENGTH)>>14,N!==0){if(G===d.SEMI)return this.emitNamedEntityData(this.treeIndex,N,this.consumed+this.excess);this.decodeMode!==T.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},O.prototype.emitNotTerminatedNamedEntity=function(){var P,C=this,q=C.result,M=C.decodeTree,N=(M[q]&h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(q,N,this.consumed),(P=this.errors)===null||P===void 0||P.missingSemicolonAfterCharacterReference(),this.consumed},O.prototype.emitNamedEntityData=function(P,C,q){var M=this.decodeTree;return this.emitCodePoint(C===1?M[P]&~h.VALUE_LENGTH:M[P+1],q),C===3&&this.emitCodePoint(M[P+2],q),q},O.prototype.end=function(){var P;switch(this.state){case S.NamedEntity:return this.result!==0&&(this.decodeMode!==T.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case S.NumericDecimal:return this.emitNumericEntity(0,2);case S.NumericHex:return this.emitNumericEntity(0,3);case S.NumericStart:return(P=this.errors)===null||P===void 0||P.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case S.EntityStart:return 0}},O}();n.EntityDecoder=w;function A(O){var P="",C=new w(O,function(q){return P+=(0,c.fromCodePoint)(q)});return function(M,N){for(var G=0,X=0;(X=M.indexOf("&",X))>=0;){P+=M.slice(G,X),C.startEntity(N);var Y=C.write(M,X+1);if(Y<0){G=X+C.end();break}G=X+Y,X=Y===0?G+1:G}var W=P+M.slice(G);return P="",W}}function R(O,P,C,q){var M=(P&h.BRANCH_LENGTH)>>7,N=P&h.JUMP_TABLE;if(M===0)return N!==0&&q===N?C:-1;if(N){var G=q-N;return G<0||G>=M?-1:O[C+G]-1}for(var X=C,Y=X+M-1;X<=Y;){var W=X+Y>>>1,te=O[W];if(te<q)X=W+1;else if(te>q)Y=W-1;else return O[W+M]}return-1}n.determineBranch=R;var E=A(u.default),I=A(s.default);function L(O,P){return P===void 0&&(P=T.Legacy),E(O,P)}n.decodeHTML=L;function F(O){return E(O,T.Attribute)}n.decodeHTMLAttribute=F;function D(O){return E(O,T.Strict)}n.decodeHTMLStrict=D;function $(O){return I(O,T.Strict)}n.decodeXML=$}(decode)),decode}var hasRequiredTokenizer;function requireTokenizer(){return hasRequiredTokenizer||(hasRequiredTokenizer=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuoteType=void 0;var t=requireDecode(),r;(function(v){v[v.Tab=9]="Tab",v[v.NewLine=10]="NewLine",v[v.FormFeed=12]="FormFeed",v[v.CarriageReturn=13]="CarriageReturn",v[v.Space=32]="Space",v[v.ExclamationMark=33]="ExclamationMark",v[v.Number=35]="Number",v[v.Amp=38]="Amp",v[v.SingleQuote=39]="SingleQuote",v[v.DoubleQuote=34]="DoubleQuote",v[v.Dash=45]="Dash",v[v.Slash=47]="Slash",v[v.Zero=48]="Zero",v[v.Nine=57]="Nine",v[v.Semi=59]="Semi",v[v.Lt=60]="Lt",v[v.Eq=61]="Eq",v[v.Gt=62]="Gt",v[v.Questionmark=63]="Questionmark",v[v.UpperA=65]="UpperA",v[v.LowerA=97]="LowerA",v[v.UpperF=70]="UpperF",v[v.LowerF=102]="LowerF",v[v.UpperZ=90]="UpperZ",v[v.LowerZ=122]="LowerZ",v[v.LowerX=120]="LowerX",v[v.OpeningSquareBracket=91]="OpeningSquareBracket"})(r||(r={}));var a;(function(v){v[v.Text=1]="Text",v[v.BeforeTagName=2]="BeforeTagName",v[v.InTagName=3]="InTagName",v[v.InSelfClosingTag=4]="InSelfClosingTag",v[v.BeforeClosingTagName=5]="BeforeClosingTagName",v[v.InClosingTagName=6]="InClosingTagName",v[v.AfterClosingTagName=7]="AfterClosingTagName",v[v.BeforeAttributeName=8]="BeforeAttributeName",v[v.InAttributeName=9]="InAttributeName",v[v.AfterAttributeName=10]="AfterAttributeName",v[v.BeforeAttributeValue=11]="BeforeAttributeValue",v[v.InAttributeValueDq=12]="InAttributeValueDq",v[v.InAttributeValueSq=13]="InAttributeValueSq",v[v.InAttributeValueNq=14]="InAttributeValueNq",v[v.BeforeDeclaration=15]="BeforeDeclaration",v[v.InDeclaration=16]="InDeclaration",v[v.InProcessingInstruction=17]="InProcessingInstruction",v[v.BeforeComment=18]="BeforeComment",v[v.CDATASequence=19]="CDATASequence",v[v.InSpecialComment=20]="InSpecialComment",v[v.InCommentLike=21]="InCommentLike",v[v.BeforeSpecialS=22]="BeforeSpecialS",v[v.SpecialStartSequence=23]="SpecialStartSequence",v[v.InSpecialTag=24]="InSpecialTag",v[v.BeforeEntity=25]="BeforeEntity",v[v.BeforeNumericEntity=26]="BeforeNumericEntity",v[v.InNamedEntity=27]="InNamedEntity",v[v.InNumericEntity=28]="InNumericEntity",v[v.InHexEntity=29]="InHexEntity"})(a||(a={}));function o(v){return v===r.Space||v===r.NewLine||v===r.Tab||v===r.FormFeed||v===r.CarriageReturn}function u(v){return v===r.Slash||v===r.Gt||o(v)}function s(v){return v>=r.Zero&&v<=r.Nine}function c(v){return v>=r.LowerA&&v<=r.LowerZ||v>=r.UpperA&&v<=r.UpperZ}function l(v){return v>=r.UpperA&&v<=r.UpperF||v>=r.LowerA&&v<=r.LowerF}var d;(function(v){v[v.NoValue=0]="NoValue",v[v.Unquoted=1]="Unquoted",v[v.Single=2]="Single",v[v.Double=3]="Double"})(d=n.QuoteType||(n.QuoteType={}));var f={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},h=function(){function v(g,b){var _=g.xmlMode,S=_===void 0?!1:_,T=g.decodeEntities,w=T===void 0?!0:T;this.cbs=b,this.state=a.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=a.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=S,this.decodeEntities=w,this.entityTrie=S?t.xmlDecodeTree:t.htmlDecodeTree}return v.prototype.reset=function(){this.state=a.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=a.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},v.prototype.write=function(g){this.offset+=this.buffer.length,this.buffer=g,this.parse()},v.prototype.end=function(){this.running&&this.finish()},v.prototype.pause=function(){this.running=!1},v.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},v.prototype.getIndex=function(){return this.index},v.prototype.getSectionStart=function(){return this.sectionStart},v.prototype.stateText=function(g){g===r.Lt||!this.decodeEntities&&this.fastForwardTo(r.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=a.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&g===r.Amp&&(this.state=a.BeforeEntity)},v.prototype.stateSpecialStartSequence=function(g){var b=this.sequenceIndex===this.currentSequence.length,_=b?u(g):(g|32)===this.currentSequence[this.sequenceIndex];if(!_)this.isSpecial=!1;else if(!b){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=a.InTagName,this.stateInTagName(g)},v.prototype.stateInSpecialTag=function(g){if(this.sequenceIndex===this.currentSequence.length){if(g===r.Gt||o(g)){var b=this.index-this.currentSequence.length;if(this.sectionStart<b){var _=this.index;this.index=b,this.cbs.ontext(this.sectionStart,b),this.index=_}this.isSpecial=!1,this.sectionStart=b+2,this.stateInClosingTagName(g);return}this.sequenceIndex=0}(g|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===f.TitleEnd?this.decodeEntities&&g===r.Amp&&(this.state=a.BeforeEntity):this.fastForwardTo(r.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(g===r.Lt)},v.prototype.stateCDATASequence=function(g){g===f.Cdata[this.sequenceIndex]?++this.sequenceIndex===f.Cdata.length&&(this.state=a.InCommentLike,this.currentSequence=f.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=a.InDeclaration,this.stateInDeclaration(g))},v.prototype.fastForwardTo=function(g){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===g)return!0;return this.index=this.buffer.length+this.offset-1,!1},v.prototype.stateInCommentLike=function(g){g===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===f.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=a.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):g!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},v.prototype.isTagStartChar=function(g){return this.xmlMode?!u(g):c(g)},v.prototype.startSpecial=function(g,b){this.isSpecial=!0,this.currentSequence=g,this.sequenceIndex=b,this.state=a.SpecialStartSequence},v.prototype.stateBeforeTagName=function(g){if(g===r.ExclamationMark)this.state=a.BeforeDeclaration,this.sectionStart=this.index+1;else if(g===r.Questionmark)this.state=a.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(g)){var b=g|32;this.sectionStart=this.index,!this.xmlMode&&b===f.TitleEnd[2]?this.startSpecial(f.TitleEnd,3):this.state=!this.xmlMode&&b===f.ScriptEnd[2]?a.BeforeSpecialS:a.InTagName}else g===r.Slash?this.state=a.BeforeClosingTagName:(this.state=a.Text,this.stateText(g))},v.prototype.stateInTagName=function(g){u(g)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g))},v.prototype.stateBeforeClosingTagName=function(g){o(g)||(g===r.Gt?this.state=a.Text:(this.state=this.isTagStartChar(g)?a.InClosingTagName:a.InSpecialComment,this.sectionStart=this.index))},v.prototype.stateInClosingTagName=function(g){(g===r.Gt||o(g))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.AfterClosingTagName,this.stateAfterClosingTagName(g))},v.prototype.stateAfterClosingTagName=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.state=a.Text,this.baseState=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeAttributeName=function(g){g===r.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=a.InSpecialTag,this.sequenceIndex=0):this.state=a.Text,this.baseState=this.state,this.sectionStart=this.index+1):g===r.Slash?this.state=a.InSelfClosingTag:o(g)||(this.state=a.InAttributeName,this.sectionStart=this.index)},v.prototype.stateInSelfClosingTag=function(g){g===r.Gt?(this.cbs.onselfclosingtag(this.index),this.state=a.Text,this.baseState=a.Text,this.sectionStart=this.index+1,this.isSpecial=!1):o(g)||(this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g))},v.prototype.stateInAttributeName=function(g){(g===r.Eq||u(g))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=a.AfterAttributeName,this.stateAfterAttributeName(g))},v.prototype.stateAfterAttributeName=function(g){g===r.Eq?this.state=a.BeforeAttributeValue:g===r.Slash||g===r.Gt?(this.cbs.onattribend(d.NoValue,this.index),this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g)):o(g)||(this.cbs.onattribend(d.NoValue,this.index),this.state=a.InAttributeName,this.sectionStart=this.index)},v.prototype.stateBeforeAttributeValue=function(g){g===r.DoubleQuote?(this.state=a.InAttributeValueDq,this.sectionStart=this.index+1):g===r.SingleQuote?(this.state=a.InAttributeValueSq,this.sectionStart=this.index+1):o(g)||(this.sectionStart=this.index,this.state=a.InAttributeValueNq,this.stateInAttributeValueNoQuotes(g))},v.prototype.handleInAttributeValue=function(g,b){g===b||!this.decodeEntities&&this.fastForwardTo(b)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(b===r.DoubleQuote?d.Double:d.Single,this.index),this.state=a.BeforeAttributeName):this.decodeEntities&&g===r.Amp&&(this.baseState=this.state,this.state=a.BeforeEntity)},v.prototype.stateInAttributeValueDoubleQuotes=function(g){this.handleInAttributeValue(g,r.DoubleQuote)},v.prototype.stateInAttributeValueSingleQuotes=function(g){this.handleInAttributeValue(g,r.SingleQuote)},v.prototype.stateInAttributeValueNoQuotes=function(g){o(g)||g===r.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(d.Unquoted,this.index),this.state=a.BeforeAttributeName,this.stateBeforeAttributeName(g)):this.decodeEntities&&g===r.Amp&&(this.baseState=this.state,this.state=a.BeforeEntity)},v.prototype.stateBeforeDeclaration=function(g){g===r.OpeningSquareBracket?(this.state=a.CDATASequence,this.sequenceIndex=0):this.state=g===r.Dash?a.BeforeComment:a.InDeclaration},v.prototype.stateInDeclaration=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateInProcessingInstruction=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeComment=function(g){g===r.Dash?(this.state=a.InCommentLike,this.currentSequence=f.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=a.InDeclaration},v.prototype.stateInSpecialComment=function(g){(g===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=a.Text,this.sectionStart=this.index+1)},v.prototype.stateBeforeSpecialS=function(g){var b=g|32;b===f.ScriptEnd[3]?this.startSpecial(f.ScriptEnd,4):b===f.StyleEnd[3]?this.startSpecial(f.StyleEnd,4):(this.state=a.InTagName,this.stateInTagName(g))},v.prototype.stateBeforeEntity=function(g){this.entityExcess=1,this.entityResult=0,g===r.Number?this.state=a.BeforeNumericEntity:g===r.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=a.InNamedEntity,this.stateInNamedEntity(g))},v.prototype.stateInNamedEntity=function(g){if(this.entityExcess+=1,this.trieIndex=(0,t.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,g),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var b=this.trieCurrent&t.BinTrieFlags.VALUE_LENGTH;if(b){var _=(b>>14)-1;if(!this.allowLegacyEntity()&&g!==r.Semi)this.trieIndex+=_;else{var S=this.index-this.entityExcess+1;S>this.sectionStart&&this.emitPartial(this.sectionStart,S),this.entityResult=this.trieIndex,this.trieIndex+=_,this.entityExcess=0,this.sectionStart=this.index+1,_===0&&this.emitNamedEntity()}}},v.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var g=(this.entityTrie[this.entityResult]&t.BinTrieFlags.VALUE_LENGTH)>>14;switch(g){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~t.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},v.prototype.stateBeforeNumericEntity=function(g){(g|32)===r.LowerX?(this.entityExcess++,this.state=a.InHexEntity):(this.state=a.InNumericEntity,this.stateInNumericEntity(g))},v.prototype.emitNumericEntity=function(g){var b=this.index-this.entityExcess-1,_=b+2+ +(this.state===a.InHexEntity);_!==this.index&&(b>this.sectionStart&&this.emitPartial(this.sectionStart,b),this.sectionStart=this.index+Number(g),this.emitCodePoint((0,t.replaceCodePoint)(this.entityResult))),this.state=this.baseState},v.prototype.stateInNumericEntity=function(g){g===r.Semi?this.emitNumericEntity(!0):s(g)?(this.entityResult=this.entityResult*10+(g-r.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},v.prototype.stateInHexEntity=function(g){g===r.Semi?this.emitNumericEntity(!0):s(g)?(this.entityResult=this.entityResult*16+(g-r.Zero),this.entityExcess++):l(g)?(this.entityResult=this.entityResult*16+((g|32)-r.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},v.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===a.Text||this.baseState===a.InSpecialTag)},v.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===a.Text||this.state===a.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===a.InAttributeValueDq||this.state===a.InAttributeValueSq||this.state===a.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},v.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},v.prototype.parse=function(){for(;this.shouldContinue();){var g=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case a.Text:{this.stateText(g);break}case a.SpecialStartSequence:{this.stateSpecialStartSequence(g);break}case a.InSpecialTag:{this.stateInSpecialTag(g);break}case a.CDATASequence:{this.stateCDATASequence(g);break}case a.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(g);break}case a.InAttributeName:{this.stateInAttributeName(g);break}case a.InCommentLike:{this.stateInCommentLike(g);break}case a.InSpecialComment:{this.stateInSpecialComment(g);break}case a.BeforeAttributeName:{this.stateBeforeAttributeName(g);break}case a.InTagName:{this.stateInTagName(g);break}case a.InClosingTagName:{this.stateInClosingTagName(g);break}case a.BeforeTagName:{this.stateBeforeTagName(g);break}case a.AfterAttributeName:{this.stateAfterAttributeName(g);break}case a.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(g);break}case a.BeforeAttributeValue:{this.stateBeforeAttributeValue(g);break}case a.BeforeClosingTagName:{this.stateBeforeClosingTagName(g);break}case a.AfterClosingTagName:{this.stateAfterClosingTagName(g);break}case a.BeforeSpecialS:{this.stateBeforeSpecialS(g);break}case a.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(g);break}case a.InSelfClosingTag:{this.stateInSelfClosingTag(g);break}case a.InDeclaration:{this.stateInDeclaration(g);break}case a.BeforeDeclaration:{this.stateBeforeDeclaration(g);break}case a.BeforeComment:{this.stateBeforeComment(g);break}case a.InProcessingInstruction:{this.stateInProcessingInstruction(g);break}case a.InNamedEntity:{this.stateInNamedEntity(g);break}case a.BeforeEntity:{this.stateBeforeEntity(g);break}case a.InHexEntity:{this.stateInHexEntity(g);break}case a.InNumericEntity:{this.stateInNumericEntity(g);break}default:this.stateBeforeNumericEntity(g)}this.index++}this.cleanup()},v.prototype.finish=function(){this.state===a.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},v.prototype.handleTrailingData=function(){var g=this.buffer.length+this.offset;this.state===a.InCommentLike?this.currentSequence===f.CdataEnd?this.cbs.oncdata(this.sectionStart,g,0):this.cbs.oncomment(this.sectionStart,g,0):this.state===a.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===a.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===a.InTagName||this.state===a.BeforeAttributeName||this.state===a.BeforeAttributeValue||this.state===a.AfterAttributeName||this.state===a.InAttributeName||this.state===a.InAttributeValueSq||this.state===a.InAttributeValueDq||this.state===a.InAttributeValueNq||this.state===a.InClosingTagName||this.cbs.ontext(this.sectionStart,g)},v.prototype.emitPartial=function(g,b){this.baseState!==a.Text&&this.baseState!==a.InSpecialTag?this.cbs.onattribdata(g,b):this.cbs.ontext(g,b)},v.prototype.emitCodePoint=function(g){this.baseState!==a.Text&&this.baseState!==a.InSpecialTag?this.cbs.onattribentity(g):this.cbs.ontextentity(g)},v}();n.default=h}(Tokenizer)),Tokenizer}var hasRequiredParser;function requireParser(){if(hasRequiredParser)return Parser$1;hasRequiredParser=1;var n=Parser$1&&Parser$1.__createBinding||(Object.create?function(S,T,w,A){A===void 0&&(A=w);var R=Object.getOwnPropertyDescriptor(T,w);(!R||("get"in R?!T.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return T[w]}}),Object.defineProperty(S,A,R)}:function(S,T,w,A){A===void 0&&(A=w),S[A]=T[w]}),t=Parser$1&&Parser$1.__setModuleDefault||(Object.create?function(S,T){Object.defineProperty(S,"default",{enumerable:!0,value:T})}:function(S,T){S.default=T}),r=Parser$1&&Parser$1.__importStar||function(S){if(S&&S.__esModule)return S;var T={};if(S!=null)for(var w in S)w!=="default"&&Object.prototype.hasOwnProperty.call(S,w)&&n(T,S,w);return t(T,S),T};Object.defineProperty(Parser$1,"__esModule",{value:!0}),Parser$1.Parser=void 0;var a=r(requireTokenizer()),o=requireDecode(),u=new Set(["input","option","optgroup","select","button","datalist","textarea"]),s=new Set(["p"]),c=new Set(["thead","tbody"]),l=new Set(["dd","dt"]),d=new Set(["rt","rp"]),f=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",s],["h1",s],["h2",s],["h3",s],["h4",s],["h5",s],["h6",s],["select",u],["input",u],["output",u],["button",u],["datalist",u],["textarea",u],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",l],["dt",l],["address",s],["article",s],["aside",s],["blockquote",s],["details",s],["div",s],["dl",s],["fieldset",s],["figcaption",s],["figure",s],["footer",s],["form",s],["header",s],["hr",s],["main",s],["nav",s],["ol",s],["pre",s],["section",s],["table",s],["ul",s],["rt",d],["rp",d],["tbody",c],["tfoot",c]]),h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),v=new Set(["math","svg"]),g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),b=/\s|\//,_=function(){function S(T,w){w===void 0&&(w={});var A,R,E,I,L;this.options=w,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=T??{},this.lowerCaseTagNames=(A=w.lowerCaseTags)!==null&&A!==void 0?A:!w.xmlMode,this.lowerCaseAttributeNames=(R=w.lowerCaseAttributeNames)!==null&&R!==void 0?R:!w.xmlMode,this.tokenizer=new((E=w.Tokenizer)!==null&&E!==void 0?E:a.default)(this.options,this),(L=(I=this.cbs).onparserinit)===null||L===void 0||L.call(I,this)}return S.prototype.ontext=function(T,w){var A,R,E=this.getSlice(T,w);this.endIndex=w-1,(R=(A=this.cbs).ontext)===null||R===void 0||R.call(A,E),this.startIndex=w},S.prototype.ontextentity=function(T){var w,A,R=this.tokenizer.getSectionStart();this.endIndex=R-1,(A=(w=this.cbs).ontext)===null||A===void 0||A.call(w,(0,o.fromCodePoint)(T)),this.startIndex=R},S.prototype.isVoidElement=function(T){return!this.options.xmlMode&&h.has(T)},S.prototype.onopentagname=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);this.lowerCaseTagNames&&(A=A.toLowerCase()),this.emitOpenTag(A)},S.prototype.emitOpenTag=function(T){var w,A,R,E;this.openTagStart=this.startIndex,this.tagname=T;var I=!this.options.xmlMode&&f.get(T);if(I)for(;this.stack.length>0&&I.has(this.stack[this.stack.length-1]);){var L=this.stack.pop();(A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,L,!0)}this.isVoidElement(T)||(this.stack.push(T),v.has(T)?this.foreignContext.push(!0):g.has(T)&&this.foreignContext.push(!1)),(E=(R=this.cbs).onopentagname)===null||E===void 0||E.call(R,T),this.cbs.onopentag&&(this.attribs={})},S.prototype.endOpenTag=function(T){var w,A;this.startIndex=this.openTagStart,this.attribs&&((A=(w=this.cbs).onopentag)===null||A===void 0||A.call(w,this.tagname,this.attribs,T),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},S.prototype.onopentagend=function(T){this.endIndex=T,this.endOpenTag(!1),this.startIndex=T+1},S.prototype.onclosetag=function(T,w){var A,R,E,I,L,F;this.endIndex=w;var D=this.getSlice(T,w);if(this.lowerCaseTagNames&&(D=D.toLowerCase()),(v.has(D)||g.has(D))&&this.foreignContext.pop(),this.isVoidElement(D))!this.options.xmlMode&&D==="br"&&((R=(A=this.cbs).onopentagname)===null||R===void 0||R.call(A,"br"),(I=(E=this.cbs).onopentag)===null||I===void 0||I.call(E,"br",{},!0),(F=(L=this.cbs).onclosetag)===null||F===void 0||F.call(L,"br",!1));else{var $=this.stack.lastIndexOf(D);if($!==-1)if(this.cbs.onclosetag)for(var O=this.stack.length-$;O--;)this.cbs.onclosetag(this.stack.pop(),O!==0);else this.stack.length=$;else!this.options.xmlMode&&D==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=w+1},S.prototype.onselfclosingtag=function(T){this.endIndex=T,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=T+1):this.onopentagend(T)},S.prototype.closeCurrentTag=function(T){var w,A,R=this.tagname;this.endOpenTag(T),this.stack[this.stack.length-1]===R&&((A=(w=this.cbs).onclosetag)===null||A===void 0||A.call(w,R,!T),this.stack.pop())},S.prototype.onattribname=function(T,w){this.startIndex=T;var A=this.getSlice(T,w);this.attribname=this.lowerCaseAttributeNames?A.toLowerCase():A},S.prototype.onattribdata=function(T,w){this.attribvalue+=this.getSlice(T,w)},S.prototype.onattribentity=function(T){this.attribvalue+=(0,o.fromCodePoint)(T)},S.prototype.onattribend=function(T,w){var A,R;this.endIndex=w,(R=(A=this.cbs).onattribute)===null||R===void 0||R.call(A,this.attribname,this.attribvalue,T===a.QuoteType.Double?'"':T===a.QuoteType.Single?"'":T===a.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},S.prototype.getInstructionName=function(T){var w=T.search(b),A=w<0?T:T.substr(0,w);return this.lowerCaseTagNames&&(A=A.toLowerCase()),A},S.prototype.ondeclaration=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){var R=this.getInstructionName(A);this.cbs.onprocessinginstruction("!".concat(R),"!".concat(A))}this.startIndex=w+1},S.prototype.onprocessinginstruction=function(T,w){this.endIndex=w;var A=this.getSlice(T,w);if(this.cbs.onprocessinginstruction){var R=this.getInstructionName(A);this.cbs.onprocessinginstruction("?".concat(R),"?".concat(A))}this.startIndex=w+1},S.prototype.oncomment=function(T,w,A){var R,E,I,L;this.endIndex=w,(E=(R=this.cbs).oncomment)===null||E===void 0||E.call(R,this.getSlice(T,w-A)),(L=(I=this.cbs).oncommentend)===null||L===void 0||L.call(I),this.startIndex=w+1},S.prototype.oncdata=function(T,w,A){var R,E,I,L,F,D,$,O,P,C;this.endIndex=w;var q=this.getSlice(T,w-A);this.options.xmlMode||this.options.recognizeCDATA?((E=(R=this.cbs).oncdatastart)===null||E===void 0||E.call(R),(L=(I=this.cbs).ontext)===null||L===void 0||L.call(I,q),(D=(F=this.cbs).oncdataend)===null||D===void 0||D.call(F)):((O=($=this.cbs).oncomment)===null||O===void 0||O.call($,"[CDATA[".concat(q,"]]")),(C=(P=this.cbs).oncommentend)===null||C===void 0||C.call(P)),this.startIndex=w+1},S.prototype.onend=function(){var T,w;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var A=this.stack.length;A>0;this.cbs.onclosetag(this.stack[--A],!0));}(w=(T=this.cbs).onend)===null||w===void 0||w.call(T)},S.prototype.reset=function(){var T,w,A,R;(w=(T=this.cbs).onreset)===null||w===void 0||w.call(T),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(R=(A=this.cbs).onparserinit)===null||R===void 0||R.call(A,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},S.prototype.parseComplete=function(T){this.reset(),this.end(T)},S.prototype.getSlice=function(T,w){for(;T-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var A=this.buffers[0].slice(T-this.bufferOffset,w-this.bufferOffset);w-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),A+=this.buffers[0].slice(0,w-this.bufferOffset);return A},S.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},S.prototype.write=function(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".write() after done!"));return}this.buffers.push(T),this.tokenizer.running&&(this.tokenizer.write(T),this.writeIndex++)},S.prototype.end=function(T){var w,A;if(this.ended){(A=(w=this.cbs).onerror)===null||A===void 0||A.call(w,new Error(".end() after done!"));return}T&&this.write(T),this.ended=!0,this.tokenizer.end()},S.prototype.pause=function(){this.tokenizer.pause()},S.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},S.prototype.parseChunk=function(T){this.write(T)},S.prototype.done=function(T){this.end(T)},S}();return Parser$1.Parser=_,Parser$1}var hasRequiredLib$3e;function requireLib$3e(){return hasRequiredLib$3e||(hasRequiredLib$3e=1,function(n){var t=lib$3d&&lib$3d.__createBinding||(Object.create?function(T,w,A,R){R===void 0&&(R=A);var E=Object.getOwnPropertyDescriptor(w,A);(!E||("get"in E?!w.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return w[A]}}),Object.defineProperty(T,R,E)}:function(T,w,A,R){R===void 0&&(R=A),T[R]=w[A]}),r=lib$3d&&lib$3d.__setModuleDefault||(Object.create?function(T,w){Object.defineProperty(T,"default",{enumerable:!0,value:w})}:function(T,w){T.default=w}),a=lib$3d&&lib$3d.__importStar||function(T){if(T&&T.__esModule)return T;var w={};if(T!=null)for(var A in T)A!=="default"&&Object.prototype.hasOwnProperty.call(T,A)&&t(w,T,A);return r(w,T),w},o=lib$3d&&lib$3d.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomUtils=n.parseFeed=n.getFeed=n.ElementType=n.Tokenizer=n.createDomStream=n.parseDOM=n.parseDocument=n.DefaultHandler=n.DomHandler=n.Parser=void 0;var u=requireParser(),s=requireParser();Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return s.Parser}});var c=requireLib$3o(),l=requireLib$3o();Object.defineProperty(n,"DomHandler",{enumerable:!0,get:function(){return l.DomHandler}}),Object.defineProperty(n,"DefaultHandler",{enumerable:!0,get:function(){return l.DomHandler}});function d(T,w){var A=new c.DomHandler(void 0,w);return new u.Parser(A,w).end(T),A.root}n.parseDocument=d;function f(T,w){return d(T,w).children}n.parseDOM=f;function h(T,w,A){var R=new c.DomHandler(T,w,A);return new u.Parser(R,w)}n.createDomStream=h;var v=requireTokenizer();Object.defineProperty(n,"Tokenizer",{enumerable:!0,get:function(){return o(v).default}}),n.ElementType=a(requireLib$3p());var g=requireLib$3l(),b=requireLib$3l();Object.defineProperty(n,"getFeed",{enumerable:!0,get:function(){return b.getFeed}});var _={xmlMode:!0};function S(T,w){return w===void 0&&(w=_),(0,g.getFeed)(f(T,w))}n.parseFeed=S,n.DomUtils=a(requireLib$3l())}(lib$3d)),lib$3d}const require$$7={"http://schema.org/":{properties:{additionalType:{subPropertyOf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}}},"http://microformats.org/profile/hcard":{}};var hasRequiredMicrodataRdfParser;function requireMicrodataRdfParser(){if(hasRequiredMicrodataRdfParser)return MicrodataRdfParser;hasRequiredMicrodataRdfParser=1,Object.defineProperty(MicrodataRdfParser,"__esModule",{value:!0}),MicrodataRdfParser.MicrodataRdfParser=void 0;const n=requireLib$3e(),t=requireBrowser(),r=requireItemPropertyHandlerContent(),a=requireItemPropertyHandlerNumber(),o=requireItemPropertyHandlerTime(),u=requireItemPropertyHandlerUrl(),s=requireUtil$5(),c=require$$7;let l=class fi extends t.Transform{constructor(f){super({readableObjectMode:!0}),this.itemScopeStack=[],this.textBufferStack=[],this.isEmittingReferences=!1,this.pendingItemRefsDomain={},this.pendingItemRefsRangeFinalized={},this.pendingItemRefsRangeCollecting={},f=f||{},this.options=f,this.util=new s.Util(f.dataFactory,f.baseIRI),this.defaultGraph=f.defaultGraph||this.util.dataFactory.defaultGraph(),this.htmlParseListener=f.htmlParseListener,this.vocabRegistry=f.vocabRegistry||c,this.parser=this.initializeParser(!!f.xmlMode)}import(f){const h=new t.PassThrough({readableObjectMode:!0});f.on("error",g=>v.emit("error",g)),f.on("data",g=>h.push(g)),f.on("end",()=>h.push(null));const v=h.pipe(new fi(this.options));return v}_transform(f,h,v){this.parser.write(f.toString()),v()}_flush(f){this.parser.end(),f()}getItemScope(f){let h=this.itemScopeStack.length-(f?2:1);for(;h>0&&!this.itemScopeStack[h];)h--;return this.itemScopeStack[h]}getDepth(){return this.itemScopeStack.length}onTagOpen(f,h){if(!this.isEmittingReferences){if("id"in h){const g=h.id;this.pendingItemRefsRangeCollecting[g]={events:[],counter:0,ids:[]}}for(const g of Object.values(this.pendingItemRefsRangeCollecting))g.counter++,g.events.push({type:"open",name:f,attributes:h})}this.textBufferStack.push(void 0);let v;if("itemscope"in h){let g;if(this.emittingReferencesItemScopeIdGenerator)g=this.emittingReferencesItemScopeIdGenerator();else{g="itemid"in h&&this.util.createSubject(h.itemid)||this.util.dataFactory.blankNode();for(const _ of Object.values(this.pendingItemRefsRangeCollecting))_.ids.push(g)}v={subject:g},this.isEmittingReferences&&(v.blockEmission=!0);const b=this.getItemScope();b&&b.vocab&&(v.vocab=b.vocab),this.itemScopeStack.push(v)}else v=this.getItemScope(),this.itemScopeStack.push(void 0);if(v){if("itemtype"in h)for(const g of this.util.createVocabIris(h.itemtype,v,!1))v.vocab||(v.vocab=this.util.deriveVocab(g.value,this.vocabRegistry)),v.blockEmission||this.emitTriple(v.subject,this.util.dataFactory.namedNode(`${s.Util.RDF}type`),g);if("lang"in h&&(v.language=h.lang),"xml:lang"in h&&(v.language=h["xml:lang"]),"itemscope"in h&&!this.isEmittingReferences&&"itemref"in h)for(const g of h.itemref.split(/\s+/u))g in this.pendingItemRefsDomain||(this.pendingItemRefsDomain[g]=[]),this.pendingItemRefsDomain[g].push(v),this.tryToEmitReferences(g,v)}"itemprop"in h&&this.handleItemProperties(h.itemprop,!1,v,f,h),"itemprop-reverse"in h&&this.handleItemProperties(h["itemprop-reverse"],!0,v,f,h)}onText(f){if(!this.isEmittingReferences)for(const h of Object.values(this.pendingItemRefsRangeCollecting))h.events.push({type:"text",data:f});for(const h of this.textBufferStack)h&&h.push(f)}onTagClose(){if(!this.isEmittingReferences)for(const[h,v]of Object.entries(this.pendingItemRefsRangeCollecting))v.counter--,v.events.push({type:"close"}),v.counter===0&&(this.pendingItemRefsRangeFinalized[h]=v,delete this.pendingItemRefsRangeCollecting[h],this.tryToEmitReferences(h));const f=this.getItemScope(!0);if(f){const h=this.getDepth();if(f.predicates&&h in f.predicates)for(const[v,g]of Object.entries(f.predicates[h])){const b=this.util.createLiteral(this.textBufferStack[h].join(""),f);this.emitPredicateTriples(f,g,b,v==="reverse"),delete f.predicates[h][v]}}this.itemScopeStack.pop(),this.textBufferStack.pop()}onEnd(){}initializeParser(f){return new n.Parser({onclosetag:()=>{try{this.onTagClose(),this.htmlParseListener&&this.htmlParseListener.onTagClose()}catch(h){this.emit("error",h)}},onend:()=>{try{this.onEnd(),this.htmlParseListener&&this.htmlParseListener.onEnd()}catch(h){this.emit("error",h)}},onopentag:(h,v)=>{try{this.onTagOpen(h,v),this.htmlParseListener&&this.htmlParseListener.onTagOpen(h,v)}catch(g){this.emit("error",g)}},ontext:h=>{try{this.onText(h),this.htmlParseListener&&this.htmlParseListener.onText(h)}catch(v){this.emit("error",v)}}},{decodeEntities:!0,recognizeSelfClosing:!0,xmlMode:f})}handleItemProperties(f,h,v,g,b){const _=this.getItemScope(!0);if(_){const S=this.getDepth(),T=this.util.createVocabIris(f,_,!0);_.predicates||(_.predicates={}),_.predicates[S]||(_.predicates[S]={});const w=h?"reverse":"forward";_.predicates[S][w]=T;for(const A of this.util.getVocabularyExpansionType(f,_,this.vocabRegistry))T.push(A);if(v&&"itemscope"in b)this.emitPredicateTriples(_,T,v.subject,h),delete _.predicates[S][w];else for(const A of fi.ITEM_PROPERTY_HANDLERS)if(A.canHandle(g,b)){const R=A.getObject(b,this.util,_);this.emitPredicateTriples(_,T,R,h),delete _.predicates[S][w]}_.predicates[S][w]&&(this.textBufferStack[S]=[])}}emitPredicateTriples(f,h,v,g){if(!f.blockEmission)for(const b of h)g?v.termType!=="Literal"&&this.emitTriple(v,b,f.subject):this.emitTriple(f.subject,b,v)}emitTriple(f,h,v){this.push(this.util.dataFactory.quad(f,h,v,this.defaultGraph))}tryToEmitReferences(f,h){const v=this.pendingItemRefsRangeFinalized[f];if(v){let g;if(h){g=[h];const b=this.pendingItemRefsDomain[f].indexOf(h);this.pendingItemRefsDomain[f].splice(b,1)}else g=this.pendingItemRefsDomain[f],delete this.pendingItemRefsDomain[f];if(g){const b=this.itemScopeStack,_=this.textBufferStack;this.isEmittingReferences=!0;for(const S of g){this.itemScopeStack=[S],this.textBufferStack=[void 0];const T=[...v.ids];this.emittingReferencesItemScopeIdGenerator=()=>T.shift();for(const w of v.events)switch(w.type){case"open":this.onTagOpen(w.name,w.attributes);break;case"text":this.onText(w.data);break;case"close":this.onTagClose();break}}this.emittingReferencesItemScopeIdGenerator=void 0,this.itemScopeStack=b,this.textBufferStack=_,this.isEmittingReferences=!1}}}};return MicrodataRdfParser.MicrodataRdfParser=l,l.ITEM_PROPERTY_HANDLERS=[new r.ItemPropertyHandlerContent,new u.ItemPropertyHandlerUrl("a","href"),new u.ItemPropertyHandlerUrl("area","href"),new u.ItemPropertyHandlerUrl("audio","src"),new u.ItemPropertyHandlerUrl("embed","src"),new u.ItemPropertyHandlerUrl("iframe","src"),new u.ItemPropertyHandlerUrl("img","src"),new u.ItemPropertyHandlerUrl("link","href"),new u.ItemPropertyHandlerUrl("object","data"),new u.ItemPropertyHandlerUrl("source","src"),new u.ItemPropertyHandlerUrl("track","src"),new u.ItemPropertyHandlerUrl("video","src"),new a.ItemPropertyHandlerNumber("data","value"),new a.ItemPropertyHandlerNumber("meter","value"),new o.ItemPropertyHandlerTime],MicrodataRdfParser}var hasRequiredMicrodataRdfStreamingParser;function requireMicrodataRdfStreamingParser(){return hasRequiredMicrodataRdfStreamingParser||(hasRequiredMicrodataRdfStreamingParser=1,function(n){var t=microdataRdfStreamingParser&&microdataRdfStreamingParser.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=microdataRdfStreamingParser&&microdataRdfStreamingParser.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireIItemPropertyHandler(),n),r(requireItemPropertyHandlerContent(),n),r(requireItemPropertyHandlerNumber(),n),r(requireItemPropertyHandlerTime(),n),r(requireItemPropertyHandlerUrl(),n),r(requireIHtmlParseListener(),n),r(requireIItemScope(),n),r(requireIVocabRegistry(),n),r(requireMicrodataRdfParser(),n),r(requireUtil$5(),n)}(microdataRdfStreamingParser)),microdataRdfStreamingParser}var hasRequiredActorRdfParseHtmlMicrodata;function requireActorRdfParseHtmlMicrodata(){if(hasRequiredActorRdfParseHtmlMicrodata)return ActorRdfParseHtmlMicrodata;hasRequiredActorRdfParseHtmlMicrodata=1,Object.defineProperty(ActorRdfParseHtmlMicrodata,"__esModule",{value:!0}),ActorRdfParseHtmlMicrodata.ActorRdfParseHtmlMicrodata=void 0;const n=requireLib$3f(),t=requireLib$4q(),r=requireLib$4s(),a=requireMicrodataRdfStreamingParser();let o=class extends n.ActorRdfParseHtml{constructor(s){super(s)}async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=s.headers?s.headers.get("content-type"):null,d=l==null?void 0:l.includes("xml"),f=new a.MicrodataRdfParser({dataFactory:c,baseIRI:s.baseIRI,xmlMode:d});f.on("error",s.error),f.on("data",s.emit);const h=f.onEnd;return f.onEnd=()=>{h.call(f),s.end()},{htmlParseListener:f}}};return ActorRdfParseHtmlMicrodata.ActorRdfParseHtmlMicrodata=o,ActorRdfParseHtmlMicrodata}var hasRequiredLib$3d;function requireLib$3d(){return hasRequiredLib$3d||(hasRequiredLib$3d=1,function(n){var t=lib$3f&&lib$3f.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3f&&lib$3f.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseHtmlMicrodata(),n)}(lib$3f)),lib$3f}var lib$3c={},ActorRdfParseHtmlRdfa={},hasRequiredActorRdfParseHtmlRdfa;function requireActorRdfParseHtmlRdfa(){if(hasRequiredActorRdfParseHtmlRdfa)return ActorRdfParseHtmlRdfa;hasRequiredActorRdfParseHtmlRdfa=1,Object.defineProperty(ActorRdfParseHtmlRdfa,"__esModule",{value:!0}),ActorRdfParseHtmlRdfa.ActorRdfParseHtmlRdfa=void 0;const n=requireLib$3f(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfaStreamingParser();let o=class extends n.ActorRdfParseHtml{constructor(s){super(s)}async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=s.headers?s.headers.get("content-type"):null,d=(s.headers&&s.headers.get("content-language"))??void 0,f=l&&l.includes("xml")?"xhtml":"html",h=new a.RdfaParser({dataFactory:c,baseIRI:s.baseIRI,profile:f,language:d});h.on("error",s.error),h.on("data",s.emit);const v=h.onEnd;return h.onEnd=()=>{v.call(h),s.end()},{htmlParseListener:h}}};return ActorRdfParseHtmlRdfa.ActorRdfParseHtmlRdfa=o,ActorRdfParseHtmlRdfa}var hasRequiredLib$3c;function requireLib$3c(){return hasRequiredLib$3c||(hasRequiredLib$3c=1,function(n){var t=lib$3c&&lib$3c.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3c&&lib$3c.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseHtmlRdfa(),n)}(lib$3c)),lib$3c}var lib$3b={},ActorRdfResolveHypermediaLinksNext={},lib$3a={},ActorRdfResolveHypermediaLinks={},hasRequiredActorRdfResolveHypermediaLinks;function requireActorRdfResolveHypermediaLinks(){if(hasRequiredActorRdfResolveHypermediaLinks)return ActorRdfResolveHypermediaLinks;hasRequiredActorRdfResolveHypermediaLinks=1,Object.defineProperty(ActorRdfResolveHypermediaLinks,"__esModule",{value:!0}),ActorRdfResolveHypermediaLinks.ActorRdfResolveHypermediaLinks=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfResolveHypermediaLinks.ActorRdfResolveHypermediaLinks=t,ActorRdfResolveHypermediaLinks}var hasRequiredLib$3b;function requireLib$3b(){return hasRequiredLib$3b||(hasRequiredLib$3b=1,function(n){var t=lib$3a&&lib$3a.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3a&&lib$3a.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfResolveHypermediaLinks(),n)}(lib$3a)),lib$3a}var hasRequiredActorRdfResolveHypermediaLinksNext;function requireActorRdfResolveHypermediaLinksNext(){if(hasRequiredActorRdfResolveHypermediaLinksNext)return ActorRdfResolveHypermediaLinksNext;hasRequiredActorRdfResolveHypermediaLinksNext=1,Object.defineProperty(ActorRdfResolveHypermediaLinksNext,"__esModule",{value:!0}),ActorRdfResolveHypermediaLinksNext.ActorRdfResolveHypermediaLinksNext=void 0;const n=requireLib$3b(),t=requireLib$4s();let r=class extends n.ActorRdfResolveHypermediaLinks{constructor(o){super(o)}async test(o){return!o.metadata.next||o.metadata.next.length===0?(0,t.failTest)(`Actor ${this.name} requires a 'next' metadata entry.`):(0,t.passTestVoid)()}async run(o){return{links:o.metadata.next.map(u=>({url:u}))}}};return ActorRdfResolveHypermediaLinksNext.ActorRdfResolveHypermediaLinksNext=r,ActorRdfResolveHypermediaLinksNext}var hasRequiredLib$3a;function requireLib$3a(){return hasRequiredLib$3a||(hasRequiredLib$3a=1,function(n){var t=lib$3b&&lib$3b.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3b&&lib$3b.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfResolveHypermediaLinksNext(),n)}(lib$3b)),lib$3b}var lib$39={},ActorRdfResolveHypermediaLinksQueueFifo={},lib$38={},ActorRdfResolveHypermediaLinksQueue={},hasRequiredActorRdfResolveHypermediaLinksQueue;function requireActorRdfResolveHypermediaLinksQueue(){if(hasRequiredActorRdfResolveHypermediaLinksQueue)return ActorRdfResolveHypermediaLinksQueue;hasRequiredActorRdfResolveHypermediaLinksQueue=1,Object.defineProperty(ActorRdfResolveHypermediaLinksQueue,"__esModule",{value:!0}),ActorRdfResolveHypermediaLinksQueue.ActorRdfResolveHypermediaLinksQueue=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfResolveHypermediaLinksQueue.ActorRdfResolveHypermediaLinksQueue=t,ActorRdfResolveHypermediaLinksQueue}var ILinkQueue={},hasRequiredILinkQueue;function requireILinkQueue(){return hasRequiredILinkQueue||(hasRequiredILinkQueue=1,Object.defineProperty(ILinkQueue,"__esModule",{value:!0})),ILinkQueue}var LinkQueueWrapper={},hasRequiredLinkQueueWrapper;function requireLinkQueueWrapper(){if(hasRequiredLinkQueueWrapper)return LinkQueueWrapper;hasRequiredLinkQueueWrapper=1,Object.defineProperty(LinkQueueWrapper,"__esModule",{value:!0}),LinkQueueWrapper.LinkQueueWrapper=void 0;let n=class{constructor(r){this.linkQueue=r}push(r,a){return this.linkQueue.push(r,a)}getSize(){return this.linkQueue.getSize()}isEmpty(){return this.linkQueue.isEmpty()}pop(){return this.linkQueue.pop()}peek(){return this.linkQueue.peek()}};return LinkQueueWrapper.LinkQueueWrapper=n,LinkQueueWrapper}var hasRequiredLib$39;function requireLib$39(){return hasRequiredLib$39||(hasRequiredLib$39=1,function(n){var t=lib$38&&lib$38.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$38&&lib$38.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfResolveHypermediaLinksQueue(),n),r(requireILinkQueue(),n),r(requireLinkQueueWrapper(),n)}(lib$38)),lib$38}var LinkQueueFifo={},hasRequiredLinkQueueFifo;function requireLinkQueueFifo(){if(hasRequiredLinkQueueFifo)return LinkQueueFifo;hasRequiredLinkQueueFifo=1,Object.defineProperty(LinkQueueFifo,"__esModule",{value:!0}),LinkQueueFifo.LinkQueueFifo=void 0;let n=class{constructor(){this.links=[]}push(r){return this.links.push(r),!0}getSize(){return this.links.length}isEmpty(){return this.links.length===0}pop(){return this.links.shift()}peek(){return this.links[0]}};return LinkQueueFifo.LinkQueueFifo=n,LinkQueueFifo}var hasRequiredActorRdfResolveHypermediaLinksQueueFifo;function requireActorRdfResolveHypermediaLinksQueueFifo(){if(hasRequiredActorRdfResolveHypermediaLinksQueueFifo)return ActorRdfResolveHypermediaLinksQueueFifo;hasRequiredActorRdfResolveHypermediaLinksQueueFifo=1,Object.defineProperty(ActorRdfResolveHypermediaLinksQueueFifo,"__esModule",{value:!0}),ActorRdfResolveHypermediaLinksQueueFifo.ActorRdfResolveHypermediaLinksQueueFifo=void 0;const n=requireLib$39(),t=requireLib$4s(),r=requireLinkQueueFifo();let a=class extends n.ActorRdfResolveHypermediaLinksQueue{constructor(u){super(u)}async test(u){return(0,t.passTestVoid)()}async run(u){return{linkQueue:new r.LinkQueueFifo}}};return ActorRdfResolveHypermediaLinksQueueFifo.ActorRdfResolveHypermediaLinksQueueFifo=a,ActorRdfResolveHypermediaLinksQueueFifo}var hasRequiredLib$38;function requireLib$38(){return hasRequiredLib$38||(hasRequiredLib$38=1,function(n){var t=lib$39&&lib$39.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$39&&lib$39.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfResolveHypermediaLinksQueueFifo(),n),r(requireLinkQueueFifo(),n)}(lib$39)),lib$39}var lib$37={},ActorRdfSerializeN3={},lib$36={},ActorRdfSerialize={},hasRequiredActorRdfSerialize;function requireActorRdfSerialize(){if(hasRequiredActorRdfSerialize)return ActorRdfSerialize;hasRequiredActorRdfSerialize=1,Object.defineProperty(ActorRdfSerialize,"__esModule",{value:!0}),ActorRdfSerialize.ActorRdfSerialize=void 0;const n=requireLib$3Z();let t=class extends n.ActorAbstractMediaTyped{constructor(a){super(a)}};return ActorRdfSerialize.ActorRdfSerialize=t,ActorRdfSerialize}var ActorRdfSerializeFixedMediaTypes={},hasRequiredActorRdfSerializeFixedMediaTypes;function requireActorRdfSerializeFixedMediaTypes(){if(hasRequiredActorRdfSerializeFixedMediaTypes)return ActorRdfSerializeFixedMediaTypes;hasRequiredActorRdfSerializeFixedMediaTypes=1,Object.defineProperty(ActorRdfSerializeFixedMediaTypes,"__esModule",{value:!0}),ActorRdfSerializeFixedMediaTypes.ActorRdfSerializeFixedMediaTypes=void 0;const n=requireLib$3Z(),t=requireLib$4s();let r=class extends n.ActorAbstractMediaTypedFixed{constructor(o){super(o)}async testHandleChecked(){return(0,t.passTestVoid)()}};return ActorRdfSerializeFixedMediaTypes.ActorRdfSerializeFixedMediaTypes=r,ActorRdfSerializeFixedMediaTypes}var hasRequiredLib$37;function requireLib$37(){return hasRequiredLib$37||(hasRequiredLib$37=1,function(n){var t=lib$36&&lib$36.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$36&&lib$36.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfSerialize(),n),r(requireActorRdfSerializeFixedMediaTypes(),n)}(lib$36)),lib$36}var hasRequiredActorRdfSerializeN3;function requireActorRdfSerializeN3(){if(hasRequiredActorRdfSerializeN3)return ActorRdfSerializeN3;hasRequiredActorRdfSerializeN3=1,Object.defineProperty(ActorRdfSerializeN3,"__esModule",{value:!0}),ActorRdfSerializeN3.ActorRdfSerializeN3=void 0;const n=requireLib$37(),t=require$$0;let r=class extends n.ActorRdfSerializeFixedMediaTypes{constructor(o){super(o)}async runHandle(o,u){const s=new t.StreamWriter({format:u});let c;return"pipe"in o.quadStream?(o.quadStream.on("error",l=>s.emit("error",l)),c=o.quadStream.pipe(s)):c=s.import(o.quadStream),{data:c,triples:u==="text/turtle"||u==="application/n-triples"||u==="text/n3"}}};return ActorRdfSerializeN3.ActorRdfSerializeN3=r,ActorRdfSerializeN3}var hasRequiredLib$36;function requireLib$36(){return hasRequiredLib$36||(hasRequiredLib$36=1,function(n){var t=lib$37&&lib$37.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$37&&lib$37.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfSerializeN3(),n)}(lib$37)),lib$37}var lib$35={},ActorRdfSerializeJsonLd={},jsonldStreamingSerializer={},JsonLdSerializer={},jsonldContextParser$2={},ContextParser$2={},ErrorCoded$2={},hasRequiredErrorCoded$2;function requireErrorCoded$2(){return hasRequiredErrorCoded$2||(hasRequiredErrorCoded$2=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_CODES=n.ErrorCoded=void 0;class t extends Error{constructor(a,o){super(a),this.code=o}}n.ErrorCoded=t,function(r){r.COLLIDING_KEYWORDS="colliding keywords",r.CONFLICTING_INDEXES="conflicting indexes",r.CYCLIC_IRI_MAPPING="cyclic IRI mapping",r.INVALID_ID_VALUE="invalid @id value",r.INVALID_INDEX_VALUE="invalid @index value",r.INVALID_NEST_VALUE="invalid @nest value",r.INVALID_PREFIX_VALUE="invalid @prefix value",r.INVALID_PROPAGATE_VALUE="invalid @propagate value",r.INVALID_REVERSE_VALUE="invalid @reverse value",r.INVALID_IMPORT_VALUE="invalid @import value",r.INVALID_VERSION_VALUE="invalid @version value",r.INVALID_BASE_IRI="invalid base IRI",r.INVALID_CONTAINER_MAPPING="invalid container mapping",r.INVALID_CONTEXT_ENTRY="invalid context entry",r.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",r.INVALID_DEFAULT_LANGUAGE="invalid default language",r.INVALID_INCLUDED_VALUE="invalid @included value",r.INVALID_IRI_MAPPING="invalid IRI mapping",r.INVALID_JSON_LITERAL="invalid JSON literal",r.INVALID_KEYWORD_ALIAS="invalid keyword alias",r.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",r.INVALID_LANGUAGE_MAPPING="invalid language mapping",r.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",r.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",r.INVALID_LOCAL_CONTEXT="invalid local context",r.INVALID_REMOTE_CONTEXT="invalid remote context",r.INVALID_REVERSE_PROPERTY="invalid reverse property",r.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",r.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",r.INVALID_SCOPED_CONTEXT="invalid scoped context",r.INVALID_SCRIPT_ELEMENT="invalid script element",r.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",r.INVALID_TERM_DEFINITION="invalid term definition",r.INVALID_TYPE_MAPPING="invalid type mapping",r.INVALID_TYPE_VALUE="invalid type value",r.INVALID_TYPED_VALUE="invalid typed value",r.INVALID_VALUE_OBJECT="invalid value object",r.INVALID_VALUE_OBJECT_VALUE="invalid value object value",r.INVALID_VOCAB_MAPPING="invalid vocab mapping",r.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",r.KEYWORD_REDEFINITION="keyword redefinition",r.LOADING_DOCUMENT_FAILED="loading document failed",r.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",r.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",r.PROCESSING_MODE_CONFLICT="processing mode conflict",r.PROTECTED_TERM_REDEFINITION="protected term redefinition",r.CONTEXT_OVERFLOW="context overflow",r.INVALID_BASE_DIRECTION="invalid base direction",r.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",r.INVALID_STREAMING_KEY_ORDER="invalid streaming key order",r.INVALID_EMBEDDED_NODE="invalid embedded node",r.INVALID_ANNOTATION="invalid annotation"}(n.ERROR_CODES||(n.ERROR_CODES={}))}(ErrorCoded$2)),ErrorCoded$2}var FetchDocumentLoader$2={},hasRequiredFetchDocumentLoader$2;function requireFetchDocumentLoader$2(){if(hasRequiredFetchDocumentLoader$2)return FetchDocumentLoader$2;hasRequiredFetchDocumentLoader$2=1,Object.defineProperty(FetchDocumentLoader$2,"__esModule",{value:!0}),FetchDocumentLoader$2.FetchDocumentLoader=void 0;const n=requireErrorCoded$2(),t=requireLink(),r=requireRelativeToAbsoluteIri();class a{constructor(u){this.fetcher=u}async load(u){const s=await(this.fetcher||fetch)(u,{headers:new Headers({accept:"application/ld+json"})});if(s.ok&&s.headers){let c=s.headers.get("Content-Type");if(c){const l=c.indexOf(";");l>0&&(c=c.substr(0,l))}if(c==="application/ld+json")return await s.json();if(s.headers.has("Link")){let l;if(s.headers.forEach((d,f)=>{if(f==="link"){const h=(0,t.parse)(d);for(const v of h.get("type","application/ld+json"))if(v.rel==="alternate"){if(l)throw new Error("Multiple JSON-LD alternate links were found on "+u);l=(0,r.resolve)(v.uri,u)}}}),l)return this.load(l)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${c}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}else throw new Error(s.statusText||`Status code: ${s.status}`)}}return FetchDocumentLoader$2.FetchDocumentLoader=a,FetchDocumentLoader$2}var JsonLdContextNormalized$2={},Util$4={},hasRequiredUtil$4;function requireUtil$4(){if(hasRequiredUtil$4)return Util$4;hasRequiredUtil$4=1,Object.defineProperty(Util$4,"__esModule",{value:!0}),Util$4.Util=void 0;class n{static isCompactIri(r){return r.indexOf(":")>0&&!(r&&r[0]==="#")}static getPrefix(r,a){if(r&&r[0]==="#")return null;const o=r.indexOf(":");if(o>=0){if(r.length>o+1&&r.charAt(o+1)==="/"&&r.charAt(o+2)==="/")return null;const u=r.substr(0,o);if(u==="_")return null;if(a[u])return u}return null}static getContextValueId(r){if(r===null||typeof r=="string")return r;const a=r["@id"];return a||null}static isSimpleTermDefinitionPrefix(r,a){return!n.isPotentialKeyword(r)&&(a.allowPrefixNonGenDelims||typeof r=="string"&&(r[0]==="_"||n.isPrefixIriEndingWithGenDelim(r)))}static isPotentialKeyword(r){return typeof r=="string"&&n.KEYWORD_REGEX.test(r)}static isPrefixIriEndingWithGenDelim(r){return n.ENDS_WITH_GEN_DELIM.test(r)}static isPrefixValue(r){return r&&(typeof r=="string"||r&&typeof r=="object")}static isValidIri(r){return!!(r&&n.IRI_REGEX.test(r))}static isValidIriWeak(r){return!!r&&r[0]!==":"&&n.IRI_REGEX_WEAK.test(r)}static isValidKeyword(r){return n.VALID_KEYWORDS[r]}static isTermProtected(r,a){const o=r[a];return typeof o!="string"&&o&&o["@protected"]}static hasProtectedTerms(r){for(const a of Object.keys(r))if(n.isTermProtected(r,a))return!0;return!1}static isReservedInternalKeyword(r){return r.startsWith("@__")}static deepEqual(r,a){const o=Object.keys(r),u=Object.keys(a);return o.length!==u.length?!1:o.every(s=>{const c=r[s],l=a[s];return c===l||c!==null&&l!==null&&typeof c=="object"&&typeof l=="object"&&this.deepEqual(c,l)})}}return n.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,n.IRI_REGEX_WEAK=/(?::[^:])|\//,n.KEYWORD_REGEX=/^@[a-z]+$/i,n.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,n.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,n.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,n.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},n.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],n.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],n.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],n.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],n.CONTAINERS_1_0=["@list","@set","@index"],Util$4.Util=n,Util$4}var hasRequiredJsonLdContextNormalized$2;function requireJsonLdContextNormalized$2(){return hasRequiredJsonLdContextNormalized$2||(hasRequiredJsonLdContextNormalized$2=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.defaultExpandOptions=n.JsonLdContextNormalized=void 0;const t=requireRelativeToAbsoluteIri(),r=requireErrorCoded$2(),a=requireUtil$4();class o{constructor(s){this.contextRaw=s}getContextRaw(){return this.contextRaw}expandTerm(s,c,l=n.defaultExpandOptions){const d=this.contextRaw[s];if(d===null||d&&d["@id"]===null)return null;let f=!0;if(d&&c){const S=a.Util.getContextValueId(d);if(S&&S!==s)if(typeof S!="string"||!a.Util.isValidIri(S)&&!a.Util.isValidKeyword(S))a.Util.isPotentialKeyword(S)||(f=!1);else return S}const h=a.Util.getPrefix(s,this.contextRaw),v=this.contextRaw["@vocab"],g=(!!v||v==="")&&v.indexOf(":")<0,b=this.contextRaw["@base"],_=a.Util.isPotentialKeyword(s);if(h){const S=this.contextRaw[h],T=a.Util.getContextValueId(S);if(T){if(typeof S=="string"||!l.allowPrefixForcing){if(!a.Util.isSimpleTermDefinitionPrefix(T,l))return s}else if(T[0]!=="_"&&!_&&!S["@prefix"]&&!(s in this.contextRaw))return s;return T+s.substr(h.length+1)}}else if(c&&(v||v===""||l.allowVocabRelativeToBase&&b&&g)&&!_&&!a.Util.isCompactIri(s))if(g){if(l.allowVocabRelativeToBase)return(v||b?(0,t.resolve)(v,b):"")+s;throw new r.ErrorCoded(`Relative vocab expansion for term '${s}' with vocab '${v}' is not allowed.`,r.ERROR_CODES.INVALID_VOCAB_MAPPING)}else return v+s;else if(!c&&b&&!_&&!a.Util.isCompactIri(s))return(0,t.resolve)(s,b);if(f)return s;throw new r.ErrorCoded(`Invalid IRI mapping found for context entry '${s}': '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(s,c){if(c&&this.contextRaw["@vocab"]&&s.startsWith(this.contextRaw["@vocab"]))return s.substr(this.contextRaw["@vocab"].length);if(!c&&this.contextRaw["@base"]&&s.startsWith(this.contextRaw["@base"]))return s.substr(this.contextRaw["@base"].length);const l={prefix:"",suffix:s};for(const d in this.contextRaw){const f=this.contextRaw[d];if(f&&!a.Util.isPotentialKeyword(d)){const h=a.Util.getContextValueId(f);if(s.startsWith(h)){const v=s.substr(h.length);if(v)v.length<l.suffix.length&&(l.prefix=d,l.suffix=v);else if(c)return d}}}return l.prefix?l.prefix+":"+l.suffix:s}}n.JsonLdContextNormalized=o,n.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}(JsonLdContextNormalized$2)),JsonLdContextNormalized$2}var hasRequiredContextParser$2;function requireContextParser$2(){if(hasRequiredContextParser$2)return ContextParser$2;hasRequiredContextParser$2=1,Object.defineProperty(ContextParser$2,"__esModule",{value:!0}),ContextParser$2.ContextParser=void 0;const n=requireRelativeToAbsoluteIri(),t=requireErrorCoded$2(),r=requireFetchDocumentLoader$2(),a=requireJsonLdContextNormalized$2(),o=requireUtil$4();class u{constructor(c){c=c||{},this.documentLoader=c.documentLoader||new r.FetchDocumentLoader,this.documentCache={},this.validateContext=!c.skipValidation,this.expandContentTypeToBase=!!c.expandContentTypeToBase,this.remoteContextsDepthLimit=c.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps="redirectSchemaOrgHttps"in c?!!c.redirectSchemaOrgHttps:!0}static validateLanguage(c,l,d){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(c)}'`,d);if(!o.Util.REGEX_LANGUAGE_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(c)}'`,d);return!1}return!0}static validateDirection(c,l){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(c){for(const l of Object.keys(c)){let d=c[l];if(d&&typeof d=="object"&&d["@reverse"]&&!d["@id"]){if(typeof d["@reverse"]!="string"||o.Util.isValidKeyword(d["@reverse"]))throw new t.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${d["@reverse"]}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);d=c[l]=Object.assign(Object.assign({},d),{"@id":d["@reverse"]}),d["@id"]=d["@reverse"],o.Util.isPotentialKeyword(d["@reverse"])?delete d["@reverse"]:d["@reverse"]=!0}}return c}expandPrefixedTerms(c,l,d){const f=c.getContextRaw();for(const h of d||Object.keys(f))if(o.Util.EXPAND_KEYS_BLACKLIST.indexOf(h)<0&&!o.Util.isReservedInternalKeyword(h)){const v=f[h];if(o.Util.isPotentialKeyword(h)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(h)>=0&&(h!=="@type"||typeof f[h]=="object"&&!(f[h]["@protected"]||f[h]["@container"]==="@set")))throw new t.ErrorCoded(`Keywords can not be aliased to something else.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(v))>=0)throw new t.ErrorCoded(`Aliasing to certain keywords is not allowed.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(v&&o.Util.isPotentialKeyword(o.Util.getContextValueId(v))&&v["@prefix"]===!0)throw new t.ErrorCoded(`Tried to use keyword aliases as prefix: '${h}': '${JSON.stringify(v)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);for(;o.Util.isPrefixValue(f[h]);){const g=f[h];let b=!1;if(typeof g=="string")f[h]=c.expandTerm(g,!0),b=b||g!==f[h];else{const _=g["@id"],S=g["@type"],T=!("@prefix"in g)||o.Util.isValidIri(h);if("@id"in g)_!=null&&typeof _=="string"&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":c.expandTerm(_,!0)}),b=b||_!==f[h]["@id"]);else if(!o.Util.isPotentialKeyword(h)&&T){const w=c.expandTerm(h,!0);w!==h&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":w}),b=!0)}if(S&&typeof S=="string"&&S!=="@vocab"&&(!g["@container"]||!g["@container"]["@type"])&&T){let w=c.expandTerm(S,!0);l&&S===w&&(w=c.expandTerm(S,!1)),w!==S&&(b=!0,f[h]=Object.assign(Object.assign({},f[h]),{"@type":w}))}}if(!b)break}}}normalize(c,{processingMode:l,normalizeLanguageTags:d}){if(d||l===1)for(const f of Object.keys(c))if(f==="@language"&&typeof c[f]=="string")c[f]=c[f].toLowerCase();else{const h=c[f];if(h&&typeof h=="object"&&typeof h["@language"]=="string"){const v=h["@language"].toLowerCase();v!==h["@language"]&&(c[f]=Object.assign(Object.assign({},h),{"@language":v}))}}}containersToHash(c){for(const l of Object.keys(c)){const d=c[l];if(d&&typeof d=="object"){if(typeof d["@container"]=="string")c[l]=Object.assign(Object.assign({},d),{"@container":{[d["@container"]]:!0}});else if(Array.isArray(d["@container"])){const f={};for(const h of d["@container"])f[h]=!0;c[l]=Object.assign(Object.assign({},d),{"@container":f})}}}}applyScopedProtected(c,{processingMode:l},d){if(l&&l>=1.1&&c["@protected"]){for(const f of Object.keys(c))if(!o.Util.isReservedInternalKeyword(f)&&!o.Util.isPotentialKeyword(f)&&!o.Util.isTermProtected(c,f)){const h=c[f];h&&typeof h=="object"?"@protected"in c[f]||(c[f]=Object.assign(Object.assign({},c[f]),{"@protected":!0})):(c[f]={"@id":h,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(h,d)&&(c[f]=Object.assign(Object.assign({},c[f]),{"@prefix":!0})))}delete c["@protected"]}}validateKeywordRedefinitions(c,l,d,f){for(const h of f??Object.keys(l))if(o.Util.isTermProtected(c,h)&&(typeof l[h]=="string"?l[h]={"@id":l[h],"@protected":!0}:l[h]=Object.assign(Object.assign({},l[h]),{"@protected":!0}),!o.Util.deepEqual(c[h],l[h])))throw new t.ErrorCoded(`Attempted to override the protected keyword ${h} from ${JSON.stringify(o.Util.getContextValueId(c[h]))} to ${JSON.stringify(o.Util.getContextValueId(l[h]))}`,t.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(c,{processingMode:l}){for(const d of Object.keys(c)){if(o.Util.isReservedInternalKeyword(d))continue;if(d==="")throw new t.ErrorCoded(`The empty term is not allowed, got: '${d}': '${JSON.stringify(c[d])}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);const f=c[d],h=typeof f;if(o.Util.isPotentialKeyword(d)){switch(d.substr(1)){case"vocab":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @vocab IRI: ${f}`,t.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @base IRI: ${c[d]}`,t.ERROR_CODES.INVALID_BASE_IRI);break;case"language":f!==null&&u.validateLanguage(f,!0,t.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(f!==null&&h!=="number")throw new t.ErrorCoded(`Found an invalid @version number: ${f}`,t.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":f!==null&&u.validateDirection(f,!0);break;case"propagate":if(l===1)throw new t.ErrorCoded(`Found an illegal @propagate keyword: ${f}`,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(f!==null&&h!=="boolean")throw new t.ErrorCoded(`Found an invalid @propagate value: ${f}`,t.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(o.Util.isValidKeyword(d)&&o.Util.isValidKeyword(o.Util.getContextValueId(f)))throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${o.Util.getContextValueId(f)}'`,t.ERROR_CODES.KEYWORD_REDEFINITION);continue}if(f!==null)switch(h){case"string":if(o.Util.getPrefix(f,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(f==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(f)&&f!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(d)&&!("@id"in f)&&(f["@type"]==="@id"?!c["@base"]:!c["@vocab"]))throw new t.ErrorCoded(`Missing @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);for(const v of Object.keys(f)){const g=f[v];if(g)switch(v){case"@id":if(o.Util.isValidKeyword(g)&&g!=="@type"&&g!=="@id"&&g!=="@graph"&&g!=="@nest")throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(g==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(g)&&g!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}if(typeof g!="string")throw new t.ErrorCoded(`Detected non-string @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(g,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if(f["@container"]==="@type"&&g!=="@id"&&g!=="@vocab")throw new t.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(typeof g!="string")throw new t.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(h)}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(g!=="@id"&&g!=="@vocab"&&(l===1||g!=="@json")&&(l===1||g!=="@none")&&(g[0]==="_"||!o.Util.isValidIri(g)))throw new t.ErrorCoded(`A context @type must be an absolute IRI, found: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if(typeof g=="string"&&f["@id"]&&f["@id"]!==g)throw new t.ErrorCoded(`Found non-matching @id and @reverse term values in '${d}':'${g}' and '${f["@id"]}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in f)throw new t.ErrorCoded(`@nest is not allowed in the reverse property '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(l===1&&(Object.keys(g).length>1||o.Util.CONTAINERS_1_0.indexOf(Object.keys(g)[0])<0))throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${Object.keys(g)}') in 1.0, must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const b of Object.keys(g)){if(b==="@list"&&f["@reverse"])throw new t.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(o.Util.CONTAINERS.indexOf(b)<0)throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${b}'), must be one of ${o.Util.CONTAINERS.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":u.validateLanguage(g,!0,t.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":u.validateDirection(g,!0);break;case"@prefix":if(g!==null&&typeof g!="boolean")throw new t.ErrorCoded(`Found an invalid term @prefix boolean in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in f)&&!o.Util.isValidIri(d))throw new t.ErrorCoded(`Invalid @prefix definition for '${d}' ('${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(l===1||!f["@container"]||!f["@container"]["@index"])throw new t.ErrorCoded(`Attempt to add illegal key to value object: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(g)&&g!=="@nest")throw new t.ErrorCoded(`Found an invalid term @nest value in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new t.ErrorCoded(`Found an invalid term value: '${d}': '${f}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(c,l,d){return typeof c=="string"||(d&&!("@base"in c)&&l.parentContext&&typeof l.parentContext=="object"&&"@base"in l.parentContext&&(c["@base"]=l.parentContext["@base"],l.parentContext["@__baseDocument"]&&(c["@__baseDocument"]=!0)),l.baseIRI&&!l.external&&("@base"in c?c["@base"]!==null&&typeof c["@base"]=="string"&&!o.Util.isValidIri(c["@base"])&&(c["@base"]=(0,n.resolve)(c["@base"],l.parentContext&&l.parentContext["@base"]||l.baseIRI)):(c["@base"]=l.baseIRI,c["@__baseDocument"]=!0))),c}normalizeContextIri(c,l){if(!o.Util.isValidIri(c))try{c=(0,n.resolve)(c,l)}catch{throw new Error(`Invalid context IRI: ${c}`)}return this.redirectSchemaOrgHttps&&c.startsWith("http://schema.org")&&(c="https://schema.org/"),c}async parseInnerContexts(c,l,d){for(const f of d??Object.keys(c)){const h=c[f];if(h&&typeof h=="object"&&"@context"in h&&h["@context"]!==null&&!l.ignoreScopedContexts){if(this.validateContext)try{const v=Object.assign(Object.assign({},c),{[f]:Object.assign({},c[f])});delete v[f]["@context"],await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,parentContext:v,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(v){throw new t.ErrorCoded(v.message,t.ERROR_CODES.INVALID_SCOPED_CONTEXT)}c[f]=Object.assign(Object.assign({},h),{"@context":(await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:c}))).getContextRaw()})}}return c}async parse(c,l={},d={}){const{baseIRI:f,parentContext:h,external:v,processingMode:g=u.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:b,ignoreProtection:_,minimalProcessing:S}=l,T=l.remoteContexts||{};if(Object.keys(T).length>=this.remoteContextsDepthLimit)throw new t.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(T),t.ERROR_CODES.CONTEXT_OVERFLOW);if(c==null){if(!_&&h&&o.Util.hasProtectedTerms(h))throw new t.ErrorCoded("Illegal context nullification when terms are protected",t.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},l,!1))}else if(typeof c=="string"){const w=this.normalizeContextIri(c,f),A=this.getOverriddenLoad(w,l);if(A)return new a.JsonLdContextNormalized(A);const R=await this.parse(await this.load(w),Object.assign(Object.assign({},l),{baseIRI:w,external:!0,remoteContexts:Object.assign(Object.assign({},T),{[w]:!0})}));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(Array.isArray(c)){const w=[],A=await Promise.all(c.map((E,I)=>{if(typeof E=="string"){const L=this.normalizeContextIri(E,f);w[I]=L;const F=this.getOverriddenLoad(L,l);return F||this.load(L)}else return E}));if(S)return new a.JsonLdContextNormalized(A);const R=await A.reduce((E,I,L)=>E.then(F=>this.parse(I,Object.assign(Object.assign({},l),{baseIRI:w[L]||l.baseIRI,external:!!w[L]||l.external,parentContext:F.getContextRaw(),remoteContexts:w[L]?Object.assign(Object.assign({},T),{[w[L]]:!0}):T}),{skipValidation:L<A.length-1})),Promise.resolve(new a.JsonLdContextNormalized(h||{})));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(typeof c=="object"){if("@context"in c)return await this.parse(c["@context"],l);if(c=Object.assign({},c),v&&delete c["@base"],this.applyBaseEntry(c,l,!0),this.containersToHash(c),S)return new a.JsonLdContextNormalized(c);let w={};if("@import"in c)if(g>=1.1){if(typeof c["@import"]!="string")throw new t.ErrorCoded("An @import value must be a string, but got "+typeof c["@import"],t.ERROR_CODES.INVALID_IMPORT_VALUE);w=await this.loadImportContext(this.normalizeContextIri(c["@import"],f)),delete c["@import"]}else throw new t.ErrorCoded("Context importing is not supported in JSON-LD 1.0",t.ERROR_CODES.INVALID_CONTEXT_ENTRY);this.applyScopedProtected(w,{processingMode:g},a.defaultExpandOptions);const A=Object.assign(w,c);this.idifyReverseTerms(A),this.normalize(A,{processingMode:g,normalizeLanguageTags:b}),this.applyScopedProtected(A,{processingMode:g},a.defaultExpandOptions);const R=Object.keys(A),E=[];if(typeof h=="object")for(const L in h)L in A?E.push(L):A[L]=h[L];await this.parseInnerContexts(A,l,R);const I=new a.JsonLdContextNormalized(A);return(A&&A["@version"]||u.DEFAULT_PROCESSING_MODE)>=1.1&&(c["@vocab"]&&typeof c["@vocab"]=="string"||c["@vocab"]==="")&&(h&&"@vocab"in h&&c["@vocab"].indexOf(":")<0?A["@vocab"]=h["@vocab"]+c["@vocab"]:(o.Util.isCompactIri(c["@vocab"])||c["@vocab"]in A)&&(A["@vocab"]=I.expandTerm(c["@vocab"],!0))),this.expandPrefixedTerms(I,this.expandContentTypeToBase,R),!_&&h&&g>=1.1&&this.validateKeywordRedefinitions(h,A,a.defaultExpandOptions,E),this.validateContext&&!d.skipValidation&&this.validate(A,{processingMode:g}),I}else throw new t.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${c}`,t.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(c){const l=this.documentCache[c];if(l)return l;let d;try{d=await this.documentLoader.load(c)}catch(f){throw new t.ErrorCoded(`Failed to load remote context ${c}: ${f.message}`,t.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in d))throw new t.ErrorCoded(`Missing @context in remote context at ${c}`,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[c]=d["@context"]}getOverriddenLoad(c,l){if(c in(l.remoteContexts||{})){if(l.ignoreRemoteScopedContexts)return c;throw new t.ErrorCoded("Detected a cyclic context inclusion of "+c,t.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(c){let l=await this.load(c);if(typeof l!="object"||Array.isArray(l))throw new t.ErrorCoded("An imported context must be a single object: "+c,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in l)throw new t.ErrorCoded("An imported context can not import another context: "+c,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);return l=Object.assign({},l),this.containersToHash(l),l}}return u.DEFAULT_PROCESSING_MODE=1.1,ContextParser$2.ContextParser=u,ContextParser$2}var IDocumentLoader$2={},hasRequiredIDocumentLoader$2;function requireIDocumentLoader$2(){return hasRequiredIDocumentLoader$2||(hasRequiredIDocumentLoader$2=1,Object.defineProperty(IDocumentLoader$2,"__esModule",{value:!0})),IDocumentLoader$2}var JsonLdContext$2={},hasRequiredJsonLdContext$2;function requireJsonLdContext$2(){return hasRequiredJsonLdContext$2||(hasRequiredJsonLdContext$2=1,Object.defineProperty(JsonLdContext$2,"__esModule",{value:!0})),JsonLdContext$2}var hasRequiredJsonldContextParser$2;function requireJsonldContextParser$2(){return hasRequiredJsonldContextParser$2||(hasRequiredJsonldContextParser$2=1,function(n){var t=jsonldContextParser$2&&jsonldContextParser$2.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldContextParser$2&&jsonldContextParser$2.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireContextParser$2(),n),r(requireErrorCoded$2(),n),r(requireFetchDocumentLoader$2(),n),r(requireIDocumentLoader$2(),n),r(requireJsonLdContext$2(),n),r(requireJsonLdContextNormalized$2(),n),r(requireUtil$4(),n)}(jsonldContextParser$2)),jsonldContextParser$2}var SeparatorType={},hasRequiredSeparatorType;function requireSeparatorType(){if(hasRequiredSeparatorType)return SeparatorType;hasRequiredSeparatorType=1,Object.defineProperty(SeparatorType,"__esModule",{value:!0}),SeparatorType.SeparatorType=void 0;let n=class{constructor(r){this.label=r}};return SeparatorType.SeparatorType=n,n.COMMA=new n(","),n.OBJECT_START=new n("{"),n.OBJECT_END=new n("}"),n.OBJECT_END_COMMA=new n("},"),n.ARRAY_START=new n("["),n.ARRAY_END=new n("]"),n.ARRAY_END_COMMA=new n("],"),n.GRAPH_FIELD_NONCOMPACT=new n('"@graph": ['),n.GRAPH_FIELD_COMPACT=new n('"@graph":['),n.CONTEXT_FIELD=new n('"@context":'),SeparatorType}var Util$3={},hasRequiredUtil$3;function requireUtil$3(){if(hasRequiredUtil$3)return Util$3;hasRequiredUtil$3=1,Object.defineProperty(Util$3,"__esModule",{value:!0}),Util$3.Util=void 0;const n=requireJsonldContextParser$2();class t{static termToValue(a,o,u={compactIds:!1,useNativeTypes:!1}){switch(a.termType){case"NamedNode":const s=o.compactIri(a.value,u.vocab);return u.compactIds?s:{"@id":s};case"DefaultGraph":return u.compactIds?a.value:{"@id":a.value};case"BlankNode":const c=`_:${a.value}`;return u.compactIds?c:{"@id":c};case"Literal":if(a.datatype.value===t.RDF_JSON){let f;try{f=JSON.parse(a.value)}catch(h){throw new n.ErrorCoded("Invalid JSON literal: "+h.message,n.ERROR_CODES.INVALID_JSON_LITERAL)}return{"@value":f,"@type":"@json"}}if(u.rdfDirection==="i18n-datatype"&&a.datatype.value.startsWith(t.I18N)){const[f,h]=a.datatype.value.substr(t.I18N.length,a.datatype.value.length).split("_");return Object.assign(Object.assign({"@value":a.value},f?{"@language":f}:{}),h?{"@direction":h}:{})}const l=a.datatype.value===t.XSD_STRING,d={"@value":!l&&u.useNativeTypes?t.stringToNativeType(a.value,a.datatype.value):a.value};return a.language?Object.assign(Object.assign({},d),{"@language":a.language}):!l&&typeof d["@value"]=="string"?Object.assign(Object.assign({},d),{"@type":a.datatype.value}):d}}static stringToNativeType(a,o){if(o.startsWith(t.XSD))switch(o.substr(t.XSD.length)){case"boolean":if(a==="true")return!0;if(a==="false")return!1;throw new Error(`Invalid xsd:boolean value '${a}'`);case"integer":case"number":case"int":case"byte":case"long":const s=parseInt(a,10);if(isNaN(s))throw new Error(`Invalid xsd:integer value '${a}'`);return s;case"float":case"double":const c=parseFloat(a);if(isNaN(c))throw new Error(`Invalid xsd:float value '${a}'`);return c}return a}}return Util$3.Util=t,t.XSD="http://www.w3.org/2001/XMLSchema#",t.XSD_STRING=t.XSD+"string",t.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t.RDF_TYPE=t.RDF+"type",t.RDF_JSON=t.RDF+"JSON",t.I18N="https://www.w3.org/ns/i18n#",Util$3}var hasRequiredJsonLdSerializer;function requireJsonLdSerializer(){if(hasRequiredJsonLdSerializer)return JsonLdSerializer;hasRequiredJsonLdSerializer=1,Object.defineProperty(JsonLdSerializer,"__esModule",{value:!0}),JsonLdSerializer.JsonLdSerializer=void 0;const n=requireJsonldContextParser$2(),t=requireSeparatorType(),r=requireUtil$3(),a=requireBrowser();let o=class na extends a.Transform{constructor(s={}){super({objectMode:!0}),this.indentation=0,this.options=s,this.options.baseIRI&&!this.options.context&&(this.options.context={"@base":this.options.baseIRI}),this.options.context?(this.originalContext=this.options.context,this.context=new n.ContextParser().parse(this.options.context,{baseIRI:this.options.baseIRI})):this.context=Promise.resolve(new n.JsonLdContextNormalized({}))}import(s){const c=new a.PassThrough({objectMode:!0});s.on("error",d=>l.emit("error",d)),s.on("data",d=>c.push(d)),s.on("end",()=>c.push(null));const l=c.pipe(new na(this.options));return l}_transform(s,c,l){this.context.then(d=>{this.transformQuad(s,d),l()}).catch(l)}async list(s){const c=await this.context;return{"@list":s.map(l=>r.Util.termToValue(l,c,this.options))}}_flush(s){return this.opened||this.pushDocumentStart(),this.lastPredicate&&this.endPredicate(),this.lastSubject&&this.endSubject(),this.lastGraph&&this.lastGraph.termType!=="DefaultGraph"&&this.endGraph(),this.endDocument(),s(null,null)}transformQuad(s,c){this.opened||this.pushDocumentStart();const l=this.lastGraph&&this.lastGraph.termType!=="DefaultGraph"&&this.lastGraph.equals(s.subject);if(!l&&(!this.lastGraph||!s.graph.equals(this.lastGraph))){let d=s.graph.termType!=="DefaultGraph"&&this.lastSubject&&this.lastSubject.equals(s.graph);this.lastGraph&&(this.lastGraph.termType!=="DefaultGraph"?(this.endPredicate(),this.endSubject(),this.endGraph(!0),d=!1):d?(this.endPredicate(!0),this.lastSubject=null):(this.endPredicate(),this.endSubject(!0))),s.graph.termType!=="DefaultGraph"&&(d||this.pushId(s.graph,!0,c),this.pushSeparator(this.options.space?t.SeparatorType.GRAPH_FIELD_NONCOMPACT:t.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++),this.lastGraph=s.graph}(!this.lastSubject||!s.subject.equals(this.lastSubject))&&(l?(this.endPredicate(),this.endSubject(),this.indentation--,this.pushSeparator(t.SeparatorType.ARRAY_END_COMMA),this.lastGraph=s.graph):(this.lastSubject&&(this.endPredicate(),this.endSubject(!0)),this.pushId(s.subject,!0,c)),this.lastSubject=s.subject),(!this.lastPredicate||!s.predicate.equals(this.lastPredicate))&&(this.lastPredicate&&this.endPredicate(!0),this.pushPredicate(s.predicate,c)),this.pushObject(s.object,c)}pushDocumentStart(){this.opened=!0,this.originalContext&&!this.options.excludeContext?(this.pushSeparator(t.SeparatorType.OBJECT_START),this.indentation++,this.pushSeparator(t.SeparatorType.CONTEXT_FIELD),this.pushIndented(JSON.stringify(this.originalContext,null,this.options.space)+","),this.pushSeparator(this.options.space?t.SeparatorType.GRAPH_FIELD_NONCOMPACT:t.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++):(this.pushSeparator(t.SeparatorType.ARRAY_START),this.indentation++)}pushId(s,c,l){if(s.termType==="Quad")this.pushNestedQuad(s,!0,l);else{const d=s.termType==="BlankNode"?"_:"+s.value:l.compactIri(s.value,!1);c?this.pushSeparator(t.SeparatorType.OBJECT_START):(this.push(t.SeparatorType.OBJECT_START.label),this.options.space&&this.push(`
`)),this.indentation++,this.pushIndented(this.options.space?`"@id": "${d}",`:`"@id":"${d}",`)}}pushPredicate(s,c){let l=s.value;!this.options.useRdfType&&l===r.Util.RDF_TYPE&&(l="@type",this.objectOptions=Object.assign(Object.assign({},this.options),{compactIds:!0,vocab:!0}));const d=c.compactIri(l,!0);this.pushIndented(this.options.space?`"${d}": [`:`"${d}":[`),this.indentation++,this.lastPredicate=s}pushObject(s,c){if(this.hadObjectForPredicate?this.pushSeparator(t.SeparatorType.COMMA):this.hadObjectForPredicate=!0,s.termType==="Quad"){const d=this.lastSubject,f=this.lastPredicate;this.hadObjectForPredicate=!1,this.pushNestedQuad(s,!1,c),this.endSubject(!1),this.hadObjectForPredicate=!0,this.lastPredicate=f,this.lastSubject=d;return}let l;try{s["@list"]?l=s:l=r.Util.termToValue(s,c,this.objectOptions||this.options)}catch(d){return this.emit("error",d)}this.pushIndented(JSON.stringify(l,null,this.options.space))}pushNestedQuad(s,c,l){this.pushSeparator(t.SeparatorType.OBJECT_START),this.indentation++,this.pushIndented(this.options.space?'"@id": ':'"@id":',!1),s.graph.termType!=="DefaultGraph"&&this.emit("error",new Error(`Found a nested quad with the non-default graph: ${s.graph.value}`)),this.pushId(s.subject,!1,l),this.pushPredicate(s.predicate,l),this.pushObject(s.object,l),this.endPredicate(!1),this.endSubject(c)}endDocument(){this.opened=!1,this.originalContext&&!this.options.excludeContext?(this.indentation--,this.pushSeparator(t.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(t.SeparatorType.OBJECT_END)):(this.indentation--,this.pushSeparator(t.SeparatorType.ARRAY_END))}endPredicate(s){this.indentation--,this.pushSeparator(s?t.SeparatorType.ARRAY_END_COMMA:t.SeparatorType.ARRAY_END),this.hadObjectForPredicate=!1,this.objectOptions=null,this.lastPredicate=null}endSubject(s){this.indentation--,this.pushSeparator(s?t.SeparatorType.OBJECT_END_COMMA:t.SeparatorType.OBJECT_END),this.lastSubject=null}endGraph(s){this.indentation--,this.pushSeparator(t.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(s?t.SeparatorType.OBJECT_END_COMMA:t.SeparatorType.OBJECT_END),this.lastGraph=null}pushSeparator(s){this.pushIndented(s.label)}pushIndented(s,c=!0){const l=this.getIndentPrefix(),d=s.split(`
`).map(f=>l+f).join(`
`);this.push(d),this.options.space&&c&&this.push(`
`)}getIndentPrefix(){return this.options.space?this.options.space.repeat(this.indentation):""}};return JsonLdSerializer.JsonLdSerializer=o,JsonLdSerializer}var hasRequiredJsonldStreamingSerializer;function requireJsonldStreamingSerializer(){return hasRequiredJsonldStreamingSerializer||(hasRequiredJsonldStreamingSerializer=1,function(n){var t=jsonldStreamingSerializer&&jsonldStreamingSerializer.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldStreamingSerializer&&jsonldStreamingSerializer.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireJsonLdSerializer(),n),r(requireUtil$3(),n)}(jsonldStreamingSerializer)),jsonldStreamingSerializer}var hasRequiredActorRdfSerializeJsonLd;function requireActorRdfSerializeJsonLd(){if(hasRequiredActorRdfSerializeJsonLd)return ActorRdfSerializeJsonLd;hasRequiredActorRdfSerializeJsonLd=1,Object.defineProperty(ActorRdfSerializeJsonLd,"__esModule",{value:!0}),ActorRdfSerializeJsonLd.ActorRdfSerializeJsonLd=void 0;const n=requireLib$37(),t=requireJsonldStreamingSerializer();let r=class extends n.ActorRdfSerializeFixedMediaTypes{constructor(o){super(o)}async runHandle(o,u,s){const c=new t.JsonLdSerializer({space:" ".repeat(this.jsonStringifyIndentSpaces)});let l;return"pipe"in o.quadStream?(o.quadStream.on("error",d=>c.emit("error",d)),l=o.quadStream.pipe(c)):l=c.import(o.quadStream),{data:l}}};return ActorRdfSerializeJsonLd.ActorRdfSerializeJsonLd=r,ActorRdfSerializeJsonLd}var hasRequiredLib$35;function requireLib$35(){return hasRequiredLib$35||(hasRequiredLib$35=1,function(n){var t=lib$35&&lib$35.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$35&&lib$35.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfSerializeJsonLd(),n)}(lib$35)),lib$35}var lib$34={},ActorRdfSerializeShaclc={},arrayifyStream={},hasRequiredArrayifyStream;function requireArrayifyStream(){if(hasRequiredArrayifyStream)return arrayifyStream;hasRequiredArrayifyStream=1,Object.defineProperty(arrayifyStream,"__esModule",{value:!0});function n(r,a){return new Promise((o,u)=>{r.on("end",()=>o(a)),r.on("error",u)})}function t(r){const a=[];return n(r.on("data",o=>a.push(o)),a)}return arrayifyStream.default=t,arrayifyStream}var dist$3={},ShaclcGenerator={},dist$2={},fragment={},hasRequiredFragment;function requireFragment(){if(hasRequiredFragment)return fragment;hasRequiredFragment=1,Object.defineProperty(fragment,"__esModule",{value:!0}),fragment.fragment=void 0;function n(a){let o=a;(o.endsWith("/")||o.endsWith("#"))&&(o=o.slice(0,o.length-1));const u=[];o.lastIndexOf("/")>0&&u.push(o.lastIndexOf("/")),o.lastIndexOf("#")>0&&u.push(o.lastIndexOf("#"));const s=Math.max(...u);return o.slice(s+1)}function t(a){var o;const u=(o=a.split(/[^a-z0-9]+/ig).filter(s=>s!=="").map(s=>s[0].toUpperCase()+s.slice(1)).join("").match(/[a-z][a-z0-9]+/ig))===null||o===void 0?void 0:o[0];return typeof u>"u"?void 0:u[0].toLowerCase()+u.slice(1)}function r(a){let o=n(a);return o=o?t(o):void 0,o||"v"}return fragment.fragment=r,fragment}var lookup$2={},lookupNamespace={},fetchContext={},browserPonyfill={exports:{}},hasRequiredBrowserPonyfill;function requireBrowserPonyfill(){return hasRequiredBrowserPonyfill||(hasRequiredBrowserPonyfill=1,function(n,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof commonjsGlobal$1<"u"&&commonjsGlobal$1,a=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(s){var c=typeof u<"u"&&u||typeof self<"u"&&self||typeof commonjsGlobal$1<"u"&&commonjsGlobal$1||{},l={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function d(M){return M&&DataView.prototype.isPrototypeOf(M)}if(l.arrayBuffer)var f=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(M){return M&&f.indexOf(Object.prototype.toString.call(M))>-1};function v(M){if(typeof M!="string"&&(M=String(M)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(M)||M==="")throw new TypeError('Invalid character in header field name: "'+M+'"');return M.toLowerCase()}function g(M){return typeof M!="string"&&(M=String(M)),M}function b(M){var N={next:function(){var G=M.shift();return{done:G===void 0,value:G}}};return l.iterable&&(N[Symbol.iterator]=function(){return N}),N}function _(M){this.map={},M instanceof _?M.forEach(function(N,G){this.append(G,N)},this):Array.isArray(M)?M.forEach(function(N){if(N.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+N.length);this.append(N[0],N[1])},this):M&&Object.getOwnPropertyNames(M).forEach(function(N){this.append(N,M[N])},this)}_.prototype.append=function(M,N){M=v(M),N=g(N);var G=this.map[M];this.map[M]=G?G+", "+N:N},_.prototype.delete=function(M){delete this.map[v(M)]},_.prototype.get=function(M){return M=v(M),this.has(M)?this.map[M]:null},_.prototype.has=function(M){return this.map.hasOwnProperty(v(M))},_.prototype.set=function(M,N){this.map[v(M)]=g(N)},_.prototype.forEach=function(M,N){for(var G in this.map)this.map.hasOwnProperty(G)&&M.call(N,this.map[G],G,this)},_.prototype.keys=function(){var M=[];return this.forEach(function(N,G){M.push(G)}),b(M)},_.prototype.values=function(){var M=[];return this.forEach(function(N){M.push(N)}),b(M)},_.prototype.entries=function(){var M=[];return this.forEach(function(N,G){M.push([G,N])}),b(M)},l.iterable&&(_.prototype[Symbol.iterator]=_.prototype.entries);function S(M){if(!M._noBody){if(M.bodyUsed)return Promise.reject(new TypeError("Already read"));M.bodyUsed=!0}}function T(M){return new Promise(function(N,G){M.onload=function(){N(M.result)},M.onerror=function(){G(M.error)}})}function w(M){var N=new FileReader,G=T(N);return N.readAsArrayBuffer(M),G}function A(M){var N=new FileReader,G=T(N),X=/charset=([A-Za-z0-9_-]+)/.exec(M.type),Y=X?X[1]:"utf-8";return N.readAsText(M,Y),G}function R(M){for(var N=new Uint8Array(M),G=new Array(N.length),X=0;X<N.length;X++)G[X]=String.fromCharCode(N[X]);return G.join("")}function E(M){if(M.slice)return M.slice(0);var N=new Uint8Array(M.byteLength);return N.set(new Uint8Array(M)),N.buffer}function I(){return this.bodyUsed=!1,this._initBody=function(M){this.bodyUsed=this.bodyUsed,this._bodyInit=M,M?typeof M=="string"?this._bodyText=M:l.blob&&Blob.prototype.isPrototypeOf(M)?this._bodyBlob=M:l.formData&&FormData.prototype.isPrototypeOf(M)?this._bodyFormData=M:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(M)?this._bodyText=M.toString():l.arrayBuffer&&l.blob&&d(M)?(this._bodyArrayBuffer=E(M.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(M)||h(M))?this._bodyArrayBuffer=E(M):this._bodyText=M=Object.prototype.toString.call(M):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof M=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(M)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var M=S(this);if(M)return M;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var M=S(this);return M||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(l.blob)return this.blob().then(w);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var M=S(this);if(M)return M;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(R(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function F(M){var N=M.toUpperCase();return L.indexOf(N)>-1?N:M}function D(M,N){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');N=N||{};var G=N.body;if(M instanceof D){if(M.bodyUsed)throw new TypeError("Already read");this.url=M.url,this.credentials=M.credentials,N.headers||(this.headers=new _(M.headers)),this.method=M.method,this.mode=M.mode,this.signal=M.signal,!G&&M._bodyInit!=null&&(G=M._bodyInit,M.bodyUsed=!0)}else this.url=String(M);if(this.credentials=N.credentials||this.credentials||"same-origin",(N.headers||!this.headers)&&(this.headers=new _(N.headers)),this.method=F(N.method||this.method||"GET"),this.mode=N.mode||this.mode||null,this.signal=N.signal||this.signal||function(){if("AbortController"in c){var W=new AbortController;return W.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(G),(this.method==="GET"||this.method==="HEAD")&&(N.cache==="no-store"||N.cache==="no-cache")){var X=/([?&])_=[^&]*/;if(X.test(this.url))this.url=this.url.replace(X,"$1_="+new Date().getTime());else{var Y=/\?/;this.url+=(Y.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function $(M){var N=new FormData;return M.trim().split("&").forEach(function(G){if(G){var X=G.split("="),Y=X.shift().replace(/\+/g," "),W=X.join("=").replace(/\+/g," ");N.append(decodeURIComponent(Y),decodeURIComponent(W))}}),N}function O(M){var N=new _,G=M.replace(/\r?\n[\t ]+/g," ");return G.split("\r").map(function(X){return X.indexOf(`
`)===0?X.substr(1,X.length):X}).forEach(function(X){var Y=X.split(":"),W=Y.shift().trim();if(W){var te=Y.join(":").trim();try{N.append(W,te)}catch(ue){console.warn("Response "+ue.message)}}}),N}I.call(D.prototype);function P(M,N){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(N||(N={}),this.type="default",this.status=N.status===void 0?200:N.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=N.statusText===void 0?"":""+N.statusText,this.headers=new _(N.headers),this.url=N.url||"",this._initBody(M)}I.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new _(this.headers),url:this.url})},P.error=function(){var M=new P(null,{status:200,statusText:""});return M.ok=!1,M.status=0,M.type="error",M};var C=[301,302,303,307,308];P.redirect=function(M,N){if(C.indexOf(N)===-1)throw new RangeError("Invalid status code");return new P(null,{status:N,headers:{location:M}})},s.DOMException=c.DOMException;try{new s.DOMException}catch{s.DOMException=function(N,G){this.message=N,this.name=G;var X=Error(N);this.stack=X.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function q(M,N){return new Promise(function(G,X){var Y=new D(M,N);if(Y.signal&&Y.signal.aborted)return X(new s.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function te(){W.abort()}W.onload=function(){var re={statusText:W.statusText,headers:O(W.getAllResponseHeaders()||"")};Y.url.indexOf("file://")===0&&(W.status<200||W.status>599)?re.status=200:re.status=W.status,re.url="responseURL"in W?W.responseURL:re.headers.get("X-Request-URL");var ye="response"in W?W.response:W.responseText;setTimeout(function(){G(new P(ye,re))},0)},W.onerror=function(){setTimeout(function(){X(new TypeError("Network request failed"))},0)},W.ontimeout=function(){setTimeout(function(){X(new TypeError("Network request timed out"))},0)},W.onabort=function(){setTimeout(function(){X(new s.DOMException("Aborted","AbortError"))},0)};function ue(re){try{return re===""&&c.location.href?c.location.href:re}catch{return re}}if(W.open(Y.method,ue(Y.url),!0),Y.credentials==="include"?W.withCredentials=!0:Y.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&(l.blob?W.responseType="blob":l.arrayBuffer&&(W.responseType="arraybuffer")),N&&typeof N.headers=="object"&&!(N.headers instanceof _||c.Headers&&N.headers instanceof c.Headers)){var fe=[];Object.getOwnPropertyNames(N.headers).forEach(function(re){fe.push(v(re)),W.setRequestHeader(re,g(N.headers[re]))}),Y.headers.forEach(function(re,ye){fe.indexOf(ye)===-1&&W.setRequestHeader(ye,re)})}else Y.headers.forEach(function(re,ye){W.setRequestHeader(ye,re)});Y.signal&&(Y.signal.addEventListener("abort",te),W.onreadystatechange=function(){W.readyState===4&&Y.signal.removeEventListener("abort",te)}),W.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return q.polyfill=!0,c.fetch||(c.fetch=q,c.Headers=_,c.Request=D,c.Response=P),s.Headers=_,s.Request=D,s.Response=P,s.fetch=q,Object.defineProperty(s,"__esModule",{value:!0}),s})({})})(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var o=r.fetch?r:a;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,n.exports=t}(browserPonyfill,browserPonyfill.exports)),browserPonyfill.exports}var hasRequiredFetchContext;function requireFetchContext(){if(hasRequiredFetchContext)return fetchContext;hasRequiredFetchContext=1;var n=fetchContext&&fetchContext.__awaiter||function(o,u,s,c){function l(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function h(b){try{g(c.next(b))}catch(_){f(_)}}function v(b){try{g(c.throw(b))}catch(_){f(_)}}function g(b){b.done?d(b.value):l(b.value).then(h,v)}g((c=c.apply(o,u||[])).next())})};Object.defineProperty(fetchContext,"__esModule",{value:!0}),fetchContext.fetchContext=fetchContext.fetchJson=void 0;const t=requireBrowserPonyfill();function r(o,u){var s;return n(this,void 0,void 0,function*(){return(yield((s=u==null?void 0:u.fetch)!==null&&s!==void 0?s:t.fetch)(o)).json()})}fetchContext.fetchJson=r;function a(o,u){return n(this,void 0,void 0,function*(){return(yield r(o,u))["@context"]})}return fetchContext.fetchContext=a,fetchContext}var hasRequiredLookupNamespace;function requireLookupNamespace(){if(hasRequiredLookupNamespace)return lookupNamespace;hasRequiredLookupNamespace=1;var n=lookupNamespace&&lookupNamespace.__awaiter||function(a,o,u,s){function c(l){return l instanceof u?l:new u(function(d){d(l)})}return new(u||(u=Promise))(function(l,d){function f(g){try{v(s.next(g))}catch(b){d(b)}}function h(g){try{v(s.throw(g))}catch(b){d(b)}}function v(g){g.done?l(g.value):c(g.value).then(f,h)}v((s=s.apply(a,o||[])).next())})};Object.defineProperty(lookupNamespace,"__esModule",{value:!0}),lookupNamespace.lookupUri=void 0;const t=requireFetchContext();function r(a,o){return n(this,void 0,void 0,function*(){const u=(yield(0,t.fetchContext)(`https://prefix.cc/${a}.file.jsonld`,o))[a];if(typeof u!="string")throw new Error(`Expected uri to be a string, received: ${u} of type ${typeof u}`);return u})}return lookupNamespace.lookupUri=r,lookupNamespace}var lookupPrefix={},hasRequiredLookupPrefix;function requireLookupPrefix(){if(hasRequiredLookupPrefix)return lookupPrefix;hasRequiredLookupPrefix=1;var n=lookupPrefix&&lookupPrefix.__awaiter||function(a,o,u,s){function c(l){return l instanceof u?l:new u(function(d){d(l)})}return new(u||(u=Promise))(function(l,d){function f(g){try{v(s.next(g))}catch(b){d(b)}}function h(g){try{v(s.throw(g))}catch(b){d(b)}}function v(g){g.done?l(g.value):c(g.value).then(f,h)}v((s=s.apply(a,o||[])).next())})};Object.defineProperty(lookupPrefix,"__esModule",{value:!0}),lookupPrefix.lookupPrefix=void 0;const t=requireFetchContext();function r(a,o){return n(this,void 0,void 0,function*(){const u=new URL("https://prefix.cc/reverse");u.searchParams.append("uri",a),u.searchParams.append("format","jsonld");const s=Object.keys(yield(0,t.fetchContext)(u,o));if(s.length===0)throw new Error("No prefixes returned");return s[0]})}return lookupPrefix.lookupPrefix=r,lookupPrefix}var lookupAllPrefixes={},hasRequiredLookupAllPrefixes;function requireLookupAllPrefixes(){if(hasRequiredLookupAllPrefixes)return lookupAllPrefixes;hasRequiredLookupAllPrefixes=1;var n=lookupAllPrefixes&&lookupAllPrefixes.__awaiter||function(a,o,u,s){function c(l){return l instanceof u?l:new u(function(d){d(l)})}return new(u||(u=Promise))(function(l,d){function f(g){try{v(s.next(g))}catch(b){d(b)}}function h(g){try{v(s.throw(g))}catch(b){d(b)}}function v(g){g.done?l(g.value):c(g.value).then(f,h)}v((s=s.apply(a,o||[])).next())})};Object.defineProperty(lookupAllPrefixes,"__esModule",{value:!0}),lookupAllPrefixes.lookupAllPrefixes=void 0;const t=requireFetchContext();function r(a){return n(this,void 0,void 0,function*(){return(0,t.fetchContext)("https://prefix.cc/context",a)})}return lookupAllPrefixes.lookupAllPrefixes=r,lookupAllPrefixes}var hasRequiredLookup;function requireLookup(){return hasRequiredLookup||(hasRequiredLookup=1,function(n){var t=lookup$2&&lookup$2.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lookup$2&&lookup$2.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireLookupNamespace(),n),r(requireLookupPrefix(),n),r(requireLookupAllPrefixes(),n)}(lookup$2)),lookup$2}var hasRequiredDist$2;function requireDist$2(){return hasRequiredDist$2||(hasRequiredDist$2=1,function(n){var t=dist$2&&dist$2.__awaiter||function(c,l,d,f){function h(v){return v instanceof d?v:new d(function(g){g(v)})}return new(d||(d=Promise))(function(v,g){function b(T){try{S(f.next(T))}catch(w){g(w)}}function _(T){try{S(f.throw(T))}catch(w){g(w)}}function S(T){T.done?v(T.value):h(T.value).then(b,_)}S((f=f.apply(c,l||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.lookupAllPrefixes=n.prefixToUri=n.uriToPrefix=void 0;const r=requireFragment(),a=requireLookup();function o(c,l){return t(this,void 0,void 0,function*(){let d;try{d=yield(0,a.lookupPrefix)(c,l)}catch{l!=null&&l.mintOnUnknown&&(d=(0,r.fragment)(c).slice(0,4))}if(typeof d<"u"&&typeof(l==null?void 0:l.existingPrefixes)=="object"&&d in l.existingPrefixes){let f=0;for(;`${d}${f}`in l.existingPrefixes;)f+=1;d=`${d}${f}`}return d})}n.uriToPrefix=o;function u(c,l){return t(this,void 0,void 0,function*(){try{return yield(0,a.lookupUri)(c,l)}catch{return}})}n.prefixToUri=u;var s=requireLookup();Object.defineProperty(n,"lookupAllPrefixes",{enumerable:!0,get:function(){return s.lookupAllPrefixes}})}(dist$2)),dist$2}var utils$2={},hasRequiredUtils$3;function requireUtils$3(){if(hasRequiredUtils$3)return utils$2;hasRequiredUtils$3=1,Object.defineProperty(utils$2,"__esModule",{value:!0}),utils$2.getShaclName=void 0;function n(t){if(t.termType!=="NamedNode"||!t.value.startsWith("http://www.w3.org/ns/shacl#"))throw new Error(`Term ${t.value} is not part of the SHACL namespace`);return t.value.slice(27)}return utils$2.getShaclName=n,utils$2}var propertyParam_={},hasRequiredPropertyParam_;function requirePropertyParam_(){return hasRequiredPropertyParam_||(hasRequiredPropertyParam_=1,Object.defineProperty(propertyParam_,"__esModule",{value:!0}),propertyParam_.default={deactivated:!0,severity:!0,message:!0,class:!0,datatype:!0,nodeKind:!0,minExclusive:!0,minInclusive:!0,maxExclusive:!0,maxInclusive:!0,minLength:!0,maxLength:!0,pattern:!0,flags:!0,languageIn:!0,uniqueLang:!0,equals:!0,disjoint:!0,lessThan:!0,lessThanOrEquals:!0,qualifiedValueShape:!0,qualifiedMinCount:!0,qualifiedMaxCount:!0,qualifiedValueShapesDisjoint:!0,closed:!0,ignoredProperties:!0,hasValue:!0,in:!0,node:!0}),propertyParam_}var basePrefixes={},hasRequiredBasePrefixes;function requireBasePrefixes(){return hasRequiredBasePrefixes||(hasRequiredBasePrefixes=1,Object.defineProperty(basePrefixes,"__esModule",{value:!0}),basePrefixes.default={owl:"http://www.w3.org/2002/07/owl#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",sh:"http://www.w3.org/ns/shacl#",xsd:"http://www.w3.org/2001/XMLSchema#"}),basePrefixes}var nodeParam={},hasRequiredNodeParam;function requireNodeParam(){return hasRequiredNodeParam||(hasRequiredNodeParam=1,Object.defineProperty(nodeParam,"__esModule",{value:!0}),nodeParam.default={targetNode:!0,targetObjectsOf:!0,targetSubjectsOf:!0,deactivated:!0,severity:!0,message:!0,class:!0,datatype:!0,nodeKind:!0,minExclusive:!0,minInclusive:!0,maxExclusive:!0,maxInclusive:!0,minLength:!0,maxLength:!0,pattern:!0,flags:!0,languageIn:!0,equals:!0,disjoint:!0,closed:!0,ignoredProperties:!0,hasValue:!0,in:!0}),nodeParam}var hasRequiredShaclcGenerator;function requireShaclcGenerator(){if(hasRequiredShaclcGenerator)return ShaclcGenerator;hasRequiredShaclcGenerator=1;var n=ShaclcGenerator&&ShaclcGenerator.__awaiter||function(g,b,_,S){function T(w){return w instanceof _?w:new _(function(A){A(w)})}return new(_||(_=Promise))(function(w,A){function R(L){try{I(S.next(L))}catch(F){A(F)}}function E(L){try{I(S.throw(L))}catch(F){A(F)}}function I(L){L.done?w(L.value):T(L.value).then(R,E)}I((S=S.apply(g,b||[])).next())})},t=ShaclcGenerator&&ShaclcGenerator.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(ShaclcGenerator,"__esModule",{value:!0});const r=require$$0,a=requireDist$2(),o=requireRdfStringTtl(),u=requireUtils$3(),s=t(requirePropertyParam_()),c=t(requireBasePrefixes()),l=t(requireNodeParam());function d(g){var b;return(b=/^[^]*[#/]/.exec(g))===null||b===void 0?void 0:b[0]}const f={"http://www.w3.org/1999/02/22-rdf-syntax-ns#":"rdf","http://www.w3.org/2000/01/rdf-schema#":"rdfs","http://www.w3.org/ns/shacl#":"sh","http://www.w3.org/2001/XMLSchema#":"xsd"},h={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",sh:"http://www.w3.org/ns/shacl#",xsd:"http://www.w3.org/2001/XMLSchema#"};class v{constructor(b,_,S={},T=void 0,w=!0,A=!1,R,E=!1){this.store=b,this.base=T,this.errorOnExtraQuads=w,this.mintUnspecifiedPrefixes=A,this.fetch=R,this.extendedSyntax=E,this.prefixes={},this.prefixRev={};for(const I of Object.keys(S)){const L=S[I],F=typeof L=="string"?L:L.value;!(F in f)&&!(I in h)&&(this.prefixRev[F]=I,this.prefixes[I]=F)}this.writer=_}write(){return n(this,void 0,void 0,function*(){const b=this.store.getQuads(null,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","http://www.w3.org/2002/07/owl#Ontology",null);if(b.length===1&&b[0].subject.termType==="NamedNode"){const S=b[0].subject;this.store.removeQuads(b),S.equals(new r.NamedNode("urn:x-base:default"))||this.writer.add(`BASE ${(0,o.termToString)(S)}`),yield this.writeImports(S)}else throw new Error("Base expected");if(this.mintUnspecifiedPrefixes){const S=new Set;for(const w of[...this.store.getSubjects(null,null,null),...this.store.getPredicates(null,null,null),...this.store.getObjects(null,null,null)])if(w.termType==="NamedNode"){const A=d(w.value);A&&!(A in this.prefixRev)&&!(A in f)&&S.add(A)}const T=Object.assign(Object.assign({},this.prefixes),h);yield Promise.all([...S].map(w=>(0,a.uriToPrefix)(w,{fetch:this.fetch,mintOnUnknown:!0,existingPrefixes:T}).then(A=>{this.prefixes[A]=w,T[A]=w,this.prefixRev[w]=A})))}const _=new Set([...this.store.getSubjects(null,null,null),...this.store.getPredicates(null,null,null),...this.store.getObjects(null,null,null)].filter(S=>S.termType==="NamedNode").map(S=>d(S.value)).filter(S=>typeof S=="string"));for(const S in this.prefixRev)_.has(S)||(delete this.prefixes[this.prefixRev[S]],delete this.prefixRev[S]);if(yield this.writePrefixes(),this.prefixes=Object.assign(Object.assign({},this.prefixes),h),this.prefixRev=Object.assign(Object.assign({},this.prefixRev),f),this.writer.newLine(),yield this.writeShapes(),this.extendedSyntax){const S=this.store.getSubjects(null,null,null);S.length>0&&this.writer.newLine(1);for(const T of S)this.writer.add(yield this.termToString(T,!0,!0)),this.writer.add(" "),this.writer.indent(),yield this.writeTurtlePredicates(T),this.writer.deindent();S.length>0&&(this.writer.add(" ."),this.writer.newLine())}if(this.errorOnExtraQuads&&this.store.size>0)throw new Error(`Dataset contains quads that cannot be written in SHACLC [
${new r.Writer({prefixes:this.prefixes}).quadsToString(this.store.getQuads(null,null,null,null))}]`);this.writer.end()})}writeImports(b){return n(this,void 0,void 0,function*(){const _=this.store.getObjectsOnce(b,new r.NamedNode("http://www.w3.org/2002/07/owl#imports"),null);if(_.length>0)for(const S of _)this.writer.add(`IMPORTS <${S.value}>`,!0)})}writePrefixes(){return n(this,void 0,void 0,function*(){const b=Object.keys(this.prefixes).filter(_=>!(_ in c.default)).sort();if(b.length>0)for(const _ of b)this.writer.add(`PREFIX ${_}: <${this.prefixes[_]}>`,!0)})}termToString(b,_=!1,S=!1){return n(this,void 0,void 0,function*(){try{if(_)throw new Error("Shacl name disabled");return(0,u.getShaclName)(b)}catch{}if(b.termType==="NamedNode"){const T=d(b.value);return T&&T in this.prefixRev&&T in this.prefixRev?`${this.prefixRev[T]}:${b.value.slice(T.length)}`:(0,o.termToString)(b)}if(b.termType==="Literal")return b.datatypeString==="http://www.w3.org/2001/XMLSchema#integer"||b.datatypeString==="http://www.w3.org/2001/XMLSchema#boolean"?b.value:(0,o.termToString)(b);throw b.termType==="BlankNode"&&S&&(0,o.termToString)(b),new Error(`Invalid term type for extra statement ${b.value} (${b.termType})`)})}writeShapes(){return n(this,void 0,void 0,function*(){for(const b of this.store.getSubjectsOnce(new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),new r.NamedNode("http://www.w3.org/ns/shacl#NodeShape"),null)){this.store.getQuadsOnce(b,new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),new r.NamedNode("http://www.w3.org/2000/01/rdf-schema#Class"),null).length>0?this.writer.add("shapeClass "):this.writer.add("shape "),this.writer.add(yield this.termToString(b)),this.writer.add(" ");const _=this.store.getObjectsOnce(b,new r.NamedNode("http://www.w3.org/ns/shacl#targetClass"),null);if(_.length>0){this.writer.add("-> ");for(const T of _)T.termType==="NamedNode"?this.writer.add(yield this.termToString(T)):(this.writer.add("!"),this.writer.add(yield this.termToString(this.singleObject(T,new r.NamedNode("http://www.w3.org/ns/shacl#not"),!0)))),this.writer.add(" ")}const S=this.store.getPredicates(b,null,null).filter(T=>[new r.NamedNode("http://www.w3.org/ns/shacl#targetClass"),new r.NamedNode("http://www.w3.org/ns/shacl#property"),new r.NamedNode("http://www.w3.org/ns/shacl#or"),...Object.keys(l.default).map(w=>new r.NamedNode("http://www.w3.org/ns/shacl#"+w))].every(w=>!T.equals(w)));S.length>0&&(this.writer.add(";"),this.writer.indent(),this.writer.newLine(1)),this.extendedSyntax&&(yield this.writeGivenTurtlePredicates(b,S)),S.length>0&&(this.writer.add(" "),this.writer.deindent()),yield this.writeShapeBody(b,!1)}})}getSingleProperty(b,_){let S=[b];try{let T=(0,u.getShaclName)(b.predicate),w="pred";if(T==="not"){const A=this.store.getQuadsOnce(b.object,null,null,null);if(S=S.concat(A),A.length!==1)throw new Error("Can only handle having one predicate of 'not'");[b]=A,T=(0,u.getShaclName)(b.predicate),w="not"}if(!(T in _))throw new Error(`${T} is not allowed`);return{name:T,type:w,object:b.object}}catch{this.store.addQuads(S)}}singleLayerPropertiesList(b,_){const S=[];for(const T of this.store.getQuadsOnce(b,null,null,null)){const w=this.getSingleProperty(T,_);w&&S.push(w)}return S}expectOneProperty(b,_){const S=this.store.getQuadsOnce(b,null,null,null);if(S.length===1){const T=this.getSingleProperty(S[0],_);if(T)return T}this.store.addQuads(S)}orProperties(b,_){const S=[];for(const T of this.store.getQuadsOnce(b,new r.NamedNode("http://www.w3.org/ns/shacl#or"),null,null)){const w=[];for(const A of this.getList(T.object)){const R=this.expectOneProperty(A,_);if(!R)throw this.store.addQuad(T),new Error("Each entry of the 'or' statement must declare exactly one property");w.push(R)}S.push(w)}return S}getList(b){let _=b;const S=[];for(;!_.equals(new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"));)S.push(this.singleObject(_,new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"),!0)),_=this.singleObject(_,new r.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"),!0);return S}writeIriLiteralOrArray(b){return n(this,void 0,void 0,function*(){if(b.termType==="BlankNode"){this.writer.add("[");let _=!0;for(const S of this.getList(b))_?_=!1:this.writer.add(" "),this.writer.add(yield this.termToString(S));this.writer.add("]")}else this.writer.add(yield this.termToString(b))})}singleObject(b,_,S){var T;return(T=this.singleQuad(b,_,S))===null||T===void 0?void 0:T.object}singleQuad(b,_,S=!1){const T=this.store.getQuadsOnce(b,_,null,null);if(S&&T.length!==1)throw this.store.addQuads(T),new Error(`The subject and predicate ${b==null?void 0:b.value} ${_==null?void 0:_.value} must have exactly one object. Instead has ${T.length}`);if(T.length>1)throw this.store.addQuads(T),new Error(`The subject and predicate ${b==null?void 0:b.value} ${_==null?void 0:_.value} can have at most one object. Instead has ${T.length}`);return T.length===1?T[0]:void 0}writeAssigment({name:b,type:_,object:S}){return n(this,void 0,void 0,function*(){_==="not"&&this.writer.add("!"),this.writer.add(b),this.writer.add("="),yield this.writeIriLiteralOrArray(S)})}writeAtom({name:b,type:_,object:S}){return n(this,void 0,void 0,function*(){switch(_==="not"&&this.writer.add("!"),b){case"node":{if(S.termType==="NamedNode")this.writer.add(`@${yield this.termToString(S)}`);else if(S.termType==="BlankNode")yield this.writeShapeBody(S);else throw new Error("Invalid nested shape, must be blank node or IRI");return}case"nodeKind":{this.writer.add((0,u.getShaclName)(S));return}case"class":{this.writer.add(yield this.termToString(S));return}case"datatype":{this.writer.add(yield this.termToString(S));return}default:this.writer.add(b),this.writer.add("="),yield this.writeIriLiteralOrArray(S)}})}writeAssigments(b,_=" ",S=!0,T){return n(this,void 0,void 0,function*(){for(const w of b)S?S=!1:this.writer.add(_),T?yield this.writeAtom(w):yield this.writeAssigment(w)})}writeParams(b,_=!0,S,T=!1,w=!1){return n(this,void 0,void 0,function*(){const A=this.orProperties(b,S),R=this.singleLayerPropertiesList(b,S);w&&(A.length>0||R.length>0)&&this.writer.newLine(1);for(const E of A)_?_=!1:this.writer.add(" "),yield this.writeAssigments(E,"|",!0,T);yield this.writeAssigments(R," ",_,T),w&&(A.length>0||R.length>0)&&this.writer.add(" .")})}writeShapeBody(b,_=!0){return n(this,void 0,void 0,function*(){this.writer.add("{").indent();const S=this.store.getObjectsOnce(b,new r.NamedNode("http://www.w3.org/ns/shacl#property"),null);yield this.writeParams(b,!0,l.default,!1,!0);for(const T of S)this.writer.newLine(1),yield this.writeProperty(T);this.writer.deindent().newLine(1),_?this.writer.add("} ."):this.writer.add("}").newLine(1)})}writeProperty(b){return n(this,void 0,void 0,function*(){yield this.writePath(this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#path"),!0));const _=this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#minCount")),S=this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#maxCount")),T=this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#nodeKind")),w=this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#class")),A=this.singleObject(b,new r.NamedNode("http://www.w3.org/ns/shacl#datatype")),R=this.store.getObjectsOnce(b,new r.NamedNode("http://www.w3.org/ns/shacl#node"),null);if(T&&(this.writer.add(" "),this.writer.add((0,u.getShaclName)(T))),w&&(this.writer.add(" "),this.writer.add(yield this.termToString(w))),A&&(this.writer.add(" "),this.writer.add(yield this.termToString(A))),_!==void 0||S!==void 0){if(this.writer.add(" ["),_){if(_.termType!=="Literal"||_.datatypeString!=="http://www.w3.org/2001/XMLSchema#integer")throw new Error("Invalid min value, must me an integer literal");this.writer.add(_.value)}else this.writer.add("0");if(this.writer.add(".."),S){if(S.termType!=="Literal"||S.datatypeString!=="http://www.w3.org/2001/XMLSchema#integer")throw new Error("Invalid max value, must me an integer literal");this.store.removeMatches(b,new r.NamedNode("http://www.w3.org/ns/shacl#maxCount"),void 0,void 0),this.writer.add(S.value)}else this.writer.add("*");this.writer.add("]")}yield this.writeParams(b,!1,s.default,!0);const E=[];for(const I of R)if(I.termType==="NamedNode")this.writer.add(" "),this.writer.add(`@${yield this.termToString(I)}`);else if(I.termType==="BlankNode")E.push(I);else throw new Error("Invalid nested shape, must be blank node or IRI");for(const I of E)this.writer.add(" "),yield this.writeShapeBody(I);this.extendedSyntax&&this.store.getQuads(b,null,null,null).length>0&&(this.writer.add(" %"),this.writer.indent(),this.writer.newLine(1),yield this.writeTurtlePredicates(b),this.writer.deindent(),this.writer.newLine(1),this.writer.add("%")),E.length===0&&this.writer.add(" .")})}writeTurtlePredicates(b){return n(this,void 0,void 0,function*(){return this.writeGivenTurtlePredicates(b,this.store.getPredicates(b,null,null))})}writeGivenTurtlePredicates(b,_){return n(this,void 0,void 0,function*(){let S=!1;if(_.some(T=>T.equals(r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")))){const T=this.store.getObjectsOnce(b,r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),null);T.length>0&&(S=!0,this.writer.add("a "),yield this.writeTurtleObjects(T))}for(const T of _)T.equals(r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"))||(S?(this.writer.add(" ;"),this.writer.newLine(1)):S=!0,this.writer.add(yield this.termToString(T,!0)),this.writer.add(" "),yield this.writeTurtleObjects(this.store.getObjectsOnce(b,T,null)))})}writeTurtleObjects(b){return n(this,void 0,void 0,function*(){const _=[],S=[];for(const w of b)w.termType==="BlankNode"&&[...this.store.match(null,null,w),...this.store.match(null,w,null)].length===0?_.push(w):S.push(w);this.writer.add((yield Promise.all(S.map(w=>this.termToString(w,!0,!0)))).join(", "));let T=S.length>0;if(_.length>0)for(const w of _)T?this.writer.add(", "):T=!0,(yield this.writeList(w))||(this.writer.add("["),this.writer.indent(),this.writer.newLine(1),yield this.writeTurtlePredicates(w),this.writer.deindent(),this.writer.newLine(1),this.writer.add("]"))})}writeList(b){return n(this,void 0,void 0,function*(){let _=b;const S=[],T=[];for(;!_.equals(r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"));){const A=this.store.getQuadsOnce(_,r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"),null,null),R=this.store.getQuadsOnce(_,r.DataFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"),null,null);if(T.push(...A,...R),A.length!==1||R.length!==1||this.store.getQuads(_,null,null,null).length!==0)return this.store.addQuads(T),!1;S.push(A[0].object),_=R[0].object}let w=!1;this.writer.add("(");for(const A of S)w?this.writer.add(" "):w=!0,yield this.writeTurtleObjects([A]);return this.writer.add(")"),!0})}writePath(b,_=!1){return n(this,void 0,void 0,function*(){if(b.termType==="NamedNode")this.writer.add(yield this.termToString(b));else if(b.termType==="BlankNode"){const S=this.store.getQuadsOnce(b,null,null,null);if(S.length===1){const{predicate:T,object:w}=S[0];switch(T.value){case"http://www.w3.org/ns/shacl#inversePath":this.writer.add("^"),yield this.writePath(w,!0);return;case"http://www.w3.org/ns/shacl#alternativePath":{const A=this.getList(w);if(A.length===0)throw new Error("Invalid Alternative Path - no options");if(A.length===1)yield this.writePath(A[0]);else{_&&this.writer.add("(");let R=!0;for(const E of A)R?R=!1:this.writer.add("|"),yield this.writePath(E,!0);_&&this.writer.add(")")}return}case"http://www.w3.org/ns/shacl#zeroOrMorePath":yield this.writePath(w,!0),this.writer.add("*");return;case"http://www.w3.org/ns/shacl#oneOrMorePath":yield this.writePath(w,!0),this.writer.add("+");return;case"http://www.w3.org/ns/shacl#zeroOrOnePath":yield this.writePath(w,!0),this.writer.add("?");return;default:throw new Error(`Invalid path type ${b.value}`)}}else{this.store.addQuads(S);const T=this.getList(b);if(T.length===0)throw new Error("Invalid Path");{_&&this.writer.add("(");let w=!0;for(const A of T)w?w=!1:this.writer.add("/"),yield this.writePath(A,!0);_&&this.writer.add(")")}}}else throw new Error("Path should be named node or blank node")})}}return ShaclcGenerator.default=v,ShaclcGenerator}var writer={},hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,Object.defineProperty(writer,"__esModule",{value:!0});class n{constructor(r){this.indents=0,this.write=r.write,this.end=r.end}indent(){return this.indents+=1,this}deindent(){if(this.indents<1)throw new Error(`Trying to deindent when indent is only ${this.indents}`);return this.indents-=1,this}add(r,a=!1){return this.write(a?`
${"	".repeat(this.indents)}${r}`:r,"utf-8"),this}newLine(r=2){return this.write(`
`.repeat(r)+"	".repeat(this.indents),"utf-8"),this}}return writer.default=n,writer}var volatileStore={},hasRequiredVolatileStore;function requireVolatileStore(){if(hasRequiredVolatileStore)return volatileStore;hasRequiredVolatileStore=1,Object.defineProperty(volatileStore,"__esModule",{value:!0});const n=require$$0;class t extends n.Store{getQuadsOnce(a,o,u,s){const c=this.getQuads(a,o,u,s);return this.removeQuads(c),c}getSubjectsOnce(a,o,u){return this.getQuadsOnce(null,a,o,u).map(s=>s.subject)}getObjectsOnce(a,o,u){return this.getQuadsOnce(a,o,null,u).map(s=>s.object)}}return volatileStore.default=t,volatileStore}var hasRequiredDist$1;function requireDist$1(){if(hasRequiredDist$1)return dist$3;hasRequiredDist$1=1;var n=dist$3&&dist$3.__awaiter||function(c,l,d,f){function h(v){return v instanceof d?v:new d(function(g){g(v)})}return new(d||(d=Promise))(function(v,g){function b(T){try{S(f.next(T))}catch(w){g(w)}}function _(T){try{S(f.throw(T))}catch(w){g(w)}}function S(T){T.done?v(T.value):h(T.value).then(b,_)}S((f=f.apply(c,l||[])).next())})},t=dist$3&&dist$3.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(dist$3,"__esModule",{value:!0}),dist$3.write=void 0;const r=require$$0,a=t(requireShaclcGenerator()),o=t(requireWriter()),u=t(requireVolatileStore());function s(c,l){return n(this,void 0,void 0,function*(){return new Promise((d,f)=>n(this,void 0,void 0,function*(){try{let h="";const v=new u.default(c),g=v.getGraphs(null,null,null);if(g.length>1)throw new Error("More than one graph found - can serialize in the default graph");if(g.length===1&&!g[0].equals(r.DataFactory.defaultGraph()))throw new Error(`Expected all triples to be in the default graph, instead triples were in ${g[0].value}`);const b=new o.default({write:S=>{h+=S},end:()=>{let S=v.getQuads(null,null,null,null);S.length===0&&(S=void 0),d({text:h,extraQuads:S})}});yield new a.default(v,b,l==null?void 0:l.prefixes,void 0,(l==null?void 0:l.errorOnUnused)!==!1,l==null?void 0:l.mintPrefixes,l==null?void 0:l.fetch,l==null?void 0:l.extendedSyntax).write()}catch(h){f(h)}}))})}return dist$3.write=s,dist$3}var hasRequiredActorRdfSerializeShaclc;function requireActorRdfSerializeShaclc(){if(hasRequiredActorRdfSerializeShaclc)return ActorRdfSerializeShaclc;hasRequiredActorRdfSerializeShaclc=1,Object.defineProperty(ActorRdfSerializeShaclc,"__esModule",{value:!0}),ActorRdfSerializeShaclc.ActorRdfSerializeShaclc=void 0;const n=requireLib$37(),t=requireArrayifyStream(),r=requireBrowser(),a=requireDist$1();let o=class extends n.ActorRdfSerializeFixedMediaTypes{constructor(s){super(s)}async runHandle(s,c){const l=new r.Readable;l._read=()=>{};try{const d={};s.quadStream.on("prefix",(h,v)=>{d[h]=v});const{text:f}=await(0,a.write)(await(0,t.default)(s.quadStream),{errorOnUnused:!0,extendedSyntax:c==="text/shaclc-ext",prefixes:d});l.push(f),l.push(null)}catch(d){l._read=()=>{l.emit("error",d)}}return{data:l,triples:!0}}};return ActorRdfSerializeShaclc.ActorRdfSerializeShaclc=o,ActorRdfSerializeShaclc}var hasRequiredLib$34;function requireLib$34(){return hasRequiredLib$34||(hasRequiredLib$34=1,function(n){var t=lib$34&&lib$34.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$34&&lib$34.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfSerializeShaclc(),n)}(lib$34)),lib$34}var lib$33={},ActorRdfUpdateQuadsRdfJsStore={},lib$32={},ActorRdfUpdateQuads={},hasRequiredActorRdfUpdateQuads;function requireActorRdfUpdateQuads(){if(hasRequiredActorRdfUpdateQuads)return ActorRdfUpdateQuads;hasRequiredActorRdfUpdateQuads=1,Object.defineProperty(ActorRdfUpdateQuads,"__esModule",{value:!0}),ActorRdfUpdateQuads.ActorRdfUpdateQuads=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorRdfUpdateQuads.ActorRdfUpdateQuads=t,ActorRdfUpdateQuads}var ActorRdfUpdateQuadsDestination={},hasRequiredActorRdfUpdateQuadsDestination;function requireActorRdfUpdateQuadsDestination(){if(hasRequiredActorRdfUpdateQuadsDestination)return ActorRdfUpdateQuadsDestination;hasRequiredActorRdfUpdateQuadsDestination=1,Object.defineProperty(ActorRdfUpdateQuadsDestination,"__esModule",{value:!0}),ActorRdfUpdateQuadsDestination.ActorRdfUpdateQuadsDestination=ActorRdfUpdateQuadsDestination.deskolemize=ActorRdfUpdateQuadsDestination.deskolemizeStream=void 0;const n=requireLib$4e(),t=requireLib$4q(),r=requireLib$4s(),a=requireActorRdfUpdateQuads();function o(c,l,d){return l==null?void 0:l.map(f=>(0,n.deskolemizeQuad)(c,f,d))}ActorRdfUpdateQuadsDestination.deskolemizeStream=o;function u(c){var h;const l=c.context.getSafe(t.KeysInitQuery.dataFactory),d=c.context.get(t.KeysRdfUpdateQuads.destination),f=(h=c.context.get(t.KeysQuerySourceIdentify.sourceIds))==null?void 0:h.get(d);return f?{...c,quadStreamInsert:o(l,c.quadStreamInsert,f),quadStreamDelete:o(l,c.quadStreamDelete,f)}:c}ActorRdfUpdateQuadsDestination.deskolemize=u;let s=class extends a.ActorRdfUpdateQuads{async test(l){return(0,r.passTestVoid)()}async run(l){const d=await this.getDestination(l.context);return await this.getOutput(d,u(l))}async getOutput(l,d){return{execute:async()=>{await l.update({insert:d.quadStreamInsert,delete:d.quadStreamDelete}),await(d.deleteGraphs?l.deleteGraphs(d.deleteGraphs.graphs,d.deleteGraphs.requireExistence,d.deleteGraphs.dropGraphs):Promise.resolve()),await(d.createGraphs?l.createGraphs(d.createGraphs.graphs,d.createGraphs.requireNonExistence):Promise.resolve())}}}};return ActorRdfUpdateQuadsDestination.ActorRdfUpdateQuadsDestination=s,ActorRdfUpdateQuadsDestination}var IQuadDestination={},hasRequiredIQuadDestination;function requireIQuadDestination(){return hasRequiredIQuadDestination||(hasRequiredIQuadDestination=1,Object.defineProperty(IQuadDestination,"__esModule",{value:!0})),IQuadDestination}var utils$1={},hasRequiredUtils$2;function requireUtils$2(){if(hasRequiredUtils$2)return utils$1;hasRequiredUtils$2=1,Object.defineProperty(utils$1,"__esModule",{value:!0}),utils$1.getContextDestinationUrl=utils$1.getContextDestination=utils$1.getDataDestinationContext=utils$1.getDataDestinationValue=utils$1.getDataDestinationType=utils$1.isDataDestinationRawType=void 0;const n=requireLib$4q();function t(c){return typeof c=="string"||"remove"in c}utils$1.isDataDestinationRawType=t;function r(c){return typeof c=="string"?"":"remove"in c?"rdfjsStore":c.type}utils$1.getDataDestinationType=r;function a(c){return t(c)?c:c.value}utils$1.getDataDestinationValue=a;function o(c,l){return typeof c=="string"||"remove"in c||!c.context?l:l.merge(c.context)}utils$1.getDataDestinationContext=o;function u(c){return c.get(n.KeysRdfUpdateQuads.destination)}utils$1.getContextDestination=u;function s(c){if(c){let l=a(c);if(typeof l=="string"){const d=l.indexOf("#");return d>=0&&(l=l.slice(0,d)),l}}}return utils$1.getContextDestinationUrl=s,utils$1}var hasRequiredLib$33;function requireLib$33(){return hasRequiredLib$33||(hasRequiredLib$33=1,function(n){var t=lib$32&&lib$32.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$32&&lib$32.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateQuads(),n),r(requireActorRdfUpdateQuadsDestination(),n),r(requireIQuadDestination(),n),r(requireUtils$2(),n)}(lib$32)),lib$32}var RdfJsQuadDestination={},hasRequiredRdfJsQuadDestination;function requireRdfJsQuadDestination(){if(hasRequiredRdfJsQuadDestination)return RdfJsQuadDestination;hasRequiredRdfJsQuadDestination=1,Object.defineProperty(RdfJsQuadDestination,"__esModule",{value:!0}),RdfJsQuadDestination.RdfJsQuadDestination=void 0;const n=requireDist$4(),t=requireRdfString();let r=class{constructor(o,u){this.dataFactory=o,this.store=u}async update(o){o.delete&&await(0,n.promisifyEventEmitter)(this.store.remove(o.delete)),o.insert&&await(0,n.promisifyEventEmitter)(this.store.import(o.insert))}async deleteGraphs(o,u,s){switch(o){case"ALL":await(0,n.promisifyEventEmitter)(this.store.deleteGraph(this.dataFactory.defaultGraph()));case"NAMED":const c=this.store.match(),l={};c.on("data",d=>{d.graph.termType!=="DefaultGraph"&&(l[(0,t.termToString)(d.graph)]=!0)}),await(0,n.promisifyEventEmitter)(c),await Promise.all(Object.keys(l).map(d=>(0,n.promisifyEventEmitter)(this.store.deleteGraph((0,t.stringToTerm)(d,this.dataFactory)))));break;default:for(const d of Array.isArray(o)?o:[o])await(0,n.promisifyEventEmitter)(this.store.deleteGraph(d))}}async createGraphs(o,u){if(u)for(const s of o){const c=this.store.match(void 0,void 0,void 0,s);await new Promise((l,d)=>{c.once("data",()=>{d(new Error(`Unable to create graph ${s.value} as it already exists`))}),c.on("end",l),c.on("error",d)})}}};return RdfJsQuadDestination.RdfJsQuadDestination=r,RdfJsQuadDestination}var hasRequiredActorRdfUpdateQuadsRdfJsStore;function requireActorRdfUpdateQuadsRdfJsStore(){if(hasRequiredActorRdfUpdateQuadsRdfJsStore)return ActorRdfUpdateQuadsRdfJsStore;hasRequiredActorRdfUpdateQuadsRdfJsStore=1,Object.defineProperty(ActorRdfUpdateQuadsRdfJsStore,"__esModule",{value:!0}),ActorRdfUpdateQuadsRdfJsStore.ActorRdfUpdateQuadsRdfJsStore=void 0;const n=requireLib$33(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfJsQuadDestination();let o=class extends n.ActorRdfUpdateQuadsDestination{constructor(s){super(s)}async test(s){var l;const c=(0,n.getContextDestination)(s.context);return!c||typeof c=="string"||!("remove"in c)&&"value"in c&&!((l=c.value)!=null&&l.remove)?(0,r.failTest)(`${this.name} received an invalid rdfjsStore.`):(0,r.passTestVoid)()}async getDestination(s){const c=(0,n.getContextDestination)(s);return new a.RdfJsQuadDestination(s.getSafe(t.KeysInitQuery.dataFactory),"remove"in c?c:c.value)}};return ActorRdfUpdateQuadsRdfJsStore.ActorRdfUpdateQuadsRdfJsStore=o,ActorRdfUpdateQuadsRdfJsStore}var hasRequiredLib$32;function requireLib$32(){return hasRequiredLib$32||(hasRequiredLib$32=1,function(n){var t=lib$33&&lib$33.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$33&&lib$33.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateQuadsRdfJsStore(),n)}(lib$33)),lib$33}var lib$31={},ActorFunctionFactoryExpressionBound={},ExpressionFunctionBound={},hasRequiredExpressionFunctionBound;function requireExpressionFunctionBound(){if(hasRequiredExpressionFunctionBound)return ExpressionFunctionBound;hasRequiredExpressionFunctionBound=1,Object.defineProperty(ExpressionFunctionBound,"__esModule",{value:!0}),ExpressionFunctionBound.ExpressionFunctionBound=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4p(),a=requireLib$4n();let o=class extends n.ExpressionFunctionBase{constructor(){super({arity:1,operator:a.SparqlOperator.BOUND,apply:async({args:s,mapping:c,exprEval:l})=>{const d=s[0];if(d.expressionType!==r.ExpressionType.Variable)throw new a.InvalidArgumentTypes(s,a.SparqlOperator.BOUND);const f=c.has((0,a.expressionToVar)(l.context.getSafe(t.KeysInitQuery.dataFactory),d));return(0,a.bool)(f)}})}};return ExpressionFunctionBound.ExpressionFunctionBound=o,ExpressionFunctionBound}var hasRequiredActorFunctionFactoryExpressionBound;function requireActorFunctionFactoryExpressionBound(){if(hasRequiredActorFunctionFactoryExpressionBound)return ActorFunctionFactoryExpressionBound;hasRequiredActorFunctionFactoryExpressionBound=1,Object.defineProperty(ActorFunctionFactoryExpressionBound,"__esModule",{value:!0}),ActorFunctionFactoryExpressionBound.ActorFunctionFactoryExpressionBound=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionBound();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.BOUND],termFunction:!1})}async run(u){return new r.ExpressionFunctionBound}};return ActorFunctionFactoryExpressionBound.ActorFunctionFactoryExpressionBound=a,ActorFunctionFactoryExpressionBound}var hasRequiredLib$31;function requireLib$31(){return hasRequiredLib$31||(hasRequiredLib$31=1,function(n){var t=lib$31&&lib$31.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$31&&lib$31.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionBound(),n)}(lib$31)),lib$31}var lib$30={},ActorFunctionFactoryExpressionBnode={},ExpressionFunctionBnode={},hasRequiredExpressionFunctionBnode;function requireExpressionFunctionBnode(){if(hasRequiredExpressionFunctionBnode)return ExpressionFunctionBnode;hasRequiredExpressionFunctionBnode=1,Object.defineProperty(ExpressionFunctionBnode,"__esModule",{value:!0}),ExpressionFunctionBnode.ExpressionFunctionBnode=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4f(),a=requireLib$4n();let o=class hi extends n.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:a.SparqlOperator.BNODE,apply:async s=>{const{args:c,mapping:l,exprEval:d}=s,f=c.length===1?await d.evaluatorExpressionEvaluation(c[0],l):void 0;let h;if(f){const g=hi.bnodeTree.search([f],d.context.getSafe(t.KeysExpressionEvaluator.superTypeProvider),d.context.getSafe(t.KeysInitQuery.functionArgumentsCache));if(!g)throw new a.InvalidArgumentTypes(c,a.SparqlOperator.BNODE);h=g(d)([f]).str()}const v=new r.BlankNodeBindingsScoped(h??`BNODE_${hi.bnodeCounter++}`);return new a.BlankNode(v)}})}checkArity(s){return s.length===0||s.length===1}};return ExpressionFunctionBnode.ExpressionFunctionBnode=o,o.bnodeTree=(0,a.declare)(a.SparqlOperator.BNODE).onString1(()=>u=>u).collect(),o.bnodeCounter=0,ExpressionFunctionBnode}var hasRequiredActorFunctionFactoryExpressionBnode;function requireActorFunctionFactoryExpressionBnode(){if(hasRequiredActorFunctionFactoryExpressionBnode)return ActorFunctionFactoryExpressionBnode;hasRequiredActorFunctionFactoryExpressionBnode=1,Object.defineProperty(ActorFunctionFactoryExpressionBnode,"__esModule",{value:!0}),ActorFunctionFactoryExpressionBnode.ActorFunctionFactoryExpressionBnode=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionBnode();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.BNODE],termFunction:!1})}async run(u){return new r.ExpressionFunctionBnode}};return ActorFunctionFactoryExpressionBnode.ActorFunctionFactoryExpressionBnode=a,ActorFunctionFactoryExpressionBnode}var hasRequiredLib$30;function requireLib$30(){return hasRequiredLib$30||(hasRequiredLib$30=1,function(n){var t=lib$30&&lib$30.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$30&&lib$30.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionBnode(),n)}(lib$30)),lib$30}var lib$2$={},ActorFunctionFactoryExpressionCoalesce={},ExpressionFunctionCoalesce={},hasRequiredExpressionFunctionCoalesce;function requireExpressionFunctionCoalesce(){if(hasRequiredExpressionFunctionCoalesce)return ExpressionFunctionCoalesce;hasRequiredExpressionFunctionCoalesce=1,Object.defineProperty(ExpressionFunctionCoalesce,"__esModule",{value:!0}),ExpressionFunctionCoalesce.ExpressionFunctionCoalesce=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:t.SparqlOperator.COALESCE,apply:async({args:o,mapping:u,exprEval:s})=>{const c=[];for(const l of o)try{return await s.evaluatorExpressionEvaluation(l,u)}catch(d){c.push(d)}throw new t.CoalesceError(c)}})}};return ExpressionFunctionCoalesce.ExpressionFunctionCoalesce=r,ExpressionFunctionCoalesce}var hasRequiredActorFunctionFactoryExpressionCoalesce;function requireActorFunctionFactoryExpressionCoalesce(){if(hasRequiredActorFunctionFactoryExpressionCoalesce)return ActorFunctionFactoryExpressionCoalesce;hasRequiredActorFunctionFactoryExpressionCoalesce=1,Object.defineProperty(ActorFunctionFactoryExpressionCoalesce,"__esModule",{value:!0}),ActorFunctionFactoryExpressionCoalesce.ActorFunctionFactoryExpressionCoalesce=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionCoalesce();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.COALESCE],termFunction:!1})}async run(u){return new r.ExpressionFunctionCoalesce}};return ActorFunctionFactoryExpressionCoalesce.ActorFunctionFactoryExpressionCoalesce=a,ActorFunctionFactoryExpressionCoalesce}var hasRequiredLib$2$;function requireLib$2$(){return hasRequiredLib$2$||(hasRequiredLib$2$=1,function(n){var t=lib$2$&&lib$2$.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2$&&lib$2$.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionCoalesce(),n)}(lib$2$)),lib$2$}var lib$2_={},ActorFunctionFactoryExpressionConcat={},ExpressionFunctionConcat={},hasRequiredExpressionFunctionConcat;function requireExpressionFunctionConcat(){if(hasRequiredExpressionFunctionConcat)return ExpressionFunctionConcat;hasRequiredExpressionFunctionConcat=1,Object.defineProperty(ExpressionFunctionConcat,"__esModule",{value:!0}),ExpressionFunctionConcat.ExpressionFunctionConcat=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class pi extends n.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:r.SparqlOperator.CONCAT,apply:async u=>{const{args:s,mapping:c,exprEval:l}=u,d=s.map(async b=>l.evaluatorExpressionEvaluation(b,c)).map(async b=>{const _=pi.concatTree.search([await b],l.context.getSafe(t.KeysExpressionEvaluator.superTypeProvider),l.context.getSafe(t.KeysInitQuery.functionArgumentsCache));if(!_)throw new r.InvalidArgumentTypes(s,r.SparqlOperator.CONCAT);return _(l)([await b])}),f=await Promise.all(d),v=f.map(b=>b.typedValue).join(""),g=pi.langAllEqual(f)?f[0].language:void 0;return g?(0,r.langString)(v,g):(0,r.string)(v)}})}static langAllEqual(u){return u.length>0&&u.every(s=>s.language===u[0].language)}};return ExpressionFunctionConcat.ExpressionFunctionConcat=a,a.concatTree=(0,r.declare)(r.SparqlOperator.CONCAT).onStringly1(()=>o=>o).collect(),ExpressionFunctionConcat}var hasRequiredActorFunctionFactoryExpressionConcat;function requireActorFunctionFactoryExpressionConcat(){if(hasRequiredActorFunctionFactoryExpressionConcat)return ActorFunctionFactoryExpressionConcat;hasRequiredActorFunctionFactoryExpressionConcat=1,Object.defineProperty(ActorFunctionFactoryExpressionConcat,"__esModule",{value:!0}),ActorFunctionFactoryExpressionConcat.ActorFunctionFactoryExpressionConcat=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionConcat();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.CONCAT],termFunction:!1})}async run(u){return new r.ExpressionFunctionConcat}};return ActorFunctionFactoryExpressionConcat.ActorFunctionFactoryExpressionConcat=a,ActorFunctionFactoryExpressionConcat}var hasRequiredLib$2_;function requireLib$2_(){return hasRequiredLib$2_||(hasRequiredLib$2_=1,function(n){var t=lib$2_&&lib$2_.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2_&&lib$2_.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionConcat(),n)}(lib$2_)),lib$2_}var lib$2Z={},ActorFunctionFactoryExpressionExtensions={},NamedExtension={},hasRequiredNamedExtension;function requireNamedExtension(){if(hasRequiredNamedExtension)return NamedExtension;hasRequiredNamedExtension=1,Object.defineProperty(NamedExtension,"__esModule",{value:!0}),NamedExtension.NamedExtension=void 0;const n=requireCore(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.ExpressionFunctionBase{constructor({operator:u,functionDefinition:s}){super({arity:Number.POSITIVE_INFINITY,operator:u,apply:async({args:c,exprEval:l,mapping:d})=>{const f=await Promise.all(c.map(h=>l.evaluatorExpressionEvaluation(h,d)));try{return new r.TermTransformer(l.context.getSafe(t.KeysExpressionEvaluator.superTypeProvider)).transformRDFTermUnsafe(await s(f.map(h=>h.toRDF(l.context.getSafe(t.KeysInitQuery.dataFactory)))))}catch(h){throw new r.ExtensionFunctionError(this.operator,h)}}})}};return NamedExtension.NamedExtension=a,NamedExtension}var hasRequiredActorFunctionFactoryExpressionExtensions;function requireActorFunctionFactoryExpressionExtensions(){if(hasRequiredActorFunctionFactoryExpressionExtensions)return ActorFunctionFactoryExpressionExtensions;hasRequiredActorFunctionFactoryExpressionExtensions=1,Object.defineProperty(ActorFunctionFactoryExpressionExtensions,"__esModule",{value:!0}),ActorFunctionFactoryExpressionExtensions.ActorFunctionFactoryExpressionExtensions=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4s(),a=requireRdfDataFactory(),o=requireNamedExtension();let u=class extends n.ActorFunctionFactory{constructor(c){super(c)}async test({context:c,functionName:l}){return await c.getSafe(t.KeysExpressionEvaluator.extensionFunctionCreator)(new a.DataFactory().namedNode(l))?(0,r.passTestVoid)():(0,r.failTest)(`Actor ${this.name} can only provide non-termExpression implementations for functions that are provided through config entries like: ${t.KeysInitQuery.extensionFunctionCreator.name} or ${t.KeysInitQuery.extensionFunctions.name}`)}async run({context:c,functionName:l}){const f=await c.getSafe(t.KeysExpressionEvaluator.extensionFunctionCreator)(new a.DataFactory().namedNode(l));return new o.NamedExtension({operator:l,functionDefinition:f})}};return ActorFunctionFactoryExpressionExtensions.ActorFunctionFactoryExpressionExtensions=u,ActorFunctionFactoryExpressionExtensions}var hasRequiredLib$2Z;function requireLib$2Z(){return hasRequiredLib$2Z||(hasRequiredLib$2Z=1,function(n){var t=lib$2Z&&lib$2Z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2Z&&lib$2Z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionExtensions(),n)}(lib$2Z)),lib$2Z}var lib$2Y={},ActorFunctionFactoryExpressionIf={},ExpressionFunctionIf={},hasRequiredExpressionFunctionIf;function requireExpressionFunctionIf(){if(hasRequiredExpressionFunctionIf)return ExpressionFunctionIf;hasRequiredExpressionFunctionIf=1,Object.defineProperty(ExpressionFunctionIf,"__esModule",{value:!0}),ExpressionFunctionIf.ExpressionFunctionIf=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(){super({arity:3,operator:t.SparqlOperator.IF,apply:async({args:o,mapping:u,exprEval:s})=>(await s.evaluatorExpressionEvaluation(o[0],u)).coerceEBV()?s.evaluatorExpressionEvaluation(o[1],u):s.evaluatorExpressionEvaluation(o[2],u)})}};return ExpressionFunctionIf.ExpressionFunctionIf=r,ExpressionFunctionIf}var hasRequiredActorFunctionFactoryExpressionIf;function requireActorFunctionFactoryExpressionIf(){if(hasRequiredActorFunctionFactoryExpressionIf)return ActorFunctionFactoryExpressionIf;hasRequiredActorFunctionFactoryExpressionIf=1,Object.defineProperty(ActorFunctionFactoryExpressionIf,"__esModule",{value:!0}),ActorFunctionFactoryExpressionIf.ActorFunctionFactoryExpressionIf=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionIf();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IF],termFunction:!1})}async run(u){return new r.ExpressionFunctionIf}};return ActorFunctionFactoryExpressionIf.ActorFunctionFactoryExpressionIf=a,ActorFunctionFactoryExpressionIf}var hasRequiredLib$2Y;function requireLib$2Y(){return hasRequiredLib$2Y||(hasRequiredLib$2Y=1,function(n){var t=lib$2Y&&lib$2Y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2Y&&lib$2Y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionIf(),n)}(lib$2Y)),lib$2Y}var lib$2X={},ActorFunctionFactoryExpressionLogicalAnd={},ExpressionFunctionLogicalAnd={},hasRequiredExpressionFunctionLogicalAnd;function requireExpressionFunctionLogicalAnd(){if(hasRequiredExpressionFunctionLogicalAnd)return ExpressionFunctionLogicalAnd;hasRequiredExpressionFunctionLogicalAnd=1,Object.defineProperty(ExpressionFunctionLogicalAnd,"__esModule",{value:!0}),ExpressionFunctionLogicalAnd.ExpressionFunctionLogicalAnd=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.LOGICAL_AND,apply:async({args:o,mapping:u,exprEval:s})=>{const[c,l]=o;try{if(!(await s.evaluatorExpressionEvaluation(c,u)).coerceEBV())return(0,t.bool)(!1);const v=(await s.evaluatorExpressionEvaluation(l,u)).coerceEBV();return(0,t.bool)(v)}catch(d){if((await s.evaluatorExpressionEvaluation(l,u)).coerceEBV())throw d;return(0,t.bool)(!1)}}})}};return ExpressionFunctionLogicalAnd.ExpressionFunctionLogicalAnd=r,ExpressionFunctionLogicalAnd}var hasRequiredActorFunctionFactoryExpressionLogicalAnd;function requireActorFunctionFactoryExpressionLogicalAnd(){if(hasRequiredActorFunctionFactoryExpressionLogicalAnd)return ActorFunctionFactoryExpressionLogicalAnd;hasRequiredActorFunctionFactoryExpressionLogicalAnd=1,Object.defineProperty(ActorFunctionFactoryExpressionLogicalAnd,"__esModule",{value:!0}),ActorFunctionFactoryExpressionLogicalAnd.ActorFunctionFactoryExpressionLogicalAnd=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionLogicalAnd();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LOGICAL_AND],termFunction:!1})}async run(u){return new r.ExpressionFunctionLogicalAnd}};return ActorFunctionFactoryExpressionLogicalAnd.ActorFunctionFactoryExpressionLogicalAnd=a,ActorFunctionFactoryExpressionLogicalAnd}var hasRequiredLib$2X;function requireLib$2X(){return hasRequiredLib$2X||(hasRequiredLib$2X=1,function(n){var t=lib$2X&&lib$2X.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2X&&lib$2X.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionLogicalAnd(),n)}(lib$2X)),lib$2X}var lib$2W={},ActorFunctionFactoryExpressionLogicalOr={},ExpressionFunctionLogicalOr={},hasRequiredExpressionFunctionLogicalOr;function requireExpressionFunctionLogicalOr(){if(hasRequiredExpressionFunctionLogicalOr)return ExpressionFunctionLogicalOr;hasRequiredExpressionFunctionLogicalOr=1,Object.defineProperty(ExpressionFunctionLogicalOr,"__esModule",{value:!0}),ExpressionFunctionLogicalOr.ExpressionFunctionLogicalOr=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.LOGICAL_OR,apply:async({args:o,mapping:u,exprEval:s})=>{const[c,l]=o;try{if((await s.evaluatorExpressionEvaluation(c,u)).coerceEBV())return(0,t.bool)(!0);const v=(await s.evaluatorExpressionEvaluation(l,u)).coerceEBV();return(0,t.bool)(v)}catch(d){if(!(await s.evaluatorExpressionEvaluation(l,u)).coerceEBV())throw d;return(0,t.bool)(!0)}}})}};return ExpressionFunctionLogicalOr.ExpressionFunctionLogicalOr=r,ExpressionFunctionLogicalOr}var hasRequiredActorFunctionFactoryExpressionLogicalOr;function requireActorFunctionFactoryExpressionLogicalOr(){if(hasRequiredActorFunctionFactoryExpressionLogicalOr)return ActorFunctionFactoryExpressionLogicalOr;hasRequiredActorFunctionFactoryExpressionLogicalOr=1,Object.defineProperty(ActorFunctionFactoryExpressionLogicalOr,"__esModule",{value:!0}),ActorFunctionFactoryExpressionLogicalOr.ActorFunctionFactoryExpressionLogicalOr=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionLogicalOr();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LOGICAL_OR],termFunction:!1})}async run(u){return new r.ExpressionFunctionLogicalOr}};return ActorFunctionFactoryExpressionLogicalOr.ActorFunctionFactoryExpressionLogicalOr=a,ActorFunctionFactoryExpressionLogicalOr}var hasRequiredLib$2W;function requireLib$2W(){return hasRequiredLib$2W||(hasRequiredLib$2W=1,function(n){var t=lib$2W&&lib$2W.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2W&&lib$2W.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionLogicalOr(),n)}(lib$2W)),lib$2W}var lib$2V={},ActorFunctionFactoryExpressionSameTerm={},ExpressionFunctionSameTerm={},hasRequiredExpressionFunctionSameTerm;function requireExpressionFunctionSameTerm(){if(hasRequiredExpressionFunctionSameTerm)return ExpressionFunctionSameTerm;hasRequiredExpressionFunctionSameTerm=1,Object.defineProperty(ExpressionFunctionSameTerm,"__esModule",{value:!0}),ExpressionFunctionSameTerm.ExpressionFunctionSameTerm=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.ExpressionFunctionBase{constructor(){super({arity:2,operator:r.SparqlOperator.SAME_TERM,apply:async({args:u,mapping:s,exprEval:c})=>{const l=c.context.getSafe(t.KeysInitQuery.dataFactory),[d,f]=u.map(g=>c.evaluatorExpressionEvaluation(g,s)),[h,v]=await Promise.all([d,f]);return(0,r.bool)(h.toRDF(l).equals(v.toRDF(l)))}})}};return ExpressionFunctionSameTerm.ExpressionFunctionSameTerm=a,ExpressionFunctionSameTerm}var hasRequiredActorFunctionFactoryExpressionSameTerm;function requireActorFunctionFactoryExpressionSameTerm(){if(hasRequiredActorFunctionFactoryExpressionSameTerm)return ActorFunctionFactoryExpressionSameTerm;hasRequiredActorFunctionFactoryExpressionSameTerm=1,Object.defineProperty(ActorFunctionFactoryExpressionSameTerm,"__esModule",{value:!0}),ActorFunctionFactoryExpressionSameTerm.ActorFunctionFactoryExpressionSameTerm=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionSameTerm();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SAME_TERM],termFunction:!1})}async run(u){return new r.ExpressionFunctionSameTerm}};return ActorFunctionFactoryExpressionSameTerm.ActorFunctionFactoryExpressionSameTerm=a,ActorFunctionFactoryExpressionSameTerm}var hasRequiredLib$2V;function requireLib$2V(){return hasRequiredLib$2V||(hasRequiredLib$2V=1,function(n){var t=lib$2V&&lib$2V.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2V&&lib$2V.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionSameTerm(),n)}(lib$2V)),lib$2V}var lib$2U={},ActorFunctionFactoryTermAbs={},TermFunctionAbs={},hasRequiredTermFunctionAbs;function requireTermFunctionAbs(){if(hasRequiredTermFunctionAbs)return TermFunctionAbs;hasRequiredTermFunctionAbs=1,Object.defineProperty(TermFunctionAbs,"__esModule",{value:!0}),TermFunctionAbs.TermFunctionAbs=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.ABS,overloads:(0,t.declare)(t.SparqlOperator.ABS).numericConverter(()=>o=>Math.abs(o)).collect()})}};return TermFunctionAbs.TermFunctionAbs=r,TermFunctionAbs}var hasRequiredActorFunctionFactoryTermAbs;function requireActorFunctionFactoryTermAbs(){if(hasRequiredActorFunctionFactoryTermAbs)return ActorFunctionFactoryTermAbs;hasRequiredActorFunctionFactoryTermAbs=1,Object.defineProperty(ActorFunctionFactoryTermAbs,"__esModule",{value:!0}),ActorFunctionFactoryTermAbs.ActorFunctionFactoryTermAbs=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionAbs();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.ABS],termFunction:!0})}async run(u){return new r.TermFunctionAbs}};return ActorFunctionFactoryTermAbs.ActorFunctionFactoryTermAbs=a,ActorFunctionFactoryTermAbs}var hasRequiredLib$2U;function requireLib$2U(){return hasRequiredLib$2U||(hasRequiredLib$2U=1,function(n){var t=lib$2U&&lib$2U.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2U&&lib$2U.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermAbs(),n)}(lib$2U)),lib$2U}var lib$2T={},ActorFunctionFactoryTermAddition={},TermFunctionAddition={},bignumber$1={exports:{}},bignumber=bignumber$1.exports,hasRequiredBignumber;function requireBignumber(){return hasRequiredBignumber||(hasRequiredBignumber=1,function(n){(function(t){var r,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,o=Math.ceil,u=Math.floor,s="[BigNumber Error] ",c=s+"Number primitive has more than 15 significant digits: ",l=1e14,d=14,f=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,g=1e9;function b(I){var L,F,D,$=re.prototype={constructor:re,toString:null,valueOf:null},O=new re(1),P=20,C=4,q=-7,M=21,N=-1e7,G=1e7,X=!1,Y=1,W=0,te={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},ue="0123456789abcdefghijklmnopqrstuvwxyz",fe=!0;function re(J,j){var z,B,U,Z,oe,ie,se,ne,he=this;if(!(he instanceof re))return new re(J,j);if(j==null){if(J&&J._isBigNumber===!0){he.s=J.s,!J.c||J.e>G?he.c=he.e=null:J.e<N?he.c=[he.e=0]:(he.e=J.e,he.c=J.c.slice());return}if((ie=typeof J=="number")&&J*0==0){if(he.s=1/J<0?(J=-J,-1):1,J===~~J){for(Z=0,oe=J;oe>=10;oe/=10,Z++);Z>G?he.c=he.e=null:(he.e=Z,he.c=[J]);return}ne=String(J)}else{if(!a.test(ne=String(J)))return D(he,ne,ie);he.s=ne.charCodeAt(0)==45?(ne=ne.slice(1),-1):1}(Z=ne.indexOf("."))>-1&&(ne=ne.replace(".","")),(oe=ne.search(/e/i))>0?(Z<0&&(Z=oe),Z+=+ne.slice(oe+1),ne=ne.substring(0,oe)):Z<0&&(Z=ne.length)}else{if(w(j,2,ue.length,"Base"),j==10&&fe)return he=new re(J),ve(he,P+he.e+1,C);if(ne=String(J),ie=typeof J=="number"){if(J*0!=0)return D(he,ne,ie,j);if(he.s=1/J<0?(ne=ne.slice(1),-1):1,re.DEBUG&&ne.replace(/^0\.0*|\./,"").length>15)throw Error(c+J)}else he.s=ne.charCodeAt(0)===45?(ne=ne.slice(1),-1):1;for(z=ue.slice(0,j),Z=oe=0,se=ne.length;oe<se;oe++)if(z.indexOf(B=ne.charAt(oe))<0){if(B=="."){if(oe>Z){Z=se;continue}}else if(!U&&(ne==ne.toUpperCase()&&(ne=ne.toLowerCase())||ne==ne.toLowerCase()&&(ne=ne.toUpperCase()))){U=!0,oe=-1,Z=0;continue}return D(he,String(J),ie,j)}ie=!1,ne=F(ne,j,10,he.s),(Z=ne.indexOf("."))>-1?ne=ne.replace(".",""):Z=ne.length}for(oe=0;ne.charCodeAt(oe)===48;oe++);for(se=ne.length;ne.charCodeAt(--se)===48;);if(ne=ne.slice(oe,++se)){if(se-=oe,ie&&re.DEBUG&&se>15&&(J>f||J!==u(J)))throw Error(c+he.s*J);if((Z=Z-oe-1)>G)he.c=he.e=null;else if(Z<N)he.c=[he.e=0];else{if(he.e=Z,he.c=[],oe=(Z+1)%d,Z<0&&(oe+=d),oe<se){for(oe&&he.c.push(+ne.slice(0,oe)),se-=d;oe<se;)he.c.push(+ne.slice(oe,oe+=d));oe=d-(ne=ne.slice(oe)).length}else oe-=se;for(;oe--;ne+="0");he.c.push(+ne)}}else he.c=[he.e=0]}re.clone=b,re.ROUND_UP=0,re.ROUND_DOWN=1,re.ROUND_CEIL=2,re.ROUND_FLOOR=3,re.ROUND_HALF_UP=4,re.ROUND_HALF_DOWN=5,re.ROUND_HALF_EVEN=6,re.ROUND_HALF_CEIL=7,re.ROUND_HALF_FLOOR=8,re.EUCLID=9,re.config=re.set=function(J){var j,z;if(J!=null)if(typeof J=="object"){if(J.hasOwnProperty(j="DECIMAL_PLACES")&&(z=J[j],w(z,0,g,j),P=z),J.hasOwnProperty(j="ROUNDING_MODE")&&(z=J[j],w(z,0,8,j),C=z),J.hasOwnProperty(j="EXPONENTIAL_AT")&&(z=J[j],z&&z.pop?(w(z[0],-1e9,0,j),w(z[1],0,g,j),q=z[0],M=z[1]):(w(z,-1e9,g,j),q=-(M=z<0?-z:z))),J.hasOwnProperty(j="RANGE"))if(z=J[j],z&&z.pop)w(z[0],-1e9,-1,j),w(z[1],1,g,j),N=z[0],G=z[1];else if(w(z,-1e9,g,j),z)N=-(G=z<0?-z:z);else throw Error(s+j+" cannot be zero: "+z);if(J.hasOwnProperty(j="CRYPTO"))if(z=J[j],z===!!z)if(z)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))X=z;else throw X=!z,Error(s+"crypto unavailable");else X=z;else throw Error(s+j+" not true or false: "+z);if(J.hasOwnProperty(j="MODULO_MODE")&&(z=J[j],w(z,0,9,j),Y=z),J.hasOwnProperty(j="POW_PRECISION")&&(z=J[j],w(z,0,g,j),W=z),J.hasOwnProperty(j="FORMAT"))if(z=J[j],typeof z=="object")te=z;else throw Error(s+j+" not an object: "+z);if(J.hasOwnProperty(j="ALPHABET"))if(z=J[j],typeof z=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(z))fe=z.slice(0,10)=="0123456789",ue=z;else throw Error(s+j+" invalid: "+z)}else throw Error(s+"Object expected: "+J);return{DECIMAL_PLACES:P,ROUNDING_MODE:C,EXPONENTIAL_AT:[q,M],RANGE:[N,G],CRYPTO:X,MODULO_MODE:Y,POW_PRECISION:W,FORMAT:te,ALPHABET:ue}},re.isBigNumber=function(J){if(!J||J._isBigNumber!==!0)return!1;if(!re.DEBUG)return!0;var j,z,B=J.c,U=J.e,Z=J.s;e:if({}.toString.call(B)=="[object Array]"){if((Z===1||Z===-1)&&U>=-1e9&&U<=g&&U===u(U)){if(B[0]===0){if(U===0&&B.length===1)return!0;break e}if(j=(U+1)%d,j<1&&(j+=d),String(B[0]).length==j){for(j=0;j<B.length;j++)if(z=B[j],z<0||z>=l||z!==u(z))break e;if(z!==0)return!0}}}else if(B===null&&U===null&&(Z===null||Z===1||Z===-1))return!0;throw Error(s+"Invalid BigNumber: "+J)},re.maximum=re.max=function(){return Te(arguments,-1)},re.minimum=re.min=function(){return Te(arguments,1)},re.random=function(){var J=9007199254740992,j=Math.random()*J&2097151?function(){return u(Math.random()*J)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(z){var B,U,Z,oe,ie,se=0,ne=[],he=new re(O);if(z==null?z=P:w(z,0,g),oe=o(z/d),X)if(crypto.getRandomValues){for(B=crypto.getRandomValues(new Uint32Array(oe*=2));se<oe;)ie=B[se]*131072+(B[se+1]>>>11),ie>=9e15?(U=crypto.getRandomValues(new Uint32Array(2)),B[se]=U[0],B[se+1]=U[1]):(ne.push(ie%1e14),se+=2);se=oe/2}else if(crypto.randomBytes){for(B=crypto.randomBytes(oe*=7);se<oe;)ie=(B[se]&31)*281474976710656+B[se+1]*1099511627776+B[se+2]*4294967296+B[se+3]*16777216+(B[se+4]<<16)+(B[se+5]<<8)+B[se+6],ie>=9e15?crypto.randomBytes(7).copy(B,se):(ne.push(ie%1e14),se+=7);se=oe/7}else throw X=!1,Error(s+"crypto unavailable");if(!X)for(;se<oe;)ie=j(),ie<9e15&&(ne[se++]=ie%1e14);for(oe=ne[--se],z%=d,oe&&z&&(ie=h[d-z],ne[se]=u(oe/ie)*ie);ne[se]===0;ne.pop(),se--);if(se<0)ne=[Z=0];else{for(Z=-1;ne[0]===0;ne.splice(0,1),Z-=d);for(se=1,ie=ne[0];ie>=10;ie/=10,se++);se<d&&(Z-=d-se)}return he.e=Z,he.c=ne,he}}(),re.sum=function(){for(var J=1,j=arguments,z=new re(j[0]);J<j.length;)z=z.plus(j[J++]);return z},F=function(){var J="0123456789";function j(z,B,U,Z){for(var oe,ie=[0],se,ne=0,he=z.length;ne<he;){for(se=ie.length;se--;ie[se]*=B);for(ie[0]+=Z.indexOf(z.charAt(ne++)),oe=0;oe<ie.length;oe++)ie[oe]>U-1&&(ie[oe+1]==null&&(ie[oe+1]=0),ie[oe+1]+=ie[oe]/U|0,ie[oe]%=U)}return ie.reverse()}return function(z,B,U,Z,oe){var ie,se,ne,he,xe,me,Ie,Pe,Ce=z.indexOf("."),pe=P,H=C;for(Ce>=0&&(he=W,W=0,z=z.replace(".",""),Pe=new re(B),me=Pe.pow(z.length-Ce),W=he,Pe.c=j(E(S(me.c),me.e,"0"),10,U,J),Pe.e=Pe.c.length),Ie=j(z,B,U,oe?(ie=ue,J):(ie=J,ue)),ne=he=Ie.length;Ie[--he]==0;Ie.pop());if(!Ie[0])return ie.charAt(0);if(Ce<0?--ne:(me.c=Ie,me.e=ne,me.s=Z,me=L(me,Pe,pe,H,U),Ie=me.c,xe=me.r,ne=me.e),se=ne+pe+1,Ce=Ie[se],he=U/2,xe=xe||se<0||Ie[se+1]!=null,xe=H<4?(Ce!=null||xe)&&(H==0||H==(me.s<0?3:2)):Ce>he||Ce==he&&(H==4||xe||H==6&&Ie[se-1]&1||H==(me.s<0?8:7)),se<1||!Ie[0])z=xe?E(ie.charAt(1),-pe,ie.charAt(0)):ie.charAt(0);else{if(Ie.length=se,xe)for(--U;++Ie[--se]>U;)Ie[se]=0,se||(++ne,Ie=[1].concat(Ie));for(he=Ie.length;!Ie[--he];);for(Ce=0,z="";Ce<=he;z+=ie.charAt(Ie[Ce++]));z=E(z,ne,ie.charAt(0))}return z}}(),L=function(){function J(B,U,Z){var oe,ie,se,ne,he=0,xe=B.length,me=U%v,Ie=U/v|0;for(B=B.slice();xe--;)se=B[xe]%v,ne=B[xe]/v|0,oe=Ie*se+ne*me,ie=me*se+oe%v*v+he,he=(ie/Z|0)+(oe/v|0)+Ie*ne,B[xe]=ie%Z;return he&&(B=[he].concat(B)),B}function j(B,U,Z,oe){var ie,se;if(Z!=oe)se=Z>oe?1:-1;else for(ie=se=0;ie<Z;ie++)if(B[ie]!=U[ie]){se=B[ie]>U[ie]?1:-1;break}return se}function z(B,U,Z,oe){for(var ie=0;Z--;)B[Z]-=ie,ie=B[Z]<U[Z]?1:0,B[Z]=ie*oe+B[Z]-U[Z];for(;!B[0]&&B.length>1;B.splice(0,1));}return function(B,U,Z,oe,ie){var se,ne,he,xe,me,Ie,Pe,Ce,pe,H,V,Q,ee,ae,be,le,we,De=B.s==U.s?1:-1,Fe=B.c,Ne=U.c;if(!Fe||!Fe[0]||!Ne||!Ne[0])return new re(!B.s||!U.s||(Fe?Ne&&Fe[0]==Ne[0]:!Ne)?NaN:Fe&&Fe[0]==0||!Ne?De*0:De/0);for(Ce=new re(De),pe=Ce.c=[],ne=B.e-U.e,De=Z+ne+1,ie||(ie=l,ne=_(B.e/d)-_(U.e/d),De=De/d|0),he=0;Ne[he]==(Fe[he]||0);he++);if(Ne[he]>(Fe[he]||0)&&ne--,De<0)pe.push(1),xe=!0;else{for(ae=Fe.length,le=Ne.length,he=0,De+=2,me=u(ie/(Ne[0]+1)),me>1&&(Ne=J(Ne,me,ie),Fe=J(Fe,me,ie),le=Ne.length,ae=Fe.length),ee=le,H=Fe.slice(0,le),V=H.length;V<le;H[V++]=0);we=Ne.slice(),we=[0].concat(we),be=Ne[0],Ne[1]>=ie/2&&be++;do{if(me=0,se=j(Ne,H,le,V),se<0){if(Q=H[0],le!=V&&(Q=Q*ie+(H[1]||0)),me=u(Q/be),me>1)for(me>=ie&&(me=ie-1),Ie=J(Ne,me,ie),Pe=Ie.length,V=H.length;j(Ie,H,Pe,V)==1;)me--,z(Ie,le<Pe?we:Ne,Pe,ie),Pe=Ie.length,se=1;else me==0&&(se=me=1),Ie=Ne.slice(),Pe=Ie.length;if(Pe<V&&(Ie=[0].concat(Ie)),z(H,Ie,V,ie),V=H.length,se==-1)for(;j(Ne,H,le,V)<1;)me++,z(H,le<V?we:Ne,V,ie),V=H.length}else se===0&&(me++,H=[0]);pe[he++]=me,H[0]?H[V++]=Fe[ee]||0:(H=[Fe[ee]],V=1)}while((ee++<ae||H[0]!=null)&&De--);xe=H[0]!=null,pe[0]||pe.splice(0,1)}if(ie==l){for(he=1,De=pe[0];De>=10;De/=10,he++);ve(Ce,Z+(Ce.e=he+ne*d-1)+1,oe,xe)}else Ce.e=ne,Ce.r=+xe;return Ce}}();function ye(J,j,z,B){var U,Z,oe,ie,se;if(z==null?z=C:w(z,0,8),!J.c)return J.toString();if(U=J.c[0],oe=J.e,j==null)se=S(J.c),se=B==1||B==2&&(oe<=q||oe>=M)?R(se,oe):E(se,oe,"0");else if(J=ve(new re(J),j,z),Z=J.e,se=S(J.c),ie=se.length,B==1||B==2&&(j<=Z||Z<=q)){for(;ie<j;se+="0",ie++);se=R(se,Z)}else if(j-=oe,se=E(se,Z,"0"),Z+1>ie){if(--j>0)for(se+=".";j--;se+="0");}else if(j+=Z-ie,j>0)for(Z+1==ie&&(se+=".");j--;se+="0");return J.s<0&&U?"-"+se:se}function Te(J,j){for(var z,B,U=1,Z=new re(J[0]);U<J.length;U++)B=new re(J[U]),(!B.s||(z=T(Z,B))===j||z===0&&Z.s===j)&&(Z=B);return Z}function Re(J,j,z){for(var B=1,U=j.length;!j[--U];j.pop());for(U=j[0];U>=10;U/=10,B++);return(z=B+z*d-1)>G?J.c=J.e=null:z<N?J.c=[J.e=0]:(J.e=z,J.c=j),J}D=function(){var J=/^(-?)0([xbo])(?=\w[\w.]*$)/i,j=/^([^.]+)\.$/,z=/^\.([^.]+)$/,B=/^-?(Infinity|NaN)$/,U=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Z,oe,ie,se){var ne,he=ie?oe:oe.replace(U,"");if(B.test(he))Z.s=isNaN(he)?null:he<0?-1:1;else{if(!ie&&(he=he.replace(J,function(xe,me,Ie){return ne=(Ie=Ie.toLowerCase())=="x"?16:Ie=="b"?2:8,!se||se==ne?me:xe}),se&&(ne=se,he=he.replace(j,"$1").replace(z,"0.$1")),oe!=he))return new re(he,ne);if(re.DEBUG)throw Error(s+"Not a"+(se?" base "+se:"")+" number: "+oe);Z.s=null}Z.c=Z.e=null}}();function ve(J,j,z,B){var U,Z,oe,ie,se,ne,he,xe=J.c,me=h;if(xe){e:{for(U=1,ie=xe[0];ie>=10;ie/=10,U++);if(Z=j-U,Z<0)Z+=d,oe=j,se=xe[ne=0],he=u(se/me[U-oe-1]%10);else if(ne=o((Z+1)/d),ne>=xe.length)if(B){for(;xe.length<=ne;xe.push(0));se=he=0,U=1,Z%=d,oe=Z-d+1}else break e;else{for(se=ie=xe[ne],U=1;ie>=10;ie/=10,U++);Z%=d,oe=Z-d+U,he=oe<0?0:u(se/me[U-oe-1]%10)}if(B=B||j<0||xe[ne+1]!=null||(oe<0?se:se%me[U-oe-1]),B=z<4?(he||B)&&(z==0||z==(J.s<0?3:2)):he>5||he==5&&(z==4||B||z==6&&(Z>0?oe>0?se/me[U-oe]:0:xe[ne-1])%10&1||z==(J.s<0?8:7)),j<1||!xe[0])return xe.length=0,B?(j-=J.e+1,xe[0]=me[(d-j%d)%d],J.e=-j||0):xe[0]=J.e=0,J;if(Z==0?(xe.length=ne,ie=1,ne--):(xe.length=ne+1,ie=me[d-Z],xe[ne]=oe>0?u(se/me[U-oe]%me[oe])*ie:0),B)for(;;)if(ne==0){for(Z=1,oe=xe[0];oe>=10;oe/=10,Z++);for(oe=xe[0]+=ie,ie=1;oe>=10;oe/=10,ie++);Z!=ie&&(J.e++,xe[0]==l&&(xe[0]=1));break}else{if(xe[ne]+=ie,xe[ne]!=l)break;xe[ne--]=0,ie=1}for(Z=xe.length;xe[--Z]===0;xe.pop());}J.e>G?J.c=J.e=null:J.e<N&&(J.c=[J.e=0])}return J}function ce(J){var j,z=J.e;return z===null?J.toString():(j=S(J.c),j=z<=q||z>=M?R(j,z):E(j,z,"0"),J.s<0?"-"+j:j)}return $.absoluteValue=$.abs=function(){var J=new re(this);return J.s<0&&(J.s=1),J},$.comparedTo=function(J,j){return T(this,new re(J,j))},$.decimalPlaces=$.dp=function(J,j){var z,B,U,Z=this;if(J!=null)return w(J,0,g),j==null?j=C:w(j,0,8),ve(new re(Z),J+Z.e+1,j);if(!(z=Z.c))return null;if(B=((U=z.length-1)-_(this.e/d))*d,U=z[U])for(;U%10==0;U/=10,B--);return B<0&&(B=0),B},$.dividedBy=$.div=function(J,j){return L(this,new re(J,j),P,C)},$.dividedToIntegerBy=$.idiv=function(J,j){return L(this,new re(J,j),0,1)},$.exponentiatedBy=$.pow=function(J,j){var z,B,U,Z,oe,ie,se,ne,he,xe=this;if(J=new re(J),J.c&&!J.isInteger())throw Error(s+"Exponent not an integer: "+ce(J));if(j!=null&&(j=new re(j)),ie=J.e>14,!xe.c||!xe.c[0]||xe.c[0]==1&&!xe.e&&xe.c.length==1||!J.c||!J.c[0])return he=new re(Math.pow(+ce(xe),ie?J.s*(2-A(J)):+ce(J))),j?he.mod(j):he;if(se=J.s<0,j){if(j.c?!j.c[0]:!j.s)return new re(NaN);B=!se&&xe.isInteger()&&j.isInteger(),B&&(xe=xe.mod(j))}else{if(J.e>9&&(xe.e>0||xe.e<-1||(xe.e==0?xe.c[0]>1||ie&&xe.c[1]>=24e7:xe.c[0]<8e13||ie&&xe.c[0]<=9999975e7)))return Z=xe.s<0&&A(J)?-0:0,xe.e>-1&&(Z=1/Z),new re(se?1/Z:Z);W&&(Z=o(W/d+2))}for(ie?(z=new re(.5),se&&(J.s=1),ne=A(J)):(U=Math.abs(+ce(J)),ne=U%2),he=new re(O);;){if(ne){if(he=he.times(xe),!he.c)break;Z?he.c.length>Z&&(he.c.length=Z):B&&(he=he.mod(j))}if(U){if(U=u(U/2),U===0)break;ne=U%2}else if(J=J.times(z),ve(J,J.e+1,1),J.e>14)ne=A(J);else{if(U=+ce(J),U===0)break;ne=U%2}xe=xe.times(xe),Z?xe.c&&xe.c.length>Z&&(xe.c.length=Z):B&&(xe=xe.mod(j))}return B?he:(se&&(he=O.div(he)),j?he.mod(j):Z?ve(he,W,C,oe):he)},$.integerValue=function(J){var j=new re(this);return J==null?J=C:w(J,0,8),ve(j,j.e+1,J)},$.isEqualTo=$.eq=function(J,j){return T(this,new re(J,j))===0},$.isFinite=function(){return!!this.c},$.isGreaterThan=$.gt=function(J,j){return T(this,new re(J,j))>0},$.isGreaterThanOrEqualTo=$.gte=function(J,j){return(j=T(this,new re(J,j)))===1||j===0},$.isInteger=function(){return!!this.c&&_(this.e/d)>this.c.length-2},$.isLessThan=$.lt=function(J,j){return T(this,new re(J,j))<0},$.isLessThanOrEqualTo=$.lte=function(J,j){return(j=T(this,new re(J,j)))===-1||j===0},$.isNaN=function(){return!this.s},$.isNegative=function(){return this.s<0},$.isPositive=function(){return this.s>0},$.isZero=function(){return!!this.c&&this.c[0]==0},$.minus=function(J,j){var z,B,U,Z,oe=this,ie=oe.s;if(J=new re(J,j),j=J.s,!ie||!j)return new re(NaN);if(ie!=j)return J.s=-j,oe.plus(J);var se=oe.e/d,ne=J.e/d,he=oe.c,xe=J.c;if(!se||!ne){if(!he||!xe)return he?(J.s=-j,J):new re(xe?oe:NaN);if(!he[0]||!xe[0])return xe[0]?(J.s=-j,J):new re(he[0]?oe:C==3?-0:0)}if(se=_(se),ne=_(ne),he=he.slice(),ie=se-ne){for((Z=ie<0)?(ie=-ie,U=he):(ne=se,U=xe),U.reverse(),j=ie;j--;U.push(0));U.reverse()}else for(B=(Z=(ie=he.length)<(j=xe.length))?ie:j,ie=j=0;j<B;j++)if(he[j]!=xe[j]){Z=he[j]<xe[j];break}if(Z&&(U=he,he=xe,xe=U,J.s=-J.s),j=(B=xe.length)-(z=he.length),j>0)for(;j--;he[z++]=0);for(j=l-1;B>ie;){if(he[--B]<xe[B]){for(z=B;z&&!he[--z];he[z]=j);--he[z],he[B]+=l}he[B]-=xe[B]}for(;he[0]==0;he.splice(0,1),--ne);return he[0]?Re(J,he,ne):(J.s=C==3?-1:1,J.c=[J.e=0],J)},$.modulo=$.mod=function(J,j){var z,B,U=this;return J=new re(J,j),!U.c||!J.s||J.c&&!J.c[0]?new re(NaN):!J.c||U.c&&!U.c[0]?new re(U):(Y==9?(B=J.s,J.s=1,z=L(U,J,0,3),J.s=B,z.s*=B):z=L(U,J,0,Y),J=U.minus(z.times(J)),!J.c[0]&&Y==1&&(J.s=U.s),J)},$.multipliedBy=$.times=function(J,j){var z,B,U,Z,oe,ie,se,ne,he,xe,me,Ie,Pe,Ce,pe,H=this,V=H.c,Q=(J=new re(J,j)).c;if(!V||!Q||!V[0]||!Q[0])return!H.s||!J.s||V&&!V[0]&&!Q||Q&&!Q[0]&&!V?J.c=J.e=J.s=null:(J.s*=H.s,!V||!Q?J.c=J.e=null:(J.c=[0],J.e=0)),J;for(B=_(H.e/d)+_(J.e/d),J.s*=H.s,se=V.length,xe=Q.length,se<xe&&(Pe=V,V=Q,Q=Pe,U=se,se=xe,xe=U),U=se+xe,Pe=[];U--;Pe.push(0));for(Ce=l,pe=v,U=xe;--U>=0;){for(z=0,me=Q[U]%pe,Ie=Q[U]/pe|0,oe=se,Z=U+oe;Z>U;)ne=V[--oe]%pe,he=V[oe]/pe|0,ie=Ie*ne+he*me,ne=me*ne+ie%pe*pe+Pe[Z]+z,z=(ne/Ce|0)+(ie/pe|0)+Ie*he,Pe[Z--]=ne%Ce;Pe[Z]=z}return z?++B:Pe.splice(0,1),Re(J,Pe,B)},$.negated=function(){var J=new re(this);return J.s=-J.s||null,J},$.plus=function(J,j){var z,B=this,U=B.s;if(J=new re(J,j),j=J.s,!U||!j)return new re(NaN);if(U!=j)return J.s=-j,B.minus(J);var Z=B.e/d,oe=J.e/d,ie=B.c,se=J.c;if(!Z||!oe){if(!ie||!se)return new re(U/0);if(!ie[0]||!se[0])return se[0]?J:new re(ie[0]?B:U*0)}if(Z=_(Z),oe=_(oe),ie=ie.slice(),U=Z-oe){for(U>0?(oe=Z,z=se):(U=-U,z=ie),z.reverse();U--;z.push(0));z.reverse()}for(U=ie.length,j=se.length,U-j<0&&(z=se,se=ie,ie=z,j=U),U=0;j;)U=(ie[--j]=ie[j]+se[j]+U)/l|0,ie[j]=l===ie[j]?0:ie[j]%l;return U&&(ie=[U].concat(ie),++oe),Re(J,ie,oe)},$.precision=$.sd=function(J,j){var z,B,U,Z=this;if(J!=null&&J!==!!J)return w(J,1,g),j==null?j=C:w(j,0,8),ve(new re(Z),J,j);if(!(z=Z.c))return null;if(U=z.length-1,B=U*d+1,U=z[U]){for(;U%10==0;U/=10,B--);for(U=z[0];U>=10;U/=10,B++);}return J&&Z.e+1>B&&(B=Z.e+1),B},$.shiftedBy=function(J){return w(J,-9007199254740991,f),this.times("1e"+J)},$.squareRoot=$.sqrt=function(){var J,j,z,B,U,Z=this,oe=Z.c,ie=Z.s,se=Z.e,ne=P+4,he=new re("0.5");if(ie!==1||!oe||!oe[0])return new re(!ie||ie<0&&(!oe||oe[0])?NaN:oe?Z:1/0);if(ie=Math.sqrt(+ce(Z)),ie==0||ie==1/0?(j=S(oe),(j.length+se)%2==0&&(j+="0"),ie=Math.sqrt(+j),se=_((se+1)/2)-(se<0||se%2),ie==1/0?j="5e"+se:(j=ie.toExponential(),j=j.slice(0,j.indexOf("e")+1)+se),z=new re(j)):z=new re(ie+""),z.c[0]){for(se=z.e,ie=se+ne,ie<3&&(ie=0);;)if(U=z,z=he.times(U.plus(L(Z,U,ne,1))),S(U.c).slice(0,ie)===(j=S(z.c)).slice(0,ie))if(z.e<se&&--ie,j=j.slice(ie-3,ie+1),j=="9999"||!B&&j=="4999"){if(!B&&(ve(U,U.e+P+2,0),U.times(U).eq(Z))){z=U;break}ne+=4,ie+=4,B=1}else{(!+j||!+j.slice(1)&&j.charAt(0)=="5")&&(ve(z,z.e+P+2,1),J=!z.times(z).eq(Z));break}}return ve(z,z.e+P+1,C,J)},$.toExponential=function(J,j){return J!=null&&(w(J,0,g),J++),ye(this,J,j,1)},$.toFixed=function(J,j){return J!=null&&(w(J,0,g),J=J+this.e+1),ye(this,J,j)},$.toFormat=function(J,j,z){var B,U=this;if(z==null)J!=null&&j&&typeof j=="object"?(z=j,j=null):J&&typeof J=="object"?(z=J,J=j=null):z=te;else if(typeof z!="object")throw Error(s+"Argument not an object: "+z);if(B=U.toFixed(J,j),U.c){var Z,oe=B.split("."),ie=+z.groupSize,se=+z.secondaryGroupSize,ne=z.groupSeparator||"",he=oe[0],xe=oe[1],me=U.s<0,Ie=me?he.slice(1):he,Pe=Ie.length;if(se&&(Z=ie,ie=se,se=Z,Pe-=Z),ie>0&&Pe>0){for(Z=Pe%ie||ie,he=Ie.substr(0,Z);Z<Pe;Z+=ie)he+=ne+Ie.substr(Z,ie);se>0&&(he+=ne+Ie.slice(Z)),me&&(he="-"+he)}B=xe?he+(z.decimalSeparator||"")+((se=+z.fractionGroupSize)?xe.replace(new RegExp("\\d{"+se+"}\\B","g"),"$&"+(z.fractionGroupSeparator||"")):xe):he}return(z.prefix||"")+B+(z.suffix||"")},$.toFraction=function(J){var j,z,B,U,Z,oe,ie,se,ne,he,xe,me,Ie=this,Pe=Ie.c;if(J!=null&&(ie=new re(J),!ie.isInteger()&&(ie.c||ie.s!==1)||ie.lt(O)))throw Error(s+"Argument "+(ie.isInteger()?"out of range: ":"not an integer: ")+ce(ie));if(!Pe)return new re(Ie);for(j=new re(O),ne=z=new re(O),B=se=new re(O),me=S(Pe),Z=j.e=me.length-Ie.e-1,j.c[0]=h[(oe=Z%d)<0?d+oe:oe],J=!J||ie.comparedTo(j)>0?Z>0?j:ne:ie,oe=G,G=1/0,ie=new re(me),se.c[0]=0;he=L(ie,j,0,1),U=z.plus(he.times(B)),U.comparedTo(J)!=1;)z=B,B=U,ne=se.plus(he.times(U=ne)),se=U,j=ie.minus(he.times(U=j)),ie=U;return U=L(J.minus(z),B,0,1),se=se.plus(U.times(ne)),z=z.plus(U.times(B)),se.s=ne.s=Ie.s,Z=Z*2,xe=L(ne,B,Z,C).minus(Ie).abs().comparedTo(L(se,z,Z,C).minus(Ie).abs())<1?[ne,B]:[se,z],G=oe,xe},$.toNumber=function(){return+ce(this)},$.toPrecision=function(J,j){return J!=null&&w(J,1,g),ye(this,J,j,2)},$.toString=function(J){var j,z=this,B=z.s,U=z.e;return U===null?B?(j="Infinity",B<0&&(j="-"+j)):j="NaN":(J==null?j=U<=q||U>=M?R(S(z.c),U):E(S(z.c),U,"0"):J===10&&fe?(z=ve(new re(z),P+U+1,C),j=E(S(z.c),z.e,"0")):(w(J,2,ue.length,"Base"),j=F(E(S(z.c),U,"0"),10,J,B,!0)),B<0&&z.c[0]&&(j="-"+j)),j},$.valueOf=$.toJSON=function(){return ce(this)},$._isBigNumber=!0,I!=null&&re.set(I),re}function _(I){var L=I|0;return I>0||I===L?L:L-1}function S(I){for(var L,F,D=1,$=I.length,O=I[0]+"";D<$;){for(L=I[D++]+"",F=d-L.length;F--;L="0"+L);O+=L}for($=O.length;O.charCodeAt(--$)===48;);return O.slice(0,$+1||1)}function T(I,L){var F,D,$=I.c,O=L.c,P=I.s,C=L.s,q=I.e,M=L.e;if(!P||!C)return null;if(F=$&&!$[0],D=O&&!O[0],F||D)return F?D?0:-C:P;if(P!=C)return P;if(F=P<0,D=q==M,!$||!O)return D?0:!$^F?1:-1;if(!D)return q>M^F?1:-1;for(C=(q=$.length)<(M=O.length)?q:M,P=0;P<C;P++)if($[P]!=O[P])return $[P]>O[P]^F?1:-1;return q==M?0:q>M^F?1:-1}function w(I,L,F,D){if(I<L||I>F||I!==u(I))throw Error(s+(D||"Argument")+(typeof I=="number"?I<L||I>F?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function A(I){var L=I.c.length-1;return _(I.e/d)==L&&I.c[L]%2!=0}function R(I,L){return(I.length>1?I.charAt(0)+"."+I.slice(1):I)+(L<0?"e":"e+")+L}function E(I,L,F){var D,$;if(L<0){for($=F+".";++L;$+=F);I=$+I}else if(D=I.length,++L>D){for($=F,L-=D;--L;$+=F);I+=$}else L<D&&(I=I.slice(0,L)+"."+I.slice(L));return I}r=b(),r.default=r.BigNumber=r,n.exports?n.exports=r:(t||(t=typeof self<"u"&&self?self:window),t.BigNumber=r)})(bignumber)}(bignumber$1)),bignumber$1.exports}var hasRequiredTermFunctionAddition;function requireTermFunctionAddition(){if(hasRequiredTermFunctionAddition)return TermFunctionAddition;hasRequiredTermFunctionAddition=1,Object.defineProperty(TermFunctionAddition,"__esModule",{value:!0}),TermFunctionAddition.TermFunctionAddition=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireBignumber();let a=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.ADDITION,overloads:(0,t.declare)(t.SparqlOperator.ADDITION).arithmetic(()=>(u,s)=>new r.BigNumber(u).plus(s).toNumber()).set([t.TypeURL.XSD_DATE_TIME,t.TypeURL.XSD_DAY_TIME_DURATION],()=>([u,s])=>new t.DateTimeLiteral((0,t.addDurationToDateTime)(u.typedValue,(0,t.defaultedDurationRepresentation)(s.typedValue)))).copy({from:[t.TypeURL.XSD_DATE_TIME,t.TypeURL.XSD_DAY_TIME_DURATION],to:[t.TypeURL.XSD_DATE_TIME,t.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([t.TypeURL.XSD_DATE,t.TypeURL.XSD_DAY_TIME_DURATION],()=>([u,s])=>new t.DateLiteral((0,t.addDurationToDateTime)((0,t.defaultedDateTimeRepresentation)(u.typedValue),(0,t.defaultedDurationRepresentation)(s.typedValue)))).copy({from:[t.TypeURL.XSD_DATE,t.TypeURL.XSD_DAY_TIME_DURATION],to:[t.TypeURL.XSD_DATE,t.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([t.TypeURL.XSD_TIME,t.TypeURL.XSD_DAY_TIME_DURATION],()=>([u,s])=>new t.TimeLiteral((0,t.addDurationToDateTime)((0,t.defaultedDateTimeRepresentation)(u.typedValue),(0,t.defaultedDurationRepresentation)(s.typedValue)))).copy({from:[t.TypeURL.XSD_TIME,t.TypeURL.XSD_DAY_TIME_DURATION],to:[t.TypeURL.XSD_TIME,t.TypeURL.XSD_YEAR_MONTH_DURATION]}).collect()})}};return TermFunctionAddition.TermFunctionAddition=a,TermFunctionAddition}var hasRequiredActorFunctionFactoryTermAddition;function requireActorFunctionFactoryTermAddition(){if(hasRequiredActorFunctionFactoryTermAddition)return ActorFunctionFactoryTermAddition;hasRequiredActorFunctionFactoryTermAddition=1,Object.defineProperty(ActorFunctionFactoryTermAddition,"__esModule",{value:!0}),ActorFunctionFactoryTermAddition.ActorFunctionFactoryTermAddition=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionAddition();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.ADDITION],termFunction:!0})}async run(u){return new r.TermFunctionAddition}};return ActorFunctionFactoryTermAddition.ActorFunctionFactoryTermAddition=a,ActorFunctionFactoryTermAddition}var hasRequiredLib$2T;function requireLib$2T(){return hasRequiredLib$2T||(hasRequiredLib$2T=1,function(n){var t=lib$2T&&lib$2T.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2T&&lib$2T.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermAddition(),n)}(lib$2T)),lib$2T}var lib$2S={},ActorFunctionFactoryTermCeil={},TermFunctionCeil={},hasRequiredTermFunctionCeil;function requireTermFunctionCeil(){if(hasRequiredTermFunctionCeil)return TermFunctionCeil;hasRequiredTermFunctionCeil=1,Object.defineProperty(TermFunctionCeil,"__esModule",{value:!0}),TermFunctionCeil.TermFunctionCeil=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.CEIL,overloads:(0,t.declare)(t.SparqlOperator.CEIL).numericConverter(()=>o=>Math.ceil(o)).collect()})}};return TermFunctionCeil.TermFunctionCeil=r,TermFunctionCeil}var hasRequiredActorFunctionFactoryTermCeil;function requireActorFunctionFactoryTermCeil(){if(hasRequiredActorFunctionFactoryTermCeil)return ActorFunctionFactoryTermCeil;hasRequiredActorFunctionFactoryTermCeil=1,Object.defineProperty(ActorFunctionFactoryTermCeil,"__esModule",{value:!0}),ActorFunctionFactoryTermCeil.ActorFunctionFactoryTermCeil=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionCeil();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.CEIL],termFunction:!0})}async run(u){return new r.TermFunctionCeil}};return ActorFunctionFactoryTermCeil.ActorFunctionFactoryTermCeil=a,ActorFunctionFactoryTermCeil}var hasRequiredLib$2S;function requireLib$2S(){return hasRequiredLib$2S||(hasRequiredLib$2S=1,function(n){var t=lib$2S&&lib$2S.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2S&&lib$2S.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermCeil(),n)}(lib$2S)),lib$2S}var lib$2R={},ActorFunctionFactoryTermContains={},TermFunctionContains={},hasRequiredTermFunctionContains;function requireTermFunctionContains(){if(hasRequiredTermFunctionContains)return TermFunctionContains;hasRequiredTermFunctionContains=1,Object.defineProperty(TermFunctionContains,"__esModule",{value:!0}),TermFunctionContains.TermFunctionContains=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.CONTAINS,overloads:(0,t.declare)(t.SparqlOperator.CONTAINS).onBinaryTyped([t.TypeAlias.SPARQL_STRINGLY,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.bool)(o.includes(u))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.RDF_LANG_STRING],()=>(o,u)=>{if(o.language!==u.language)throw new t.IncompatibleLanguageOperation(o,u);return(0,t.bool)(o.typedValue.includes(u.typedValue))}).collect()})}};return TermFunctionContains.TermFunctionContains=r,TermFunctionContains}var hasRequiredActorFunctionFactoryTermContains;function requireActorFunctionFactoryTermContains(){if(hasRequiredActorFunctionFactoryTermContains)return ActorFunctionFactoryTermContains;hasRequiredActorFunctionFactoryTermContains=1,Object.defineProperty(ActorFunctionFactoryTermContains,"__esModule",{value:!0}),ActorFunctionFactoryTermContains.ActorFunctionFactoryTermContains=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionContains();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.CONTAINS],termFunction:!0})}async run(u){return new r.TermFunctionContains}};return ActorFunctionFactoryTermContains.ActorFunctionFactoryTermContains=a,ActorFunctionFactoryTermContains}var hasRequiredLib$2R;function requireLib$2R(){return hasRequiredLib$2R||(hasRequiredLib$2R=1,function(n){var t=lib$2R&&lib$2R.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2R&&lib$2R.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermContains(),n)}(lib$2R)),lib$2R}var lib$2Q={},ActorFunctionFactoryTermDatatype={},TermFunctionDatatype={},hasRequiredTermFunctionDatatype;function requireTermFunctionDatatype(){if(hasRequiredTermFunctionDatatype)return TermFunctionDatatype;hasRequiredTermFunctionDatatype=1,Object.defineProperty(TermFunctionDatatype,"__esModule",{value:!0}),TermFunctionDatatype.TermFunctionDatatype=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.DATATYPE,overloads:(0,t.declare)(t.SparqlOperator.DATATYPE).onLiteral1(()=>o=>new t.NamedNode(o.dataType)).collect()})}};return TermFunctionDatatype.TermFunctionDatatype=r,TermFunctionDatatype}var hasRequiredActorFunctionFactoryTermDatatype;function requireActorFunctionFactoryTermDatatype(){if(hasRequiredActorFunctionFactoryTermDatatype)return ActorFunctionFactoryTermDatatype;hasRequiredActorFunctionFactoryTermDatatype=1,Object.defineProperty(ActorFunctionFactoryTermDatatype,"__esModule",{value:!0}),ActorFunctionFactoryTermDatatype.ActorFunctionFactoryTermDatatype=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionDatatype();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.DATATYPE],termFunction:!0})}async run(u){return new r.TermFunctionDatatype}};return ActorFunctionFactoryTermDatatype.ActorFunctionFactoryTermDatatype=a,ActorFunctionFactoryTermDatatype}var hasRequiredLib$2Q;function requireLib$2Q(){return hasRequiredLib$2Q||(hasRequiredLib$2Q=1,function(n){var t=lib$2Q&&lib$2Q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2Q&&lib$2Q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermDatatype(),n)}(lib$2Q)),lib$2Q}var lib$2P={},ActorFunctionFactoryTermDay={},TermFunctionDay={},hasRequiredTermFunctionDay;function requireTermFunctionDay(){if(hasRequiredTermFunctionDay)return TermFunctionDay;hasRequiredTermFunctionDay=1,Object.defineProperty(TermFunctionDay,"__esModule",{value:!0}),TermFunctionDay.TermFunctionDay=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.DAY,overloads:(0,t.declare)(t.SparqlOperator.DAY).onDateTime1(()=>o=>(0,t.integer)(o.typedValue.day)).set([t.TypeURL.XSD_DATE],()=>([o])=>(0,t.integer)(o.typedValue.day)).collect()})}};return TermFunctionDay.TermFunctionDay=r,TermFunctionDay}var hasRequiredActorFunctionFactoryTermDay;function requireActorFunctionFactoryTermDay(){if(hasRequiredActorFunctionFactoryTermDay)return ActorFunctionFactoryTermDay;hasRequiredActorFunctionFactoryTermDay=1,Object.defineProperty(ActorFunctionFactoryTermDay,"__esModule",{value:!0}),ActorFunctionFactoryTermDay.ActorFunctionFactoryTermDay=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionDay();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.DAY],termFunction:!0})}async run(u){return new r.TermFunctionDay}};return ActorFunctionFactoryTermDay.ActorFunctionFactoryTermDay=a,ActorFunctionFactoryTermDay}var hasRequiredLib$2P;function requireLib$2P(){return hasRequiredLib$2P||(hasRequiredLib$2P=1,function(n){var t=lib$2P&&lib$2P.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2P&&lib$2P.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermDay(),n)}(lib$2P)),lib$2P}var lib$2O={},ActorFunctionFactoryTermDivision={},TermFunctionDivision={},hasRequiredTermFunctionDivision;function requireTermFunctionDivision(){if(hasRequiredTermFunctionDivision)return TermFunctionDivision;hasRequiredTermFunctionDivision=1,Object.defineProperty(TermFunctionDivision,"__esModule",{value:!0}),TermFunctionDivision.TermFunctionDivision=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireBignumber();let a=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.DIVISION,overloads:(0,t.declare)(t.SparqlOperator.DIVISION).arithmetic(()=>(u,s)=>new r.BigNumber(u).div(s).toNumber()).onBinaryTyped([t.TypeURL.XSD_INTEGER,t.TypeURL.XSD_INTEGER],()=>(u,s)=>{if(s===0)throw new t.ExpressionError("Integer division by 0");return(0,t.decimal)(new r.BigNumber(u).div(s).toNumber())}).collect()})}};return TermFunctionDivision.TermFunctionDivision=a,TermFunctionDivision}var hasRequiredActorFunctionFactoryTermDivision;function requireActorFunctionFactoryTermDivision(){if(hasRequiredActorFunctionFactoryTermDivision)return ActorFunctionFactoryTermDivision;hasRequiredActorFunctionFactoryTermDivision=1,Object.defineProperty(ActorFunctionFactoryTermDivision,"__esModule",{value:!0}),ActorFunctionFactoryTermDivision.ActorFunctionFactoryTermDivision=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionDivision();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.DIVISION],termFunction:!0})}async run(u){return new r.TermFunctionDivision}};return ActorFunctionFactoryTermDivision.ActorFunctionFactoryTermDivision=a,ActorFunctionFactoryTermDivision}var hasRequiredLib$2O;function requireLib$2O(){return hasRequiredLib$2O||(hasRequiredLib$2O=1,function(n){var t=lib$2O&&lib$2O.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2O&&lib$2O.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermDivision(),n)}(lib$2O)),lib$2O}var lib$2N={},ActorFunctionFactoryTermEncodeForUri={},TermFunctionEncodeForUri={},hasRequiredTermFunctionEncodeForUri;function requireTermFunctionEncodeForUri(){if(hasRequiredTermFunctionEncodeForUri)return TermFunctionEncodeForUri;hasRequiredTermFunctionEncodeForUri=1,Object.defineProperty(TermFunctionEncodeForUri,"__esModule",{value:!0}),TermFunctionEncodeForUri.TermFunctionEncodeForUri=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.ENCODE_FOR_URI,overloads:(0,t.declare)(t.SparqlOperator.ENCODE_FOR_URI).onStringly1Typed(()=>o=>(0,t.string)(encodeURI(o))).collect()})}};return TermFunctionEncodeForUri.TermFunctionEncodeForUri=r,TermFunctionEncodeForUri}var hasRequiredActorFunctionFactoryTermEncodeForUri;function requireActorFunctionFactoryTermEncodeForUri(){if(hasRequiredActorFunctionFactoryTermEncodeForUri)return ActorFunctionFactoryTermEncodeForUri;hasRequiredActorFunctionFactoryTermEncodeForUri=1,Object.defineProperty(ActorFunctionFactoryTermEncodeForUri,"__esModule",{value:!0}),ActorFunctionFactoryTermEncodeForUri.ActorFunctionFactoryTermEncodeForUri=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionEncodeForUri();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.ENCODE_FOR_URI],termFunction:!0})}async run(u){return new r.TermFunctionEncodeForUri}};return ActorFunctionFactoryTermEncodeForUri.ActorFunctionFactoryTermEncodeForUri=a,ActorFunctionFactoryTermEncodeForUri}var hasRequiredLib$2N;function requireLib$2N(){return hasRequiredLib$2N||(hasRequiredLib$2N=1,function(n){var t=lib$2N&&lib$2N.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2N&&lib$2N.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermEncodeForUri(),n)}(lib$2N)),lib$2N}var lib$2M={},ActorFunctionFactoryTermEquality={},TermFunctionEquality={},hasRequiredTermFunctionEquality;function requireTermFunctionEquality(){if(hasRequiredTermFunctionEquality)return TermFunctionEquality;hasRequiredTermFunctionEquality=1,Object.defineProperty(TermFunctionEquality,"__esModule",{value:!0}),TermFunctionEquality.TermFunctionEquality=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:r.SparqlOperator.EQUAL,overloads:(0,r.declare)(r.SparqlOperator.EQUAL).numberTest(()=>(u,s)=>u===s).stringTest(()=>(u,s)=>u.localeCompare(s)===0).set([r.TypeURL.RDF_LANG_STRING,r.TypeURL.RDF_LANG_STRING],()=>([u,s])=>(0,r.bool)(u.str()===s.str()&&u.language===s.language)).set([r.TypeAlias.SPARQL_STRINGLY,r.TypeAlias.SPARQL_STRINGLY],()=>()=>(0,r.bool)(!1)).booleanTest(()=>(u,s)=>u===s).dateTimeTest(u=>(s,c)=>(0,r.toUTCDate)(s,u.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()===(0,r.toUTCDate)(c,u.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()).copy({from:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DATE_TIME],to:[r.TypeURL.XSD_DATE,r.TypeURL.XSD_DATE]}).set(["quad","quad"],u=>([s,c])=>(0,r.bool)(this.applyOnTerms([s.subject,c.subject],u).coerceEBV()&&this.applyOnTerms([s.predicate,c.predicate],u).coerceEBV()&&this.applyOnTerms([s.object,c.object],u).coerceEBV()&&this.applyOnTerms([s.graph,c.graph],u).coerceEBV()),!1).set(["term","term"],u=>([s,c])=>{const l=s.toRDF(u.context.getSafe(t.KeysInitQuery.dataFactory)),d=c.toRDF(u.context.getSafe(t.KeysInitQuery.dataFactory)),f=l.equals(d);if(!f&&l.termType==="Literal"&&d.termType==="Literal")throw new r.RDFEqualTypeError([s,c]);return(0,r.bool)(f)},!1).set([r.TypeURL.XSD_DURATION,r.TypeURL.XSD_DURATION],()=>([u,s])=>(0,r.bool)((0,r.yearMonthDurationsToMonths)((0,r.defaultedYearMonthDurationRepresentation)(u.typedValue))===(0,r.yearMonthDurationsToMonths)((0,r.defaultedYearMonthDurationRepresentation)(s.typedValue))&&(0,r.dayTimeDurationsToSeconds)((0,r.defaultedDayTimeDurationRepresentation)(u.typedValue))===(0,r.dayTimeDurationsToSeconds)((0,r.defaultedDayTimeDurationRepresentation)(s.typedValue)))).set([r.TypeURL.XSD_TIME,r.TypeURL.XSD_TIME],u=>([s,c])=>(0,r.bool)((0,r.toUTCDate)((0,r.defaultedDateTimeRepresentation)(s.typedValue),u.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()===(0,r.toUTCDate)((0,r.defaultedDateTimeRepresentation)(c.typedValue),u.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime())).collect()})}};return TermFunctionEquality.TermFunctionEquality=a,TermFunctionEquality}var hasRequiredActorFunctionFactoryTermEquality;function requireActorFunctionFactoryTermEquality(){if(hasRequiredActorFunctionFactoryTermEquality)return ActorFunctionFactoryTermEquality;hasRequiredActorFunctionFactoryTermEquality=1,Object.defineProperty(ActorFunctionFactoryTermEquality,"__esModule",{value:!0}),ActorFunctionFactoryTermEquality.ActorFunctionFactoryTermEquality=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionEquality();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.EQUAL],termFunction:!0})}async run(u){return new r.TermFunctionEquality}};return ActorFunctionFactoryTermEquality.ActorFunctionFactoryTermEquality=a,ActorFunctionFactoryTermEquality}var hasRequiredLib$2M;function requireLib$2M(){return hasRequiredLib$2M||(hasRequiredLib$2M=1,function(n){var t=lib$2M&&lib$2M.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2M&&lib$2M.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermEquality(),n)}(lib$2M)),lib$2M}var lib$2L={},ActorFunctionFactoryTermFloor={},TermFunctionFloor={},hasRequiredTermFunctionFloor;function requireTermFunctionFloor(){if(hasRequiredTermFunctionFloor)return TermFunctionFloor;hasRequiredTermFunctionFloor=1,Object.defineProperty(TermFunctionFloor,"__esModule",{value:!0}),TermFunctionFloor.TermFunctionFloor=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.FLOOR,overloads:(0,t.declare)(t.SparqlOperator.FLOOR).numericConverter(()=>o=>Math.floor(o)).collect()})}};return TermFunctionFloor.TermFunctionFloor=r,TermFunctionFloor}var hasRequiredActorFunctionFactoryTermFloor;function requireActorFunctionFactoryTermFloor(){if(hasRequiredActorFunctionFactoryTermFloor)return ActorFunctionFactoryTermFloor;hasRequiredActorFunctionFactoryTermFloor=1,Object.defineProperty(ActorFunctionFactoryTermFloor,"__esModule",{value:!0}),ActorFunctionFactoryTermFloor.ActorFunctionFactoryTermFloor=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionFloor();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.FLOOR],termFunction:!0})}async run(u){return new r.TermFunctionFloor}};return ActorFunctionFactoryTermFloor.ActorFunctionFactoryTermFloor=a,ActorFunctionFactoryTermFloor}var hasRequiredLib$2L;function requireLib$2L(){return hasRequiredLib$2L||(hasRequiredLib$2L=1,function(n){var t=lib$2L&&lib$2L.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2L&&lib$2L.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermFloor(),n)}(lib$2L)),lib$2L}var lib$2K={},ActorFunctionFactoryTermHours={},TermFunctionHours={},hasRequiredTermFunctionHours;function requireTermFunctionHours(){if(hasRequiredTermFunctionHours)return TermFunctionHours;hasRequiredTermFunctionHours=1,Object.defineProperty(TermFunctionHours,"__esModule",{value:!0}),TermFunctionHours.TermFunctionHours=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.HOURS,overloads:(0,t.declare)(t.SparqlOperator.HOURS).onDateTime1(()=>o=>(0,t.integer)(o.typedValue.hours)).set([t.TypeURL.XSD_TIME],()=>([o])=>(0,t.integer)(o.typedValue.hours)).collect()})}};return TermFunctionHours.TermFunctionHours=r,TermFunctionHours}var hasRequiredActorFunctionFactoryTermHours;function requireActorFunctionFactoryTermHours(){if(hasRequiredActorFunctionFactoryTermHours)return ActorFunctionFactoryTermHours;hasRequiredActorFunctionFactoryTermHours=1,Object.defineProperty(ActorFunctionFactoryTermHours,"__esModule",{value:!0}),ActorFunctionFactoryTermHours.ActorFunctionFactoryTermHours=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionHours();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.HOURS],termFunction:!0})}async run(u){return new r.TermFunctionHours}};return ActorFunctionFactoryTermHours.ActorFunctionFactoryTermHours=a,ActorFunctionFactoryTermHours}var hasRequiredLib$2K;function requireLib$2K(){return hasRequiredLib$2K||(hasRequiredLib$2K=1,function(n){var t=lib$2K&&lib$2K.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2K&&lib$2K.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermHours(),n)}(lib$2K)),lib$2K}var lib$2J={},ActorFunctionFactoryTermIri={},TermFunctionIri={},hasRequiredTermFunctionIri;function requireTermFunctionIri(){if(hasRequiredTermFunctionIri)return TermFunctionIri;hasRequiredTermFunctionIri=1,Object.defineProperty(TermFunctionIri,"__esModule",{value:!0}),TermFunctionIri.TermFunctionIri=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n(),a=requireRelativeToAbsoluteIri();let o=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:r.SparqlOperator.IRI,overloads:(0,r.declare)(r.SparqlOperator.IRI).set(["namedNode"],s=>c=>{const l=c[0],d=(0,a.resolve)(l.str(),s.context.get(t.KeysInitQuery.baseIRI)??"");return new r.NamedNode(d)}).onString1(s=>c=>{const l=(0,a.resolve)(c.str(),s.context.get(t.KeysInitQuery.baseIRI)??"");return new r.NamedNode(l)}).collect()})}};return TermFunctionIri.TermFunctionIri=o,TermFunctionIri}var hasRequiredActorFunctionFactoryTermIri;function requireActorFunctionFactoryTermIri(){if(hasRequiredActorFunctionFactoryTermIri)return ActorFunctionFactoryTermIri;hasRequiredActorFunctionFactoryTermIri=1,Object.defineProperty(ActorFunctionFactoryTermIri,"__esModule",{value:!0}),ActorFunctionFactoryTermIri.ActorFunctionFactoryTermIri=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIri();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IRI,t.SparqlOperator.URI],termFunction:!0})}async run(u){return new r.TermFunctionIri}};return ActorFunctionFactoryTermIri.ActorFunctionFactoryTermIri=a,ActorFunctionFactoryTermIri}var hasRequiredLib$2J;function requireLib$2J(){return hasRequiredLib$2J||(hasRequiredLib$2J=1,function(n){var t=lib$2J&&lib$2J.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2J&&lib$2J.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIri(),n)}(lib$2J)),lib$2J}var lib$2I={},ActorFunctionFactoryTermIsBlank={},TermFunctionIsBlank={},hasRequiredTermFunctionIsBlank;function requireTermFunctionIsBlank(){if(hasRequiredTermFunctionIsBlank)return TermFunctionIsBlank;hasRequiredTermFunctionIsBlank=1,Object.defineProperty(TermFunctionIsBlank,"__esModule",{value:!0}),TermFunctionIsBlank.TermFunctionIsBlank=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.IS_BLANK,overloads:(0,t.declare)(t.SparqlOperator.IS_BLANK).onTerm1(()=>o=>(0,t.bool)(o.termType==="blankNode")).collect()})}};return TermFunctionIsBlank.TermFunctionIsBlank=r,TermFunctionIsBlank}var hasRequiredActorFunctionFactoryTermIsBlank;function requireActorFunctionFactoryTermIsBlank(){if(hasRequiredActorFunctionFactoryTermIsBlank)return ActorFunctionFactoryTermIsBlank;hasRequiredActorFunctionFactoryTermIsBlank=1,Object.defineProperty(ActorFunctionFactoryTermIsBlank,"__esModule",{value:!0}),ActorFunctionFactoryTermIsBlank.ActorFunctionFactoryTermIsBlank=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIsBlank();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IS_BLANK],termFunction:!0})}async run(u){return new r.TermFunctionIsBlank}};return ActorFunctionFactoryTermIsBlank.ActorFunctionFactoryTermIsBlank=a,ActorFunctionFactoryTermIsBlank}var hasRequiredLib$2I;function requireLib$2I(){return hasRequiredLib$2I||(hasRequiredLib$2I=1,function(n){var t=lib$2I&&lib$2I.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2I&&lib$2I.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIsBlank(),n)}(lib$2I)),lib$2I}var lib$2H={},ActorFunctionFactoryTermIsIri={},TermFunctionIsIri={},hasRequiredTermFunctionIsIri;function requireTermFunctionIsIri(){if(hasRequiredTermFunctionIsIri)return TermFunctionIsIri;hasRequiredTermFunctionIsIri=1,Object.defineProperty(TermFunctionIsIri,"__esModule",{value:!0}),TermFunctionIsIri.TermFunctionIsIri=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.IS_IRI,overloads:(0,t.declare)(t.SparqlOperator.IS_IRI).onTerm1(()=>o=>(0,t.bool)(o.termType==="namedNode")).collect()})}};return TermFunctionIsIri.TermFunctionIsIri=r,TermFunctionIsIri}var hasRequiredActorFunctionFactoryTermIsIri;function requireActorFunctionFactoryTermIsIri(){if(hasRequiredActorFunctionFactoryTermIsIri)return ActorFunctionFactoryTermIsIri;hasRequiredActorFunctionFactoryTermIsIri=1,Object.defineProperty(ActorFunctionFactoryTermIsIri,"__esModule",{value:!0}),ActorFunctionFactoryTermIsIri.ActorFunctionFactoryTermIsIri=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIsIri();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IS_IRI,t.SparqlOperator.IS_URI],termFunction:!0})}async run(u){return new r.TermFunctionIsIri}};return ActorFunctionFactoryTermIsIri.ActorFunctionFactoryTermIsIri=a,ActorFunctionFactoryTermIsIri}var hasRequiredLib$2H;function requireLib$2H(){return hasRequiredLib$2H||(hasRequiredLib$2H=1,function(n){var t=lib$2H&&lib$2H.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2H&&lib$2H.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIsIri(),n)}(lib$2H)),lib$2H}var lib$2G={},ActorFunctionFactoryTermIsNumeric={},TermFunctionIsNumeric={},hasRequiredTermFunctionIsNumeric;function requireTermFunctionIsNumeric(){if(hasRequiredTermFunctionIsNumeric)return TermFunctionIsNumeric;hasRequiredTermFunctionIsNumeric=1,Object.defineProperty(TermFunctionIsNumeric,"__esModule",{value:!0}),TermFunctionIsNumeric.TermFunctionIsNumeric=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.IS_NUMERIC,overloads:(0,t.declare)(t.SparqlOperator.IS_NUMERIC).onNumeric1(()=>()=>(0,t.bool)(!0)).onTerm1(()=>()=>(0,t.bool)(!1)).collect()})}};return TermFunctionIsNumeric.TermFunctionIsNumeric=r,TermFunctionIsNumeric}var hasRequiredActorFunctionFactoryTermIsNumeric;function requireActorFunctionFactoryTermIsNumeric(){if(hasRequiredActorFunctionFactoryTermIsNumeric)return ActorFunctionFactoryTermIsNumeric;hasRequiredActorFunctionFactoryTermIsNumeric=1,Object.defineProperty(ActorFunctionFactoryTermIsNumeric,"__esModule",{value:!0}),ActorFunctionFactoryTermIsNumeric.ActorFunctionFactoryTermIsNumeric=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIsNumeric();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IS_NUMERIC],termFunction:!0})}async run(u){return new r.TermFunctionIsNumeric}};return ActorFunctionFactoryTermIsNumeric.ActorFunctionFactoryTermIsNumeric=a,ActorFunctionFactoryTermIsNumeric}var hasRequiredLib$2G;function requireLib$2G(){return hasRequiredLib$2G||(hasRequiredLib$2G=1,function(n){var t=lib$2G&&lib$2G.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2G&&lib$2G.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIsNumeric(),n)}(lib$2G)),lib$2G}var lib$2F={},ActorFunctionFactoryTermIsTriple={},TermFunctionIsTriple={},hasRequiredTermFunctionIsTriple;function requireTermFunctionIsTriple(){if(hasRequiredTermFunctionIsTriple)return TermFunctionIsTriple;hasRequiredTermFunctionIsTriple=1,Object.defineProperty(TermFunctionIsTriple,"__esModule",{value:!0}),TermFunctionIsTriple.TermFunctionIsTriple=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.IS_TRIPLE,overloads:(0,t.declare)(t.SparqlOperator.IS_TRIPLE).onTerm1(()=>o=>(0,t.bool)(o.termType==="quad")).collect()})}};return TermFunctionIsTriple.TermFunctionIsTriple=r,TermFunctionIsTriple}var hasRequiredActorFunctionFactoryTermIsTriple;function requireActorFunctionFactoryTermIsTriple(){if(hasRequiredActorFunctionFactoryTermIsTriple)return ActorFunctionFactoryTermIsTriple;hasRequiredActorFunctionFactoryTermIsTriple=1,Object.defineProperty(ActorFunctionFactoryTermIsTriple,"__esModule",{value:!0}),ActorFunctionFactoryTermIsTriple.ActorFunctionFactoryTermIsTriple=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIsTriple();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IS_TRIPLE],termFunction:!0})}async run(u){return new r.TermFunctionIsTriple}};return ActorFunctionFactoryTermIsTriple.ActorFunctionFactoryTermIsTriple=a,ActorFunctionFactoryTermIsTriple}var hasRequiredLib$2F;function requireLib$2F(){return hasRequiredLib$2F||(hasRequiredLib$2F=1,function(n){var t=lib$2F&&lib$2F.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2F&&lib$2F.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIsTriple(),n)}(lib$2F)),lib$2F}var lib$2E={},ActorFunctionFactoryTermIsLiteral={},TermFunctionIsLiteral={},hasRequiredTermFunctionIsLiteral;function requireTermFunctionIsLiteral(){if(hasRequiredTermFunctionIsLiteral)return TermFunctionIsLiteral;hasRequiredTermFunctionIsLiteral=1,Object.defineProperty(TermFunctionIsLiteral,"__esModule",{value:!0}),TermFunctionIsLiteral.TermFunctionIsLiteral=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.IS_LITERAL,overloads:(0,t.declare)(t.SparqlOperator.IS_LITERAL).onTerm1(()=>o=>(0,t.bool)(o.termType==="literal")).collect()})}};return TermFunctionIsLiteral.TermFunctionIsLiteral=r,TermFunctionIsLiteral}var hasRequiredActorFunctionFactoryTermIsLiteral;function requireActorFunctionFactoryTermIsLiteral(){if(hasRequiredActorFunctionFactoryTermIsLiteral)return ActorFunctionFactoryTermIsLiteral;hasRequiredActorFunctionFactoryTermIsLiteral=1,Object.defineProperty(ActorFunctionFactoryTermIsLiteral,"__esModule",{value:!0}),ActorFunctionFactoryTermIsLiteral.ActorFunctionFactoryTermIsLiteral=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionIsLiteral();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IS_LITERAL],termFunction:!0})}async run(u){return new r.TermFunctionIsLiteral}};return ActorFunctionFactoryTermIsLiteral.ActorFunctionFactoryTermIsLiteral=a,ActorFunctionFactoryTermIsLiteral}var hasRequiredLib$2E;function requireLib$2E(){return hasRequiredLib$2E||(hasRequiredLib$2E=1,function(n){var t=lib$2E&&lib$2E.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2E&&lib$2E.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermIsLiteral(),n)}(lib$2E)),lib$2E}var lib$2D={},ActorFunctionFactoryTermLang={},TermFunctionLang={},hasRequiredTermFunctionLang;function requireTermFunctionLang(){if(hasRequiredTermFunctionLang)return TermFunctionLang;hasRequiredTermFunctionLang=1,Object.defineProperty(TermFunctionLang,"__esModule",{value:!0}),TermFunctionLang.TermFunctionLang=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.LANG,overloads:(0,t.declare)(t.SparqlOperator.LANG).onLiteral1(()=>o=>(0,t.string)(o.language??"")).collect()})}};return TermFunctionLang.TermFunctionLang=r,TermFunctionLang}var hasRequiredActorFunctionFactoryTermLang;function requireActorFunctionFactoryTermLang(){if(hasRequiredActorFunctionFactoryTermLang)return ActorFunctionFactoryTermLang;hasRequiredActorFunctionFactoryTermLang=1,Object.defineProperty(ActorFunctionFactoryTermLang,"__esModule",{value:!0}),ActorFunctionFactoryTermLang.ActorFunctionFactoryTermLang=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionLang();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LANG],termFunction:!0})}async run(u){return new r.TermFunctionLang}};return ActorFunctionFactoryTermLang.ActorFunctionFactoryTermLang=a,ActorFunctionFactoryTermLang}var hasRequiredLib$2D;function requireLib$2D(){return hasRequiredLib$2D||(hasRequiredLib$2D=1,function(n){var t=lib$2D&&lib$2D.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2D&&lib$2D.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermLang(),n)}(lib$2D)),lib$2D}var lib$2C={},ActorFunctionFactoryTermLcase={},TermFunctionLcase={},hasRequiredTermFunctionLcase;function requireTermFunctionLcase(){if(hasRequiredTermFunctionLcase)return TermFunctionLcase;hasRequiredTermFunctionLcase=1,Object.defineProperty(TermFunctionLcase,"__esModule",{value:!0}),TermFunctionLcase.TermFunctionLcase=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.LCASE,overloads:(0,t.declare)(t.SparqlOperator.LCASE).onString1Typed(()=>o=>(0,t.string)(o.toLowerCase())).onLangString1(()=>o=>(0,t.langString)(o.typedValue.toLowerCase(),o.language)).collect()})}};return TermFunctionLcase.TermFunctionLcase=r,TermFunctionLcase}var hasRequiredActorFunctionFactoryTermLcase;function requireActorFunctionFactoryTermLcase(){if(hasRequiredActorFunctionFactoryTermLcase)return ActorFunctionFactoryTermLcase;hasRequiredActorFunctionFactoryTermLcase=1,Object.defineProperty(ActorFunctionFactoryTermLcase,"__esModule",{value:!0}),ActorFunctionFactoryTermLcase.ActorFunctionFactoryTermLcase=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionLcase();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LCASE],termFunction:!0})}async run(u){return new r.TermFunctionLcase}};return ActorFunctionFactoryTermLcase.ActorFunctionFactoryTermLcase=a,ActorFunctionFactoryTermLcase}var hasRequiredLib$2C;function requireLib$2C(){return hasRequiredLib$2C||(hasRequiredLib$2C=1,function(n){var t=lib$2C&&lib$2C.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2C&&lib$2C.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermLcase(),n)}(lib$2C)),lib$2C}var lib$2B={},ActorFunctionFactoryTermLangmatches={},TermFunctionLangmatches={},hasRequiredTermFunctionLangmatches;function requireTermFunctionLangmatches(){if(hasRequiredTermFunctionLangmatches)return TermFunctionLangmatches;hasRequiredTermFunctionLangmatches=1,Object.defineProperty(TermFunctionLangmatches,"__esModule",{value:!0}),TermFunctionLangmatches.TermFunctionLangmatches=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class zr extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.LANG_MATCHES,overloads:(0,t.declare)(t.SparqlOperator.LANG_MATCHES).onBinaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.bool)(zr.langMatches(o,u))).collect()})}static langMatches(o,u){const s=o.split("-"),c=u.split("-");if(!zr.matchLangTag(c[0],s[0])&&!zr.isWildCard(s[0]))return!1;let l=1,d=1;for(;d<c.length;){if(zr.isWildCard(c[d])){d++;continue}if(l===s.length)return!1;if(zr.matchLangTag(c[d],s[l])){l++,d++;continue}if(s[l].length===1)return!1;l++}return!0}static isWildCard(o){return o==="*"}static matchLangTag(o,u){return new RegExp(`/${o}/`,"iu").test(`/${u}/`)}};return TermFunctionLangmatches.TermFunctionLangmatches=r,TermFunctionLangmatches}var hasRequiredActorFunctionFactoryTermLangmatches;function requireActorFunctionFactoryTermLangmatches(){if(hasRequiredActorFunctionFactoryTermLangmatches)return ActorFunctionFactoryTermLangmatches;hasRequiredActorFunctionFactoryTermLangmatches=1,Object.defineProperty(ActorFunctionFactoryTermLangmatches,"__esModule",{value:!0}),ActorFunctionFactoryTermLangmatches.ActorFunctionFactoryTermLangmatches=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionLangmatches();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LANG_MATCHES],termFunction:!0})}async run(u){return new r.TermFunctionLangmatches}};return ActorFunctionFactoryTermLangmatches.ActorFunctionFactoryTermLangmatches=a,ActorFunctionFactoryTermLangmatches}var hasRequiredLib$2B;function requireLib$2B(){return hasRequiredLib$2B||(hasRequiredLib$2B=1,function(n){var t=lib$2B&&lib$2B.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2B&&lib$2B.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermLangmatches(),n)}(lib$2B)),lib$2B}var lib$2A={},ActorFunctionFactoryTermMinutes={},TermFunctionMinutes={},hasRequiredTermFunctionMinutes;function requireTermFunctionMinutes(){if(hasRequiredTermFunctionMinutes)return TermFunctionMinutes;hasRequiredTermFunctionMinutes=1,Object.defineProperty(TermFunctionMinutes,"__esModule",{value:!0}),TermFunctionMinutes.TermFunctionMinutes=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.MINUTES,overloads:(0,t.declare)(t.SparqlOperator.MINUTES).onDateTime1(()=>o=>(0,t.integer)(o.typedValue.minutes)).set([t.TypeURL.XSD_TIME],()=>([o])=>(0,t.integer)(o.typedValue.minutes)).collect()})}};return TermFunctionMinutes.TermFunctionMinutes=r,TermFunctionMinutes}var hasRequiredActorFunctionFactoryTermMinutes;function requireActorFunctionFactoryTermMinutes(){if(hasRequiredActorFunctionFactoryTermMinutes)return ActorFunctionFactoryTermMinutes;hasRequiredActorFunctionFactoryTermMinutes=1,Object.defineProperty(ActorFunctionFactoryTermMinutes,"__esModule",{value:!0}),ActorFunctionFactoryTermMinutes.ActorFunctionFactoryTermMinutes=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionMinutes();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.MINUTES],termFunction:!0})}async run(u){return new r.TermFunctionMinutes}};return ActorFunctionFactoryTermMinutes.ActorFunctionFactoryTermMinutes=a,ActorFunctionFactoryTermMinutes}var hasRequiredLib$2A;function requireLib$2A(){return hasRequiredLib$2A||(hasRequiredLib$2A=1,function(n){var t=lib$2A&&lib$2A.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2A&&lib$2A.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermMinutes(),n)}(lib$2A)),lib$2A}var lib$2z={},ActorFunctionFactoryTermMd5={},TermFunctionMd5={},sparkMd5={exports:{}},hasRequiredSparkMd5;function requireSparkMd5(){return hasRequiredSparkMd5||(hasRequiredSparkMd5=1,function(n,t){(function(r){n.exports=r()})(function(r){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function o(T,w){var A=T[0],R=T[1],E=T[2],I=T[3];A+=(R&E|~R&I)+w[0]-680876936|0,A=(A<<7|A>>>25)+R|0,I+=(A&R|~A&E)+w[1]-389564586|0,I=(I<<12|I>>>20)+A|0,E+=(I&A|~I&R)+w[2]+606105819|0,E=(E<<17|E>>>15)+I|0,R+=(E&I|~E&A)+w[3]-1044525330|0,R=(R<<22|R>>>10)+E|0,A+=(R&E|~R&I)+w[4]-176418897|0,A=(A<<7|A>>>25)+R|0,I+=(A&R|~A&E)+w[5]+1200080426|0,I=(I<<12|I>>>20)+A|0,E+=(I&A|~I&R)+w[6]-1473231341|0,E=(E<<17|E>>>15)+I|0,R+=(E&I|~E&A)+w[7]-45705983|0,R=(R<<22|R>>>10)+E|0,A+=(R&E|~R&I)+w[8]+1770035416|0,A=(A<<7|A>>>25)+R|0,I+=(A&R|~A&E)+w[9]-1958414417|0,I=(I<<12|I>>>20)+A|0,E+=(I&A|~I&R)+w[10]-42063|0,E=(E<<17|E>>>15)+I|0,R+=(E&I|~E&A)+w[11]-1990404162|0,R=(R<<22|R>>>10)+E|0,A+=(R&E|~R&I)+w[12]+1804603682|0,A=(A<<7|A>>>25)+R|0,I+=(A&R|~A&E)+w[13]-40341101|0,I=(I<<12|I>>>20)+A|0,E+=(I&A|~I&R)+w[14]-1502002290|0,E=(E<<17|E>>>15)+I|0,R+=(E&I|~E&A)+w[15]+1236535329|0,R=(R<<22|R>>>10)+E|0,A+=(R&I|E&~I)+w[1]-165796510|0,A=(A<<5|A>>>27)+R|0,I+=(A&E|R&~E)+w[6]-1069501632|0,I=(I<<9|I>>>23)+A|0,E+=(I&R|A&~R)+w[11]+643717713|0,E=(E<<14|E>>>18)+I|0,R+=(E&A|I&~A)+w[0]-373897302|0,R=(R<<20|R>>>12)+E|0,A+=(R&I|E&~I)+w[5]-701558691|0,A=(A<<5|A>>>27)+R|0,I+=(A&E|R&~E)+w[10]+38016083|0,I=(I<<9|I>>>23)+A|0,E+=(I&R|A&~R)+w[15]-660478335|0,E=(E<<14|E>>>18)+I|0,R+=(E&A|I&~A)+w[4]-405537848|0,R=(R<<20|R>>>12)+E|0,A+=(R&I|E&~I)+w[9]+568446438|0,A=(A<<5|A>>>27)+R|0,I+=(A&E|R&~E)+w[14]-1019803690|0,I=(I<<9|I>>>23)+A|0,E+=(I&R|A&~R)+w[3]-187363961|0,E=(E<<14|E>>>18)+I|0,R+=(E&A|I&~A)+w[8]+1163531501|0,R=(R<<20|R>>>12)+E|0,A+=(R&I|E&~I)+w[13]-1444681467|0,A=(A<<5|A>>>27)+R|0,I+=(A&E|R&~E)+w[2]-51403784|0,I=(I<<9|I>>>23)+A|0,E+=(I&R|A&~R)+w[7]+1735328473|0,E=(E<<14|E>>>18)+I|0,R+=(E&A|I&~A)+w[12]-1926607734|0,R=(R<<20|R>>>12)+E|0,A+=(R^E^I)+w[5]-378558|0,A=(A<<4|A>>>28)+R|0,I+=(A^R^E)+w[8]-2022574463|0,I=(I<<11|I>>>21)+A|0,E+=(I^A^R)+w[11]+1839030562|0,E=(E<<16|E>>>16)+I|0,R+=(E^I^A)+w[14]-35309556|0,R=(R<<23|R>>>9)+E|0,A+=(R^E^I)+w[1]-1530992060|0,A=(A<<4|A>>>28)+R|0,I+=(A^R^E)+w[4]+1272893353|0,I=(I<<11|I>>>21)+A|0,E+=(I^A^R)+w[7]-155497632|0,E=(E<<16|E>>>16)+I|0,R+=(E^I^A)+w[10]-1094730640|0,R=(R<<23|R>>>9)+E|0,A+=(R^E^I)+w[13]+681279174|0,A=(A<<4|A>>>28)+R|0,I+=(A^R^E)+w[0]-358537222|0,I=(I<<11|I>>>21)+A|0,E+=(I^A^R)+w[3]-722521979|0,E=(E<<16|E>>>16)+I|0,R+=(E^I^A)+w[6]+76029189|0,R=(R<<23|R>>>9)+E|0,A+=(R^E^I)+w[9]-640364487|0,A=(A<<4|A>>>28)+R|0,I+=(A^R^E)+w[12]-421815835|0,I=(I<<11|I>>>21)+A|0,E+=(I^A^R)+w[15]+530742520|0,E=(E<<16|E>>>16)+I|0,R+=(E^I^A)+w[2]-995338651|0,R=(R<<23|R>>>9)+E|0,A+=(E^(R|~I))+w[0]-198630844|0,A=(A<<6|A>>>26)+R|0,I+=(R^(A|~E))+w[7]+1126891415|0,I=(I<<10|I>>>22)+A|0,E+=(A^(I|~R))+w[14]-1416354905|0,E=(E<<15|E>>>17)+I|0,R+=(I^(E|~A))+w[5]-57434055|0,R=(R<<21|R>>>11)+E|0,A+=(E^(R|~I))+w[12]+1700485571|0,A=(A<<6|A>>>26)+R|0,I+=(R^(A|~E))+w[3]-1894986606|0,I=(I<<10|I>>>22)+A|0,E+=(A^(I|~R))+w[10]-1051523|0,E=(E<<15|E>>>17)+I|0,R+=(I^(E|~A))+w[1]-2054922799|0,R=(R<<21|R>>>11)+E|0,A+=(E^(R|~I))+w[8]+1873313359|0,A=(A<<6|A>>>26)+R|0,I+=(R^(A|~E))+w[15]-30611744|0,I=(I<<10|I>>>22)+A|0,E+=(A^(I|~R))+w[6]-1560198380|0,E=(E<<15|E>>>17)+I|0,R+=(I^(E|~A))+w[13]+1309151649|0,R=(R<<21|R>>>11)+E|0,A+=(E^(R|~I))+w[4]-145523070|0,A=(A<<6|A>>>26)+R|0,I+=(R^(A|~E))+w[11]-1120210379|0,I=(I<<10|I>>>22)+A|0,E+=(A^(I|~R))+w[2]+718787259|0,E=(E<<15|E>>>17)+I|0,R+=(I^(E|~A))+w[9]-343485551|0,R=(R<<21|R>>>11)+E|0,T[0]=A+T[0]|0,T[1]=R+T[1]|0,T[2]=E+T[2]|0,T[3]=I+T[3]|0}function u(T){var w=[],A;for(A=0;A<64;A+=4)w[A>>2]=T.charCodeAt(A)+(T.charCodeAt(A+1)<<8)+(T.charCodeAt(A+2)<<16)+(T.charCodeAt(A+3)<<24);return w}function s(T){var w=[],A;for(A=0;A<64;A+=4)w[A>>2]=T[A]+(T[A+1]<<8)+(T[A+2]<<16)+(T[A+3]<<24);return w}function c(T){var w=T.length,A=[1732584193,-271733879,-1732584194,271733878],R,E,I,L,F,D;for(R=64;R<=w;R+=64)o(A,u(T.substring(R-64,R)));for(T=T.substring(R-64),E=T.length,I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],R=0;R<E;R+=1)I[R>>2]|=T.charCodeAt(R)<<(R%4<<3);if(I[R>>2]|=128<<(R%4<<3),R>55)for(o(A,I),R=0;R<16;R+=1)I[R]=0;return L=w*8,L=L.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(L[2],16),D=parseInt(L[1],16)||0,I[14]=F,I[15]=D,o(A,I),A}function l(T){var w=T.length,A=[1732584193,-271733879,-1732584194,271733878],R,E,I,L,F,D;for(R=64;R<=w;R+=64)o(A,s(T.subarray(R-64,R)));for(T=R-64<w?T.subarray(R-64):new Uint8Array(0),E=T.length,I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],R=0;R<E;R+=1)I[R>>2]|=T[R]<<(R%4<<3);if(I[R>>2]|=128<<(R%4<<3),R>55)for(o(A,I),R=0;R<16;R+=1)I[R]=0;return L=w*8,L=L.toString(16).match(/(.*?)(.{0,8})$/),F=parseInt(L[2],16),D=parseInt(L[1],16)||0,I[14]=F,I[15]=D,o(A,I),A}function d(T){var w="",A;for(A=0;A<4;A+=1)w+=a[T>>A*8+4&15]+a[T>>A*8&15];return w}function f(T){var w;for(w=0;w<T.length;w+=1)T[w]=d(T[w]);return T.join("")}f(c("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function T(w,A){return w=w|0||0,w<0?Math.max(w+A,0):Math.min(w,A)}ArrayBuffer.prototype.slice=function(w,A){var R=this.byteLength,E=T(w,R),I=R,L,F,D,$;return A!==r&&(I=T(A,R)),E>I?new ArrayBuffer(0):(L=I-E,F=new ArrayBuffer(L),D=new Uint8Array(F),$=new Uint8Array(this,E,L),D.set($),F)}}();function h(T){return/[\u0080-\uFFFF]/.test(T)&&(T=unescape(encodeURIComponent(T))),T}function v(T,w){var A=T.length,R=new ArrayBuffer(A),E=new Uint8Array(R),I;for(I=0;I<A;I+=1)E[I]=T.charCodeAt(I);return w?E:R}function g(T){return String.fromCharCode.apply(null,new Uint8Array(T))}function b(T,w,A){var R=new Uint8Array(T.byteLength+w.byteLength);return R.set(new Uint8Array(T)),R.set(new Uint8Array(w),T.byteLength),R}function _(T){var w=[],A=T.length,R;for(R=0;R<A-1;R+=2)w.push(parseInt(T.substr(R,2),16));return String.fromCharCode.apply(String,w)}function S(){this.reset()}return S.prototype.append=function(T){return this.appendBinary(h(T)),this},S.prototype.appendBinary=function(T){this._buff+=T,this._length+=T.length;var w=this._buff.length,A;for(A=64;A<=w;A+=64)o(this._hash,u(this._buff.substring(A-64,A)));return this._buff=this._buff.substring(A-64),this},S.prototype.end=function(T){var w=this._buff,A=w.length,R,E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],I;for(R=0;R<A;R+=1)E[R>>2]|=w.charCodeAt(R)<<(R%4<<3);return this._finish(E,A),I=f(this._hash),T&&(I=_(I)),this.reset(),I},S.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},S.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},S.prototype.setState=function(T){return this._buff=T.buff,this._length=T.length,this._hash=T.hash,this},S.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},S.prototype._finish=function(T,w){var A=w,R,E,I;if(T[A>>2]|=128<<(A%4<<3),A>55)for(o(this._hash,T),A=0;A<16;A+=1)T[A]=0;R=this._length*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),E=parseInt(R[2],16),I=parseInt(R[1],16)||0,T[14]=E,T[15]=I,o(this._hash,T)},S.hash=function(T,w){return S.hashBinary(h(T),w)},S.hashBinary=function(T,w){var A=c(T),R=f(A);return w?_(R):R},S.ArrayBuffer=function(){this.reset()},S.ArrayBuffer.prototype.append=function(T){var w=b(this._buff.buffer,T),A=w.length,R;for(this._length+=T.byteLength,R=64;R<=A;R+=64)o(this._hash,s(w.subarray(R-64,R)));return this._buff=R-64<A?new Uint8Array(w.buffer.slice(R-64)):new Uint8Array(0),this},S.ArrayBuffer.prototype.end=function(T){var w=this._buff,A=w.length,R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E,I;for(E=0;E<A;E+=1)R[E>>2]|=w[E]<<(E%4<<3);return this._finish(R,A),I=f(this._hash),T&&(I=_(I)),this.reset(),I},S.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},S.ArrayBuffer.prototype.getState=function(){var T=S.prototype.getState.call(this);return T.buff=g(T.buff),T},S.ArrayBuffer.prototype.setState=function(T){return T.buff=v(T.buff,!0),S.prototype.setState.call(this,T)},S.ArrayBuffer.prototype.destroy=S.prototype.destroy,S.ArrayBuffer.prototype._finish=S.prototype._finish,S.ArrayBuffer.hash=function(T,w){var A=l(new Uint8Array(T)),R=f(A);return w?_(R):R},S})}(sparkMd5)),sparkMd5.exports}var hasRequiredTermFunctionMd5;function requireTermFunctionMd5(){if(hasRequiredTermFunctionMd5)return TermFunctionMd5;hasRequiredTermFunctionMd5=1,Object.defineProperty(TermFunctionMd5,"__esModule",{value:!0}),TermFunctionMd5.TermFunctionMd5=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireSparkMd5();let a=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.MD5,overloads:(0,t.declare)(t.SparqlOperator.MD5).onString1Typed(()=>u=>(0,t.string)((0,r.hash)(u))).collect()})}};return TermFunctionMd5.TermFunctionMd5=a,TermFunctionMd5}var hasRequiredActorFunctionFactoryTermMd5;function requireActorFunctionFactoryTermMd5(){if(hasRequiredActorFunctionFactoryTermMd5)return ActorFunctionFactoryTermMd5;hasRequiredActorFunctionFactoryTermMd5=1,Object.defineProperty(ActorFunctionFactoryTermMd5,"__esModule",{value:!0}),ActorFunctionFactoryTermMd5.ActorFunctionFactoryTermMd5=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionMd5();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.MD5],termFunction:!0})}async run(u){return new r.TermFunctionMd5}};return ActorFunctionFactoryTermMd5.ActorFunctionFactoryTermMd5=a,ActorFunctionFactoryTermMd5}var hasRequiredLib$2z;function requireLib$2z(){return hasRequiredLib$2z||(hasRequiredLib$2z=1,function(n){var t=lib$2z&&lib$2z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2z&&lib$2z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermMd5(),n)}(lib$2z)),lib$2z}var lib$2y={},ActorFunctionFactoryTermMultiplication={},TermFunctionMultiplication={},hasRequiredTermFunctionMultiplication;function requireTermFunctionMultiplication(){if(hasRequiredTermFunctionMultiplication)return TermFunctionMultiplication;hasRequiredTermFunctionMultiplication=1,Object.defineProperty(TermFunctionMultiplication,"__esModule",{value:!0}),TermFunctionMultiplication.TermFunctionMultiplication=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireBignumber();let a=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.MULTIPLICATION,overloads:(0,t.declare)(t.SparqlOperator.MULTIPLICATION).arithmetic(()=>(u,s)=>new r.BigNumber(u).times(s).toNumber()).collect()})}};return TermFunctionMultiplication.TermFunctionMultiplication=a,TermFunctionMultiplication}var hasRequiredActorFunctionFactoryTermMultiplication;function requireActorFunctionFactoryTermMultiplication(){if(hasRequiredActorFunctionFactoryTermMultiplication)return ActorFunctionFactoryTermMultiplication;hasRequiredActorFunctionFactoryTermMultiplication=1,Object.defineProperty(ActorFunctionFactoryTermMultiplication,"__esModule",{value:!0}),ActorFunctionFactoryTermMultiplication.ActorFunctionFactoryTermMultiplication=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionMultiplication();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.MULTIPLICATION],termFunction:!0})}async run(u){return new r.TermFunctionMultiplication}};return ActorFunctionFactoryTermMultiplication.ActorFunctionFactoryTermMultiplication=a,ActorFunctionFactoryTermMultiplication}var hasRequiredLib$2y;function requireLib$2y(){return hasRequiredLib$2y||(hasRequiredLib$2y=1,function(n){var t=lib$2y&&lib$2y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2y&&lib$2y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermMultiplication(),n)}(lib$2y)),lib$2y}var lib$2x={},ActorFunctionFactoryTermMonth={},TermFunctionMonth={},hasRequiredTermFunctionMonth;function requireTermFunctionMonth(){if(hasRequiredTermFunctionMonth)return TermFunctionMonth;hasRequiredTermFunctionMonth=1,Object.defineProperty(TermFunctionMonth,"__esModule",{value:!0}),TermFunctionMonth.TermFunctionMonth=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.MONTH,overloads:(0,t.declare)(t.SparqlOperator.MONTH).onDateTime1(()=>o=>(0,t.integer)(o.typedValue.month)).set([t.TypeURL.XSD_DATE],()=>([o])=>(0,t.integer)(o.typedValue.month)).collect()})}};return TermFunctionMonth.TermFunctionMonth=r,TermFunctionMonth}var hasRequiredActorFunctionFactoryTermMonth;function requireActorFunctionFactoryTermMonth(){if(hasRequiredActorFunctionFactoryTermMonth)return ActorFunctionFactoryTermMonth;hasRequiredActorFunctionFactoryTermMonth=1,Object.defineProperty(ActorFunctionFactoryTermMonth,"__esModule",{value:!0}),ActorFunctionFactoryTermMonth.ActorFunctionFactoryTermMonth=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionMonth();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.MONTH],termFunction:!0})}async run(u){return new r.TermFunctionMonth}};return ActorFunctionFactoryTermMonth.ActorFunctionFactoryTermMonth=a,ActorFunctionFactoryTermMonth}var hasRequiredLib$2x;function requireLib$2x(){return hasRequiredLib$2x||(hasRequiredLib$2x=1,function(n){var t=lib$2x&&lib$2x.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2x&&lib$2x.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermMonth(),n)}(lib$2x)),lib$2x}var lib$2w={},ActorFunctionFactoryTermNot={},TermFunctionNot={},hasRequiredTermFunctionNot;function requireTermFunctionNot(){if(hasRequiredTermFunctionNot)return TermFunctionNot;hasRequiredTermFunctionNot=1,Object.defineProperty(TermFunctionNot,"__esModule",{value:!0}),TermFunctionNot.TermFunctionNot=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.NOT,overloads:(0,t.declare)(t.SparqlOperator.NOT).onTerm1(()=>o=>(0,t.bool)(!o.coerceEBV())).collect()})}};return TermFunctionNot.TermFunctionNot=r,TermFunctionNot}var hasRequiredActorFunctionFactoryTermNot;function requireActorFunctionFactoryTermNot(){if(hasRequiredActorFunctionFactoryTermNot)return ActorFunctionFactoryTermNot;hasRequiredActorFunctionFactoryTermNot=1,Object.defineProperty(ActorFunctionFactoryTermNot,"__esModule",{value:!0}),ActorFunctionFactoryTermNot.ActorFunctionFactoryTermNot=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionNot();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.NOT],termFunction:!0})}async run(u){return new r.TermFunctionNot}};return ActorFunctionFactoryTermNot.ActorFunctionFactoryTermNot=a,ActorFunctionFactoryTermNot}var hasRequiredLib$2w;function requireLib$2w(){return hasRequiredLib$2w||(hasRequiredLib$2w=1,function(n){var t=lib$2w&&lib$2w.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2w&&lib$2w.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermNot(),n)}(lib$2w)),lib$2w}var lib$2v={},ActorFunctionFactoryTermObject={},TermFunctionObject={},hasRequiredTermFunctionObject;function requireTermFunctionObject(){if(hasRequiredTermFunctionObject)return TermFunctionObject;hasRequiredTermFunctionObject=1,Object.defineProperty(TermFunctionObject,"__esModule",{value:!0}),TermFunctionObject.TermFunctionObject=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.OBJECT,overloads:(0,t.declare)(t.SparqlOperator.OBJECT).onQuad1(()=>o=>o.object).collect()})}};return TermFunctionObject.TermFunctionObject=r,TermFunctionObject}var hasRequiredActorFunctionFactoryTermObject;function requireActorFunctionFactoryTermObject(){if(hasRequiredActorFunctionFactoryTermObject)return ActorFunctionFactoryTermObject;hasRequiredActorFunctionFactoryTermObject=1,Object.defineProperty(ActorFunctionFactoryTermObject,"__esModule",{value:!0}),ActorFunctionFactoryTermObject.ActorFunctionFactoryTermObject=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionObject();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.OBJECT],termFunction:!0})}async run(u){return new r.TermFunctionObject}};return ActorFunctionFactoryTermObject.ActorFunctionFactoryTermObject=a,ActorFunctionFactoryTermObject}var hasRequiredLib$2v;function requireLib$2v(){return hasRequiredLib$2v||(hasRequiredLib$2v=1,function(n){var t=lib$2v&&lib$2v.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2v&&lib$2v.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermObject(),n)}(lib$2v)),lib$2v}var lib$2u={},ActorFunctionFactoryTermNow={},TermFunctionNow={},hasRequiredTermFunctionNow;function requireTermFunctionNow(){if(hasRequiredTermFunctionNow)return TermFunctionNow;hasRequiredTermFunctionNow=1,Object.defineProperty(TermFunctionNow,"__esModule",{value:!0}),TermFunctionNow.TermFunctionNow=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.TermFunctionBase{constructor(){super({arity:0,operator:r.SparqlOperator.NOW,overloads:(0,r.declare)(r.SparqlOperator.NOW).set([],u=>()=>new r.DateTimeLiteral((0,r.toDateTimeRepresentation)({date:u.context.getSafe(t.KeysInitQuery.queryTimestamp),timeZone:u.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)}))).collect()})}};return TermFunctionNow.TermFunctionNow=a,TermFunctionNow}var hasRequiredActorFunctionFactoryTermNow;function requireActorFunctionFactoryTermNow(){if(hasRequiredActorFunctionFactoryTermNow)return ActorFunctionFactoryTermNow;hasRequiredActorFunctionFactoryTermNow=1,Object.defineProperty(ActorFunctionFactoryTermNow,"__esModule",{value:!0}),ActorFunctionFactoryTermNow.ActorFunctionFactoryTermNow=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionNow();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.NOW],termFunction:!0})}async run(u){return new r.TermFunctionNow}};return ActorFunctionFactoryTermNow.ActorFunctionFactoryTermNow=a,ActorFunctionFactoryTermNow}var hasRequiredLib$2u;function requireLib$2u(){return hasRequiredLib$2u||(hasRequiredLib$2u=1,function(n){var t=lib$2u&&lib$2u.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2u&&lib$2u.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermNow(),n)}(lib$2u)),lib$2u}var lib$2t={},ActorFunctionFactoryTermPredicate={},TermFunctionPredicate={},hasRequiredTermFunctionPredicate;function requireTermFunctionPredicate(){if(hasRequiredTermFunctionPredicate)return TermFunctionPredicate;hasRequiredTermFunctionPredicate=1,Object.defineProperty(TermFunctionPredicate,"__esModule",{value:!0}),TermFunctionPredicate.TermFunctionPredicate=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.PREDICATE,overloads:(0,t.declare)(t.SparqlOperator.PREDICATE).onQuad1(()=>o=>o.predicate).collect()})}};return TermFunctionPredicate.TermFunctionPredicate=r,TermFunctionPredicate}var hasRequiredActorFunctionFactoryTermPredicate;function requireActorFunctionFactoryTermPredicate(){if(hasRequiredActorFunctionFactoryTermPredicate)return ActorFunctionFactoryTermPredicate;hasRequiredActorFunctionFactoryTermPredicate=1,Object.defineProperty(ActorFunctionFactoryTermPredicate,"__esModule",{value:!0}),ActorFunctionFactoryTermPredicate.ActorFunctionFactoryTermPredicate=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionPredicate();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.PREDICATE],termFunction:!0})}async run(u){return new r.TermFunctionPredicate}};return ActorFunctionFactoryTermPredicate.ActorFunctionFactoryTermPredicate=a,ActorFunctionFactoryTermPredicate}var hasRequiredLib$2t;function requireLib$2t(){return hasRequiredLib$2t||(hasRequiredLib$2t=1,function(n){var t=lib$2t&&lib$2t.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2t&&lib$2t.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermPredicate(),n)}(lib$2t)),lib$2t}var lib$2s={},ActorFunctionFactoryTermRand={},TermFunctionRand={},hasRequiredTermFunctionRand;function requireTermFunctionRand(){if(hasRequiredTermFunctionRand)return TermFunctionRand;hasRequiredTermFunctionRand=1,Object.defineProperty(TermFunctionRand,"__esModule",{value:!0}),TermFunctionRand.TermFunctionRand=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:0,operator:t.SparqlOperator.RAND,overloads:(0,t.declare)(t.SparqlOperator.RAND).set([],()=>()=>(0,t.double)(Math.random())).collect()})}};return TermFunctionRand.TermFunctionRand=r,TermFunctionRand}var hasRequiredActorFunctionFactoryTermRand;function requireActorFunctionFactoryTermRand(){if(hasRequiredActorFunctionFactoryTermRand)return ActorFunctionFactoryTermRand;hasRequiredActorFunctionFactoryTermRand=1,Object.defineProperty(ActorFunctionFactoryTermRand,"__esModule",{value:!0}),ActorFunctionFactoryTermRand.ActorFunctionFactoryTermRand=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionRand();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.RAND],termFunction:!0})}async run(u){return new r.TermFunctionRand}};return ActorFunctionFactoryTermRand.ActorFunctionFactoryTermRand=a,ActorFunctionFactoryTermRand}var hasRequiredLib$2s;function requireLib$2s(){return hasRequiredLib$2s||(hasRequiredLib$2s=1,function(n){var t=lib$2s&&lib$2s.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2s&&lib$2s.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermRand(),n)}(lib$2s)),lib$2s}var lib$2r={},ActorFunctionFactoryTermRegex={},TermFunctionRegex={},hasRequiredTermFunctionRegex;function requireTermFunctionRegex(){if(hasRequiredTermFunctionRegex)return TermFunctionRegex;hasRequiredTermFunctionRegex=1,Object.defineProperty(TermFunctionRegex,"__esModule",{value:!0}),TermFunctionRegex.TermFunctionRegex=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class gr extends n.TermFunctionBase{constructor(){super({arity:[2,3],operator:t.SparqlOperator.REGEX,overloads:(0,t.declare)(t.SparqlOperator.REGEX).onBinaryTyped([t.TypeAlias.SPARQL_STRINGLY,t.TypeURL.XSD_STRING],gr.regex2).onTernaryTyped([t.TypeAlias.SPARQL_STRINGLY,t.TypeURL.XSD_STRING,t.TypeURL.XSD_STRING],gr.regex3).collect()})}static regex2(){return(o,u)=>(0,t.bool)(gr.matches(o,u))}static regex3(){return(o,u,s)=>(0,t.bool)(gr.matches(o,u,s))}static matches(o,u,s=""){return s=gr.cleanFlags(s),s.includes("x")&&(u=gr.flagX(u)),s.includes("q")&&(u=gr.flagQ(u)),new RegExp(u,s.replaceAll(/[qx]/gu,"")).test(o)}static cleanFlags(o){if(!/^[imsxq]*$/u.test(o))throw new Error("Invalid flags");const u=[...o].find((s,c,l)=>l.indexOf(s)!==c);if(u)throw new Error(`Duplicate flag: ${u}`);return o!=null&&o.includes("q")&&(o=o.replaceAll(/[msx]/gu,"")),`${o}u`}static flagX(o){if(!o)return o;let u=o[0];for(;["	",`
`,"\r"," "].includes(u);)o=o.slice(1),u=o[0];let s=u==="[";for(let c=1;c<o.length;c++){const l=o[c];["	",`
`,"\r"," "].includes(l)&&!s?(o=o.slice(0,c)+o.slice(c+1),c--):l==="["&&u!=="\\"?s=!0:l==="]"&&u!=="\\"&&(s=!1),u=l}return o}static flagQ(o){return o.replaceAll(/([?+*.{}()[\]\\|])/gu,"\\$1").replaceAll(/^\^/gu,"\\^").replaceAll(/\$$/gu,"\\$")}};return TermFunctionRegex.TermFunctionRegex=r,TermFunctionRegex}var hasRequiredActorFunctionFactoryTermRegex;function requireActorFunctionFactoryTermRegex(){if(hasRequiredActorFunctionFactoryTermRegex)return ActorFunctionFactoryTermRegex;hasRequiredActorFunctionFactoryTermRegex=1,Object.defineProperty(ActorFunctionFactoryTermRegex,"__esModule",{value:!0}),ActorFunctionFactoryTermRegex.ActorFunctionFactoryTermRegex=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionRegex();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.REGEX],termFunction:!0})}async run(u){return new r.TermFunctionRegex}};return ActorFunctionFactoryTermRegex.ActorFunctionFactoryTermRegex=a,ActorFunctionFactoryTermRegex}var hasRequiredLib$2r;function requireLib$2r(){return hasRequiredLib$2r||(hasRequiredLib$2r=1,function(n){var t=lib$2r&&lib$2r.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2r&&lib$2r.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermRegex(),n),r(requireTermFunctionRegex(),n)}(lib$2r)),lib$2r}var lib$2q={},ActorFunctionFactoryTermReplace={},TermFunctionReplace={},hasRequiredTermFunctionReplace;function requireTermFunctionReplace(){if(hasRequiredTermFunctionReplace)return TermFunctionReplace;hasRequiredTermFunctionReplace=1,Object.defineProperty(TermFunctionReplace,"__esModule",{value:!0}),TermFunctionReplace.TermFunctionReplace=void 0;const n=requireLib$2r(),t=requireLib$4m(),r=requireLib$4n();let a=class an extends t.TermFunctionBase{constructor(){super({arity:[3,4],operator:r.SparqlOperator.REPLACE,overloads:(0,r.declare)(r.SparqlOperator.REPLACE).onTernaryTyped([r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING],()=>(u,s,c)=>(0,r.string)(an.replace(u,s,c))).set([r.TypeURL.RDF_LANG_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING],()=>([u,s,c])=>{const l=an.replace(u.typedValue,s.typedValue,c.typedValue);return(0,r.langString)(l,u.language)}).onQuaternaryTyped([r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING],()=>(u,s,c,l)=>(0,r.string)(an.replace(u,s,c,l))).set([r.TypeURL.RDF_LANG_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING,r.TypeURL.XSD_STRING],()=>([u,s,c,l])=>{const d=an.replace(u.typedValue,s.typedValue,c.typedValue,l.typedValue);return(0,r.langString)(d,u.language)}).collect()})}static replace(u,s,c,l=""){return l=n.TermFunctionRegex.cleanFlags(l),l.includes("x")&&(s=n.TermFunctionRegex.flagX(s)),l.includes("q")?s=n.TermFunctionRegex.flagQ(s):c=c.replaceAll("$0",()=>"$&"),l=`${l.replaceAll(/[qx]/gu,"")}g`,u.replaceAll(new RegExp(s,l),c)}};return TermFunctionReplace.TermFunctionReplace=a,TermFunctionReplace}var hasRequiredActorFunctionFactoryTermReplace;function requireActorFunctionFactoryTermReplace(){if(hasRequiredActorFunctionFactoryTermReplace)return ActorFunctionFactoryTermReplace;hasRequiredActorFunctionFactoryTermReplace=1,Object.defineProperty(ActorFunctionFactoryTermReplace,"__esModule",{value:!0}),ActorFunctionFactoryTermReplace.ActorFunctionFactoryTermReplace=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionReplace();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.REPLACE],termFunction:!0})}async run(u){return new r.TermFunctionReplace}};return ActorFunctionFactoryTermReplace.ActorFunctionFactoryTermReplace=a,ActorFunctionFactoryTermReplace}var hasRequiredLib$2q;function requireLib$2q(){return hasRequiredLib$2q||(hasRequiredLib$2q=1,function(n){var t=lib$2q&&lib$2q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2q&&lib$2q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermReplace(),n)}(lib$2q)),lib$2q}var lib$2p={},ActorFunctionFactoryTermRound={},TermFunctionRound={},hasRequiredTermFunctionRound;function requireTermFunctionRound(){if(hasRequiredTermFunctionRound)return TermFunctionRound;hasRequiredTermFunctionRound=1,Object.defineProperty(TermFunctionRound,"__esModule",{value:!0}),TermFunctionRound.TermFunctionRound=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.ROUND,overloads:(0,t.declare)(t.SparqlOperator.ROUND).numericConverter(()=>o=>Math.round(o)).collect()})}};return TermFunctionRound.TermFunctionRound=r,TermFunctionRound}var hasRequiredActorFunctionFactoryTermRound;function requireActorFunctionFactoryTermRound(){if(hasRequiredActorFunctionFactoryTermRound)return ActorFunctionFactoryTermRound;hasRequiredActorFunctionFactoryTermRound=1,Object.defineProperty(ActorFunctionFactoryTermRound,"__esModule",{value:!0}),ActorFunctionFactoryTermRound.ActorFunctionFactoryTermRound=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionRound();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.ROUND],termFunction:!0})}async run(u){return new r.TermFunctionRound}};return ActorFunctionFactoryTermRound.ActorFunctionFactoryTermRound=a,ActorFunctionFactoryTermRound}var hasRequiredLib$2p;function requireLib$2p(){return hasRequiredLib$2p||(hasRequiredLib$2p=1,function(n){var t=lib$2p&&lib$2p.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2p&&lib$2p.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermRound(),n)}(lib$2p)),lib$2p}var lib$2o={},ActorFunctionFactoryTermSeconds={},TermFunctionSeconds={},hasRequiredTermFunctionSeconds;function requireTermFunctionSeconds(){if(hasRequiredTermFunctionSeconds)return TermFunctionSeconds;hasRequiredTermFunctionSeconds=1,Object.defineProperty(TermFunctionSeconds,"__esModule",{value:!0}),TermFunctionSeconds.TermFunctionSeconds=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SECONDS,overloads:(0,t.declare)(t.SparqlOperator.SECONDS).onDateTime1(()=>o=>(0,t.decimal)(o.typedValue.seconds)).set([t.TypeURL.XSD_TIME],()=>([o])=>(0,t.integer)(o.typedValue.seconds)).collect()})}};return TermFunctionSeconds.TermFunctionSeconds=r,TermFunctionSeconds}var hasRequiredActorFunctionFactoryTermSeconds;function requireActorFunctionFactoryTermSeconds(){if(hasRequiredActorFunctionFactoryTermSeconds)return ActorFunctionFactoryTermSeconds;hasRequiredActorFunctionFactoryTermSeconds=1,Object.defineProperty(ActorFunctionFactoryTermSeconds,"__esModule",{value:!0}),ActorFunctionFactoryTermSeconds.ActorFunctionFactoryTermSeconds=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSeconds();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SECONDS],termFunction:!0})}async run(u){return new r.TermFunctionSeconds}};return ActorFunctionFactoryTermSeconds.ActorFunctionFactoryTermSeconds=a,ActorFunctionFactoryTermSeconds}var hasRequiredLib$2o;function requireLib$2o(){return hasRequiredLib$2o||(hasRequiredLib$2o=1,function(n){var t=lib$2o&&lib$2o.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2o&&lib$2o.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSeconds(),n)}(lib$2o)),lib$2o}var lib$2n={},ActorFunctionFactoryTermSha256={},TermFunctionSha256={},hasRequiredTermFunctionSha256;function requireTermFunctionSha256(){if(hasRequiredTermFunctionSha256)return TermFunctionSha256;hasRequiredTermFunctionSha256=1,Object.defineProperty(TermFunctionSha256,"__esModule",{value:!0}),TermFunctionSha256.TermFunctionSha256=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireHash();let a=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SHA256,overloads:(0,t.declare)(t.SparqlOperator.SHA256).onString1Typed(()=>u=>(0,t.string)((0,r.sha256)().update(u).digest("hex"))).collect()})}};return TermFunctionSha256.TermFunctionSha256=a,TermFunctionSha256}var hasRequiredActorFunctionFactoryTermSha256;function requireActorFunctionFactoryTermSha256(){if(hasRequiredActorFunctionFactoryTermSha256)return ActorFunctionFactoryTermSha256;hasRequiredActorFunctionFactoryTermSha256=1,Object.defineProperty(ActorFunctionFactoryTermSha256,"__esModule",{value:!0}),ActorFunctionFactoryTermSha256.ActorFunctionFactoryTermSha256=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSha256();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SHA256],termFunction:!0})}async run(u){return new r.TermFunctionSha256}};return ActorFunctionFactoryTermSha256.ActorFunctionFactoryTermSha256=a,ActorFunctionFactoryTermSha256}var hasRequiredLib$2n;function requireLib$2n(){return hasRequiredLib$2n||(hasRequiredLib$2n=1,function(n){var t=lib$2n&&lib$2n.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2n&&lib$2n.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSha256(),n)}(lib$2n)),lib$2n}var lib$2m={},ActorFunctionFactoryTermSha1={},TermFunctionSha1={},hasRequiredTermFunctionSha1;function requireTermFunctionSha1(){if(hasRequiredTermFunctionSha1)return TermFunctionSha1;hasRequiredTermFunctionSha1=1,Object.defineProperty(TermFunctionSha1,"__esModule",{value:!0}),TermFunctionSha1.TermFunctionSha1=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireHash();let a=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SHA1,overloads:(0,t.declare)(t.SparqlOperator.SHA1).onString1Typed(()=>u=>(0,t.string)((0,r.sha1)().update(u).digest("hex"))).collect()})}};return TermFunctionSha1.TermFunctionSha1=a,TermFunctionSha1}var hasRequiredActorFunctionFactoryTermSha1;function requireActorFunctionFactoryTermSha1(){if(hasRequiredActorFunctionFactoryTermSha1)return ActorFunctionFactoryTermSha1;hasRequiredActorFunctionFactoryTermSha1=1,Object.defineProperty(ActorFunctionFactoryTermSha1,"__esModule",{value:!0}),ActorFunctionFactoryTermSha1.ActorFunctionFactoryTermSha1=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSha1();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SHA1],termFunction:!0})}async run(u){return new r.TermFunctionSha1}};return ActorFunctionFactoryTermSha1.ActorFunctionFactoryTermSha1=a,ActorFunctionFactoryTermSha1}var hasRequiredLib$2m;function requireLib$2m(){return hasRequiredLib$2m||(hasRequiredLib$2m=1,function(n){var t=lib$2m&&lib$2m.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2m&&lib$2m.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSha1(),n)}(lib$2m)),lib$2m}var lib$2l={},ActorFunctionFactoryTermSha384={},TermFunctionSha384={},hasRequiredTermFunctionSha384;function requireTermFunctionSha384(){if(hasRequiredTermFunctionSha384)return TermFunctionSha384;hasRequiredTermFunctionSha384=1,Object.defineProperty(TermFunctionSha384,"__esModule",{value:!0}),TermFunctionSha384.TermFunctionSha384=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireHash();let a=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SHA384,overloads:(0,t.declare)(t.SparqlOperator.SHA384).onString1Typed(()=>u=>(0,t.string)((0,r.sha384)().update(u).digest("hex"))).collect()})}};return TermFunctionSha384.TermFunctionSha384=a,TermFunctionSha384}var hasRequiredActorFunctionFactoryTermSha384;function requireActorFunctionFactoryTermSha384(){if(hasRequiredActorFunctionFactoryTermSha384)return ActorFunctionFactoryTermSha384;hasRequiredActorFunctionFactoryTermSha384=1,Object.defineProperty(ActorFunctionFactoryTermSha384,"__esModule",{value:!0}),ActorFunctionFactoryTermSha384.ActorFunctionFactoryTermSha384=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSha384();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SHA384],termFunction:!0})}async run(u){return new r.TermFunctionSha384}};return ActorFunctionFactoryTermSha384.ActorFunctionFactoryTermSha384=a,ActorFunctionFactoryTermSha384}var hasRequiredLib$2l;function requireLib$2l(){return hasRequiredLib$2l||(hasRequiredLib$2l=1,function(n){var t=lib$2l&&lib$2l.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2l&&lib$2l.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSha384(),n)}(lib$2l)),lib$2l}var lib$2k={},ActorFunctionFactoryTermSha512={},TermFunctionSha512={},hasRequiredTermFunctionSha512;function requireTermFunctionSha512(){if(hasRequiredTermFunctionSha512)return TermFunctionSha512;hasRequiredTermFunctionSha512=1,Object.defineProperty(TermFunctionSha512,"__esModule",{value:!0}),TermFunctionSha512.TermFunctionSha512=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireHash();let a=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SHA512,overloads:(0,t.declare)(t.SparqlOperator.SHA512).onString1Typed(()=>u=>(0,t.string)((0,r.sha512)().update(u).digest("hex"))).collect()})}};return TermFunctionSha512.TermFunctionSha512=a,TermFunctionSha512}var hasRequiredActorFunctionFactoryTermSha512;function requireActorFunctionFactoryTermSha512(){if(hasRequiredActorFunctionFactoryTermSha512)return ActorFunctionFactoryTermSha512;hasRequiredActorFunctionFactoryTermSha512=1,Object.defineProperty(ActorFunctionFactoryTermSha512,"__esModule",{value:!0}),ActorFunctionFactoryTermSha512.ActorFunctionFactoryTermSha512=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSha512();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SHA512],termFunction:!0})}async run(u){return new r.TermFunctionSha512}};return ActorFunctionFactoryTermSha512.ActorFunctionFactoryTermSha512=a,ActorFunctionFactoryTermSha512}var hasRequiredLib$2k;function requireLib$2k(){return hasRequiredLib$2k||(hasRequiredLib$2k=1,function(n){var t=lib$2k&&lib$2k.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2k&&lib$2k.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSha512(),n)}(lib$2k)),lib$2k}var lib$2j={},ActorFunctionFactoryTermStrAfter={},TermFunctionStrAfter={},hasRequiredTermFunctionStrAfter;function requireTermFunctionStrAfter(){if(hasRequiredTermFunctionStrAfter)return TermFunctionStrAfter;hasRequiredTermFunctionStrAfter=1,Object.defineProperty(TermFunctionStrAfter,"__esModule",{value:!0}),TermFunctionStrAfter.TermFunctionStrAfter=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.STRAFTER,overloads:(0,t.declare)(t.SparqlOperator.STRAFTER).onBinaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.string)(o.slice(o.indexOf(u)).slice(u.length))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>{const[s,c]=[o.typedValue,u.typedValue],l=s.slice(s.indexOf(c)).slice(c.length);return l||!c?(0,t.langString)(l,o.language):(0,t.string)(l)}).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.RDF_LANG_STRING],()=>(o,u)=>{if(o.language!==u.language)throw new t.IncompatibleLanguageOperation(o,u);const[s,c]=[o.typedValue,u.typedValue],l=s.slice(s.indexOf(c)).slice(c.length);return l||!c?(0,t.langString)(l,o.language):(0,t.string)(l)}).collect()})}};return TermFunctionStrAfter.TermFunctionStrAfter=r,TermFunctionStrAfter}var hasRequiredActorFunctionFactoryTermStrAfter;function requireActorFunctionFactoryTermStrAfter(){if(hasRequiredActorFunctionFactoryTermStrAfter)return ActorFunctionFactoryTermStrAfter;hasRequiredActorFunctionFactoryTermStrAfter=1,Object.defineProperty(ActorFunctionFactoryTermStrAfter,"__esModule",{value:!0}),ActorFunctionFactoryTermStrAfter.ActorFunctionFactoryTermStrAfter=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrAfter();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRAFTER],termFunction:!0})}async run(u){return new r.TermFunctionStrAfter}};return ActorFunctionFactoryTermStrAfter.ActorFunctionFactoryTermStrAfter=a,ActorFunctionFactoryTermStrAfter}var hasRequiredLib$2j;function requireLib$2j(){return hasRequiredLib$2j||(hasRequiredLib$2j=1,function(n){var t=lib$2j&&lib$2j.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2j&&lib$2j.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrAfter(),n)}(lib$2j)),lib$2j}var lib$2i={},ActorFunctionFactoryTermStrBefore={},TermFunctionStrBefore={},hasRequiredTermFunctionStrBefore;function requireTermFunctionStrBefore(){if(hasRequiredTermFunctionStrBefore)return TermFunctionStrBefore;hasRequiredTermFunctionStrBefore=1,Object.defineProperty(TermFunctionStrBefore,"__esModule",{value:!0}),TermFunctionStrBefore.TermFunctionStrBefore=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.STRBEFORE,overloads:(0,t.declare)(t.SparqlOperator.STRBEFORE).onBinaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.string)(o.slice(0,Math.max(0,o.indexOf(u))))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>{const[s,c]=[o.typedValue,u.typedValue],l=o.typedValue.slice(0,Math.max(0,s.indexOf(c)));return l||!c?(0,t.langString)(l,o.language):(0,t.string)(l)}).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.RDF_LANG_STRING],()=>(o,u)=>{if(o.language!==u.language)throw new t.IncompatibleLanguageOperation(o,u);const[s,c]=[o.typedValue,u.typedValue],l=o.typedValue.slice(0,Math.max(0,s.indexOf(c)));return l||!c?(0,t.langString)(l,o.language):(0,t.string)(l)}).collect()})}};return TermFunctionStrBefore.TermFunctionStrBefore=r,TermFunctionStrBefore}var hasRequiredActorFunctionFactoryTermStrBefore;function requireActorFunctionFactoryTermStrBefore(){if(hasRequiredActorFunctionFactoryTermStrBefore)return ActorFunctionFactoryTermStrBefore;hasRequiredActorFunctionFactoryTermStrBefore=1,Object.defineProperty(ActorFunctionFactoryTermStrBefore,"__esModule",{value:!0}),ActorFunctionFactoryTermStrBefore.ActorFunctionFactoryTermStrBefore=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrBefore();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRBEFORE],termFunction:!0})}async run(u){return new r.TermFunctionStrBefore}};return ActorFunctionFactoryTermStrBefore.ActorFunctionFactoryTermStrBefore=a,ActorFunctionFactoryTermStrBefore}var hasRequiredLib$2i;function requireLib$2i(){return hasRequiredLib$2i||(hasRequiredLib$2i=1,function(n){var t=lib$2i&&lib$2i.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2i&&lib$2i.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrBefore(),n)}(lib$2i)),lib$2i}var lib$2h={},ActorFunctionFactoryTermStrDt={},TermFunctionStrDt={},hasRequiredTermFunctionStrDt;function requireTermFunctionStrDt(){if(hasRequiredTermFunctionStrDt)return TermFunctionStrDt;hasRequiredTermFunctionStrDt=1,Object.defineProperty(TermFunctionStrDt,"__esModule",{value:!0}),TermFunctionStrDt.TermFunctionStrDt=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:r.SparqlOperator.STRDT,overloads:(0,r.declare)(r.SparqlOperator.STRDT).set([r.TypeURL.XSD_STRING,"namedNode"],u=>([s,c])=>{const l=u.context.getSafe(t.KeysInitQuery.dataFactory),d=l.literal(s.typedValue,l.namedNode(c.value));return new r.TermTransformer(u.context.getSafe(t.KeysExpressionEvaluator.superTypeProvider)).transformLiteral(d)}).collect()})}};return TermFunctionStrDt.TermFunctionStrDt=a,TermFunctionStrDt}var hasRequiredActorFunctionFactoryTermStrDt;function requireActorFunctionFactoryTermStrDt(){if(hasRequiredActorFunctionFactoryTermStrDt)return ActorFunctionFactoryTermStrDt;hasRequiredActorFunctionFactoryTermStrDt=1,Object.defineProperty(ActorFunctionFactoryTermStrDt,"__esModule",{value:!0}),ActorFunctionFactoryTermStrDt.ActorFunctionFactoryTermStrDt=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrDt();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRDT],termFunction:!0})}async run(u){return new r.TermFunctionStrDt}};return ActorFunctionFactoryTermStrDt.ActorFunctionFactoryTermStrDt=a,ActorFunctionFactoryTermStrDt}var hasRequiredLib$2h;function requireLib$2h(){return hasRequiredLib$2h||(hasRequiredLib$2h=1,function(n){var t=lib$2h&&lib$2h.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2h&&lib$2h.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrDt(),n)}(lib$2h)),lib$2h}var lib$2g={},ActorFunctionFactoryTermStrEnds={},TermFunctionStrEnds={},hasRequiredTermFunctionStrEnds;function requireTermFunctionStrEnds(){if(hasRequiredTermFunctionStrEnds)return TermFunctionStrEnds;hasRequiredTermFunctionStrEnds=1,Object.defineProperty(TermFunctionStrEnds,"__esModule",{value:!0}),TermFunctionStrEnds.TermFunctionStrEnds=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.STRENDS,overloads:(0,t.declare)(t.SparqlOperator.STRENDS).onBinaryTyped([t.TypeAlias.SPARQL_STRINGLY,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.bool)(o.endsWith(u))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.RDF_LANG_STRING],()=>(o,u)=>{if(o.language!==u.language)throw new t.IncompatibleLanguageOperation(o,u);return(0,t.bool)(o.typedValue.endsWith(u.typedValue))}).collect()})}};return TermFunctionStrEnds.TermFunctionStrEnds=r,TermFunctionStrEnds}var hasRequiredActorFunctionFactoryTermStrEnds;function requireActorFunctionFactoryTermStrEnds(){if(hasRequiredActorFunctionFactoryTermStrEnds)return ActorFunctionFactoryTermStrEnds;hasRequiredActorFunctionFactoryTermStrEnds=1,Object.defineProperty(ActorFunctionFactoryTermStrEnds,"__esModule",{value:!0}),ActorFunctionFactoryTermStrEnds.ActorFunctionFactoryTermStrEnds=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrEnds();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRENDS],termFunction:!0})}async run(u){return new r.TermFunctionStrEnds}};return ActorFunctionFactoryTermStrEnds.ActorFunctionFactoryTermStrEnds=a,ActorFunctionFactoryTermStrEnds}var hasRequiredLib$2g;function requireLib$2g(){return hasRequiredLib$2g||(hasRequiredLib$2g=1,function(n){var t=lib$2g&&lib$2g.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2g&&lib$2g.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrEnds(),n)}(lib$2g)),lib$2g}var lib$2f={},ActorFunctionFactoryTermStrLang={},TermFunctionStrLang={},hasRequiredTermFunctionStrLang;function requireTermFunctionStrLang(){if(hasRequiredTermFunctionStrLang)return TermFunctionStrLang;hasRequiredTermFunctionStrLang=1,Object.defineProperty(TermFunctionStrLang,"__esModule",{value:!0}),TermFunctionStrLang.TermFunctionStrLang=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.STRLANG,overloads:(0,t.declare)(t.SparqlOperator.STRLANG).onBinaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_STRING],()=>(o,u)=>new t.LangStringLiteral(o,u.toLowerCase())).collect()})}};return TermFunctionStrLang.TermFunctionStrLang=r,TermFunctionStrLang}var hasRequiredActorFunctionFactoryTermStrLang;function requireActorFunctionFactoryTermStrLang(){if(hasRequiredActorFunctionFactoryTermStrLang)return ActorFunctionFactoryTermStrLang;hasRequiredActorFunctionFactoryTermStrLang=1,Object.defineProperty(ActorFunctionFactoryTermStrLang,"__esModule",{value:!0}),ActorFunctionFactoryTermStrLang.ActorFunctionFactoryTermStrLang=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrLang();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRLANG],termFunction:!0})}async run(u){return new r.TermFunctionStrLang}};return ActorFunctionFactoryTermStrLang.ActorFunctionFactoryTermStrLang=a,ActorFunctionFactoryTermStrLang}var hasRequiredLib$2f;function requireLib$2f(){return hasRequiredLib$2f||(hasRequiredLib$2f=1,function(n){var t=lib$2f&&lib$2f.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2f&&lib$2f.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrLang(),n)}(lib$2f)),lib$2f}var lib$2e={},ActorFunctionFactoryTermStrLen={},TermFunctionStrLen={},hasRequiredTermFunctionStrLen;function requireTermFunctionStrLen(){if(hasRequiredTermFunctionStrLen)return TermFunctionStrLen;hasRequiredTermFunctionStrLen=1,Object.defineProperty(TermFunctionStrLen,"__esModule",{value:!0}),TermFunctionStrLen.TermFunctionStrLen=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.STRLEN,overloads:(0,t.declare)(t.SparqlOperator.STRLEN).onStringly1(()=>o=>(0,t.integer)([...o.typedValue].length)).collect()})}};return TermFunctionStrLen.TermFunctionStrLen=r,TermFunctionStrLen}var hasRequiredActorFunctionFactoryTermStrLen;function requireActorFunctionFactoryTermStrLen(){if(hasRequiredActorFunctionFactoryTermStrLen)return ActorFunctionFactoryTermStrLen;hasRequiredActorFunctionFactoryTermStrLen=1,Object.defineProperty(ActorFunctionFactoryTermStrLen,"__esModule",{value:!0}),ActorFunctionFactoryTermStrLen.ActorFunctionFactoryTermStrLen=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrLen();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRLEN],termFunction:!0})}async run(u){return new r.TermFunctionStrLen}};return ActorFunctionFactoryTermStrLen.ActorFunctionFactoryTermStrLen=a,ActorFunctionFactoryTermStrLen}var hasRequiredLib$2e;function requireLib$2e(){return hasRequiredLib$2e||(hasRequiredLib$2e=1,function(n){var t=lib$2e&&lib$2e.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2e&&lib$2e.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrLen(),n)}(lib$2e)),lib$2e}var lib$2d={},ActorFunctionFactoryTermStrStarts={},TermFunctionStrStarts={},hasRequiredTermFunctionStrStarts;function requireTermFunctionStrStarts(){if(hasRequiredTermFunctionStrStarts)return TermFunctionStrStarts;hasRequiredTermFunctionStrStarts=1,Object.defineProperty(TermFunctionStrStarts,"__esModule",{value:!0}),TermFunctionStrStarts.TermFunctionStrStarts=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:t.SparqlOperator.STRSTARTS,overloads:(0,t.declare)(t.SparqlOperator.STRSTARTS).onBinaryTyped([t.TypeAlias.SPARQL_STRINGLY,t.TypeURL.XSD_STRING],()=>(o,u)=>(0,t.bool)(o.startsWith(u))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.RDF_LANG_STRING],()=>(o,u)=>{if(o.language!==u.language)throw new t.IncompatibleLanguageOperation(o,u);return(0,t.bool)(o.typedValue.startsWith(u.typedValue))}).collect()})}};return TermFunctionStrStarts.TermFunctionStrStarts=r,TermFunctionStrStarts}var hasRequiredActorFunctionFactoryTermStrStarts;function requireActorFunctionFactoryTermStrStarts(){if(hasRequiredActorFunctionFactoryTermStrStarts)return ActorFunctionFactoryTermStrStarts;hasRequiredActorFunctionFactoryTermStrStarts=1,Object.defineProperty(ActorFunctionFactoryTermStrStarts,"__esModule",{value:!0}),ActorFunctionFactoryTermStrStarts.ActorFunctionFactoryTermStrStarts=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrStarts();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRSTARTS],termFunction:!0})}async run(u){return new r.TermFunctionStrStarts}};return ActorFunctionFactoryTermStrStarts.ActorFunctionFactoryTermStrStarts=a,ActorFunctionFactoryTermStrStarts}var hasRequiredLib$2d;function requireLib$2d(){return hasRequiredLib$2d||(hasRequiredLib$2d=1,function(n){var t=lib$2d&&lib$2d.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2d&&lib$2d.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrStarts(),n)}(lib$2d)),lib$2d}var lib$2c={},ActorFunctionFactoryTermStrUuid={},TermFunctionStrUuid={},cjsBrowser={},max$1={},hasRequiredMax;function requireMax(){return hasRequiredMax||(hasRequiredMax=1,Object.defineProperty(max$1,"__esModule",{value:!0}),max$1.default="ffffffff-ffff-ffff-ffff-ffffffffffff"),max$1}var nil={},hasRequiredNil;function requireNil(){return hasRequiredNil||(hasRequiredNil=1,Object.defineProperty(nil,"__esModule",{value:!0}),nil.default="00000000-0000-0000-0000-000000000000"),nil}var parse$2={},validate={},regex={},hasRequiredRegex;function requireRegex(){return hasRequiredRegex||(hasRequiredRegex=1,Object.defineProperty(regex,"__esModule",{value:!0}),regex.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i),regex}var hasRequiredValidate;function requireValidate(){if(hasRequiredValidate)return validate;hasRequiredValidate=1,Object.defineProperty(validate,"__esModule",{value:!0});const n=requireRegex();function t(r){return typeof r=="string"&&n.default.test(r)}return validate.default=t,validate}var hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse$2;hasRequiredParse=1,Object.defineProperty(parse$2,"__esModule",{value:!0});const n=requireValidate();function t(r){if(!(0,n.default)(r))throw TypeError("Invalid UUID");let a;return Uint8Array.of((a=parseInt(r.slice(0,8),16))>>>24,a>>>16&255,a>>>8&255,a&255,(a=parseInt(r.slice(9,13),16))>>>8,a&255,(a=parseInt(r.slice(14,18),16))>>>8,a&255,(a=parseInt(r.slice(19,23),16))>>>8,a&255,(a=parseInt(r.slice(24,36),16))/1099511627776&255,a/4294967296&255,a>>>24&255,a>>>16&255,a>>>8&255,a&255)}return parse$2.default=t,parse$2}var stringify={},hasRequiredStringify;function requireStringify(){if(hasRequiredStringify)return stringify;hasRequiredStringify=1,Object.defineProperty(stringify,"__esModule",{value:!0}),stringify.unsafeStringify=void 0;const n=requireValidate(),t=[];for(let o=0;o<256;++o)t.push((o+256).toString(16).slice(1));function r(o,u=0){return(t[o[u+0]]+t[o[u+1]]+t[o[u+2]]+t[o[u+3]]+"-"+t[o[u+4]]+t[o[u+5]]+"-"+t[o[u+6]]+t[o[u+7]]+"-"+t[o[u+8]]+t[o[u+9]]+"-"+t[o[u+10]]+t[o[u+11]]+t[o[u+12]]+t[o[u+13]]+t[o[u+14]]+t[o[u+15]]).toLowerCase()}stringify.unsafeStringify=r;function a(o,u=0){const s=r(o,u);if(!(0,n.default)(s))throw TypeError("Stringified UUID is invalid");return s}return stringify.default=a,stringify}var v1$1={},rng={},hasRequiredRng;function requireRng(){if(hasRequiredRng)return rng;hasRequiredRng=1,Object.defineProperty(rng,"__esModule",{value:!0});let n;const t=new Uint8Array(16);function r(){if(!n){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(t)}return rng.default=r,rng}var hasRequiredV1;function requireV1(){if(hasRequiredV1)return v1$1;hasRequiredV1=1,Object.defineProperty(v1$1,"__esModule",{value:!0}),v1$1.updateV1State=void 0;const n=requireRng(),t=requireStringify(),r={};function a(s,c,l){var h;let d;const f=(s==null?void 0:s._v6)??!1;if(s){const v=Object.keys(s);v.length===1&&v[0]==="_v6"&&(s=void 0)}if(s)d=u(s.random??((h=s.rng)==null?void 0:h.call(s))??(0,n.default)(),s.msecs,s.nsecs,s.clockseq,s.node,c,l);else{const v=Date.now(),g=(0,n.default)();o(r,v,g),d=u(g,r.msecs,r.nsecs,f?void 0:r.clockseq,f?void 0:r.node,c,l)}return c??(0,t.unsafeStringify)(d)}function o(s,c,l){return s.msecs??(s.msecs=-1/0),s.nsecs??(s.nsecs=0),c===s.msecs?(s.nsecs++,s.nsecs>=1e4&&(s.node=void 0,s.nsecs=0)):c>s.msecs?s.nsecs=0:c<s.msecs&&(s.node=void 0),s.node||(s.node=l.slice(10,16),s.node[0]|=1,s.clockseq=(l[8]<<8|l[9])&16383),s.msecs=c,s}v1$1.updateV1State=o;function u(s,c,l,d,f,h,v=0){if(s.length<16)throw new Error("Random bytes length must be >= 16");if(!h)h=new Uint8Array(16),v=0;else if(v<0||v+16>h.length)throw new RangeError(`UUID byte range ${v}:${v+15} is out of buffer bounds`);c??(c=Date.now()),l??(l=0),d??(d=(s[8]<<8|s[9])&16383),f??(f=s.slice(10,16)),c+=122192928e5;const g=((c&268435455)*1e4+l)%4294967296;h[v++]=g>>>24&255,h[v++]=g>>>16&255,h[v++]=g>>>8&255,h[v++]=g&255;const b=c/4294967296*1e4&268435455;h[v++]=b>>>8&255,h[v++]=b&255,h[v++]=b>>>24&15|16,h[v++]=b>>>16&255,h[v++]=d>>>8|128,h[v++]=d&255;for(let _=0;_<6;++_)h[v++]=f[_];return h}return v1$1.default=a,v1$1}var v1ToV6={},hasRequiredV1ToV6;function requireV1ToV6(){if(hasRequiredV1ToV6)return v1ToV6;hasRequiredV1ToV6=1,Object.defineProperty(v1ToV6,"__esModule",{value:!0});const n=requireParse(),t=requireStringify();function r(o){const u=typeof o=="string"?(0,n.default)(o):o,s=a(u);return typeof o=="string"?(0,t.unsafeStringify)(s):s}v1ToV6.default=r;function a(o){return Uint8Array.of((o[6]&15)<<4|o[7]>>4&15,(o[7]&15)<<4|(o[4]&240)>>4,(o[4]&15)<<4|(o[5]&240)>>4,(o[5]&15)<<4|(o[0]&240)>>4,(o[0]&15)<<4|(o[1]&240)>>4,(o[1]&15)<<4|(o[2]&240)>>4,96|o[2]&15,o[3],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])}return v1ToV6}var v3={},md5={},hasRequiredMd5;function requireMd5(){if(hasRequiredMd5)return md5;hasRequiredMd5=1,Object.defineProperty(md5,"__esModule",{value:!0});function n(v){const g=o(v),b=a(g,v.length*8);return t(b)}function t(v){const g=new Uint8Array(v.length*4);for(let b=0;b<v.length*4;b++)g[b]=v[b>>2]>>>b%4*8&255;return g}function r(v){return(v+64>>>9<<4)+14+1}function a(v,g){const b=new Uint32Array(r(g)).fill(0);b.set(v),b[g>>5]|=128<<g%32,b[b.length-1]=g,v=b;let _=1732584193,S=-271733879,T=-1732584194,w=271733878;for(let A=0;A<v.length;A+=16){const R=_,E=S,I=T,L=w;_=l(_,S,T,w,v[A],7,-680876936),w=l(w,_,S,T,v[A+1],12,-389564586),T=l(T,w,_,S,v[A+2],17,606105819),S=l(S,T,w,_,v[A+3],22,-1044525330),_=l(_,S,T,w,v[A+4],7,-176418897),w=l(w,_,S,T,v[A+5],12,1200080426),T=l(T,w,_,S,v[A+6],17,-1473231341),S=l(S,T,w,_,v[A+7],22,-45705983),_=l(_,S,T,w,v[A+8],7,1770035416),w=l(w,_,S,T,v[A+9],12,-1958414417),T=l(T,w,_,S,v[A+10],17,-42063),S=l(S,T,w,_,v[A+11],22,-1990404162),_=l(_,S,T,w,v[A+12],7,1804603682),w=l(w,_,S,T,v[A+13],12,-40341101),T=l(T,w,_,S,v[A+14],17,-1502002290),S=l(S,T,w,_,v[A+15],22,1236535329),_=d(_,S,T,w,v[A+1],5,-165796510),w=d(w,_,S,T,v[A+6],9,-1069501632),T=d(T,w,_,S,v[A+11],14,643717713),S=d(S,T,w,_,v[A],20,-373897302),_=d(_,S,T,w,v[A+5],5,-701558691),w=d(w,_,S,T,v[A+10],9,38016083),T=d(T,w,_,S,v[A+15],14,-660478335),S=d(S,T,w,_,v[A+4],20,-405537848),_=d(_,S,T,w,v[A+9],5,568446438),w=d(w,_,S,T,v[A+14],9,-1019803690),T=d(T,w,_,S,v[A+3],14,-187363961),S=d(S,T,w,_,v[A+8],20,1163531501),_=d(_,S,T,w,v[A+13],5,-1444681467),w=d(w,_,S,T,v[A+2],9,-51403784),T=d(T,w,_,S,v[A+7],14,1735328473),S=d(S,T,w,_,v[A+12],20,-1926607734),_=f(_,S,T,w,v[A+5],4,-378558),w=f(w,_,S,T,v[A+8],11,-2022574463),T=f(T,w,_,S,v[A+11],16,1839030562),S=f(S,T,w,_,v[A+14],23,-35309556),_=f(_,S,T,w,v[A+1],4,-1530992060),w=f(w,_,S,T,v[A+4],11,1272893353),T=f(T,w,_,S,v[A+7],16,-155497632),S=f(S,T,w,_,v[A+10],23,-1094730640),_=f(_,S,T,w,v[A+13],4,681279174),w=f(w,_,S,T,v[A],11,-358537222),T=f(T,w,_,S,v[A+3],16,-722521979),S=f(S,T,w,_,v[A+6],23,76029189),_=f(_,S,T,w,v[A+9],4,-640364487),w=f(w,_,S,T,v[A+12],11,-421815835),T=f(T,w,_,S,v[A+15],16,530742520),S=f(S,T,w,_,v[A+2],23,-995338651),_=h(_,S,T,w,v[A],6,-198630844),w=h(w,_,S,T,v[A+7],10,1126891415),T=h(T,w,_,S,v[A+14],15,-1416354905),S=h(S,T,w,_,v[A+5],21,-57434055),_=h(_,S,T,w,v[A+12],6,1700485571),w=h(w,_,S,T,v[A+3],10,-1894986606),T=h(T,w,_,S,v[A+10],15,-1051523),S=h(S,T,w,_,v[A+1],21,-2054922799),_=h(_,S,T,w,v[A+8],6,1873313359),w=h(w,_,S,T,v[A+15],10,-30611744),T=h(T,w,_,S,v[A+6],15,-1560198380),S=h(S,T,w,_,v[A+13],21,1309151649),_=h(_,S,T,w,v[A+4],6,-145523070),w=h(w,_,S,T,v[A+11],10,-1120210379),T=h(T,w,_,S,v[A+2],15,718787259),S=h(S,T,w,_,v[A+9],21,-343485551),_=u(_,R),S=u(S,E),T=u(T,I),w=u(w,L)}return Uint32Array.of(_,S,T,w)}function o(v){if(v.length===0)return new Uint32Array;const g=new Uint32Array(r(v.length*8)).fill(0);for(let b=0;b<v.length;b++)g[b>>2]|=(v[b]&255)<<b%4*8;return g}function u(v,g){const b=(v&65535)+(g&65535);return(v>>16)+(g>>16)+(b>>16)<<16|b&65535}function s(v,g){return v<<g|v>>>32-g}function c(v,g,b,_,S,T){return u(s(u(u(g,v),u(_,T)),S),b)}function l(v,g,b,_,S,T,w){return c(g&b|~g&_,v,g,S,T,w)}function d(v,g,b,_,S,T,w){return c(g&_|b&~_,v,g,S,T,w)}function f(v,g,b,_,S,T,w){return c(g^b^_,v,g,S,T,w)}function h(v,g,b,_,S,T,w){return c(b^(g|~_),v,g,S,T,w)}return md5.default=n,md5}var v35={},hasRequiredV35;function requireV35(){if(hasRequiredV35)return v35;hasRequiredV35=1,Object.defineProperty(v35,"__esModule",{value:!0}),v35.URL=v35.DNS=v35.stringToBytes=void 0;const n=requireParse(),t=requireStringify();function r(o){o=unescape(encodeURIComponent(o));const u=new Uint8Array(o.length);for(let s=0;s<o.length;++s)u[s]=o.charCodeAt(s);return u}v35.stringToBytes=r,v35.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",v35.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function a(o,u,s,c,l,d){const f=typeof s=="string"?r(s):s,h=typeof c=="string"?(0,n.default)(c):c;if(typeof c=="string"&&(c=(0,n.default)(c)),(c==null?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let v=new Uint8Array(16+f.length);if(v.set(h),v.set(f,h.length),v=u(v),v[6]=v[6]&15|o,v[8]=v[8]&63|128,l){d=d||0;for(let g=0;g<16;++g)l[d+g]=v[g];return l}return(0,t.unsafeStringify)(v)}return v35.default=a,v35}var hasRequiredV3;function requireV3(){return hasRequiredV3||(hasRequiredV3=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.URL=n.DNS=void 0;const t=requireMd5(),r=requireV35();var a=requireV35();Object.defineProperty(n,"DNS",{enumerable:!0,get:function(){return a.DNS}}),Object.defineProperty(n,"URL",{enumerable:!0,get:function(){return a.URL}});function o(u,s,c,l){return(0,r.default)(48,t.default,u,s,c,l)}o.DNS=r.DNS,o.URL=r.URL,n.default=o}(v3)),v3}var v4={},native={},hasRequiredNative;function requireNative(){if(hasRequiredNative)return native;hasRequiredNative=1,Object.defineProperty(native,"__esModule",{value:!0});const n=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);return native.default={randomUUID:n},native}var hasRequiredV4;function requireV4(){if(hasRequiredV4)return v4;hasRequiredV4=1,Object.defineProperty(v4,"__esModule",{value:!0});const n=requireNative(),t=requireRng(),r=requireStringify();function a(o,u,s){var l;if(n.default.randomUUID&&!u&&!o)return n.default.randomUUID();o=o||{};const c=o.random??((l=o.rng)==null?void 0:l.call(o))??(0,t.default)();if(c.length<16)throw new Error("Random bytes length must be >= 16");if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,u){if(s=s||0,s<0||s+16>u.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);for(let d=0;d<16;++d)u[s+d]=c[d];return u}return(0,r.unsafeStringify)(c)}return v4.default=a,v4}var v5={},sha1={},hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1;hasRequiredSha1=1,Object.defineProperty(sha1,"__esModule",{value:!0});function n(a,o,u,s){switch(a){case 0:return o&u^~o&s;case 1:return o^u^s;case 2:return o&u^o&s^u&s;case 3:return o^u^s}}function t(a,o){return a<<o|a>>>32-o}function r(a){const o=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520],s=new Uint8Array(a.length+1);s.set(a),s[a.length]=128,a=s;const c=a.length/4+2,l=Math.ceil(c/16),d=new Array(l);for(let f=0;f<l;++f){const h=new Uint32Array(16);for(let v=0;v<16;++v)h[v]=a[f*64+v*4]<<24|a[f*64+v*4+1]<<16|a[f*64+v*4+2]<<8|a[f*64+v*4+3];d[f]=h}d[l-1][14]=(a.length-1)*8/Math.pow(2,32),d[l-1][14]=Math.floor(d[l-1][14]),d[l-1][15]=(a.length-1)*8&4294967295;for(let f=0;f<l;++f){const h=new Uint32Array(80);for(let T=0;T<16;++T)h[T]=d[f][T];for(let T=16;T<80;++T)h[T]=t(h[T-3]^h[T-8]^h[T-14]^h[T-16],1);let v=u[0],g=u[1],b=u[2],_=u[3],S=u[4];for(let T=0;T<80;++T){const w=Math.floor(T/20),A=t(v,5)+n(w,g,b,_)+S+o[w]+h[T]>>>0;S=_,_=b,b=t(g,30)>>>0,g=v,v=A}u[0]=u[0]+v>>>0,u[1]=u[1]+g>>>0,u[2]=u[2]+b>>>0,u[3]=u[3]+_>>>0,u[4]=u[4]+S>>>0}return Uint8Array.of(u[0]>>24,u[0]>>16,u[0]>>8,u[0],u[1]>>24,u[1]>>16,u[1]>>8,u[1],u[2]>>24,u[2]>>16,u[2]>>8,u[2],u[3]>>24,u[3]>>16,u[3]>>8,u[3],u[4]>>24,u[4]>>16,u[4]>>8,u[4])}return sha1.default=r,sha1}var hasRequiredV5;function requireV5(){return hasRequiredV5||(hasRequiredV5=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.URL=n.DNS=void 0;const t=requireSha1(),r=requireV35();var a=requireV35();Object.defineProperty(n,"DNS",{enumerable:!0,get:function(){return a.DNS}}),Object.defineProperty(n,"URL",{enumerable:!0,get:function(){return a.URL}});function o(u,s,c,l){return(0,r.default)(80,t.default,u,s,c,l)}o.DNS=r.DNS,o.URL=r.URL,n.default=o}(v5)),v5}var v6={},hasRequiredV6;function requireV6(){if(hasRequiredV6)return v6;hasRequiredV6=1,Object.defineProperty(v6,"__esModule",{value:!0});const n=requireStringify(),t=requireV1(),r=requireV1ToV6();function a(o,u,s){o??(o={}),s??(s=0);let c=(0,t.default)({...o,_v6:!0},new Uint8Array(16));if(c=(0,r.default)(c),u){for(let l=0;l<16;l++)u[s+l]=c[l];return u}return(0,n.unsafeStringify)(c)}return v6.default=a,v6}var v6ToV1={},hasRequiredV6ToV1;function requireV6ToV1(){if(hasRequiredV6ToV1)return v6ToV1;hasRequiredV6ToV1=1,Object.defineProperty(v6ToV1,"__esModule",{value:!0});const n=requireParse(),t=requireStringify();function r(o){const u=typeof o=="string"?(0,n.default)(o):o,s=a(u);return typeof o=="string"?(0,t.unsafeStringify)(s):s}v6ToV1.default=r;function a(o){return Uint8Array.of((o[3]&15)<<4|o[4]>>4&15,(o[4]&15)<<4|(o[5]&240)>>4,(o[5]&15)<<4|o[6]&15,o[7],(o[1]&15)<<4|(o[2]&240)>>4,(o[2]&15)<<4|(o[3]&240)>>4,16|(o[0]&240)>>4,(o[0]&15)<<4|(o[1]&240)>>4,o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])}return v6ToV1}var v7={},hasRequiredV7;function requireV7(){if(hasRequiredV7)return v7;hasRequiredV7=1,Object.defineProperty(v7,"__esModule",{value:!0}),v7.updateV7State=void 0;const n=requireRng(),t=requireStringify(),r={};function a(s,c,l){var f;let d;if(s)d=u(s.random??((f=s.rng)==null?void 0:f.call(s))??(0,n.default)(),s.msecs,s.seq,c,l);else{const h=Date.now(),v=(0,n.default)();o(r,h,v),d=u(v,r.msecs,r.seq,c,l)}return c??(0,t.unsafeStringify)(d)}function o(s,c,l){return s.msecs??(s.msecs=-1/0),s.seq??(s.seq=0),c>s.msecs?(s.seq=l[6]<<23|l[7]<<16|l[8]<<8|l[9],s.msecs=c):(s.seq=s.seq+1|0,s.seq===0&&s.msecs++),s}v7.updateV7State=o;function u(s,c,l,d,f=0){if(s.length<16)throw new Error("Random bytes length must be >= 16");if(!d)d=new Uint8Array(16),f=0;else if(f<0||f+16>d.length)throw new RangeError(`UUID byte range ${f}:${f+15} is out of buffer bounds`);return c??(c=Date.now()),l??(l=s[6]*127<<24|s[7]<<16|s[8]<<8|s[9]),d[f++]=c/1099511627776&255,d[f++]=c/4294967296&255,d[f++]=c/16777216&255,d[f++]=c/65536&255,d[f++]=c/256&255,d[f++]=c&255,d[f++]=112|l>>>28&15,d[f++]=l>>>20&255,d[f++]=128|l>>>14&63,d[f++]=l>>>6&255,d[f++]=l<<2&255|s[10]&3,d[f++]=s[11],d[f++]=s[12],d[f++]=s[13],d[f++]=s[14],d[f++]=s[15],d}return v7.default=a,v7}var version$2={},hasRequiredVersion;function requireVersion(){if(hasRequiredVersion)return version$2;hasRequiredVersion=1,Object.defineProperty(version$2,"__esModule",{value:!0});const n=requireValidate();function t(r){if(!(0,n.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}return version$2.default=t,version$2}var hasRequiredCjsBrowser;function requireCjsBrowser(){return hasRequiredCjsBrowser||(hasRequiredCjsBrowser=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.version=n.validate=n.v7=n.v6ToV1=n.v6=n.v5=n.v4=n.v3=n.v1ToV6=n.v1=n.stringify=n.parse=n.NIL=n.MAX=void 0;var t=requireMax();Object.defineProperty(n,"MAX",{enumerable:!0,get:function(){return t.default}});var r=requireNil();Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return r.default}});var a=requireParse();Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return a.default}});var o=requireStringify();Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return o.default}});var u=requireV1();Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return u.default}});var s=requireV1ToV6();Object.defineProperty(n,"v1ToV6",{enumerable:!0,get:function(){return s.default}});var c=requireV3();Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return c.default}});var l=requireV4();Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return l.default}});var d=requireV5();Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return d.default}});var f=requireV6();Object.defineProperty(n,"v6",{enumerable:!0,get:function(){return f.default}});var h=requireV6ToV1();Object.defineProperty(n,"v6ToV1",{enumerable:!0,get:function(){return h.default}});var v=requireV7();Object.defineProperty(n,"v7",{enumerable:!0,get:function(){return v.default}});var g=requireValidate();Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return g.default}});var b=requireVersion();Object.defineProperty(n,"version",{enumerable:!0,get:function(){return b.default}})}(cjsBrowser)),cjsBrowser}var hasRequiredTermFunctionStrUuid;function requireTermFunctionStrUuid(){if(hasRequiredTermFunctionStrUuid)return TermFunctionStrUuid;hasRequiredTermFunctionStrUuid=1,Object.defineProperty(TermFunctionStrUuid,"__esModule",{value:!0}),TermFunctionStrUuid.TermFunctionStrUuid=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireCjsBrowser();let a=class extends n.TermFunctionBase{constructor(){super({arity:0,operator:t.SparqlOperator.STRUUID,overloads:(0,t.declare)(t.SparqlOperator.STRUUID).set([],()=>()=>(0,t.string)(r.v4())).collect()})}};return TermFunctionStrUuid.TermFunctionStrUuid=a,TermFunctionStrUuid}var hasRequiredActorFunctionFactoryTermStrUuid;function requireActorFunctionFactoryTermStrUuid(){if(hasRequiredActorFunctionFactoryTermStrUuid)return ActorFunctionFactoryTermStrUuid;hasRequiredActorFunctionFactoryTermStrUuid=1,Object.defineProperty(ActorFunctionFactoryTermStrUuid,"__esModule",{value:!0}),ActorFunctionFactoryTermStrUuid.ActorFunctionFactoryTermStrUuid=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStrUuid();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STRUUID],termFunction:!0})}async run(u){return new r.TermFunctionStrUuid}};return ActorFunctionFactoryTermStrUuid.ActorFunctionFactoryTermStrUuid=a,ActorFunctionFactoryTermStrUuid}var hasRequiredLib$2c;function requireLib$2c(){return hasRequiredLib$2c||(hasRequiredLib$2c=1,function(n){var t=lib$2c&&lib$2c.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2c&&lib$2c.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStrUuid(),n)}(lib$2c)),lib$2c}var lib$2b={},ActorFunctionFactoryTermStr={},TermFunctionStr={},hasRequiredTermFunctionStr;function requireTermFunctionStr(){if(hasRequiredTermFunctionStr)return TermFunctionStr;hasRequiredTermFunctionStr=1,Object.defineProperty(TermFunctionStr,"__esModule",{value:!0}),TermFunctionStr.TermFunctionStr=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.STR,overloads:(0,t.declare)(t.SparqlOperator.STR).onTerm1(()=>o=>(0,t.string)(o.str())).collect()})}};return TermFunctionStr.TermFunctionStr=r,TermFunctionStr}var hasRequiredActorFunctionFactoryTermStr;function requireActorFunctionFactoryTermStr(){if(hasRequiredActorFunctionFactoryTermStr)return ActorFunctionFactoryTermStr;hasRequiredActorFunctionFactoryTermStr=1,Object.defineProperty(ActorFunctionFactoryTermStr,"__esModule",{value:!0}),ActorFunctionFactoryTermStr.ActorFunctionFactoryTermStr=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionStr();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.STR],termFunction:!0})}async run(u){return new r.TermFunctionStr}};return ActorFunctionFactoryTermStr.ActorFunctionFactoryTermStr=a,ActorFunctionFactoryTermStr}var hasRequiredLib$2b;function requireLib$2b(){return hasRequiredLib$2b||(hasRequiredLib$2b=1,function(n){var t=lib$2b&&lib$2b.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2b&&lib$2b.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermStr(),n)}(lib$2b)),lib$2b}var lib$2a={},ActorFunctionFactoryTermSubStr={},TermFunctionSubStr={},hasRequiredTermFunctionSubStr;function requireTermFunctionSubStr(){if(hasRequiredTermFunctionSubStr)return TermFunctionSubStr;hasRequiredTermFunctionSubStr=1,Object.defineProperty(TermFunctionSubStr,"__esModule",{value:!0}),TermFunctionSubStr.TermFunctionSubStr=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:[2,3],operator:t.SparqlOperator.SUBSTR,overloads:(0,t.declare)(t.SparqlOperator.SUBSTR).onBinaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_INTEGER],()=>(o,u)=>(0,t.string)([...o].slice(u-1).join(""))).onBinary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.XSD_INTEGER],()=>(o,u)=>{const s=[...o.typedValue].slice(u.typedValue-1).join("");return(0,t.langString)(s,o.language)}).onTernaryTyped([t.TypeURL.XSD_STRING,t.TypeURL.XSD_INTEGER,t.TypeURL.XSD_INTEGER],()=>(o,u,s)=>(0,t.string)([...o].slice(u-1,s+u-1).join(""))).onTernary([t.TypeURL.RDF_LANG_STRING,t.TypeURL.XSD_INTEGER,t.TypeURL.XSD_INTEGER],()=>(o,u,s)=>{const c=[...o.typedValue].slice(u.typedValue-1,s.typedValue+u.typedValue-1).join("");return(0,t.langString)(c,o.language)}).collect()})}};return TermFunctionSubStr.TermFunctionSubStr=r,TermFunctionSubStr}var hasRequiredActorFunctionFactoryTermSubStr;function requireActorFunctionFactoryTermSubStr(){if(hasRequiredActorFunctionFactoryTermSubStr)return ActorFunctionFactoryTermSubStr;hasRequiredActorFunctionFactoryTermSubStr=1,Object.defineProperty(ActorFunctionFactoryTermSubStr,"__esModule",{value:!0}),ActorFunctionFactoryTermSubStr.ActorFunctionFactoryTermSubStr=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSubStr();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SUBSTR],termFunction:!0})}async run(u){return new r.TermFunctionSubStr}};return ActorFunctionFactoryTermSubStr.ActorFunctionFactoryTermSubStr=a,ActorFunctionFactoryTermSubStr}var hasRequiredLib$2a;function requireLib$2a(){return hasRequiredLib$2a||(hasRequiredLib$2a=1,function(n){var t=lib$2a&&lib$2a.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2a&&lib$2a.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSubStr(),n)}(lib$2a)),lib$2a}var lib$29={},ActorFunctionFactoryTermSubject={},TermFunctionSubject={},hasRequiredTermFunctionSubject;function requireTermFunctionSubject(){if(hasRequiredTermFunctionSubject)return TermFunctionSubject;hasRequiredTermFunctionSubject=1,Object.defineProperty(TermFunctionSubject,"__esModule",{value:!0}),TermFunctionSubject.TermFunctionSubject=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.SUBJECT,overloads:(0,t.declare)(t.SparqlOperator.SUBJECT).onQuad1(()=>o=>o.subject).collect()})}};return TermFunctionSubject.TermFunctionSubject=r,TermFunctionSubject}var hasRequiredActorFunctionFactoryTermSubject;function requireActorFunctionFactoryTermSubject(){if(hasRequiredActorFunctionFactoryTermSubject)return ActorFunctionFactoryTermSubject;hasRequiredActorFunctionFactoryTermSubject=1,Object.defineProperty(ActorFunctionFactoryTermSubject,"__esModule",{value:!0}),ActorFunctionFactoryTermSubject.ActorFunctionFactoryTermSubject=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSubject();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SUBJECT],termFunction:!0})}async run(u){return new r.TermFunctionSubject}};return ActorFunctionFactoryTermSubject.ActorFunctionFactoryTermSubject=a,ActorFunctionFactoryTermSubject}var hasRequiredLib$29;function requireLib$29(){return hasRequiredLib$29||(hasRequiredLib$29=1,function(n){var t=lib$29&&lib$29.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$29&&lib$29.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSubject(),n)}(lib$29)),lib$29}var lib$28={},ActorFunctionFactoryTermSubtraction={},TermFunctionSubtraction={},hasRequiredTermFunctionSubtraction;function requireTermFunctionSubtraction(){if(hasRequiredTermFunctionSubtraction)return TermFunctionSubtraction;hasRequiredTermFunctionSubtraction=1,Object.defineProperty(TermFunctionSubtraction,"__esModule",{value:!0}),TermFunctionSubtraction.TermFunctionSubtraction=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n(),a=requireBignumber();let o=class extends n.TermFunctionBase{constructor(){super({arity:2,operator:r.SparqlOperator.SUBTRACTION,overloads:(0,r.declare)(r.SparqlOperator.SUBTRACTION).arithmetic(()=>(s,c)=>new a.BigNumber(s).minus(c).toNumber()).set([r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DATE_TIME],s=>([c,l])=>new r.DayTimeDurationLiteral((0,r.elapsedDuration)(c.typedValue,l.typedValue,s.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)))).copy({from:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DATE_TIME],to:[r.TypeURL.XSD_DATE,r.TypeURL.XSD_DATE]}).copy({from:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DATE_TIME],to:[r.TypeURL.XSD_TIME,r.TypeURL.XSD_TIME]}).set([r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DAY_TIME_DURATION],()=>([s,c])=>new r.DateTimeLiteral((0,r.addDurationToDateTime)(s.typedValue,(0,r.defaultedDurationRepresentation)((0,r.negateDuration)(c.typedValue))))).copy({from:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DAY_TIME_DURATION],to:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([r.TypeURL.XSD_DATE,r.TypeURL.XSD_DAY_TIME_DURATION],()=>([s,c])=>new r.DateLiteral((0,r.addDurationToDateTime)((0,r.defaultedDateTimeRepresentation)(s.typedValue),(0,r.defaultedDurationRepresentation)((0,r.negateDuration)(c.typedValue))))).copy({from:[r.TypeURL.XSD_DATE,r.TypeURL.XSD_DAY_TIME_DURATION],to:[r.TypeURL.XSD_DATE,r.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([r.TypeURL.XSD_TIME,r.TypeURL.XSD_DAY_TIME_DURATION],()=>([s,c])=>new r.TimeLiteral((0,r.addDurationToDateTime)((0,r.defaultedDateTimeRepresentation)(s.typedValue),(0,r.defaultedDurationRepresentation)((0,r.negateDuration)(c.typedValue))))).collect()})}};return TermFunctionSubtraction.TermFunctionSubtraction=o,TermFunctionSubtraction}var hasRequiredActorFunctionFactoryTermSubtraction;function requireActorFunctionFactoryTermSubtraction(){if(hasRequiredActorFunctionFactoryTermSubtraction)return ActorFunctionFactoryTermSubtraction;hasRequiredActorFunctionFactoryTermSubtraction=1,Object.defineProperty(ActorFunctionFactoryTermSubtraction,"__esModule",{value:!0}),ActorFunctionFactoryTermSubtraction.ActorFunctionFactoryTermSubtraction=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionSubtraction();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.SUBTRACTION],termFunction:!0})}async run(u){return new r.TermFunctionSubtraction}};return ActorFunctionFactoryTermSubtraction.ActorFunctionFactoryTermSubtraction=a,ActorFunctionFactoryTermSubtraction}var hasRequiredLib$28;function requireLib$28(){return hasRequiredLib$28||(hasRequiredLib$28=1,function(n){var t=lib$28&&lib$28.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$28&&lib$28.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermSubtraction(),n)}(lib$28)),lib$28}var lib$27={},ActorFunctionFactoryTermTimezone={},TermFunctionTimezone={},hasRequiredTermFunctionTimezone;function requireTermFunctionTimezone(){if(hasRequiredTermFunctionTimezone)return TermFunctionTimezone;hasRequiredTermFunctionTimezone=1,Object.defineProperty(TermFunctionTimezone,"__esModule",{value:!0}),TermFunctionTimezone.TermFunctionTimezone=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.TIMEZONE,overloads:(0,t.declare)(t.SparqlOperator.TIMEZONE).onDateTime1(()=>o=>{const u={hours:o.typedValue.zoneHours,minutes:o.typedValue.zoneMinutes};if(u.hours===void 0&&u.minutes===void 0)throw new t.InvalidTimezoneCall(o.str());return new t.DayTimeDurationLiteral(u)}).copy({from:[t.TypeURL.XSD_DATE_TIME],to:[t.TypeURL.XSD_DATE]}).copy({from:[t.TypeURL.XSD_DATE_TIME],to:[t.TypeURL.XSD_TIME]}).collect()})}};return TermFunctionTimezone.TermFunctionTimezone=r,TermFunctionTimezone}var hasRequiredActorFunctionFactoryTermTimezone;function requireActorFunctionFactoryTermTimezone(){if(hasRequiredActorFunctionFactoryTermTimezone)return ActorFunctionFactoryTermTimezone;hasRequiredActorFunctionFactoryTermTimezone=1,Object.defineProperty(ActorFunctionFactoryTermTimezone,"__esModule",{value:!0}),ActorFunctionFactoryTermTimezone.ActorFunctionFactoryTermTimezone=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionTimezone();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.TIMEZONE],termFunction:!0})}async run(u){return new r.TermFunctionTimezone}};return ActorFunctionFactoryTermTimezone.ActorFunctionFactoryTermTimezone=a,ActorFunctionFactoryTermTimezone}var hasRequiredLib$27;function requireLib$27(){return hasRequiredLib$27||(hasRequiredLib$27=1,function(n){var t=lib$27&&lib$27.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$27&&lib$27.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermTimezone(),n)}(lib$27)),lib$27}var lib$26={},ActorFunctionFactoryTermTriple={},TermFunctionTriple={},hasRequiredTermFunctionTriple;function requireTermFunctionTriple(){if(hasRequiredTermFunctionTriple)return TermFunctionTriple;hasRequiredTermFunctionTriple=1,Object.defineProperty(TermFunctionTriple,"__esModule",{value:!0}),TermFunctionTriple.TermFunctionTriple=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:3,operator:t.SparqlOperator.TRIPLE,overloads:(0,t.declare)(t.SparqlOperator.TRIPLE).onTerm3(o=>(...u)=>new t.Quad(u[0],u[1],u[2],new t.DefaultGraph)).collect()})}};return TermFunctionTriple.TermFunctionTriple=r,TermFunctionTriple}var hasRequiredActorFunctionFactoryTermTriple;function requireActorFunctionFactoryTermTriple(){if(hasRequiredActorFunctionFactoryTermTriple)return ActorFunctionFactoryTermTriple;hasRequiredActorFunctionFactoryTermTriple=1,Object.defineProperty(ActorFunctionFactoryTermTriple,"__esModule",{value:!0}),ActorFunctionFactoryTermTriple.ActorFunctionFactoryTermTriple=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionTriple();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.TRIPLE],termFunction:!0})}async run(u){return new r.TermFunctionTriple}};return ActorFunctionFactoryTermTriple.ActorFunctionFactoryTermTriple=a,ActorFunctionFactoryTermTriple}var hasRequiredLib$26;function requireLib$26(){return hasRequiredLib$26||(hasRequiredLib$26=1,function(n){var t=lib$26&&lib$26.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$26&&lib$26.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermTriple(),n)}(lib$26)),lib$26}var lib$25={},ActorFunctionFactoryTermTz={},TermFunctionTz={},hasRequiredTermFunctionTz;function requireTermFunctionTz(){if(hasRequiredTermFunctionTz)return TermFunctionTz;hasRequiredTermFunctionTz=1,Object.defineProperty(TermFunctionTz,"__esModule",{value:!0}),TermFunctionTz.TermFunctionTz=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.TZ,overloads:(0,t.declare)(t.SparqlOperator.TZ).onDateTime1(()=>o=>(0,t.string)((0,t.extractRawTimeZone)(o.str()))).copy({from:[t.TypeURL.XSD_DATE_TIME],to:[t.TypeURL.XSD_DATE]}).copy({from:[t.TypeURL.XSD_DATE_TIME],to:[t.TypeURL.XSD_TIME]}).collect()})}};return TermFunctionTz.TermFunctionTz=r,TermFunctionTz}var hasRequiredActorFunctionFactoryTermTz;function requireActorFunctionFactoryTermTz(){if(hasRequiredActorFunctionFactoryTermTz)return ActorFunctionFactoryTermTz;hasRequiredActorFunctionFactoryTermTz=1,Object.defineProperty(ActorFunctionFactoryTermTz,"__esModule",{value:!0}),ActorFunctionFactoryTermTz.ActorFunctionFactoryTermTz=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionTz();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.TZ],termFunction:!0})}async run(u){return new r.TermFunctionTz}};return ActorFunctionFactoryTermTz.ActorFunctionFactoryTermTz=a,ActorFunctionFactoryTermTz}var hasRequiredLib$25;function requireLib$25(){return hasRequiredLib$25||(hasRequiredLib$25=1,function(n){var t=lib$25&&lib$25.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$25&&lib$25.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermTz(),n)}(lib$25)),lib$25}var lib$24={},ActorFunctionFactoryTermUcase={},TermFunctionUcase={},hasRequiredTermFunctionUcase;function requireTermFunctionUcase(){if(hasRequiredTermFunctionUcase)return TermFunctionUcase;hasRequiredTermFunctionUcase=1,Object.defineProperty(TermFunctionUcase,"__esModule",{value:!0}),TermFunctionUcase.TermFunctionUcase=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.UCASE,overloads:(0,t.declare)(t.SparqlOperator.UCASE).onString1Typed(()=>o=>(0,t.string)(o.toUpperCase())).onLangString1(()=>o=>(0,t.langString)(o.typedValue.toUpperCase(),o.language)).collect()})}};return TermFunctionUcase.TermFunctionUcase=r,TermFunctionUcase}var hasRequiredActorFunctionFactoryTermUcase;function requireActorFunctionFactoryTermUcase(){if(hasRequiredActorFunctionFactoryTermUcase)return ActorFunctionFactoryTermUcase;hasRequiredActorFunctionFactoryTermUcase=1,Object.defineProperty(ActorFunctionFactoryTermUcase,"__esModule",{value:!0}),ActorFunctionFactoryTermUcase.ActorFunctionFactoryTermUcase=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionUcase();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.UCASE],termFunction:!0})}async run(u){return new r.TermFunctionUcase}};return ActorFunctionFactoryTermUcase.ActorFunctionFactoryTermUcase=a,ActorFunctionFactoryTermUcase}var hasRequiredLib$24;function requireLib$24(){return hasRequiredLib$24||(hasRequiredLib$24=1,function(n){var t=lib$24&&lib$24.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$24&&lib$24.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermUcase(),n)}(lib$24)),lib$24}var lib$23={},ActorFunctionFactoryTermUnaryMinus={},TermFunctionUnaryMinus={},hasRequiredTermFunctionUnaryMinus;function requireTermFunctionUnaryMinus(){if(hasRequiredTermFunctionUnaryMinus)return TermFunctionUnaryMinus;hasRequiredTermFunctionUnaryMinus=1,Object.defineProperty(TermFunctionUnaryMinus,"__esModule",{value:!0}),TermFunctionUnaryMinus.TermFunctionUnaryMinus=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.UMINUS,overloads:(0,t.declare)(t.SparqlOperator.UMINUS).numericConverter(()=>o=>-o).collect()})}};return TermFunctionUnaryMinus.TermFunctionUnaryMinus=r,TermFunctionUnaryMinus}var hasRequiredActorFunctionFactoryTermUnaryMinus;function requireActorFunctionFactoryTermUnaryMinus(){if(hasRequiredActorFunctionFactoryTermUnaryMinus)return ActorFunctionFactoryTermUnaryMinus;hasRequiredActorFunctionFactoryTermUnaryMinus=1,Object.defineProperty(ActorFunctionFactoryTermUnaryMinus,"__esModule",{value:!0}),ActorFunctionFactoryTermUnaryMinus.ActorFunctionFactoryTermUnaryMinus=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionUnaryMinus();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.UMINUS],termFunction:!0})}async run(u){return new r.TermFunctionUnaryMinus}};return ActorFunctionFactoryTermUnaryMinus.ActorFunctionFactoryTermUnaryMinus=a,ActorFunctionFactoryTermUnaryMinus}var hasRequiredLib$23;function requireLib$23(){return hasRequiredLib$23||(hasRequiredLib$23=1,function(n){var t=lib$23&&lib$23.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$23&&lib$23.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermUnaryMinus(),n)}(lib$23)),lib$23}var lib$22={},ActorFunctionFactoryTermUnaryPlus={},TermFunctionUnaryPlus={},hasRequiredTermFunctionUnaryPlus;function requireTermFunctionUnaryPlus(){if(hasRequiredTermFunctionUnaryPlus)return TermFunctionUnaryPlus;hasRequiredTermFunctionUnaryPlus=1,Object.defineProperty(TermFunctionUnaryPlus,"__esModule",{value:!0}),TermFunctionUnaryPlus.TermFunctionUnaryPlus=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.UPLUS,overloads:(0,t.declare)(t.SparqlOperator.UPLUS).numericConverter(()=>o=>o).collect()})}};return TermFunctionUnaryPlus.TermFunctionUnaryPlus=r,TermFunctionUnaryPlus}var hasRequiredActorFunctionFactoryTermUnaryPlus;function requireActorFunctionFactoryTermUnaryPlus(){if(hasRequiredActorFunctionFactoryTermUnaryPlus)return ActorFunctionFactoryTermUnaryPlus;hasRequiredActorFunctionFactoryTermUnaryPlus=1,Object.defineProperty(ActorFunctionFactoryTermUnaryPlus,"__esModule",{value:!0}),ActorFunctionFactoryTermUnaryPlus.ActorFunctionFactoryTermUnaryPlus=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionUnaryPlus();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.UPLUS],termFunction:!0})}async run(u){return new r.TermFunctionUnaryPlus}};return ActorFunctionFactoryTermUnaryPlus.ActorFunctionFactoryTermUnaryPlus=a,ActorFunctionFactoryTermUnaryPlus}var hasRequiredLib$22;function requireLib$22(){return hasRequiredLib$22||(hasRequiredLib$22=1,function(n){var t=lib$22&&lib$22.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$22&&lib$22.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermUnaryPlus(),n)}(lib$22)),lib$22}var lib$21={},ActorFunctionFactoryTermUuid={},TermFunctionUuid={},hasRequiredTermFunctionUuid;function requireTermFunctionUuid(){if(hasRequiredTermFunctionUuid)return TermFunctionUuid;hasRequiredTermFunctionUuid=1,Object.defineProperty(TermFunctionUuid,"__esModule",{value:!0}),TermFunctionUuid.TermFunctionUuid=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireCjsBrowser();let a=class extends n.TermFunctionBase{constructor(){super({arity:0,operator:t.SparqlOperator.UUID,overloads:(0,t.declare)(t.SparqlOperator.UUID).set([],()=>()=>new t.NamedNode(`urn:uuid:${r.v4()}`)).collect()})}};return TermFunctionUuid.TermFunctionUuid=a,TermFunctionUuid}var hasRequiredActorFunctionFactoryTermUuid;function requireActorFunctionFactoryTermUuid(){if(hasRequiredActorFunctionFactoryTermUuid)return ActorFunctionFactoryTermUuid;hasRequiredActorFunctionFactoryTermUuid=1,Object.defineProperty(ActorFunctionFactoryTermUuid,"__esModule",{value:!0}),ActorFunctionFactoryTermUuid.ActorFunctionFactoryTermUuid=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionUuid();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.UUID],termFunction:!0})}async run(u){return new r.TermFunctionUuid}};return ActorFunctionFactoryTermUuid.ActorFunctionFactoryTermUuid=a,ActorFunctionFactoryTermUuid}var hasRequiredLib$21;function requireLib$21(){return hasRequiredLib$21||(hasRequiredLib$21=1,function(n){var t=lib$21&&lib$21.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$21&&lib$21.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermUuid(),n)}(lib$21)),lib$21}var lib$20={},ActorFunctionFactoryTermXsdToBoolean={},TermFunctionXsdToBoolean={},hasRequiredTermFunctionXsdToBoolean;function requireTermFunctionXsdToBoolean(){if(hasRequiredTermFunctionXsdToBoolean)return TermFunctionXsdToBoolean;hasRequiredTermFunctionXsdToBoolean=1,Object.defineProperty(TermFunctionXsdToBoolean,"__esModule",{value:!0}),TermFunctionXsdToBoolean.TermFunctionXsdToBoolean=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_BOOLEAN,overloads:(0,t.declare)(t.TypeURL.XSD_BOOLEAN).onNumeric1(()=>o=>(0,t.bool)(o.coerceEBV()),!0).onUnary(t.TypeURL.XSD_BOOLEAN,()=>o=>(0,t.bool)(o.coerceEBV()),!0).onUnary(t.TypeURL.XSD_STRING,()=>o=>{switch(o.str()){case"true":return(0,t.bool)(!0);case"false":return(0,t.bool)(!1);case"1":return(0,t.bool)(!0);case"0":return(0,t.bool)(!1);default:throw new t.CastError(o,t.TypeURL.XSD_BOOLEAN)}},!1).collect()})}};return TermFunctionXsdToBoolean.TermFunctionXsdToBoolean=r,TermFunctionXsdToBoolean}var hasRequiredActorFunctionFactoryTermXsdToBoolean;function requireActorFunctionFactoryTermXsdToBoolean(){if(hasRequiredActorFunctionFactoryTermXsdToBoolean)return ActorFunctionFactoryTermXsdToBoolean;hasRequiredActorFunctionFactoryTermXsdToBoolean=1,Object.defineProperty(ActorFunctionFactoryTermXsdToBoolean,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToBoolean.ActorFunctionFactoryTermXsdToBoolean=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToBoolean();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_BOOLEAN],termFunction:!0})}async run(u){return new r.TermFunctionXsdToBoolean}};return ActorFunctionFactoryTermXsdToBoolean.ActorFunctionFactoryTermXsdToBoolean=a,ActorFunctionFactoryTermXsdToBoolean}var hasRequiredLib$20;function requireLib$20(){return hasRequiredLib$20||(hasRequiredLib$20=1,function(n){var t=lib$20&&lib$20.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$20&&lib$20.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToBoolean(),n)}(lib$20)),lib$20}var lib$1$={},ActorFunctionFactoryTermXsdToDate={},TermFunctionXsdToDate={},hasRequiredTermFunctionXsdToDate;function requireTermFunctionXsdToDate(){if(hasRequiredTermFunctionXsdToDate)return TermFunctionXsdToDate;hasRequiredTermFunctionXsdToDate=1,Object.defineProperty(TermFunctionXsdToDate,"__esModule",{value:!0}),TermFunctionXsdToDate.TermFunctionXsdToDate=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DATE,overloads:(0,t.declare)(t.TypeURL.XSD_DATE).onUnary(t.TypeURL.XSD_DATE,()=>o=>new t.DateLiteral(o.typedValue,o.strValue)).onUnary(t.TypeURL.XSD_DATE_TIME,()=>o=>new t.DateLiteral(o.typedValue)).onStringly1(()=>o=>new t.DateLiteral((0,t.parseDate)(o.str()))).collect()})}};return TermFunctionXsdToDate.TermFunctionXsdToDate=r,TermFunctionXsdToDate}var hasRequiredActorFunctionFactoryTermXsdToDate;function requireActorFunctionFactoryTermXsdToDate(){if(hasRequiredActorFunctionFactoryTermXsdToDate)return ActorFunctionFactoryTermXsdToDate;hasRequiredActorFunctionFactoryTermXsdToDate=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDate,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDate.ActorFunctionFactoryTermXsdToDate=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDate();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DATE],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDate}};return ActorFunctionFactoryTermXsdToDate.ActorFunctionFactoryTermXsdToDate=a,ActorFunctionFactoryTermXsdToDate}var hasRequiredLib$1$;function requireLib$1$(){return hasRequiredLib$1$||(hasRequiredLib$1$=1,function(n){var t=lib$1$&&lib$1$.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1$&&lib$1$.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDate(),n)}(lib$1$)),lib$1$}var lib$1_={},ActorFunctionFactoryTermXsdToDatetime={},TermFunctionXsdToDatetime={},hasRequiredTermFunctionXsdToDatetime;function requireTermFunctionXsdToDatetime(){if(hasRequiredTermFunctionXsdToDatetime)return TermFunctionXsdToDatetime;hasRequiredTermFunctionXsdToDatetime=1,Object.defineProperty(TermFunctionXsdToDatetime,"__esModule",{value:!0}),TermFunctionXsdToDatetime.TermFunctionXsdToDatetime=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DATE_TIME,overloads:(0,t.declare)(t.TypeURL.XSD_DATE_TIME).onUnary(t.TypeURL.XSD_DATE_TIME,()=>o=>o).onUnary(t.TypeURL.XSD_STRING,()=>o=>(0,t.dateTime)((0,t.parseDateTime)(o.str()),o.str()),!1).onUnary(t.TypeURL.XSD_DATE,()=>o=>new t.DateTimeLiteral({...o.typedValue,hours:0,minutes:0,seconds:0})).collect()})}};return TermFunctionXsdToDatetime.TermFunctionXsdToDatetime=r,TermFunctionXsdToDatetime}var hasRequiredActorFunctionFactoryTermXsdToDatetime;function requireActorFunctionFactoryTermXsdToDatetime(){if(hasRequiredActorFunctionFactoryTermXsdToDatetime)return ActorFunctionFactoryTermXsdToDatetime;hasRequiredActorFunctionFactoryTermXsdToDatetime=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDatetime,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDatetime.ActorFunctionFactoryTermXsdToDatetime=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDatetime();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DATE_TIME],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDatetime}};return ActorFunctionFactoryTermXsdToDatetime.ActorFunctionFactoryTermXsdToDatetime=a,ActorFunctionFactoryTermXsdToDatetime}var hasRequiredLib$1_;function requireLib$1_(){return hasRequiredLib$1_||(hasRequiredLib$1_=1,function(n){var t=lib$1_&&lib$1_.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1_&&lib$1_.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDatetime(),n)}(lib$1_)),lib$1_}var lib$1Z={},ActorFunctionFactoryTermXsdToDayTimeDuration={},TermFunctionXsdToDayTimeDuration={},hasRequiredTermFunctionXsdToDayTimeDuration;function requireTermFunctionXsdToDayTimeDuration(){if(hasRequiredTermFunctionXsdToDayTimeDuration)return TermFunctionXsdToDayTimeDuration;hasRequiredTermFunctionXsdToDayTimeDuration=1,Object.defineProperty(TermFunctionXsdToDayTimeDuration,"__esModule",{value:!0}),TermFunctionXsdToDayTimeDuration.TermFunctionXsdToDayTimeDuration=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DAY_TIME_DURATION,overloads:(0,t.declare)(t.TypeURL.XSD_DAY_TIME_DURATION).onUnary(t.TypeURL.XSD_DURATION,()=>o=>new t.DayTimeDurationLiteral((0,t.trimToDayTimeDuration)(o.typedValue))).onStringly1(()=>o=>new t.DayTimeDurationLiteral((0,t.parseDayTimeDuration)(o.str()))).collect()})}};return TermFunctionXsdToDayTimeDuration.TermFunctionXsdToDayTimeDuration=r,TermFunctionXsdToDayTimeDuration}var hasRequiredActorFunctionFactoryTermXsdToDayTimeDuration;function requireActorFunctionFactoryTermXsdToDayTimeDuration(){if(hasRequiredActorFunctionFactoryTermXsdToDayTimeDuration)return ActorFunctionFactoryTermXsdToDayTimeDuration;hasRequiredActorFunctionFactoryTermXsdToDayTimeDuration=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDayTimeDuration,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDayTimeDuration.ActorFunctionFactoryTermXsdToDayTimeDuration=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDayTimeDuration();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DAY_TIME_DURATION],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDayTimeDuration}};return ActorFunctionFactoryTermXsdToDayTimeDuration.ActorFunctionFactoryTermXsdToDayTimeDuration=a,ActorFunctionFactoryTermXsdToDayTimeDuration}var hasRequiredLib$1Z;function requireLib$1Z(){return hasRequiredLib$1Z||(hasRequiredLib$1Z=1,function(n){var t=lib$1Z&&lib$1Z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1Z&&lib$1Z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDayTimeDuration(),n)}(lib$1Z)),lib$1Z}var lib$1Y={},ActorFunctionFactoryTermXsdToDouble={},TermFunctionXsdToDouble={},hasRequiredTermFunctionXsdToDouble;function requireTermFunctionXsdToDouble(){if(hasRequiredTermFunctionXsdToDouble)return TermFunctionXsdToDouble;hasRequiredTermFunctionXsdToDouble=1,Object.defineProperty(TermFunctionXsdToDouble,"__esModule",{value:!0}),TermFunctionXsdToDouble.TermFunctionXsdToDouble=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DOUBLE,overloads:(0,t.declare)(t.TypeURL.XSD_DOUBLE).onNumeric1(()=>o=>(0,t.double)(o.typedValue)).onBoolean1Typed(()=>o=>(0,t.double)(o?1:0)).onUnary(t.TypeURL.XSD_STRING,()=>o=>{const u=(0,t.parseXSDFloat)(o.str());if(u===void 0)throw new t.CastError(o,t.TypeURL.XSD_DOUBLE);return(0,t.double)(u)},!1).collect()})}};return TermFunctionXsdToDouble.TermFunctionXsdToDouble=r,TermFunctionXsdToDouble}var hasRequiredActorFunctionFactoryTermXsdToDouble;function requireActorFunctionFactoryTermXsdToDouble(){if(hasRequiredActorFunctionFactoryTermXsdToDouble)return ActorFunctionFactoryTermXsdToDouble;hasRequiredActorFunctionFactoryTermXsdToDouble=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDouble,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDouble.ActorFunctionFactoryTermXsdToDouble=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDouble();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DOUBLE],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDouble}};return ActorFunctionFactoryTermXsdToDouble.ActorFunctionFactoryTermXsdToDouble=a,ActorFunctionFactoryTermXsdToDouble}var hasRequiredLib$1Y;function requireLib$1Y(){return hasRequiredLib$1Y||(hasRequiredLib$1Y=1,function(n){var t=lib$1Y&&lib$1Y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1Y&&lib$1Y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDouble(),n)}(lib$1Y)),lib$1Y}var lib$1X={},ActorFunctionFactoryTermXsdToDecimal={},TermFunctionXsdToDecimal={},hasRequiredTermFunctionXsdToDecimal;function requireTermFunctionXsdToDecimal(){if(hasRequiredTermFunctionXsdToDecimal)return TermFunctionXsdToDecimal;hasRequiredTermFunctionXsdToDecimal=1,Object.defineProperty(TermFunctionXsdToDecimal,"__esModule",{value:!0}),TermFunctionXsdToDecimal.TermFunctionXsdToDecimal=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DECIMAL,overloads:(0,t.declare)(t.TypeURL.XSD_DECIMAL).onNumeric1(()=>o=>{const u=(0,t.parseXSDDecimal)(o.str());if(u===void 0)throw new t.CastError(o,t.TypeURL.XSD_DECIMAL);return(0,t.decimal)(u)}).onString1(()=>o=>{const u=o.str(),s=/^([+-])?(\d+(\.\d+)?)$/u.test(u)?(0,t.parseXSDDecimal)(u):void 0;if(s===void 0)throw new t.CastError(o,t.TypeURL.XSD_DECIMAL);return(0,t.decimal)(s)},!1).onBoolean1Typed(()=>o=>(0,t.decimal)(o?1:0)).collect()})}};return TermFunctionXsdToDecimal.TermFunctionXsdToDecimal=r,TermFunctionXsdToDecimal}var hasRequiredActorFunctionFactoryTermXsdToDecimal;function requireActorFunctionFactoryTermXsdToDecimal(){if(hasRequiredActorFunctionFactoryTermXsdToDecimal)return ActorFunctionFactoryTermXsdToDecimal;hasRequiredActorFunctionFactoryTermXsdToDecimal=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDecimal,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDecimal.ActorFunctionFactoryTermXsdToDecimal=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDecimal();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DECIMAL],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDecimal}};return ActorFunctionFactoryTermXsdToDecimal.ActorFunctionFactoryTermXsdToDecimal=a,ActorFunctionFactoryTermXsdToDecimal}var hasRequiredLib$1X;function requireLib$1X(){return hasRequiredLib$1X||(hasRequiredLib$1X=1,function(n){var t=lib$1X&&lib$1X.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1X&&lib$1X.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDecimal(),n)}(lib$1X)),lib$1X}var lib$1W={},ActorFunctionFactoryTermXsdToDuration={},TermFunctionXsdToDuration={},hasRequiredTermFunctionXsdToDuration;function requireTermFunctionXsdToDuration(){if(hasRequiredTermFunctionXsdToDuration)return TermFunctionXsdToDuration;hasRequiredTermFunctionXsdToDuration=1,Object.defineProperty(TermFunctionXsdToDuration,"__esModule",{value:!0}),TermFunctionXsdToDuration.TermFunctionXsdToDuration=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_DAY_TIME_DURATION,overloads:(0,t.declare)(t.TypeURL.XSD_DURATION).onUnary(t.TypeURL.XSD_DURATION,()=>o=>new t.DurationLiteral(o.typedValue,o.strValue)).onStringly1(()=>o=>new t.DurationLiteral((0,t.parseDuration)(o.str()))).collect()})}};return TermFunctionXsdToDuration.TermFunctionXsdToDuration=r,TermFunctionXsdToDuration}var hasRequiredActorFunctionFactoryTermXsdToDuration;function requireActorFunctionFactoryTermXsdToDuration(){if(hasRequiredActorFunctionFactoryTermXsdToDuration)return ActorFunctionFactoryTermXsdToDuration;hasRequiredActorFunctionFactoryTermXsdToDuration=1,Object.defineProperty(ActorFunctionFactoryTermXsdToDuration,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToDuration.ActorFunctionFactoryTermXsdToDuration=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToDuration();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_DURATION],termFunction:!0})}async run(u){return new r.TermFunctionXsdToDuration}};return ActorFunctionFactoryTermXsdToDuration.ActorFunctionFactoryTermXsdToDuration=a,ActorFunctionFactoryTermXsdToDuration}var hasRequiredLib$1W;function requireLib$1W(){return hasRequiredLib$1W||(hasRequiredLib$1W=1,function(n){var t=lib$1W&&lib$1W.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1W&&lib$1W.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToDuration(),n)}(lib$1W)),lib$1W}var lib$1V={},ActorFunctionFactoryTermXsdToFloat={},TermFunctionXsdToFloat={},hasRequiredTermFunctionXsdToFloat;function requireTermFunctionXsdToFloat(){if(hasRequiredTermFunctionXsdToFloat)return TermFunctionXsdToFloat;hasRequiredTermFunctionXsdToFloat=1,Object.defineProperty(TermFunctionXsdToFloat,"__esModule",{value:!0}),TermFunctionXsdToFloat.TermFunctionXsdToFloat=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_FLOAT,overloads:(0,t.declare)(t.TypeURL.XSD_FLOAT).onNumeric1(()=>o=>(0,t.float)(o.typedValue)).onBoolean1Typed(()=>o=>(0,t.float)(o?1:0)).onUnary(t.TypeURL.XSD_STRING,()=>o=>{const u=(0,t.parseXSDFloat)(o.str());if(u===void 0)throw new t.CastError(o,t.TypeURL.XSD_FLOAT);return(0,t.float)(u)},!1).collect()})}};return TermFunctionXsdToFloat.TermFunctionXsdToFloat=r,TermFunctionXsdToFloat}var hasRequiredActorFunctionFactoryTermXsdToFloat;function requireActorFunctionFactoryTermXsdToFloat(){if(hasRequiredActorFunctionFactoryTermXsdToFloat)return ActorFunctionFactoryTermXsdToFloat;hasRequiredActorFunctionFactoryTermXsdToFloat=1,Object.defineProperty(ActorFunctionFactoryTermXsdToFloat,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToFloat.ActorFunctionFactoryTermXsdToFloat=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToFloat();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_FLOAT],termFunction:!0})}async run(u){return new r.TermFunctionXsdToFloat}};return ActorFunctionFactoryTermXsdToFloat.ActorFunctionFactoryTermXsdToFloat=a,ActorFunctionFactoryTermXsdToFloat}var hasRequiredLib$1V;function requireLib$1V(){return hasRequiredLib$1V||(hasRequiredLib$1V=1,function(n){var t=lib$1V&&lib$1V.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1V&&lib$1V.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToFloat(),n)}(lib$1V)),lib$1V}var lib$1U={},ActorFunctionFactoryTermXsdToInteger={},TermFunctionXsdToInteger={},hasRequiredTermFunctionXsdToInteger;function requireTermFunctionXsdToInteger(){if(hasRequiredTermFunctionXsdToInteger)return TermFunctionXsdToInteger;hasRequiredTermFunctionXsdToInteger=1,Object.defineProperty(TermFunctionXsdToInteger,"__esModule",{value:!0}),TermFunctionXsdToInteger.TermFunctionXsdToInteger=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_INTEGER,overloads:(0,t.declare)(t.TypeURL.XSD_INTEGER).onBoolean1Typed(()=>o=>(0,t.integer)(o?1:0)).onNumeric1(()=>o=>{if(!Number.isFinite(o.typedValue))throw new t.CastError(o,t.TypeURL.XSD_INTEGER);return(0,t.integer)(Math.trunc(o.typedValue))}).onString1(()=>o=>{const u=o.str(),s=/^\d+$/u.test(u)?Number.parseInt(u,10):void 0;if(s===void 0)throw new t.CastError(o,t.TypeURL.XSD_INTEGER);return(0,t.integer)(s)}).collect()})}};return TermFunctionXsdToInteger.TermFunctionXsdToInteger=r,TermFunctionXsdToInteger}var hasRequiredActorFunctionFactoryTermXsdToInteger;function requireActorFunctionFactoryTermXsdToInteger(){if(hasRequiredActorFunctionFactoryTermXsdToInteger)return ActorFunctionFactoryTermXsdToInteger;hasRequiredActorFunctionFactoryTermXsdToInteger=1,Object.defineProperty(ActorFunctionFactoryTermXsdToInteger,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToInteger.ActorFunctionFactoryTermXsdToInteger=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToInteger();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_INTEGER],termFunction:!0})}async run(u){return new r.TermFunctionXsdToInteger}};return ActorFunctionFactoryTermXsdToInteger.ActorFunctionFactoryTermXsdToInteger=a,ActorFunctionFactoryTermXsdToInteger}var hasRequiredLib$1U;function requireLib$1U(){return hasRequiredLib$1U||(hasRequiredLib$1U=1,function(n){var t=lib$1U&&lib$1U.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1U&&lib$1U.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToInteger(),n)}(lib$1U)),lib$1U}var lib$1T={},ActorFunctionFactoryTermXsdToTime={},TermFunctionXsdToTime={},hasRequiredTermFunctionXsdToTime;function requireTermFunctionXsdToTime(){if(hasRequiredTermFunctionXsdToTime)return TermFunctionXsdToTime;hasRequiredTermFunctionXsdToTime=1,Object.defineProperty(TermFunctionXsdToTime,"__esModule",{value:!0}),TermFunctionXsdToTime.TermFunctionXsdToTime=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_TIME,overloads:(0,t.declare)(t.TypeURL.XSD_TIME).onUnary(t.TypeURL.XSD_TIME,()=>o=>new t.TimeLiteral(o.typedValue,o.strValue)).onUnary(t.TypeURL.XSD_DATE_TIME,()=>o=>new t.TimeLiteral(o.typedValue)).onStringly1(()=>o=>new t.TimeLiteral((0,t.parseTime)(o.str()))).collect()})}};return TermFunctionXsdToTime.TermFunctionXsdToTime=r,TermFunctionXsdToTime}var hasRequiredActorFunctionFactoryTermXsdToTime;function requireActorFunctionFactoryTermXsdToTime(){if(hasRequiredActorFunctionFactoryTermXsdToTime)return ActorFunctionFactoryTermXsdToTime;hasRequiredActorFunctionFactoryTermXsdToTime=1,Object.defineProperty(ActorFunctionFactoryTermXsdToTime,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToTime.ActorFunctionFactoryTermXsdToTime=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToTime();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_TIME],termFunction:!0})}async run(u){return new r.TermFunctionXsdToTime}};return ActorFunctionFactoryTermXsdToTime.ActorFunctionFactoryTermXsdToTime=a,ActorFunctionFactoryTermXsdToTime}var hasRequiredLib$1T;function requireLib$1T(){return hasRequiredLib$1T||(hasRequiredLib$1T=1,function(n){var t=lib$1T&&lib$1T.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1T&&lib$1T.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToTime(),n)}(lib$1T)),lib$1T}var lib$1S={},ActorFunctionFactoryTermXsdToString={},TermFunctionXsdToString={},hasRequiredTermFunctionXsdToString;function requireTermFunctionXsdToString(){if(hasRequiredTermFunctionXsdToString)return TermFunctionXsdToString;hasRequiredTermFunctionXsdToString=1,Object.defineProperty(TermFunctionXsdToString,"__esModule",{value:!0}),TermFunctionXsdToString.TermFunctionXsdToString=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_STRING,overloads:(0,t.declare)(t.TypeURL.XSD_STRING).onNumeric1(()=>o=>(0,t.string)((0,t.float)(o.typedValue).str())).onBoolean1Typed(()=>o=>(0,t.string)((0,t.bool)(o).str())).onTerm1(()=>o=>(0,t.string)(o.str())).collect()})}};return TermFunctionXsdToString.TermFunctionXsdToString=r,TermFunctionXsdToString}var hasRequiredActorFunctionFactoryTermXsdToString;function requireActorFunctionFactoryTermXsdToString(){if(hasRequiredActorFunctionFactoryTermXsdToString)return ActorFunctionFactoryTermXsdToString;hasRequiredActorFunctionFactoryTermXsdToString=1,Object.defineProperty(ActorFunctionFactoryTermXsdToString,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToString.ActorFunctionFactoryTermXsdToString=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToString();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_STRING],termFunction:!0})}async run(u){return new r.TermFunctionXsdToString}};return ActorFunctionFactoryTermXsdToString.ActorFunctionFactoryTermXsdToString=a,ActorFunctionFactoryTermXsdToString}var hasRequiredLib$1S;function requireLib$1S(){return hasRequiredLib$1S||(hasRequiredLib$1S=1,function(n){var t=lib$1S&&lib$1S.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1S&&lib$1S.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToString(),n)}(lib$1S)),lib$1S}var lib$1R={},ActorFunctionFactoryTermXsdToYearMonthDuration={},TermFunctionXsdToYearMonthDuration={},hasRequiredTermFunctionXsdToYearMonthDuration;function requireTermFunctionXsdToYearMonthDuration(){if(hasRequiredTermFunctionXsdToYearMonthDuration)return TermFunctionXsdToYearMonthDuration;hasRequiredTermFunctionXsdToYearMonthDuration=1,Object.defineProperty(TermFunctionXsdToYearMonthDuration,"__esModule",{value:!0}),TermFunctionXsdToYearMonthDuration.TermFunctionXsdToYearMonthDuration=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.TypeURL.XSD_YEAR_MONTH_DURATION,overloads:(0,t.declare)(t.TypeURL.XSD_YEAR_MONTH_DURATION).onUnary(t.TypeURL.XSD_DURATION,()=>o=>new t.YearMonthDurationLiteral((0,t.trimToYearMonthDuration)(o.typedValue))).onStringly1(()=>o=>new t.YearMonthDurationLiteral((0,t.parseYearMonthDuration)(o.str()))).collect()})}};return TermFunctionXsdToYearMonthDuration.TermFunctionXsdToYearMonthDuration=r,TermFunctionXsdToYearMonthDuration}var hasRequiredActorFunctionFactoryTermXsdToYearMonthDuration;function requireActorFunctionFactoryTermXsdToYearMonthDuration(){if(hasRequiredActorFunctionFactoryTermXsdToYearMonthDuration)return ActorFunctionFactoryTermXsdToYearMonthDuration;hasRequiredActorFunctionFactoryTermXsdToYearMonthDuration=1,Object.defineProperty(ActorFunctionFactoryTermXsdToYearMonthDuration,"__esModule",{value:!0}),ActorFunctionFactoryTermXsdToYearMonthDuration.ActorFunctionFactoryTermXsdToYearMonthDuration=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionXsdToYearMonthDuration();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.TypeURL.XSD_YEAR_MONTH_DURATION],termFunction:!0})}async run(u){return new r.TermFunctionXsdToYearMonthDuration}};return ActorFunctionFactoryTermXsdToYearMonthDuration.ActorFunctionFactoryTermXsdToYearMonthDuration=a,ActorFunctionFactoryTermXsdToYearMonthDuration}var hasRequiredLib$1R;function requireLib$1R(){return hasRequiredLib$1R||(hasRequiredLib$1R=1,function(n){var t=lib$1R&&lib$1R.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1R&&lib$1R.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermXsdToYearMonthDuration(),n)}(lib$1R)),lib$1R}var lib$1Q={},ActorFunctionFactoryTermYear={},TermFunctionYear={},hasRequiredTermFunctionYear;function requireTermFunctionYear(){if(hasRequiredTermFunctionYear)return TermFunctionYear;hasRequiredTermFunctionYear=1,Object.defineProperty(TermFunctionYear,"__esModule",{value:!0}),TermFunctionYear.TermFunctionYear=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(){super({arity:1,operator:t.SparqlOperator.YEAR,overloads:(0,t.declare)(t.SparqlOperator.YEAR).onDateTime1(()=>o=>(0,t.integer)(o.typedValue.year)).set([t.TypeURL.XSD_DATE],()=>([o])=>(0,t.integer)(o.typedValue.year)).collect()})}};return TermFunctionYear.TermFunctionYear=r,TermFunctionYear}var hasRequiredActorFunctionFactoryTermYear;function requireActorFunctionFactoryTermYear(){if(hasRequiredActorFunctionFactoryTermYear)return ActorFunctionFactoryTermYear;hasRequiredActorFunctionFactoryTermYear=1,Object.defineProperty(ActorFunctionFactoryTermYear,"__esModule",{value:!0}),ActorFunctionFactoryTermYear.ActorFunctionFactoryTermYear=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionYear();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.YEAR],termFunction:!0})}async run(u){return new r.TermFunctionYear}};return ActorFunctionFactoryTermYear.ActorFunctionFactoryTermYear=a,ActorFunctionFactoryTermYear}var hasRequiredLib$1Q;function requireLib$1Q(){return hasRequiredLib$1Q||(hasRequiredLib$1Q=1,function(n){var t=lib$1Q&&lib$1Q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1Q&&lib$1Q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermYear(),n)}(lib$1Q)),lib$1Q}var lib$1P={},ActorHttpFetch={},lib$1O={},ActorHttp={},lib$1N={},ReadableFromWeb={},hasRequiredReadableFromWeb;function requireReadableFromWeb(){if(hasRequiredReadableFromWeb)return ReadableFromWeb;hasRequiredReadableFromWeb=1,Object.defineProperty(ReadableFromWeb,"__esModule",{value:!0}),ReadableFromWeb.readableFromWeb=ReadableFromWeb.ReadableFromWeb=void 0;const n=requireBrowser();let t=class extends n.Readable{constructor(o,u){super(u),this.reader=o.getReader(),this.readerClosed=!1,this.reader.closed.then(()=>{this.readerClosed=!0}).catch(s=>{this.readerClosed=!0,this.destroy(s)})}_read(){this.reader.read().then(o=>this.push(o.done?null:o.value)).catch(o=>this.destroy(o))}destroy(o){return this.readerClosed||this.reader.cancel(o).then().catch(()=>{}),super.destroy(o)}};ReadableFromWeb.ReadableFromWeb=t;function r(a,o){return new t(a,o)}return ReadableFromWeb.readableFromWeb=r,ReadableFromWeb}var hasRequiredLib$1P;function requireLib$1P(){return hasRequiredLib$1P||(hasRequiredLib$1P=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.readableFromWeb=void 0;var t=requireReadableFromWeb();Object.defineProperty(n,"readableFromWeb",{enumerable:!0,get:function(){return t.readableFromWeb}})}(lib$1N)),lib$1N}var isStream_1,hasRequiredIsStream;function requireIsStream(){if(hasRequiredIsStream)return isStream_1;hasRequiredIsStream=1;const n=t=>t!==null&&typeof t=="object"&&typeof t.pipe=="function";return n.writable=t=>n(t)&&t.writable!==!1&&typeof t._write=="function"&&typeof t._writableState=="object",n.readable=t=>n(t)&&t.readable!==!1&&typeof t._read=="function"&&typeof t._readableState=="object",n.duplex=t=>n.writable(t)&&n.readable(t),n.transform=t=>n.duplex(t)&&typeof t._transform=="function",isStream_1=n,isStream_1}var readableStreamNodeToWeb={exports:{}},hasRequiredReadableStreamNodeToWeb;function requireReadableStreamNodeToWeb(){return hasRequiredReadableStreamNodeToWeb||(hasRequiredReadableStreamNodeToWeb=1,function(n){n.exports=t,n.exports.WEBSTREAM_SUPPORT=typeof ReadableStream<"u";function t(r){if(!n.exports.WEBSTREAM_SUPPORT)throw new Error("No web ReadableStream support");var a=!1,o={};function u(l){o.data=f,o.end=f,o.end=h,o.close=h,o.error=h;for(var d in o)r.on(d,o[d]);r.pause();function f(v){a||(l.enqueue(v),r.pause())}function h(v){if(!a){a=!0;for(var g in o)r.removeListener(g,o[g]);v?l.error(v):l.close()}}}function s(){a||r.resume()}function c(){a=!0;for(var l in o)r.removeListener(l,o[l]);r.push(null),r.pause(),r.destroy?r.destroy():r.close&&r.close()}return new ReadableStream({start:u,pull:s,cancel:c})}}(readableStreamNodeToWeb)),readableStreamNodeToWeb.exports}var hasRequiredActorHttp;function requireActorHttp(){if(hasRequiredActorHttp)return ActorHttp;hasRequiredActorHttp=1,Object.defineProperty(ActorHttp,"__esModule",{value:!0}),ActorHttp.ActorHttp=void 0;const n=requireLib$4s(),t=requireLib$1P(),r=requireIsStream(),a=requireReadableStreamNodeToWeb();let o=class ia extends n.Actor{constructor(s){super(s)}static toNodeReadable(s){return r(s)||s===null?s:(0,t.readableFromWeb)(s)}static toWebReadableStream(s){return a(s)}static headersToHash(s){const c={};return s.forEach((l,d)=>{c[d]=l}),c}static getInputUrl(s){return new URL(s instanceof Request?s.url:s)}static createUserAgent(s,c){if(!ia.isBrowser()){const l=[`Comunica/${c.split(".")[0]}.0`,`${s}/${c}`];return typeof globalThis.navigator=="object"&&typeof globalThis.navigator.userAgent=="string"?l.push(globalThis.navigator.userAgent):typeof globalThis.process=="object"&&typeof globalThis.process.versions=="object"&&typeof globalThis.process.versions.node=="string"&&l.push(`Node.js/${globalThis.process.versions.node.split(".")[0]}`),typeof globalThis.process=="object"&&typeof globalThis.process.platform=="string"&&typeof globalThis.process.arch=="string"&&l.splice(1,0,`(${globalThis.process.platform}; ${globalThis.process.arch})`),l.join(" ")}}static isBrowser(){return typeof globalThis.window=="object"&&typeof globalThis.window.document=="object"||typeof globalThis.importScripts=="function"}};return ActorHttp.ActorHttp=o,ActorHttp}var utils={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils;hasRequiredUtils$1=1,Object.defineProperty(utils,"__esModule",{value:!0}),utils.validateAndCloseHttpResponse=void 0;const n=requireDist$3(),t=requireActorHttp();async function r(a,o){var u;if(o.status>=400){let s="empty response";if(o.body){const c=t.ActorHttp.toNodeReadable(o.body);s=await(0,n.stringify)(c)}throw new Error(`Could not update ${a} (HTTP status ${o.status}):
${s}`)}await((u=o.body)==null?void 0:u.cancel())}return utils.validateAndCloseHttpResponse=r,utils}var hasRequiredLib$1O;function requireLib$1O(){return hasRequiredLib$1O||(hasRequiredLib$1O=1,function(n){var t=lib$1O&&lib$1O.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1O&&lib$1O.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttp(),n),r(requireUtils$1(),n)}(lib$1O)),lib$1O}const version$1="4.1.0",require$$3={version:version$1};var FetchInitPreprocessorBrowser={},hasRequiredFetchInitPreprocessorBrowser;function requireFetchInitPreprocessorBrowser(){if(hasRequiredFetchInitPreprocessorBrowser)return FetchInitPreprocessorBrowser;hasRequiredFetchInitPreprocessorBrowser=1,Object.defineProperty(FetchInitPreprocessorBrowser,"__esModule",{value:!0}),FetchInitPreprocessorBrowser.FetchInitPreprocessor=void 0;class n{async handle(r){if(r.body&&typeof r.body!="string"&&"getReader"in r.body){const a=r.body.getReader(),o=[];for(;;){const{done:u,value:s}=await a.read();if(u)break;o.push(s)}r.body=o.join("")}return{...r,keepalive:!r.body}}}return FetchInitPreprocessorBrowser.FetchInitPreprocessor=n,FetchInitPreprocessorBrowser}var hasRequiredActorHttpFetch;function requireActorHttpFetch(){if(hasRequiredActorHttpFetch)return ActorHttpFetch;hasRequiredActorHttpFetch=1,Object.defineProperty(ActorHttpFetch,"__esModule",{value:!0}),ActorHttpFetch.ActorHttpFetch=void 0;const n=requireLib$1O(),t=requireLib$4q(),r=requireLib$4s(),a=require$$3,o=requireFetchInitPreprocessorBrowser();let u=class vi extends n.ActorHttp{constructor(c){super(c),this.fetchInitPreprocessor=new o.FetchInitPreprocessor(c.agentOptions)}async test(c){return(0,r.passTest)({time:Number.POSITIVE_INFINITY})}async run(c){const l=this.prepareRequestHeaders(c),d={method:"GET",...c.init,headers:l};this.logInfo(c.context,`Requesting ${n.ActorHttp.getInputUrl(c.input).href}`,()=>({headers:n.ActorHttp.headersToHash(l),method:d.method})),c.context.has(t.KeysHttp.fetch)&&(d.headers=n.ActorHttp.headersToHash(l)),c.context.get(t.KeysHttp.includeCredentials)&&(d.credentials="include");const f=c.context.get(t.KeysHttp.httpTimeout),h=c.context.get(t.KeysHttp.httpBodyTimeout),v=c.context.get(t.KeysHttp.fetch)??fetch,g=await this.fetchInitPreprocessor.handle(d);let b,_;if(f){const T=new AbortController;g.signal=T.signal,b=()=>T.abort(new Error(`Fetch timed out for ${n.ActorHttp.getInputUrl(c.input).href} after ${f} ms`)),_=setTimeout(()=>b(),f)}const S=await v(c.input,g);return f&&(!h||!S.body)&&clearTimeout(_),S}prepareRequestHeaders(c){var f;const l=new Headers((f=c.init)==null?void 0:f.headers);n.ActorHttp.isBrowser()?l.delete("user-agent"):l.has("user-agent")||l.set("user-agent",vi.userAgent);const d=c.context.get(t.KeysHttp.auth);return d&&l.set("Authorization",`Basic ${vi.stringToBase64(d)}`),l}static stringToBase64(c){const l=new TextEncoder().encode(c),d=Array.from(l,f=>String.fromCodePoint(f)).join("");return btoa(d)}};return ActorHttpFetch.ActorHttpFetch=u,u.userAgent=n.ActorHttp.createUserAgent("ActorHttpFetch",a.version),ActorHttpFetch}var hasRequiredLib$1N;function requireLib$1N(){return hasRequiredLib$1N||(hasRequiredLib$1N=1,function(n){var t=lib$1P&&lib$1P.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1P&&lib$1P.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttpFetch(),n)}(lib$1P)),lib$1P}var lib$1M={},ActorQueryOperationSource={},hasRequiredActorQueryOperationSource;function requireActorQueryOperationSource(){if(hasRequiredActorQueryOperationSource)return ActorQueryOperationSource;hasRequiredActorQueryOperationSource=1,Object.defineProperty(ActorQueryOperationSource,"__esModule",{value:!0}),ActorQueryOperationSource.ActorQueryOperationSource=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$4l(),o=requireLib$43(),u=requireSparqlalgebrajs();let s=class extends n.ActorQueryOperation{constructor(l){super(l)}async test(l){return(0,o.getOperationSource)(l.operation)?(0,r.passTest)({httpRequests:1}):(0,r.failTest)(`Actor ${this.name} requires an operation with source annotation.`)}async run(l){const d=l.context.get(t.KeysInitQuery.physicalQueryPlanLogger);d&&(d.logOperation(l.operation.type,void 0,l.operation,l.context.get(t.KeysInitQuery.physicalQueryPlanNode),this.name,{}),l.context=l.context.set(t.KeysInitQuery.physicalQueryPlanNode,l.operation));const f=(0,o.getOperationSource)(l.operation),h=f.context?l.context.merge(f.context):l.context;let v=!1;if(u.Util.recurseOperation(l.operation,{construct(){return v=!0,!1}}),v){const _=f.source.queryQuads(l.operation,h),S=(0,a.getMetadataQuads)(_);return{type:"quads",quadStream:_,metadata:S}}switch(l.operation.type){case u.Algebra.types.ASK:return{type:"boolean",execute:()=>f.source.queryBoolean(l.operation,h)};case u.Algebra.types.COMPOSITE_UPDATE:case u.Algebra.types.DELETE_INSERT:case u.Algebra.types.LOAD:case u.Algebra.types.CLEAR:case u.Algebra.types.CREATE:case u.Algebra.types.DROP:case u.Algebra.types.ADD:case u.Algebra.types.MOVE:case u.Algebra.types.COPY:return{type:"void",execute:()=>f.source.queryVoid(l.operation,h)}}const g=f.source.queryBindings(l.operation,h),b=(0,a.getMetadataBindings)(g);return{type:"bindings",bindingsStream:g,metadata:b}}};return ActorQueryOperationSource.ActorQueryOperationSource=s,ActorQueryOperationSource}var hasRequiredLib$1M;function requireLib$1M(){return hasRequiredLib$1M||(hasRequiredLib$1M=1,function(n){var t=lib$1M&&lib$1M.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1M&&lib$1M.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationSource(),n)}(lib$1M)),lib$1M}var lib$1L={},MediatorJoinCoefficientsFixed={},hasRequiredMediatorJoinCoefficientsFixed;function requireMediatorJoinCoefficientsFixed(){if(hasRequiredMediatorJoinCoefficientsFixed)return MediatorJoinCoefficientsFixed;hasRequiredMediatorJoinCoefficientsFixed=1,Object.defineProperty(MediatorJoinCoefficientsFixed,"__esModule",{value:!0}),MediatorJoinCoefficientsFixed.MediatorJoinCoefficientsFixed=void 0;const n=requireLib$4q(),t=requireLib$4s();let r=class extends t.Mediator{constructor(o){super(o)}async mediateWith(o,u){var _;const s=[],c=u.map(({reply:S})=>S),l=(await Promise.all(c)).map(S=>{if(S.isFailed()){s.push(S.getFailMessage());return}return{value:S.get(),sideData:S.getSideData()}});let d=l.map(S=>{if(S)return S.value.iterations*this.cpuWeight+S.value.persistedItems*this.memoryWeight+S.value.blockingItems*this.timeWeight+S.value.requestTime*this.ioWeight});const f=Math.max(...d.filter(S=>S!==void 0)),h=o.context.get(n.KeysQueryOperation.limitIndicator);h&&(d=d.map((S,T)=>{var w,A;return S!==void 0&&((w=l[T])==null?void 0:w.value).blockingItems>0&&((A=l[T])==null?void 0:A.value).iterations>h?S+f:S}));let v=-1,g=Number.POSITIVE_INFINITY;for(const[S,T]of d.entries())T!==void 0&&(v===-1||T<g)&&(v=S,g=T);if(v<0)return(0,t.failTest)(this.constructFailureMessage(o,s));const b=u[v].actor;return b.includeInLogs&&((_=t.Actor.getContextLogger(o.context))==null||_.debug(`Determined physical join operator '${b.logicalType}-${b.physicalName}'`,{entries:o.entries.length,variables:await Promise.all(o.entries.map(async S=>(await S.output.metadata()).variables.map(T=>T.variable.value))),costs:Object.fromEntries(d.map((S,T)=>[`${u[T].actor.logicalType}-${u[T].actor.physicalName}`,S]).filter(S=>S[1]!==void 0)),coefficients:Object.fromEntries(l.map((S,T)=>[`${u[T].actor.logicalType}-${u[T].actor.physicalName}`,S==null?void 0:S.value]).filter(S=>S[1]!==void 0))})),(0,t.passTestWithSideData)(b,l[v].sideData)}};return MediatorJoinCoefficientsFixed.MediatorJoinCoefficientsFixed=r,MediatorJoinCoefficientsFixed}var hasRequiredLib$1L;function requireLib$1L(){return hasRequiredLib$1L||(hasRequiredLib$1L=1,function(n){var t=lib$1L&&lib$1L.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1L&&lib$1L.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorJoinCoefficientsFixed(),n)}(lib$1L)),lib$1L}var lib$1K={},ActorHttpInvalidate={},hasRequiredActorHttpInvalidate;function requireActorHttpInvalidate(){if(hasRequiredActorHttpInvalidate)return ActorHttpInvalidate;hasRequiredActorHttpInvalidate=1,Object.defineProperty(ActorHttpInvalidate,"__esModule",{value:!0}),ActorHttpInvalidate.ActorHttpInvalidate=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorHttpInvalidate.ActorHttpInvalidate=t,ActorHttpInvalidate}var ActorHttpInvalidateListenable={},hasRequiredActorHttpInvalidateListenable;function requireActorHttpInvalidateListenable(){if(hasRequiredActorHttpInvalidateListenable)return ActorHttpInvalidateListenable;hasRequiredActorHttpInvalidateListenable=1,Object.defineProperty(ActorHttpInvalidateListenable,"__esModule",{value:!0}),ActorHttpInvalidateListenable.ActorHttpInvalidateListenable=void 0;const n=requireLib$4s(),t=requireActorHttpInvalidate();let r=class extends t.ActorHttpInvalidate{constructor(o){super(o),this.invalidateListeners=[],this.invalidateListeners=[]}addInvalidateListener(o){this.invalidateListeners.push(o)}async test(o){return(0,n.passTestVoid)()}async run(o){for(const u of this.invalidateListeners)u(o);return{}}};return ActorHttpInvalidateListenable.ActorHttpInvalidateListenable=r,ActorHttpInvalidateListenable}var hasRequiredLib$1K;function requireLib$1K(){return hasRequiredLib$1K||(hasRequiredLib$1K=1,function(n){var t=lib$1K&&lib$1K.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1K&&lib$1K.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttpInvalidate(),n),r(requireActorHttpInvalidateListenable(),n)}(lib$1K)),lib$1K}var lib$1J={},MediatorAll={},hasRequiredMediatorAll;function requireMediatorAll(){if(hasRequiredMediatorAll)return MediatorAll;hasRequiredMediatorAll=1,Object.defineProperty(MediatorAll,"__esModule",{value:!0}),MediatorAll.MediatorAll=void 0;const n=requireLib$4s();let t=class extends n.Mediator{constructor(a){super(a)}async mediate(a){const o=[];let u;try{u=this.publish(a)}catch{u=[]}for(const c of u){const l=await c.reply;l.isPassed()&&o.push({actor:c.actor,sideData:l.getSideData()})}return(await Promise.all(o.map(c=>c.actor.runObservable(a,c.sideData))))[0]}async mediateWith(){throw new Error("Unsupported operation: MediatorAll#mediateWith")}};return MediatorAll.MediatorAll=t,MediatorAll}var hasRequiredLib$1J;function requireLib$1J(){return hasRequiredLib$1J||(hasRequiredLib$1J=1,function(n){var t=lib$1J&&lib$1J.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1J&&lib$1J.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireMediatorAll(),n)}(lib$1J)),lib$1J}var lib$1I={},ActorRdfJoinSingle={},lib$1H={},ActorRdfJoin={},lib$1G={},ChunkedIterator={},hasRequiredChunkedIterator;function requireChunkedIterator(){if(hasRequiredChunkedIterator)return ChunkedIterator;hasRequiredChunkedIterator=1,Object.defineProperty(ChunkedIterator,"__esModule",{value:!0}),ChunkedIterator.ChunkedIterator=void 0;const n=requireAsynciterator();let t=class extends n.TransformIterator{constructor(a,o,u){super(a,u),this.chunk=[],this.blockSize=o}consumeChunkAsIterator(){const a=new n.ArrayIterator(this.chunk,{autoStart:!1});return this.chunk=[],a}_transform(a,o,u){this.chunk.push(a),this.chunk.length>=this.blockSize&&u(this.consumeChunkAsIterator()),o()}_flush(a){this.chunk.length>0&&this._push(this.consumeChunkAsIterator()),super._flush(a)}};return ChunkedIterator.ChunkedIterator=t,ChunkedIterator}var ClosableIterator={},hasRequiredClosableIterator;function requireClosableIterator(){if(hasRequiredClosableIterator)return ClosableIterator;hasRequiredClosableIterator=1,Object.defineProperty(ClosableIterator,"__esModule",{value:!0}),ClosableIterator.ClosableIterator=void 0;const n=requireAsynciterator();let t=class extends n.AsyncIterator{constructor(s,c){super(),this.onClose=c.onClose,this._source=s,this._source[n.DESTINATION]=this,this._source.on("end",o),this._source.on("error",a),this._source.on("readable",r),this.readable=this._source.readable}read(){const s=this._source.read();return s||(this.readable=!1,this._source.done&&this.close()),s}_end(s){this.onClose(),this._source.removeListener("end",o),this._source.removeListener("error",a),this._source.removeListener("readable",r),delete this._source[n.DESTINATION],this._source.destroy(),super._end(s)}};ClosableIterator.ClosableIterator=t;function r(){this[n.DESTINATION].readable=!0}function a(u){this[n.DESTINATION].emit("error",u)}function o(){this[n.DESTINATION].close()}return ClosableIterator}var ClosableTransformIterator={},hasRequiredClosableTransformIterator;function requireClosableTransformIterator(){if(hasRequiredClosableTransformIterator)return ClosableTransformIterator;hasRequiredClosableTransformIterator=1,Object.defineProperty(ClosableTransformIterator,"__esModule",{value:!0}),ClosableTransformIterator.ClosableTransformIterator=void 0;const n=requireAsynciterator();let t=class extends n.TransformIterator{constructor(a,o){super(a,o),this.onClose=o.onClose}_end(a){this.onClose(),super._end(a)}};return ClosableTransformIterator.ClosableTransformIterator=t,ClosableTransformIterator}var instrumentIterator={},hasRequiredInstrumentIterator;function requireInstrumentIterator(){if(hasRequiredInstrumentIterator)return instrumentIterator;hasRequiredInstrumentIterator=1,Object.defineProperty(instrumentIterator,"__esModule",{value:!0}),instrumentIterator.instrumentIterator=void 0;function n(r){const a={count:0,timeSelf:0,timeLife:0};return t(r,a,!0),new Promise(o=>{r.on("end",()=>{o(a)})})}instrumentIterator.instrumentIterator=n;function t(r,a,o){if(!("_profileInstrumented"in r)){if(r._profileInstrumented=!0,"_read"in r){const u=r._read;r._read=(s,c)=>{const l=performance.now();u.call(r,s,()=>{a.timeSelf+=performance.now()-l,c()})}}if("read"in r){const u=r.read;r.read=()=>{const s=performance.now(),c=u.call(r);return o&&c&&a.count++,a.timeSelf+=performance.now()-s,c}}if(o){const u=performance.now();r.on("end",()=>{a.timeLife=performance.now()-u})}"_source"in r&&t(r._source,a,!1)}}return instrumentIterator}var hasRequiredLib$1I;function requireLib$1I(){return hasRequiredLib$1I||(hasRequiredLib$1I=1,function(n){var t=lib$1G&&lib$1G.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1G&&lib$1G.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireChunkedIterator(),n),r(requireClosableIterator(),n),r(requireClosableTransformIterator(),n),r(requireInstrumentIterator(),n)}(lib$1G)),lib$1G}var hasRequiredActorRdfJoin;function requireActorRdfJoin(){if(hasRequiredActorRdfJoin)return ActorRdfJoin;hasRequiredActorRdfJoin=1,Object.defineProperty(ActorRdfJoin,"__esModule",{value:!0}),ActorRdfJoin.ActorRdfJoin=void 0;const n=requireLib$4q(),t=requireLib$4s(),r=requireLib$1I(),a=requireLib$4l();let o=class yr extends t.Actor{constructor(s,c){super(s),this.includeInLogs=!0,this.logicalType=c.logicalType,this.physicalName=c.physicalName,this.limitEntries=c.limitEntries??Number.POSITIVE_INFINITY,this.limitEntriesMin=c.limitEntriesMin??!1,this.canHandleUndefs=c.canHandleUndefs??!1,this.isLeaf=c.isLeaf??!0,this.requiresVariableOverlap=c.requiresVariableOverlap??!1}static overlappingVariables(s){const c={};for(const l of s)for(const d of l.variables){c[d.variable.value]||(c[d.variable.value]={variable:d.variable,canBeUndef:d.canBeUndef,occurrences:0});const f=c[d.variable.value];f.canBeUndef=f.canBeUndef||d.canBeUndef,f.occurrences++}return Object.values(c).filter(l=>l.occurrences===s.length).map(l=>({variable:l.variable,canBeUndef:l.canBeUndef}))}static joinVariables(s,c,l=!1){const d={};let f=!0;for(const h of c){for(const v of h.variables)d[v.variable.value]=d[v.variable.value]||v.canBeUndef||!f&&l&&!(v.variable.value in d);f=!1}return Object.entries(d).map(([h,v])=>({variable:s.variable(h),canBeUndef:v}))}static joinBindings(...s){if(s.length===0)return null;if(s.length===1)return s[0];let c=s[0];for(const l of s.slice(1)){const d=c.merge(l);if(!d)return null;c=d}return c}static getCardinality(s){return s.cardinality}static async getMetadatas(s){return await Promise.all(s.map(c=>c.output.metadata()))}static async getEntriesWithMetadatas(s){const c=await yr.getMetadatas(s);return s.map((l,d)=>({...l,metadata:c[d]}))}static getRequestInitialTimes(s){return s.map(c=>c.pageSize?0:c.requestTime??0)}static getRequestItemTimes(s){return s.map(c=>c.pageSize?(c.requestTime??0)/c.pageSize:0)}constructState(s){const c=new a.MetadataValidationState,l=()=>c.invalidate();for(const d of s)d.state.addInvalidateListener(l);return c}async constructResultMetadata(s,c,l,d={},f=!1){let h;if(d.cardinality)h=d.cardinality;else{let v=!1;h=c.reduce((g,b)=>{const _=yr.getCardinality(b);return _.value===0&&(v=!0),{type:_.type==="estimate"?"estimate":g.type,value:g.value*(f?Math.max(1,_.value):_.value)}},{type:"exact",value:1}),(!v||f)&&(h.value*=(await this.mediatorJoinSelectivity.mediate({entries:s,context:l})).selectivity,h.value===0&&(h.value=Number.MIN_VALUE))}return{state:this.constructState(c),...d,cardinality:{type:h.type,value:h.value},variables:yr.joinVariables(l.getSafe(n.KeysInitQuery.dataFactory),c,f)}}static async sortJoinEntries(s,c,l){if(c.some(v=>v.metadata.variables.some(g=>g.canBeUndef)))return(0,t.passTest)(c);const f={};for(const v of c)for(const g of v.metadata.variables){let b=f[g.variable.value];b||(b=0),f[g.variable.value]=++b}const h=[];for(const[v,g]of Object.entries(f))g>=2&&h.push(v);return h.length===0?(0,t.failTest)("Bind join can only join entries with at least one common variable"):(0,t.passTest)((await s.mediate({entries:c,context:l})).entries)}async test(s){if(s.type!==this.logicalType)return(0,t.failTest)(`${this.name} can only handle logical joins of type '${this.logicalType}', while '${s.type}' was given.`);if(s.entries.length<=1)return(0,t.failTest)(`${this.name} requires at least two join entries.`);if(this.limitEntriesMin?s.entries.length<this.limitEntries:s.entries.length>this.limitEntries)return(0,t.failTest)(`${this.name} requires ${this.limitEntries} join entries at ${this.limitEntriesMin?"least":"most"}. The input contained ${s.entries.length}.`);for(const d of s.entries)if(d.output.type!=="bindings")return(0,t.failTest)(`Invalid type of a join entry: Expected 'bindings' but got '${d.output.type}'`);const c=await yr.getMetadatas(s.entries);let l;return!this.canHandleUndefs&&(l=yr.overlappingVariables(c),l.some(d=>d.canBeUndef))?(0,t.failTest)(`Actor ${this.name} can not join streams containing undefs`):this.requiresVariableOverlap&&(l??yr.overlappingVariables(c)).length===0?(0,t.failTest)(`Actor ${this.name} can only join entries with at least one common variable`):await this.getJoinCoefficients(s,{metadatas:c})}async run(s,c){let l;s.context.has(n.KeysInitQuery.physicalQueryPlanLogger)&&(l=s.context.get(n.KeysInitQuery.physicalQueryPlanNode),s.context=s.context.set(n.KeysInitQuery.physicalQueryPlanNode,s));const d=s.context.get(n.KeysInitQuery.physicalQueryPlanLogger);let f;this.includeInLogs&&d&&(f={},d.stashChildren(l,g=>g.logicalOperator.startsWith("join")),d.logOperation(`join-${this.logicalType}`,this.physicalName,s,l,this.name,f));const{result:h,physicalPlanMetadata:v}=await this.getOutput(s,c);if(f){(0,r.instrumentIterator)(h.bindingsStream).then(b=>{d.appendMetadata(s,{cardinalityReal:b.count,timeSelf:b.timeSelf,timeLife:b.timeLife})}),Object.assign(f,v);const g=c.metadatas.map(yr.getCardinality);if(f.cardinalities=g,f.joinCoefficients=(await this.getJoinCoefficients(s,c)).getOrThrow(),this.isLeaf)for(let b=0;b<s.entries.length;b++){const _=s.entries[b];d.unstashChild(_.operation,s),d.appendMetadata(_.operation,{cardinality:g[b]})}}return h.metadata=(0,a.cachifyMetadata)(h.metadata),h}};return ActorRdfJoin.ActorRdfJoin=o,ActorRdfJoin}var hasRequiredLib$1H;function requireLib$1H(){return hasRequiredLib$1H||(hasRequiredLib$1H=1,function(n){var t=lib$1H&&lib$1H.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1H&&lib$1H.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoin(),n)}(lib$1H)),lib$1H}var hasRequiredActorRdfJoinSingle;function requireActorRdfJoinSingle(){if(hasRequiredActorRdfJoinSingle)return ActorRdfJoinSingle;hasRequiredActorRdfJoinSingle=1,Object.defineProperty(ActorRdfJoinSingle,"__esModule",{value:!0}),ActorRdfJoinSingle.ActorRdfJoinSingle=void 0;const n=requireLib$1H(),t=requireLib$4s();let r=class extends n.ActorRdfJoin{constructor(o){super(o,{logicalType:"inner",physicalName:"single",limitEntries:1}),this.includeInLogs=!1}async test(o){return o.entries.length!==1?(0,t.failTest)(`Actor ${this.name} can only join a single entry`):await this.getJoinCoefficients(o,void 0)}async getOutput(o){return{result:o.entries[0].output}}async getJoinCoefficients(o,u){return(0,t.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},u)}};return ActorRdfJoinSingle.ActorRdfJoinSingle=r,ActorRdfJoinSingle}var hasRequiredLib$1G;function requireLib$1G(){return hasRequiredLib$1G||(hasRequiredLib$1G=1,function(n){var t=lib$1I&&lib$1I.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1I&&lib$1I.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinSingle(),n)}(lib$1I)),lib$1I}var lib$1F={},ActorRdfJoinMultiEmpty={},hasRequiredActorRdfJoinMultiEmpty;function requireActorRdfJoinMultiEmpty(){if(hasRequiredActorRdfJoinMultiEmpty)return ActorRdfJoinMultiEmpty;hasRequiredActorRdfJoinMultiEmpty=1,Object.defineProperty(ActorRdfJoinMultiEmpty,"__esModule",{value:!0}),ActorRdfJoinMultiEmpty.ActorRdfJoinMultiEmpty=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$4l(),o=requireAsynciterator();let u=class extends n.ActorRdfJoin{constructor(c){super(c,{logicalType:"inner",physicalName:"multi-empty",canHandleUndefs:!0})}async test(c){return(await n.ActorRdfJoin.getMetadatas(c.entries)).every(l=>n.ActorRdfJoin.getCardinality(l).value>0)?(0,r.failTest)(`Actor ${this.name} can only join entries where at least one is empty`):super.test(c)}async getOutput(c){for(const d of c.entries)d.output.bindingsStream.close();const l=c.context.getSafe(t.KeysInitQuery.dataFactory);return{result:{bindingsStream:new o.ArrayIterator([],{autoStart:!1}),metadata:async()=>({state:new a.MetadataValidationState,cardinality:{type:"exact",value:0},variables:n.ActorRdfJoin.joinVariables(l,await n.ActorRdfJoin.getMetadatas(c.entries))}),type:"bindings"}}}async getJoinCoefficients(c,l){return(0,r.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},l)}};return ActorRdfJoinMultiEmpty.ActorRdfJoinMultiEmpty=u,ActorRdfJoinMultiEmpty}var hasRequiredLib$1F;function requireLib$1F(){return hasRequiredLib$1F||(hasRequiredLib$1F=1,function(n){var t=lib$1F&&lib$1F.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1F&&lib$1F.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMultiEmpty(),n)}(lib$1F)),lib$1F}var lib$1E={},ActorRdfJoinHash={},lib$1D={},BindingsIndexDef={},hasRequiredBindingsIndexDef;function requireBindingsIndexDef(){if(hasRequiredBindingsIndexDef)return BindingsIndexDef;hasRequiredBindingsIndexDef=1,Object.defineProperty(BindingsIndexDef,"__esModule",{value:!0}),BindingsIndexDef.BindingsIndexDef=void 0;let n=class{constructor(r,a){this.keys=r.map(o=>o.variable),this.hashFn=a,this.index={}}put(r,a){return this.index[this.hashFn(r,this.keys)]=a}get(r){const a=this.getFirst(r);return a?[a]:[]}getFirst(r){return this.index[this.hashFn(r,this.keys)]}values(){return Object.values(this.index)}};return BindingsIndexDef.BindingsIndexDef=n,BindingsIndexDef}var BindingsIndexUndef={},hasRequiredBindingsIndexUndef;function requireBindingsIndexUndef(){if(hasRequiredBindingsIndexUndef)return BindingsIndexUndef;hasRequiredBindingsIndexUndef=1,Object.defineProperty(BindingsIndexUndef,"__esModule",{value:!0}),BindingsIndexUndef.BindingsIndexUndef=void 0;let n=class{constructor(r,a,o){this.data={},this.keys=r.map(u=>u.variable),this.hashFn=a,this.allowDisjointDomains=o&&this.keys.length>0}put(r,a){if(this.allowDisjointDomains||this.isBindingsValid(r)){let o=this.data;for(let u=0;u<this.keys.length;u++){const s=this.keys[u],c=this.hashFn(r.get(s));let l=o[c];l||(l=o[c]=u===this.keys.length-1?a:{}),o=l}}return a}isBindingsValid(r){let a=!1;for(const o of this.keys)if(r.has(o)){a=!0;break}return a}get(r){return this.allowDisjointDomains||this.isBindingsValid(r)?this.getRecursive(r,this.keys,[this.data]):[]}getRecursive(r,a,o){if(a.length===0)return o;let u;[u,...a]=a;const s=[];for(const c of o){const l=this.hashFn(r==null?void 0:r.get(u));if(l){const d=[c[l],c[""]].filter(Boolean);if(d.length===0)continue;s.push(this.getRecursive(r,a,d))}else{const d=Object.values(c);if(d.length===0)continue;s.push(this.getRecursive(r,a,d))}}return s.flat()}getFirst(r,a=!0){if(this.allowDisjointDomains||this.isBindingsValid(r))return this.getRecursiveFirst(r,this.keys,[this.data],a)}getRecursiveFirst(r,a,o,u){if(a.length===0)return o[0];let s;[s,...a]=a;for(const c of o){const l=this.hashFn(r.get(s));if(l||!u){const d=[c[l],c[""]].filter(Boolean);if(d.length===0)continue;const f=this.getRecursiveFirst(r,a,d,u);if(f)return f}else{const d=Object.values(c);if(d.length===0)continue;const f=this.getRecursiveFirst(r,a,d,u);if(f)return f}}}values(){return this.keys.length===0?[]:this.getRecursive(void 0,this.keys,[this.data])}};return BindingsIndexUndef.BindingsIndexUndef=n,BindingsIndexUndef}var IBindingsIndex={},hasRequiredIBindingsIndex;function requireIBindingsIndex(){return hasRequiredIBindingsIndex||(hasRequiredIBindingsIndex=1,Object.defineProperty(IBindingsIndex,"__esModule",{value:!0})),IBindingsIndex}var hasRequiredLib$1E;function requireLib$1E(){return hasRequiredLib$1E||(hasRequiredLib$1E=1,function(n){var t=lib$1D&&lib$1D.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1D&&lib$1D.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireBindingsIndexDef(),n),r(requireBindingsIndexUndef(),n),r(requireIBindingsIndex(),n)}(lib$1D)),lib$1D}var DynamicNestedLoopJoin_1,hasRequiredDynamicNestedLoopJoin;function requireDynamicNestedLoopJoin(){if(hasRequiredDynamicNestedLoopJoin)return DynamicNestedLoopJoin_1;hasRequiredDynamicNestedLoopJoin=1;let n=requireAsynciterator(),t=n.MultiTransformIterator,r=n.SimpleTransformIterator;class a extends t{constructor(u,s,c,l){super(u,l),this.funRight=s,this.funJoin=c}_createTransformer(u){return new r(this.funRight(u),{transform:(s,c,l)=>{let d=this.funJoin(u,s);d!==null&&l(d),c()}})}}return DynamicNestedLoopJoin_1=a,DynamicNestedLoopJoin_1}var HashJoin_1,hasRequiredHashJoin;function requireHashJoin(){if(hasRequiredHashJoin)return HashJoin_1;hasRequiredHashJoin=1;let n=requireAsynciterator().AsyncIterator;class t extends n{constructor(a,o,u,s){super(),this.addedDataListener=!1,this.left=a,this.right=o,this.funHash=u,this.funJoin=s,this.leftMap=new Map,this.match=null,this.matches=[],this.matchIdx=0,this.left.on("error",l=>this.destroy(l)),this.right.on("error",l=>this.destroy(l)),this.readable=!1,this.left.on("end",c.bind(this));function c(){this.readable=!0,this.right.on("readable",()=>this.readable=!0),this.right.on("end",()=>{this.hasResults()||this._end()})}this.on("newListener",l=>{l==="data"&&this._addDataListenerIfNeeded()}),this.left.readable&&this._addDataListenerIfNeeded(),this.left.on("readable",()=>this._addDataListenerIfNeeded())}hasResults(){return!this.right.ended||this.matchIdx<this.matches.length}_end(){super._end(),this.left.destroy(),this.right.destroy()}read(){for(this._addDataListenerIfNeeded();;){if(this.ended||!this.readable)return null;for(;this.matchIdx<this.matches.length;){let o=this.matches[this.matchIdx++],u=this.funJoin(o,this.match);if(u!==null)return u}if(this.hasResults()||this._end(),this.match=this.right.read(),this.match===null)return this.readable=!1,null;let a=this.funHash(this.match);this.matches=this.leftMap.get(a)||[],this.matchIdx=0}}_addDataListenerIfNeeded(){this.addedDataListener||(this.addedDataListener=!0,this._addDataListener())}_addDataListener(){this.left.on("data",a.bind(this));function a(o){let u=this.funHash(o),s=this.leftMap.get(u);s||(s=[],this.leftMap.set(u,s)),s.push(o)}}}return HashJoin_1=t,HashJoin_1}var NestedLoopJoin_1,hasRequiredNestedLoopJoin;function requireNestedLoopJoin(){if(hasRequiredNestedLoopJoin)return NestedLoopJoin_1;hasRequiredNestedLoopJoin=1;const{MultiTransformIterator:n,SimpleTransformIterator:t,scheduleTask:r}=requireAsynciterator();class a extends n{constructor(u,s,c,l){super(u,l),this.right=s,this.funJoin=c,this.on("end",()=>this.right.close())}_end(){super._end(),r(()=>this.right.destroy())}_createTransformer(u){return new t(this.right.clone(),{transform:(s,c,l)=>{let d=this.funJoin(u,s);d!==null&&l(d),c()}})}}return NestedLoopJoin_1=a,NestedLoopJoin_1}var SymmetricHashJoin_1,hasRequiredSymmetricHashJoin;function requireSymmetricHashJoin(){if(hasRequiredSymmetricHashJoin)return SymmetricHashJoin_1;hasRequiredSymmetricHashJoin=1;let n=requireAsynciterator().AsyncIterator;class t extends n{constructor(a,o,u,s){super(),this.left=a,this.right=o,this.funHash=u,this.funJoin=s,this.usedLeft=!1,this.leftMap=new Map,this.rightMap=new Map,this.on("end",()=>this._cleanup()),this.match=null,this.matches=[],this.matchIdx=0,(this.left.readable||this.right.readable)&&(this.readable=!0),this.left.on("error",c=>this.destroy(c)),this.right.on("error",c=>this.destroy(c)),this.left.on("readable",()=>this.readable=!0),this.right.on("readable",()=>this.readable=!0),this.left.on("end",()=>{this.hasResults()||this._end()}),this.right.on("end",()=>{this.hasResults()||this._end()})}hasResults(){return!this.left.ended||!this.right.ended||!!this.matches&&this.matchIdx<this.matches.length}_cleanup(){this.leftMap=null,this.rightMap=null,this.matches=null}_end(){super._end(),this.left.destroy(),this.right.destroy()}read(){for(;;){if(this.ended)return null;for(;this.matchIdx<this.matches.length;){let u=this.matches[this.matchIdx++],s=this.usedLeft?this.funJoin(this.match,u):this.funJoin(u,this.match);if(s!==null)return s}this.hasResults()||this._end();let a=null;for(let u=0;u<2&&(a=this.usedLeft?this.right.read():this.left.read(),this.usedLeft=!this.usedLeft,a===null);++u);if(this.done||a===null)return this.readable=!1,null;let o=this.funHash(a);if(this.usedLeft&&this.right.done)this.leftMap=null;else if(this.left.done)this.rightMap=null;else{let u=this.usedLeft?this.leftMap:this.rightMap;u.has(o)||u.set(o,[]);let s=u.get(o);s||(s=[],u.set(o,s)),s.push(a)}this.match=a,this.matches=(this.usedLeft?this.rightMap:this.leftMap).get(o)||[],this.matchIdx=0}}}return SymmetricHashJoin_1=t,SymmetricHashJoin_1}var MergeIterator_1,hasRequiredMergeIterator;function requireMergeIterator(){if(hasRequiredMergeIterator)return MergeIterator_1;hasRequiredMergeIterator=1;let n=requireAsynciterator().AsyncIterator;class t extends n{constructor(a){super(),Array.isArray(a)||(a=Array.prototype.slice.call(arguments)),this.streams=a;for(let o of a)o.on("readable",()=>this.emit("readable")),o.on("end",()=>this._removeStream(o));this.streams.length===0&&this.close(),this.idx=this.streams.length-1}_removeStream(a){let o=this.streams.indexOf(a);o<0||(this.streams.splice(o,1),this.idx>=this.streams.length&&--this.idx,this.streams.length===0&&this._end())}close(){super.close();for(let a of this.streams)a.close()}read(){for(let a=0;a<this.streams.length;++a){this.idx=(this.idx+1)%this.streams.length;let o=this.streams[this.idx].read();if(o!==null)return o}return null}}return MergeIterator_1=t,MergeIterator_1}var asyncjoin,hasRequiredAsyncjoin;function requireAsyncjoin(){if(hasRequiredAsyncjoin)return asyncjoin;hasRequiredAsyncjoin=1;const n=requireDynamicNestedLoopJoin(),t=requireHashJoin(),r=requireNestedLoopJoin(),a=requireSymmetricHashJoin(),o=requireMergeIterator();return asyncjoin={DynamicNestedLoopJoin:n,HashJoin:t,NestedLoopJoin:r,SymmetricHashJoin:a,MergeStream:o},asyncjoin}var hasRequiredActorRdfJoinHash;function requireActorRdfJoinHash(){if(hasRequiredActorRdfJoinHash)return ActorRdfJoinHash;hasRequiredActorRdfJoinHash=1,Object.defineProperty(ActorRdfJoinHash,"__esModule",{value:!0}),ActorRdfJoinHash.ActorRdfJoinHash=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireLib$1E(),a=requireLib$1I(),o=requireAsynciterator(),u=requireAsyncjoin(),s=requireRdfString();let c=class extends n.ActorRdfJoin{constructor(d){super(d,{logicalType:"inner",physicalName:`hash-${d.canHandleUndefs?"undef":"def"}`,limitEntries:2,requiresVariableOverlap:!0,canHandleUndefs:d.canHandleUndefs})}async getOutput(d,f){const h=f.metadatas;let v;const g=n.ActorRdfJoin.overlappingVariables(h);if(this.canHandleUndefs){const b=f.entriesSorted[0].output,_=f.entriesSorted[1].output;v=new a.ClosableTransformIterator(async()=>{const S=new r.BindingsIndexUndef(g,T=>T&&T.termType!=="Variable"?(0,s.termToString)(T):"",!0);return await new Promise(T=>{b.bindingsStream.on("data",w=>{(S.getFirst(w,!1)??S.put(w,[])).push(w)}),b.bindingsStream.on("end",T),b.bindingsStream.on("error",w=>{v.emit("error",w)})}),new o.MultiTransformIterator(_.bindingsStream,{multiTransform:T=>new o.ArrayIterator(S.get(T).flat().map(w=>n.ActorRdfJoin.joinBindings(T,w)).filter(w=>w!==null),{autoStart:!1}),autoStart:!1})},{autoStart:!1,onClose(){b.bindingsStream.destroy(),_.bindingsStream.destroy()}})}else{const{hashFunction:b}=await this.mediatorHashBindings.mediate({context:d.context}),_=g.map(S=>S.variable);v=new u.HashJoin(f.entriesSorted[0].output.bindingsStream,f.entriesSorted[1].output.bindingsStream,S=>b(S,_),n.ActorRdfJoin.joinBindings)}return{result:{type:"bindings",bindingsStream:v,metadata:async()=>await this.constructResultMetadata(f.entriesSorted,h,d.context)}}}async getJoinCoefficients(d,f){let h=d.entries;f.metadatas[1].cardinality.value<f.metadatas[0].cardinality.value&&(f.metadatas=[f.metadatas[1],f.metadatas[0]],h=[d.entries[1],d.entries[0]]);const{metadatas:v}=f,g=n.ActorRdfJoin.getRequestInitialTimes(v),b=n.ActorRdfJoin.getRequestItemTimes(v);let _=v[0].cardinality.value+v[1].cardinality.value;return this.canHandleUndefs||(_*=.8),(0,t.passTestWithSideData)({iterations:_,persistedItems:v[0].cardinality.value,blockingItems:v[0].cardinality.value,requestTime:g[0]+v[0].cardinality.value*b[0]+g[1]+v[1].cardinality.value*b[1]},{...f,entriesSorted:h})}};return ActorRdfJoinHash.ActorRdfJoinHash=c,ActorRdfJoinHash}var hasRequiredLib$1D;function requireLib$1D(){return hasRequiredLib$1D||(hasRequiredLib$1D=1,function(n){var t=lib$1E&&lib$1E.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1E&&lib$1E.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinHash(),n)}(lib$1E)),lib$1E}var lib$1C={},ActorRdfJoinSymmetricHash={},hasRequiredActorRdfJoinSymmetricHash;function requireActorRdfJoinSymmetricHash(){if(hasRequiredActorRdfJoinSymmetricHash)return ActorRdfJoinSymmetricHash;hasRequiredActorRdfJoinSymmetricHash=1,Object.defineProperty(ActorRdfJoinSymmetricHash,"__esModule",{value:!0}),ActorRdfJoinSymmetricHash.ActorRdfJoinSymmetricHash=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireAsyncjoin();let a=class extends n.ActorRdfJoin{constructor(u){super(u,{logicalType:"inner",physicalName:"symmetric-hash",limitEntries:2,requiresVariableOverlap:!0})}async getOutput(u){const s=await n.ActorRdfJoin.getMetadatas(u.entries),c=n.ActorRdfJoin.overlappingVariables(s),{hashFunction:l}=await this.mediatorHashBindings.mediate({context:u.context}),d=c.map(h=>h.variable);return{result:{type:"bindings",bindingsStream:new r.SymmetricHashJoin(u.entries[0].output.bindingsStream,u.entries[1].output.bindingsStream,h=>l(h,d),n.ActorRdfJoin.joinBindings),metadata:async()=>await this.constructResultMetadata(u.entries,s,u.context)}}}async getJoinCoefficients(u,s){const{metadatas:c}=s,l=n.ActorRdfJoin.getRequestInitialTimes(c),d=n.ActorRdfJoin.getRequestItemTimes(c);return(0,t.passTestWithSideData)({iterations:c[0].cardinality.value+c[1].cardinality.value,persistedItems:c[0].cardinality.value+c[1].cardinality.value,blockingItems:0,requestTime:l[0]+c[0].cardinality.value*d[0]+l[1]+c[1].cardinality.value*d[1]},s)}};return ActorRdfJoinSymmetricHash.ActorRdfJoinSymmetricHash=a,ActorRdfJoinSymmetricHash}var hasRequiredLib$1C;function requireLib$1C(){return hasRequiredLib$1C||(hasRequiredLib$1C=1,function(n){var t=lib$1C&&lib$1C.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1C&&lib$1C.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinSymmetricHash(),n)}(lib$1C)),lib$1C}var lib$1B={},ActorRdfJoinNestedLoop={},hasRequiredActorRdfJoinNestedLoop;function requireActorRdfJoinNestedLoop(){if(hasRequiredActorRdfJoinNestedLoop)return ActorRdfJoinNestedLoop;hasRequiredActorRdfJoinNestedLoop=1,Object.defineProperty(ActorRdfJoinNestedLoop,"__esModule",{value:!0}),ActorRdfJoinNestedLoop.ActorRdfJoinNestedLoop=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireAsyncjoin();let a=class extends n.ActorRdfJoin{constructor(u){super(u,{logicalType:"inner",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(u){return{result:{type:"bindings",bindingsStream:new r.NestedLoopJoin(u.entries[0].output.bindingsStream,u.entries[1].output.bindingsStream,n.ActorRdfJoin.joinBindings,{autoStart:!1}),metadata:async()=>await this.constructResultMetadata(u.entries,await n.ActorRdfJoin.getMetadatas(u.entries),u.context)}}}async getJoinCoefficients(u,s){const{metadatas:c}=s,l=n.ActorRdfJoin.getRequestInitialTimes(c),d=n.ActorRdfJoin.getRequestItemTimes(c);return(0,t.passTestWithSideData)({iterations:c[0].cardinality.value*c[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:l[0]+c[0].cardinality.value*d[0]+l[1]+c[1].cardinality.value*d[1]},s)}};return ActorRdfJoinNestedLoop.ActorRdfJoinNestedLoop=a,ActorRdfJoinNestedLoop}var hasRequiredLib$1B;function requireLib$1B(){return hasRequiredLib$1B||(hasRequiredLib$1B=1,function(n){var t=lib$1B&&lib$1B.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1B&&lib$1B.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinNestedLoop(),n)}(lib$1B)),lib$1B}var lib$1A={},ActorRdfJoinMinusHash={},lib$1z={},Bindings={},bindingsToString={},hasRequiredBindingsToString;function requireBindingsToString(){if(hasRequiredBindingsToString)return bindingsToString;hasRequiredBindingsToString=1,Object.defineProperty(bindingsToString,"__esModule",{value:!0}),bindingsToString.bindingsToCompactString=bindingsToString.bindingsToString=void 0;const n=requireRdfString();function t(a){const o={};for(const u of a.keys())o[u.value]=(0,n.termToString)(a.get(u));return JSON.stringify(o,null,"  ")}bindingsToString.bindingsToString=t;function r(a,o){return o.map(u=>{const s=a.get(u);return s?(0,n.termToString)(s):""}).join("")}return bindingsToString.bindingsToCompactString=r,bindingsToString}var hasRequiredBindings;function requireBindings(){if(hasRequiredBindings)return Bindings;hasRequiredBindings=1,Object.defineProperty(Bindings,"__esModule",{value:!0}),Bindings.Bindings=void 0;const n=requireLib$4s(),t=require$$0$2,r=requireBindingsToString();let a=class kt{constructor(u,s,c){this.type="bindings",this.dataFactory=u,this.entries=s,this.contextHolder=c}has(u){return this.entries.has(typeof u=="string"?u:u.value)}get(u){return this.entries.get(typeof u=="string"?u:u.value)}set(u,s){return new kt(this.dataFactory,this.entries.set(typeof u=="string"?u:u.value,s),this.contextHolder)}delete(u){return new kt(this.dataFactory,this.entries.delete(typeof u=="string"?u:u.value),this.contextHolder)}keys(){return this.mapIterable(this.iteratorToIterable(this.entries.keys()),u=>this.dataFactory.variable(u))}values(){return this.iteratorToIterable(this.entries.values())}forEach(u){for(const[s,c]of this.entries.entries())u(c,this.dataFactory.variable(s))}get size(){return this.entries.size}[Symbol.iterator](){return this.mapIterable(this.iteratorToIterable(this.entries.entries()),([u,s])=>[this.dataFactory.variable(u),s])[Symbol.iterator]()}equals(u){var s;if(!u)return!1;if(this===u)return!0;if(this.size!==u.size)return!1;for(const c of this.keys())if(!((s=this.get(c))!=null&&s.equals(u.get(c))))return!1;return!0}filter(u){return new kt(this.dataFactory,(0,t.Map)(this.entries.filter((s,c)=>u(s,this.dataFactory.variable(c)))),this.contextHolder)}map(u){return new kt(this.dataFactory,(0,t.Map)(this.entries.map((s,c)=>u(s,this.dataFactory.variable(c)))),this.contextHolder)}merge(u){if(this.size<u.size&&u instanceof kt)return u.merge(this);let s=this.entries;if(u instanceof kt)for(const[c,l]of u.entries){const d=this.entries.get(c);if(d&&!d.equals(l))return;s=s.set(c,l)}else for(const[c,l]of u){const d=this.entries.get(c.value);if(d&&!d.equals(l))return;s=s.set(c.value,l)}return this.createBindingsWithContexts(s,u)}mergeWith(u,s){if(this.size<s.size&&s instanceof kt)return s.mergeWith(u,this);let c=this.entries;if(s instanceof kt)for(const[l,d]of s.entries){const f=this.entries.get(l);let h;f&&!f.equals(d)?h=u(f,d,this.dataFactory.variable(l)):h=d,c=c.set(l,h)}else for(const[l,d]of s){const f=this.entries.get(l.value);let h;f&&!f.equals(d)?h=u(f,d,l):h=d,c=c.set(l.value,h)}return this.createBindingsWithContexts(c,s)}createBindingsWithContexts(u,s){if(this.contextHolder&&this.contextHolder.context){let c=this.contextHolder.context;return"contextHolder"in s&&s.contextHolder&&s.contextHolder.context&&(c=kt.mergeContext(this.contextHolder.contextMergeHandlers,c,s.contextHolder.context)),new kt(this.dataFactory,u,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:c})}return new kt(this.dataFactory,u,s.contextHolder)}static mergeContext(u,s,c){const l=[...s.keys(),...c.keys()],d={},f={},h=new Set(c.keys().map(g=>g.name)),v=s.keys().filter(g=>h.has(g.name));for(const g of l){if(f[g.name]===1)continue;f[g.name]=1;const b=v.some(_=>_.name===g.name);if(u[g.name]&&b){d[g.name]=u[g.name].run(s.get(g),c.get(g));continue}if(!(!u[g.name]&&b)){if(!s.get(g)){d[g.name]=c.get(g);continue}c.get(g)||(d[g.name]=s.get(g))}}return new n.ActionContext(d)}setContextEntry(u,s){return this.setContextEntryRaw(u,s)}setContextEntryRaw(u,s){var c;return this.contextHolder&&this.contextHolder.context?new kt(this.dataFactory,this.entries,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:this.contextHolder.context.set(u,s)}):new kt(this.dataFactory,this.entries,{contextMergeHandlers:((c=this.contextHolder)==null?void 0:c.contextMergeHandlers)??{},context:new n.ActionContext().set(u,s)})}deleteContextEntry(u){return this.deleteContextEntryRaw(u)}deleteContextEntryRaw(u){var s;return this.contextHolder?new kt(this.dataFactory,this.entries,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:(s=this.contextHolder.context)==null?void 0:s.delete(u)}):new kt(this.dataFactory,this.entries)}getContext(){var u;return(u=this.contextHolder)==null?void 0:u.context}getContextEntry(u){var s;return(s=this.getContext())==null?void 0:s.get(u)}toString(){return(0,r.bindingsToString)(this)}*mapIterable(u,s){for(const c of u)yield s(c)}iteratorToIterable(u){return{[Symbol.iterator]:()=>u}}};return Bindings.Bindings=a,Bindings}var BindingsFactory={},hasRequiredBindingsFactory;function requireBindingsFactory(){if(hasRequiredBindingsFactory)return BindingsFactory;hasRequiredBindingsFactory=1,Object.defineProperty(BindingsFactory,"__esModule",{value:!0}),BindingsFactory.BindingsFactory=void 0;const n=require$$0$2,t=requireBindings();let r=class aa{constructor(o,u){this.dataFactory=o,this.contextMergeHandlers=u}static async create(o,u,s){return new aa(s,(await o.mediate({context:u})).mergeHandlers)}bindings(o=[]){return new t.Bindings(this.dataFactory,(0,n.Map)(o.map(([u,s])=>[u.value,s])),this.contextMergeHandlers?{contextMergeHandlers:this.contextMergeHandlers}:void 0)}fromBindings(o){return this.bindings([...o])}fromRecord(o){return this.bindings(Object.entries(o).map(([u,s])=>[this.dataFactory.variable(u),s]))}};return BindingsFactory.BindingsFactory=r,BindingsFactory}var hasRequiredLib$1A;function requireLib$1A(){return hasRequiredLib$1A||(hasRequiredLib$1A=1,function(n){var t=lib$1z&&lib$1z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1z&&lib$1z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireBindings(),n),r(requireBindingsFactory(),n),r(requireBindingsToString(),n)}(lib$1z)),lib$1z}var hasRequiredActorRdfJoinMinusHash;function requireActorRdfJoinMinusHash(){if(hasRequiredActorRdfJoinMinusHash)return ActorRdfJoinMinusHash;hasRequiredActorRdfJoinMinusHash=1,Object.defineProperty(ActorRdfJoinMinusHash,"__esModule",{value:!0}),ActorRdfJoinMinusHash.ActorRdfJoinMinusHash=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireLib$1A(),a=requireLib$1E(),o=requireLib$1I(),u=requireRdfString();let s=class oa extends n.ActorRdfJoin{constructor(l){super(l,{logicalType:"minus",physicalName:`hash-${l.canHandleUndefs?"undef":"def"}`,limitEntries:2,canHandleUndefs:l.canHandleUndefs})}static constructIndex(l,d){return l?new a.BindingsIndexUndef(d,f=>f&&f.termType!=="Variable"?(0,u.termToString)(f):"",!1):new a.BindingsIndexDef(d,r.bindingsToCompactString)}async getOutput(l){const d=l.entries[1].output,f=l.entries[0].output,h=await n.ActorRdfJoin.getMetadatas(l.entries),v=n.ActorRdfJoin.overlappingVariables(h);if(v.length===0)return d.bindingsStream.destroy(),{result:f};const g=new o.ClosableTransformIterator(async()=>{const b=oa.constructIndex(this.canHandleUndefs,v);return await new Promise(_=>{d.bindingsStream.on("data",S=>b.put(S,!0)),d.bindingsStream.on("end",_),d.bindingsStream.on("error",S=>g.emit("error",S))}),f.bindingsStream.filter(_=>!b.getFirst(_,!0))},{autoStart:!1,onClose(){d.bindingsStream.destroy(),f.bindingsStream.destroy()}});return{result:{type:"bindings",bindingsStream:g,metadata:f.metadata}}}async getJoinCoefficients(l,d){const{metadatas:f}=d,h=n.ActorRdfJoin.getRequestInitialTimes(f),v=n.ActorRdfJoin.getRequestItemTimes(f);let g=f[0].cardinality.value+f[1].cardinality.value;return this.canHandleUndefs||(g*=.8),(0,t.passTestWithSideData)({iterations:g,persistedItems:f[0].cardinality.value,blockingItems:f[0].cardinality.value,requestTime:h[0]+f[0].cardinality.value*v[0]+h[1]+f[1].cardinality.value*v[1]},d)}};return ActorRdfJoinMinusHash.ActorRdfJoinMinusHash=s,ActorRdfJoinMinusHash}var hasRequiredLib$1z;function requireLib$1z(){return hasRequiredLib$1z||(hasRequiredLib$1z=1,function(n){var t=lib$1A&&lib$1A.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1A&&lib$1A.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMinusHash(),n)}(lib$1A)),lib$1A}var lib$1y={},ActorRdfJoinOptionalHash={},hasRequiredActorRdfJoinOptionalHash;function requireActorRdfJoinOptionalHash(){if(hasRequiredActorRdfJoinOptionalHash)return ActorRdfJoinOptionalHash;hasRequiredActorRdfJoinOptionalHash=1,Object.defineProperty(ActorRdfJoinOptionalHash,"__esModule",{value:!0}),ActorRdfJoinOptionalHash.ActorRdfJoinOptionalHash=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireLib$1A(),a=requireLib$1E(),o=requireLib$1I(),u=requireAsynciterator(),s=requireRdfString();let c=class gi extends n.ActorRdfJoin{constructor(d){super(d,{logicalType:"optional",physicalName:`hash-${d.canHandleUndefs?"undef":"def"}-${d.blocking?"blocking":"nonblocking"}`,limitEntries:2,canHandleUndefs:d.canHandleUndefs,requiresVariableOverlap:!0})}static constructIndex(d,f){return d?new a.BindingsIndexUndef(f,h=>h&&h.termType!=="Variable"?(0,s.termToString)(h):"",!0):new a.BindingsIndexDef(f,r.bindingsToCompactString)}async getOutput(d){const f=d.entries[1].output,h=d.entries[0].output,v=await n.ActorRdfJoin.getMetadatas(d.entries),g=n.ActorRdfJoin.overlappingVariables(v);let b;return this.blocking?b=new o.ClosableTransformIterator(async()=>{const _=gi.constructIndex(this.canHandleUndefs,g);return await new Promise(S=>{f.bindingsStream.on("data",T=>{(_.getFirst(T,!0)??_.put(T,[])).push(T)}),f.bindingsStream.on("end",S),f.bindingsStream.on("error",T=>{b.emit("error",T)})}),new u.MultiTransformIterator(h.bindingsStream,{multiTransform:S=>new u.ArrayIterator(_.get(S).flat().map(T=>n.ActorRdfJoin.joinBindings(S,T)).filter(T=>T!==null),{autoStart:!1}),optional:!0,autoStart:!1})},{autoStart:!1,onClose(){f.bindingsStream.destroy(),h.bindingsStream.destroy()}}):b=new o.ClosableTransformIterator(async()=>{const _=gi.constructIndex(this.canHandleUndefs,g);let S=!0;return f.bindingsStream.on("data",T=>{(_.getFirst(T,!0)??_.put(T,new u.BufferedIterator({autoStart:!1})))._push(T)}),f.bindingsStream.on("end",()=>{for(const T of _.values())T.close();S=!1}),f.bindingsStream.on("error",T=>{b.emit("error",T)}),new u.MultiTransformIterator(h.bindingsStream,{multiTransform:T=>{let w=_.get(T);return w.length===0&&(S?w=[_.put(T,new u.BufferedIterator({autoStart:!1}))]:w=[]),new u.UnionIterator(w.map(R=>R.clone()),{autoStart:!1}).map(R=>n.ActorRdfJoin.joinBindings(T,R))},optional:!0,autoStart:!1})},{autoStart:!1,onClose(){f.bindingsStream.destroy(),h.bindingsStream.destroy()}}),{result:{type:"bindings",bindingsStream:b,metadata:async()=>await this.constructResultMetadata(d.entries,v,d.context,{},!0)}}}async getJoinCoefficients(d,f){const{metadatas:h}=f,v=n.ActorRdfJoin.getRequestInitialTimes(h),g=n.ActorRdfJoin.getRequestItemTimes(h);let b=h[0].cardinality.value+h[1].cardinality.value;return this.canHandleUndefs||(b*=.8),this.blocking&&(b*=.9),(0,t.passTestWithSideData)({iterations:b,persistedItems:h[0].cardinality.value,blockingItems:this.blocking?h[0].cardinality.value:0,requestTime:v[0]+h[0].cardinality.value*g[0]+v[1]+h[1].cardinality.value*g[1]},f)}};return ActorRdfJoinOptionalHash.ActorRdfJoinOptionalHash=c,ActorRdfJoinOptionalHash}var hasRequiredLib$1y;function requireLib$1y(){return hasRequiredLib$1y||(hasRequiredLib$1y=1,function(n){var t=lib$1y&&lib$1y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1y&&lib$1y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinOptionalHash(),n)}(lib$1y)),lib$1y}var lib$1x={},ActorRdfJoinOptionalNestedLoop={},hasRequiredActorRdfJoinOptionalNestedLoop;function requireActorRdfJoinOptionalNestedLoop(){if(hasRequiredActorRdfJoinOptionalNestedLoop)return ActorRdfJoinOptionalNestedLoop;hasRequiredActorRdfJoinOptionalNestedLoop=1,Object.defineProperty(ActorRdfJoinOptionalNestedLoop,"__esModule",{value:!0}),ActorRdfJoinOptionalNestedLoop.ActorRdfJoinOptionalNestedLoop=void 0;const n=requireLib$1H(),t=requireLib$4s(),r=requireAsyncjoin();let a=class extends n.ActorRdfJoin{constructor(u){super(u,{logicalType:"optional",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(u){return{result:{type:"bindings",bindingsStream:new r.NestedLoopJoin(u.entries[0].output.bindingsStream,u.entries[1].output.bindingsStream,n.ActorRdfJoin.joinBindings,{optional:!0,autoStart:!1}),metadata:async()=>await this.constructResultMetadata(u.entries,await n.ActorRdfJoin.getMetadatas(u.entries),u.context,{},!0)}}}async getJoinCoefficients(u,s){const{metadatas:c}=s,l=n.ActorRdfJoin.getRequestInitialTimes(c),d=n.ActorRdfJoin.getRequestItemTimes(c);return(0,t.passTestWithSideData)({iterations:c[0].cardinality.value*c[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:l[0]+c[0].cardinality.value*d[0]+l[1]+c[1].cardinality.value*d[1]},s)}};return ActorRdfJoinOptionalNestedLoop.ActorRdfJoinOptionalNestedLoop=a,ActorRdfJoinOptionalNestedLoop}var hasRequiredLib$1x;function requireLib$1x(){return hasRequiredLib$1x||(hasRequiredLib$1x=1,function(n){var t=lib$1x&&lib$1x.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1x&&lib$1x.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinOptionalNestedLoop(),n)}(lib$1x)),lib$1x}var lib$1w={},ActorDereferenceRdfParse={},lib$1v={},ActorDereferenceRdf={},hasRequiredActorDereferenceRdf;function requireActorDereferenceRdf(){if(hasRequiredActorDereferenceRdf)return ActorDereferenceRdf;hasRequiredActorDereferenceRdf=1,Object.defineProperty(ActorDereferenceRdf,"__esModule",{value:!0}),ActorDereferenceRdf.ActorDereferenceRdf=void 0;const n=requireLib$3O();let t=class extends n.ActorDereferenceParse{constructor(a){super(a)}};return ActorDereferenceRdf.ActorDereferenceRdf=t,ActorDereferenceRdf}var hasRequiredLib$1w;function requireLib$1w(){return hasRequiredLib$1w||(hasRequiredLib$1w=1,function(n){var t=lib$1v&&lib$1v.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1v&&lib$1v.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorDereferenceRdf(),n)}(lib$1v)),lib$1v}var hasRequiredActorDereferenceRdfParse;function requireActorDereferenceRdfParse(){if(hasRequiredActorDereferenceRdfParse)return ActorDereferenceRdfParse;hasRequiredActorDereferenceRdfParse=1,Object.defineProperty(ActorDereferenceRdfParse,"__esModule",{value:!0}),ActorDereferenceRdfParse.ActorDereferenceRdfParse=void 0;const n=requireLib$1w();let t=class extends n.ActorDereferenceRdf{constructor(a){super(a)}async getMetadata(a){return{baseIRI:a.url}}};return ActorDereferenceRdfParse.ActorDereferenceRdfParse=t,ActorDereferenceRdfParse}var hasRequiredLib$1v;function requireLib$1v(){return hasRequiredLib$1v||(hasRequiredLib$1v=1,function(n){var t=lib$1w&&lib$1w.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1w&&lib$1w.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorDereferenceRdfParse(),n)}(lib$1w)),lib$1w}var lib$1u={},ActorRdfParseHtmlScript={},HtmlScriptListener={},hasRequiredHtmlScriptListener;function requireHtmlScriptListener(){if(hasRequiredHtmlScriptListener)return HtmlScriptListener;hasRequiredHtmlScriptListener=1,Object.defineProperty(HtmlScriptListener,"__esModule",{value:!0}),HtmlScriptListener.HtmlScriptListener=void 0;const n=requireLib$4q(),t=requireBrowser(),r=requireRelativeToAbsoluteIri();let a=class on{constructor(u,s,c,l,d,f,h,v){this.textChunksJsonLd=[],this.endBarrier=1,this.passedScripts=0,this.isFinalJsonLdProcessing=!1,this.mediatorRdfParseHandle=u,this.cbQuad=s,this.cbError=c,this.cbEnd=l,this.supportedTypes=d,this.context=f.set(n.KeysRdfParseHtmlScript.processingHtmlScript,!0),this.baseIRI=h,this.headers=v,this.onlyFirstScript=f.get(n.KeysRdfParseHtmlScript.extractAllScripts)===!1;const g=this.baseIRI.indexOf("#");this.targetScriptId=g>0?this.baseIRI.slice(g+1,this.baseIRI.length):null}static newErrorCoded(u,s){const c=new Error(u);return c.code=s,c}onEnd(){--this.endBarrier===0&&(this.textChunksJsonLd.length>0?(this.handleMediaType="application/ld+json",this.textChunks=this.textChunksJsonLd,this.textChunks.push("]"),this.textChunksJsonLd=[],this.isFinalJsonLdProcessing=!0,this.endBarrier++,this.onTagClose()):(this.passedScripts===0&&this.targetScriptId&&this.cbError(on.newErrorCoded(`Failed to find targeted script id "${this.targetScriptId}"`,"loading document failed")),this.cbEnd()),this.isFinalJsonLdProcessing=!1)}onTagClose(){if(this.handleMediaType)if(this.requiresCustomJsonLdHandling(this.handleMediaType)&&!this.isFinalJsonLdProcessing)this.handleMediaType=void 0,this.textChunks=void 0,this.onEnd();else{const u=new t.Readable({objectMode:!0});u._read=()=>{};const s=this.textChunks,c={context:this.context,handle:{metadata:{baseIRI:this.baseIRI},data:u,headers:this.headers,context:this.context},handleMediaType:this.handleMediaType};this.mediatorRdfParseHandle.mediate(c).then(({handle:l})=>{l.data.on("error",d=>this.cbError(on.newErrorCoded(d.message,"invalid script element"))).on("data",this.cbQuad).on("end",()=>this.onEnd());for(const d of s)u.push(d);u.push(null)}).catch(l=>{this.targetScriptId?this.cbError(on.newErrorCoded(l.message,"loading document failed")):this.onEnd()}),this.handleMediaType=void 0,this.textChunks=void 0}}onTagOpen(u,s){u==="base"&&s.href&&(this.baseIRI=(0,r.resolve)(s.href,this.baseIRI)),u==="script"&&(!this.targetScriptId||s.id===this.targetScriptId)?this.supportedTypes[s.type]?this.onlyFirstScript&&this.passedScripts>0?this.handleMediaType=void 0:(this.passedScripts++,this.handleMediaType=s.type,this.endBarrier++,this.requiresCustomJsonLdHandling(this.handleMediaType)?(this.textChunks=this.textChunksJsonLd,this.textChunks.push(this.textChunks.length===0?"[":",")):this.textChunks=[]):this.targetScriptId&&this.cbError(on.newErrorCoded(`Targeted script "${this.targetScriptId}" does not have a supported type`,"loading document failed")):this.handleMediaType=void 0}onText(u){this.handleMediaType&&this.textChunks.push(u)}requiresCustomJsonLdHandling(u){return!this.onlyFirstScript&&!this.targetScriptId&&u==="application/ld+json"}};return HtmlScriptListener.HtmlScriptListener=a,HtmlScriptListener}var hasRequiredActorRdfParseHtmlScript;function requireActorRdfParseHtmlScript(){if(hasRequiredActorRdfParseHtmlScript)return ActorRdfParseHtmlScript;hasRequiredActorRdfParseHtmlScript=1,Object.defineProperty(ActorRdfParseHtmlScript,"__esModule",{value:!0}),ActorRdfParseHtmlScript.ActorRdfParseHtmlScript=void 0;const n=requireLib$3f(),t=requireLib$4s(),r=requireHtmlScriptListener();let a=class extends n.ActorRdfParseHtml{constructor(u){super(u)}async test(u){return(0,t.passTestVoid)()}async run(u){const s=(await this.mediatorRdfParseMediatypes.mediate({context:u.context,mediaTypes:!0})).mediaTypes;return{htmlParseListener:new r.HtmlScriptListener(this.mediatorRdfParseHandle,u.emit,u.error,u.end,s,u.context,u.baseIRI,u.headers)}}};return ActorRdfParseHtmlScript.ActorRdfParseHtmlScript=a,ActorRdfParseHtmlScript}var hasRequiredLib$1u;function requireLib$1u(){return hasRequiredLib$1u||(hasRequiredLib$1u=1,function(n){var t=lib$1u&&lib$1u.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1u&&lib$1u.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseHtmlScript(),n)}(lib$1u)),lib$1u}var lib$1t={},ActorQueryResultSerializeRdf={},hasRequiredActorQueryResultSerializeRdf;function requireActorQueryResultSerializeRdf(){if(hasRequiredActorQueryResultSerializeRdf)return ActorQueryResultSerializeRdf;hasRequiredActorQueryResultSerializeRdf=1,Object.defineProperty(ActorQueryResultSerializeRdf,"__esModule",{value:!0}),ActorQueryResultSerializeRdf.ActorQueryResultSerializeRdf=void 0;const n=requireLib$3Y(),t=requireLib$4s();let r=class extends n.ActorQueryResultSerialize{constructor(o){super(o)}async testHandle(o,u,s){if(o.type!=="quads")return(0,t.failTest)(`Actor ${this.name} can only handle quad streams`);const{mediaTypes:c}=await this.mediatorMediaTypeCombiner.mediate({context:s,mediaTypes:!0});return u in c?(0,t.passTestVoid)():(0,t.failTest)(`Actor ${this.name} can not handle media type ${u}. All available types: ${Object.keys(c)}`)}async runHandle(o,u,s){return(await this.mediatorRdfSerialize.mediate({context:s,handle:{context:s,quadStream:o.quadStream},handleMediaType:u})).handle}async testMediaType(o){return(0,t.passTestVoid)()}async getMediaTypes(o){return(await this.mediatorMediaTypeCombiner.mediate({context:o,mediaTypes:!0})).mediaTypes}async testMediaTypeFormats(o){return(0,t.passTestVoid)()}async getMediaTypeFormats(o){return(await this.mediatorMediaTypeFormatCombiner.mediate({context:o,mediaTypeFormats:!0})).mediaTypeFormats}};return ActorQueryResultSerializeRdf.ActorQueryResultSerializeRdf=r,ActorQueryResultSerializeRdf}var hasRequiredLib$1t;function requireLib$1t(){return hasRequiredLib$1t||(hasRequiredLib$1t=1,function(n){var t=lib$1t&&lib$1t.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1t&&lib$1t.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryResultSerializeRdf(),n)}(lib$1t)),lib$1t}var lib$1s={},ActorBindingsAggregatorFactoryCount={},lib$1r={},ActorBindingsAggregatorFactory={},hasRequiredActorBindingsAggregatorFactory;function requireActorBindingsAggregatorFactory(){if(hasRequiredActorBindingsAggregatorFactory)return ActorBindingsAggregatorFactory;hasRequiredActorBindingsAggregatorFactory=1,Object.defineProperty(ActorBindingsAggregatorFactory,"__esModule",{value:!0}),ActorBindingsAggregatorFactory.ActorBindingsAggregatorFactory=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a),this.mediatorExpressionEvaluatorFactory=a.mediatorExpressionEvaluatorFactory}};return ActorBindingsAggregatorFactory.ActorBindingsAggregatorFactory=t,ActorBindingsAggregatorFactory}var AggregateEvaluator={},hasRequiredAggregateEvaluator;function requireAggregateEvaluator(){if(hasRequiredAggregateEvaluator)return AggregateEvaluator;hasRequiredAggregateEvaluator=1,Object.defineProperty(AggregateEvaluator,"__esModule",{value:!0}),AggregateEvaluator.AggregateEvaluator=void 0;const n=requireLib$4q(),t=requireLib$4n(),r=requireRdfString();let a=class{constructor(u,s,c=!1){this.evaluator=u,this.distinct=s,this.throwError=c,this.errorOccurred=!1,this.errorOccurred=!1,this.superTypeProvider=u.context.getSafe(n.KeysExpressionEvaluator.superTypeProvider),this.termTransformer=new t.TermTransformer(this.superTypeProvider),this.variableValues=new Set}emptyValueTerm(){}emptyValue(){const u=this.emptyValueTerm();if(u===void 0&&this.throwError)throw new t.EmptyAggregateError;return u}async putBindings(u){if(!this.errorOccurred)try{const s=await this.evaluator.evaluate(u);if(!s||this.errorOccurred)return;(!this.distinct||!this.variableValues.has(r.termToString(s)))&&(this.putTerm(s),this.distinct&&this.variableValues.add(r.termToString(s)))}catch(s){this.safeThrow(s)}}async result(){if(!this.errorOccurred)return this.termResult()}safeThrow(u){if(this.throwError)throw u;this.errorOccurred=!0}termToNumericOrError(u){if(u.termType!=="Literal")throw new Error(`Term with value ${u.value} has type ${u.termType} and is not a numeric literal`);if(!t.isSubTypeOf(u.datatype.value,t.TypeAlias.SPARQL_NUMERIC,this.superTypeProvider))throw new Error(`Term datatype ${u.datatype.value} with value ${u.value} has type ${u.termType} and is not a numeric literal`);return this.termTransformer.transformLiteral(u)}};return AggregateEvaluator.AggregateEvaluator=a,AggregateEvaluator}var hasRequiredLib$1s;function requireLib$1s(){return hasRequiredLib$1s||(hasRequiredLib$1s=1,function(n){var t=lib$1r&&lib$1r.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1r&&lib$1r.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactory(),n),r(requireAggregateEvaluator(),n)}(lib$1r)),lib$1r}var CountAggregator={},hasRequiredCountAggregator;function requireCountAggregator(){if(hasRequiredCountAggregator)return CountAggregator;hasRequiredCountAggregator=1,Object.defineProperty(CountAggregator,"__esModule",{value:!0}),CountAggregator.CountAggregator=void 0;const n=requireLib$1s(),t=requireLib$4n();let r=class extends n.AggregateEvaluator{constructor(o,u,s){super(o,u,s),this.state=void 0}emptyValueTerm(){return(0,t.typedLiteral)("0",t.TypeURL.XSD_INTEGER)}putTerm(o){this.state===void 0&&(this.state=0),this.state++}termResult(){return this.state===void 0?this.emptyValue():(0,t.typedLiteral)(String(this.state),t.TypeURL.XSD_INTEGER)}};return CountAggregator.CountAggregator=r,CountAggregator}var hasRequiredActorBindingsAggregatorFactoryCount;function requireActorBindingsAggregatorFactoryCount(){if(hasRequiredActorBindingsAggregatorFactoryCount)return ActorBindingsAggregatorFactoryCount;hasRequiredActorBindingsAggregatorFactoryCount=1,Object.defineProperty(ActorBindingsAggregatorFactoryCount,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryCount.ActorBindingsAggregatorFactoryCount=void 0;const n=requireLib$1s(),t=requireLib$4s(),r=requireSparqlalgebrajs(),a=requireCountAggregator();let o=class extends n.ActorBindingsAggregatorFactory{constructor(s){super(s)}async test(s){return s.expr.aggregator!=="count"||s.expr.expression.expressionType===r.Algebra.expressionTypes.WILDCARD?(0,t.failTest)("This actor only supports the 'count' aggregator without wildcard."):(0,t.passTestVoid)()}async run({context:s,expr:c}){return new a.CountAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:s}),c.distinct)}};return ActorBindingsAggregatorFactoryCount.ActorBindingsAggregatorFactoryCount=o,ActorBindingsAggregatorFactoryCount}var hasRequiredLib$1r;function requireLib$1r(){return hasRequiredLib$1r||(hasRequiredLib$1r=1,function(n){var t=lib$1s&&lib$1s.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1s&&lib$1s.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryCount(),n),r(requireCountAggregator(),n)}(lib$1s)),lib$1s}var lib$1q={},ActorBindingsAggregatorFactoryGroupConcat={},GroupConcatAggregator={},hasRequiredGroupConcatAggregator;function requireGroupConcatAggregator(){if(hasRequiredGroupConcatAggregator)return GroupConcatAggregator;hasRequiredGroupConcatAggregator=1,Object.defineProperty(GroupConcatAggregator,"__esModule",{value:!0}),GroupConcatAggregator.GroupConcatAggregator=void 0;const n=requireLib$1s(),t=requireLib$4n();let r=class extends n.AggregateEvaluator{constructor(o,u,s,c,l){super(o,u,l),this.dataFactory=s,this.state=void 0,this.lastLanguageValid=!0,this.lastLanguage=void 0,this.separator=c??" "}emptyValueTerm(){return t.typedLiteral("",t.TypeURL.XSD_STRING)}putTerm(o){this.state===void 0?(this.state=o.value,o.termType==="Literal"&&(this.lastLanguage=o.language)):(this.state+=this.separator+o.value,this.lastLanguageValid&&o.termType==="Literal"&&this.lastLanguage!==o.language&&(this.lastLanguageValid=!1,this.lastLanguage=void 0))}termResult(){return this.state===void 0?this.emptyValue():this.lastLanguageValid&&this.lastLanguage?t.langString(this.state,this.lastLanguage).toRDF(this.dataFactory):t.typedLiteral(this.state,t.TypeURL.XSD_STRING)}};return GroupConcatAggregator.GroupConcatAggregator=r,GroupConcatAggregator}var hasRequiredActorBindingsAggregatorFactoryGroupConcat;function requireActorBindingsAggregatorFactoryGroupConcat(){if(hasRequiredActorBindingsAggregatorFactoryGroupConcat)return ActorBindingsAggregatorFactoryGroupConcat;hasRequiredActorBindingsAggregatorFactoryGroupConcat=1,Object.defineProperty(ActorBindingsAggregatorFactoryGroupConcat,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryGroupConcat.ActorBindingsAggregatorFactoryGroupConcat=void 0;const n=requireLib$1s(),t=requireLib$4q(),r=requireLib$4s(),a=requireGroupConcatAggregator();let o=class extends n.ActorBindingsAggregatorFactory{constructor(s){super(s)}async test(s){return s.expr.aggregator!=="group_concat"?(0,r.failTest)("This actor only supports the 'group_concat' aggregator."):(0,r.passTestVoid)()}async run({context:s,expr:c}){return new a.GroupConcatAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:s}),c.distinct,s.getSafe(t.KeysInitQuery.dataFactory),c.separator)}};return ActorBindingsAggregatorFactoryGroupConcat.ActorBindingsAggregatorFactoryGroupConcat=o,ActorBindingsAggregatorFactoryGroupConcat}var hasRequiredLib$1q;function requireLib$1q(){return hasRequiredLib$1q||(hasRequiredLib$1q=1,function(n){var t=lib$1q&&lib$1q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1q&&lib$1q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryGroupConcat(),n),r(requireGroupConcatAggregator(),n)}(lib$1q)),lib$1q}var lib$1p={},ActorBindingsAggregatorFactorySample={},SampleAggregator={},hasRequiredSampleAggregator;function requireSampleAggregator(){if(hasRequiredSampleAggregator)return SampleAggregator;hasRequiredSampleAggregator=1,Object.defineProperty(SampleAggregator,"__esModule",{value:!0}),SampleAggregator.SampleAggregator=void 0;const n=requireLib$1s();let t=class extends n.AggregateEvaluator{constructor(a,o,u){super(a,o,u),this.state=void 0}putTerm(a){this.state===void 0&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return SampleAggregator.SampleAggregator=t,SampleAggregator}var hasRequiredActorBindingsAggregatorFactorySample;function requireActorBindingsAggregatorFactorySample(){if(hasRequiredActorBindingsAggregatorFactorySample)return ActorBindingsAggregatorFactorySample;hasRequiredActorBindingsAggregatorFactorySample=1,Object.defineProperty(ActorBindingsAggregatorFactorySample,"__esModule",{value:!0}),ActorBindingsAggregatorFactorySample.ActorBindingsAggregatorFactorySample=void 0;const n=requireLib$1s(),t=requireLib$4s(),r=requireSampleAggregator();let a=class extends n.ActorBindingsAggregatorFactory{constructor(u){super(u)}async test(u){return u.expr.aggregator!=="sample"?(0,t.failTest)("This actor only supports the 'sample' aggregator."):(0,t.passTestVoid)()}async run({context:u,expr:s}){return new r.SampleAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:s.expression,context:u}),s.distinct)}};return ActorBindingsAggregatorFactorySample.ActorBindingsAggregatorFactorySample=a,ActorBindingsAggregatorFactorySample}var hasRequiredLib$1p;function requireLib$1p(){return hasRequiredLib$1p||(hasRequiredLib$1p=1,function(n){var t=lib$1p&&lib$1p.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1p&&lib$1p.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactorySample(),n),r(requireSampleAggregator(),n)}(lib$1p)),lib$1p}var lib$1o={},ActorBindingsAggregatorFactoryWildcardCount={},WildcardCountAggregator={},hasRequiredWildcardCountAggregator;function requireWildcardCountAggregator(){if(hasRequiredWildcardCountAggregator)return WildcardCountAggregator;hasRequiredWildcardCountAggregator=1,Object.defineProperty(WildcardCountAggregator,"__esModule",{value:!0}),WildcardCountAggregator.WildcardCountAggregator=void 0;const n=requireLib$1s(),t=requireLib$4n(),r=requireRdfString();let a=class extends n.AggregateEvaluator{constructor(u,s,c){super(u,s,c),this.bindingValues=new Map,this.state=void 0}putTerm(u){}async putBindings(u){this.handleDistinct(u)||(this.state===void 0&&(this.state=0),this.state+=1)}emptyValueTerm(){return(0,t.typedLiteral)("0",t.TypeURL.XSD_INTEGER)}termResult(){return this.state===void 0?this.emptyValue():(0,t.typedLiteral)(String(this.state),t.TypeURL.XSD_INTEGER)}handleDistinct(u){if(this.distinct){const s=[...u];s.sort((h,v)=>h[0].value.localeCompare(v[0].value));const c=s.map(([h])=>h.value).join(","),l=s.map(([,h])=>r.termToString(h)).join(","),d=this.bindingValues.get(c),f=d!==void 0&&d.has(l);return d||this.bindingValues.set(c,new Set),this.bindingValues.get(c).add(l),f}return!1}};return WildcardCountAggregator.WildcardCountAggregator=a,WildcardCountAggregator}var hasRequiredActorBindingsAggregatorFactoryWildcardCount;function requireActorBindingsAggregatorFactoryWildcardCount(){if(hasRequiredActorBindingsAggregatorFactoryWildcardCount)return ActorBindingsAggregatorFactoryWildcardCount;hasRequiredActorBindingsAggregatorFactoryWildcardCount=1,Object.defineProperty(ActorBindingsAggregatorFactoryWildcardCount,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryWildcardCount.ActorBindingsAggregatorFactoryWildcardCount=void 0;const n=requireLib$1s(),t=requireLib$4s(),r=requireWildcardCountAggregator();let a=class extends n.ActorBindingsAggregatorFactory{constructor(u){super(u)}async test(u){return u.expr.aggregator!=="count"||u.expr.expression.expressionType!=="wildcard"?(0,t.failTest)("This actor only supports the 'count' aggregator with wildcard."):(0,t.passTestVoid)()}async run({context:u,expr:s}){return new r.WildcardCountAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:s.expression,context:u}),s.distinct)}};return ActorBindingsAggregatorFactoryWildcardCount.ActorBindingsAggregatorFactoryWildcardCount=a,ActorBindingsAggregatorFactoryWildcardCount}var hasRequiredLib$1o;function requireLib$1o(){return hasRequiredLib$1o||(hasRequiredLib$1o=1,function(n){var t=lib$1o&&lib$1o.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1o&&lib$1o.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryWildcardCount(),n),r(requireWildcardCountAggregator(),n)}(lib$1o)),lib$1o}var lib$1n={},ActorBindingsAggregatorFactoryAverage={},AverageAggregator={},hasRequiredAverageAggregator;function requireAverageAggregator(){if(hasRequiredAverageAggregator)return AverageAggregator;hasRequiredAverageAggregator=1,Object.defineProperty(AverageAggregator,"__esModule",{value:!0}),AverageAggregator.AverageAggregator=void 0;const n=requireLib$1s(),t=requireLib$4n();let r=class extends n.AggregateEvaluator{constructor(o,u,s,c,l,d){super(o,u,d),this.dataFactory=s,this.additionFunction=c,this.divisionFunction=l,this.state=void 0}emptyValueTerm(){return t.typedLiteral("0",t.TypeURL.XSD_INTEGER)}putTerm(o){if(this.state===void 0){const u=this.termToNumericOrError(o);this.state={sum:u,count:1}}else{const u=this.termToNumericOrError(o);this.state.sum=this.additionFunction.applyOnTerms([this.state.sum,u],this.evaluator),this.state.count++}}termResult(){if(this.state===void 0)return this.emptyValue();const o=new t.IntegerLiteral(this.state.count);return this.divisionFunction.applyOnTerms([this.state.sum,o],this.evaluator).toRDF(this.dataFactory)}};return AverageAggregator.AverageAggregator=r,AverageAggregator}var hasRequiredActorBindingsAggregatorFactoryAverage;function requireActorBindingsAggregatorFactoryAverage(){if(hasRequiredActorBindingsAggregatorFactoryAverage)return ActorBindingsAggregatorFactoryAverage;hasRequiredActorBindingsAggregatorFactoryAverage=1,Object.defineProperty(ActorBindingsAggregatorFactoryAverage,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryAverage.ActorBindingsAggregatorFactoryAverage=void 0;const n=requireLib$1s(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$4n(),o=requireAverageAggregator();let u=class extends n.ActorBindingsAggregatorFactory{constructor(c){super(c),this.mediatorFunctionFactory=c.mediatorFunctionFactory}async test(c){return c.expr.aggregator!=="avg"?(0,r.failTest)("This actor only supports the 'avg' aggregator."):(0,r.passTestVoid)()}async run({context:c,expr:l}){return new o.AverageAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:l.expression,context:c}),l.distinct,c.getSafe(t.KeysInitQuery.dataFactory),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.ADDITION,context:c,requireTermExpression:!0}),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.DIVISION,context:c,requireTermExpression:!0}))}};return ActorBindingsAggregatorFactoryAverage.ActorBindingsAggregatorFactoryAverage=u,ActorBindingsAggregatorFactoryAverage}var hasRequiredLib$1n;function requireLib$1n(){return hasRequiredLib$1n||(hasRequiredLib$1n=1,function(n){var t=lib$1n&&lib$1n.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1n&&lib$1n.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryAverage(),n),r(requireAverageAggregator(),n)}(lib$1n)),lib$1n}var lib$1m={},ActorBindingsAggregatorFactorySum={},SumAggregator={},hasRequiredSumAggregator;function requireSumAggregator(){if(hasRequiredSumAggregator)return SumAggregator;hasRequiredSumAggregator=1,Object.defineProperty(SumAggregator,"__esModule",{value:!0}),SumAggregator.SumAggregator=void 0;const n=requireLib$1s(),t=requireLib$4n();let r=class extends n.AggregateEvaluator{constructor(o,u,s,c,l){super(o,u,l),this.dataFactory=s,this.additionFunction=c,this.state=void 0}emptyValueTerm(){return(0,t.typedLiteral)("0",t.TypeURL.XSD_INTEGER)}putTerm(o){if(this.state===void 0)this.state=this.termToNumericOrError(o);else{const u=this.termToNumericOrError(o);this.state=this.additionFunction.applyOnTerms([this.state,u],this.evaluator)}}termResult(){return this.state===void 0?this.emptyValue():this.state.toRDF(this.dataFactory)}};return SumAggregator.SumAggregator=r,SumAggregator}var hasRequiredActorBindingsAggregatorFactorySum;function requireActorBindingsAggregatorFactorySum(){if(hasRequiredActorBindingsAggregatorFactorySum)return ActorBindingsAggregatorFactorySum;hasRequiredActorBindingsAggregatorFactorySum=1,Object.defineProperty(ActorBindingsAggregatorFactorySum,"__esModule",{value:!0}),ActorBindingsAggregatorFactorySum.ActorBindingsAggregatorFactorySum=void 0;const n=requireLib$1s(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$4n(),o=requireSumAggregator();let u=class extends n.ActorBindingsAggregatorFactory{constructor(c){super(c),this.mediatorFunctionFactory=c.mediatorFunctionFactory}async test(c){return c.expr.aggregator!=="sum"?(0,r.failTest)("This actor only supports the 'sum' aggregator."):(0,r.passTestVoid)()}async run({expr:c,context:l}){return new o.SumAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:l}),c.distinct,l.getSafe(t.KeysInitQuery.dataFactory),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.ADDITION,context:l,requireTermExpression:!0}))}};return ActorBindingsAggregatorFactorySum.ActorBindingsAggregatorFactorySum=u,ActorBindingsAggregatorFactorySum}var hasRequiredLib$1m;function requireLib$1m(){return hasRequiredLib$1m||(hasRequiredLib$1m=1,function(n){var t=lib$1m&&lib$1m.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1m&&lib$1m.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactorySum(),n),r(requireSumAggregator(),n)}(lib$1m)),lib$1m}var lib$1l={},ActorFunctionFactoryExpressionIn={},ExpressionFunctionIn={},hasRequiredExpressionFunctionIn;function requireExpressionFunctionIn(){if(hasRequiredExpressionFunctionIn)return ExpressionFunctionIn;hasRequiredExpressionFunctionIn=1,Object.defineProperty(ExpressionFunctionIn,"__esModule",{value:!0}),ExpressionFunctionIn.ExpressionFunctionIn=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(o){super({arity:Number.POSITIVE_INFINITY,operator:t.SparqlOperator.IN,apply:async u=>{const{args:s,mapping:c,exprEval:l}=u,[d,...f]=s,h=await l.evaluatorExpressionEvaluation(d,c);return await this.inRecursive(h,{...u,args:f},[])}}),this.equalityFunction=o}checkArity(o){return o.length>0}async inRecursive(o,u,s){const{args:c,mapping:l,exprEval:d}=u;if(c.length===0)return s.every(h=>!h)?(0,t.bool)(!1):Promise.reject(new t.InError(s));try{const f=c.shift(),h=await d.evaluatorExpressionEvaluation(f,l);return this.equalityFunction.applyOnTerms([o,h],d).typedValue?(0,t.bool)(!0):this.inRecursive(o,u,[...s,!1])}catch(f){return this.inRecursive(o,u,[...s,f])}}};return ExpressionFunctionIn.ExpressionFunctionIn=r,ExpressionFunctionIn}var hasRequiredActorFunctionFactoryExpressionIn;function requireActorFunctionFactoryExpressionIn(){if(hasRequiredActorFunctionFactoryExpressionIn)return ActorFunctionFactoryExpressionIn;hasRequiredActorFunctionFactoryExpressionIn=1,Object.defineProperty(ActorFunctionFactoryExpressionIn,"__esModule",{value:!0}),ActorFunctionFactoryExpressionIn.ActorFunctionFactoryExpressionIn=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionIn();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.IN],termFunction:!1}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.EQUAL,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.ExpressionFunctionIn(s)}};return ActorFunctionFactoryExpressionIn.ActorFunctionFactoryExpressionIn=a,ActorFunctionFactoryExpressionIn}var hasRequiredLib$1l;function requireLib$1l(){return hasRequiredLib$1l||(hasRequiredLib$1l=1,function(n){var t=lib$1l&&lib$1l.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1l&&lib$1l.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionIn(),n)}(lib$1l)),lib$1l}var lib$1k={},ActorFunctionFactoryExpressionNotIn={},ExpressionFunctionNotIn={},hasRequiredExpressionFunctionNotIn;function requireExpressionFunctionNotIn(){if(hasRequiredExpressionFunctionNotIn)return ExpressionFunctionNotIn;hasRequiredExpressionFunctionNotIn=1,Object.defineProperty(ExpressionFunctionNotIn,"__esModule",{value:!0}),ExpressionFunctionNotIn.ExpressionFunctionNotIn=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.ExpressionFunctionBase{constructor(o){super({arity:Number.POSITIVE_INFINITY,operator:t.SparqlOperator.NOT_IN,apply:async u=>{const s=await this.inFunction.apply(u);return(0,t.bool)(!s.typedValue)}}),this.inFunction=o}checkArity(o){return o.length>0}};return ExpressionFunctionNotIn.ExpressionFunctionNotIn=r,ExpressionFunctionNotIn}var hasRequiredActorFunctionFactoryExpressionNotIn;function requireActorFunctionFactoryExpressionNotIn(){if(hasRequiredActorFunctionFactoryExpressionNotIn)return ActorFunctionFactoryExpressionNotIn;hasRequiredActorFunctionFactoryExpressionNotIn=1,Object.defineProperty(ActorFunctionFactoryExpressionNotIn,"__esModule",{value:!0}),ActorFunctionFactoryExpressionNotIn.ActorFunctionFactoryExpressionNotIn=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireExpressionFunctionNotIn();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.NOT_IN],termFunction:!1}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.IN,context:u.context,arguments:u.arguments});return new r.ExpressionFunctionNotIn(s)}};return ActorFunctionFactoryExpressionNotIn.ActorFunctionFactoryExpressionNotIn=a,ActorFunctionFactoryExpressionNotIn}var hasRequiredLib$1k;function requireLib$1k(){return hasRequiredLib$1k||(hasRequiredLib$1k=1,function(n){var t=lib$1k&&lib$1k.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1k&&lib$1k.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryExpressionNotIn(),n)}(lib$1k)),lib$1k}var lib$1j={},ActorFunctionFactoryTermGreaterThanEqual={},TermFunctionGreaterThanEqual={},hasRequiredTermFunctionGreaterThanEqual;function requireTermFunctionGreaterThanEqual(){if(hasRequiredTermFunctionGreaterThanEqual)return TermFunctionGreaterThanEqual;hasRequiredTermFunctionGreaterThanEqual=1,Object.defineProperty(TermFunctionGreaterThanEqual,"__esModule",{value:!0}),TermFunctionGreaterThanEqual.TermFunctionGreaterThanEqual=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(o){super({arity:2,operator:t.SparqlOperator.GTE,overloads:(0,t.declare)(t.SparqlOperator.GTE).set(["term","term"],u=>([s,c])=>this.lessThanEqualFunction.applyOnTerms([c,s],u)).collect()}),this.lessThanEqualFunction=o}};return TermFunctionGreaterThanEqual.TermFunctionGreaterThanEqual=r,TermFunctionGreaterThanEqual}var hasRequiredActorFunctionFactoryTermGreaterThanEqual;function requireActorFunctionFactoryTermGreaterThanEqual(){if(hasRequiredActorFunctionFactoryTermGreaterThanEqual)return ActorFunctionFactoryTermGreaterThanEqual;hasRequiredActorFunctionFactoryTermGreaterThanEqual=1,Object.defineProperty(ActorFunctionFactoryTermGreaterThanEqual,"__esModule",{value:!0}),ActorFunctionFactoryTermGreaterThanEqual.ActorFunctionFactoryTermGreaterThanEqual=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionGreaterThanEqual();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.GTE],termFunction:!0}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.LTE,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.TermFunctionGreaterThanEqual(s)}};return ActorFunctionFactoryTermGreaterThanEqual.ActorFunctionFactoryTermGreaterThanEqual=a,ActorFunctionFactoryTermGreaterThanEqual}var hasRequiredLib$1j;function requireLib$1j(){return hasRequiredLib$1j||(hasRequiredLib$1j=1,function(n){var t=lib$1j&&lib$1j.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1j&&lib$1j.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermGreaterThanEqual(),n)}(lib$1j)),lib$1j}var lib$1i={},ActorFunctionFactoryTermGreaterThan={},TermFunctionGreaterThan={},hasRequiredTermFunctionGreaterThan;function requireTermFunctionGreaterThan(){if(hasRequiredTermFunctionGreaterThan)return TermFunctionGreaterThan;hasRequiredTermFunctionGreaterThan=1,Object.defineProperty(TermFunctionGreaterThan,"__esModule",{value:!0}),TermFunctionGreaterThan.TermFunctionGreaterThan=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(o){super({arity:2,operator:t.SparqlOperator.GT,overloads:(0,t.declare)(t.SparqlOperator.GT).set(["term","term"],u=>([s,c])=>this.lessThanFunction.applyOnTerms([c,s],u)).collect()}),this.lessThanFunction=o}};return TermFunctionGreaterThan.TermFunctionGreaterThan=r,TermFunctionGreaterThan}var hasRequiredActorFunctionFactoryTermGreaterThan;function requireActorFunctionFactoryTermGreaterThan(){if(hasRequiredActorFunctionFactoryTermGreaterThan)return ActorFunctionFactoryTermGreaterThan;hasRequiredActorFunctionFactoryTermGreaterThan=1,Object.defineProperty(ActorFunctionFactoryTermGreaterThan,"__esModule",{value:!0}),ActorFunctionFactoryTermGreaterThan.ActorFunctionFactoryTermGreaterThan=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionGreaterThan();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.GT],termFunction:!0}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.LT,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.TermFunctionGreaterThan(s)}};return ActorFunctionFactoryTermGreaterThan.ActorFunctionFactoryTermGreaterThan=a,ActorFunctionFactoryTermGreaterThan}var hasRequiredLib$1i;function requireLib$1i(){return hasRequiredLib$1i||(hasRequiredLib$1i=1,function(n){var t=lib$1i&&lib$1i.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1i&&lib$1i.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermGreaterThan(),n)}(lib$1i)),lib$1i}var lib$1h={},ActorFunctionFactoryTermInequality={},TermFunctionInequality={},hasRequiredTermFunctionInequality;function requireTermFunctionInequality(){if(hasRequiredTermFunctionInequality)return TermFunctionInequality;hasRequiredTermFunctionInequality=1,Object.defineProperty(TermFunctionInequality,"__esModule",{value:!0}),TermFunctionInequality.TermFunctionInequality=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(o){super({arity:2,operator:t.SparqlOperator.NOT_EQUAL,overloads:(0,t.declare)(t.SparqlOperator.NOT_EQUAL).set(["term","term"],u=>([s,c])=>(0,t.bool)(!this.equalityFunction.applyOnTerms([s,c],u).typedValue)).collect()}),this.equalityFunction=o}};return TermFunctionInequality.TermFunctionInequality=r,TermFunctionInequality}var hasRequiredActorFunctionFactoryTermInequality;function requireActorFunctionFactoryTermInequality(){if(hasRequiredActorFunctionFactoryTermInequality)return ActorFunctionFactoryTermInequality;hasRequiredActorFunctionFactoryTermInequality=1,Object.defineProperty(ActorFunctionFactoryTermInequality,"__esModule",{value:!0}),ActorFunctionFactoryTermInequality.ActorFunctionFactoryTermInequality=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionInequality();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.NOT_EQUAL],termFunction:!0}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.EQUAL,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.TermFunctionInequality(s)}};return ActorFunctionFactoryTermInequality.ActorFunctionFactoryTermInequality=a,ActorFunctionFactoryTermInequality}var hasRequiredLib$1h;function requireLib$1h(){return hasRequiredLib$1h||(hasRequiredLib$1h=1,function(n){var t=lib$1h&&lib$1h.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1h&&lib$1h.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermInequality(),n)}(lib$1h)),lib$1h}var lib$1g={},ActorFunctionFactoryTermLesserThanEqual={},TermFunctionLesserThanEqual={},hasRequiredTermFunctionLesserThanEqual;function requireTermFunctionLesserThanEqual(){if(hasRequiredTermFunctionLesserThanEqual)return TermFunctionLesserThanEqual;hasRequiredTermFunctionLesserThanEqual=1,Object.defineProperty(TermFunctionLesserThanEqual,"__esModule",{value:!0}),TermFunctionLesserThanEqual.TermFunctionLesserThanEqual=void 0;const n=requireLib$4m(),t=requireLib$4n();let r=class extends n.TermFunctionBase{constructor(o,u){super({arity:2,operator:t.SparqlOperator.LTE,overloads:(0,t.declare)(t.SparqlOperator.LTE).set(["term","term"],s=>([c,l])=>(0,t.bool)(this.lessThanFunction.applyOnTerms([c,l],s).typedValue||this.equalityFunction.applyOnTerms([c,l],s).typedValue)).collect()}),this.equalityFunction=o,this.lessThanFunction=u}};return TermFunctionLesserThanEqual.TermFunctionLesserThanEqual=r,TermFunctionLesserThanEqual}var hasRequiredActorFunctionFactoryTermLesserThanEqual;function requireActorFunctionFactoryTermLesserThanEqual(){if(hasRequiredActorFunctionFactoryTermLesserThanEqual)return ActorFunctionFactoryTermLesserThanEqual;hasRequiredActorFunctionFactoryTermLesserThanEqual=1,Object.defineProperty(ActorFunctionFactoryTermLesserThanEqual,"__esModule",{value:!0}),ActorFunctionFactoryTermLesserThanEqual.ActorFunctionFactoryTermLesserThanEqual=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionLesserThanEqual();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LTE],termFunction:!0}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.EQUAL,requireTermExpression:!0,context:u.context,arguments:u.arguments}),c=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.LT,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.TermFunctionLesserThanEqual(s,c)}};return ActorFunctionFactoryTermLesserThanEqual.ActorFunctionFactoryTermLesserThanEqual=a,ActorFunctionFactoryTermLesserThanEqual}var hasRequiredLib$1g;function requireLib$1g(){return hasRequiredLib$1g||(hasRequiredLib$1g=1,function(n){var t=lib$1g&&lib$1g.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1g&&lib$1g.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermLesserThanEqual(),n)}(lib$1g)),lib$1g}var lib$1f={},ActorFunctionFactoryTermLesserThan={},TermFunctionLesserThan={},hasRequiredTermFunctionLesserThan;function requireTermFunctionLesserThan(){if(hasRequiredTermFunctionLesserThan)return TermFunctionLesserThan;hasRequiredTermFunctionLesserThan=1,Object.defineProperty(TermFunctionLesserThan,"__esModule",{value:!0}),TermFunctionLesserThan.TermFunctionLesserThan=void 0;const n=requireLib$4m(),t=requireLib$4q(),r=requireLib$4n();let a=class extends n.TermFunctionBase{constructor(u){super({arity:2,operator:r.SparqlOperator.LT,overloads:(0,r.declare)(r.SparqlOperator.LT).numberTest(()=>(s,c)=>s<c).stringTest(()=>(s,c)=>s.localeCompare(c)===-1).booleanTest(()=>(s,c)=>s<c).dateTimeTest(s=>(c,l)=>(0,r.toUTCDate)(c,s.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()<(0,r.toUTCDate)(l,s.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()).copy({from:[r.TypeURL.XSD_DATE_TIME,r.TypeURL.XSD_DATE_TIME],to:[r.TypeURL.XSD_DATE,r.TypeURL.XSD_DATE]}).set([r.TypeURL.XSD_YEAR_MONTH_DURATION,r.TypeURL.XSD_YEAR_MONTH_DURATION],()=>([s,c])=>(0,r.bool)((0,r.yearMonthDurationsToMonths)((0,r.defaultedYearMonthDurationRepresentation)(s.typedValue))<(0,r.yearMonthDurationsToMonths)((0,r.defaultedYearMonthDurationRepresentation)(c.typedValue)))).set([r.TypeURL.XSD_DAY_TIME_DURATION,r.TypeURL.XSD_DAY_TIME_DURATION],()=>([s,c])=>(0,r.bool)((0,r.dayTimeDurationsToSeconds)((0,r.defaultedDayTimeDurationRepresentation)(s.typedValue))<(0,r.dayTimeDurationsToSeconds)((0,r.defaultedDayTimeDurationRepresentation)(c.typedValue)))).set([r.TypeURL.XSD_TIME,r.TypeURL.XSD_TIME],s=>([c,l])=>(0,r.bool)((0,r.toUTCDate)((0,r.defaultedDateTimeRepresentation)(c.typedValue),s.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime()<(0,r.toUTCDate)((0,r.defaultedDateTimeRepresentation)(l.typedValue),s.context.getSafe(t.KeysExpressionEvaluator.defaultTimeZone)).getTime())).set(["quad","quad"],s=>([c,l])=>{const d=this.quadComponentTest(c.subject,l.subject,s);if(d!==void 0)return(0,r.bool)(d);const f=this.quadComponentTest(c.predicate,l.predicate,s);if(f!==void 0)return(0,r.bool)(f);const h=this.quadComponentTest(c.object,l.object,s);return h!==void 0?(0,r.bool)(h):(0,r.bool)(this.quadComponentTest(c.graph,l.graph,s)??!1)},!1).collect()}),this.equalityFunction=u}quadComponentTest(u,s,c){return this.equalityFunction.applyOnTerms([u,s],c).typedValue?void 0:this.applyOnTerms([u,s],c).typedValue}};return TermFunctionLesserThan.TermFunctionLesserThan=a,TermFunctionLesserThan}var hasRequiredActorFunctionFactoryTermLesserThan;function requireActorFunctionFactoryTermLesserThan(){if(hasRequiredActorFunctionFactoryTermLesserThan)return ActorFunctionFactoryTermLesserThan;hasRequiredActorFunctionFactoryTermLesserThan=1,Object.defineProperty(ActorFunctionFactoryTermLesserThan,"__esModule",{value:!0}),ActorFunctionFactoryTermLesserThan.ActorFunctionFactoryTermLesserThan=void 0;const n=requireLib$4m(),t=requireLib$4n(),r=requireTermFunctionLesserThan();let a=class extends n.ActorFunctionFactoryDedicated{constructor(u){super({...u,functionNames:[t.SparqlOperator.LT],termFunction:!0}),this.mediatorFunctionFactory=u.mediatorFunctionFactory}async run(u){const s=await this.mediatorFunctionFactory.mediate({functionName:t.SparqlOperator.EQUAL,requireTermExpression:!0,context:u.context,arguments:u.arguments});return new r.TermFunctionLesserThan(s)}};return ActorFunctionFactoryTermLesserThan.ActorFunctionFactoryTermLesserThan=a,ActorFunctionFactoryTermLesserThan}var hasRequiredLib$1f;function requireLib$1f(){return hasRequiredLib$1f||(hasRequiredLib$1f=1,function(n){var t=lib$1f&&lib$1f.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1f&&lib$1f.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorFunctionFactoryTermLesserThan(),n)}(lib$1f)),lib$1f}var lib$1e={},ActorHttpWayback={},hasRequiredActorHttpWayback;function requireActorHttpWayback(){if(hasRequiredActorHttpWayback)return ActorHttpWayback;hasRequiredActorHttpWayback=1,Object.defineProperty(ActorHttpWayback,"__esModule",{value:!0}),ActorHttpWayback.ActorHttpWayback=void 0;const n=requireLib$1O(),t=requireLib$4q(),r=requireLib$4s(),a=requireDist$3(),o="http://wayback.archive-it.org/";function u(l){const d=new Request(l.input,l.init);return{input:new Request(new URL(`/${d.url}`,o),d)}}function s(l){const d=l.get(t.KeysHttpProxy.httpProxyHandler);return d?f=>d.getProxy(u(f)):f=>Promise.resolve(u(f))}let c=class extends n.ActorHttp{constructor(d){super(d)}async test(d){return(0,r.passTestVoid)()}async run(d){let f=await this.mediatorHttp.mediate(d);if(f.status===404&&d.context.get(t.KeysHttpWayback.recoverBrokenLinks)){let h=await this.mediatorHttp.mediate({...d,context:d.context.set(t.KeysHttpWayback.recoverBrokenLinks,!1).set(t.KeysHttpProxy.httpProxyHandler,{getProxy:s(d.context)})});h.status===200&&([f,h]=[h,f]);const{body:v}=h;v&&("cancel"in v&&typeof v.cancel=="function"?await v.cancel():"destroy"in v&&typeof v.destroy=="function"?v.destroy():await(0,a.stringify)(n.ActorHttp.toNodeReadable(v)))}return f}};return ActorHttpWayback.ActorHttpWayback=c,ActorHttpWayback}var hasRequiredLib$1e;function requireLib$1e(){return hasRequiredLib$1e||(hasRequiredLib$1e=1,function(n){var t=lib$1e&&lib$1e.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1e&&lib$1e.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttpWayback(),n)}(lib$1e)),lib$1e}var lib$1d={},ActorRdfParseJsonLd={},jsonldStreamingParser={},JsonLdParser={},jsonldContextParser$1={},ContextParser$1={},ErrorCoded$1={},hasRequiredErrorCoded$1;function requireErrorCoded$1(){return hasRequiredErrorCoded$1||(hasRequiredErrorCoded$1=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_CODES=n.ErrorCoded=void 0;class t extends Error{constructor(a,o){super(a),this.code=o}}n.ErrorCoded=t,function(r){r.COLLIDING_KEYWORDS="colliding keywords",r.CONFLICTING_INDEXES="conflicting indexes",r.CYCLIC_IRI_MAPPING="cyclic IRI mapping",r.INVALID_ID_VALUE="invalid @id value",r.INVALID_INDEX_VALUE="invalid @index value",r.INVALID_NEST_VALUE="invalid @nest value",r.INVALID_PREFIX_VALUE="invalid @prefix value",r.INVALID_PROPAGATE_VALUE="invalid @propagate value",r.INVALID_REVERSE_VALUE="invalid @reverse value",r.INVALID_IMPORT_VALUE="invalid @import value",r.INVALID_VERSION_VALUE="invalid @version value",r.INVALID_BASE_IRI="invalid base IRI",r.INVALID_CONTAINER_MAPPING="invalid container mapping",r.INVALID_CONTEXT_ENTRY="invalid context entry",r.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",r.INVALID_DEFAULT_LANGUAGE="invalid default language",r.INVALID_INCLUDED_VALUE="invalid @included value",r.INVALID_IRI_MAPPING="invalid IRI mapping",r.INVALID_JSON_LITERAL="invalid JSON literal",r.INVALID_KEYWORD_ALIAS="invalid keyword alias",r.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",r.INVALID_LANGUAGE_MAPPING="invalid language mapping",r.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",r.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",r.INVALID_LOCAL_CONTEXT="invalid local context",r.INVALID_REMOTE_CONTEXT="invalid remote context",r.INVALID_REVERSE_PROPERTY="invalid reverse property",r.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",r.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",r.INVALID_SCOPED_CONTEXT="invalid scoped context",r.INVALID_SCRIPT_ELEMENT="invalid script element",r.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",r.INVALID_TERM_DEFINITION="invalid term definition",r.INVALID_TYPE_MAPPING="invalid type mapping",r.INVALID_TYPE_VALUE="invalid type value",r.INVALID_TYPED_VALUE="invalid typed value",r.INVALID_VALUE_OBJECT="invalid value object",r.INVALID_VALUE_OBJECT_VALUE="invalid value object value",r.INVALID_VOCAB_MAPPING="invalid vocab mapping",r.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",r.KEYWORD_REDEFINITION="keyword redefinition",r.LOADING_DOCUMENT_FAILED="loading document failed",r.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",r.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",r.PROCESSING_MODE_CONFLICT="processing mode conflict",r.PROTECTED_TERM_REDEFINITION="protected term redefinition",r.CONTEXT_OVERFLOW="context overflow",r.INVALID_BASE_DIRECTION="invalid base direction",r.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",r.INVALID_STREAMING_KEY_ORDER="invalid streaming key order",r.INVALID_EMBEDDED_NODE="invalid embedded node",r.INVALID_ANNOTATION="invalid annotation"}(n.ERROR_CODES||(n.ERROR_CODES={}))}(ErrorCoded$1)),ErrorCoded$1}var FetchDocumentLoader$1={},hasRequiredFetchDocumentLoader$1;function requireFetchDocumentLoader$1(){if(hasRequiredFetchDocumentLoader$1)return FetchDocumentLoader$1;hasRequiredFetchDocumentLoader$1=1,Object.defineProperty(FetchDocumentLoader$1,"__esModule",{value:!0}),FetchDocumentLoader$1.FetchDocumentLoader=void 0;const n=requireErrorCoded$1(),t=requireLink(),r=requireRelativeToAbsoluteIri();class a{constructor(u){this.fetcher=u}async load(u){const s=await(this.fetcher||fetch)(u,{headers:new Headers({accept:"application/ld+json"})});if(s.ok&&s.headers){let c=s.headers.get("Content-Type");if(c){const l=c.indexOf(";");l>0&&(c=c.substr(0,l))}if(c==="application/ld+json")return await s.json();if(s.headers.has("Link")){let l;if(s.headers.forEach((d,f)=>{if(f==="link"){const h=(0,t.parse)(d);for(const v of h.get("type","application/ld+json"))if(v.rel==="alternate"){if(l)throw new Error("Multiple JSON-LD alternate links were found on "+u);l=(0,r.resolve)(v.uri,u)}}}),l)return this.load(l)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${c}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}else throw new Error(s.statusText||`Status code: ${s.status}`)}}return FetchDocumentLoader$1.FetchDocumentLoader=a,FetchDocumentLoader$1}var JsonLdContextNormalized$1={},Util$2={},hasRequiredUtil$2;function requireUtil$2(){if(hasRequiredUtil$2)return Util$2;hasRequiredUtil$2=1,Object.defineProperty(Util$2,"__esModule",{value:!0}),Util$2.Util=void 0;class n{static isCompactIri(r){return r.indexOf(":")>0&&!(r&&r[0]==="#")}static getPrefix(r,a){if(r&&r[0]==="#")return null;const o=r.indexOf(":");if(o>=0){if(r.length>o+1&&r.charAt(o+1)==="/"&&r.charAt(o+2)==="/")return null;const u=r.substr(0,o);if(u==="_")return null;if(a[u])return u}return null}static getContextValueId(r){if(r===null||typeof r=="string")return r;const a=r["@id"];return a||null}static isSimpleTermDefinitionPrefix(r,a){return!n.isPotentialKeyword(r)&&(a.allowPrefixNonGenDelims||typeof r=="string"&&(r[0]==="_"||n.isPrefixIriEndingWithGenDelim(r)))}static isPotentialKeyword(r){return typeof r=="string"&&n.KEYWORD_REGEX.test(r)}static isPrefixIriEndingWithGenDelim(r){return n.ENDS_WITH_GEN_DELIM.test(r)}static isPrefixValue(r){return r&&(typeof r=="string"||r&&typeof r=="object")}static isValidIri(r){return!!(r&&n.IRI_REGEX.test(r))}static isValidIriWeak(r){return!!r&&r[0]!==":"&&n.IRI_REGEX_WEAK.test(r)}static isValidKeyword(r){return n.VALID_KEYWORDS[r]}static isTermProtected(r,a){const o=r[a];return typeof o!="string"&&o&&o["@protected"]}static hasProtectedTerms(r){for(const a of Object.keys(r))if(n.isTermProtected(r,a))return!0;return!1}static isReservedInternalKeyword(r){return r.startsWith("@__")}static deepEqual(r,a){const o=Object.keys(r),u=Object.keys(a);return o.length!==u.length?!1:o.every(s=>{const c=r[s],l=a[s];return c===l||c!==null&&l!==null&&typeof c=="object"&&typeof l=="object"&&this.deepEqual(c,l)})}}return n.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,n.IRI_REGEX_WEAK=/(?::[^:])|\//,n.KEYWORD_REGEX=/^@[a-z]+$/i,n.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,n.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,n.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,n.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},n.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],n.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],n.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],n.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],n.CONTAINERS_1_0=["@list","@set","@index"],Util$2.Util=n,Util$2}var hasRequiredJsonLdContextNormalized$1;function requireJsonLdContextNormalized$1(){return hasRequiredJsonLdContextNormalized$1||(hasRequiredJsonLdContextNormalized$1=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.defaultExpandOptions=n.JsonLdContextNormalized=void 0;const t=requireRelativeToAbsoluteIri(),r=requireErrorCoded$1(),a=requireUtil$2();class o{constructor(s){this.contextRaw=s}getContextRaw(){return this.contextRaw}expandTerm(s,c,l=n.defaultExpandOptions){const d=this.contextRaw[s];if(d===null||d&&d["@id"]===null)return null;let f=!0;if(d&&c){const S=a.Util.getContextValueId(d);if(S&&S!==s)if(typeof S!="string"||!a.Util.isValidIri(S)&&!a.Util.isValidKeyword(S))a.Util.isPotentialKeyword(S)||(f=!1);else return S}const h=a.Util.getPrefix(s,this.contextRaw),v=this.contextRaw["@vocab"],g=(!!v||v==="")&&v.indexOf(":")<0,b=this.contextRaw["@base"],_=a.Util.isPotentialKeyword(s);if(h){const S=this.contextRaw[h],T=a.Util.getContextValueId(S);if(T){if(typeof S=="string"||!l.allowPrefixForcing){if(!a.Util.isSimpleTermDefinitionPrefix(T,l))return s}else if(T[0]!=="_"&&!_&&!S["@prefix"]&&!(s in this.contextRaw))return s;return T+s.substr(h.length+1)}}else if(c&&(v||v===""||l.allowVocabRelativeToBase&&b&&g)&&!_&&!a.Util.isCompactIri(s))if(g){if(l.allowVocabRelativeToBase)return(v||b?(0,t.resolve)(v,b):"")+s;throw new r.ErrorCoded(`Relative vocab expansion for term '${s}' with vocab '${v}' is not allowed.`,r.ERROR_CODES.INVALID_VOCAB_MAPPING)}else return v+s;else if(!c&&b&&!_&&!a.Util.isCompactIri(s))return(0,t.resolve)(s,b);if(f)return s;throw new r.ErrorCoded(`Invalid IRI mapping found for context entry '${s}': '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(s,c){if(c&&this.contextRaw["@vocab"]&&s.startsWith(this.contextRaw["@vocab"]))return s.substr(this.contextRaw["@vocab"].length);if(!c&&this.contextRaw["@base"]&&s.startsWith(this.contextRaw["@base"]))return s.substr(this.contextRaw["@base"].length);const l={prefix:"",suffix:s};for(const d in this.contextRaw){const f=this.contextRaw[d];if(f&&!a.Util.isPotentialKeyword(d)){const h=a.Util.getContextValueId(f);if(s.startsWith(h)){const v=s.substr(h.length);if(v)v.length<l.suffix.length&&(l.prefix=d,l.suffix=v);else if(c)return d}}}return l.prefix?l.prefix+":"+l.suffix:s}}n.JsonLdContextNormalized=o,n.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}(JsonLdContextNormalized$1)),JsonLdContextNormalized$1}var hasRequiredContextParser$1;function requireContextParser$1(){if(hasRequiredContextParser$1)return ContextParser$1;hasRequiredContextParser$1=1,Object.defineProperty(ContextParser$1,"__esModule",{value:!0}),ContextParser$1.ContextParser=void 0;const n=requireRelativeToAbsoluteIri(),t=requireErrorCoded$1(),r=requireFetchDocumentLoader$1(),a=requireJsonLdContextNormalized$1(),o=requireUtil$2();class u{constructor(c){c=c||{},this.documentLoader=c.documentLoader||new r.FetchDocumentLoader,this.documentCache={},this.validateContext=!c.skipValidation,this.expandContentTypeToBase=!!c.expandContentTypeToBase,this.remoteContextsDepthLimit=c.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps="redirectSchemaOrgHttps"in c?!!c.redirectSchemaOrgHttps:!0}static validateLanguage(c,l,d){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(c)}'`,d);if(!o.Util.REGEX_LANGUAGE_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(c)}'`,d);return!1}return!0}static validateDirection(c,l){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(c){for(const l of Object.keys(c)){let d=c[l];if(d&&typeof d=="object"&&d["@reverse"]&&!d["@id"]){if(typeof d["@reverse"]!="string"||o.Util.isValidKeyword(d["@reverse"]))throw new t.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${d["@reverse"]}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);d=c[l]=Object.assign(Object.assign({},d),{"@id":d["@reverse"]}),d["@id"]=d["@reverse"],o.Util.isPotentialKeyword(d["@reverse"])?delete d["@reverse"]:d["@reverse"]=!0}}return c}expandPrefixedTerms(c,l,d){const f=c.getContextRaw();for(const h of d||Object.keys(f))if(o.Util.EXPAND_KEYS_BLACKLIST.indexOf(h)<0&&!o.Util.isReservedInternalKeyword(h)){const v=f[h];if(o.Util.isPotentialKeyword(h)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(h)>=0&&(h!=="@type"||typeof f[h]=="object"&&!(f[h]["@protected"]||f[h]["@container"]==="@set")))throw new t.ErrorCoded(`Keywords can not be aliased to something else.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(v))>=0)throw new t.ErrorCoded(`Aliasing to certain keywords is not allowed.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(v&&o.Util.isPotentialKeyword(o.Util.getContextValueId(v))&&v["@prefix"]===!0)throw new t.ErrorCoded(`Tried to use keyword aliases as prefix: '${h}': '${JSON.stringify(v)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);for(;o.Util.isPrefixValue(f[h]);){const g=f[h];let b=!1;if(typeof g=="string")f[h]=c.expandTerm(g,!0),b=b||g!==f[h];else{const _=g["@id"],S=g["@type"],T=!("@prefix"in g)||o.Util.isValidIri(h);if("@id"in g)_!=null&&typeof _=="string"&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":c.expandTerm(_,!0)}),b=b||_!==f[h]["@id"]);else if(!o.Util.isPotentialKeyword(h)&&T){const w=c.expandTerm(h,!0);w!==h&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":w}),b=!0)}if(S&&typeof S=="string"&&S!=="@vocab"&&(!g["@container"]||!g["@container"]["@type"])&&T){let w=c.expandTerm(S,!0);l&&S===w&&(w=c.expandTerm(S,!1)),w!==S&&(b=!0,f[h]=Object.assign(Object.assign({},f[h]),{"@type":w}))}}if(!b)break}}}normalize(c,{processingMode:l,normalizeLanguageTags:d}){if(d||l===1)for(const f of Object.keys(c))if(f==="@language"&&typeof c[f]=="string")c[f]=c[f].toLowerCase();else{const h=c[f];if(h&&typeof h=="object"&&typeof h["@language"]=="string"){const v=h["@language"].toLowerCase();v!==h["@language"]&&(c[f]=Object.assign(Object.assign({},h),{"@language":v}))}}}containersToHash(c){for(const l of Object.keys(c)){const d=c[l];if(d&&typeof d=="object"){if(typeof d["@container"]=="string")c[l]=Object.assign(Object.assign({},d),{"@container":{[d["@container"]]:!0}});else if(Array.isArray(d["@container"])){const f={};for(const h of d["@container"])f[h]=!0;c[l]=Object.assign(Object.assign({},d),{"@container":f})}}}}applyScopedProtected(c,{processingMode:l},d){if(l&&l>=1.1&&c["@protected"]){for(const f of Object.keys(c))if(!o.Util.isReservedInternalKeyword(f)&&!o.Util.isPotentialKeyword(f)&&!o.Util.isTermProtected(c,f)){const h=c[f];h&&typeof h=="object"?"@protected"in c[f]||(c[f]=Object.assign(Object.assign({},c[f]),{"@protected":!0})):(c[f]={"@id":h,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(h,d)&&(c[f]=Object.assign(Object.assign({},c[f]),{"@prefix":!0})))}delete c["@protected"]}}validateKeywordRedefinitions(c,l,d,f){for(const h of f??Object.keys(l))if(o.Util.isTermProtected(c,h)&&(typeof l[h]=="string"?l[h]={"@id":l[h],"@protected":!0}:l[h]=Object.assign(Object.assign({},l[h]),{"@protected":!0}),!o.Util.deepEqual(c[h],l[h])))throw new t.ErrorCoded(`Attempted to override the protected keyword ${h} from ${JSON.stringify(o.Util.getContextValueId(c[h]))} to ${JSON.stringify(o.Util.getContextValueId(l[h]))}`,t.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(c,{processingMode:l}){for(const d of Object.keys(c)){if(o.Util.isReservedInternalKeyword(d))continue;if(d==="")throw new t.ErrorCoded(`The empty term is not allowed, got: '${d}': '${JSON.stringify(c[d])}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);const f=c[d],h=typeof f;if(o.Util.isPotentialKeyword(d)){switch(d.substr(1)){case"vocab":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @vocab IRI: ${f}`,t.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @base IRI: ${c[d]}`,t.ERROR_CODES.INVALID_BASE_IRI);break;case"language":f!==null&&u.validateLanguage(f,!0,t.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(f!==null&&h!=="number")throw new t.ErrorCoded(`Found an invalid @version number: ${f}`,t.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":f!==null&&u.validateDirection(f,!0);break;case"propagate":if(l===1)throw new t.ErrorCoded(`Found an illegal @propagate keyword: ${f}`,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(f!==null&&h!=="boolean")throw new t.ErrorCoded(`Found an invalid @propagate value: ${f}`,t.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(o.Util.isValidKeyword(d)&&o.Util.isValidKeyword(o.Util.getContextValueId(f)))throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${o.Util.getContextValueId(f)}'`,t.ERROR_CODES.KEYWORD_REDEFINITION);continue}if(f!==null)switch(h){case"string":if(o.Util.getPrefix(f,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(f==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(f)&&f!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(d)&&!("@id"in f)&&(f["@type"]==="@id"?!c["@base"]:!c["@vocab"]))throw new t.ErrorCoded(`Missing @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);for(const v of Object.keys(f)){const g=f[v];if(g)switch(v){case"@id":if(o.Util.isValidKeyword(g)&&g!=="@type"&&g!=="@id"&&g!=="@graph"&&g!=="@nest")throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(g==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(g)&&g!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}if(typeof g!="string")throw new t.ErrorCoded(`Detected non-string @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(g,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if(f["@container"]==="@type"&&g!=="@id"&&g!=="@vocab")throw new t.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(typeof g!="string")throw new t.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(h)}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(g!=="@id"&&g!=="@vocab"&&(l===1||g!=="@json")&&(l===1||g!=="@none")&&(g[0]==="_"||!o.Util.isValidIri(g)))throw new t.ErrorCoded(`A context @type must be an absolute IRI, found: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if(typeof g=="string"&&f["@id"]&&f["@id"]!==g)throw new t.ErrorCoded(`Found non-matching @id and @reverse term values in '${d}':'${g}' and '${f["@id"]}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in f)throw new t.ErrorCoded(`@nest is not allowed in the reverse property '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(l===1&&(Object.keys(g).length>1||o.Util.CONTAINERS_1_0.indexOf(Object.keys(g)[0])<0))throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${Object.keys(g)}') in 1.0, must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const b of Object.keys(g)){if(b==="@list"&&f["@reverse"])throw new t.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(o.Util.CONTAINERS.indexOf(b)<0)throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${b}'), must be one of ${o.Util.CONTAINERS.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":u.validateLanguage(g,!0,t.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":u.validateDirection(g,!0);break;case"@prefix":if(g!==null&&typeof g!="boolean")throw new t.ErrorCoded(`Found an invalid term @prefix boolean in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in f)&&!o.Util.isValidIri(d))throw new t.ErrorCoded(`Invalid @prefix definition for '${d}' ('${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(l===1||!f["@container"]||!f["@container"]["@index"])throw new t.ErrorCoded(`Attempt to add illegal key to value object: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(g)&&g!=="@nest")throw new t.ErrorCoded(`Found an invalid term @nest value in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new t.ErrorCoded(`Found an invalid term value: '${d}': '${f}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(c,l,d){return typeof c=="string"||(d&&!("@base"in c)&&l.parentContext&&typeof l.parentContext=="object"&&"@base"in l.parentContext&&(c["@base"]=l.parentContext["@base"],l.parentContext["@__baseDocument"]&&(c["@__baseDocument"]=!0)),l.baseIRI&&!l.external&&("@base"in c?c["@base"]!==null&&typeof c["@base"]=="string"&&!o.Util.isValidIri(c["@base"])&&(c["@base"]=(0,n.resolve)(c["@base"],l.parentContext&&l.parentContext["@base"]||l.baseIRI)):(c["@base"]=l.baseIRI,c["@__baseDocument"]=!0))),c}normalizeContextIri(c,l){if(!o.Util.isValidIri(c))try{c=(0,n.resolve)(c,l)}catch{throw new Error(`Invalid context IRI: ${c}`)}return this.redirectSchemaOrgHttps&&c.startsWith("http://schema.org")&&(c="https://schema.org/"),c}async parseInnerContexts(c,l,d){for(const f of d??Object.keys(c)){const h=c[f];if(h&&typeof h=="object"&&"@context"in h&&h["@context"]!==null&&!l.ignoreScopedContexts){if(this.validateContext)try{const v=Object.assign(Object.assign({},c),{[f]:Object.assign({},c[f])});delete v[f]["@context"],await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,parentContext:v,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(v){throw new t.ErrorCoded(v.message,t.ERROR_CODES.INVALID_SCOPED_CONTEXT)}c[f]=Object.assign(Object.assign({},h),{"@context":(await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:c}))).getContextRaw()})}}return c}async parse(c,l={},d={}){const{baseIRI:f,parentContext:h,external:v,processingMode:g=u.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:b,ignoreProtection:_,minimalProcessing:S}=l,T=l.remoteContexts||{};if(Object.keys(T).length>=this.remoteContextsDepthLimit)throw new t.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(T),t.ERROR_CODES.CONTEXT_OVERFLOW);if(c==null){if(!_&&h&&o.Util.hasProtectedTerms(h))throw new t.ErrorCoded("Illegal context nullification when terms are protected",t.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},l,!1))}else if(typeof c=="string"){const w=this.normalizeContextIri(c,f),A=this.getOverriddenLoad(w,l);if(A)return new a.JsonLdContextNormalized(A);const R=await this.parse(await this.load(w),Object.assign(Object.assign({},l),{baseIRI:w,external:!0,remoteContexts:Object.assign(Object.assign({},T),{[w]:!0})}));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(Array.isArray(c)){const w=[],A=await Promise.all(c.map((E,I)=>{if(typeof E=="string"){const L=this.normalizeContextIri(E,f);w[I]=L;const F=this.getOverriddenLoad(L,l);return F||this.load(L)}else return E}));if(S)return new a.JsonLdContextNormalized(A);const R=await A.reduce((E,I,L)=>E.then(F=>this.parse(I,Object.assign(Object.assign({},l),{baseIRI:w[L]||l.baseIRI,external:!!w[L]||l.external,parentContext:F.getContextRaw(),remoteContexts:w[L]?Object.assign(Object.assign({},T),{[w[L]]:!0}):T}),{skipValidation:L<A.length-1})),Promise.resolve(new a.JsonLdContextNormalized(h||{})));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(typeof c=="object"){if("@context"in c)return await this.parse(c["@context"],l);if(c=Object.assign({},c),v&&delete c["@base"],this.applyBaseEntry(c,l,!0),this.containersToHash(c),S)return new a.JsonLdContextNormalized(c);let w={};if("@import"in c)if(g>=1.1){if(typeof c["@import"]!="string")throw new t.ErrorCoded("An @import value must be a string, but got "+typeof c["@import"],t.ERROR_CODES.INVALID_IMPORT_VALUE);w=await this.loadImportContext(this.normalizeContextIri(c["@import"],f)),delete c["@import"]}else throw new t.ErrorCoded("Context importing is not supported in JSON-LD 1.0",t.ERROR_CODES.INVALID_CONTEXT_ENTRY);this.applyScopedProtected(w,{processingMode:g},a.defaultExpandOptions);const A=Object.assign(w,c);this.idifyReverseTerms(A),this.normalize(A,{processingMode:g,normalizeLanguageTags:b}),this.applyScopedProtected(A,{processingMode:g},a.defaultExpandOptions);const R=Object.keys(A),E=[];if(typeof h=="object")for(const L in h)L in A?E.push(L):A[L]=h[L];await this.parseInnerContexts(A,l,R);const I=new a.JsonLdContextNormalized(A);return(A&&A["@version"]||u.DEFAULT_PROCESSING_MODE)>=1.1&&(c["@vocab"]&&typeof c["@vocab"]=="string"||c["@vocab"]==="")&&(h&&"@vocab"in h&&c["@vocab"].indexOf(":")<0?A["@vocab"]=h["@vocab"]+c["@vocab"]:(o.Util.isCompactIri(c["@vocab"])||c["@vocab"]in A)&&(A["@vocab"]=I.expandTerm(c["@vocab"],!0))),this.expandPrefixedTerms(I,this.expandContentTypeToBase,R),!_&&h&&g>=1.1&&this.validateKeywordRedefinitions(h,A,a.defaultExpandOptions,E),this.validateContext&&!d.skipValidation&&this.validate(A,{processingMode:g}),I}else throw new t.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${c}`,t.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(c){const l=this.documentCache[c];if(l)return l;let d;try{d=await this.documentLoader.load(c)}catch(f){throw new t.ErrorCoded(`Failed to load remote context ${c}: ${f.message}`,t.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in d))throw new t.ErrorCoded(`Missing @context in remote context at ${c}`,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[c]=d["@context"]}getOverriddenLoad(c,l){if(c in(l.remoteContexts||{})){if(l.ignoreRemoteScopedContexts)return c;throw new t.ErrorCoded("Detected a cyclic context inclusion of "+c,t.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(c){let l=await this.load(c);if(typeof l!="object"||Array.isArray(l))throw new t.ErrorCoded("An imported context must be a single object: "+c,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in l)throw new t.ErrorCoded("An imported context can not import another context: "+c,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);return l=Object.assign({},l),this.containersToHash(l),l}}return u.DEFAULT_PROCESSING_MODE=1.1,ContextParser$1.ContextParser=u,ContextParser$1}var IDocumentLoader$1={},hasRequiredIDocumentLoader$1;function requireIDocumentLoader$1(){return hasRequiredIDocumentLoader$1||(hasRequiredIDocumentLoader$1=1,Object.defineProperty(IDocumentLoader$1,"__esModule",{value:!0})),IDocumentLoader$1}var JsonLdContext$1={},hasRequiredJsonLdContext$1;function requireJsonLdContext$1(){return hasRequiredJsonLdContext$1||(hasRequiredJsonLdContext$1=1,Object.defineProperty(JsonLdContext$1,"__esModule",{value:!0})),JsonLdContext$1}var hasRequiredJsonldContextParser$1;function requireJsonldContextParser$1(){return hasRequiredJsonldContextParser$1||(hasRequiredJsonldContextParser$1=1,function(n){var t=jsonldContextParser$1&&jsonldContextParser$1.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldContextParser$1&&jsonldContextParser$1.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireContextParser$1(),n),r(requireErrorCoded$1(),n),r(requireFetchDocumentLoader$1(),n),r(requireIDocumentLoader$1(),n),r(requireJsonLdContext$1(),n),r(requireJsonLdContextNormalized$1(),n),r(requireUtil$2(),n)}(jsonldContextParser$1)),jsonldContextParser$1}var EntryHandlerArrayValue={},Util$1={},EntryHandlerContainer={},ContainerHandlerIdentifier={},hasRequiredContainerHandlerIdentifier;function requireContainerHandlerIdentifier(){if(hasRequiredContainerHandlerIdentifier)return ContainerHandlerIdentifier;hasRequiredContainerHandlerIdentifier=1,Object.defineProperty(ContainerHandlerIdentifier,"__esModule",{value:!0}),ContainerHandlerIdentifier.ContainerHandlerIdentifier=void 0;let n=class{canCombineWithGraph(){return!0}async handle(r,a,o,u,s,c){let l;if(a.emittedStack[c+1]&&a.idStack[c+1])l=a.idStack[c+1][0];else{const h=await o.getContainerKey(u[c],u,c)!==null?await o.resourceToTerm(await a.getContext(u),u[c]):o.dataFactory.blankNode();if(!h){a.emittedStack[c]=!1;return}l=h,a.idStack[c+1]=[l]}let d=a.idStack[c];d||(d=a.idStack[c]=[]),d.some(f=>f.equals(l))||d.push(l),await a.handlePendingContainerFlushBuffers()||(a.emittedStack[c]=!1)}};return ContainerHandlerIdentifier.ContainerHandlerIdentifier=n,ContainerHandlerIdentifier}var ContainerHandlerIndex={},EntryHandlerPredicate={},hasRequiredEntryHandlerPredicate;function requireEntryHandlerPredicate(){if(hasRequiredEntryHandlerPredicate)return EntryHandlerPredicate;hasRequiredEntryHandlerPredicate=1,Object.defineProperty(EntryHandlerPredicate,"__esModule",{value:!0}),EntryHandlerPredicate.EntryHandlerPredicate=void 0;const n=requireJsonldContextParser$1(),t=requireUtil$1();let r=class ua{static async handlePredicateObject(o,u,s,c,l,d,f,h,v){const g=await u.getPropertiesDepth(s,c),b=await u.getDepthOffsetGraph(c,s),_=c-b,S=o.idStack[g];if(S&&!v)for(const T of S)if(b>=0){const A=o.idStack[_-1];if(A)for(const R of A)u.emitQuadChecked(c,T,l,d,R,f,h);else f?(u.validateReverseSubject(d),o.getUnidentifiedGraphBufferSafe(_-1).push({subject:d,predicate:l,object:T,isEmbedded:h})):o.getUnidentifiedGraphBufferSafe(_-1).push({subject:T,predicate:l,object:d,isEmbedded:h})}else{const A=await u.getGraphContainerValue(s,g);u.emitQuadChecked(c,T,l,d,A,f,h)}else if(f&&u.validateReverseSubject(d),v){if(o.rdfstar){o.idStack[c]&&o.emitError(new n.ErrorCoded(`Found an illegal @id inside an annotation: ${o.idStack[c][0].value}`,n.ERROR_CODES.INVALID_ANNOTATION));for(let A=0;A<c;A++)await u.unaliasKeyword(s[A],s,A)==="@id"&&o.emitError(new n.ErrorCoded("Found an illegal annotation inside an embedded node",n.ERROR_CODES.INVALID_ANNOTATION));const T=o.getAnnotationsBufferSafe(g),w={predicate:l,object:d,reverse:f,nestedAnnotations:[],depth:g};T.push(w);for(let A=T.length-2;A>=0;A--){const R=T[A];R.depth>g&&(w.nestedAnnotations.push(R),T.splice(A,1))}}}else o.getUnidentifiedValueBufferSafe(g).push({predicate:l,object:d,reverse:f,isEmbedded:h})}isPropertyHandler(){return!0}isStackProcessor(){return!0}async validate(o,u,s,c,l){const d=s[c];if(d){const f=await o.getContext(s);if(!o.jsonLiteralStack[c]&&await u.predicateToTerm(f,s[c]))return t.Util.getContextValueType(f,d)==="@json"&&(o.jsonLiteralStack[c+1]=!0),!0}return!1}async test(o,u,s,c,l){return c[l]}async handle(o,u,s,c,l,d,f){const h=c[d],v=await o.getContext(c),g=await u.predicateToTerm(v,s);if(g){const b=await u.valueToTerm(v,s,l,d,c);if(b.length)for(let _ of b){let S=await u.unaliasKeywordParent(c,d);const T=t.Util.isPropertyReverse(v,h,S);let w=0;for(;S==="@reverse"||typeof S=="number";)typeof S=="number"?w++:d--,S=await u.unaliasKeywordParent(c,d-w);const A=t.Util.isPropertyInEmbeddedNode(S);u.validateReverseInEmbeddedNode(s,T,A);const R=t.Util.isPropertyInAnnotationObject(S);if(l){const E="@list"in t.Util.getContextValueContainer(v,s);if(E||l["@list"]){if((E&&!Array.isArray(l)&&!l["@list"]||l["@list"]&&!Array.isArray(l["@list"]))&&_!==u.rdfNil){const I=u.dataFactory.blankNode();o.emitQuad(d,u.dataFactory.quad(I,u.rdfRest,u.rdfNil,u.getDefaultGraph())),o.emitQuad(d,u.dataFactory.quad(I,u.rdfFirst,_,u.getDefaultGraph())),_=I}if(T&&!o.allowSubjectList)throw new n.ErrorCoded(`Found illegal list value in subject position at ${s}`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}}await ua.handlePredicateObject(o,u,c,d,g,_,T,A,R)}}}};return EntryHandlerPredicate.EntryHandlerPredicate=r,EntryHandlerPredicate}var hasRequiredContainerHandlerIndex;function requireContainerHandlerIndex(){if(hasRequiredContainerHandlerIndex)return ContainerHandlerIndex;hasRequiredContainerHandlerIndex=1,Object.defineProperty(ContainerHandlerIndex,"__esModule",{value:!0}),ContainerHandlerIndex.ContainerHandlerIndex=void 0;const n=requireJsonldContextParser$1(),t=requireEntryHandlerPredicate(),r=requireUtil$1();let a=class{canCombineWithGraph(){return!0}async handle(u,s,c,l,d,f){if(!Array.isArray(d)){const h="@graph"in u,v=await s.getContext(l),g=l[f-1],b=r.Util.getContextValueIndex(v,g);if(b){if(n.Util.isPotentialKeyword(b))throw new n.ErrorCoded(`Keywords can not be used as @index value, got: ${b}`,n.ERROR_CODES.INVALID_TERM_DEFINITION);if(typeof b!="string")throw new n.ErrorCoded(`@index values must be strings, got: ${b}`,n.ERROR_CODES.INVALID_TERM_DEFINITION);if(typeof d!="object"){if(r.Util.getContextValueType(v,g)!=="@id")throw new n.ErrorCoded(`Property-based index containers require nodes as values or strings with @type: @id, but got: ${d}`,n.ERROR_CODES.INVALID_VALUE_OBJECT);const T=c.resourceToTerm(v,d);T&&(s.idStack[f+1]=[T])}const S=c.createVocabOrBaseTerm(v,b);if(S){const T=await c.valueToTerm(v,b,await c.getContainerKey(l[f],l,f),f,l);if(h){const w=await c.getGraphContainerValue(l,f+1);for(const A of T)s.emitQuad(f,c.dataFactory.quad(w,S,A,c.getDefaultGraph()))}else for(const w of T)await t.EntryHandlerPredicate.handlePredicateObject(s,c,l,f+1,S,w,!1,!1,!1)}}const _=h?2:1;await s.newOnValueJob(l.slice(0,l.length-_),d,f-_,!0),await s.handlePendingContainerFlushBuffers()}s.emittedStack[f]=!1}};return ContainerHandlerIndex.ContainerHandlerIndex=a,ContainerHandlerIndex}var ContainerHandlerLanguage={},hasRequiredContainerHandlerLanguage;function requireContainerHandlerLanguage(){if(hasRequiredContainerHandlerLanguage)return ContainerHandlerLanguage;hasRequiredContainerHandlerLanguage=1,Object.defineProperty(ContainerHandlerLanguage,"__esModule",{value:!0}),ContainerHandlerLanguage.ContainerHandlerLanguage=void 0;const n=requireJsonldContextParser$1();let t=class{canCombineWithGraph(){return!1}async handle(a,o,u,s,c,l){const d=await u.getContainerKey(s[l],s,l);if(Array.isArray(c))c=c.map(f=>({"@value":f,"@language":d}));else{if(typeof c!="string")throw new n.ErrorCoded(`Got invalid language map value, got '${JSON.stringify(c)}', but expected string`,n.ERROR_CODES.INVALID_LANGUAGE_MAP_VALUE);c={"@value":c,"@language":d}}await o.newOnValueJob(s.slice(0,s.length-1),c,l-1,!0),o.emittedStack[l]=!1}};return ContainerHandlerLanguage.ContainerHandlerLanguage=t,ContainerHandlerLanguage}var ContainerHandlerType={},hasRequiredContainerHandlerType;function requireContainerHandlerType(){if(hasRequiredContainerHandlerType)return ContainerHandlerType;hasRequiredContainerHandlerType=1,Object.defineProperty(ContainerHandlerType,"__esModule",{value:!0}),ContainerHandlerType.ContainerHandlerType=void 0;const n=requireEntryHandlerPredicate(),t=requireUtil$1();let r=class{canCombineWithGraph(){return!1}async handle(o,u,s,c,l,d){if(!Array.isArray(l)){if(typeof l=="string"){const v=await u.getContext(c),b=t.Util.getContextValueType(v,c[d-1])==="@vocab"?await s.createVocabOrBaseTerm(v,l):await s.resourceToTerm(v,l);if(b){const _={"@id":b.termType==="NamedNode"?b.value:l};await u.newOnValueJob(c.slice(0,c.length-1),_,d-1,!0),u.idStack[d+1]=[b]}}else{const v=!!u.idStack[d+1];v||delete u.idStack[d],await u.newOnValueJob(c.slice(0,c.length-1),l,d-1,!0),v||(u.idStack[d+1]=u.idStack[d])}const f=await s.getContainerKey(c[d],c,d),h=f!==null?s.createVocabOrBaseTerm(await u.getContext(c),f):null;h&&await n.EntryHandlerPredicate.handlePredicateObject(u,s,c,d+1,s.rdfType,h,!1,!1,!1),await u.handlePendingContainerFlushBuffers()}u.emittedStack[d]=!1}};return ContainerHandlerType.ContainerHandlerType=r,ContainerHandlerType}var hasRequiredEntryHandlerContainer;function requireEntryHandlerContainer(){if(hasRequiredEntryHandlerContainer)return EntryHandlerContainer;hasRequiredEntryHandlerContainer=1,Object.defineProperty(EntryHandlerContainer,"__esModule",{value:!0}),EntryHandlerContainer.EntryHandlerContainer=void 0;const n=requireContainerHandlerIdentifier(),t=requireContainerHandlerIndex(),r=requireContainerHandlerLanguage(),a=requireContainerHandlerType(),o=requireUtil$1();let u=class mr{static isSimpleGraphContainer(c){return"@graph"in c&&("@set"in c&&Object.keys(c).length===2||Object.keys(c).length===1)}static isComplexGraphContainer(c){return"@graph"in c&&("@set"in c&&Object.keys(c).length>2||!("@set"in c)&&Object.keys(c).length>1)}static getContainerGraphIndex(c,l,d){let f=mr.isSimpleGraphContainer(c),h="";for(let v=l;v<d.length;v++)(!f||typeof d[v]=="number")&&(h+=":"+d[v]),!f&&typeof d[v]!="number"&&(f=!0);return h}static async getContainerHandler(c,l,d){const f={containers:{"@set":!0},depth:d,fallback:!0};let h=!1;const v=await c.getContext(l,2);for(let g=d-1;g>=0;g--)if(typeof l[g]!="number"){const b=o.Util.getContextValue(v,"@container",l[g],!1);if(b&&mr.isSimpleGraphContainer(b))return{containers:b,depth:g+1,fallback:!1};const _=o.Util.getContextValue(v,"@container",l[g-1],!1);if(_){const S="@graph"in _;for(const T in mr.CONTAINER_HANDLERS)if(_[T])return S?mr.CONTAINER_HANDLERS[T].canCombineWithGraph()?{containers:_,depth:g,fallback:!1}:f:h?f:{containers:_,depth:g,fallback:!1};return f}else{if(h)return f;h=!0}}return f}static async isBufferableContainerHandler(c,l,d){const f=await mr.getContainerHandler(c,l,d);return!f.fallback&&!("@graph"in f.containers)}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(c,l,d,f,h){return!!await this.test(c,l,null,d,f)}async test(c,l,d,f,h){const v=o.Util.getContextValueContainer(await c.getContext(f,2),f[h-1]);for(const g in mr.CONTAINER_HANDLERS)if(v[g])return{containers:v,handler:mr.CONTAINER_HANDLERS[g]};return null}async handle(c,l,d,f,h,v,g){return g.handler.handle(g.containers,c,l,f,h,v)}};return u.CONTAINER_HANDLERS={"@id":new n.ContainerHandlerIdentifier,"@index":new t.ContainerHandlerIndex,"@language":new r.ContainerHandlerLanguage,"@type":new a.ContainerHandlerType},EntryHandlerContainer.EntryHandlerContainer=u,EntryHandlerContainer}var canonicalize,hasRequiredCanonicalize;function requireCanonicalize(){return hasRequiredCanonicalize||(hasRequiredCanonicalize=1,canonicalize=function n(t){return t===null||typeof t!="object"||t.toJSON!=null?JSON.stringify(t):Array.isArray(t)?"["+t.reduce((r,a,o)=>{const u=o===0?"":",",s=a===void 0||typeof a=="symbol"?null:a;return r+u+n(s)},"")+"]":"{"+Object.keys(t).sort().reduce((r,a,o)=>{if(t[a]===void 0||typeof t[a]=="symbol")return r;const u=r.length===0?"":",";return r+u+n(a)+":"+n(t[a])},"")+"}"}),canonicalize}var hasRequiredUtil$1;function requireUtil$1(){if(hasRequiredUtil$1)return Util$1;hasRequiredUtil$1=1,Object.defineProperty(Util$1,"__esModule",{value:!0}),Util$1.Util=void 0;const n=requireJsonldContextParser$1(),t=requireRdfDataFactory(),r=requireEntryHandlerContainer(),a=requireCanonicalize();class o{constructor(s){this.parsingContext=s.parsingContext,this.dataFactory=s.dataFactory||new t.DataFactory,this.rdfFirst=this.dataFactory.namedNode(o.RDF+"first"),this.rdfRest=this.dataFactory.namedNode(o.RDF+"rest"),this.rdfNil=this.dataFactory.namedNode(o.RDF+"nil"),this.rdfType=this.dataFactory.namedNode(o.RDF+"type"),this.rdfJson=this.dataFactory.namedNode(o.RDF+"JSON")}static getContextValue(s,c,l,d){const f=s.getContextRaw()[l];if(!f)return d;const h=f[c];return h===void 0?d:h}static getContextValueContainer(s,c){return o.getContextValue(s,"@container",c,{"@set":!0})}static getContextValueType(s,c){const l=o.getContextValue(s,"@type",c,null);return l==="@none"?null:l}static getContextValueLanguage(s,c){return o.getContextValue(s,"@language",c,s.getContextRaw()["@language"]||null)}static getContextValueDirection(s,c){return o.getContextValue(s,"@direction",c,s.getContextRaw()["@direction"]||null)}static isContextValueReverse(s,c){return!!o.getContextValue(s,"@reverse",c,null)}static getContextValueIndex(s,c){return o.getContextValue(s,"@index",c,s.getContextRaw()["@index"]||null)}static isPropertyReverse(s,c,l){return l==="@reverse"!==o.isContextValueReverse(s,c)}static isPropertyInEmbeddedNode(s){return s==="@id"}static isPropertyInAnnotationObject(s){return s==="@annotation"}static isValidIri(s){return s!==null&&n.Util.isValidIri(s)}static isPrefixArray(s,c){if(s.length>c.length)return!1;for(let l=0;l<s.length;l++)if(s[l]!==c[l])return!1;return!0}async validateValueIndexes(s){if(this.parsingContext.validateValueIndexes){const c={};for(const l of s)if(l&&typeof l=="object"){const d=l["@id"],f=l["@index"];if(d&&f){const h=c[d];if(h&&h!==f)throw new n.ErrorCoded(`Conflicting @index value for ${d}`,n.ERROR_CODES.CONFLICTING_INDEXES);c[d]=f}}}}async valueToTerm(s,c,l,d,f){if(o.getContextValueType(s,c)==="@json")return[this.dataFactory.literal(this.valueToJsonString(l),this.rdfJson)];const h=typeof l;switch(h){case"object":if(l==null)return[];if(Array.isArray(l))return"@list"in o.getContextValueContainer(s,c)?l.length===0?[this.rdfNil]:this.parsingContext.idStack[d+1]||[]:(await this.validateValueIndexes(l),[]);if(s=await this.getContextSelfOrPropertyScoped(s,c),"@context"in l&&(s=await this.parsingContext.parseContext(l["@context"],(await this.parsingContext.getContext(f,0)).getContextRaw())),l=await this.unaliasKeywords(l,f,d,s),"@value"in l){let v,g,b,_,S;for(c in l){const T=l[c];switch(c){case"@value":v=T;break;case"@language":g=T;break;case"@direction":b=T;break;case"@type":_=T;break;case"@index":S=T;break;case"@annotation":break;default:throw new n.ErrorCoded(`Unknown value entry '${c}' in @value: ${JSON.stringify(l)}`,n.ERROR_CODES.INVALID_VALUE_OBJECT)}}if(await this.unaliasKeyword(_,f,d,!0,s)==="@json")return[this.dataFactory.literal(this.valueToJsonString(v),this.rdfJson)];if(v===null)return[];if(typeof v=="object")throw new n.ErrorCoded(`The value of an '@value' can not be an object, got '${JSON.stringify(v)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT_VALUE);if(this.parsingContext.validateValueIndexes&&S&&typeof S!="string")throw new n.ErrorCoded(`The value of an '@index' must be a string, got '${JSON.stringify(S)}'`,n.ERROR_CODES.INVALID_INDEX_VALUE);if(g){if(typeof v!="string")throw new n.ErrorCoded(`When an '@language' is set, the value of '@value' must be a string, got '${JSON.stringify(v)}'`,n.ERROR_CODES.INVALID_LANGUAGE_TAGGED_VALUE);if(!n.ContextParser.validateLanguage(g,this.parsingContext.strictValues,n.ERROR_CODES.INVALID_LANGUAGE_TAGGED_STRING))return[];(this.parsingContext.normalizeLanguageTags||this.parsingContext.activeProcessingMode===1)&&(g=g.toLowerCase())}if(b){if(typeof v!="string")throw new Error(`When an '@direction' is set, the value of '@value' must be a string, got '${JSON.stringify(v)}'`);if(!n.ContextParser.validateDirection(b,this.parsingContext.strictValues))return[]}if(g&&b&&this.parsingContext.rdfDirection){if(_)throw new n.ErrorCoded(`Can not have '@language', '@direction' and '@type' in a value: '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(d,v,g,b))}else if(g){if(_)throw new n.ErrorCoded(`Can not have both '@language' and '@type' in a value: '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return[this.dataFactory.literal(v,g)]}else if(b&&this.parsingContext.rdfDirection){if(_)throw new n.ErrorCoded(`Can not have both '@direction' and '@type' in a value: '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_VALUE_OBJECT);return this.nullableTermToArray(this.createLanguageDirectionLiteral(d,v,g,b))}else if(_){if(typeof _!="string")throw new n.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(_)}'`,n.ERROR_CODES.INVALID_TYPED_VALUE);const T=this.createVocabOrBaseTerm(s,_);if(!T)throw new n.ErrorCoded(`Invalid '@type' value, got '${JSON.stringify(_)}'`,n.ERROR_CODES.INVALID_TYPED_VALUE);if(T.termType!=="NamedNode")throw new n.ErrorCoded(`Illegal value type (${T.termType}): ${_}`,n.ERROR_CODES.INVALID_TYPED_VALUE);return[this.dataFactory.literal(v,T)]}return await this.valueToTerm(new n.JsonLdContextNormalized({}),c,v,d,f)}else if("@set"in l){if(Object.keys(l).length>1)throw new n.ErrorCoded(`Found illegal neighbouring entries next to @set for key: '${c}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);return[]}else if("@list"in l){if(Object.keys(l).length>1)throw new n.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${c}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT);const v=l["@list"];return Array.isArray(v)?v.length===0?[this.rdfNil]:this.parsingContext.idStack[d+1]||[]:await this.valueToTerm(await this.parsingContext.getContext(f),c,v,d-1,f.slice(0,-1))}else{if("@reverse"in l&&typeof l["@reverse"]=="boolean")return[];if("@graph"in o.getContextValueContainer(await this.parsingContext.getContext(f),c)){const v=this.parsingContext.graphContainerTermStack[d+1];return v?Object.values(v):[this.dataFactory.blankNode()]}else if("@id"in l){if(Object.keys(l).length>1&&(s=await this.parsingContext.getContext(f,0)),"@context"in l&&(s=await this.parsingContext.parseContext(l["@context"],s.getContextRaw())),l["@type"]==="@vocab")return this.nullableTermToArray(this.createVocabOrBaseTerm(s,l["@id"]));{const v=l["@id"];let g;if(typeof v=="object")if(this.parsingContext.rdfstar)g=this.parsingContext.idStack[d+1][0];else throw new n.ErrorCoded(`Found illegal @id '${l}'`,n.ERROR_CODES.INVALID_ID_VALUE);else g=this.resourceToTerm(s,v);return this.nullableTermToArray(g)}}else return this.parsingContext.emittedStack[d+1]||l&&typeof l=="object"&&Object.keys(l).length===0?this.parsingContext.idStack[d+1]||(this.parsingContext.idStack[d+1]=[this.dataFactory.blankNode()]):[]}case"string":return this.nullableTermToArray(this.stringValueToTerm(d,await this.getContextSelfOrPropertyScoped(s,c),c,l,null));case"boolean":return this.nullableTermToArray(this.stringValueToTerm(d,await this.getContextSelfOrPropertyScoped(s,c),c,(!!l).toString(),this.dataFactory.namedNode(o.XSD_BOOLEAN)));case"number":return this.nullableTermToArray(this.stringValueToTerm(d,await this.getContextSelfOrPropertyScoped(s,c),c,l,this.dataFactory.namedNode(l%1===0&&l<1e21?o.XSD_INTEGER:o.XSD_DOUBLE)));default:return this.parsingContext.emitError(new Error(`Could not determine the RDF type of a ${h}`)),[]}}async getContextSelfOrPropertyScoped(s,c){const l=s.getContextRaw()[c];return l&&typeof l=="object"&&"@context"in l&&(s=await this.parsingContext.parseContext(l,s.getContextRaw(),!0)),s}nullableTermToArray(s){return s?[s]:[]}predicateToTerm(s,c){const l=s.expandTerm(c,!0,this.parsingContext.getExpandOptions());if(!l)return null;if(l[0]==="_"&&l[1]===":")return this.parsingContext.produceGeneralizedRdf?this.dataFactory.blankNode(l.substr(2)):null;if(o.isValidIri(l))return this.dataFactory.namedNode(l);if(l&&this.parsingContext.strictValues)this.parsingContext.emitError(new n.ErrorCoded(`Invalid predicate IRI: ${l}`,n.ERROR_CODES.INVALID_IRI_MAPPING));else return null;return null}resourceToTerm(s,c){if(c.startsWith("_:"))return this.dataFactory.blankNode(c.substr(2));const l=s.expandTerm(c,!1,this.parsingContext.getExpandOptions());if(!o.isValidIri(l))if(l&&this.parsingContext.strictValues)this.parsingContext.emitError(new Error(`Invalid resource IRI: ${l}`));else return null;return this.dataFactory.namedNode(l)}createVocabOrBaseTerm(s,c){if(c.startsWith("_:"))return this.dataFactory.blankNode(c.substr(2));const l=this.parsingContext.getExpandOptions();let d=s.expandTerm(c,!0,l);if(d===c&&(d=s.expandTerm(c,!1,l)),!o.isValidIri(d))if(d&&this.parsingContext.strictValues&&!d.startsWith("@"))this.parsingContext.emitError(new Error(`Invalid term IRI: ${d}`));else return null;return this.dataFactory.namedNode(d)}intToString(s,c){return typeof s=="number"?Number.isFinite(s)?s%1===0&&(!c||c.value!==o.XSD_DOUBLE)?Number(s).toString():s.toExponential(15).replace(/(\d)0*e\+?/,"$1E"):s>0?"INF":"-INF":s}stringValueToTerm(s,c,l,d,f){const h=o.getContextValueType(c,l);if(h)if(h==="@id"){if(!f)return this.resourceToTerm(c,this.intToString(d,f))}else if(h==="@vocab"){if(!f)return this.createVocabOrBaseTerm(c,this.intToString(d,f))}else f=this.dataFactory.namedNode(h);if(!f){const v=o.getContextValueLanguage(c,l),g=o.getContextValueDirection(c,l);return g&&this.parsingContext.rdfDirection?this.createLanguageDirectionLiteral(s,this.intToString(d,f),v,g):this.dataFactory.literal(this.intToString(d,f),v)}return this.dataFactory.literal(this.intToString(d,f),f)}createLanguageDirectionLiteral(s,c,l,d){if(this.parsingContext.rdfDirection==="i18n-datatype")return l||(l=""),this.dataFactory.literal(c,this.dataFactory.namedNode(`https://www.w3.org/ns/i18n#${l}_${d}`));{const f=this.dataFactory.blankNode(),h=this.getDefaultGraph();return this.parsingContext.emitQuad(s,this.dataFactory.quad(f,this.dataFactory.namedNode(o.RDF+"value"),this.dataFactory.literal(c),h)),l&&this.parsingContext.emitQuad(s,this.dataFactory.quad(f,this.dataFactory.namedNode(o.RDF+"language"),this.dataFactory.literal(l),h)),this.parsingContext.emitQuad(s,this.dataFactory.quad(f,this.dataFactory.namedNode(o.RDF+"direction"),this.dataFactory.literal(d),h)),f}}valueToJsonString(s){return a(s)}async unaliasKeyword(s,c,l,d,f){if(Number.isInteger(s))return s;if(!d){const h=this.parsingContext.unaliasedKeywordCacheStack[l];if(h)return h}if(!n.Util.isPotentialKeyword(s)){f=f||await this.parsingContext.getContext(c);let h=f.getContextRaw()[s];h&&typeof h=="object"&&(h=h["@id"]),n.Util.isValidKeyword(h)&&(s=h)}return d?s:this.parsingContext.unaliasedKeywordCacheStack[l]=s}async unaliasKeywordParent(s,c){return await this.unaliasKeyword(c>0&&s[c-1],s,c-1)}async unaliasKeywords(s,c,l,d){const f={};for(const h in s)f[await this.unaliasKeyword(h,c,l+1,!0,d)]=s[h];return f}async isLiteral(s,c){for(let l=c;l>=0;l--){if(await this.unaliasKeyword(s[l],s,l)==="@annotation")return!1;if(this.parsingContext.literalStack[l]||this.parsingContext.jsonLiteralStack[l])return!0}return!1}async getDepthOffsetGraph(s,c){for(let l=s-1;l>0;l--)if(await this.unaliasKeyword(c[l],c,l)==="@graph"){const d=(await r.EntryHandlerContainer.getContainerHandler(this.parsingContext,c,l)).containers;return r.EntryHandlerContainer.isComplexGraphContainer(d)?-1:s-l-1}return-1}validateReverseSubject(s){if(s.termType==="Literal")throw new n.ErrorCoded(`Found illegal literal in subject position: ${s.value}`,n.ERROR_CODES.INVALID_REVERSE_PROPERTY_VALUE)}getDefaultGraph(){return this.parsingContext.defaultGraph||this.dataFactory.defaultGraph()}async getGraphContainerValue(s,c){let l=this.getDefaultGraph();const{containers:d,depth:f}=await r.EntryHandlerContainer.getContainerHandler(this.parsingContext,s,c);if("@graph"in d){const h=r.EntryHandlerContainer.getContainerGraphIndex(d,f,s),v=this.parsingContext.graphContainerTermStack[f];if(l=v?v[h]:null,!l){let g=null;if("@id"in d){const b=await this.getContainerKey(s[f],s,f);b!==null&&(g=await this.resourceToTerm(await this.parsingContext.getContext(s),b))}g||(g=this.dataFactory.blankNode()),this.parsingContext.graphContainerTermStack[f]||(this.parsingContext.graphContainerTermStack[f]={}),l=this.parsingContext.graphContainerTermStack[f][h]=g}}return l}async getPropertiesDepth(s,c){let l=c;for(let d=c-1;d>0;d--)if(typeof s[d]!="number"){const f=await this.unaliasKeyword(s[d],s,d);if(f==="@reverse")return d;if(f==="@nest")l=d;else return l}return l}async getContainerKey(s,c,l){const d=await this.unaliasKeyword(s,c,l);return d==="@none"?null:d}validateReverseInEmbeddedNode(s,c,l){if(l&&c&&!this.parsingContext.rdfstarReverseInEmbedded)throw new n.ErrorCoded(`Illegal reverse property in embedded node in ${s}`,n.ERROR_CODES.INVALID_EMBEDDED_NODE)}emitQuadChecked(s,c,l,d,f,h,v){let g;if(h?(this.validateReverseSubject(d),g=this.dataFactory.quad(d,l,c,f)):g=this.dataFactory.quad(c,l,d,f),v){if(g.graph.termType!=="DefaultGraph"&&(g=this.dataFactory.quad(g.subject,g.predicate,g.object)),this.parsingContext.idStack[s-1])throw new n.ErrorCoded("Illegal multiple properties in an embedded node",n.ERROR_CODES.INVALID_EMBEDDED_NODE);this.parsingContext.idStack[s-1]=[g]}else this.parsingContext.emitQuad(s,g);const b=this.parsingContext.annotationsBuffer[s];if(b){for(const _ of b)this.emitAnnotation(s,g,_);delete this.parsingContext.annotationsBuffer[s]}}emitAnnotation(s,c,l){let d;l.reverse?(this.validateReverseSubject(l.object),d=this.dataFactory.quad(l.object,l.predicate,c)):d=this.dataFactory.quad(c,l.predicate,l.object),this.parsingContext.emitQuad(s,d);for(const f of l.nestedAnnotations)this.emitAnnotation(s,d,f)}}return o.XSD="http://www.w3.org/2001/XMLSchema#",o.XSD_BOOLEAN=o.XSD+"boolean",o.XSD_INTEGER=o.XSD+"integer",o.XSD_DOUBLE=o.XSD+"double",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",Util$1.Util=o,Util$1}var hasRequiredEntryHandlerArrayValue;function requireEntryHandlerArrayValue(){if(hasRequiredEntryHandlerArrayValue)return EntryHandlerArrayValue;hasRequiredEntryHandlerArrayValue=1,Object.defineProperty(EntryHandlerArrayValue,"__esModule",{value:!0}),EntryHandlerArrayValue.EntryHandlerArrayValue=void 0;const n=requireUtil$1(),t=requireJsonldContextParser$1();let r=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(o,u,s,c,l){return this.test(o,u,null,s,c)}async test(o,u,s,c,l){return typeof c[l]=="number"}async handle(o,u,s,c,l,d){let f=await u.unaliasKeywordParent(c,d);if(f==="@list"){let h=null,v=0;for(let g=d-2;g>0;g--){const b=c[g];if(typeof b=="string"||typeof b=="number"){v=g,h=b;break}}if(h!==null){const g=await u.valueToTerm(await o.getContext(c),h,l,d,c);for(const b of g)await this.handleListElement(o,u,b,l,d,c.slice(0,v),v);g.length===0&&await this.handleListElement(o,u,null,l,d,c.slice(0,v),v)}}else if(f==="@set")await o.newOnValueJob(c.slice(0,-2),l,d-2,!1);else if(f!==void 0&&f!=="@type"){for(let v=d-1;v>0;v--)if(typeof c[v]!="number"){f=await u.unaliasKeyword(c[v],c,v);break}const h=await o.getContext(c.slice(0,-1));if("@list"in n.Util.getContextValueContainer(h,f)){o.emittedStack[d+1]=!0;const v=await u.valueToTerm(await o.getContext(c),f,l,d,c);for(const g of v)await this.handleListElement(o,u,g,l,d,c.slice(0,-1),d-1);v.length===0&&await this.handleListElement(o,u,null,l,d,c.slice(0,-1),d-1)}else o.shiftStack(d,1),await o.newOnValueJob(c.slice(0,-1),l,d-1,!1),o.contextTree.removeContext(c.slice(0,-1))}}async handleListElement(o,u,s,c,l,d,f){let h=o.listPointerStack[l];if(c!==null&&(await u.unaliasKeywords(c,d,l))["@value"]!==null){if(!h||!h.value){const v=u.dataFactory.blankNode();h={value:v,listRootDepth:f,listId:v}}else{const v=u.dataFactory.blankNode();o.emitQuad(l,u.dataFactory.quad(h.value,u.rdfRest,v,u.getDefaultGraph())),h.value=v}s&&o.emitQuad(l,u.dataFactory.quad(h.value,u.rdfFirst,s,u.getDefaultGraph()))}else h||(h={listRootDepth:f,listId:u.rdfNil});o.listPointerStack[l]=h,o.rdfstar&&o.annotationsBuffer[l]&&o.emitError(new t.ErrorCoded("Found an illegal annotation inside a list",t.ERROR_CODES.INVALID_ANNOTATION))}};return EntryHandlerArrayValue.EntryHandlerArrayValue=r,EntryHandlerArrayValue}var EntryHandlerInvalidFallback={},hasRequiredEntryHandlerInvalidFallback;function requireEntryHandlerInvalidFallback(){if(hasRequiredEntryHandlerInvalidFallback)return EntryHandlerInvalidFallback;hasRequiredEntryHandlerInvalidFallback=1,Object.defineProperty(EntryHandlerInvalidFallback,"__esModule",{value:!0}),EntryHandlerInvalidFallback.EntryHandlerInvalidFallback=void 0;let n=class{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(r,a,o,u,s){return!1}async test(r,a,o,u,s){return!0}async handle(r,a,o,u,s,c){r.emittedStack[c]=!1}};return EntryHandlerInvalidFallback.EntryHandlerInvalidFallback=n,EntryHandlerInvalidFallback}var EntryHandlerKeywordContext={},EntryHandlerKeyword={},hasRequiredEntryHandlerKeyword;function requireEntryHandlerKeyword(){if(hasRequiredEntryHandlerKeyword)return EntryHandlerKeyword;hasRequiredEntryHandlerKeyword=1,Object.defineProperty(EntryHandlerKeyword,"__esModule",{value:!0}),EntryHandlerKeyword.EntryHandlerKeyword=void 0;let n=class{constructor(r){this.keyword=r}isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(r,a,o,u,s){return!1}async test(r,a,o,u,s){return o===this.keyword}};return EntryHandlerKeyword.EntryHandlerKeyword=n,EntryHandlerKeyword}var hasRequiredEntryHandlerKeywordContext;function requireEntryHandlerKeywordContext(){if(hasRequiredEntryHandlerKeywordContext)return EntryHandlerKeywordContext;hasRequiredEntryHandlerKeywordContext=1,Object.defineProperty(EntryHandlerKeywordContext,"__esModule",{value:!0}),EntryHandlerKeywordContext.EntryHandlerKeywordContext=void 0;const n=requireJsonldContextParser$1(),t=requireEntryHandlerKeyword();let r=class extends t.EntryHandlerKeyword{constructor(){super("@context")}isStackProcessor(){return!1}async handle(o,u,s,c,l,d){o.streamingProfile&&(o.processingStack[d]||o.processingType[d]||o.idStack[d]!==void 0)&&o.emitError(new n.ErrorCoded("Found an out-of-order context, while streaming is enabled.(disable `streamingProfile`)",n.ERROR_CODES.INVALID_STREAMING_KEY_ORDER));const f=o.getContext(c),h=o.parseContext(l,(await f).getContextRaw());o.contextTree.setContext(c.slice(0,-1),h),o.emitContext(l),await o.validateContext(await h)}};return EntryHandlerKeywordContext.EntryHandlerKeywordContext=r,EntryHandlerKeywordContext}var EntryHandlerKeywordGraph={},hasRequiredEntryHandlerKeywordGraph;function requireEntryHandlerKeywordGraph(){if(hasRequiredEntryHandlerKeywordGraph)return EntryHandlerKeywordGraph;hasRequiredEntryHandlerKeywordGraph=1,Object.defineProperty(EntryHandlerKeywordGraph,"__esModule",{value:!0}),EntryHandlerKeywordGraph.EntryHandlerKeywordGraph=void 0;const n=requireEntryHandlerKeyword();let t=class extends n.EntryHandlerKeyword{constructor(){super("@graph")}async handle(a,o,u,s,c,l){a.graphStack[l+1]=!0}};return EntryHandlerKeywordGraph.EntryHandlerKeywordGraph=t,EntryHandlerKeywordGraph}var EntryHandlerKeywordId={},hasRequiredEntryHandlerKeywordId;function requireEntryHandlerKeywordId(){if(hasRequiredEntryHandlerKeywordId)return EntryHandlerKeywordId;hasRequiredEntryHandlerKeywordId=1,Object.defineProperty(EntryHandlerKeywordId,"__esModule",{value:!0}),EntryHandlerKeywordId.EntryHandlerKeywordId=void 0;const n=requireJsonldContextParser$1(),t=requireEntryHandlerKeyword();let r=class extends t.EntryHandlerKeyword{constructor(){super("@id")}isStackProcessor(){return!1}async handle(o,u,s,c,l,d){if(typeof l!="string"){if(o.rdfstar&&typeof l=="object"){const h=Object.keys(l);h.length===1&&h[0]==="@id"&&o.emitError(new n.ErrorCoded(`Invalid embedded node without property with @id ${l["@id"]}`,n.ERROR_CODES.INVALID_EMBEDDED_NODE))}else o.emitError(new n.ErrorCoded(`Found illegal @id '${l}'`,n.ERROR_CODES.INVALID_ID_VALUE));return}const f=await u.getPropertiesDepth(c,d);if(o.idStack[f]!==void 0&&(o.idStack[f][0].listHead?o.emitError(new n.ErrorCoded(`Found illegal neighbouring entries next to @list for key: '${c[d-1]}'`,n.ERROR_CODES.INVALID_SET_OR_LIST_OBJECT)):o.emitError(new n.ErrorCoded(`Found duplicate @ids '${o.idStack[f][0].value}' and '${l}'`,n.ERROR_CODES.COLLIDING_KEYWORDS))),o.rdfstar&&o.annotationsBuffer[d])for(const h of o.annotationsBuffer[d])h.depth===d&&o.emitError(new n.ErrorCoded(`Found an illegal @id inside an annotation: ${l}`,n.ERROR_CODES.INVALID_ANNOTATION));o.idStack[f]=u.nullableTermToArray(await u.resourceToTerm(await o.getContext(c),l))}};return EntryHandlerKeywordId.EntryHandlerKeywordId=r,EntryHandlerKeywordId}var EntryHandlerKeywordIncluded={},hasRequiredEntryHandlerKeywordIncluded;function requireEntryHandlerKeywordIncluded(){if(hasRequiredEntryHandlerKeywordIncluded)return EntryHandlerKeywordIncluded;hasRequiredEntryHandlerKeywordIncluded=1,Object.defineProperty(EntryHandlerKeywordIncluded,"__esModule",{value:!0}),EntryHandlerKeywordIncluded.EntryHandlerKeywordIncluded=void 0;const n=requireJsonldContextParser$1(),t=requireEntryHandlerKeyword();let r=class extends t.EntryHandlerKeyword{constructor(){super("@included")}async handle(o,u,s,c,l,d){typeof l!="object"&&o.emitError(new n.ErrorCoded(`Found illegal @included '${l}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE));const f=await u.unaliasKeywords(l,c,d,await o.getContext(c));"@value"in f&&o.emitError(new n.ErrorCoded(`Found an illegal @included @value node '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE)),"@list"in f&&o.emitError(new n.ErrorCoded(`Found an illegal @included @list node '${JSON.stringify(l)}'`,n.ERROR_CODES.INVALID_INCLUDED_VALUE)),o.emittedStack[d]=!1}};return EntryHandlerKeywordIncluded.EntryHandlerKeywordIncluded=r,EntryHandlerKeywordIncluded}var EntryHandlerKeywordNest={},hasRequiredEntryHandlerKeywordNest;function requireEntryHandlerKeywordNest(){if(hasRequiredEntryHandlerKeywordNest)return EntryHandlerKeywordNest;hasRequiredEntryHandlerKeywordNest=1,Object.defineProperty(EntryHandlerKeywordNest,"__esModule",{value:!0}),EntryHandlerKeywordNest.EntryHandlerKeywordNest=void 0;const n=requireJsonldContextParser$1(),t=requireEntryHandlerKeyword();let r=class extends t.EntryHandlerKeyword{constructor(){super("@nest")}async handle(o,u,s,c,l,d){typeof l!="object"&&o.emitError(new n.ErrorCoded(`Found invalid @nest entry for '${s}': '${l}'`,n.ERROR_CODES.INVALID_NEST_VALUE)),"@value"in await u.unaliasKeywords(l,c,d,await o.getContext(c))&&o.emitError(new n.ErrorCoded(`Found an invalid @value node for '${s}'`,n.ERROR_CODES.INVALID_NEST_VALUE)),o.emittedStack[d]=!1}};return EntryHandlerKeywordNest.EntryHandlerKeywordNest=r,EntryHandlerKeywordNest}var EntryHandlerKeywordType={},hasRequiredEntryHandlerKeywordType;function requireEntryHandlerKeywordType(){if(hasRequiredEntryHandlerKeywordType)return EntryHandlerKeywordType;hasRequiredEntryHandlerKeywordType=1,Object.defineProperty(EntryHandlerKeywordType,"__esModule",{value:!0}),EntryHandlerKeywordType.EntryHandlerKeywordType=void 0;const n=requireJsonldContextParser$1(),t=requireUtil$1(),r=requireEntryHandlerPredicate(),a=requireEntryHandlerKeyword();let o=class extends a.EntryHandlerKeyword{constructor(){super("@type")}isStackProcessor(){return!1}async handle(s,c,l,d,f,h){const v=d[h],g=await s.getContext(d),b=c.rdfType,_=await c.unaliasKeywordParent(d,h),S=t.Util.isPropertyReverse(g,v,_),T=t.Util.isPropertyInEmbeddedNode(_);c.validateReverseInEmbeddedNode(l,S,T);const w=t.Util.isPropertyInAnnotationObject(_),A=Array.isArray(f)?f:[f];for(const I of A){typeof I!="string"&&s.emitError(new n.ErrorCoded(`Found illegal @type '${I}'`,n.ERROR_CODES.INVALID_TYPE_VALUE));const L=c.createVocabOrBaseTerm(g,I);L&&await r.EntryHandlerPredicate.handlePredicateObject(s,c,d,h,b,L,S,T,w)}let R=Promise.resolve(g),E=!1;for(const I of A.sort()){const L=t.Util.getContextValue(g,"@context",I,null);L&&(E=!0,R=R.then(F=>s.parseContext(L,F.getContextRaw())))}s.streamingProfile&&(E||!s.streamingProfileAllowOutOfOrderPlainType)&&(s.processingStack[h]||s.idStack[h])&&s.emitError(new n.ErrorCoded("Found an out-of-order type-scoped context, while streaming is enabled.(disable `streamingProfile`)",n.ERROR_CODES.INVALID_STREAMING_KEY_ORDER)),E&&(R=R.then(I=>I.getContextRaw()["@propagate"]!==!0?new n.JsonLdContextNormalized(Object.assign(Object.assign({},I.getContextRaw()),{"@propagate":!1,"@__propagateFallback":g.getContextRaw()})):I),s.contextTree.setContext(d.slice(0,d.length-1),R)),s.processingType[h]=!0}};return EntryHandlerKeywordType.EntryHandlerKeywordType=o,EntryHandlerKeywordType}var EntryHandlerKeywordUnknownFallback={},hasRequiredEntryHandlerKeywordUnknownFallback;function requireEntryHandlerKeywordUnknownFallback(){if(hasRequiredEntryHandlerKeywordUnknownFallback)return EntryHandlerKeywordUnknownFallback;hasRequiredEntryHandlerKeywordUnknownFallback=1,Object.defineProperty(EntryHandlerKeywordUnknownFallback,"__esModule",{value:!0}),EntryHandlerKeywordUnknownFallback.EntryHandlerKeywordUnknownFallback=void 0;const n=requireJsonldContextParser$1();let t=class sa{isPropertyHandler(){return!1}isStackProcessor(){return!0}async validate(a,o,u,s,c){const l=await o.unaliasKeyword(u[s],u,s);return n.Util.isPotentialKeyword(l)?!(!c&&l==="@list"):!1}async test(a,o,u,s,c){return n.Util.isPotentialKeyword(u)}async handle(a,o,u,s,c,l){const d=sa.VALID_KEYWORDS_TYPES[u];d!==void 0?d&&typeof c!==d.type&&a.emitError(new n.ErrorCoded(`Invalid value type for '${u}' with value '${c}'`,d.errorCode)):a.strictValues&&a.emitError(new Error(`Unknown keyword '${u}' with value '${c}'`)),a.emittedStack[l]=!1}};return t.VALID_KEYWORDS_TYPES={"@index":{type:"string",errorCode:n.ERROR_CODES.INVALID_INDEX_VALUE},"@list":null,"@reverse":{type:"object",errorCode:n.ERROR_CODES.INVALID_REVERSE_VALUE},"@set":null,"@value":null},EntryHandlerKeywordUnknownFallback.EntryHandlerKeywordUnknownFallback=t,EntryHandlerKeywordUnknownFallback}var EntryHandlerKeywordValue={},hasRequiredEntryHandlerKeywordValue;function requireEntryHandlerKeywordValue(){if(hasRequiredEntryHandlerKeywordValue)return EntryHandlerKeywordValue;hasRequiredEntryHandlerKeywordValue=1,Object.defineProperty(EntryHandlerKeywordValue,"__esModule",{value:!0}),EntryHandlerKeywordValue.EntryHandlerKeywordValue=void 0;const n=requireEntryHandlerKeyword();let t=class extends n.EntryHandlerKeyword{constructor(){super("@value")}async validate(a,o,u,s,c){const l=u[s];return l&&!a.literalStack[s]&&await this.test(a,o,l,u,s)&&(a.literalStack[s]=!0),super.validate(a,o,u,s,c)}async test(a,o,u,s,c){return await o.unaliasKeyword(s[c],s.slice(0,s.length-1),c-1,!0)==="@value"}async handle(a,o,u,s,c,l){a.literalStack[l]=!0,delete a.unidentifiedValuesBuffer[l],delete a.unidentifiedGraphsBuffer[l],a.emittedStack[l]=!1}};return EntryHandlerKeywordValue.EntryHandlerKeywordValue=t,EntryHandlerKeywordValue}var ParsingContext={},ContextTree={},hasRequiredContextTree;function requireContextTree(){if(hasRequiredContextTree)return ContextTree;hasRequiredContextTree=1,Object.defineProperty(ContextTree,"__esModule",{value:!0}),ContextTree.ContextTree=void 0;let n=class ca{constructor(){this.subTrees={}}getContext(r){if(r.length>0){const[a,...o]=r,u=this.subTrees[a];if(u){const s=u.getContext(o);if(s)return s.then(({context:c,depth:l})=>({context:c,depth:l+1}))}}return this.context?this.context.then(a=>({context:a,depth:0})):null}setContext(r,a){if(r.length===0)this.context=a;else{const[o,...u]=r;let s=this.subTrees[o];s||(s=this.subTrees[o]=new ca),s.setContext(u,a)}}removeContext(r){this.setContext(r,null)}};return ContextTree.ContextTree=n,ContextTree}var hasRequiredParsingContext;function requireParsingContext(){if(hasRequiredParsingContext)return ParsingContext;hasRequiredParsingContext=1,Object.defineProperty(ParsingContext,"__esModule",{value:!0}),ParsingContext.ParsingContext=void 0;const n=requireJsonldContextParser$1(),t=requireErrorCoded$1(),r=requireContextTree(),a=requireJsonLdParser();let o=class la{constructor(s){this.contextParser=new n.ContextParser({documentLoader:s.documentLoader,skipValidation:s.skipContextValidation}),this.streamingProfile=!!s.streamingProfile,this.baseIRI=s.baseIRI,this.produceGeneralizedRdf=!!s.produceGeneralizedRdf,this.allowSubjectList=!!s.allowSubjectList,this.processingMode=s.processingMode||a.JsonLdParser.DEFAULT_PROCESSING_MODE,this.strictValues=!!s.strictValues,this.validateValueIndexes=!!s.validateValueIndexes,this.defaultGraph=s.defaultGraph,this.rdfDirection=s.rdfDirection,this.normalizeLanguageTags=s.normalizeLanguageTags,this.streamingProfileAllowOutOfOrderPlainType=s.streamingProfileAllowOutOfOrderPlainType,this.rdfstar=s.rdfstar!==!1,this.rdfstarReverseInEmbedded=s.rdfstarReverseInEmbedded,this.topLevelProperties=!1,this.activeProcessingMode=parseFloat(this.processingMode),this.processingStack=[],this.processingType=[],this.emittedStack=[],this.idStack=[],this.graphStack=[],this.graphContainerTermStack=[],this.listPointerStack=[],this.contextTree=new r.ContextTree,this.literalStack=[],this.validationStack=[],this.unaliasedKeywordCacheStack=[],this.jsonLiteralStack=[],this.unidentifiedValuesBuffer=[],this.unidentifiedGraphsBuffer=[],this.annotationsBuffer=[],this.pendingContainerFlushBuffers=[],this.parser=s.parser,s.context?(this.rootContext=this.parseContext(s.context),this.rootContext.then(c=>this.validateContext(c))):this.rootContext=Promise.resolve(new n.JsonLdContextNormalized(this.baseIRI?{"@base":this.baseIRI,"@__baseDocument":!0}:{}))}async parseContext(s,c,l){return this.contextParser.parse(s,{baseIRI:this.baseIRI,ignoreProtection:l,normalizeLanguageTags:this.normalizeLanguageTags,parentContext:c,processingMode:this.activeProcessingMode})}validateContext(s){const c=s.getContextRaw()["@version"];if(c){if(this.activeProcessingMode&&c>this.activeProcessingMode)throw new t.ErrorCoded(`Unsupported JSON-LD version '${c}' under active processing mode ${this.activeProcessingMode}.`,t.ERROR_CODES.PROCESSING_MODE_CONFLICT);if(this.activeProcessingMode&&c<this.activeProcessingMode)throw new t.ErrorCoded(`Invalid JSON-LD version ${c} under active processing mode ${this.activeProcessingMode}.`,t.ERROR_CODES.INVALID_VERSION_VALUE);this.activeProcessingMode=c}}async getContext(s,c=1){const l=s;for(;typeof s[s.length-1]=="number";)s=s.slice(0,s.length-1);c&&(s=s.slice(0,-c));const d=await this.getContextPropagationAware(s);let h=d.context.getContextRaw();for(let v=d.depth;v<l.length-c;v++){const g=l[v],b=h[g];if(b&&typeof b=="object"&&"@context"in b){const _=(await this.parseContext(b,h,!0)).getContextRaw(),S=!(g in _)||_[g]["@context"]["@propagate"];(S!==!1||v===l.length-1-c)&&(h=Object.assign({},_),delete h["@propagate"],h[g]=Object.assign({},h[g]),"@id"in b&&(h[g]["@id"]=b["@id"]),delete h[g]["@context"],S!==!1&&this.contextTree.setContext(l.slice(0,v+c),Promise.resolve(new n.JsonLdContextNormalized(h))))}}return new n.JsonLdContextNormalized(h)}async getContextPropagationAware(s){const c=s.length;let l=null,d;do{d=!1,l&&"@__propagateFallback"in l.context.getContextRaw()?l.context=new n.JsonLdContextNormalized(l.context.getContextRaw()["@__propagateFallback"]):(l&&(s=s.slice(0,l.depth-1)),l=await this.contextTree.getContext(s)||{context:await this.rootContext,depth:0});const f=s[s.length-1];if(f in l.context.getContextRaw()){const h=l.context.getContextRaw()[f];h&&typeof h=="object"&&"@context"in h&&(d=!0)}}while(l.depth>0&&l.context.getContextRaw()["@propagate"]===!1&&l.depth!==c&&!d);return l.depth===0&&l.context.getContextRaw()["@propagate"]===!1&&l.depth!==c&&(l.context=new n.JsonLdContextNormalized({})),l}async newOnValueJob(s,c,l,d){await this.parser.newOnValueJob(s,c,l,d)}async handlePendingContainerFlushBuffers(){if(this.pendingContainerFlushBuffers.length>0){for(const s of this.pendingContainerFlushBuffers)await this.parser.flushBuffer(s.depth,s.keys),this.parser.flushStacks(s.depth);return this.pendingContainerFlushBuffers.splice(0,this.pendingContainerFlushBuffers.length),!0}else return!1}emitQuad(s,c){s===1&&(this.topLevelProperties=!0),this.parser.push(c)}emitError(s){this.parser.emit("error",s)}emitContext(s){this.parser.emit("context",s)}getUnidentifiedValueBufferSafe(s){let c=this.unidentifiedValuesBuffer[s];return c||(c=[],this.unidentifiedValuesBuffer[s]=c),c}getUnidentifiedGraphBufferSafe(s){let c=this.unidentifiedGraphsBuffer[s];return c||(c=[],this.unidentifiedGraphsBuffer[s]=c),c}getAnnotationsBufferSafe(s){let c=this.annotationsBuffer[s];return c||(c=[],this.annotationsBuffer[s]=c),c}getExpandOptions(){return la.EXPAND_OPTIONS[this.activeProcessingMode]}shiftStack(s,c){const l=this.idStack[s+c];if(l&&(this.idStack[s]=l,this.emittedStack[s]=!0,delete this.idStack[s+c]),this.pendingContainerFlushBuffers.length)for(const d of this.pendingContainerFlushBuffers)d.depth>=s+c&&(d.depth-=c,d.keys.splice(s,c));this.unidentifiedValuesBuffer[s+c]&&(this.unidentifiedValuesBuffer[s]=this.unidentifiedValuesBuffer[s+c],delete this.unidentifiedValuesBuffer[s+c]),this.annotationsBuffer[s+c-1]&&(this.annotationsBuffer[s-1]||(this.annotationsBuffer[s-1]=[]),this.annotationsBuffer[s-1]=[...this.annotationsBuffer[s-1],...this.annotationsBuffer[s+c-1]],delete this.annotationsBuffer[s+c-1])}};return o.EXPAND_OPTIONS={1:{allowPrefixForcing:!1,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!1},1.1:{allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}},ParsingContext.ParsingContext=o,ParsingContext}var EntryHandlerKeywordAnnotation={},hasRequiredEntryHandlerKeywordAnnotation;function requireEntryHandlerKeywordAnnotation(){if(hasRequiredEntryHandlerKeywordAnnotation)return EntryHandlerKeywordAnnotation;hasRequiredEntryHandlerKeywordAnnotation=1,Object.defineProperty(EntryHandlerKeywordAnnotation,"__esModule",{value:!0}),EntryHandlerKeywordAnnotation.EntryHandlerKeywordAnnotation=void 0;const n=requireEntryHandlerKeyword(),t=requireJsonldContextParser$1();let r=class extends n.EntryHandlerKeyword{constructor(){super("@annotation")}async handle(o,u,s,c,l,d){(typeof l=="string"||typeof l=="object"&&l["@value"])&&o.emitError(new t.ErrorCoded(`Found illegal annotation value: ${JSON.stringify(l)}`,t.ERROR_CODES.INVALID_ANNOTATION))}};return EntryHandlerKeywordAnnotation.EntryHandlerKeywordAnnotation=r,EntryHandlerKeywordAnnotation}var hasRequiredJsonLdParser;function requireJsonLdParser(){if(hasRequiredJsonLdParser)return JsonLdParser;hasRequiredJsonLdParser=1,Object.defineProperty(JsonLdParser,"__esModule",{value:!0}),JsonLdParser.JsonLdParser=void 0;const n=requireJsonparse(),t=requireJsonldContextParser$1(),r=requireBrowser(),a=requireEntryHandlerArrayValue(),o=requireEntryHandlerContainer(),u=requireEntryHandlerInvalidFallback(),s=requireEntryHandlerPredicate(),c=requireEntryHandlerKeywordContext(),l=requireEntryHandlerKeywordGraph(),d=requireEntryHandlerKeywordId(),f=requireEntryHandlerKeywordIncluded(),h=requireEntryHandlerKeywordNest(),v=requireEntryHandlerKeywordType(),g=requireEntryHandlerKeywordUnknownFallback(),b=requireEntryHandlerKeywordValue(),_=requireParsingContext(),S=requireUtil$1(),T=requireLink(),w=requireEntryHandlerKeywordAnnotation();let A=class Gr extends r.Transform{constructor(E){super({readableObjectMode:!0}),E=E||{},this.options=E,this.parsingContext=new _.ParsingContext(Object.assign({parser:this},E)),this.util=new S.Util({dataFactory:E.dataFactory,parsingContext:this.parsingContext}),this.jsonParser=new n,this.contextJobs=[],this.typeJobs=[],this.contextAwaitingJobs=[],this.lastDepth=0,this.lastKeys=[],this.lastOnValueJob=Promise.resolve(),this.attachJsonParserListeners(),this.on("end",()=>{typeof this.jsonParser.mode<"u"&&this.emit("error",new Error("Unclosed document"))})}static fromHttpResponse(E,I,L,F){let D,$=["application/activity+json"];if(F&&F.wellKnownMediaTypes&&($=F.wellKnownMediaTypes),I!=="application/ld+json"&&!$.includes(I)){if(I!=="application/json"&&!I.endsWith("+json"))throw new t.ErrorCoded(`Unsupported JSON-LD media type ${I}`,t.ERROR_CODES.LOADING_DOCUMENT_FAILED);if(L&&L.has("Link")&&L.forEach((P,C)=>{if(C==="link"){const q=(0,T.parse)(P);for(const M of q.get("rel","http://www.w3.org/ns/json-ld#context")){if(D)throw new t.ErrorCoded("Multiple JSON-LD context link headers were found on "+E,t.ERROR_CODES.MULTIPLE_CONTEXT_LINK_HEADERS);D=M.uri}}}),!D&&!(F!=null&&F.ignoreMissingContextLinkHeader))throw new t.ErrorCoded(`Missing context link header for media type ${I} on ${E}`,t.ERROR_CODES.LOADING_DOCUMENT_FAILED)}let O;if(L&&L.has("Content-Type")){const P=L.get("Content-Type"),C=/; *profile=([^"]*)/.exec(P);C&&C[1]==="http://www.w3.org/ns/json-ld#streaming"&&(O=!0)}return new Gr(Object.assign({baseIRI:E,context:D,streamingProfile:O},F||{}))}import(E){if("pipe"in E){E.on("error",L=>I.emit("error",L));const I=E.pipe(new Gr(this.options));return I}else{const I=new r.PassThrough({readableObjectMode:!0});E.on("error",F=>L.emit("error",F)),E.on("data",F=>I.push(F)),E.on("end",()=>I.push(null));const L=I.pipe(new Gr(this.options));return L}}_transform(E,I,L){this.jsonParser.write(E),this.lastOnValueJob.then(()=>L(),F=>L(F))}async newOnValueJob(E,I,L,F){let D=!0;if(F&&L<this.lastDepth){const q=this.parsingContext.listPointerStack[this.lastDepth];q&&(q.value&&this.push(this.util.dataFactory.quad(q.value,this.util.rdfRest,this.util.rdfNil,this.util.getDefaultGraph())),q.listId.listHead=!0,this.parsingContext.idStack[q.listRootDepth+1]=[q.listId],this.parsingContext.listPointerStack.splice(this.lastDepth,1)),await o.EntryHandlerContainer.isBufferableContainerHandler(this.parsingContext,this.lastKeys,this.lastDepth)?(this.parsingContext.pendingContainerFlushBuffers.push({depth:this.lastDepth,keys:this.lastKeys.slice(0,this.lastKeys.length)}),D=!1):await this.flushBuffer(this.lastDepth,this.lastKeys)}const $=await this.util.unaliasKeyword(E[L],E,L),O=await this.util.unaliasKeywordParent(E,L);this.parsingContext.emittedStack[L]=!0;let P=!0;t.Util.isValidKeyword($)&&O==="@reverse"&&$!=="@context"&&this.emit("error",new t.ErrorCoded(`Found the @id '${I}' inside an @reverse property`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY_MAP));let C=!1;this.parsingContext.validationStack.length>1&&(C=this.parsingContext.validationStack[this.parsingContext.validationStack.length-1].property);for(let q=Math.max(1,this.parsingContext.validationStack.length-1);q<E.length-1;q++){const M=this.parsingContext.validationStack[q]||(this.parsingContext.validationStack[q]=await this.validateKey(E.slice(0,q+1),q,C));if(M.valid)!C&&M.property&&(C=!0);else{this.parsingContext.emittedStack[L]=!1,P=!1;break}}if(await this.util.isLiteral(E,L)&&(P=!1),P)for(const q of Gr.ENTRY_HANDLERS){const M=await q.test(this.parsingContext,this.util,$,E,L);if(M){await q.handle(this.parsingContext,this.util,$,E,I,L,M),q.isStackProcessor()&&(this.parsingContext.processingStack[L]=!0);break}}L===0&&Array.isArray(I)&&await this.util.validateValueIndexes(I),D&&L<this.lastDepth&&this.flushStacks(this.lastDepth),this.lastDepth=L,this.lastKeys=E,this.parsingContext.unaliasedKeywordCacheStack.splice(L-1)}flushStacks(E){this.parsingContext.processingStack.splice(E,1),this.parsingContext.processingType.splice(E,1),this.parsingContext.emittedStack.splice(E,1),this.parsingContext.idStack.splice(E,1),this.parsingContext.graphStack.splice(E+1,1),this.parsingContext.graphContainerTermStack.splice(E,1),this.parsingContext.jsonLiteralStack.splice(E,1),this.parsingContext.validationStack.splice(E-1,2),this.parsingContext.literalStack.splice(E,this.parsingContext.literalStack.length-E),this.parsingContext.annotationsBuffer.splice(E,1)}async flushBuffer(E,I){let L=this.parsingContext.idStack[E];!!L||(L=this.parsingContext.idStack[E]=[this.util.dataFactory.blankNode()]);const D=this.parsingContext.unidentifiedValuesBuffer[E];if(D){for(const P of L){const C=await this.util.getDepthOffsetGraph(E,I),q=this.parsingContext.graphStack[E]||C>=0?this.parsingContext.idStack[E-C-1]:[await this.util.getGraphContainerValue(I,E)];if(q)for(const M of q){this.parsingContext.emittedStack[E]=!0;for(const N of D)this.util.emitQuadChecked(E,P,N.predicate,N.object,M,N.reverse,N.isEmbedded)}else{const M=this.parsingContext.getUnidentifiedGraphBufferSafe(E-await this.util.getDepthOffsetGraph(E,I)-1);for(const N of D)N.reverse?M.push({object:P,predicate:N.predicate,subject:N.object,isEmbedded:N.isEmbedded}):M.push({object:N.object,predicate:N.predicate,subject:P,isEmbedded:N.isEmbedded})}}this.parsingContext.unidentifiedValuesBuffer.splice(E,1),this.parsingContext.literalStack.splice(E,1),this.parsingContext.jsonLiteralStack.splice(E,1)}const $=this.parsingContext.unidentifiedGraphsBuffer[E];if($){for(const P of L){const C=E===1&&P.termType==="BlankNode"&&!this.parsingContext.topLevelProperties?this.util.getDefaultGraph():P;this.parsingContext.emittedStack[E]=!0;for(const q of $)this.parsingContext.emitQuad(E,this.util.dataFactory.quad(q.subject,q.predicate,q.object,C))}this.parsingContext.unidentifiedGraphsBuffer.splice(E,1)}const O=this.parsingContext.annotationsBuffer[E];if(O){O.length>0&&E===1&&this.parsingContext.emitError(new t.ErrorCoded("Annotations can not be made on top-level nodes",t.ERROR_CODES.INVALID_ANNOTATION));const P=this.parsingContext.getAnnotationsBufferSafe(E-1);for(const C of O)P.push(C);delete this.parsingContext.annotationsBuffer[E]}}async validateKey(E,I,L){for(const F of Gr.ENTRY_HANDLERS)if(await F.validate(this.parsingContext,this.util,E,I,L))return{valid:!0,property:L||F.isPropertyHandler()};return{valid:!1,property:!1}}attachJsonParserListeners(){this.jsonParser.onValue=E=>{const I=this.jsonParser.stack.length,L=new Array(I+1).fill(0).map((F,D)=>D===I?this.jsonParser.key:this.jsonParser.stack[D].key);if(!this.isParsingContextInner(I)){const F=()=>this.newOnValueJob(L,E,I,!0);if(!this.parsingContext.streamingProfile&&!this.parsingContext.contextTree.getContext(L.slice(0,-1)))if(L[I]==="@context"){let D=this.contextJobs[I];D||(D=this.contextJobs[I]=[]),D.push(F)}else this.contextAwaitingJobs.push({job:F,keys:L,depth:I});else this.lastOnValueJob=this.lastOnValueJob.then(F);!this.parsingContext.streamingProfile&&I===0&&(this.lastOnValueJob=this.lastOnValueJob.then(()=>this.executeBufferedJobs()))}},this.jsonParser.onError=E=>{this.emit("error",E)}}isParsingContextInner(E){for(let I=E;I>0;I--)if(this.jsonParser.stack[I-1].key==="@context")return!0;return!1}async executeBufferedJobs(){for(const I of this.contextJobs)if(I)for(const L of I)await L();this.parsingContext.unaliasedKeywordCacheStack.splice(0);const E=[];for(const I of this.contextAwaitingJobs)await this.util.unaliasKeyword(I.keys[I.depth],I.keys,I.depth,!0)==="@type"||typeof I.keys[I.depth]=="number"&&await this.util.unaliasKeyword(I.keys[I.depth-1],I.keys,I.depth-1,!0)==="@type"?this.typeJobs.push({job:I.job,keys:I.keys.slice(0,I.keys.length-1)}):E.push(I);for(const I of E){if(this.typeJobs.length>0){const L=[],F=[];for(let O=0;O<this.typeJobs.length;O++){const P=this.typeJobs[O];S.Util.isPrefixArray(P.keys,I.keys)&&(L.push(P),F.push(O))}const D=L.sort((O,P)=>O.keys.length-P.keys.length);for(const O of D)await O.job();const $=F.sort().reverse();for(const O of $)this.typeJobs.splice(O,1)}await I.job()}}};return A.DEFAULT_PROCESSING_MODE="1.1",A.ENTRY_HANDLERS=[new a.EntryHandlerArrayValue,new c.EntryHandlerKeywordContext,new d.EntryHandlerKeywordId,new f.EntryHandlerKeywordIncluded,new l.EntryHandlerKeywordGraph,new h.EntryHandlerKeywordNest,new v.EntryHandlerKeywordType,new b.EntryHandlerKeywordValue,new w.EntryHandlerKeywordAnnotation,new o.EntryHandlerContainer,new g.EntryHandlerKeywordUnknownFallback,new s.EntryHandlerPredicate,new u.EntryHandlerInvalidFallback],JsonLdParser.JsonLdParser=A,JsonLdParser}var hasRequiredJsonldStreamingParser;function requireJsonldStreamingParser(){return hasRequiredJsonldStreamingParser||(hasRequiredJsonldStreamingParser=1,function(n){var t=jsonldStreamingParser&&jsonldStreamingParser.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldStreamingParser&&jsonldStreamingParser.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireJsonLdParser(),n)}(jsonldStreamingParser)),jsonldStreamingParser}var DocumentLoaderMediated={},jsonldContextParser={},ContextParser={},browserPolyfill={},hasRequiredBrowserPolyfill;function requireBrowserPolyfill(){return hasRequiredBrowserPolyfill||(hasRequiredBrowserPolyfill=1,function(){(function(n){(function(t){var r=typeof globalThis<"u"&&globalThis||typeof n<"u"&&n||typeof commonjsGlobal$1<"u"&&commonjsGlobal$1||{},a={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function o($){return $&&DataView.prototype.isPrototypeOf($)}if(a.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function($){return $&&u.indexOf(Object.prototype.toString.call($))>-1};function c($){if(typeof $!="string"&&($=String($)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test($)||$==="")throw new TypeError('Invalid character in header field name: "'+$+'"');return $.toLowerCase()}function l($){return typeof $!="string"&&($=String($)),$}function d($){var O={next:function(){var P=$.shift();return{done:P===void 0,value:P}}};return a.iterable&&(O[Symbol.iterator]=function(){return O}),O}function f($){this.map={},$ instanceof f?$.forEach(function(O,P){this.append(P,O)},this):Array.isArray($)?$.forEach(function(O){if(O.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+O.length);this.append(O[0],O[1])},this):$&&Object.getOwnPropertyNames($).forEach(function(O){this.append(O,$[O])},this)}f.prototype.append=function($,O){$=c($),O=l(O);var P=this.map[$];this.map[$]=P?P+", "+O:O},f.prototype.delete=function($){delete this.map[c($)]},f.prototype.get=function($){return $=c($),this.has($)?this.map[$]:null},f.prototype.has=function($){return this.map.hasOwnProperty(c($))},f.prototype.set=function($,O){this.map[c($)]=l(O)},f.prototype.forEach=function($,O){for(var P in this.map)this.map.hasOwnProperty(P)&&$.call(O,this.map[P],P,this)},f.prototype.keys=function(){var $=[];return this.forEach(function(O,P){$.push(P)}),d($)},f.prototype.values=function(){var $=[];return this.forEach(function(O){$.push(O)}),d($)},f.prototype.entries=function(){var $=[];return this.forEach(function(O,P){$.push([P,O])}),d($)},a.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function h($){if(!$._noBody){if($.bodyUsed)return Promise.reject(new TypeError("Already read"));$.bodyUsed=!0}}function v($){return new Promise(function(O,P){$.onload=function(){O($.result)},$.onerror=function(){P($.error)}})}function g($){var O=new FileReader,P=v(O);return O.readAsArrayBuffer($),P}function b($){var O=new FileReader,P=v(O),C=/charset=([A-Za-z0-9_-]+)/.exec($.type),q=C?C[1]:"utf-8";return O.readAsText($,q),P}function _($){for(var O=new Uint8Array($),P=new Array(O.length),C=0;C<O.length;C++)P[C]=String.fromCharCode(O[C]);return P.join("")}function S($){if($.slice)return $.slice(0);var O=new Uint8Array($.byteLength);return O.set(new Uint8Array($)),O.buffer}function T(){return this.bodyUsed=!1,this._initBody=function($){this.bodyUsed=this.bodyUsed,this._bodyInit=$,$?typeof $=="string"?this._bodyText=$:a.blob&&Blob.prototype.isPrototypeOf($)?this._bodyBlob=$:a.formData&&FormData.prototype.isPrototypeOf($)?this._bodyFormData=$:a.searchParams&&URLSearchParams.prototype.isPrototypeOf($)?this._bodyText=$.toString():a.arrayBuffer&&a.blob&&o($)?(this._bodyArrayBuffer=S($.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf($)||s($))?this._bodyArrayBuffer=S($):this._bodyText=$=Object.prototype.toString.call($):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof $=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf($)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var $=h(this);if($)return $;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var $=h(this);return $||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(a.blob)return this.blob().then(g);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var $=h(this);if($)return $;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(_(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var w=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function A($){var O=$.toUpperCase();return w.indexOf(O)>-1?O:$}function R($,O){if(!(this instanceof R))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');O=O||{};var P=O.body;if($ instanceof R){if($.bodyUsed)throw new TypeError("Already read");this.url=$.url,this.credentials=$.credentials,O.headers||(this.headers=new f($.headers)),this.method=$.method,this.mode=$.mode,this.signal=$.signal,!P&&$._bodyInit!=null&&(P=$._bodyInit,$.bodyUsed=!0)}else this.url=String($);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new f(O.headers)),this.method=A(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal||function(){if("AbortController"in r){var M=new AbortController;return M.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(P),(this.method==="GET"||this.method==="HEAD")&&(O.cache==="no-store"||O.cache==="no-cache")){var C=/([?&])_=[^&]*/;if(C.test(this.url))this.url=this.url.replace(C,"$1_="+new Date().getTime());else{var q=/\?/;this.url+=(q.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})};function E($){var O=new FormData;return $.trim().split("&").forEach(function(P){if(P){var C=P.split("="),q=C.shift().replace(/\+/g," "),M=C.join("=").replace(/\+/g," ");O.append(decodeURIComponent(q),decodeURIComponent(M))}}),O}function I($){var O=new f,P=$.replace(/\r?\n[\t ]+/g," ");return P.split("\r").map(function(C){return C.indexOf(`
`)===0?C.substr(1,C.length):C}).forEach(function(C){var q=C.split(":"),M=q.shift().trim();if(M){var N=q.join(":").trim();try{O.append(M,N)}catch(G){console.warn("Response "+G.message)}}}),O}T.call(R.prototype);function L($,O){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=O.statusText===void 0?"":""+O.statusText,this.headers=new f(O.headers),this.url=O.url||"",this._initBody($)}T.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},L.error=function(){var $=new L(null,{status:200,statusText:""});return $.ok=!1,$.status=0,$.type="error",$};var F=[301,302,303,307,308];L.redirect=function($,O){if(F.indexOf(O)===-1)throw new RangeError("Invalid status code");return new L(null,{status:O,headers:{location:$}})},t.DOMException=r.DOMException;try{new t.DOMException}catch{t.DOMException=function(O,P){this.message=O,this.name=P;var C=Error(O);this.stack=C.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function D($,O){return new Promise(function(P,C){var q=new R($,O);if(q.signal&&q.signal.aborted)return C(new t.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function N(){M.abort()}M.onload=function(){var Y={statusText:M.statusText,headers:I(M.getAllResponseHeaders()||"")};q.url.indexOf("file://")===0&&(M.status<200||M.status>599)?Y.status=200:Y.status=M.status,Y.url="responseURL"in M?M.responseURL:Y.headers.get("X-Request-URL");var W="response"in M?M.response:M.responseText;setTimeout(function(){P(new L(W,Y))},0)},M.onerror=function(){setTimeout(function(){C(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){C(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){C(new t.DOMException("Aborted","AbortError"))},0)};function G(Y){try{return Y===""&&r.location.href?r.location.href:Y}catch{return Y}}if(M.open(q.method,G(q.url),!0),q.credentials==="include"?M.withCredentials=!0:q.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(a.blob?M.responseType="blob":a.arrayBuffer&&(M.responseType="arraybuffer")),O&&typeof O.headers=="object"&&!(O.headers instanceof f||r.Headers&&O.headers instanceof r.Headers)){var X=[];Object.getOwnPropertyNames(O.headers).forEach(function(Y){X.push(c(Y)),M.setRequestHeader(Y,l(O.headers[Y]))}),q.headers.forEach(function(Y,W){X.indexOf(W)===-1&&M.setRequestHeader(W,Y)})}else q.headers.forEach(function(Y,W){M.setRequestHeader(W,Y)});q.signal&&(q.signal.addEventListener("abort",N),M.onreadystatechange=function(){M.readyState===4&&q.signal.removeEventListener("abort",N)}),M.send(typeof q._bodyInit>"u"?null:q._bodyInit)})}return D.polyfill=!0,r.fetch||(r.fetch=D,r.Headers=f,r.Request=R,r.Response=L),t.Headers=f,t.Request=R,t.Response=L,t.fetch=D,Object.defineProperty(t,"__esModule",{value:!0}),t})({})})(typeof self<"u"?self:browserPolyfill)}()),browserPolyfill}var ErrorCoded={},hasRequiredErrorCoded;function requireErrorCoded(){return hasRequiredErrorCoded||(hasRequiredErrorCoded=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ERROR_CODES=n.ErrorCoded=void 0;class t extends Error{constructor(a,o){super(a),this.code=o}}n.ErrorCoded=t,function(r){r.COLLIDING_KEYWORDS="colliding keywords",r.CONFLICTING_INDEXES="conflicting indexes",r.CYCLIC_IRI_MAPPING="cyclic IRI mapping",r.INVALID_ID_VALUE="invalid @id value",r.INVALID_INDEX_VALUE="invalid @index value",r.INVALID_NEST_VALUE="invalid @nest value",r.INVALID_PREFIX_VALUE="invalid @prefix value",r.INVALID_PROPAGATE_VALUE="invalid @propagate value",r.INVALID_REVERSE_VALUE="invalid @reverse value",r.INVALID_IMPORT_VALUE="invalid @import value",r.INVALID_VERSION_VALUE="invalid @version value",r.INVALID_BASE_IRI="invalid base IRI",r.INVALID_CONTAINER_MAPPING="invalid container mapping",r.INVALID_CONTEXT_ENTRY="invalid context entry",r.INVALID_CONTEXT_NULLIFICATION="invalid context nullification",r.INVALID_DEFAULT_LANGUAGE="invalid default language",r.INVALID_INCLUDED_VALUE="invalid @included value",r.INVALID_IRI_MAPPING="invalid IRI mapping",r.INVALID_JSON_LITERAL="invalid JSON literal",r.INVALID_KEYWORD_ALIAS="invalid keyword alias",r.INVALID_LANGUAGE_MAP_VALUE="invalid language map value",r.INVALID_LANGUAGE_MAPPING="invalid language mapping",r.INVALID_LANGUAGE_TAGGED_STRING="invalid language-tagged string",r.INVALID_LANGUAGE_TAGGED_VALUE="invalid language-tagged value",r.INVALID_LOCAL_CONTEXT="invalid local context",r.INVALID_REMOTE_CONTEXT="invalid remote context",r.INVALID_REVERSE_PROPERTY="invalid reverse property",r.INVALID_REVERSE_PROPERTY_MAP="invalid reverse property map",r.INVALID_REVERSE_PROPERTY_VALUE="invalid reverse property value",r.INVALID_SCOPED_CONTEXT="invalid scoped context",r.INVALID_SCRIPT_ELEMENT="invalid script element",r.INVALID_SET_OR_LIST_OBJECT="invalid set or list object",r.INVALID_TERM_DEFINITION="invalid term definition",r.INVALID_TYPE_MAPPING="invalid type mapping",r.INVALID_TYPE_VALUE="invalid type value",r.INVALID_TYPED_VALUE="invalid typed value",r.INVALID_VALUE_OBJECT="invalid value object",r.INVALID_VALUE_OBJECT_VALUE="invalid value object value",r.INVALID_VOCAB_MAPPING="invalid vocab mapping",r.IRI_CONFUSED_WITH_PREFIX="IRI confused with prefix",r.KEYWORD_REDEFINITION="keyword redefinition",r.LOADING_DOCUMENT_FAILED="loading document failed",r.LOADING_REMOTE_CONTEXT_FAILED="loading remote context failed",r.MULTIPLE_CONTEXT_LINK_HEADERS="multiple context link headers",r.PROCESSING_MODE_CONFLICT="processing mode conflict",r.PROTECTED_TERM_REDEFINITION="protected term redefinition",r.CONTEXT_OVERFLOW="context overflow",r.INVALID_BASE_DIRECTION="invalid base direction",r.RECURSIVE_CONTEXT_INCLUSION="recursive context inclusion",r.INVALID_STREAMING_KEY_ORDER="invalid streaming key order",r.INVALID_EMBEDDED_NODE="invalid embedded node",r.INVALID_ANNOTATION="invalid annotation"}(n.ERROR_CODES||(n.ERROR_CODES={}))}(ErrorCoded)),ErrorCoded}var FetchDocumentLoader={},hasRequiredFetchDocumentLoader;function requireFetchDocumentLoader(){if(hasRequiredFetchDocumentLoader)return FetchDocumentLoader;hasRequiredFetchDocumentLoader=1,Object.defineProperty(FetchDocumentLoader,"__esModule",{value:!0}),FetchDocumentLoader.FetchDocumentLoader=void 0,requireBrowserPolyfill();const n=requireErrorCoded(),t=requireLink(),r=requireRelativeToAbsoluteIri();let a=class{constructor(u){this.fetcher=u}async load(u){const s=await(this.fetcher||fetch)(u,{headers:new Headers({accept:"application/ld+json"})});if(s.ok&&s.headers){let c=s.headers.get("Content-Type");if(c){const l=c.indexOf(";");l>0&&(c=c.substr(0,l))}if(c==="application/ld+json")return await s.json();if(s.headers.has("Link")){let l;if(s.headers.forEach((d,f)=>{if(f==="link"){const h=(0,t.parse)(d);for(const v of h.get("type","application/ld+json"))if(v.rel==="alternate"){if(l)throw new Error("Multiple JSON-LD alternate links were found on "+u);l=(0,r.resolve)(v.uri,u)}}}),l)return this.load(l)}throw new n.ErrorCoded(`Unsupported JSON-LD media type ${c}`,n.ERROR_CODES.LOADING_DOCUMENT_FAILED)}else throw new Error(s.statusText||`Status code: ${s.status}`)}};return FetchDocumentLoader.FetchDocumentLoader=a,FetchDocumentLoader}var JsonLdContextNormalized={},Util={},hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return Util;hasRequiredUtil=1,Object.defineProperty(Util,"__esModule",{value:!0}),Util.Util=void 0;let n=class ur{static isCompactIri(r){return r.indexOf(":")>0&&!(r&&r[0]==="#")}static getPrefix(r,a){if(r&&r[0]==="#")return null;const o=r.indexOf(":");if(o>=0){if(r.length>o+1&&r.charAt(o+1)==="/"&&r.charAt(o+2)==="/")return null;const u=r.substr(0,o);if(u==="_")return null;if(a[u])return u}return null}static getContextValueId(r){if(r===null||typeof r=="string")return r;const a=r["@id"];return a||null}static isSimpleTermDefinitionPrefix(r,a){return!ur.isPotentialKeyword(r)&&(a.allowPrefixNonGenDelims||typeof r=="string"&&(r[0]==="_"||ur.isPrefixIriEndingWithGenDelim(r)))}static isPotentialKeyword(r){return typeof r=="string"&&ur.KEYWORD_REGEX.test(r)}static isPrefixIriEndingWithGenDelim(r){return ur.ENDS_WITH_GEN_DELIM.test(r)}static isPrefixValue(r){return r&&(typeof r=="string"||r&&typeof r=="object")}static isValidIri(r){return!!(r&&ur.IRI_REGEX.test(r))}static isValidIriWeak(r){return!!r&&r[0]!==":"&&ur.IRI_REGEX_WEAK.test(r)}static isValidKeyword(r){return ur.VALID_KEYWORDS[r]}static isTermProtected(r,a){const o=r[a];return typeof o!="string"&&o&&o["@protected"]}static hasProtectedTerms(r){for(const a of Object.keys(r))if(ur.isTermProtected(r,a))return!0;return!1}static isReservedInternalKeyword(r){return r.startsWith("@__")}static deepEqual(r,a){const o=Object.keys(r),u=Object.keys(a);return o.length!==u.length?!1:o.every(s=>{const c=r[s],l=a[s];return c===l||c!==null&&l!==null&&typeof c=="object"&&typeof l=="object"&&this.deepEqual(c,l)})}};return n.IRI_REGEX=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^ "<>{}|\\\[\]`#]*(#[^#]*)?$/,n.IRI_REGEX_WEAK=/(?::[^:])|\//,n.KEYWORD_REGEX=/^@[a-z]+$/i,n.ENDS_WITH_GEN_DELIM=/[:/?#\[\]@]$/,n.REGEX_LANGUAGE_TAG=/^[a-zA-Z]+(-[a-zA-Z0-9]+)*$/,n.REGEX_DIRECTION_TAG=/^(ltr)|(rtl)$/,n.VALID_KEYWORDS={"@annotation":!0,"@base":!0,"@container":!0,"@context":!0,"@direction":!0,"@graph":!0,"@id":!0,"@import":!0,"@included":!0,"@index":!0,"@json":!0,"@language":!0,"@list":!0,"@nest":!0,"@none":!0,"@prefix":!0,"@propagate":!0,"@protected":!0,"@reverse":!0,"@set":!0,"@type":!0,"@value":!0,"@version":!0,"@vocab":!0},n.EXPAND_KEYS_BLACKLIST=["@base","@vocab","@language","@version","@direction"],n.ALIAS_DOMAIN_BLACKLIST=["@container","@graph","@id","@index","@list","@nest","@none","@prefix","@reverse","@set","@type","@value","@version"],n.ALIAS_RANGE_BLACKLIST=["@context","@preserve"],n.CONTAINERS=["@list","@set","@index","@language","@graph","@id","@type"],n.CONTAINERS_1_0=["@list","@set","@index"],Util.Util=n,Util}var hasRequiredJsonLdContextNormalized;function requireJsonLdContextNormalized(){return hasRequiredJsonLdContextNormalized||(hasRequiredJsonLdContextNormalized=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.defaultExpandOptions=n.JsonLdContextNormalized=void 0;const t=requireRelativeToAbsoluteIri(),r=requireErrorCoded(),a=requireUtil();class o{constructor(s){this.contextRaw=s}getContextRaw(){return this.contextRaw}expandTerm(s,c,l=n.defaultExpandOptions){const d=this.contextRaw[s];if(d===null||d&&d["@id"]===null)return null;let f=!0;if(d&&c){const S=a.Util.getContextValueId(d);if(S&&S!==s)if(typeof S!="string"||!a.Util.isValidIri(S)&&!a.Util.isValidKeyword(S))a.Util.isPotentialKeyword(S)||(f=!1);else return S}const h=a.Util.getPrefix(s,this.contextRaw),v=this.contextRaw["@vocab"],g=(!!v||v==="")&&v.indexOf(":")<0,b=this.contextRaw["@base"],_=a.Util.isPotentialKeyword(s);if(h){const S=this.contextRaw[h],T=a.Util.getContextValueId(S);if(T){if(typeof S=="string"||!l.allowPrefixForcing){if(!a.Util.isSimpleTermDefinitionPrefix(T,l))return s}else if(T[0]!=="_"&&!_&&!S["@prefix"]&&!(s in this.contextRaw))return s;return T+s.substr(h.length+1)}}else if(c&&(v||v===""||l.allowVocabRelativeToBase&&b&&g)&&!_&&!a.Util.isCompactIri(s))if(g){if(l.allowVocabRelativeToBase)return(v||b?(0,t.resolve)(v,b):"")+s;throw new r.ErrorCoded(`Relative vocab expansion for term '${s}' with vocab '${v}' is not allowed.`,r.ERROR_CODES.INVALID_VOCAB_MAPPING)}else return v+s;else if(!c&&b&&!_&&!a.Util.isCompactIri(s))return(0,t.resolve)(s,b);if(f)return s;throw new r.ErrorCoded(`Invalid IRI mapping found for context entry '${s}': '${JSON.stringify(d)}'`,r.ERROR_CODES.INVALID_IRI_MAPPING)}compactIri(s,c){if(c&&this.contextRaw["@vocab"]&&s.startsWith(this.contextRaw["@vocab"]))return s.substr(this.contextRaw["@vocab"].length);if(!c&&this.contextRaw["@base"]&&s.startsWith(this.contextRaw["@base"]))return s.substr(this.contextRaw["@base"].length);const l={prefix:"",suffix:s};for(const d in this.contextRaw){const f=this.contextRaw[d];if(f&&!a.Util.isPotentialKeyword(d)){const h=a.Util.getContextValueId(f);if(s.startsWith(h)){const v=s.substr(h.length);if(v)v.length<l.suffix.length&&(l.prefix=d,l.suffix=v);else if(c)return d}}}return l.prefix?l.prefix+":"+l.suffix:s}}n.JsonLdContextNormalized=o,n.defaultExpandOptions={allowPrefixForcing:!0,allowPrefixNonGenDelims:!1,allowVocabRelativeToBase:!0}}(JsonLdContextNormalized)),JsonLdContextNormalized}var hasRequiredContextParser;function requireContextParser(){if(hasRequiredContextParser)return ContextParser;hasRequiredContextParser=1,Object.defineProperty(ContextParser,"__esModule",{value:!0}),ContextParser.ContextParser=void 0,requireBrowserPolyfill();const n=requireRelativeToAbsoluteIri(),t=requireErrorCoded(),r=requireFetchDocumentLoader(),a=requireJsonLdContextNormalized(),o=requireUtil();let u=class Lr{constructor(c){c=c||{},this.documentLoader=c.documentLoader||new r.FetchDocumentLoader,this.documentCache={},this.validateContext=!c.skipValidation,this.expandContentTypeToBase=!!c.expandContentTypeToBase,this.remoteContextsDepthLimit=c.remoteContextsDepthLimit||32,this.redirectSchemaOrgHttps="redirectSchemaOrgHttps"in c?!!c.redirectSchemaOrgHttps:!0}static validateLanguage(c,l,d){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@language' must be a string, got '${JSON.stringify(c)}'`,d);if(!o.Util.REGEX_LANGUAGE_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@language' must be a valid language tag, got '${JSON.stringify(c)}'`,d);return!1}return!0}static validateDirection(c,l){if(typeof c!="string")throw new t.ErrorCoded(`The value of an '@direction' must be a string, got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);if(!o.Util.REGEX_DIRECTION_TAG.test(c)){if(l)throw new t.ErrorCoded(`The value of an '@direction' must be 'ltr' or 'rtl', got '${JSON.stringify(c)}'`,t.ERROR_CODES.INVALID_BASE_DIRECTION);return!1}return!0}idifyReverseTerms(c){for(const l of Object.keys(c)){let d=c[l];if(d&&typeof d=="object"&&d["@reverse"]&&!d["@id"]){if(typeof d["@reverse"]!="string"||o.Util.isValidKeyword(d["@reverse"]))throw new t.ErrorCoded(`Invalid @reverse value, must be absolute IRI or blank node: '${d["@reverse"]}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);d=c[l]=Object.assign(Object.assign({},d),{"@id":d["@reverse"]}),d["@id"]=d["@reverse"],o.Util.isPotentialKeyword(d["@reverse"])?delete d["@reverse"]:d["@reverse"]=!0}}return c}expandPrefixedTerms(c,l,d){const f=c.getContextRaw();for(const h of d||Object.keys(f))if(o.Util.EXPAND_KEYS_BLACKLIST.indexOf(h)<0&&!o.Util.isReservedInternalKeyword(h)){const v=f[h];if(o.Util.isPotentialKeyword(h)&&o.Util.ALIAS_DOMAIN_BLACKLIST.indexOf(h)>=0&&(h!=="@type"||typeof f[h]=="object"&&!(f[h]["@protected"]||f[h]["@container"]==="@set")))throw new t.ErrorCoded(`Keywords can not be aliased to something else.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.KEYWORD_REDEFINITION);if(o.Util.ALIAS_RANGE_BLACKLIST.indexOf(o.Util.getContextValueId(v))>=0)throw new t.ErrorCoded(`Aliasing to certain keywords is not allowed.
Tried mapping ${h} to ${JSON.stringify(v)}`,t.ERROR_CODES.INVALID_KEYWORD_ALIAS);if(v&&o.Util.isPotentialKeyword(o.Util.getContextValueId(v))&&v["@prefix"]===!0)throw new t.ErrorCoded(`Tried to use keyword aliases as prefix: '${h}': '${JSON.stringify(v)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);for(;o.Util.isPrefixValue(f[h]);){const g=f[h];let b=!1;if(typeof g=="string")f[h]=c.expandTerm(g,!0),b=b||g!==f[h];else{const _=g["@id"],S=g["@type"],T=!("@prefix"in g)||o.Util.isValidIri(h);if("@id"in g)_!=null&&typeof _=="string"&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":c.expandTerm(_,!0)}),b=b||_!==f[h]["@id"]);else if(!o.Util.isPotentialKeyword(h)&&T){const w=c.expandTerm(h,!0);w!==h&&(f[h]=Object.assign(Object.assign({},f[h]),{"@id":w}),b=!0)}if(S&&typeof S=="string"&&S!=="@vocab"&&(!g["@container"]||!g["@container"]["@type"])&&T){let w=c.expandTerm(S,!0);l&&S===w&&(w=c.expandTerm(S,!1)),w!==S&&(b=!0,f[h]=Object.assign(Object.assign({},f[h]),{"@type":w}))}}if(!b)break}}}normalize(c,{processingMode:l,normalizeLanguageTags:d}){if(d||l===1)for(const f of Object.keys(c))if(f==="@language"&&typeof c[f]=="string")c[f]=c[f].toLowerCase();else{const h=c[f];if(h&&typeof h=="object"&&typeof h["@language"]=="string"){const v=h["@language"].toLowerCase();v!==h["@language"]&&(c[f]=Object.assign(Object.assign({},h),{"@language":v}))}}}containersToHash(c){for(const l of Object.keys(c)){const d=c[l];if(d&&typeof d=="object"){if(typeof d["@container"]=="string")c[l]=Object.assign(Object.assign({},d),{"@container":{[d["@container"]]:!0}});else if(Array.isArray(d["@container"])){const f={};for(const h of d["@container"])f[h]=!0;c[l]=Object.assign(Object.assign({},d),{"@container":f})}}}}applyScopedProtected(c,{processingMode:l},d){if(l&&l>=1.1&&c["@protected"]){for(const f of Object.keys(c))if(!o.Util.isReservedInternalKeyword(f)&&!o.Util.isPotentialKeyword(f)&&!o.Util.isTermProtected(c,f)){const h=c[f];h&&typeof h=="object"?"@protected"in c[f]||(c[f]=Object.assign(Object.assign({},c[f]),{"@protected":!0})):(c[f]={"@id":h,"@protected":!0},o.Util.isSimpleTermDefinitionPrefix(h,d)&&(c[f]=Object.assign(Object.assign({},c[f]),{"@prefix":!0})))}delete c["@protected"]}}validateKeywordRedefinitions(c,l,d,f){for(const h of f??Object.keys(l))if(o.Util.isTermProtected(c,h)&&(typeof l[h]=="string"?l[h]={"@id":l[h],"@protected":!0}:l[h]=Object.assign(Object.assign({},l[h]),{"@protected":!0}),!o.Util.deepEqual(c[h],l[h])))throw new t.ErrorCoded(`Attempted to override the protected keyword ${h} from ${JSON.stringify(o.Util.getContextValueId(c[h]))} to ${JSON.stringify(o.Util.getContextValueId(l[h]))}`,t.ERROR_CODES.PROTECTED_TERM_REDEFINITION)}validate(c,{processingMode:l}){for(const d of Object.keys(c)){if(o.Util.isReservedInternalKeyword(d))continue;if(d==="")throw new t.ErrorCoded(`The empty term is not allowed, got: '${d}': '${JSON.stringify(c[d])}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);const f=c[d],h=typeof f;if(o.Util.isPotentialKeyword(d)){switch(d.substr(1)){case"vocab":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @vocab IRI: ${f}`,t.ERROR_CODES.INVALID_VOCAB_MAPPING);break;case"base":if(f!==null&&h!=="string")throw new t.ErrorCoded(`Found an invalid @base IRI: ${c[d]}`,t.ERROR_CODES.INVALID_BASE_IRI);break;case"language":f!==null&&Lr.validateLanguage(f,!0,t.ERROR_CODES.INVALID_DEFAULT_LANGUAGE);break;case"version":if(f!==null&&h!=="number")throw new t.ErrorCoded(`Found an invalid @version number: ${f}`,t.ERROR_CODES.INVALID_VERSION_VALUE);break;case"direction":f!==null&&Lr.validateDirection(f,!0);break;case"propagate":if(l===1)throw new t.ErrorCoded(`Found an illegal @propagate keyword: ${f}`,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);if(f!==null&&h!=="boolean")throw new t.ErrorCoded(`Found an invalid @propagate value: ${f}`,t.ERROR_CODES.INVALID_PROPAGATE_VALUE);break}if(o.Util.isValidKeyword(d)&&o.Util.isValidKeyword(o.Util.getContextValueId(f)))throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${o.Util.getContextValueId(f)}'`,t.ERROR_CODES.KEYWORD_REDEFINITION);continue}if(f!==null)switch(h){case"string":if(o.Util.getPrefix(f,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(f==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(f)&&f!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${f}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}break;case"object":if(!o.Util.isCompactIri(d)&&!("@id"in f)&&(f["@type"]==="@id"?!c["@base"]:!c["@vocab"]))throw new t.ErrorCoded(`Missing @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);for(const v of Object.keys(f)){const g=f[v];if(g)switch(v){case"@id":if(o.Util.isValidKeyword(g)&&g!=="@type"&&g!=="@id"&&g!=="@graph"&&g!=="@nest")throw new t.ErrorCoded(`Illegal keyword alias in term value, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIriWeak(d)){if(g==="@type")throw new t.ErrorCoded(`IRIs can not be mapped to @type, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.isValidIri(g)&&g!==new a.JsonLdContextNormalized(c).expandTerm(d))throw new t.ErrorCoded(`IRIs can not be mapped to other IRIs, found: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING)}if(typeof g!="string")throw new t.ErrorCoded(`Detected non-string @id in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_IRI_MAPPING);if(o.Util.getPrefix(g,c)===d)throw new t.ErrorCoded(`Detected cyclical IRI mapping in context entry: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.CYCLIC_IRI_MAPPING);break;case"@type":if(f["@container"]==="@type"&&g!=="@id"&&g!=="@vocab")throw new t.ErrorCoded(`@container: @type only allows @type: @id or @vocab, but got: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(typeof g!="string")throw new t.ErrorCoded(`The value of an '@type' must be a string, got '${JSON.stringify(h)}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);if(g!=="@id"&&g!=="@vocab"&&(l===1||g!=="@json")&&(l===1||g!=="@none")&&(g[0]==="_"||!o.Util.isValidIri(g)))throw new t.ErrorCoded(`A context @type must be an absolute IRI, found: '${d}': '${g}'`,t.ERROR_CODES.INVALID_TYPE_MAPPING);break;case"@reverse":if(typeof g=="string"&&f["@id"]&&f["@id"]!==g)throw new t.ErrorCoded(`Found non-matching @id and @reverse term values in '${d}':'${g}' and '${f["@id"]}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if("@nest"in f)throw new t.ErrorCoded(`@nest is not allowed in the reverse property '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);break;case"@container":if(l===1&&(Object.keys(g).length>1||o.Util.CONTAINERS_1_0.indexOf(Object.keys(g)[0])<0))throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${Object.keys(g)}') in 1.0, must be only one of ${o.Util.CONTAINERS_1_0.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING);for(const b of Object.keys(g)){if(b==="@list"&&f["@reverse"])throw new t.ErrorCoded(`Term value can not be @container: @list and @reverse at the same time on '${d}'`,t.ERROR_CODES.INVALID_REVERSE_PROPERTY);if(o.Util.CONTAINERS.indexOf(b)<0)throw new t.ErrorCoded(`Invalid term @container for '${d}' ('${b}'), must be one of ${o.Util.CONTAINERS.join(", ")}`,t.ERROR_CODES.INVALID_CONTAINER_MAPPING)}break;case"@language":Lr.validateLanguage(g,!0,t.ERROR_CODES.INVALID_LANGUAGE_MAPPING);break;case"@direction":Lr.validateDirection(g,!0);break;case"@prefix":if(g!==null&&typeof g!="boolean")throw new t.ErrorCoded(`Found an invalid term @prefix boolean in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_PREFIX_VALUE);if(!("@id"in f)&&!o.Util.isValidIri(d))throw new t.ErrorCoded(`Invalid @prefix definition for '${d}' ('${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@index":if(l===1||!f["@container"]||!f["@container"]["@index"])throw new t.ErrorCoded(`Attempt to add illegal key to value object: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION);break;case"@nest":if(o.Util.isPotentialKeyword(g)&&g!=="@nest")throw new t.ErrorCoded(`Found an invalid term @nest value in: '${d}': '${JSON.stringify(f)}'`,t.ERROR_CODES.INVALID_NEST_VALUE)}}break;default:throw new t.ErrorCoded(`Found an invalid term value: '${d}': '${f}'`,t.ERROR_CODES.INVALID_TERM_DEFINITION)}}}applyBaseEntry(c,l,d){return typeof c=="string"||(d&&!("@base"in c)&&l.parentContext&&typeof l.parentContext=="object"&&"@base"in l.parentContext&&(c["@base"]=l.parentContext["@base"],l.parentContext["@__baseDocument"]&&(c["@__baseDocument"]=!0)),l.baseIRI&&!l.external&&("@base"in c?c["@base"]!==null&&typeof c["@base"]=="string"&&!o.Util.isValidIri(c["@base"])&&(c["@base"]=(0,n.resolve)(c["@base"],l.parentContext&&l.parentContext["@base"]||l.baseIRI)):(c["@base"]=l.baseIRI,c["@__baseDocument"]=!0))),c}normalizeContextIri(c,l){if(!o.Util.isValidIri(c))try{c=(0,n.resolve)(c,l)}catch{throw new Error(`Invalid context IRI: ${c}`)}return this.redirectSchemaOrgHttps&&c.startsWith("http://schema.org")&&(c="https://schema.org/"),c}async parseInnerContexts(c,l,d){for(const f of d??Object.keys(c)){const h=c[f];if(h&&typeof h=="object"&&"@context"in h&&h["@context"]!==null&&!l.ignoreScopedContexts){if(this.validateContext)try{const v=Object.assign(Object.assign({},c),{[f]:Object.assign({},c[f])});delete v[f]["@context"],await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,parentContext:v,ignoreProtection:!0,ignoreRemoteScopedContexts:!0,ignoreScopedContexts:!0}))}catch(v){throw new t.ErrorCoded(v.message,t.ERROR_CODES.INVALID_SCOPED_CONTEXT)}c[f]=Object.assign(Object.assign({},h),{"@context":(await this.parse(h["@context"],Object.assign(Object.assign({},l),{external:!1,minimalProcessing:!0,ignoreRemoteScopedContexts:!0,parentContext:c}))).getContextRaw()})}}return c}async parse(c,l={},d={}){const{baseIRI:f,parentContext:h,external:v,processingMode:g=Lr.DEFAULT_PROCESSING_MODE,normalizeLanguageTags:b,ignoreProtection:_,minimalProcessing:S}=l,T=l.remoteContexts||{};if(Object.keys(T).length>=this.remoteContextsDepthLimit)throw new t.ErrorCoded("Detected an overflow in remote context inclusions: "+Object.keys(T),t.ERROR_CODES.CONTEXT_OVERFLOW);if(c==null){if(!_&&h&&o.Util.hasProtectedTerms(h))throw new t.ErrorCoded("Illegal context nullification when terms are protected",t.ERROR_CODES.INVALID_CONTEXT_NULLIFICATION);return new a.JsonLdContextNormalized(this.applyBaseEntry({},l,!1))}else if(typeof c=="string"){const w=this.normalizeContextIri(c,f),A=this.getOverriddenLoad(w,l);if(A)return new a.JsonLdContextNormalized(A);const R=await this.parse(await this.load(w),Object.assign(Object.assign({},l),{baseIRI:w,external:!0,remoteContexts:Object.assign(Object.assign({},T),{[w]:!0})}));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(Array.isArray(c)){const w=[],A=await Promise.all(c.map((E,I)=>{if(typeof E=="string"){const L=this.normalizeContextIri(E,f);w[I]=L;const F=this.getOverriddenLoad(L,l);return F||this.load(L)}else return E}));if(S)return new a.JsonLdContextNormalized(A);const R=await A.reduce((E,I,L)=>E.then(F=>this.parse(I,Object.assign(Object.assign({},l),{baseIRI:w[L]||l.baseIRI,external:!!w[L]||l.external,parentContext:F.getContextRaw(),remoteContexts:w[L]?Object.assign(Object.assign({},T),{[w[L]]:!0}):T}),{skipValidation:L<A.length-1})),Promise.resolve(new a.JsonLdContextNormalized(h||{})));return this.applyBaseEntry(R.getContextRaw(),l,!0),R}else if(typeof c=="object"){if("@context"in c)return await this.parse(c["@context"],l);if(c=Object.assign({},c),v&&delete c["@base"],this.applyBaseEntry(c,l,!0),this.containersToHash(c),S)return new a.JsonLdContextNormalized(c);let w={};if("@import"in c)if(g>=1.1){if(typeof c["@import"]!="string")throw new t.ErrorCoded("An @import value must be a string, but got "+typeof c["@import"],t.ERROR_CODES.INVALID_IMPORT_VALUE);w=await this.loadImportContext(this.normalizeContextIri(c["@import"],f)),delete c["@import"]}else throw new t.ErrorCoded("Context importing is not supported in JSON-LD 1.0",t.ERROR_CODES.INVALID_CONTEXT_ENTRY);this.applyScopedProtected(w,{processingMode:g},a.defaultExpandOptions);const A=Object.assign(w,c);this.idifyReverseTerms(A),this.normalize(A,{processingMode:g,normalizeLanguageTags:b}),this.applyScopedProtected(A,{processingMode:g},a.defaultExpandOptions);const R=Object.keys(A),E=[];if(typeof h=="object")for(const L in h)L in A?E.push(L):A[L]=h[L];await this.parseInnerContexts(A,l,R);const I=new a.JsonLdContextNormalized(A);return(A&&A["@version"]||Lr.DEFAULT_PROCESSING_MODE)>=1.1&&(c["@vocab"]&&typeof c["@vocab"]=="string"||c["@vocab"]==="")&&(h&&"@vocab"in h&&c["@vocab"].indexOf(":")<0?A["@vocab"]=h["@vocab"]+c["@vocab"]:(o.Util.isCompactIri(c["@vocab"])||c["@vocab"]in A)&&(A["@vocab"]=I.expandTerm(c["@vocab"],!0))),this.expandPrefixedTerms(I,this.expandContentTypeToBase,R),!_&&h&&g>=1.1&&this.validateKeywordRedefinitions(h,A,a.defaultExpandOptions,E),this.validateContext&&!d.skipValidation&&this.validate(A,{processingMode:g}),I}else throw new t.ErrorCoded(`Tried parsing a context that is not a string, array or object, but got ${c}`,t.ERROR_CODES.INVALID_LOCAL_CONTEXT)}async load(c){const l=this.documentCache[c];if(l)return l;let d;try{d=await this.documentLoader.load(c)}catch(f){throw new t.ErrorCoded(`Failed to load remote context ${c}: ${f.message}`,t.ERROR_CODES.LOADING_REMOTE_CONTEXT_FAILED)}if(!("@context"in d))throw new t.ErrorCoded(`Missing @context in remote context at ${c}`,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);return this.documentCache[c]=d["@context"]}getOverriddenLoad(c,l){if(c in(l.remoteContexts||{})){if(l.ignoreRemoteScopedContexts)return c;throw new t.ErrorCoded("Detected a cyclic context inclusion of "+c,t.ERROR_CODES.RECURSIVE_CONTEXT_INCLUSION)}return null}async loadImportContext(c){let l=await this.load(c);if(typeof l!="object"||Array.isArray(l))throw new t.ErrorCoded("An imported context must be a single object: "+c,t.ERROR_CODES.INVALID_REMOTE_CONTEXT);if("@import"in l)throw new t.ErrorCoded("An imported context can not import another context: "+c,t.ERROR_CODES.INVALID_CONTEXT_ENTRY);return l=Object.assign({},l),this.containersToHash(l),l}};return u.DEFAULT_PROCESSING_MODE=1.1,ContextParser.ContextParser=u,ContextParser}var IDocumentLoader={},hasRequiredIDocumentLoader;function requireIDocumentLoader(){return hasRequiredIDocumentLoader||(hasRequiredIDocumentLoader=1,Object.defineProperty(IDocumentLoader,"__esModule",{value:!0})),IDocumentLoader}var JsonLdContext={},hasRequiredJsonLdContext;function requireJsonLdContext(){return hasRequiredJsonLdContext||(hasRequiredJsonLdContext=1,Object.defineProperty(JsonLdContext,"__esModule",{value:!0})),JsonLdContext}var hasRequiredJsonldContextParser;function requireJsonldContextParser(){return hasRequiredJsonldContextParser||(hasRequiredJsonldContextParser=1,function(n){var t=jsonldContextParser&&jsonldContextParser.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=jsonldContextParser&&jsonldContextParser.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireContextParser(),n),r(requireErrorCoded(),n),r(requireFetchDocumentLoader(),n),r(requireIDocumentLoader(),n),r(requireJsonLdContext(),n),r(requireJsonLdContextNormalized(),n),r(requireUtil(),n)}(jsonldContextParser)),jsonldContextParser}var hasRequiredDocumentLoaderMediated;function requireDocumentLoaderMediated(){if(hasRequiredDocumentLoaderMediated)return DocumentLoaderMediated;hasRequiredDocumentLoaderMediated=1,Object.defineProperty(DocumentLoaderMediated,"__esModule",{value:!0}),DocumentLoaderMediated.DocumentLoaderMediated=void 0;const n=requireLib$1O(),t=requireDist$3(),r=requireJsonldContextParser();let a=class da extends r.FetchDocumentLoader{constructor(u,s){super(da.createFetcher(u,s)),this.mediatorHttp=u,this.context=s}static createFetcher(u,s){return async(c,l)=>{const d=await u.mediate({input:c,init:l,context:s});return d.json=async()=>JSON.parse(await(0,t.stringify)(n.ActorHttp.toNodeReadable(d.body))),d}}};return DocumentLoaderMediated.DocumentLoaderMediated=a,DocumentLoaderMediated}var hasRequiredActorRdfParseJsonLd;function requireActorRdfParseJsonLd(){if(hasRequiredActorRdfParseJsonLd)return ActorRdfParseJsonLd;hasRequiredActorRdfParseJsonLd=1,Object.defineProperty(ActorRdfParseJsonLd,"__esModule",{value:!0}),ActorRdfParseJsonLd.ActorRdfParseJsonLd=void 0;const n=requireLib$3s(),t=requireLib$4q(),r=requireLib$4s(),a=requireJsonldStreamingParser(),o=requireDocumentLoaderMediated();let u=class extends n.ActorRdfParseFixedMediaTypes{constructor(c){super(c)}async testHandle(c,l,d){return d.has(t.KeysRdfParseHtmlScript.processingHtmlScript)&&l!=="application/ld+json"?(0,r.failTest)("JSON-LD in script tags can only have media type 'application/ld+json'"):!l||!(l in this.mediaTypePriorities||l.endsWith("+json"))?(0,r.failTest)(`Unrecognized media type: ${l}`):await this.testHandleChecked(c)}async runHandle(c,l,d){var g;const f=c.context.getSafe(t.KeysInitQuery.dataFactory);return{data:a.JsonLdParser.fromHttpResponse(((g=c.metadata)==null?void 0:g.baseIRI)??"",l,c.headers,{dataFactory:f,documentLoader:d.get(t.KeysRdfParseJsonLd.documentLoader)??new o.DocumentLoaderMediated(this.mediatorHttp,d),strictValues:d.get(t.KeysRdfParseJsonLd.strictValues),...d.get(t.KeysRdfParseJsonLd.parserOptions)}).import(c.data)}}};return ActorRdfParseJsonLd.ActorRdfParseJsonLd=u,ActorRdfParseJsonLd}var hasRequiredLib$1d;function requireLib$1d(){return hasRequiredLib$1d||(hasRequiredLib$1d=1,function(n){var t=lib$1d&&lib$1d.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1d&&lib$1d.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfParseJsonLd(),n),r(requireDocumentLoaderMediated(),n)}(lib$1d)),lib$1d}var lib$1c={},ActorRdfUpdateHypermediaPatchSparqlUpdate={},lib$1b={},ActorRdfUpdateHypermedia={},hasRequiredActorRdfUpdateHypermedia;function requireActorRdfUpdateHypermedia(){if(hasRequiredActorRdfUpdateHypermedia)return ActorRdfUpdateHypermedia;hasRequiredActorRdfUpdateHypermedia=1,Object.defineProperty(ActorRdfUpdateHypermedia,"__esModule",{value:!0}),ActorRdfUpdateHypermedia.ActorRdfUpdateHypermedia=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a,o){super(a),this.destinationType=o}async test(a){return a.forceDestinationType&&this.destinationType!==a.forceDestinationType?(0,n.failTest)(`Actor ${this.name} is not able to handle destination type ${a.forceDestinationType}.`):this.testMetadata(a)}};return ActorRdfUpdateHypermedia.ActorRdfUpdateHypermedia=t,ActorRdfUpdateHypermedia}var hasRequiredLib$1c;function requireLib$1c(){return hasRequiredLib$1c||(hasRequiredLib$1c=1,function(n){var t=lib$1b&&lib$1b.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1b&&lib$1b.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateHypermedia(),n)}(lib$1b)),lib$1b}var QuadDestinationPatchSparqlUpdate={},hasRequiredQuadDestinationPatchSparqlUpdate;function requireQuadDestinationPatchSparqlUpdate(){if(hasRequiredQuadDestinationPatchSparqlUpdate)return QuadDestinationPatchSparqlUpdate;hasRequiredQuadDestinationPatchSparqlUpdate=1,Object.defineProperty(QuadDestinationPatchSparqlUpdate,"__esModule",{value:!0}),QuadDestinationPatchSparqlUpdate.QuadDestinationPatchSparqlUpdate=void 0;const n=requireLib$1O(),t=requireAsynciterator(),r=requireRdfStringTtl(),a=requireBrowser();let o=class{constructor(s,c,l){this.url=s,this.context=c,this.mediatorHttp=l}async update(s){const c=this.createCombinedQuadsQuery(s.insert,s.delete);await this.wrapSparqlUpdateRequest(c)}createCombinedQuadsQuery(s,c){return new t.ArrayIterator([],{autoStart:!1}).append(this.createQuadsQuery("DELETE",c)).append(c&&s?[` ;
`]:[]).append(this.createQuadsQuery("INSERT",s))}createQuadsQuery(s,c){return c?c.map(l=>{let d=`${(0,r.termToString)(l.subject)} ${(0,r.termToString)(l.predicate)} ${(0,r.termToString)(l.object)} .`;return l.graph.termType==="DefaultGraph"?d=`  ${d}
`:d=`  GRAPH ${(0,r.termToString)(l.graph)} { ${d} }
`,d}).prepend([`${s} DATA {
`]).append(["}"]):new t.ArrayIterator([],{autoStart:!1})}async wrapSparqlUpdateRequest(s){const c=new a.Readable;c.wrap(s);const l=new Headers({"content-type":"application/sparql-update"}),d=await this.mediatorHttp.mediate({context:this.context,init:{headers:l,method:"PATCH",body:n.ActorHttp.toWebReadableStream(c)},input:this.url});await(0,n.validateAndCloseHttpResponse)(this.url,d)}async deleteGraphs(s,c,l){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}async createGraphs(s,c){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}};return QuadDestinationPatchSparqlUpdate.QuadDestinationPatchSparqlUpdate=o,QuadDestinationPatchSparqlUpdate}var hasRequiredActorRdfUpdateHypermediaPatchSparqlUpdate;function requireActorRdfUpdateHypermediaPatchSparqlUpdate(){if(hasRequiredActorRdfUpdateHypermediaPatchSparqlUpdate)return ActorRdfUpdateHypermediaPatchSparqlUpdate;hasRequiredActorRdfUpdateHypermediaPatchSparqlUpdate=1,Object.defineProperty(ActorRdfUpdateHypermediaPatchSparqlUpdate,"__esModule",{value:!0}),ActorRdfUpdateHypermediaPatchSparqlUpdate.ActorRdfUpdateHypermediaPatchSparqlUpdate=void 0;const n=requireLib$1c(),t=requireLib$4s(),r=requireQuadDestinationPatchSparqlUpdate();let a=class extends n.ActorRdfUpdateHypermedia{constructor(u){super(u,"patchSparqlUpdate")}async testMetadata(u){return!u.forceDestinationType&&!u.metadata.patchSparqlUpdate?(0,t.failTest)(`Actor ${this.name} could not detect a destination with 'application/sparql-update' as 'Accept-Patch' header.`):!u.forceDestinationType&&!u.exists?(0,t.failTest)(`Actor ${this.name} can only patch a destination that already exists.`):(0,t.passTestVoid)()}async run(u){return this.logInfo(u.context,`Identified as patchSparqlUpdate destination: ${u.url}`),{destination:new r.QuadDestinationPatchSparqlUpdate(u.url,u.context,this.mediatorHttp)}}};return ActorRdfUpdateHypermediaPatchSparqlUpdate.ActorRdfUpdateHypermediaPatchSparqlUpdate=a,ActorRdfUpdateHypermediaPatchSparqlUpdate}var hasRequiredLib$1b;function requireLib$1b(){return hasRequiredLib$1b||(hasRequiredLib$1b=1,function(n){var t=lib$1c&&lib$1c.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1c&&lib$1c.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateHypermediaPatchSparqlUpdate(),n),r(requireQuadDestinationPatchSparqlUpdate(),n)}(lib$1c)),lib$1c}var lib$1a={},ActorRdfUpdateHypermediaPutLdp={},QuadDestinationPutLdp={},hasRequiredQuadDestinationPutLdp;function requireQuadDestinationPutLdp(){if(hasRequiredQuadDestinationPutLdp)return QuadDestinationPutLdp;hasRequiredQuadDestinationPutLdp=1,Object.defineProperty(QuadDestinationPutLdp,"__esModule",{value:!0}),QuadDestinationPutLdp.QuadDestinationPutLdp=void 0;const n=requireLib$1O();let t=class{constructor(a,o,u,s,c,l){this.url=a,this.context=o,this.mediaTypes=u,this.mediatorHttp=s,this.mediatorRdfSerializeMediatypes=c,this.mediatorRdfSerialize=l}async update(a){if(a.delete)throw new Error("Put-based LDP destinations don't support deletions");a.insert&&await this.wrapRdfUpdateRequest("INSERT",a.insert)}async wrapRdfUpdateRequest(a,o){const{mediaTypes:u}=await this.mediatorRdfSerializeMediatypes.mediate({context:this.context,mediaTypes:!0}),s=this.mediaTypes.filter(h=>h in u),c=s.length>0?s[0]:Object.keys(u).sort((h,v)=>u[v]-u[h])[0],{handle:{data:l}}=await this.mediatorRdfSerialize.mediate({context:this.context,handle:{quadStream:o,context:this.context},handleMediaType:c}),d=new Headers({"content-type":c}),f=await this.mediatorHttp.mediate({context:this.context,init:{headers:d,method:"PUT",body:n.ActorHttp.toWebReadableStream(l)},input:this.url});await(0,n.validateAndCloseHttpResponse)(this.url,f)}async deleteGraphs(a,o,u){throw new Error("Put-based LDP destinations don't support named graphs")}async createGraphs(a,o){throw new Error("Put-based LDP destinations don't support named graphs")}};return QuadDestinationPutLdp.QuadDestinationPutLdp=t,QuadDestinationPutLdp}var hasRequiredActorRdfUpdateHypermediaPutLdp;function requireActorRdfUpdateHypermediaPutLdp(){if(hasRequiredActorRdfUpdateHypermediaPutLdp)return ActorRdfUpdateHypermediaPutLdp;hasRequiredActorRdfUpdateHypermediaPutLdp=1,Object.defineProperty(ActorRdfUpdateHypermediaPutLdp,"__esModule",{value:!0}),ActorRdfUpdateHypermediaPutLdp.ActorRdfUpdateHypermediaPutLdp=void 0;const n=requireLib$1c(),t=requireLib$4s(),r=requireQuadDestinationPutLdp();let a=class extends n.ActorRdfUpdateHypermedia{constructor(u){super(u,"putLdp")}async testMetadata(u){if(!u.forceDestinationType){if(!u.metadata.allowHttpMethods||!u.metadata.allowHttpMethods.includes("PUT"))return(0,t.failTest)(`Actor ${this.name} could not detect a destination with 'Allow: PUT' header.`);if(u.exists)return(0,t.failTest)(`Actor ${this.name} can only put on a destination that does not already exists.`)}return(0,t.passTestVoid)()}async run(u){return this.logInfo(u.context,`Identified as putLdp destination: ${u.url}`),{destination:new r.QuadDestinationPutLdp(u.url,u.context,u.metadata.putAccepted||[],this.mediatorHttp,this.mediatorRdfSerializeMediatypes,this.mediatorRdfSerialize)}}};return ActorRdfUpdateHypermediaPutLdp.ActorRdfUpdateHypermediaPutLdp=a,ActorRdfUpdateHypermediaPutLdp}var hasRequiredLib$1a;function requireLib$1a(){return hasRequiredLib$1a||(hasRequiredLib$1a=1,function(n){var t=lib$1a&&lib$1a.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1a&&lib$1a.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateHypermediaPutLdp(),n),r(requireQuadDestinationPutLdp(),n)}(lib$1a)),lib$1a}var lib$19={},ActorRdfUpdateHypermediaSparql={},QuadDestinationSparql={},fetchSparqlEndpoint={},SparqlEndpointFetcher={},sparqlxmlParse={},SparqlXmlParser={},hasRequiredSparqlXmlParser;function requireSparqlXmlParser(){if(hasRequiredSparqlXmlParser)return SparqlXmlParser;hasRequiredSparqlXmlParser=1,Object.defineProperty(SparqlXmlParser,"__esModule",{value:!0}),SparqlXmlParser.SparqlXmlParser=void 0;const n=requireRdfDataFactory(),t=requireSaxes(),r=requireBrowser();let a=class{constructor(u){u=u||{},this.dataFactory=u.dataFactory||new n.DataFactory,this.prefixVariableQuestionMark=!!u.prefixVariableQuestionMark}parseXmlResultsStream(u){const s=A=>w.emit("error",A);u.on("error",s);const c=new t.SaxesParser,l=[];let d=!1,f=!1;const h=[];let v={},g="",b="",_,S="",T=[];c.on("error",s),c.on("opentag",A=>{A.name==="variable"&&this.stackEquals(l,["sparql","head"])?h.push(this.dataFactory.variable(A.attributes.name)):A.name==="results"&&this.stackEquals(l,["sparql"])?f=!0:A.name==="result"&&this.stackEquals(l,["sparql","results"])?v={}:A.name==="binding"&&this.stackEquals(l,["sparql","results","result"])?(g=A.attributes.name||"",b="",_="",S="",T=[]):A.name==="triple"&&this.stackBeginsWith(l,["sparql","results","result"])?T.push({components:{}}):l[l.length-1]==="triple"&&this.stackBeginsWith(l,["sparql","results","result","binding"])?(b="",_="",S="",["subject","predicate","object"].includes(A.name)?T[T.length-1].currentComponent=A.name:s(new Error(`Illegal quoted triple component '${A.name}' found on line ${c.line+1}`))):this.stackBeginsWith(l,["sparql","results","result","binding"])&&(b=A.name,"xml:lang"in A.attributes?_=A.attributes["xml:lang"]:"datatype"in A.attributes?_=this.dataFactory.namedNode(A.attributes.datatype):_=void 0),l.push(A.name)}),c.on("closetag",A=>{if(this.stackEquals(l,["sparql","head"])&&(w.emit("variables",h),d=!0),this.stackEquals(l,["sparql","results","result"])&&w.push(v),this.stackBeginsWith(l,["sparql","results","result","binding"])){let R;if(!g&&b)s(new Error(`Terms should have a name on line ${c.line+1}`));else if(b==="uri")R=this.dataFactory.namedNode(S);else if(b==="bnode")R=this.dataFactory.blankNode(S);else if(b==="literal")R=this.dataFactory.literal(S,_);else if(l[l.length-1]==="triple"){const E=T.pop();E&&E.components.subject&&E.components.predicate&&E.components.object?R=this.dataFactory.quad(E.components.subject,E.components.predicate,E.components.object):s(new Error(`Incomplete quoted triple on line ${c.line+1}`))}else b&&s(new Error(`Invalid term type '${b}' on line ${c.line+1}`));if(R)if(T.length>0){const E=T[T.length-1];E.components[E.currentComponent]&&s(new Error(`The ${E.currentComponent} in a quoted triple on line ${c.line+1} was already defined before`)),E.components[E.currentComponent]=R}else{const E=this.prefixVariableQuestionMark?"?"+g:g;v[E]=R}b=void 0}l.pop()}),c.on("text",A=>{this.stackBeginsWith(l,["sparql","results","result","binding"])&&l[l.length-1]===b&&(S=A)});const w=u.on("end",A=>{f?d||w.emit("variables",[]):w.emit("error",new Error("No valid SPARQL query results were found."))}).pipe(new r.Transform({objectMode:!0,transform(A,R,E){c.write(A),E()}}));return w}parseXmlBooleanStream(u){return new Promise((s,c)=>{const l=new t.SaxesParser,d=[];l.on("error",c),l.on("opentag",f=>{d.push(f.name)}),l.on("closetag",f=>{d.pop()}),l.on("text",f=>{this.stackEquals(d,["sparql","boolean"])&&s(f==="true")}),u.on("error",c).on("data",f=>l.write(f)).on("end",()=>c(new Error("No valid ASK response was found.")))})}stackEquals(u,s){return u.length===s.length&&u.every((c,l)=>s[l]===c)}stackBeginsWith(u,s){return u.length>=s.length&&s.every((c,l)=>u[l]===c)}};return SparqlXmlParser.SparqlXmlParser=a,SparqlXmlParser}var hasRequiredSparqlxmlParse;function requireSparqlxmlParse(){return hasRequiredSparqlxmlParse||(hasRequiredSparqlxmlParse=1,function(n){var t=sparqlxmlParse&&sparqlxmlParse.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=sparqlxmlParse&&sparqlxmlParse.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireSparqlXmlParser(),n)}(sparqlxmlParse)),sparqlxmlParse}var _Promise={exports:{}},hasRequired_Promise;function require_Promise(){return hasRequired_Promise||(hasRequired_Promise=1,function(n){(function(){var t;typeof window=="object"&&window?t=window:t=commonjsGlobal$1,n.exports?n.exports=t.Promise?t.Promise:u:t.Promise||(t.Promise=u);var r=t.setImmediate||function(v){setTimeout(v,1)};function a(v,g){return function(){v.apply(g,arguments)}}var o=Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"};function u(v){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof v!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],h(v,a(c,this),a(l,this))}function s(v){var g=this;if(this._state===null){this._deferreds.push(v);return}r(function(){var b=g._state?v.onFulfilled:v.onRejected;if(b===null){(g._state?v.resolve:v.reject)(g._value);return}var _;try{_=b(g._value)}catch(S){v.reject(S);return}v.resolve(_)})}function c(v){try{if(v===this)throw new TypeError("A promise cannot be resolved with itself.");if(v&&(typeof v=="object"||typeof v=="function")){var g=v.then;if(typeof g=="function"){h(a(g,v),a(c,this),a(l,this));return}}this._state=!0,this._value=v,d.call(this)}catch(b){l.call(this,b)}}function l(v){this._state=!1,this._value=v,d.call(this)}function d(){for(var v=0,g=this._deferreds.length;v<g;v++)s.call(this,this._deferreds[v]);this._deferreds=null}function f(v,g,b,_){this.onFulfilled=typeof v=="function"?v:null,this.onRejected=typeof g=="function"?g:null,this.resolve=b,this.reject=_}function h(v,g,b){var _=!1;try{v(function(S){_||(_=!0,g(S))},function(S){_||(_=!0,b(S))})}catch(S){if(_)return;_=!0,b(S)}}u.prototype.catch=function(v){return this.then(null,v)},u.prototype.then=function(v,g){var b=this;return new u(function(_,S){s.call(b,new f(v,g,_,S))})},u.all=function(){var v=Array.prototype.slice.call(arguments.length===1&&o(arguments[0])?arguments[0]:arguments);return new u(function(g,b){if(v.length===0)return g([]);var _=v.length;function S(w,A){try{if(A&&(typeof A=="object"||typeof A=="function")){var R=A.then;if(typeof R=="function"){R.call(A,function(E){S(w,E)},b);return}}v[w]=A,--_===0&&g(v)}catch(E){b(E)}}for(var T=0;T<v.length;T++)S(T,v[T])})},u.resolve=function(v){return v&&typeof v=="object"&&v.constructor===u?v:new u(function(g){g(v)})},u.reject=function(v){return new u(function(g,b){b(v)})},u.race=function(v){return new u(function(g,b){for(var _=0,S=v.length;_<S;_++)v[_].then(g,b)})}})()}(_Promise)),_Promise.exports}var streamToString,hasRequiredStreamToString;function requireStreamToString(){if(hasRequiredStreamToString)return streamToString;hasRequiredStreamToString=1;var n=require_Promise();return streamToString=function(t,r,a){typeof r=="function"&&(a=r,r=null);var o="",u=new n(function(s,c){t.on("data",function(l){o+=typeof r=="string"?l.toString(r):l.toString()}),t.on("end",function(){s(o)}),t.on("error",c)});return a&&u.then(function(s){a(null,s)},a),u},streamToString}var hasRequiredSparqlEndpointFetcher;function requireSparqlEndpointFetcher(){if(hasRequiredSparqlEndpointFetcher)return SparqlEndpointFetcher;hasRequiredSparqlEndpointFetcher=1;var n=SparqlEndpointFetcher&&SparqlEndpointFetcher.__awaiter||function(d,f,h,v){function g(b){return b instanceof h?b:new h(function(_){_(b)})}return new(h||(h=Promise))(function(b,_){function S(A){try{w(v.next(A))}catch(R){_(R)}}function T(A){try{w(v.throw(A))}catch(R){_(R)}}function w(A){A.done?b(A.value):g(A.value).then(S,T)}w((v=v.apply(d,f||[])).next())})};Object.defineProperty(SparqlEndpointFetcher,"__esModule",{value:!0}),SparqlEndpointFetcher.SparqlEndpointFetcher=void 0;const t=requireIsStream(),r=require$$0,a=requireLib$1P(),o=requireSparql$1(),u=requireSparqljsonParse(),s=requireSparqlxmlParse(),c=requireStreamToString();let l=class Qr{constructor(f){var h,v,g;this.method=(h=f==null?void 0:f.method)!==null&&h!==void 0?h:"POST",this.timeout=f==null?void 0:f.timeout,this.additionalUrlParams=(v=f==null?void 0:f.additionalUrlParams)!==null&&v!==void 0?v:new URLSearchParams,this.defaultHeaders=(g=f==null?void 0:f.defaultHeaders)!==null&&g!==void 0?g:new Headers,this.fetchCb=f==null?void 0:f.fetch,this.sparqlJsonParser=new u.SparqlJsonParser(f),this.sparqlXmlParser=new s.SparqlXmlParser(f),this.sparqlParsers={[Qr.CONTENTTYPE_SPARQL_JSON]:{parseBooleanStream:b=>this.sparqlJsonParser.parseJsonBooleanStream(b),parseResultsStream:b=>this.sparqlJsonParser.parseJsonResultsStream(b)},[Qr.CONTENTTYPE_SPARQL_XML]:{parseBooleanStream:b=>this.sparqlXmlParser.parseXmlBooleanStream(b),parseResultsStream:b=>this.sparqlXmlParser.parseXmlResultsStream(b)}}}getQueryType(f){const h=new o.Parser({sparqlStar:!0}).parse(f);return h.type==="query"?h.queryType==="DESCRIBE"?"CONSTRUCT":h.queryType:"UNKNOWN"}getUpdateTypes(f){const h=new o.Parser({sparqlStar:!0}).parse(f);if(h.type==="update"){const v={};for(const g of h.updates)"type"in g?v[g.type]=!0:v[g.updateType]=!0;return v}return"UNKNOWN"}fetchBindings(f,h){return n(this,void 0,void 0,function*(){const[v,g]=yield this.fetchRawStream(f,h,Qr.CONTENTTYPE_SPARQL),b=this.sparqlParsers[v];if(!b)throw new Error(`Unknown SPARQL results content type: ${v}`);return b.parseResultsStream(g)})}fetchAsk(f,h){return n(this,void 0,void 0,function*(){const[v,g]=yield this.fetchRawStream(f,h,Qr.CONTENTTYPE_SPARQL),b=this.sparqlParsers[v];if(!b)throw new Error(`Unknown SPARQL results content type: ${v}`);return b.parseBooleanStream(g)})}fetchTriples(f,h){return n(this,void 0,void 0,function*(){const[v,g]=yield this.fetchRawStream(f,h,Qr.CONTENTTYPE_TURTLE);return g.pipe(new r.StreamParser({format:v}))})}fetchUpdate(f,h){return n(this,void 0,void 0,function*(){const v=new AbortController,g={};this.defaultHeaders.forEach((_,S)=>{g[S]=_});const b={method:"POST",headers:Object.assign(Object.assign({},g),{"content-type":"application/sparql-update"}),body:h,signal:v.signal};yield this.handleFetchCall(f,b,{ignoreBody:!0}),v.abort()})}fetchRawStream(f,h,v){return n(this,void 0,void 0,function*(){let g=this.method==="POST"?f:`${f}?query=${encodeURIComponent(h)}`,b;const _=new Headers(this.defaultHeaders);if(_.append("Accept",v),this.method==="POST"){_.append("Content-Type","application/x-www-form-urlencoded"),b=new URLSearchParams,b.set("query",h);for(const[S,T]of this.additionalUrlParams.entries())b.set(S,T);_.append("Content-Length",b.toString().length.toString())}else this.additionalUrlParams.toString().length>0&&(g+=`&${this.additionalUrlParams.toString()}`);return this.handleFetchCall(g,{headers:_,method:this.method,body:b})})}handleFetchCall(f,h,v){return n(this,void 0,void 0,function*(){var g,b,_;let S,T;if(this.timeout){const R=new AbortController;h.signal=R.signal,S=setTimeout(()=>R.abort(),this.timeout)}const w=yield((g=this.fetchCb)!==null&&g!==void 0?g:fetch)(f,h);if(clearTimeout(S),!(v!=null&&v.ignoreBody)&&w.body&&(T=t(w.body)?w.body:(0,a.readableFromWeb)(w.body)),!w.ok||!T&&!(v!=null&&v.ignoreBody)){const R=f.split("?").at(0),E=T?yield c(T):"empty response";throw new Error(`Invalid SPARQL endpoint response from ${R} (HTTP status ${w.status}):
${E}`)}return[(_=(b=w.headers.get("Content-Type"))===null||b===void 0?void 0:b.split(";").at(0))!==null&&_!==void 0?_:"",T]})}};return SparqlEndpointFetcher.SparqlEndpointFetcher=l,l.CONTENTTYPE_SPARQL_JSON="application/sparql-results+json",l.CONTENTTYPE_SPARQL_XML="application/sparql-results+xml",l.CONTENTTYPE_TURTLE="text/turtle",l.CONTENTTYPE_SPARQL=`${l.CONTENTTYPE_SPARQL_JSON};q=1.0,${l.CONTENTTYPE_SPARQL_XML};q=0.7`,SparqlEndpointFetcher}var hasRequiredFetchSparqlEndpoint;function requireFetchSparqlEndpoint(){return hasRequiredFetchSparqlEndpoint||(hasRequiredFetchSparqlEndpoint=1,function(n){var t=fetchSparqlEndpoint&&fetchSparqlEndpoint.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=fetchSparqlEndpoint&&fetchSparqlEndpoint.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireSparqlEndpointFetcher(),n)}(fetchSparqlEndpoint)),fetchSparqlEndpoint}var hasRequiredQuadDestinationSparql;function requireQuadDestinationSparql(){if(hasRequiredQuadDestinationSparql)return QuadDestinationSparql;hasRequiredQuadDestinationSparql=1,Object.defineProperty(QuadDestinationSparql,"__esModule",{value:!0}),QuadDestinationSparql.QuadDestinationSparql=void 0;const n=requireDist$3(),t=requireAsynciterator(),r=requireFetchSparqlEndpoint(),a=requireRdfStringTtl();let o=class{constructor(s,c,l,d){this.url=s,this.context=c,this.mediatorHttp=l,this.endpointFetcher=new r.SparqlEndpointFetcher({fetch:(f,h)=>this.mediatorHttp.mediate({input:f,init:h,context:this.context}),prefixVariableQuestionMark:!0,dataFactory:d})}async update(s){const c=this.createCombinedQuadsQuery(s.insert,s.delete);await this.wrapSparqlUpdateRequest(c)}createCombinedQuadsQuery(s,c){return new t.ArrayIterator([],{autoStart:!1}).append(this.createQuadsQuery("DELETE",c)).append(c&&s?[` ;
`]:[]).append(this.createQuadsQuery("INSERT",s))}createQuadsQuery(s,c){return c?c.map(l=>{let d=`${(0,a.termToString)(l.subject)} ${(0,a.termToString)(l.predicate)} ${(0,a.termToString)(l.object)} .`;return l.graph.termType==="DefaultGraph"?d=`  ${d}
`:d=`  GRAPH ${(0,a.termToString)(l.graph)} { ${d} }
`,d}).prepend([`${s} DATA {
`]).append(["}"]):new t.ArrayIterator([],{autoStart:!1})}async wrapSparqlUpdateRequest(s){const c=await(0,n.stringify)(s);await this.endpointFetcher.fetchUpdate(this.url,c)}async deleteGraphs(s,c,l){const d=Array.isArray(s)?s:[s],f=[];for(const h of d){let v;typeof h=="string"?v=h:h.termType==="DefaultGraph"?v="DEFAULT":v=`GRAPH <${h.value}>`,f.push(`${l?"DROP":"CLEAR"} ${c?"":"SILENT "}${v}`)}await this.endpointFetcher.fetchUpdate(this.url,f.join("; "))}async createGraphs(s,c){const l=[];for(const d of s)l.push(`CREATE${c?"":" SILENT"} GRAPH <${d.value}>`);await this.endpointFetcher.fetchUpdate(this.url,l.join("; "))}};return QuadDestinationSparql.QuadDestinationSparql=o,QuadDestinationSparql}var hasRequiredActorRdfUpdateHypermediaSparql;function requireActorRdfUpdateHypermediaSparql(){if(hasRequiredActorRdfUpdateHypermediaSparql)return ActorRdfUpdateHypermediaSparql;hasRequiredActorRdfUpdateHypermediaSparql=1,Object.defineProperty(ActorRdfUpdateHypermediaSparql,"__esModule",{value:!0}),ActorRdfUpdateHypermediaSparql.ActorRdfUpdateHypermediaSparql=void 0;const n=requireLib$1c(),t=requireLib$4q(),r=requireLib$4s(),a=requireQuadDestinationSparql();let o=class extends n.ActorRdfUpdateHypermedia{constructor(s){super(s,"sparql")}async testMetadata(s){return!s.forceDestinationType&&!s.metadata.sparqlService&&!(this.checkUrlSuffixSparql&&s.url.endsWith("/sparql"))&&!(this.checkUrlSuffixUpdate&&s.url.endsWith("/update"))?(0,r.failTest)(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql or /update.`):(0,r.passTestVoid)()}async run(s){this.logInfo(s.context,`Identified as sparql destination: ${s.url}`);const c=s.context.getSafe(t.KeysInitQuery.dataFactory);return{destination:new a.QuadDestinationSparql(s.metadata.sparqlService||s.url,s.context,this.mediatorHttp,c)}}};return ActorRdfUpdateHypermediaSparql.ActorRdfUpdateHypermediaSparql=o,ActorRdfUpdateHypermediaSparql}var hasRequiredLib$19;function requireLib$19(){return hasRequiredLib$19||(hasRequiredLib$19=1,function(n){var t=lib$19&&lib$19.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$19&&lib$19.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateHypermediaSparql(),n),r(requireQuadDestinationSparql(),n)}(lib$19)),lib$19}var lib$18={},ActorQueryOperationAsk={},hasRequiredActorQueryOperationAsk;function requireActorQueryOperationAsk(){if(hasRequiredActorQueryOperationAsk)return ActorQueryOperationAsk;hasRequiredActorQueryOperationAsk=1,Object.defineProperty(ActorQueryOperationAsk,"__esModule",{value:!0}),ActorQueryOperationAsk.ActorQueryOperationAsk=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$43();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"ask")}async testOperation(u,s){return(0,t.passTestVoid)()}async runOperation(u,s){const c=await this.mediatorQueryOperation.mediate({operation:u.input,context:s}),{bindingsStream:l}=(0,r.getSafeBindings)(c);return{type:"boolean",execute:async()=>(await l.take(1).toArray()).length===1}}};return ActorQueryOperationAsk.ActorQueryOperationAsk=a,ActorQueryOperationAsk}var hasRequiredLib$18;function requireLib$18(){return hasRequiredLib$18||(hasRequiredLib$18=1,function(n){var t=lib$18&&lib$18.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$18&&lib$18.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationAsk(),n)}(lib$18)),lib$18}var lib$17={},ActorQueryOperationBgpJoin={},hasRequiredActorQueryOperationBgpJoin;function requireActorQueryOperationBgpJoin(){if(hasRequiredActorQueryOperationBgpJoin)return ActorQueryOperationBgpJoin;hasRequiredActorQueryOperationBgpJoin=1,Object.defineProperty(ActorQueryOperationBgpJoin,"__esModule",{value:!0}),ActorQueryOperationBgpJoin.ActorQueryOperationBgpJoin=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorQueryOperationTypedMediated{constructor(s){super(s,"bgp")}async testOperation(s,c){return(0,r.passTestVoid)()}async runOperation(s,c){const l=c.getSafe(t.KeysInitQuery.dataFactory),d=new a.Factory(l);return this.mediatorQueryOperation.mediate({operation:d.createJoin(s.patterns),context:c})}};return ActorQueryOperationBgpJoin.ActorQueryOperationBgpJoin=o,ActorQueryOperationBgpJoin}var hasRequiredLib$17;function requireLib$17(){return hasRequiredLib$17||(hasRequiredLib$17=1,function(n){var t=lib$17&&lib$17.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$17&&lib$17.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationBgpJoin(),n)}(lib$17)),lib$17}var lib$16={},ActorQueryOperationConstruct={},BindingsToQuadsIterator={},hasRequiredBindingsToQuadsIterator;function requireBindingsToQuadsIterator(){if(hasRequiredBindingsToQuadsIterator)return BindingsToQuadsIterator;hasRequiredBindingsToQuadsIterator=1,Object.defineProperty(BindingsToQuadsIterator,"__esModule",{value:!0}),BindingsToQuadsIterator.BindingsToQuadsIterator=void 0;const n=requireAsynciterator(),t=requireRdfTerms();let r=class un extends n.MultiTransformIterator{constructor(o,u,s){super(s,{autoStart:!1}),this.dataFactory=o,this.template=u,this.blankNodeCounter=0}static bindTerm(o,u){return u.termType==="Variable"?o.get(u):u}static bindQuad(o,u){try{return(0,t.mapTermsNested)(u,s=>{const c=un.bindTerm(o,s);if(!c)throw new Error("Unbound term");return c})}catch{}}static localizeBlankNode(o,u,s){return s.termType==="BlankNode"?o.blankNode(`${s.value}${u}`):s}static localizeQuad(o,u,s){return(0,t.mapTermsNested)(s,c=>un.localizeBlankNode(o,u,c))}bindTemplate(o,u,s){return u.map(un.localizeQuad.bind(null,this.dataFactory,s)).map(l=>un.bindQuad.bind(null,o)(l)).filter(Boolean)}_createTransformer(o){return new n.ArrayIterator(this.bindTemplate(o,this.template,this.blankNodeCounter++),{autoStart:!1})}};return BindingsToQuadsIterator.BindingsToQuadsIterator=r,BindingsToQuadsIterator}var hasRequiredActorQueryOperationConstruct;function requireActorQueryOperationConstruct(){if(hasRequiredActorQueryOperationConstruct)return ActorQueryOperationConstruct;hasRequiredActorQueryOperationConstruct=1,Object.defineProperty(ActorQueryOperationConstruct,"__esModule",{value:!0}),ActorQueryOperationConstruct.ActorQueryOperationConstruct=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireRdfTerms(),u=requireSparqlalgebrajs(),s=requireBindingsToQuadsIterator();let c=class fa extends n.ActorQueryOperationTypedMediated{constructor(d){super(d,"construct")}static getVariables(d){return(0,o.uniqTerms)([].concat.apply([],d.map(f=>(0,o.getVariables)((0,o.getTermsNested)(f)))))}async testOperation(d,f){return(0,r.passTestVoid)()}async runOperation(d,f){const h=f.getSafe(t.KeysInitQuery.dataFactory),v=fa.getVariables(d.template),g={type:u.Algebra.types.PROJECT,input:d.input,variables:v},b=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:g,context:f})),_=new s.BindingsToQuadsIterator(h,d.template,b.bindingsStream);return{metadata:()=>b.metadata().then(T=>({...T,order:void 0,cardinality:{type:T.cardinality.type,value:T.cardinality.value*d.template.length},availableOrders:void 0})),quadStream:_,type:"quads"}}};return ActorQueryOperationConstruct.ActorQueryOperationConstruct=c,ActorQueryOperationConstruct}var hasRequiredLib$16;function requireLib$16(){return hasRequiredLib$16||(hasRequiredLib$16=1,function(n){var t=lib$16&&lib$16.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$16&&lib$16.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationConstruct(),n),r(requireBindingsToQuadsIterator(),n)}(lib$16)),lib$16}var lib$15={},ActorQueryOperationDistinctHash={},hasRequiredActorQueryOperationDistinctHash;function requireActorQueryOperationDistinctHash(){if(hasRequiredActorQueryOperationDistinctHash)return ActorQueryOperationDistinctHash;hasRequiredActorQueryOperationDistinctHash=1,Object.defineProperty(ActorQueryOperationDistinctHash,"__esModule",{value:!0}),ActorQueryOperationDistinctHash.ActorQueryOperationDistinctHash=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$43();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"distinct")}async testOperation(u,s){return(0,t.passTestVoid)()}async runOperation(u,s){const c=await this.mediatorQueryOperation.mediate({operation:u.input,context:s});if(c.type==="quads"){const h=(0,r.getSafeQuads)(c);return{type:"quads",quadStream:h.quadStream.filter(await this.newHashFilterQuads(s)),metadata:h.metadata}}const l=(0,r.getSafeBindings)(c),d=(await l.metadata()).variables.map(h=>h.variable);return{type:"bindings",bindingsStream:l.bindingsStream.filter(await this.newHashFilter(s,d)),metadata:l.metadata}}async newHashFilter(u,s){const{hashFunction:c}=await this.mediatorHashBindings.mediate({context:u}),l={};return d=>{const f=c(d,s);return!(f in l)&&(l[f]=!0)}}async newHashFilterQuads(u){const{hashFunction:s}=await this.mediatorHashQuads.mediate({context:u}),c={};return l=>{const d=s(l);return!(d in c)&&(c[d]=!0)}}};return ActorQueryOperationDistinctHash.ActorQueryOperationDistinctHash=a,ActorQueryOperationDistinctHash}var hasRequiredLib$15;function requireLib$15(){return hasRequiredLib$15||(hasRequiredLib$15=1,function(n){var t=lib$15&&lib$15.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$15&&lib$15.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationDistinctHash(),n)}(lib$15)),lib$15}var lib$14={},ActorQueryOperationExtend={},hasRequiredActorQueryOperationExtend;function requireActorQueryOperationExtend(){if(hasRequiredActorQueryOperationExtend)return ActorQueryOperationExtend;hasRequiredActorQueryOperationExtend=1,Object.defineProperty(ActorQueryOperationExtend,"__esModule",{value:!0}),ActorQueryOperationExtend.ActorQueryOperationExtend=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$1A(),a=requireLib$4n(),o=requireLib$43();let u=class extends n.ActorQueryOperationTypedMediated{constructor(c){super(c,"extend"),this.mediatorExpressionEvaluatorFactory=c.mediatorExpressionEvaluatorFactory}async testOperation(){return(0,t.passTestVoid)()}async runOperation(c,l){const{expression:d,input:f,variable:h}=c,v=(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:f,context:l}));if((await v.metadata()).variables.some(S=>S.variable.equals(h)))throw new Error(`Illegal binding to variable '${h.value}' that has already been bound`);const g=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:d,context:l}),b=async(S,T,w)=>{try{const A=await g.evaluate(S),R=S.set(h,A);w(R)}catch(A){(0,a.isExpressionError)(A)?(w(S),this.logWarn(l,`Expression error for extend operation (${A.message})with bindings '${(0,r.bindingsToString)(S)}'`)):_.emit("error",A)}T()},_=v.bindingsStream.transform({autoStart:!1,transform:b});return{type:"bindings",bindingsStream:_,async metadata(){const S=await v.metadata();return{...S,variables:[...S.variables,{variable:h,canBeUndef:!1}]}}}}};return ActorQueryOperationExtend.ActorQueryOperationExtend=u,ActorQueryOperationExtend}var hasRequiredLib$14;function requireLib$14(){return hasRequiredLib$14||(hasRequiredLib$14=1,function(n){var t=lib$14&&lib$14.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$14&&lib$14.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationExtend(),n)}(lib$14)),lib$14}var lib$13={},ActorQueryOperationFilter={},hasRequiredActorQueryOperationFilter;function requireActorQueryOperationFilter(){if(hasRequiredActorQueryOperationFilter)return ActorQueryOperationFilter;hasRequiredActorQueryOperationFilter=1,Object.defineProperty(ActorQueryOperationFilter,"__esModule",{value:!0}),ActorQueryOperationFilter.ActorQueryOperationFilter=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$1A(),a=requireLib$4n(),o=requireLib$43();let u=class extends n.ActorQueryOperationTypedMediated{constructor(c){super(c,"filter"),this.mediatorExpressionEvaluatorFactory=c.mediatorExpressionEvaluatorFactory}async testOperation(){return(0,t.passTestVoid)()}async runOperation(c,l){const d=await this.mediatorQueryOperation.mediate({operation:c.input,context:l}),f=(0,o.getSafeBindings)(d);(0,o.validateQueryOutput)(f,"bindings");const h=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:l}),v=async(b,_,S)=>{try{await h.evaluateAsEBV(b)&&S(b)}catch(T){(0,a.isExpressionError)(T)?this.logWarn(l,"Error occurred while filtering.",()=>({error:T,bindings:(0,r.bindingsToString)(b)})):g.emit("error",T)}_()},g=f.bindingsStream.transform({transform:v,autoStart:!1});return{type:"bindings",bindingsStream:g,metadata:f.metadata}}};return ActorQueryOperationFilter.ActorQueryOperationFilter=u,ActorQueryOperationFilter}var hasRequiredLib$13;function requireLib$13(){return hasRequiredLib$13||(hasRequiredLib$13=1,function(n){var t=lib$13&&lib$13.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$13&&lib$13.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationFilter(),n)}(lib$13)),lib$13}var lib$12={},ActorQueryOperationFromQuad={},hasRequiredActorQueryOperationFromQuad;function requireActorQueryOperationFromQuad(){if(hasRequiredActorQueryOperationFromQuad)return ActorQueryOperationFromQuad;hasRequiredActorQueryOperationFromQuad=1,Object.defineProperty(ActorQueryOperationFromQuad,"__esModule",{value:!0}),ActorQueryOperationFromQuad.ActorQueryOperationFromQuad=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class Kt extends n.ActorQueryOperationTypedMediated{constructor(s){super(s,"from")}static copyOperation(s,c){const l={};for(const d of Object.keys(s))Array.isArray(s[d])&&d!=="template"?d==="variables"?l[d]=s[d]:l[d]=s[d].map(c):Kt.ALGEBRA_TYPES.includes(s[d].type)?l[d]=c(s[d]):l[d]=s[d];return l}static applyOperationDefaultGraph(s,c,l){if(c.type==="bgp"&&c.patterns.length>0||c.type==="path"||c.type==="pattern"){if(c.type==="bgp")return Kt.joinOperations(s,c.patterns.map(f=>{if(f.graph.termType!=="DefaultGraph")return s.createBgp([f]);const h=l.map(v=>s.createBgp([Object.assign(s.createPattern(f.subject,f.predicate,f.object,v),{metadata:f.metadata})]));return Kt.unionOperations(s,h)}));if(c.graph.termType!=="DefaultGraph")return c;const d=l.map(f=>c.type==="path"?s.createPath(c.subject,c.predicate,c.object,f):Object.assign(s.createPattern(c.subject,c.predicate,c.object,f),{metadata:c.metadata}));return Kt.unionOperations(s,d)}return Kt.copyOperation(c,d=>this.applyOperationDefaultGraph(s,d,l))}static applyOperationNamedGraph(s,c,l,d){if(c.type==="bgp"&&c.patterns.length>0||c.type==="path"||c.type==="pattern"){const f=c.type==="bgp"?c.patterns[0].graph:c.graph;if(f.termType==="DefaultGraph")return{type:a.Algebra.types.BGP,patterns:[]};if(f.termType==="Variable"){if(l.length===1){const v=l[0],g={};g[`?${f.value}`]=v;const b=s.createValues([f],[g]);let _;return c.type==="bgp"?_=s.createBgp(c.patterns.map(S=>s.createPattern(S.subject,S.predicate,S.object,v))):c.type==="path"?_=s.createPath(c.subject,c.predicate,c.object,v):_=s.createPattern(c.subject,c.predicate,c.object,v),s.createJoin([b,_])}return Kt.unionOperations(s,l.map(v=>Kt.applyOperationNamedGraph(s,c,[v],d)))}return[...l,...d].some(v=>v.equals(f))?c:{type:a.Algebra.types.BGP,patterns:[]}}return Kt.copyOperation(c,f=>this.applyOperationNamedGraph(s,f,l,d))}static joinOperations(s,c){if(c.length===1)return c[0];if(c.length>1)return s.createJoin(c);throw new Error("A join can only be applied on at least one operation")}static unionOperations(s,c){if(c.length===1)return c[0];if(c.length>1)return s.createUnion(c);throw new Error("A union can only be applied on at least one operation")}static createOperation(s,c){let l=c.input;return c.default.length>0&&(l=Kt.applyOperationDefaultGraph(s,l,c.default)),(c.named.length>0||c.default.length>0)&&(l=Kt.applyOperationNamedGraph(s,l,c.named,c.default)),l}async testOperation(s,c){return(0,r.passTestVoid)()}async runOperation(s,c){const l=c.getSafe(t.KeysInitQuery.dataFactory),d=new a.Factory(l),f=Kt.createOperation(d,s);return this.mediatorQueryOperation.mediate({operation:f,context:c})}};return ActorQueryOperationFromQuad.ActorQueryOperationFromQuad=o,o.ALGEBRA_TYPES=Object.keys(a.Algebra.types).map(u=>a.Algebra.types[u]),ActorQueryOperationFromQuad}var hasRequiredLib$12;function requireLib$12(){return hasRequiredLib$12||(hasRequiredLib$12=1,function(n){var t=lib$12&&lib$12.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$12&&lib$12.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationFromQuad(),n)}(lib$12)),lib$12}var lib$11={},ActorQueryOperationProject={},hasRequiredActorQueryOperationProject;function requireActorQueryOperationProject(){if(hasRequiredActorQueryOperationProject)return ActorQueryOperationProject;hasRequiredActorQueryOperationProject=1,Object.defineProperty(ActorQueryOperationProject,"__esModule",{value:!0}),ActorQueryOperationProject.ActorQueryOperationProject=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$4f(),o=requireLib$43();let u=class extends n.ActorQueryOperationTypedMediated{constructor(c){super(c,"project")}async testOperation(c,l){return(0,r.passTestVoid)()}async runOperation(c,l){const d=l.getSafe(t.KeysInitQuery.dataFactory),f=(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:c.input,context:l})),h=await f.metadata(),v=Object.fromEntries(h.variables.map(A=>[A.variable.value,A])),g=c.variables.map(A=>({variable:A,canBeUndef:!1})),b=Object.fromEntries(g.map(A=>[A.variable.value,A])),_=h.variables.filter(A=>!(A.variable.value in b)),S=g.map(A=>({variable:A.variable,canBeUndef:!(A.variable.value in v)||v[A.variable.value].canBeUndef}));let T=_.length===0?f.bindingsStream:f.bindingsStream.map(A=>{for(const R of _)A=A.delete(R.variable);return A}),w=0;return T=T.map(A=>{w++;const R=new Map;return A.map(E=>{if(E instanceof a.BlankNodeBindingsScoped){let I=R.get(E.value);return I||(I=d.blankNode(`${E.value}${w}`),R.set(E.value,I)),I}return E})}),{type:"bindings",bindingsStream:T,metadata:async()=>({...h,variables:S})}}};return ActorQueryOperationProject.ActorQueryOperationProject=u,ActorQueryOperationProject}var hasRequiredLib$11;function requireLib$11(){return hasRequiredLib$11||(hasRequiredLib$11=1,function(n){var t=lib$11&&lib$11.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$11&&lib$11.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationProject(),n)}(lib$11)),lib$11}var lib$10={},ActorQueryOperationReducedHash={},hasRequiredActorQueryOperationReducedHash;function requireActorQueryOperationReducedHash(){if(hasRequiredActorQueryOperationReducedHash)return ActorQueryOperationReducedHash;hasRequiredActorQueryOperationReducedHash=1,Object.defineProperty(ActorQueryOperationReducedHash,"__esModule",{value:!0}),ActorQueryOperationReducedHash.ActorQueryOperationReducedHash=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$43(),a=requireCommonjs$1();let o=class extends n.ActorQueryOperationTypedMediated{constructor(s){super(s,"reduced")}async testOperation(s,c){return(0,t.passTestVoid)()}async runOperation(s,c){const l=(0,r.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:s.input,context:c})),d=(await l.metadata()).variables.map(h=>h.variable);return{type:"bindings",bindingsStream:l.bindingsStream.filter(await this.newHashFilter(c,d)),metadata:l.metadata}}async newHashFilter(s,c){const{hashFunction:l}=await this.mediatorHashBindings.mediate({context:s}),d=new a.LRUCache({max:this.cacheSize});return f=>{const h=l(f,c);return d.has(h)?!1:(d.set(h,!0),!0)}}};return ActorQueryOperationReducedHash.ActorQueryOperationReducedHash=o,ActorQueryOperationReducedHash}var hasRequiredLib$10;function requireLib$10(){return hasRequiredLib$10||(hasRequiredLib$10=1,function(n){var t=lib$10&&lib$10.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$10&&lib$10.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationReducedHash(),n)}(lib$10)),lib$10}var lib$$={},ActorQueryOperationSlice={},hasRequiredActorQueryOperationSlice;function requireActorQueryOperationSlice(){if(hasRequiredActorQueryOperationSlice)return ActorQueryOperationSlice;hasRequiredActorQueryOperationSlice=1,Object.defineProperty(ActorQueryOperationSlice,"__esModule",{value:!0}),ActorQueryOperationSlice.ActorQueryOperationSlice=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"slice")}async testOperation(u,s){return(0,r.passTestVoid)()}async runOperation(u,s){u.length&&(s=s.set(t.KeysQueryOperation.limitIndicator,u.length));const c=await this.mediatorQueryOperation.mediate({operation:u.input,context:s});return c.type==="bindings"?{type:"bindings",bindingsStream:this.sliceStream(c.bindingsStream,u),metadata:this.sliceMetadata(c,u)}:c.type==="quads"?{type:"quads",quadStream:this.sliceStream(c.quadStream,u),metadata:this.sliceMetadata(c,u)}:c}sliceStream(u,s){const c=!!s.length||s.length===0,{start:l}=s,d=c?s.start+s.length-1:Number.POSITIVE_INFINITY;return u.transform({offset:l,limit:Math.max(d-l+1,0),autoStart:!1})}sliceMetadata(u,s){const c=!!s.length||s.length===0;return()=>u.metadata().then(l=>{const d={...l.cardinality};return Number.isFinite(d.value)&&(d.value=Math.max(0,d.value-s.start),c&&(d.value=Math.min(d.value,s.length))),{...l,cardinality:d}})}};return ActorQueryOperationSlice.ActorQueryOperationSlice=a,ActorQueryOperationSlice}var hasRequiredLib$$;function requireLib$$(){return hasRequiredLib$$||(hasRequiredLib$$=1,function(n){var t=lib$$&&lib$$.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$$&&lib$$.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationSlice(),n)}(lib$$)),lib$$}var lib$_={},ActorQueryOperationUnion={},hasRequiredActorQueryOperationUnion;function requireActorQueryOperationUnion(){if(hasRequiredActorQueryOperationUnion)return ActorQueryOperationUnion;hasRequiredActorQueryOperationUnion=1,Object.defineProperty(ActorQueryOperationUnion,"__esModule",{value:!0}),ActorQueryOperationUnion.ActorQueryOperationUnion=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$4l(),a=requireLib$43(),o=requireAsynciterator();let u=class Pn extends n.ActorQueryOperationTypedMediated{constructor(c){super(c,"union")}static unionVariables(c){const l={};for(const d of c)for(const f of d){l[f.variable.value]||(l[f.variable.value]={variable:f.variable,canBeUndef:f.canBeUndef,occurrences:0});const h=l[f.variable.value];h.canBeUndef=h.canBeUndef||f.canBeUndef,h.occurrences++}return Object.values(l).map(d=>d.occurrences===c.length?{variable:d.variable,canBeUndef:d.canBeUndef}:{variable:d.variable,canBeUndef:!0})}static async unionMetadata(c,l,d,f){let h=(await f.mediate({mode:"initialize",context:d})).metadata;for(const g of c)h={...g,...(await f.mediate({mode:"append",accumulatedMetadata:h,appendingMetadata:g,context:d})).metadata};h.state=new r.MetadataValidationState;const v=()=>h.state.invalidate();for(const g of c)g.state.addInvalidateListener(v);if(l){const g=c.map(b=>b.variables);h.variables=Pn.unionVariables(g)}return h}async testOperation(c,l){return(0,t.passTestVoid)()}async runOperation(c,l){const d=await Promise.all(c.input.map(h=>this.mediatorQueryOperation.mediate({operation:h,context:l})));let f;for(const h of d)if(f===void 0)f=h.type;else if(f!==h.type)throw new Error(`Unable to union ${f} and ${h.type}`);if(f==="bindings"||c.input.length===0){const h=d.map(a.getSafeBindings);return{type:"bindings",bindingsStream:new o.UnionIterator(h.map(b=>b.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(h.map(b=>b.metadata())).then(b=>Pn.unionMetadata(b,!0,l,this.mediatorRdfMetadataAccumulate))}}if(f==="quads"){const h=d.map(a.getSafeQuads);return{type:"quads",quadStream:new o.UnionIterator(h.map(b=>b.quadStream),{autoStart:!1}),metadata:()=>Promise.all(h.map(b=>b.metadata())).then(b=>Pn.unionMetadata(b,!1,l,this.mediatorRdfMetadataAccumulate))}}throw new Error(`Unable to union ${f}`)}};return ActorQueryOperationUnion.ActorQueryOperationUnion=u,ActorQueryOperationUnion}var hasRequiredLib$_;function requireLib$_(){return hasRequiredLib$_||(hasRequiredLib$_=1,function(n){var t=lib$_&&lib$_.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$_&&lib$_.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationUnion(),n)}(lib$_)),lib$_}var lib$Z={},ActorQueryOperationPathAlt={},lib$Y={},ActorAbstractPath={},PathVariableObjectIterator={},hasRequiredPathVariableObjectIterator;function requirePathVariableObjectIterator(){if(hasRequiredPathVariableObjectIterator)return PathVariableObjectIterator;hasRequiredPathVariableObjectIterator=1,Object.defineProperty(PathVariableObjectIterator,"__esModule",{value:!0}),PathVariableObjectIterator.PathVariableObjectIterator=void 0;const n=requireLib$43(),t=requireAsynciterator(),r=requireRdfString();let a=class extends t.BufferedIterator{constructor(u,s,c,l,d,f,h,v=16){super({autoStart:!0}),this.algebraFactory=u,this.subject=s,this.predicate=c,this.graph=l,this.context=d,this.mediatorQueryOperation=f,this.maxRunningOperations=v,this.termHashes=new Map,this.runningOperations=[],this.pendingOperations=[],this._push(this.subject,h)}_end(u){for(const s of this.runningOperations)s.destroy();super._end(u)}_push(u,s=!0){let c;if(s&&(c=(0,r.termToString)(u),this.termHashes.has(c)))return;const l=this.algebraFactory.dataFactory.variable("b");this.pendingOperations.push({variable:l,operation:this.algebraFactory.createPath(u,this.predicate,l,this.graph)}),c&&(this.termHashes.set(c,u),super._push(u))}_read(u,s){const c=this;(async function(){for(;c.runningOperations.length<c.maxRunningOperations&&c.pendingOperations.length!==0;){const f=c.pendingOperations.pop(),h=(0,n.getSafeBindings)(await c.mediatorQueryOperation.mediate({operation:f.operation,context:c.context})),v=h.bindingsStream.transform({autoStart:!1,transform(g,b,_){const S=g.get(f.variable);_(S),b()}});v.done||(c.runningOperations.push(v),v.on("error",g=>c.destroy(g)),v.on("readable",()=>{c.readable=!0,c._fillBufferAsync()}),v.on("end",()=>{c.runningOperations.splice(c.runningOperations.indexOf(v),1),c.readable=!0,c._fillBufferAsync()})),c.setProperty("metadata",h.metadata)}let l=0,d;for(;l!==(l=u);)for(let f=0;f<c.runningOperations.length&&u>0;f++)(d=c.runningOperations[f].read())!==null&&(u--,c._push(d));c.runningOperations.length===0&&c.pendingOperations.length===0&&c.close()})().then(()=>{s()},l=>this.destroy(l))}};return PathVariableObjectIterator.PathVariableObjectIterator=a,PathVariableObjectIterator}var hasRequiredActorAbstractPath;function requireActorAbstractPath(){if(hasRequiredActorAbstractPath)return ActorAbstractPath;hasRequiredActorAbstractPath=1,Object.defineProperty(ActorAbstractPath,"__esModule",{value:!0}),ActorAbstractPath.ActorAbstractPath=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireAsynciterator(),u=requireRdfString(),s=requireSparqlalgebrajs(),c=requirePathVariableObjectIterator();let l=class extends n.ActorQueryOperationTypedMediated{constructor(f,h){super(f,"path"),this.predicateType=h}async testOperation(f,h){return f.predicate.type!==this.predicateType?(0,r.failTest)(`This Actor only supports ${this.predicateType} Path operations.`):(0,r.passTestVoid)()}generateVariable(f,h,v){return v?h&&(h.subject.value===v||h.object.value===v)?this.generateVariable(f,h,`${v}b`):f.variable(v):this.generateVariable(f,h,"b")}async isPathArbitraryLengthDistinct(f,h,v){return h.get(t.KeysQueryOperation.isPathArbitraryLengthDistinctKey)?(h=h.set(t.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!1),{context:h,operation:void 0}):(h=h.set(t.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!0),{context:h,operation:(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:f.createDistinct(v),context:h}))})}async predicateStarGraphVariable(f,h,v,g,b,_,S){const T=this.getPathSources(v),w=this.generateVariable(_.dataFactory,_.createPath(f,v,h,g)),A=_.createUnion([this.assignPatternSources(_,_.createPattern(f,w,h,g),T),this.assignPatternSources(_,_.createPattern(h,w,f,g),T)]),R=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:b,operation:A})),E=new Set;return{bindingsStream:new o.MultiTransformIterator(R.bindingsStream,{multiTransform:L=>{const F=L.get(g);return E.has(F.value)?new o.EmptyIterator:(E.add(F.value),new o.TransformIterator(async()=>{const D=new o.BufferedIterator;return await this.getObjectsPredicateStar(_,f,v,F,b,{},D,{count:0}),D.transform({transform($,O,P){P(S.bindings([[h,$],[g,F]])),O()}})},{maxBufferSize:128}))},autoStart:!1}),metadata:R.metadata}}async getObjectsPredicateStarEval(f,h,v,g,b,_,S,T){if(g.termType==="Variable")return this.predicateStarGraphVariable(f,v,h,g,b,S,T);const w=new c.PathVariableObjectIterator(S,f,h,g,b,this.mediatorQueryOperation,_);return{bindingsStream:w.transform({autoStart:!1,transform(R,E,I){I(T.bindings([[v,R]])),E()}}),async metadata(){const R=await new Promise(E=>{w.getProperty("metadata",I=>E(I()))});return R.cardinality.value++,R}}}async getObjectsPredicateStar(f,h,v,g,b,_,S,T){const w=(0,u.termToString)(h);if(_[w])return;S._push(h),_[w]=h,T.count++;const A=this.generateVariable(f.dataFactory),R=f.createPath(h,v,A,g),E=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:R,context:b}));return E.bindingsStream.on("data",async I=>{const L=I.get(A);await this.getObjectsPredicateStar(f,L,v,g,b,_,S,T)}),E.bindingsStream.on("end",()=>{--T.count===0&&S.close()}),E.metadata}async getSubjectAndObjectBindingsPredicateStar(f,h,v,g,b,_,S,T,w,A,R,E,I){const L=(0,u.termToString)(g)+(0,u.termToString)(_);if(w[L])return;if(R.count++,w[L]=!0,A._push(I.bindings([[f,v],[h,g]])),L in T){const D=await T[L];for(const $ of D)await this.getSubjectAndObjectBindingsPredicateStar(f,h,v,$,b,_,S,T,w,A,R,E,I);--R.count===0&&A.close();return}const F=new Promise(async(D,$)=>{const O=[],P=this.generateVariable(E.dataFactory),C=E.createPath(g,b,P,_),q=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:C,context:S}));q.bindingsStream.on("data",async M=>{const N=M.get(P);O.push(N),await this.getSubjectAndObjectBindingsPredicateStar(f,h,v,N,b,_,S,T,w,A,R,E,I)}),q.bindingsStream.on("error",$),q.bindingsStream.on("end",()=>{--R.count===0&&A.close(),D(O)})});T[L]=F}getPathSources(f){switch(f.type){case s.Algebra.types.ALT:case s.Algebra.types.SEQ:return f.input.flatMap(h=>this.getPathSources(h));case s.Algebra.types.INV:case s.Algebra.types.ONE_OR_MORE_PATH:case s.Algebra.types.ZERO_OR_MORE_PATH:case s.Algebra.types.ZERO_OR_ONE_PATH:return this.getPathSources(f.path);case s.Algebra.types.LINK:case s.Algebra.types.NPS:{const h=(0,a.getOperationSource)(f);if(!h)throw new Error("Could not find a required source on a link path operation");return[h]}}}assignPatternSources(f,h,v){if(v.length===0)throw new Error("Attempted to assign zero sources to a pattern during property path handling");return v.length===1?(0,a.assignOperationSource)(h,v[0]):f.createUnion(v.map(g=>(0,a.assignOperationSource)(h,g)),!0)}};return ActorAbstractPath.ActorAbstractPath=l,ActorAbstractPath}var hasRequiredLib$Z;function requireLib$Z(){return hasRequiredLib$Z||(hasRequiredLib$Z=1,function(n){var t=lib$Y&&lib$Y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$Y&&lib$Y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorAbstractPath(),n),r(requirePathVariableObjectIterator(),n)}(lib$Y)),lib$Y}var hasRequiredActorQueryOperationPathAlt;function requireActorQueryOperationPathAlt(){if(hasRequiredActorQueryOperationPathAlt)return ActorQueryOperationPathAlt;hasRequiredActorQueryOperationPathAlt=1,Object.defineProperty(ActorQueryOperationPathAlt,"__esModule",{value:!0}),ActorQueryOperationPathAlt.ActorQueryOperationPathAlt=void 0;const n=requireLib$Z(),t=requireLib$_(),r=requireLib$4q(),a=requireLib$43(),o=requireAsynciterator(),u=requireSparqlalgebrajs();let s=class extends n.ActorAbstractPath{constructor(l){super(l,u.Algebra.types.ALT)}async runOperation(l,d){const f=d.getSafe(r.KeysInitQuery.dataFactory),h=new u.Factory(f),v=l.predicate,g=(await Promise.all(v.input.map(S=>this.mediatorQueryOperation.mediate({context:d,operation:h.createPath(l.subject,S,l.object,l.graph)})))).map(a.getSafeBindings);return{type:"bindings",bindingsStream:new o.UnionIterator(g.map(S=>S.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(g.map(S=>S.metadata())).then(S=>t.ActorQueryOperationUnion.unionMetadata(S,!0,d,this.mediatorRdfMetadataAccumulate))}}};return ActorQueryOperationPathAlt.ActorQueryOperationPathAlt=s,ActorQueryOperationPathAlt}var hasRequiredLib$Y;function requireLib$Y(){return hasRequiredLib$Y||(hasRequiredLib$Y=1,function(n){var t=lib$Z&&lib$Z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$Z&&lib$Z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathAlt(),n)}(lib$Z)),lib$Z}var lib$X={},ActorQueryOperationPathInv={},hasRequiredActorQueryOperationPathInv;function requireActorQueryOperationPathInv(){if(hasRequiredActorQueryOperationPathInv)return ActorQueryOperationPathInv;hasRequiredActorQueryOperationPathInv=1,Object.defineProperty(ActorQueryOperationPathInv,"__esModule",{value:!0}),ActorQueryOperationPathInv.ActorQueryOperationPathInv=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireSparqlalgebrajs();let a=class extends n.ActorAbstractPath{constructor(u){super(u,r.Algebra.types.INV)}async runOperation(u,s){const c=s.getSafe(t.KeysInitQuery.dataFactory),l=new r.Factory(c),d=u.predicate,f=l.createPath(u.object,d.path,u.subject,u.graph);return this.mediatorQueryOperation.mediate({operation:f,context:s})}};return ActorQueryOperationPathInv.ActorQueryOperationPathInv=a,ActorQueryOperationPathInv}var hasRequiredLib$X;function requireLib$X(){return hasRequiredLib$X||(hasRequiredLib$X=1,function(n){var t=lib$X&&lib$X.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$X&&lib$X.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathInv(),n)}(lib$X)),lib$X}var lib$W={},ActorQueryOperationPathLink={},hasRequiredActorQueryOperationPathLink;function requireActorQueryOperationPathLink(){if(hasRequiredActorQueryOperationPathLink)return ActorQueryOperationPathLink;hasRequiredActorQueryOperationPathLink=1,Object.defineProperty(ActorQueryOperationPathLink,"__esModule",{value:!0}),ActorQueryOperationPathLink.ActorQueryOperationPathLink=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireSparqlalgebrajs();let a=class extends n.ActorAbstractPath{constructor(u){super(u,r.Algebra.types.LINK)}async runOperation(u,s){const c=s.getSafe(t.KeysInitQuery.dataFactory),l=new r.Factory(c),d=u.predicate,f=Object.assign(l.createPattern(u.subject,d.iri,u.object,u.graph),{metadata:d.metadata});return this.mediatorQueryOperation.mediate({operation:f,context:s})}};return ActorQueryOperationPathLink.ActorQueryOperationPathLink=a,ActorQueryOperationPathLink}var hasRequiredLib$W;function requireLib$W(){return hasRequiredLib$W||(hasRequiredLib$W=1,function(n){var t=lib$W&&lib$W.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$W&&lib$W.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathLink(),n)}(lib$W)),lib$W}var lib$V={},ActorQueryOperationPathNps={},hasRequiredActorQueryOperationPathNps;function requireActorQueryOperationPathNps(){if(hasRequiredActorQueryOperationPathNps)return ActorQueryOperationPathNps;hasRequiredActorQueryOperationPathNps=1,Object.defineProperty(ActorQueryOperationPathNps,"__esModule",{value:!0}),ActorQueryOperationPathNps.ActorQueryOperationPathNps=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireLib$43(),a=requireSparqlalgebrajs();let o=class extends n.ActorAbstractPath{constructor(s){super(s,a.Algebra.types.NPS)}async runOperation(s,c){const l=c.getSafe(t.KeysInitQuery.dataFactory),d=new a.Factory(l),f=s.predicate,h=this.generateVariable(l,s),v=Object.assign(d.createPattern(s.subject,h,s.object,s.graph),{metadata:f.metadata}),g=(0,r.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:v,context:c}));return{type:"bindings",bindingsStream:g.bindingsStream.map(_=>f.iris.some(S=>S.equals(_.get(h)))?null:_.delete(h)),metadata:g.metadata}}};return ActorQueryOperationPathNps.ActorQueryOperationPathNps=o,ActorQueryOperationPathNps}var hasRequiredLib$V;function requireLib$V(){return hasRequiredLib$V||(hasRequiredLib$V=1,function(n){var t=lib$V&&lib$V.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$V&&lib$V.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathNps(),n)}(lib$V)),lib$V}var lib$U={},ActorQueryOperationClear={},hasRequiredActorQueryOperationClear;function requireActorQueryOperationClear(){if(hasRequiredActorQueryOperationClear)return ActorQueryOperationClear;hasRequiredActorQueryOperationClear=1,Object.defineProperty(ActorQueryOperationClear,"__esModule",{value:!0}),ActorQueryOperationClear.ActorQueryOperationClear=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$43();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"clear")}async testOperation(u,s){return(0,r.testReadOnly)(s)}async runOperation(u,s){const c=s.getSafe(t.KeysInitQuery.dataFactory);let l;u.source==="DEFAULT"?l=c.defaultGraph():typeof u.source=="string"?l=u.source:l=[u.source];const{execute:d}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:l,requireExistence:!u.silent,dropGraphs:!1},context:s});return{type:"void",execute:d}}};return ActorQueryOperationClear.ActorQueryOperationClear=a,ActorQueryOperationClear}var hasRequiredLib$U;function requireLib$U(){return hasRequiredLib$U||(hasRequiredLib$U=1,function(n){var t=lib$U&&lib$U.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$U&&lib$U.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationClear(),n)}(lib$U)),lib$U}var lib$T={},ActorQueryOperationUpdateCompositeUpdate={},hasRequiredActorQueryOperationUpdateCompositeUpdate;function requireActorQueryOperationUpdateCompositeUpdate(){if(hasRequiredActorQueryOperationUpdateCompositeUpdate)return ActorQueryOperationUpdateCompositeUpdate;hasRequiredActorQueryOperationUpdateCompositeUpdate=1,Object.defineProperty(ActorQueryOperationUpdateCompositeUpdate,"__esModule",{value:!0}),ActorQueryOperationUpdateCompositeUpdate.ActorQueryOperationUpdateCompositeUpdate=void 0;const n=requireLib$4k(),t=requireLib$43();let r=class extends n.ActorQueryOperationTypedMediated{constructor(o){super(o,"compositeupdate")}async testOperation(o,u){return(0,t.testReadOnly)(u)}async runOperation(o,u){return{type:"void",execute:()=>(async()=>{for(const c of o.updates)await(0,t.getSafeVoid)(await this.mediatorQueryOperation.mediate({operation:c,context:u})).execute()})()}}};return ActorQueryOperationUpdateCompositeUpdate.ActorQueryOperationUpdateCompositeUpdate=r,ActorQueryOperationUpdateCompositeUpdate}var hasRequiredLib$T;function requireLib$T(){return hasRequiredLib$T||(hasRequiredLib$T=1,function(n){var t=lib$T&&lib$T.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$T&&lib$T.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationUpdateCompositeUpdate(),n)}(lib$T)),lib$T}var lib$S={},ActorQueryOperationCreate={},hasRequiredActorQueryOperationCreate;function requireActorQueryOperationCreate(){if(hasRequiredActorQueryOperationCreate)return ActorQueryOperationCreate;hasRequiredActorQueryOperationCreate=1,Object.defineProperty(ActorQueryOperationCreate,"__esModule",{value:!0}),ActorQueryOperationCreate.ActorQueryOperationCreate=void 0;const n=requireLib$4k(),t=requireLib$43();let r=class extends n.ActorQueryOperationTypedMediated{constructor(o){super(o,"create")}async testOperation(o,u){return(0,t.testReadOnly)(u)}async runOperation(o,u){const{execute:s}=await this.mediatorUpdateQuads.mediate({createGraphs:{graphs:[o.source],requireNonExistence:!o.silent},context:u});return{type:"void",execute:s}}};return ActorQueryOperationCreate.ActorQueryOperationCreate=r,ActorQueryOperationCreate}var hasRequiredLib$S;function requireLib$S(){return hasRequiredLib$S||(hasRequiredLib$S=1,function(n){var t=lib$S&&lib$S.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$S&&lib$S.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationCreate(),n)}(lib$S)),lib$S}var lib$R={},ActorQueryOperationDrop={},hasRequiredActorQueryOperationDrop;function requireActorQueryOperationDrop(){if(hasRequiredActorQueryOperationDrop)return ActorQueryOperationDrop;hasRequiredActorQueryOperationDrop=1,Object.defineProperty(ActorQueryOperationDrop,"__esModule",{value:!0}),ActorQueryOperationDrop.ActorQueryOperationDrop=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$43();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"drop")}async testOperation(u,s){return(0,r.testReadOnly)(s)}async runOperation(u,s){const c=s.getSafe(t.KeysInitQuery.dataFactory);let l;u.source==="DEFAULT"?l=c.defaultGraph():typeof u.source=="string"?l=u.source:l=[u.source];const{execute:d}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:l,requireExistence:!u.silent,dropGraphs:!0},context:s});return{type:"void",execute:d}}};return ActorQueryOperationDrop.ActorQueryOperationDrop=a,ActorQueryOperationDrop}var hasRequiredLib$R;function requireLib$R(){return hasRequiredLib$R||(hasRequiredLib$R=1,function(n){var t=lib$R&&lib$R.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$R&&lib$R.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationDrop(),n)}(lib$R)),lib$R}var lib$Q={},ActorQueryOperationLoad={},hasRequiredActorQueryOperationLoad;function requireActorQueryOperationLoad(){if(hasRequiredActorQueryOperationLoad)return ActorQueryOperationLoad;hasRequiredActorQueryOperationLoad=1,Object.defineProperty(ActorQueryOperationLoad,"__esModule",{value:!0}),ActorQueryOperationLoad.ActorQueryOperationLoad=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$43(),a=requireSparqlalgebrajs();let o=class extends n.ActorQueryOperationTypedMediated{constructor(s){super(s,"load")}async testOperation(s,c){return(0,r.testReadOnly)(c)}async runOperation(s,c){const l=c.getSafe(t.KeysInitQuery.dataFactory),d=new a.Factory(l);let f=c;s.silent&&(f=f.set(t.KeysInitQuery.lenient,!0));const{querySource:h}=await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{value:s.source.value},context:f});let g=(0,r.getSafeQuads)(await this.mediatorQueryOperation.mediate({operation:d.createConstruct((0,r.assignOperationSource)(d.createPattern(l.variable("s"),l.variable("p"),l.variable("o")),h),[d.createPattern(l.variable("s"),l.variable("p"),l.variable("o"))]),context:f})).quadStream;s.destination&&(g=g.map(_=>l.quad(_.subject,_.predicate,_.object,s.destination)));const{execute:b}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:g,context:c});return{type:"void",execute:b}}};return ActorQueryOperationLoad.ActorQueryOperationLoad=o,ActorQueryOperationLoad}var hasRequiredLib$Q;function requireLib$Q(){return hasRequiredLib$Q||(hasRequiredLib$Q=1,function(n){var t=lib$Q&&lib$Q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$Q&&lib$Q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationLoad(),n)}(lib$Q)),lib$Q}var lib$P={},ActorQueryOperationJoin={},hasRequiredActorQueryOperationJoin;function requireActorQueryOperationJoin(){if(hasRequiredActorQueryOperationJoin)return ActorQueryOperationJoin;hasRequiredActorQueryOperationJoin=1,Object.defineProperty(ActorQueryOperationJoin,"__esModule",{value:!0}),ActorQueryOperationJoin.ActorQueryOperationJoin=void 0;const n=requireLib$4k(),t=requireLib$1H(),r=requireLib$4s(),a=requireLib$4l(),o=requireLib$43(),u=requireAsynciterator(),s=requireRdfDataFactory();let c=class extends n.ActorQueryOperationTypedMediated{constructor(d){super(d,"join")}async testOperation(d,f){return(0,r.passTestVoid)()}async runOperation(d,f){const h=(await Promise.all(d.input.map(async v=>({output:await this.mediatorQueryOperation.mediate({operation:v,context:f}),operation:v})))).map(({output:v,operation:g})=>({output:(0,o.getSafeBindings)(v),operation:g}));if((await Promise.all(h.map(v=>v.output.metadata()))).some(v=>v.cardinality.value===0&&v.cardinality.type==="exact")){for(const v of h)v.output.bindingsStream.close();return{bindingsStream:new u.ArrayIterator([],{autoStart:!1}),metadata:async()=>({state:new a.MetadataValidationState,cardinality:{type:"exact",value:0},variables:t.ActorRdfJoin.joinVariables(new s.DataFactory,await t.ActorRdfJoin.getMetadatas(h))}),type:"bindings"}}return this.mediatorJoin.mediate({type:"inner",entries:h,context:f})}};return ActorQueryOperationJoin.ActorQueryOperationJoin=c,ActorQueryOperationJoin}var hasRequiredLib$P;function requireLib$P(){return hasRequiredLib$P||(hasRequiredLib$P=1,function(n){var t=lib$P&&lib$P.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$P&&lib$P.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationJoin(),n)}(lib$P)),lib$P}var lib$O={},ActorQueryOperationLeftJoin={},hasRequiredActorQueryOperationLeftJoin;function requireActorQueryOperationLeftJoin(){if(hasRequiredActorQueryOperationLeftJoin)return ActorQueryOperationLeftJoin;hasRequiredActorQueryOperationLeftJoin=1,Object.defineProperty(ActorQueryOperationLeftJoin,"__esModule",{value:!0}),ActorQueryOperationLeftJoin.ActorQueryOperationLeftJoin=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$1A(),a=requireLib$4n(),o=requireLib$43();let u=class extends n.ActorQueryOperationTypedMediated{constructor(c){super(c,"leftjoin"),this.mediatorExpressionEvaluatorFactory=c.mediatorExpressionEvaluatorFactory}async testOperation(c,l){return(0,t.passTestVoid)()}async runOperation(c,l){const d=(await Promise.all(c.input.map(async h=>({output:await this.mediatorQueryOperation.mediate({operation:h,context:l}),operation:h})))).map(({output:h,operation:v})=>({output:(0,o.getSafeBindings)(h),operation:v})),f=await this.mediatorJoin.mediate({type:"optional",entries:d,context:l});if(c.expression){const v=(await d[1].output.metadata()).variables,g=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:l}),b=f.bindingsStream.transform({autoStart:!1,transform:async(_,S,T)=>{if(!v.every(w=>_.has(w.variable.value)))return T(_),S();try{await g.evaluateAsEBV(_)&&T(_)}catch(w){(0,a.isExpressionError)(w)?this.logWarn(l,"Error occurred while filtering.",()=>({error:w,bindings:(0,r.bindingsToString)(_)})):b.emit("error",w)}S()}});f.bindingsStream=b}return f}};return ActorQueryOperationLeftJoin.ActorQueryOperationLeftJoin=u,ActorQueryOperationLeftJoin}var hasRequiredLib$O;function requireLib$O(){return hasRequiredLib$O||(hasRequiredLib$O=1,function(n){var t=lib$O&&lib$O.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$O&&lib$O.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationLeftJoin(),n)}(lib$O)),lib$O}var lib$N={},ActorQueryOperationMinus={},hasRequiredActorQueryOperationMinus;function requireActorQueryOperationMinus(){if(hasRequiredActorQueryOperationMinus)return ActorQueryOperationMinus;hasRequiredActorQueryOperationMinus=1,Object.defineProperty(ActorQueryOperationMinus,"__esModule",{value:!0}),ActorQueryOperationMinus.ActorQueryOperationMinus=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$43();let a=class extends n.ActorQueryOperationTypedMediated{constructor(u){super(u,"minus")}async testOperation(u,s){return(0,t.passTestVoid)()}async runOperation(u,s){const c=(await Promise.all(u.input.map(async l=>({output:await this.mediatorQueryOperation.mediate({operation:l,context:s}),operation:l})))).map(({output:l,operation:d})=>({output:(0,r.getSafeBindings)(l),operation:d}));return this.mediatorJoin.mediate({type:"minus",entries:c,context:s})}};return ActorQueryOperationMinus.ActorQueryOperationMinus=a,ActorQueryOperationMinus}var hasRequiredLib$N;function requireLib$N(){return hasRequiredLib$N||(hasRequiredLib$N=1,function(n){var t=lib$N&&lib$N.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$N&&lib$N.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationMinus(),n)}(lib$N)),lib$N}var lib$M={},ActorQueryOperationPathSeq={},hasRequiredActorQueryOperationPathSeq;function requireActorQueryOperationPathSeq(){if(hasRequiredActorQueryOperationPathSeq)return ActorQueryOperationPathSeq;hasRequiredActorQueryOperationPathSeq=1,Object.defineProperty(ActorQueryOperationPathSeq,"__esModule",{value:!0}),ActorQueryOperationPathSeq.ActorQueryOperationPathSeq=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireLib$43(),a=requireSparqlalgebrajs();let o=class extends n.ActorAbstractPath{constructor(s){super(s,a.Algebra.types.SEQ)}async runOperation(s,c){const l=c.getSafe(t.KeysInitQuery.dataFactory),d=new a.Factory(l),f=s.predicate;let h=s.subject;const v=[],g=await Promise.all(f.input.map((S,T)=>{const w=T===f.input.length-1?s.object:this.generateVariable(l,s,`b${T}`),A=d.createPath(h,S,w,s.graph),R=this.mediatorQueryOperation.mediate({context:c,operation:A});return h=w,T<f.input.length-1&&v.push(w),{output:R,operation:A}}).map(async({output:S,operation:T})=>({output:(0,r.getSafeBindings)(await S),operation:T}))),b=(0,r.getSafeBindings)(await this.mediatorJoin.mediate({type:"inner",entries:g,context:c}));return{type:"bindings",bindingsStream:b.bindingsStream.transform({transform(S,T,w){for(const A of v)S=S.delete(A);w(S),T()}}),async metadata(){const S=await b.metadata(),T=S.variables.filter(w=>!v.some(A=>A.value===w.variable.value));return{...S,variables:T}}}}};return ActorQueryOperationPathSeq.ActorQueryOperationPathSeq=o,ActorQueryOperationPathSeq}var hasRequiredLib$M;function requireLib$M(){return hasRequiredLib$M||(hasRequiredLib$M=1,function(n){var t=lib$M&&lib$M.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$M&&lib$M.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathSeq(),n)}(lib$M)),lib$M}var lib$L={},ActorRdfJoinMultiSmallest={},hasRequiredActorRdfJoinMultiSmallest;function requireActorRdfJoinMultiSmallest(){if(hasRequiredActorRdfJoinMultiSmallest)return ActorRdfJoinMultiSmallest;hasRequiredActorRdfJoinMultiSmallest=1,Object.defineProperty(ActorRdfJoinMultiSmallest,"__esModule",{value:!0}),ActorRdfJoinMultiSmallest.ActorRdfJoinMultiSmallest=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireSparqlalgebrajs();let u=class extends n.ActorRdfJoin{constructor(c){super(c,{logicalType:"inner",physicalName:"multi-smallest",limitEntries:3,limitEntriesMin:!0,canHandleUndefs:!0,isLeaf:!1})}async sortJoinEntries(c,l){return(await this.mediatorJoinEntriesSort.mediate({entries:c,context:l})).entries}async getOutput(c,l){const d=c.context.getSafe(t.KeysInitQuery.dataFactory),f=new o.Factory(d),h=l.sortedEntries,v=h[0],g=h[1];h.splice(0,2);const b={output:(0,a.getSafeBindings)(await this.mediatorJoin.mediate({type:c.type,entries:[v,g],context:c.context})),operation:f.createJoin([v.operation,g.operation],!1)};return h.push(b),{result:await this.mediatorJoin.mediate({type:c.type,entries:h,context:c.context})}}async getJoinCoefficients(c,l){let{metadatas:d}=l;d=[...d];const f=await this.sortJoinEntries(c.entries.map((g,b)=>({...g,metadata:d[b]})),c.context);d=f.map(g=>g.metadata);const h=n.ActorRdfJoin.getRequestInitialTimes(d),v=n.ActorRdfJoin.getRequestItemTimes(d);return(0,r.passTestWithSideData)({iterations:d[0].cardinality.value*d[1].cardinality.value*d.slice(2).reduce((g,b)=>g*b.cardinality.value,1),persistedItems:0,blockingItems:0,requestTime:h[0]+d[0].cardinality.value*v[0]+h[1]+d[1].cardinality.value*v[1]+d.slice(2).reduce((g,b,_)=>g+h.slice(2)[_]+b.cardinality.value*v.slice(2)[_],0)},{...l,sortedEntries:f})}};return ActorRdfJoinMultiSmallest.ActorRdfJoinMultiSmallest=u,ActorRdfJoinMultiSmallest}var hasRequiredLib$L;function requireLib$L(){return hasRequiredLib$L||(hasRequiredLib$L=1,function(n){var t=lib$L&&lib$L.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$L&&lib$L.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMultiSmallest(),n)}(lib$L)),lib$L}var lib$K={},ActorBindingsAggregatorFactoryMax={},MaxAggregator={},hasRequiredMaxAggregator;function requireMaxAggregator(){if(hasRequiredMaxAggregator)return MaxAggregator;hasRequiredMaxAggregator=1,Object.defineProperty(MaxAggregator,"__esModule",{value:!0}),MaxAggregator.MaxAggregator=void 0;const n=requireLib$1s();let t=class extends n.AggregateEvaluator{constructor(a,o,u,s){super(a,o,s),this.orderByEvaluator=u,this.state=void 0}putTerm(a){if(a.termType!=="Literal")throw new Error(`Term with value ${a.value} has type ${a.termType} and is not a literal`);this.state===void 0?this.state=a:this.orderByEvaluator.orderTypes(this.state,a)===-1&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return MaxAggregator.MaxAggregator=t,MaxAggregator}var hasRequiredActorBindingsAggregatorFactoryMax;function requireActorBindingsAggregatorFactoryMax(){if(hasRequiredActorBindingsAggregatorFactoryMax)return ActorBindingsAggregatorFactoryMax;hasRequiredActorBindingsAggregatorFactoryMax=1,Object.defineProperty(ActorBindingsAggregatorFactoryMax,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryMax.ActorBindingsAggregatorFactoryMax=void 0;const n=requireLib$1s(),t=requireLib$4s(),r=requireMaxAggregator();let a=class extends n.ActorBindingsAggregatorFactory{constructor(u){super(u),this.mediatorTermComparatorFactory=u.mediatorTermComparatorFactory}async test(u){return u.expr.aggregator!=="max"?(0,t.failTest)("This actor only supports the 'max' aggregator."):(0,t.passTestVoid)()}async run({expr:u,context:s}){return new r.MaxAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:u.expression,context:s}),u.distinct,await this.mediatorTermComparatorFactory.mediate({context:s}))}};return ActorBindingsAggregatorFactoryMax.ActorBindingsAggregatorFactoryMax=a,ActorBindingsAggregatorFactoryMax}var hasRequiredLib$K;function requireLib$K(){return hasRequiredLib$K||(hasRequiredLib$K=1,function(n){var t=lib$K&&lib$K.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$K&&lib$K.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryMax(),n),r(requireMaxAggregator(),n)}(lib$K)),lib$K}var lib$J={},ActorBindingsAggregatorFactoryMin={},MinAggregator={},hasRequiredMinAggregator;function requireMinAggregator(){if(hasRequiredMinAggregator)return MinAggregator;hasRequiredMinAggregator=1,Object.defineProperty(MinAggregator,"__esModule",{value:!0}),MinAggregator.MinAggregator=void 0;const n=requireLib$1s();let t=class extends n.AggregateEvaluator{constructor(a,o,u,s){super(a,o,s),this.orderByEvaluator=u,this.state=void 0}putTerm(a){if(a.termType!=="Literal")throw new Error(`Term with value ${a.value} has type ${a.termType} and is not a literal`);this.state===void 0?this.state=a:this.orderByEvaluator.orderTypes(this.state,a)===1&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return MinAggregator.MinAggregator=t,MinAggregator}var hasRequiredActorBindingsAggregatorFactoryMin;function requireActorBindingsAggregatorFactoryMin(){if(hasRequiredActorBindingsAggregatorFactoryMin)return ActorBindingsAggregatorFactoryMin;hasRequiredActorBindingsAggregatorFactoryMin=1,Object.defineProperty(ActorBindingsAggregatorFactoryMin,"__esModule",{value:!0}),ActorBindingsAggregatorFactoryMin.ActorBindingsAggregatorFactoryMin=void 0;const n=requireLib$1s(),t=requireLib$4s(),r=requireMinAggregator();let a=class extends n.ActorBindingsAggregatorFactory{constructor(u){super(u),this.mediatorTermComparatorFactory=u.mediatorTermComparatorFactory}async test(u){return u.expr.aggregator!=="min"?(0,t.failTest)("This actor only supports the 'min' aggregator."):(0,t.passTestVoid)()}async run({context:u,expr:s}){return new r.MinAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:s.expression,context:u}),s.distinct,await this.mediatorTermComparatorFactory.mediate({context:u}))}};return ActorBindingsAggregatorFactoryMin.ActorBindingsAggregatorFactoryMin=a,ActorBindingsAggregatorFactoryMin}var hasRequiredLib$J;function requireLib$J(){return hasRequiredLib$J||(hasRequiredLib$J=1,function(n){var t=lib$J&&lib$J.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$J&&lib$J.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorBindingsAggregatorFactoryMin(),n),r(requireMinAggregator(),n)}(lib$J)),lib$J}var lib$I={},ActorQueryOperationOrderBy={},SortIterator={},hasRequiredSortIterator;function requireSortIterator(){if(hasRequiredSortIterator)return SortIterator;hasRequiredSortIterator=1,Object.defineProperty(SortIterator,"__esModule",{value:!0}),SortIterator.SortIterator=void 0;const n=requireAsynciterator();let t=class extends n.TransformIterator{constructor(a,o,u){super(a,u);const s=u&&u.window;this.windowLength=Number.isFinite(s)&&s>0?s:Number.POSITIVE_INFINITY,this.sort=o,this.sorted=[]}_read(a,o){let u,{length:s}=this.sorted;for(;s!==this.windowLength&&(u=this.source.read(),u!==null);){let c=0,l=s-1,d,f;for(;c<=l;)d=Math.trunc((c+l)/2),f=this.sort(u,this.sorted[d]),f<0?c=d+1:f>0?l=d-1:(c=d,l=-1);this.sorted.splice(c,0,u),s++}s===this.windowLength&&this._push(this.sorted.pop()),o()}_flush(a){let{length:o}=this.sorted;for(;o--;)this._push(this.sorted.pop());a()}};return SortIterator.SortIterator=t,SortIterator}var hasRequiredActorQueryOperationOrderBy;function requireActorQueryOperationOrderBy(){if(hasRequiredActorQueryOperationOrderBy)return ActorQueryOperationOrderBy;hasRequiredActorQueryOperationOrderBy=1,Object.defineProperty(ActorQueryOperationOrderBy,"__esModule",{value:!0}),ActorQueryOperationOrderBy.ActorQueryOperationOrderBy=void 0;const n=requireLib$4k(),t=requireLib$4s(),r=requireLib$4n(),a=requireLib$43(),o=requireSparqlalgebrajs(),u=requireSortIterator();let s=class extends n.ActorQueryOperationTypedMediated{constructor(l){super(l,"orderby"),this.window=l.window??Number.POSITIVE_INFINITY,this.mediatorExpressionEvaluatorFactory=l.mediatorExpressionEvaluatorFactory,this.mediatorTermComparatorFactory=l.mediatorTermComparatorFactory}async testOperation(){return(0,t.passTestVoid)()}async runOperation(l,d){const f=await this.mediatorQueryOperation.mediate({operation:l.input,context:d}),h=(0,a.getSafeBindings)(f),v={window:this.window};let{bindingsStream:g}=h;const b=await this.mediatorTermComparatorFactory.mediate({context:d});for(let _=l.expressions.length-1;_>=0;_--){let S=l.expressions[_];const T=this.isAscending(S);S=this.extractSortExpression(S);const w=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:S,context:d}),A=async(I,L,F)=>{try{const D=await w.evaluate(I);F({bindings:I,result:D})}catch(D){(0,r.isExpressionError)(D)||g.emit("error",D),F({bindings:I,result:void 0})}L()},R=g.transform({transform:A});g=new u.SortIterator(R,(I,L)=>{let F=b.orderTypes(I.result,L.result);return T||(F*=-1),F},v).map(({bindings:I})=>I)}return{type:"bindings",bindingsStream:g,metadata:h.metadata}}extractSortExpression(l){const{expressionType:d,operator:f}=l;return d!==o.Algebra.expressionTypes.OPERATOR?l:f==="desc"?l.args[0]:l}isAscending(l){const{expressionType:d,operator:f}=l;return d!==o.Algebra.expressionTypes.OPERATOR?!0:f!=="desc"}};return ActorQueryOperationOrderBy.ActorQueryOperationOrderBy=s,ActorQueryOperationOrderBy}var hasRequiredLib$I;function requireLib$I(){return hasRequiredLib$I||(hasRequiredLib$I=1,function(n){var t=lib$I&&lib$I.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$I&&lib$I.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationOrderBy(),n)}(lib$I)),lib$I}var lib$H={},ActorOptimizeQueryOperationFilterPushdown={},hasRequiredActorOptimizeQueryOperationFilterPushdown;function requireActorOptimizeQueryOperationFilterPushdown(){if(hasRequiredActorOptimizeQueryOperationFilterPushdown)return ActorOptimizeQueryOperationFilterPushdown;hasRequiredActorOptimizeQueryOperationFilterPushdown=1,Object.defineProperty(ActorOptimizeQueryOperationFilterPushdown,"__esModule",{value:!0}),ActorOptimizeQueryOperationFilterPushdown.ActorOptimizeQueryOperationFilterPushdown=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireRdfTerms(),u=requireSparqlalgebrajs();let s=class extends n.ActorOptimizeQueryOperation{constructor(l){super(l)}async test(l){return(0,r.passTestVoid)()}async run(l){const d=l.context.getSafe(t.KeysInitQuery.dataFactory),f=new u.Factory(d);let h=l.operation;const v=this;this.splitConjunctive&&(h=u.Util.mapOperation(h,{filter(T,w){return T.expression.expressionType===u.Algebra.expressionTypes.OPERATOR&&T.expression.operator==="&&"?(v.logDebug(l.context,`Split conjunctive filter into ${T.expression.args.length} nested filters`),{recurse:!0,result:T.expression.args.reduce((A,R)=>w.createFilter(A,R),T.input)}):{recurse:!0,result:T}}},f));const g=this.getSources(h),b=new Map(await Promise.all(g.map(async T=>[T,await T.source.getSelectorShape(l.context)])));let _=!0,S=0;for(;_&&S<this.maxIterations;)_=!1,h=u.Util.mapOperation(h,{filter(T,w){if(!v.shouldAttemptPushDown(T,g,b))return{recurse:!0,result:T};const A=v.getExpressionVariables(T.expression),[R,E]=v.filterPushdown(T.expression,A,T.input,w,l.context);return R&&(_=!0),{recurse:!0,result:E}}}),S++;return S>1&&v.logDebug(l.context,`Pushed down filters in ${S} iterations`),this.mergeConjunctive&&(h=u.Util.mapOperation(h,{filter(T,w){if(T.input.type===u.Algebra.types.FILTER){const{nestedExpressions:A,input:R}=v.getNestedFilterExpressions(T);return v.logDebug(l.context,`Merge ${A.length} nested filters into conjunctive filter`),{recurse:!0,result:w.createFilter(R,A.slice(1).reduce((E,I)=>w.createOperatorExpression("&&",[E,I]),A[0]))}}return{recurse:!0,result:T}}})),{operation:h,context:l.context}}shouldAttemptPushDown(l,d,f){if(this.aggressivePushdown)return!0;const h=l.expression;return!!(h.expressionType===u.Algebra.expressionTypes.OPERATOR&&h.operator==="="&&(h.args[0].expressionType==="term"&&h.args[0].term.termType!=="Variable"&&h.args[1].expressionType==="term"&&h.args[1].term.termType==="Variable"||h.args[0].expressionType==="term"&&h.args[0].term.termType==="Variable"&&h.args[1].expressionType==="term"&&h.args[1].term.termType!=="Variable")||d.some(v=>(0,a.doesShapeAcceptOperation)(f.get(v),l)))}getSources(l){const d=new Set,f=h=>{const v=(0,a.getOperationSource)(h);return v&&d.add(v),!1};return u.Util.recurseOperation(l,{[u.Algebra.types.PATTERN]:f,[u.Algebra.types.LINK]:f,[u.Algebra.types.NPS]:f,[u.Algebra.types.SERVICE]:f}),[...d]}getExpressionVariables(l){switch(l.expressionType){case u.Algebra.expressionTypes.AGGREGATE:case u.Algebra.expressionTypes.WILDCARD:throw new Error(`Getting expression variables is not supported for ${l.expressionType}`);case u.Algebra.expressionTypes.EXISTENCE:return u.Util.inScopeVariables(l.input);case u.Algebra.expressionTypes.NAMED:return[];case u.Algebra.expressionTypes.OPERATOR:return(0,o.uniqTerms)(l.args.flatMap(d=>this.getExpressionVariables(d)));case u.Algebra.expressionTypes.TERM:return l.term.termType==="Variable"?[l.term]:[]}}getOverlappingOperations(l,d){const f=[],h=[],v=[];for(const g of l.input){const b=u.Util.inScopeVariables(g);this.variablesSubSetOf(d,b)?f.push(g):this.variablesIntersect(d,b)?h.push(g):v.push(g)}return{fullyOverlapping:f,partiallyOverlapping:h,notOverlapping:v}}filterPushdown(l,d,f,h,v){if(this.isExpressionFalse(l))return[!0,h.createUnion([])];if(l.type===u.Algebra.types.EXPRESSION&&l.expressionType===u.Algebra.expressionTypes.EXISTENCE)return[!1,h.createFilter(f,l)];switch(f.type){case u.Algebra.types.EXTEND:return this.variablesIntersect([f.variable],d)?[!1,h.createFilter(f,l)]:[!0,h.createExtend(this.filterPushdown(l,d,f.input,h,v)[1],f.variable,f.expression)];case u.Algebra.types.FILTER:{const[g,b]=this.filterPushdown(l,d,f.input,h,v);return[g,h.createFilter(b,f.expression)]}case u.Algebra.types.JOIN:{if(f.input.length===0)return[!1,h.createFilter(f,l)];const{fullyOverlapping:g,partiallyOverlapping:b,notOverlapping:_}=this.getOverlappingOperations(f,d),S=[];let T=!1;return g.length>0&&(T=!0,S.push(h.createJoin(g.map(w=>this.filterPushdown(l,d,w,h,v)[1])))),b.length>0&&S.push(h.createFilter(h.createJoin(b,!1),l)),_.length>0&&S.push(..._),S.length>1&&(T=!0),T&&this.logDebug(v,`Push down filter across join entries with ${g.length} fully overlapping, ${b.length} partially overlapping, and ${_.length} not overlapping`),[T,S.length===1?S[0]:h.createJoin(S)]}case u.Algebra.types.NOP:return[!0,f];case u.Algebra.types.PROJECT:return this.variablesIntersect(f.variables,d)?[!0,h.createProject(this.filterPushdown(l,d,f.input,h,v)[1],f.variables)]:[!0,f];case u.Algebra.types.UNION:{const{fullyOverlapping:g,partiallyOverlapping:b,notOverlapping:_}=this.getOverlappingOperations(f,d),S=[];let T=!1;return g.length>0&&(T=!0,S.push(h.createUnion(g.map(w=>this.filterPushdown(l,d,w,h,v)[1])))),b.length>0&&S.push(h.createFilter(h.createUnion(b,!1),l)),_.length>0&&S.push(..._),S.length>1&&(T=!0),T&&this.logDebug(v,`Push down filter across union entries with ${g.length} fully overlapping, ${b.length} partially overlapping, and ${_.length} not overlapping`),[T,S.length===1?S[0]:h.createUnion(S)]}case u.Algebra.types.VALUES:return this.variablesIntersect(f.variables,d)?[!1,h.createFilter(f,l)]:[!0,f];case u.Algebra.types.LEFT_JOIN:{if(this.pushIntoLeftJoins){const g=u.Util.inScopeVariables(f.input[1]);if(!this.variablesIntersect(d,g))return this.logDebug(v,"Push down filter into left join"),[!0,h.createLeftJoin(this.filterPushdown(l,d,f.input[0],h,v)[1],f.input[1],f.expression)]}return[!1,h.createFilter(f,l)]}case u.Algebra.types.PATTERN:{if(this.pushEqualityIntoPatterns){const g=this.getEqualityExpressionPushableIntoPattern(l);if(g){let b=!1;const _=f.metadata;if(f=(0,o.mapTermsNested)(f,S=>S.equals(g.variable)?(b=!0,g.term):S),f.type=u.Algebra.types.PATTERN,f.metadata=_,b)return this.logDebug(v,`Push down filter into pattern for ?${g.variable.value}`),[!0,h.createJoin([f,h.createValues([g.variable],[{[`?${g.variable.value}`]:g.term}])])]}}return[!1,h.createFilter(f,l)]}case u.Algebra.types.PATH:{if(this.pushEqualityIntoPatterns){const g=this.getEqualityExpressionPushableIntoPattern(l);if(g&&(f.subject.equals(g.variable)||f.object.equals(g.variable))){this.logDebug(v,`Push down filter into path for ?${g.variable.value}`);const b=f.metadata;return f=h.createPath(f.subject.equals(g.variable)?g.term:f.subject,f.predicate,f.object.equals(g.variable)?g.term:f.object),f.metadata=b,[!0,h.createJoin([f,h.createValues([g.variable],[{[`?${g.variable.value}`]:g.term}])])]}}return[!1,h.createFilter(f,l)]}case u.Algebra.types.MINUS:case u.Algebra.types.ALT:case u.Algebra.types.ASK:case u.Algebra.types.BGP:case u.Algebra.types.CONSTRUCT:case u.Algebra.types.DESCRIBE:case u.Algebra.types.DISTINCT:case u.Algebra.types.EXPRESSION:case u.Algebra.types.FROM:case u.Algebra.types.GRAPH:case u.Algebra.types.GROUP:case u.Algebra.types.INV:case u.Algebra.types.LINK:case u.Algebra.types.NPS:case u.Algebra.types.ONE_OR_MORE_PATH:case u.Algebra.types.ORDER_BY:case u.Algebra.types.REDUCED:case u.Algebra.types.SEQ:case u.Algebra.types.SERVICE:case u.Algebra.types.SLICE:case u.Algebra.types.ZERO_OR_MORE_PATH:case u.Algebra.types.ZERO_OR_ONE_PATH:case u.Algebra.types.COMPOSITE_UPDATE:case u.Algebra.types.DELETE_INSERT:case u.Algebra.types.LOAD:case u.Algebra.types.CLEAR:case u.Algebra.types.CREATE:case u.Algebra.types.DROP:case u.Algebra.types.ADD:case u.Algebra.types.MOVE:case u.Algebra.types.COPY:return[!1,h.createFilter(f,l)]}}getEqualityExpressionPushableIntoPattern(l){if(l.expressionType===u.Algebra.expressionTypes.OPERATOR&&l.operator==="="){if(l.args[0].expressionType==="term"&&l.args[0].term.termType!=="Variable"&&(l.args[0].term.termType!=="Literal"||this.isLiteralWithCanonicalLexicalForm(l.args[0].term))&&l.args[1].expressionType==="term"&&l.args[1].term.termType==="Variable")return{variable:l.args[1].term,term:l.args[0].term};if(l.args[0].expressionType==="term"&&l.args[0].term.termType==="Variable"&&l.args[1].expressionType==="term"&&l.args[1].term.termType!=="Variable"&&(l.args[1].term.termType!=="Literal"||this.isLiteralWithCanonicalLexicalForm(l.args[1].term)))return{variable:l.args[0].term,term:l.args[1].term}}}isLiteralWithCanonicalLexicalForm(l){if(l.termType==="Literal")switch(l.datatype.value){case"http://www.w3.org/2001/XMLSchema#string":case"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":case"http://www.w3.org/2001/XMLSchema#normalizedString":case"http://www.w3.org/2001/XMLSchema#anyURI":case"http://www.w3.org/2001/XMLSchema#base64Binary":case"http://www.w3.org/2001/XMLSchema#language":case"http://www.w3.org/2001/XMLSchema#Name":case"http://www.w3.org/2001/XMLSchema#NCName":case"http://www.w3.org/2001/XMLSchema#NMTOKEN":case"http://www.w3.org/2001/XMLSchema#token":case"http://www.w3.org/2001/XMLSchema#hexBinary":return!0}return!1}variablesIntersect(l,d){return l.some(f=>d.some(h=>f.equals(h)))}variablesSubSetOf(l,d){return l.length<=d.length&&l.every(f=>d.some(h=>f.equals(h)))}isExpressionFalse(l){return l.term&&l.term.termType==="Literal"&&l.term.value==="false"}getNestedFilterExpressions(l){if(l.input.type===u.Algebra.types.FILTER){const d=this.getNestedFilterExpressions(l.input);return{nestedExpressions:[l.expression,...d.nestedExpressions],input:d.input}}return{nestedExpressions:[l.expression],input:l.input}}};return ActorOptimizeQueryOperationFilterPushdown.ActorOptimizeQueryOperationFilterPushdown=s,ActorOptimizeQueryOperationFilterPushdown}var hasRequiredLib$H;function requireLib$H(){return hasRequiredLib$H||(hasRequiredLib$H=1,function(n){var t=lib$H&&lib$H.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$H&&lib$H.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationFilterPushdown(),n)}(lib$H)),lib$H}var lib$G={},ActorDereferenceHttpBrowser={},ActorDereferenceHttpBase={},hasRequiredActorDereferenceHttpBase;function requireActorDereferenceHttpBase(){if(hasRequiredActorDereferenceHttpBase)return ActorDereferenceHttpBase;hasRequiredActorDereferenceHttpBase=1,Object.defineProperty(ActorDereferenceHttpBase,"__esModule",{value:!0}),ActorDereferenceHttpBase.ActorDereferenceHttpBase=ActorDereferenceHttpBase.mediaTypesToAcceptString=void 0;const n=requireLib$3O(),t=requireLib$1O(),r=requireLib$4s(),a=requireDist$3(),o=requireRelativeToAbsoluteIri(),u=/^[^ ;]*/u;function s(l,d){const f="*/*;q=0.1",h=[],v=Object.entries(l).map(([b,_])=>({mediaType:b,priority:_})).sort((b,_)=>_.priority===b.priority?b.mediaType.localeCompare(_.mediaType):_.priority-b.priority);let g=v.length-1;for(const{mediaType:b,priority:_}of v){const S=b+(_===1?"":`;q=${_.toFixed(3).replace(/0*$/u,"")}`);if(g+S.length>d){for(;g+f.length>d;){const T=h.pop()??"";g-=T.length+1}h.push(f);break}h.push(S),g+=S.length}return h.length===0?"*/*":h.join(",")}ActorDereferenceHttpBase.mediaTypesToAcceptString=s;let c=class extends n.ActorDereference{constructor(d){super(d)}async test({url:d}){return/^https?:/u.test(d)?(0,r.passTestVoid)():(0,r.failTest)(`Cannot retrieve ${d} because it is not an HTTP(S) URL.`)}async run(d){var T,w;let f=!0;const h=new Headers(d.headers);h.append("Accept",s(await((T=d.mediaTypes)==null?void 0:T.call(d))??{},this.getMaxAcceptHeaderLength()));let v;const g=Date.now();try{v=await this.mediatorHttp.mediate({context:d.context,init:{headers:h,method:d.method},input:d.url})}catch(A){return this.handleDereferenceErrors(d,A)}const b=(0,o.resolve)(v.url,d.url),_=Date.now()-g;if(v.status!==200){f=!1;const A=v.body?await(0,a.stringify)(t.ActorHttp.toNodeReadable(v.body)):"empty response";if(!d.acceptErrors){const R=new Error(`Could not retrieve ${d.url} (HTTP status ${v.status}):
${A}`);return this.handleDereferenceErrors(d,R,v.headers,_)}}const S=(w=u.exec(v.headers.get("content-type")??""))==null?void 0:w[0];return{url:b,data:f?t.ActorHttp.toNodeReadable(v.body):(0,n.emptyReadable)(),exists:f,requestTime:_,headers:v.headers,mediaType:S==="text/plain"?void 0:S}}};return ActorDereferenceHttpBase.ActorDereferenceHttpBase=c,ActorDereferenceHttpBase}var hasRequiredActorDereferenceHttpBrowser;function requireActorDereferenceHttpBrowser(){if(hasRequiredActorDereferenceHttpBrowser)return ActorDereferenceHttpBrowser;hasRequiredActorDereferenceHttpBrowser=1,Object.defineProperty(ActorDereferenceHttpBrowser,"__esModule",{value:!0}),ActorDereferenceHttpBrowser.ActorDereferenceHttp=void 0;const n=requireActorDereferenceHttpBase();class t extends n.ActorDereferenceHttpBase{getMaxAcceptHeaderLength(){return this.maxAcceptHeaderLengthBrowser}}return ActorDereferenceHttpBrowser.ActorDereferenceHttp=t,ActorDereferenceHttpBrowser}var hasRequiredLib$G;function requireLib$G(){return hasRequiredLib$G||(hasRequiredLib$G=1,function(n){var t=lib$G&&lib$G.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$G&&lib$G.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorDereferenceHttpBrowser(),n),r(requireActorDereferenceHttpBase(),n)}(lib$G)),lib$G}var lib$F={},ActorHttpProxy={},hasRequiredActorHttpProxy;function requireActorHttpProxy(){if(hasRequiredActorHttpProxy)return ActorHttpProxy;hasRequiredActorHttpProxy=1,Object.defineProperty(ActorHttpProxy,"__esModule",{value:!0}),ActorHttpProxy.ActorHttpProxy=void 0;const n=requireLib$1O(),t=requireLib$4q(),r=requireLib$4s();let a=class extends n.ActorHttp{constructor(u){super(u)}async test(u){const s=u.context.get(t.KeysHttpProxy.httpProxyHandler);return s?await s.getProxy(u)?(0,r.passTest)({time:Number.POSITIVE_INFINITY}):(0,r.failTest)(`Actor ${this.name} could not determine a proxy for the given request.`):(0,r.failTest)(`Actor ${this.name} could not find a proxy handler in the context.`)}async run(u){const s=typeof u.input=="string"?u.input:u.input.url,c=u.context.get(t.KeysHttpProxy.httpProxyHandler),l=await this.mediatorHttp.mediate({...await c.getProxy(u),context:u.context.delete(t.KeysHttpProxy.httpProxyHandler)});return Object.defineProperty(l,"url",{configurable:!0,enumerable:!0,get:()=>l.headers.get("x-final-url")??s}),l}};return ActorHttpProxy.ActorHttpProxy=a,ActorHttpProxy}var ProxyHandlerStatic={},hasRequiredProxyHandlerStatic;function requireProxyHandlerStatic(){if(hasRequiredProxyHandlerStatic)return ProxyHandlerStatic;hasRequiredProxyHandlerStatic=1,Object.defineProperty(ProxyHandlerStatic,"__esModule",{value:!0}),ProxyHandlerStatic.ProxyHandlerStatic=void 0;let n=class{constructor(r){this.prefixUrl=r}async getProxy(r){return{init:r.init,input:this.modifyInput(r.input)}}modifyInput(r){return typeof r=="string"?this.prefixUrl+r:new Request(this.prefixUrl+r.url,r)}};return ProxyHandlerStatic.ProxyHandlerStatic=n,ProxyHandlerStatic}var hasRequiredLib$F;function requireLib$F(){return hasRequiredLib$F||(hasRequiredLib$F=1,function(n){var t=lib$F&&lib$F.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$F&&lib$F.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttpProxy(),n),r(requireProxyHandlerStatic(),n)}(lib$F)),lib$F}var lib$E={},ActorContextPreprocessQuerySourceIdentify={},hasRequiredActorContextPreprocessQuerySourceIdentify;function requireActorContextPreprocessQuerySourceIdentify(){if(hasRequiredActorContextPreprocessQuerySourceIdentify)return ActorContextPreprocessQuerySourceIdentify;hasRequiredActorContextPreprocessQuerySourceIdentify=1,Object.defineProperty(ActorContextPreprocessQuerySourceIdentify,"__esModule",{value:!0}),ActorContextPreprocessQuerySourceIdentify.ActorContextPreprocessQuerySourceIdentify=void 0;const n=requireLib$4j(),t=requireLib$4q(),r=requireLib$4s(),a=requireCommonjs$1();let o=class extends n.ActorContextPreprocess{constructor(s){super(s),this.cache=this.cacheSize?new a.LRUCache({max:this.cacheSize}):void 0;const c=this.cache;c&&this.httpInvalidator.addInvalidateListener(({url:l})=>l?c.delete(l):c.clear())}async test(s){return(0,r.passTestVoid)()}async run(s){let c=s.context;if(c.has(t.KeysInitQuery.querySourcesUnidentified)){const l=s.context.get(t.KeysInitQuery.querySourcesUnidentified),d=await Promise.all(l.map(v=>this.expandSource(v))),f=await Promise.all(d.map(async v=>this.identifySource(v,s.context))),h=s.context.get(t.KeysStatistics.dereferencedLinks);if(h)for(const v of f)h.updateStatistic({url:v.source.referenceValue,metadata:{seed:!0}},v.source);c=s.context.delete(t.KeysInitQuery.querySourcesUnidentified).set(t.KeysQueryOperation.querySources,f)}return{context:c}}async expandSource(s){return typeof s=="string"||"match"in s?{value:s}:{...s,context:(await this.mediatorContextPreprocess.mediate({context:r.ActionContext.ensureActionContext(s.context??{})})).context}}identifySource(s,c){let l;return typeof s.value=="string"&&this.cache&&(l=this.cache.get(s.value)),l||(l=this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:s,context:c}).then(({querySource:d})=>d),typeof s.value=="string"&&this.cache&&this.cache.set(s.value,l)),l}};return ActorContextPreprocessQuerySourceIdentify.ActorContextPreprocessQuerySourceIdentify=o,ActorContextPreprocessQuerySourceIdentify}var hasRequiredLib$E;function requireLib$E(){return hasRequiredLib$E||(hasRequiredLib$E=1,function(n){var t=lib$E&&lib$E.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$E&&lib$E.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorContextPreprocessQuerySourceIdentify(),n)}(lib$E)),lib$E}var lib$D={},ActorRdfUpdateQuadsHypermedia={},hasRequiredActorRdfUpdateQuadsHypermedia;function requireActorRdfUpdateQuadsHypermedia(){if(hasRequiredActorRdfUpdateQuadsHypermedia)return ActorRdfUpdateQuadsHypermedia;hasRequiredActorRdfUpdateQuadsHypermedia=1,Object.defineProperty(ActorRdfUpdateQuadsHypermedia,"__esModule",{value:!0}),ActorRdfUpdateQuadsHypermedia.ActorRdfUpdateQuadsHypermedia=void 0;const n=requireLib$33(),t=requireLib$4s(),r=requireCommonjs$1();let a=class extends n.ActorRdfUpdateQuadsDestination{constructor(u){super(u),this.cache=this.cacheSize?new r.LRUCache({max:this.cacheSize}):void 0;const s=this.cache;s&&this.httpInvalidator.addInvalidateListener(({url:c})=>c?s.delete(c):s.clear())}async test(u){return(0,n.getContextDestinationUrl)((0,n.getContextDestination)(u.context))?(0,t.passTestVoid)():(0,t.failTest)(`Actor ${this.name} can only update quads against a single destination URL.`)}getDestination(u){const s=(0,n.getContextDestination)(u);let c=(0,n.getContextDestinationUrl)(s);if(this.cache&&this.cache.has(c))return this.cache.get(c);const l=(async()=>{var v;let d,f;try{const g=await this.mediatorDereferenceRdf.mediate({context:u,url:c,acceptErrors:!0});f=g.exists,c=g.url;const b=await this.mediatorMetadata.mediate({context:u,url:c,quads:g.data,triples:(v=g.metadata)==null?void 0:v.triples});d=(await this.mediatorMetadataExtract.mediate({context:u,url:c,metadata:b.metadata,headers:g.headers,requestTime:g.requestTime})).metadata}catch{d={},f=!1}const{destination:h}=await this.mediatorRdfUpdateHypermedia.mediate({context:u,url:c,metadata:d,exists:f,forceDestinationType:(0,n.getDataDestinationType)(s)});return h})();return this.cache&&this.cache.set(c,l),l}};return ActorRdfUpdateQuadsHypermedia.ActorRdfUpdateQuadsHypermedia=a,ActorRdfUpdateQuadsHypermedia}var hasRequiredLib$D;function requireLib$D(){return hasRequiredLib$D||(hasRequiredLib$D=1,function(n){var t=lib$D&&lib$D.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$D&&lib$D.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfUpdateQuadsHypermedia(),n)}(lib$D)),lib$D}var lib$C={},ActionObserverHttp$1={},hasRequiredActionObserverHttp$1;function requireActionObserverHttp$1(){if(hasRequiredActionObserverHttp$1)return ActionObserverHttp$1;hasRequiredActionObserverHttp$1=1,Object.defineProperty(ActionObserverHttp$1,"__esModule",{value:!0}),ActionObserverHttp$1.ActionObserverHttp=void 0;const n=requireLib$4s();class t extends n.ActionObserver{constructor(a){super(a),this.requests=0,this.bus.subscribeObserver(this),this.httpInvalidator.addInvalidateListener(()=>{this.requests=0})}onRun(a,o,u){this.requests++}}return ActionObserverHttp$1.ActionObserverHttp=t,ActionObserverHttp$1}var ActorQueryResultSerializeSparqlJson={},hasRequiredActorQueryResultSerializeSparqlJson;function requireActorQueryResultSerializeSparqlJson(){if(hasRequiredActorQueryResultSerializeSparqlJson)return ActorQueryResultSerializeSparqlJson;hasRequiredActorQueryResultSerializeSparqlJson=1,Object.defineProperty(ActorQueryResultSerializeSparqlJson,"__esModule",{value:!0}),ActorQueryResultSerializeSparqlJson.ActorQueryResultSerializeSparqlJson=void 0;const n=requireLib$3Y(),t=requireLib$4s(),r=requireAsynciterator(),a=requireBrowser();let o=class sn extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(s){super(s)}static bindingToJsonBindings(s){if(s.termType==="Literal"){const c=s,l={value:c.value,type:"literal"},{language:d,datatype:f}=c;return d?l["xml:lang"]=d:f&&f.value!=="http://www.w3.org/2001/XMLSchema#string"&&(l.datatype=f.value),l}return s.termType==="BlankNode"?{value:s.value,type:"bnode"}:s.termType==="Quad"?{value:{subject:sn.bindingToJsonBindings(s.subject),predicate:sn.bindingToJsonBindings(s.predicate),object:sn.bindingToJsonBindings(s.object)},type:"triple"}:{value:s.value,type:"uri"}}async testHandleChecked(s,c){return["bindings","boolean"].includes(s.type)?(0,t.passTestVoid)():(0,t.failTest)("This actor can only handle bindings streams or booleans.")}async runHandle(s,c,l){const d=new a.Readable,f={};if(s.type==="bindings"){const h=await s.metadata();h.variables.length>0&&(f.vars=h.variables.map(v=>v.variable.value))}if(d.push(`{"head": ${JSON.stringify(f)},
`),s.type==="bindings"){const h=s.bindingsStream;d.push(`"results": { "bindings": [
`);let v=!0;function*g(b){yield b()}d.wrap((0,r.wrap)(h).map(b=>{const _=`${v?"":`,
`}${JSON.stringify(Object.fromEntries([...b].map(([S,T])=>[S.value,sn.bindingToJsonBindings(T)])))}`;return v=!1,_}).append((0,r.wrap)(g(()=>`
]}${this.emitMetadata?`,
"metadata": { "httpRequests": ${this.httpObserver.requests} }`:""}}
`))))}else d.wrap((0,r.wrap)(s.execute().then(h=>[`"boolean":${h}
}
`])));return{data:d}}};return ActorQueryResultSerializeSparqlJson.ActorQueryResultSerializeSparqlJson=o,ActorQueryResultSerializeSparqlJson}var hasRequiredLib$C;function requireLib$C(){return hasRequiredLib$C||(hasRequiredLib$C=1,function(n){var t=lib$C&&lib$C.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$C&&lib$C.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActionObserverHttp$1(),n),r(requireActorQueryResultSerializeSparqlJson(),n)}(lib$C)),lib$C}var lib$B={},ActionObserverHttp={},hasRequiredActionObserverHttp;function requireActionObserverHttp(){if(hasRequiredActionObserverHttp)return ActionObserverHttp;hasRequiredActionObserverHttp=1,Object.defineProperty(ActionObserverHttp,"__esModule",{value:!0}),ActionObserverHttp.ActionObserverHttp=void 0;const n=requireLib$4s();let t=class extends n.ActionObserver{constructor(a){super(a),this.requests=0,this.bus.subscribeObserver(this),this.httpInvalidator.addInvalidateListener(()=>{this.requests=0})}onRun(a,o,u){this.requests++}};return ActionObserverHttp.ActionObserverHttp=t,ActionObserverHttp}var ActorQueryResultSerializeStats={},hasRequiredActorQueryResultSerializeStats;function requireActorQueryResultSerializeStats(){if(hasRequiredActorQueryResultSerializeStats)return ActorQueryResultSerializeStats;hasRequiredActorQueryResultSerializeStats=1,Object.defineProperty(ActorQueryResultSerializeStats,"__esModule",{value:!0}),ActorQueryResultSerializeStats.ActorQueryResultSerializeStats=void 0;const n=requireLib$3Y(),t=requireLib$4q(),r=requireLib$4s(),a=requireAsynciterator(),o=requireBrowser();let u=class extends n.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c)}async testHandleChecked(c,l){return["bindings","quads"].includes(c.type)?(0,r.passTestVoid)():(0,r.failTest)("This actor can only handle bindings streams or quad streams.")}pushHeader(c){const l=["Result","Delay (ms)","HTTP requests"].join(",");c.push(`${l}
`)}createStat(c,l){return`${[l,this.delay(c),this.httpObserver.requests].join(",")}
`}createSpecialLine(c,l){return`${[c,this.delay(l),this.httpObserver.requests].join(",")}
`}async runHandle(c,l,d){const f=new o.Readable,h=c.type==="bindings"?c.bindingsStream:c.quadStream,v=c.context.getSafe(t.KeysInitQuery.queryTimestampHighResolution);let g=1;function*b(S){yield S()}const _=(0,a.wrap)(h).map(()=>this.createStat(v,g++)).prepend([this.createSpecialLine("PLANNING",v)]).append((0,a.wrap)(b(()=>this.createSpecialLine("TOTAL",v))));return this.pushHeader(f),f.wrap(_),{data:f}}now(){return performance.now()}delay(c){return this.now()-c}};return ActorQueryResultSerializeStats.ActorQueryResultSerializeStats=u,ActorQueryResultSerializeStats}var hasRequiredLib$B;function requireLib$B(){return hasRequiredLib$B||(hasRequiredLib$B=1,function(n){var t=lib$B&&lib$B.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$B&&lib$B.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActionObserverHttp(),n),r(requireActorQueryResultSerializeStats(),n)}(lib$B)),lib$B}var lib$A={},ActorQuerySourceIdentifyHypermediaQpf={},lib$z={},ActorQuerySourceIdentifyHypermedia$1={},hasRequiredActorQuerySourceIdentifyHypermedia$1;function requireActorQuerySourceIdentifyHypermedia$1(){if(hasRequiredActorQuerySourceIdentifyHypermedia$1)return ActorQuerySourceIdentifyHypermedia$1;hasRequiredActorQuerySourceIdentifyHypermedia$1=1,Object.defineProperty(ActorQuerySourceIdentifyHypermedia$1,"__esModule",{value:!0}),ActorQuerySourceIdentifyHypermedia$1.ActorQuerySourceIdentifyHypermedia=void 0;const n=requireLib$4s();class t extends n.Actor{constructor(a,o){super(a),this.sourceType=o}async test(a){return a.forceSourceType&&this.sourceType!==a.forceSourceType?(0,n.failTest)(`Actor ${this.name} is not able to handle source type ${a.forceSourceType}.`):this.testMetadata(a)}}return ActorQuerySourceIdentifyHypermedia$1.ActorQuerySourceIdentifyHypermedia=t,ActorQuerySourceIdentifyHypermedia$1}var hasRequiredLib$A;function requireLib$A(){return hasRequiredLib$A||(hasRequiredLib$A=1,function(n){var t=lib$z&&lib$z.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$z&&lib$z.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyHypermedia$1(),n)}(lib$z)),lib$z}var QuerySourceQpf={},lib$y={},ActorQuerySourceIdentify={},hasRequiredActorQuerySourceIdentify;function requireActorQuerySourceIdentify(){if(hasRequiredActorQuerySourceIdentify)return ActorQuerySourceIdentify;hasRequiredActorQuerySourceIdentify=1,Object.defineProperty(ActorQuerySourceIdentify,"__esModule",{value:!0}),ActorQuerySourceIdentify.ActorQuerySourceIdentify=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorQuerySourceIdentify.ActorQuerySourceIdentify=t,ActorQuerySourceIdentify}var Utils={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return Utils;hasRequiredUtils=1,Object.defineProperty(Utils,"__esModule",{value:!0}),Utils.filterMatchingQuotedQuads=Utils.quadsOrderToBindingsOrder=Utils.quadsMetadataToBindingsMetadata=Utils.setMetadata=Utils.getDuplicateElementLinks=Utils.getVariables=Utils.isTermVariable=Utils.quadsToBindings=void 0;const n=requireLib$1I(),t=requireLib$4l(),r=requireRdfString(),a=requireRdfTerms(),o=requireQuadTermUtil();function u(g,b,_,S,T){const w=c(b),A=b.graph.termType==="Variable"&&!T,R=l(b),E=(0,a.reduceTermsNested)(b,(F,D,$)=>(D.termType==="Variable"&&(F[$.join("_")]=D.value),F),{});let I=g;A&&(I=I.filter(F=>F.graph.termType!=="DefaultGraph")),R&&(I=I.filter(F=>{for(const D in R){const $=D.split("_"),O=(0,a.getValueNestedPath)(F,$);for(const P of R[D])if(!O.equals((0,a.getValueNestedPath)(F,P)))return!1}return!0}));const L=new n.ClosableIterator(I.map(F=>S.bindings(Object.keys(E).map(D=>{const $=D.split("_"),O=E[D],P=(0,a.getValueNestedPath)(F,$);return[_.variable(O),P]}))),{onClose:()=>g.destroy()});return d(_,L,g,E,w,A||!!R),L}Utils.quadsToBindings=u;function s(g){return g.termType==="Variable"}Utils.isTermVariable=s;function c(g){return(0,a.uniqTerms)((0,a.getTermsNested)(g).filter(s))}Utils.getVariables=c;function l(g){const b={};let _=!1;if((0,a.forEachTermsNested)(g,(T,w)=>{if(T.termType==="Variable"){const A=(0,r.termToString)(T),R=(b[A]||(b[A]=[])).push(w);_=_||R>1}}),!_)return;const S={};for(const T in b){const w=b[T],A=w.slice(1);A.length>0&&(S[w[0].join("_")]=A)}return S}Utils.getDuplicateElementLinks=l;function d(g,b,_,S,T,w){const A=E=>{w&&(E.cardinality.type="estimate"),b.setProperty("metadata",f(g,(0,t.validateMetadataQuads)(E),S,T)),E.state&&E.state.addInvalidateListener(()=>{d(g,b,_,S,T,w)})},R=_.getProperty("metadata");R?A(R):_.getProperty("metadata",A)}Utils.setMetadata=d;function f(g,b,_,S){return{...b,order:b.order?h(g,b.order,_):void 0,availableOrders:b.availableOrders?b.availableOrders.map(T=>({cost:T.cost,terms:h(g,T.terms,_)})):void 0,variables:S.map(T=>({variable:T,canBeUndef:!1}))}}Utils.quadsMetadataToBindingsMetadata=f;function h(g,b,_){const S={};return b.map(T=>{const w=_[T.term];if(w&&!S[w])return S[w]=!0,{term:g.variable(w),direction:T.direction}}).filter(Boolean)}Utils.quadsOrderToBindingsOrder=h;function v(g,b){return(0,a.someTerms)(g,_=>_.termType==="Quad")&&(b=b.filter(_=>(0,o.matchPatternMappings)(_,g))),b}return Utils.filterMatchingQuotedQuads=v,Utils}var hasRequiredLib$z;function requireLib$z(){return hasRequiredLib$z||(hasRequiredLib$z=1,function(n){var t=lib$y&&lib$y.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$y&&lib$y.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentify(),n),r(requireUtils(),n)}(lib$y)),lib$y}var hasRequiredQuerySourceQpf;function requireQuerySourceQpf(){if(hasRequiredQuerySourceQpf)return QuerySourceQpf;hasRequiredQuerySourceQpf=1,Object.defineProperty(QuerySourceQpf,"__esModule",{value:!0}),QuerySourceQpf.QuerySourceQpf=void 0;const n=requireLib$z(),t=requireLib$4q(),r=requireLib$4l(),a=requireAsynciterator(),o=requireRdfString(),u=requireRdfStringTtl(),s=requireRdfTerms();let c=class{constructor(f,h,v,g,b,_,S,T,w,A,R,E,I,L){if(this.referenceValue=R,this.mediatorMetadata=f,this.mediatorMetadataExtract=h,this.mediatorDereferenceRdf=v,this.dataFactory=g,this.algebraFactory=b,this.bindingsFactory=_,this.subjectUri=S,this.predicateUri=T,this.objectUri=w,this.graphUri=A,this.url=R,this.bindingsRestricted=I,this.cachedQuads={},this.searchForm=this.getSearchForm(E),this.defaultGraph=E.defaultGraph?this.dataFactory.namedNode(E.defaultGraph):void 0,L){let F=(0,a.wrap)(L);this.defaultGraph&&(F=this.reverseMapQuadsToDefaultGraph(F)),E={...E,state:new r.MetadataValidationState},F.setProperty("metadata",E),this.cacheQuads(F,this.dataFactory.variable(""),this.dataFactory.variable(""),this.dataFactory.variable(""),this.dataFactory.variable(""))}this.selectorShape=this.bindingsRestricted?{type:"operation",operation:{operationType:"pattern",pattern:this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")],filterBindings:!0}:{type:"operation",operation:{operationType:"pattern",pattern:this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")]}}async getSelectorShape(){return this.selectorShape}queryBindings(f,h,v){if(f.type!=="pattern")throw new Error(`Attempted to pass non-pattern operation '${f.type}' to QuerySourceQpf`);const g=!!h.get(t.KeysQueryOperation.unionDefaultGraph);let b=this.match(f.subject,f.predicate,f.object,f.graph,g,h,v);return b=(0,n.filterMatchingQuotedQuads)(f,b),(0,n.quadsToBindings)(b,f,this.dataFactory,this.bindingsFactory,g)}getSearchForm(f){if(!f.searchForms||!f.searchForms.values)return;const{searchForms:h}=f;for(const v of h.values)if(this.graphUri&&this.subjectUri in v.mappings&&this.predicateUri in v.mappings&&this.objectUri in v.mappings&&this.graphUri in v.mappings&&Object.keys(v.mappings).length===4||this.subjectUri in v.mappings&&this.predicateUri in v.mappings&&this.objectUri in v.mappings&&Object.keys(v.mappings).length===3)return v}createFragmentUri(f,h,v,g,b){const _={},S=[{uri:this.subjectUri,term:h},{uri:this.predicateUri,term:v},{uri:this.objectUri,term:g},{uri:this.graphUri,term:b}];for(const T of S)T.uri&&(this.bindingsRestricted||T.term.termType!=="Variable"&&(T.term.termType!=="Quad"||(0,s.everyTermsNested)(T.term,w=>w.termType!=="Variable")))&&(_[T.uri]=(0,o.termToString)(T.term));return f.getUri(_)}match(f,h,v,g,b,_,S){let T=!1;if(g.termType==="DefaultGraph")if(this.defaultGraph)T=!0,g=this.defaultGraph;else if(Object.keys(this.searchForm.mappings).length===4&&!this.defaultGraph)if(b)g=this.dataFactory.variable("g");else{const E=new a.ArrayIterator([],{autoStart:!1});return E.setProperty("metadata",{state:new r.MetadataValidationState,requestTime:0,cardinality:{type:"exact",value:0},first:null,next:null,last:null}),E}else Object.keys(this.searchForm.mappings).length===3&&(g=this.dataFactory.variable("g"));if(!(S!=null&&S.filterBindings)){const E=this.getCachedQuads(f,h,v,g);if(E)return E}const w=this;let A;const R=async function(){var D;let E=w.createFragmentUri(w.searchForm,f,h,v,g);S!=null&&S.filterBindings&&(E=await w.getBindingsRestrictedLink(f,h,v,g,E,S.filterBindings));const I=await w.mediatorDereferenceRdf.mediate({context:_,url:E});E=I.url;const L=await w.mediatorMetadata.mediate({context:_,url:E,quads:I.data,triples:(D=I.metadata)==null?void 0:D.triples}),{metadata:F}=await w.mediatorMetadataExtract.mediate({context:_,url:E,metadata:L.metadata,requestTime:I.requestTime});return A.setProperty("metadata",{...F,state:new r.MetadataValidationState,subsetOf:w.url}),L.data}();return A=new a.TransformIterator(async()=>{const E=await R,I=this.dataFactory.defaultGraph();let L=(0,a.wrap)(E).transform({filter(F){return(0,s.matchPattern)(F,f,h,v,g)?!0:T&&(0,s.matchPattern)(F,f,h,v,I)}});return(T||g.termType==="Variable")&&(L=this.reverseMapQuadsToDefaultGraph(L)),L},{autoStart:!1}),S!=null&&S.filterBindings?A:(this.cacheQuads(A,f,h,v,g),this.getCachedQuads(f,h,v,g))}async getBindingsRestrictedLink(f,h,v,g,b,_){const S=[];for(const w of await _.bindings.toArray()){const A=["("];for(const R of _.metadata.variables){const E=w.get(R.variable);A.push(E?(0,u.termToString)(E):"UNDEF"),A.push(" ")}A.push(")"),S.push(A.join(""))}S.length===0&&S.push("(<ex:comunica:unknown>)");const T=encodeURIComponent(`(${_.metadata.variables.map(w=>`?${w.variable.value}`).join(" ")}) { ${S.join(" ")} }`);return`${b}&values=${T}`}reverseMapQuadsToDefaultGraph(f){const h=this.dataFactory.defaultGraph();return f.map(v=>(0,s.mapTerms)(v,(g,b)=>b==="graph"&&g.equals(this.defaultGraph)?h:g))}getPatternId(f,h,v,g){return JSON.stringify({s:f.termType==="Variable"?"":l(f),p:h.termType==="Variable"?"":l(h),o:v.termType==="Variable"?"":l(v),g:g.termType==="Variable"?"":l(g)})}cacheQuads(f,h,v,g,b){const _=this.getPatternId(h,v,g,b);this.cachedQuads[_]=f.clone()}getCachedQuads(f,h,v,g){const b=this.getPatternId(f,h,v,g),_=this.cachedQuads[b];if(_)return _.clone()}queryQuads(f,h){throw new Error("queryQuads is not implemented in QuerySourceQpf")}queryBoolean(f,h){throw new Error("queryBoolean is not implemented in QuerySourceQpf")}queryVoid(f,h){throw new Error("queryVoid is not implemented in QuerySourceQpf")}};QuerySourceQpf.QuerySourceQpf=c;function l(d){return d.termType==="DefaultGraph"?"|":(0,o.termToString)(d)}return QuerySourceQpf}var hasRequiredActorQuerySourceIdentifyHypermediaQpf;function requireActorQuerySourceIdentifyHypermediaQpf(){if(hasRequiredActorQuerySourceIdentifyHypermediaQpf)return ActorQuerySourceIdentifyHypermediaQpf;hasRequiredActorQuerySourceIdentifyHypermediaQpf=1,Object.defineProperty(ActorQuerySourceIdentifyHypermediaQpf,"__esModule",{value:!0}),ActorQuerySourceIdentifyHypermediaQpf.ActorQuerySourceIdentifyHypermediaQpf=void 0;const n=requireLib$A(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireSparqlalgebrajs(),u=requireQuerySourceQpf();let s=class extends n.ActorQuerySourceIdentifyHypermedia{constructor(l){super(l,"qpf")}async test(l){return l.forceSourceType&&l.forceSourceType!=="qpf"&&l.forceSourceType!=="brtpf"?(0,r.failTest)(`Actor ${this.name} is not able to handle source type ${l.forceSourceType}.`):this.testMetadata(l)}async testMetadata(l){const{searchForm:d}=await this.createSource(l.url,l.metadata,l.context,l.forceSourceType==="brtpf");return d?l.handledDatasets&&l.handledDatasets[d.dataset]?(0,r.failTest)(`Actor ${this.name} can only be applied for the first page of a QPF dataset.`):(0,r.passTest)({filterFactor:1}):(0,r.failTest)("Illegal state: found no TPF/QPF search form anymore in metadata.")}async run(l){this.logInfo(l.context,`Identified as qpf source: ${l.url}`);const d=await this.createSource(l.url,l.metadata,l.context,l.forceSourceType==="brtpf",l.quads);return{source:d,dataset:d.searchForm.dataset}}async createSource(l,d,f,h,v){const g=f.getSafe(t.KeysInitQuery.dataFactory),b=new o.Factory(g);return new u.QuerySourceQpf(this.mediatorMetadata,this.mediatorMetadataExtract,this.mediatorDereferenceRdf,g,b,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,f,g),this.subjectUri,this.predicateUri,this.objectUri,this.graphUri,l,d,h,v)}};return ActorQuerySourceIdentifyHypermediaQpf.ActorQuerySourceIdentifyHypermediaQpf=s,ActorQuerySourceIdentifyHypermediaQpf}var hasRequiredLib$y;function requireLib$y(){return hasRequiredLib$y||(hasRequiredLib$y=1,function(n){var t=lib$A&&lib$A.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$A&&lib$A.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyHypermediaQpf(),n),r(requireQuerySourceQpf(),n)}(lib$A)),lib$A}var lib$x={},ActorQuerySourceIdentifyHypermediaSparql={},QuerySourceSparql={},hasRequiredQuerySourceSparql;function requireQuerySourceSparql(){if(hasRequiredQuerySourceSparql)return QuerySourceSparql;hasRequiredQuerySourceSparql=1,Object.defineProperty(QuerySourceSparql,"__esModule",{value:!0}),QuerySourceSparql.QuerySourceSparql=void 0;const n=requireLib$4q(),t=requireLib$4s(),r=requireLib$4l(),a=requireAsynciterator(),o=requireFetchSparqlEndpoint(),u=requireCommonjs$1(),s=requireRdfTerms(),c=requireSparqlalgebrajs(),l={type:"estimate",value:Number.POSITIVE_INFINITY};let d=class Wt{constructor(h,v,g,b,_,S,T,w,A,R){this.referenceValue=h,this.url=h,this.context=v,this.mediatorHttp=g,this.bindMethod=b,this.dataFactory=_,this.algebraFactory=S,this.bindingsFactory=T,this.endpointFetcher=new o.SparqlEndpointFetcher({method:w?"GET":"POST",fetch:(E,I)=>this.mediatorHttp.mediate({input:E,init:I,context:this.lastSourceContext}),prefixVariableQuestionMark:!0,dataFactory:_}),this.cache=A>0?new u.LRUCache({max:A}):void 0,this.countTimeout=R}async getSelectorShape(){return Wt.SELECTOR_SHAPE}queryBindings(h,v,g){let b;g!=null&&g.joinBindings?b=Wt.addBindingsToOperation(this.algebraFactory,this.bindMethod,h,g.joinBindings):b=Promise.resolve(h);const _=new a.TransformIterator(async()=>{const S=await b,T=c.Util.inScopeVariables(S),w=v.get(n.KeysInitQuery.queryString),A=!(g!=null&&g.joinBindings)&&w?w:Wt.operationToSelectQuery(this.algebraFactory,S,T),R=Wt.getOperationUndefs(S);return this.queryBindingsRemote(this.url,A,T,v,R)},{autoStart:!1});return this.attachMetadata(_,v,b),_}queryQuads(h,v){this.lastSourceContext=this.context.merge(v);const g=this.endpointFetcher.fetchTriples(this.url,v.get(n.KeysInitQuery.queryString)??Wt.operationToQuery(h));this.lastSourceContext=void 0;const b=(0,a.wrap)(g,{autoStart:!1,maxBufferSize:Number.POSITIVE_INFINITY});return this.attachMetadata(b,v,Promise.resolve(h.input)),b}queryBoolean(h,v){this.lastSourceContext=this.context.merge(v);const g=this.endpointFetcher.fetchAsk(this.url,v.get(n.KeysInitQuery.queryString)??Wt.operationToQuery(h));return this.lastSourceContext=void 0,g}queryVoid(h,v){this.lastSourceContext=this.context.merge(v);const g=this.endpointFetcher.fetchUpdate(this.url,v.get(n.KeysInitQuery.queryString)??Wt.operationToQuery(h));return this.lastSourceContext=void 0,g}attachMetadata(h,v,g){let b=[];new Promise(async(_,S)=>{var w;let T;try{const A=await g,R=c.Util.inScopeVariables(A);T=Wt.operationToCountQuery(this.dataFactory,this.algebraFactory,A);const E=Wt.getOperationUndefs(A);b=R.map($=>({variable:$,canBeUndef:E.some(O=>O.equals($))}));const I=(w=this.cache)==null?void 0:w.get(T);if(I!==void 0)return _(I);const L=setTimeout(()=>_(l),this.countTimeout),F=this.dataFactory.variable("count"),D=await this.queryBindingsRemote(this.url,T,[F],v,[]);D.on("data",$=>{var C;clearTimeout(L);const O=$.get(F),P={type:"estimate",value:Number.POSITIVE_INFINITY};if(O){const q=Number.parseInt(O.value,10);Number.isNaN(q)||(P.type="exact",P.value=q,(C=this.cache)==null||C.set(T,P))}return _(P)}),D.on("error",()=>{clearTimeout(L),_(l)}),D.on("end",()=>{clearTimeout(L),_(l)})}catch(A){return S(A)}}).then(_=>{h.setProperty("metadata",{state:new r.MetadataValidationState,cardinality:_,variables:b})}).catch(()=>h.setProperty("metadata",{state:new r.MetadataValidationState,cardinality:l,variables:b}))}static async addBindingsToOperation(h,v,g,b){const _=await b.bindings.toArray();switch(v){case"values":return h.createJoin([h.createValues(b.metadata.variables.map(S=>S.variable),_.map(S=>Object.fromEntries([...S].map(([T,w])=>[`?${T.value}`,w])))),g],!1);case"union":throw new Error('Not implemented yet: "union" case');case"filter":throw new Error('Not implemented yet: "filter" case')}}static operationToSelectQuery(h,v,g){return Wt.operationToQuery(h.createProject(v,g))}static operationToCountQuery(h,v,g){return Wt.operationToQuery(v.createProject(v.createExtend(v.createGroup(g,[],[v.createBoundAggregate(h.variable("var0"),"count",v.createWildcardExpression(),!1)]),h.variable("count"),v.createTermExpression(h.variable("var0"))),[h.variable("count")]))}static operationToQuery(h){return(0,c.toSparql)(h,{sparqlStar:!0})}static getOperationUndefs(h){const v=[];return c.Util.recurseOperation(h,{leftjoin(g){const b=c.Util.inScopeVariables(g.input[0]),_=c.Util.inScopeVariables(g.input[1]);for(const S of _)b.some(T=>T.equals(S))||v.push(S);return!1},values(g){for(const b of g.variables)g.bindings.some(_=>!(`?${b.value}`in _))&&v.push(b);return!1},union(g){const b=g.input.map(c.Util.inScopeVariables);for(const _ of(0,s.uniqTerms)(b.flat()))b.every(S=>S.some(T=>T.equals(_)))||v.push(_);return!0}}),(0,s.uniqTerms)(v)}async queryBindingsRemote(h,v,g,b,_){const S=new Set;for(const w of _)S.add(w.value);this.lastSourceContext=this.context.merge(b);const T=await this.endpointFetcher.fetchBindings(h,v);return this.lastSourceContext=void 0,(0,a.wrap)(T,{autoStart:!1,maxBufferSize:Number.POSITIVE_INFINITY}).map(w=>this.bindingsFactory.bindings(g.map(A=>{var E;const R=w[`?${A.value}`];return!S.has(A.value)&&!R&&((E=t.Actor.getContextLogger(this.context))==null||E.warn(`The endpoint ${h} failed to provide a binding for ${A.value}.`)),[A,R]}).filter(([A,R])=>!!R)))}toString(){return`QuerySourceSparql(${this.url})`}};return QuerySourceSparql.QuerySourceSparql=d,d.SELECTOR_SHAPE={type:"disjunction",children:[{type:"operation",operation:{operationType:"wildcard"},joinBindings:!0}]},QuerySourceSparql}var hasRequiredActorQuerySourceIdentifyHypermediaSparql;function requireActorQuerySourceIdentifyHypermediaSparql(){if(hasRequiredActorQuerySourceIdentifyHypermediaSparql)return ActorQuerySourceIdentifyHypermediaSparql;hasRequiredActorQuerySourceIdentifyHypermediaSparql=1,Object.defineProperty(ActorQuerySourceIdentifyHypermediaSparql,"__esModule",{value:!0}),ActorQuerySourceIdentifyHypermediaSparql.ActorQuerySourceIdentifyHypermediaSparql=void 0;const n=requireLib$A(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireSparqlalgebrajs(),u=requireQuerySourceSparql();let s=class extends n.ActorQuerySourceIdentifyHypermedia{constructor(l){super(l,"sparql")}async testMetadata(l){return!l.forceSourceType&&!l.metadata.sparqlService&&!(this.checkUrlSuffix&&l.url.endsWith("/sparql"))?(0,r.failTest)(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql.`):(0,r.passTest)({filterFactor:1})}async run(l){this.logInfo(l.context,`Identified ${l.url} as sparql source with service URL: ${l.metadata.sparqlService||l.url}`);const d=l.context.getSafe(t.KeysInitQuery.dataFactory),f=new o.Factory(d);return{source:new u.QuerySourceSparql(l.forceSourceType?l.url:l.metadata.sparqlService||l.url,l.context,this.mediatorHttp,this.bindMethod,d,f,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,l.context,d),this.forceHttpGet,this.cacheSize,this.countTimeout)}}};return ActorQuerySourceIdentifyHypermediaSparql.ActorQuerySourceIdentifyHypermediaSparql=s,ActorQuerySourceIdentifyHypermediaSparql}var hasRequiredLib$x;function requireLib$x(){return hasRequiredLib$x||(hasRequiredLib$x=1,function(n){var t=lib$x&&lib$x.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$x&&lib$x.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyHypermediaSparql(),n),r(requireQuerySourceSparql(),n)}(lib$x)),lib$x}var lib$w={},ActorQuerySourceIdentifyHypermediaNone={},lib$v={},ActorQuerySourceIdentifyRdfJs={},QuerySourceRdfJs={},hasRequiredQuerySourceRdfJs;function requireQuerySourceRdfJs(){if(hasRequiredQuerySourceRdfJs)return QuerySourceRdfJs;hasRequiredQuerySourceRdfJs=1,Object.defineProperty(QuerySourceRdfJs,"__esModule",{value:!0}),QuerySourceRdfJs.QuerySourceRdfJs=void 0;const n=requireLib$z(),t=requireLib$4q(),r=requireLib$4l(),a=requireAsynciterator(),o=requireRdfTerms(),u=requireSparqlalgebrajs();let s=class zt{constructor(l,d,f){this.source=l,this.referenceValue=l,this.dataFactory=d,this.bindingsFactory=f;const h=new u.Factory(this.dataFactory);this.selectorShape={type:"operation",operation:{operationType:"pattern",pattern:h.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o")]}}static nullifyVariables(l,d){return!l||l.termType==="Variable"||!d&&l.termType==="Quad"&&(0,o.someTermsNested)(l,f=>f.termType==="Variable")?void 0:l}static hasDuplicateVariables(l){const d=(0,o.filterTermsNested)(l,f=>f.termType==="Variable");return d.length>1&&(0,o.uniqTerms)(d).length<d.length}async getSelectorShape(){return this.selectorShape}queryBindings(l,d){var g;if(l.type!=="pattern")throw new Error(`Attempted to pass non-pattern operation '${l.type}' to QuerySourceRdfJs`);const f=!!((g=this.source.features)!=null&&g.quotedTripleFiltering),h=this.source.match(zt.nullifyVariables(l.subject,f),zt.nullifyVariables(l.predicate,f),zt.nullifyVariables(l.object,f),zt.nullifyVariables(l.graph,f));let v=h instanceof a.AsyncIterator?h:(0,a.wrap)(h,{autoStart:!1});return f||(v=(0,n.filterMatchingQuotedQuads)(l,v)),v.getProperty("metadata")||this.setMetadata(v,l).catch(b=>v.destroy(b)),(0,n.quadsToBindings)(v,l,this.dataFactory,this.bindingsFactory,!!d.get(t.KeysQueryOperation.unionDefaultGraph))}async setMetadata(l,d){var g;const f=!!((g=this.source.features)!=null&&g.quotedTripleFiltering);let h;if(this.source.countQuads)h=await this.source.countQuads(zt.nullifyVariables(d.subject,f),zt.nullifyVariables(d.predicate,f),zt.nullifyVariables(d.object,f),zt.nullifyVariables(d.graph,f));else{let b=0;h=await new Promise((_,S)=>{const T=this.source.match(zt.nullifyVariables(d.subject,f),zt.nullifyVariables(d.predicate,f),zt.nullifyVariables(d.object,f),zt.nullifyVariables(d.graph,f));T.on("error",S),T.on("end",()=>_(b)),T.on("data",()=>b++)})}const v=!f&&(0,o.someTerms)(d,b=>b.termType==="Quad")||zt.hasDuplicateVariables(d);l.setProperty("metadata",{state:new r.MetadataValidationState,cardinality:{type:v?"estimate":"exact",value:h}})}queryQuads(l,d){throw new Error("queryQuads is not implemented in QuerySourceRdfJs")}queryBoolean(l,d){throw new Error("queryBoolean is not implemented in QuerySourceRdfJs")}queryVoid(l,d){throw new Error("queryVoid is not implemented in QuerySourceRdfJs")}toString(){return`QuerySourceRdfJs(${this.source.constructor.name})`}};return QuerySourceRdfJs.QuerySourceRdfJs=s,QuerySourceRdfJs}var hasRequiredActorQuerySourceIdentifyRdfJs;function requireActorQuerySourceIdentifyRdfJs(){if(hasRequiredActorQuerySourceIdentifyRdfJs)return ActorQuerySourceIdentifyRdfJs;hasRequiredActorQuerySourceIdentifyRdfJs=1,Object.defineProperty(ActorQuerySourceIdentifyRdfJs,"__esModule",{value:!0}),ActorQuerySourceIdentifyRdfJs.ActorQuerySourceIdentifyRdfJs=void 0;const n=requireLib$z(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireQuerySourceRdfJs();let u=class extends n.ActorQuerySourceIdentify{constructor(c){super(c)}async test(c){const l=c.querySourceUnidentified;return l.type!==void 0&&l.type!=="rdfjs"?(0,r.failTest)(`${this.name} requires a single query source with rdfjs type to be present in the context.`):typeof l.value=="string"||!("match"in l.value)?(0,r.failTest)(`${this.name} received an invalid rdfjs query source.`):(0,r.passTestVoid)()}async run(c){const l=c.context.getSafe(t.KeysInitQuery.dataFactory);return{querySource:{source:new o.QuerySourceRdfJs(c.querySourceUnidentified.value,l,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,c.context,l)),context:c.querySourceUnidentified.context??new r.ActionContext}}}};return ActorQuerySourceIdentifyRdfJs.ActorQuerySourceIdentifyRdfJs=u,ActorQuerySourceIdentifyRdfJs}var IRdfJsSourceExtended={},hasRequiredIRdfJsSourceExtended;function requireIRdfJsSourceExtended(){return hasRequiredIRdfJsSourceExtended||(hasRequiredIRdfJsSourceExtended=1,Object.defineProperty(IRdfJsSourceExtended,"__esModule",{value:!0})),IRdfJsSourceExtended}var hasRequiredLib$w;function requireLib$w(){return hasRequiredLib$w||(hasRequiredLib$w=1,function(n){var t=lib$v&&lib$v.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$v&&lib$v.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyRdfJs(),n),r(requireIRdfJsSourceExtended(),n),r(requireQuerySourceRdfJs(),n)}(lib$v)),lib$v}var rdfStoreStream={},rdfStores={},DatasetCoreWrapper={},RdfStore={},TermDictionaryNumberRecordFullTerms={},hasRequiredTermDictionaryNumberRecordFullTerms;function requireTermDictionaryNumberRecordFullTerms(){if(hasRequiredTermDictionaryNumberRecordFullTerms)return TermDictionaryNumberRecordFullTerms;hasRequiredTermDictionaryNumberRecordFullTerms=1,Object.defineProperty(TermDictionaryNumberRecordFullTerms,"__esModule",{value:!0}),TermDictionaryNumberRecordFullTerms.TermDictionaryNumberRecordFullTerms=void 0;const n=requireRdfDataFactory(),t=requireRdfString();let r=class{constructor(o=new n.DataFactory){this.lastId=0,this.dictionary={},this.reverseDictionary={},this.features={quotedTriples:!1},this.dataFactory=o}encode(o){const u=(0,t.termToString)(o);let s=this.dictionary[u];return s===void 0&&(s=this.lastId++,this.dictionary[u]=s,this.reverseDictionary[s]=o),s}encodeOptional(o){const u=(0,t.termToString)(o);return this.dictionary[u]}decode(o){const u=this.reverseDictionary[o];if(u===void 0)throw new Error(`The value ${o} is not present in this dictionary`);return u}*encodings(){for(const o of Object.keys(this.reverseDictionary))yield Number.parseInt(o,10)}findQuotedTriples(o){throw new Error("findQuotedTriples is not supported")}findQuotedTriplesEncoded(o){throw new Error("findQuotedTriplesEncoded is not supported")}};return TermDictionaryNumberRecordFullTerms.TermDictionaryNumberRecordFullTerms=r,TermDictionaryNumberRecordFullTerms}var TermDictionaryQuotedIndexed={},RdfStoreIndexNestedMap={},OrderUtils={},hasRequiredOrderUtils;function requireOrderUtils(){return hasRequiredOrderUtils||(hasRequiredOrderUtils=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.arePatternsQuoted=n.quadHasVariables=n.quadToPattern=n.encodeOptionalTerms=n.orderQuadComponents=n.getComponentOrderScore=n.getBestIndex=n.QUAD_TERM_NAMES_INVERSE=void 0;const t=requireRdfTerms();n.QUAD_TERM_NAMES_INVERSE=Object.fromEntries(t.QUAD_TERM_NAMES.map((d,f)=>[d,f]));function r(d,f){if(d.length===1||f.every(g=>g!==void 0))return 0;const h=[];for(let g=0;g<t.QUAD_TERM_NAMES.length;g++)f[g]&&h.push(t.QUAD_TERM_NAMES[g]);return d.map((g,b)=>({score:a(g,h),index:b})).sort((g,b)=>b.score-g.score)[0].index}n.getBestIndex=r;function a(d,f){return d.map((h,v)=>f.includes(h)?d.length-v:0).reduce((h,v)=>h+v,0)}n.getComponentOrderScore=a;function o(d,f){return d.map(h=>{const v=n.QUAD_TERM_NAMES_INVERSE[h];return f[v]})}n.orderQuadComponents=o;function u(d,f){const h=d.map(v=>{if(v){if(v.termType==="Quad"&&c(v))return;const g=f.encodeOptional(v);return g===void 0?"none":g}return v});if(!h.includes("none"))return h}n.encodeOptionalTerms=u;function s(d,f,h,v,g){let b=!1;return[[d||void 0,f||void 0,h||void 0,v||void 0].map(S=>{if(S){if(S.termType==="Variable")return;if(S.termType==="Quad"){if(g)return S;b=!0;return}}return S}),b]}n.quadToPattern=s;function c(d){for(const f of t.QUAD_TERM_NAMES){const h=d[f];if(h.termType==="Variable"||h.termType==="Quad"&&c(h))return!0}return!1}n.quadHasVariables=c;function l(d){return d.map(f=>(f==null?void 0:f.termType)==="Quad"&&c(f))}n.arePatternsQuoted=l}(OrderUtils)),OrderUtils}var hasRequiredRdfStoreIndexNestedMap;function requireRdfStoreIndexNestedMap(){if(hasRequiredRdfStoreIndexNestedMap)return RdfStoreIndexNestedMap;hasRequiredRdfStoreIndexNestedMap=1,Object.defineProperty(RdfStoreIndexNestedMap,"__esModule",{value:!0}),RdfStoreIndexNestedMap.RdfStoreIndexNestedMap=void 0;const n=requireOrderUtils();let t=class{constructor(a){this.features={quotedTripleFiltering:!1},this.dictionary=a.dictionary,this.nestedMap=new Map}set(a,o){const u=this.nestedMap;let s=u.get(a[0]);s||(s=new Map,u.set(a[0],s));let c=s.get(a[1]);c||(c=new Map,s.set(a[1],c));let l=c.get(a[2]);l||(l=new Map,c.set(a[2],l));const d=l.has(a[3]);return d||l.set(a[3],o),!d}remove(a){const o=this.nestedMap,u=o.get(a[0]);if(!u)return!1;const s=u.get(a[1]);if(!s)return!1;const c=s.get(a[2]);if(!c)return!1;const l=c.delete(a[3]);return l&&c.size===0&&(s.delete(a[2]),s.size===0&&(u.delete(a[1]),u.size===0&&o.delete(a[0]))),l}get(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!(!o||o.includes(void 0)))return this.getEncoded(o)}getEncoded(a){const o=this.nestedMap.get(a[0]);if(!o)return;const u=o.get(a[1]);if(!u)return;const s=u.get(a[2]);if(s)return s.get(a[3])}*find(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!o)return;const[u,s,c,l]=o,[d,f,h,v]=a;let g,b,_,S,T,w,A;const R=this.nestedMap,E=u!==void 0?R.has(u)?[u]:[]:R.keys();for(const I of E){T=R.get(I),g=d||this.dictionary.decode(I);const L=s!==void 0?T.has(s)?[s]:[]:T.keys();for(const F of L){w=T.get(F),b=f||this.dictionary.decode(F);const D=c!==void 0?w.has(c)?[c]:[]:w.keys();for(const $ of D){A=w.get($),_=h||this.dictionary.decode($);const O=l!==void 0?A.has(l)?[l]:[]:A.keys();for(const P of O)S=v||this.dictionary.decode(P),yield[g,b,_,S]}}}}*findEncoded(a,o){const[u,s,c,l]=a;let d,f,h;const v=this.nestedMap,g=u!==void 0?v.has(u)?[u]:[]:v.keys();for(const b of g){d=v.get(b);const _=s!==void 0?d.has(s)?[s]:[]:d.keys();for(const S of _){f=d.get(S);const T=c!==void 0?f.has(c)?[c]:[]:f.keys();for(const w of T){h=f.get(w);const A=l!==void 0?h.has(l)?[l]:[]:h.keys();for(const R of A)yield[b,S,w,R]}}}}count(a){let o=0;const u=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!u)return 0;const s=u[0],c=u[1],l=u[2],d=u[3];let f,h,v;const g=this.nestedMap,b=s!==void 0?g.has(s)?[s]:[]:g.keys();for(const _ of b){f=g.get(_);const S=c!==void 0?f.has(c)?[c]:[]:f.keys();for(const T of S){h=f.get(T);const w=l!==void 0?h.has(l)?[l]:[]:h.keys();for(const A of w)v=h.get(A),d!==void 0?v.has(d)&&o++:o+=v.size}}return o}};return RdfStoreIndexNestedMap.RdfStoreIndexNestedMap=t,RdfStoreIndexNestedMap}var hasRequiredTermDictionaryQuotedIndexed;function requireTermDictionaryQuotedIndexed(){if(hasRequiredTermDictionaryQuotedIndexed)return TermDictionaryQuotedIndexed;hasRequiredTermDictionaryQuotedIndexed=1,Object.defineProperty(TermDictionaryQuotedIndexed,"__esModule",{value:!0}),TermDictionaryQuotedIndexed.TermDictionaryQuotedIndexed=void 0;const n=requireRdfDataFactory(),t=requireRdfStoreIndexNestedMap(),r=requireOrderUtils();let a=class sr{constructor(u,s=new n.DataFactory){this.quotedTriplesDictionary=[],this.features={quotedTriples:!0},this.plainTermDictionary=u;const c={indexCombinations:[],indexConstructor:void 0,dictionary:this,dataFactory:s};this.quotedTriplesReverseDictionaries=[new t.RdfStoreIndexNestedMap(c),new t.RdfStoreIndexNestedMap(c),new t.RdfStoreIndexNestedMap(c)],this.dataFactory=s}encode(u){return u.termType==="Quad"?this.encodeQuotedTriple(u,!1):this.plainTermDictionary.encode(u)}encodeQuotedTriple(u,s){if(u.graph.termType!=="DefaultGraph")throw new Error("Encoding of quoted quads outside of the default graph is not allowed");const c=(0,r.encodeOptionalTerms)([u.subject,u.predicate,u.object,u.graph],this),l=c&&c.every(v=>v!==void 0)?this.quotedTriplesReverseDictionaries[0].getEncoded(c):void 0;if(l!==void 0||s)return l===void 0?void 0:sr.BITMASK|l;const d=[this.encode(u.subject),this.encode(u.predicate),this.encode(u.object)],f=this.quotedTriplesDictionary.length+1;this.quotedTriplesDictionary.push(d);const h=this.encode(this.dataFactory.defaultGraph());return this.quotedTriplesReverseDictionaries[0].set([d[0],d[1],d[2],h],f),this.quotedTriplesReverseDictionaries[1].set([d[1],d[2],d[0],h],f),this.quotedTriplesReverseDictionaries[2].set([d[2],d[0],d[1],h],f),sr.BITMASK|f}encodeOptional(u){return u.termType==="Quad"?this.encodeQuotedTriple(u,!0):this.plainTermDictionary.encodeOptional(u)}decode(u){if(sr.BITMASK&u){const s=(~sr.BITMASK&u)-1;if(s>=this.quotedTriplesDictionary.length)throw new Error(`The value ${u} is not present in the quoted triples range of the dictionary`);const c=this.quotedTriplesDictionary[s];return this.dataFactory.quad(this.decode(c[0]),this.decode(c[1]),this.decode(c[2]))}return this.plainTermDictionary.decode(u)}*encodings(){for(const u of this.plainTermDictionary.encodings())yield u;for(const u of this.quotedTriplesDictionary.keys())yield sr.BITMASK|1+u}*findQuotedTriples(u){for(const s of this.findQuotedTriplesEncoded(u))yield this.decode(s)}*findQuotedTriplesEncoded(u){const[s,c]=(0,r.quadToPattern)(u.subject,u.predicate,u.object,u.graph,!0);for(const l of this.patternToIterable(s[0]))for(const d of this.patternToIterable(s[1]))for(const f of this.patternToIterable(s[2]))for(const h of this.patternToIterable(s[3]))if(l&&d||!d&&!f){const v=[l,d,f,h];for(const g of this.quotedTriplesReverseDictionaries[0].findEncoded(v,s))yield sr.BITMASK|this.quotedTriplesReverseDictionaries[0].getEncoded(g)}else if(!l&&d){const v=[d,f,l,h];for(const g of this.quotedTriplesReverseDictionaries[1].findEncoded(v,s))yield sr.BITMASK|this.quotedTriplesReverseDictionaries[1].getEncoded(g)}else{const v=[f,l,d,h];for(const g of this.quotedTriplesReverseDictionaries[2].findEncoded(v,s))yield sr.BITMASK|this.quotedTriplesReverseDictionaries[2].getEncoded(g)}}*patternToIterable(u){if((u==null?void 0:u.termType)==="Quad"){yield*this.findQuotedTriplesEncoded(u);return}if(u===void 0){yield void 0;return}const s=this.encodeOptional(u);s!==void 0&&(yield s)}};return a.BITMASK=1<<31,TermDictionaryQuotedIndexed.TermDictionaryQuotedIndexed=a,TermDictionaryQuotedIndexed}var RdfStoreIndexNestedMapQuoted={},hasRequiredRdfStoreIndexNestedMapQuoted;function requireRdfStoreIndexNestedMapQuoted(){if(hasRequiredRdfStoreIndexNestedMapQuoted)return RdfStoreIndexNestedMapQuoted;hasRequiredRdfStoreIndexNestedMapQuoted=1,Object.defineProperty(RdfStoreIndexNestedMapQuoted,"__esModule",{value:!0}),RdfStoreIndexNestedMapQuoted.RdfStoreIndexNestedMapQuoted=void 0;const n=requireOrderUtils(),t=requireRdfStoreIndexNestedMap();let r=class extends t.RdfStoreIndexNestedMap{constructor(o){super(o),this.features={quotedTripleFiltering:!0}}*getQuotedPatternKeys(o,u){for(const s of this.dictionary.findQuotedTriplesEncoded(u))o.has(s)&&(yield s)}*find(o){const u=(0,n.encodeOptionalTerms)(o,this.dictionary);if(!u)return;const[s,c,l,d]=u,[f,h,v,g]=o,[b,_,S,T]=(0,n.arePatternsQuoted)(o);let w,A,R,E,I,L,F;const D=this.nestedMap,$=f!==void 0?b?this.getQuotedPatternKeys(D,f):D.has(s)?[s]:[]:D.keys();for(const O of $){I=D.get(O),w=!b&&f?f:this.dictionary.decode(O);const P=h!==void 0?_?this.getQuotedPatternKeys(I,h):I.has(c)?[c]:[]:I.keys();for(const C of P){L=I.get(C),A=!_&&h?h:this.dictionary.decode(C);const q=v!==void 0?S?this.getQuotedPatternKeys(L,v):L.has(l)?[l]:[]:L.keys();for(const M of q){F=L.get(M),R=!S&&v?v:this.dictionary.decode(M);const N=g!==void 0?T?this.getQuotedPatternKeys(F,g):F.has(d)?[d]:[]:F.keys();for(const G of N)E=!T&&g?g:this.dictionary.decode(G),yield[w,A,R,E]}}}}*findEncoded(o,u){const[s,c,l,d]=o,[f,h,v,g]=u,[b,_,S,T]=(0,n.arePatternsQuoted)(u);let w,A,R;const E=this.nestedMap,I=f!==void 0?b?this.getQuotedPatternKeys(E,f):E.has(s)?[s]:[]:E.keys();for(const L of I){w=E.get(L);const F=h!==void 0?_?this.getQuotedPatternKeys(w,h):w.has(c)?[c]:[]:w.keys();for(const D of F){A=w.get(D);const $=v!==void 0?S?this.getQuotedPatternKeys(A,v):A.has(l)?[l]:[]:A.keys();for(const O of $){R=A.get(O);const P=g!==void 0?T?this.getQuotedPatternKeys(R,g):R.has(d)?[d]:[]:R.keys();for(const C of P)yield[Number.parseInt(L,10),Number.parseInt(D,10),Number.parseInt(O,10),Number.parseInt(C,10)]}}}}count(o){let u=0;const s=(0,n.encodeOptionalTerms)(o,this.dictionary);if(!s)return 0;const[c,l,d,f]=s,[h,v,g,b]=o,[_,S,T,w]=(0,n.arePatternsQuoted)(o);let A,R,E;const I=this.nestedMap,L=h!==void 0?_?this.getQuotedPatternKeys(I,h):I.has(c)?[c]:[]:I.keys();for(const F of L){A=I.get(F);const D=v!==void 0?S?this.getQuotedPatternKeys(A,v):A.has(l)?[l]:[]:A.keys();for(const $ of D){R=A.get($);const O=g!==void 0?T?this.getQuotedPatternKeys(R,g):R.has(d)?[d]:[]:R.keys();for(const P of O)E=R.get(P),b!==void 0?w?u+=[...this.getQuotedPatternKeys(E,b)].length:E.has(f)&&u++:u+=E.size}}return u}};return RdfStoreIndexNestedMapQuoted.RdfStoreIndexNestedMapQuoted=r,RdfStoreIndexNestedMapQuoted}var hasRequiredRdfStore;function requireRdfStore(){if(hasRequiredRdfStore)return RdfStore;hasRequiredRdfStore=1,Object.defineProperty(RdfStore,"__esModule",{value:!0}),RdfStore.RdfStore=void 0;const n=requireAsynciterator(),t=requireRdfDataFactory(),r=requireRdfTerms(),a=requireDatasetCoreWrapper(),o=requireTermDictionaryNumberRecordFullTerms(),u=requireTermDictionaryQuotedIndexed(),s=requireRdfStoreIndexNestedMapQuoted(),c=requireOrderUtils();let l=class cn{constructor(f){this.features={quotedTripleFiltering:!0},this._size=0,this.options=f,this.dataFactory=f.dataFactory,this.dictionary=f.dictionary,this.indexesWrapped=cn.constructIndexesWrapped(f),this.indexesWrappedComponentOrders=this.indexesWrapped.map(h=>h.componentOrder)}static createDefault(){return new cn({indexCombinations:cn.DEFAULT_INDEX_COMBINATIONS,indexConstructor:f=>new s.RdfStoreIndexNestedMapQuoted(f),dictionary:new u.TermDictionaryQuotedIndexed(new o.TermDictionaryNumberRecordFullTerms),dataFactory:new t.DataFactory})}static constructIndexesWrapped(f){const h=[];if(f.indexCombinations.length===0)throw new Error("At least one index combination is required");for(const v of f.indexCombinations){if(!cn.isCombinationValid(v))throw new Error(`Invalid index combination: ${v}`);h.push({index:f.indexConstructor(f),componentOrder:v,componentOrderInverse:Object.fromEntries(v.map((g,b)=>[g,b]))})}return h}static isCombinationValid(f){for(const h of r.QUAD_TERM_NAMES)if(!f.includes(h))return!1;return f.length===4}get size(){return this._size}addQuad(f){const h=[this.dictionary.encode(f.subject),this.dictionary.encode(f.predicate),this.dictionary.encode(f.object),this.dictionary.encode(f.graph)];let v=!1;for(const g of this.indexesWrapped)v=g.index.set((0,c.orderQuadComponents)(g.componentOrder,h),!0);return v?(this._size++,!0):!1}removeQuad(f){const h=[this.dictionary.encodeOptional(f.subject),this.dictionary.encodeOptional(f.predicate),this.dictionary.encodeOptional(f.object),this.dictionary.encodeOptional(f.graph)];if(h.includes(void 0))return!1;let v=!1;for(const g of this.indexesWrapped)if(v=g.index.remove((0,c.orderQuadComponents)(g.componentOrder,h)),!v)break;return v?(this._size--,!0):!1}remove(f){return f.on("data",h=>this.removeQuad(h)),f}removeMatches(f,h,v,g){return this.remove(this.match(f,h,v,g))}deleteGraph(f){return typeof f=="string"&&(f=this.dataFactory.namedNode(f)),this.removeMatches(void 0,void 0,void 0,f)}import(f){return f.on("data",h=>this.addQuad(h)),f}*readQuads(f,h,v,g){const b=!!this.dictionary.features.quotedTriples&&Object.values(this.indexesWrapped).every(A=>A.index.features.quotedTripleFiltering),[_,S]=(0,c.quadToPattern)(f,h,v,g,b),T=this.indexesWrapped[(0,c.getBestIndex)(this.indexesWrappedComponentOrders,_)],w=(0,c.orderQuadComponents)(T.componentOrder,_);for(const A of T.index.find(w)){const R=this.dataFactory.quad(A[T.componentOrderInverse.subject],A[T.componentOrderInverse.predicate],A[T.componentOrderInverse.object],A[T.componentOrderInverse.graph]);S?(0,r.matchPattern)(R,f,h,v,g)&&(yield R):yield R}}getQuads(f,h,v,g){return[...this.readQuads(f,h,v,g)]}match(f,h,v,g){return(0,n.wrap)(this.readQuads(f,h,v,g))}countQuads(f,h,v,g){const b=!!this.dictionary.features.quotedTriples&&Object.values(this.indexesWrapped).every(w=>w.index.features.quotedTripleFiltering),[_]=(0,c.quadToPattern)(f,h,v,g,b);if(_.every(w=>w===void 0))return this.size;const S=this.indexesWrapped[(0,c.getBestIndex)(this.indexesWrappedComponentOrders,_)],T=(0,c.orderQuadComponents)(S.componentOrder,_);return S.index.count(T)}asDataset(){return new a.DatasetCoreWrapper(this)}};return l.DEFAULT_INDEX_COMBINATIONS=[["graph","subject","predicate","object"],["graph","predicate","object","subject"],["graph","object","subject","predicate"]],RdfStore.RdfStore=l,RdfStore}var hasRequiredDatasetCoreWrapper;function requireDatasetCoreWrapper(){if(hasRequiredDatasetCoreWrapper)return DatasetCoreWrapper;hasRequiredDatasetCoreWrapper=1,Object.defineProperty(DatasetCoreWrapper,"__esModule",{value:!0}),DatasetCoreWrapper.DatasetCoreWrapper=void 0;const n=requireRdfStore();let t=class ha{constructor(a){this.store=a}get size(){return this.store.size}add(a){return this.store.addQuad(a),this}delete(a){return this.store.removeQuad(a),this}has(a){for(const o of this.store.readQuads(a.subject,a.predicate,a.object,a.graph))return!0;return!1}match(a,o,u,s){const c=new n.RdfStore(this.store.options);for(const l of this.store.readQuads(a,o,u,s))c.addQuad(l);return new ha(c)}[Symbol.iterator](){return this.store.readQuads()}};return DatasetCoreWrapper.DatasetCoreWrapper=t,DatasetCoreWrapper}var ITermDictionary={},hasRequiredITermDictionary;function requireITermDictionary(){return hasRequiredITermDictionary||(hasRequiredITermDictionary=1,Object.defineProperty(ITermDictionary,"__esModule",{value:!0})),ITermDictionary}var TermDictionaryNumberMap={},hasRequiredTermDictionaryNumberMap;function requireTermDictionaryNumberMap(){if(hasRequiredTermDictionaryNumberMap)return TermDictionaryNumberMap;hasRequiredTermDictionaryNumberMap=1,Object.defineProperty(TermDictionaryNumberMap,"__esModule",{value:!0}),TermDictionaryNumberMap.TermDictionaryNumberMap=void 0;const n=requireRdfDataFactory(),t=requireRdfString();let r=class{constructor(o=new n.DataFactory){this.lastId=0,this.dictionary=new Map,this.reverseDictionary=new Map,this.features={quotedTriples:!1},this.dataFactory=o}encode(o){const u=(0,t.termToString)(o);let s=this.dictionary.get(u);return s===void 0&&(s=this.lastId++,this.dictionary.set(u,s),this.reverseDictionary.set(s,u)),s}encodeOptional(o){const u=(0,t.termToString)(o);return this.dictionary.get(u)}decode(o){const u=this.reverseDictionary.get(o);if(u===void 0)throw new Error(`The value ${o} is not present in this dictionary`);return(0,t.stringToTerm)(u,this.dataFactory)}encodings(){return this.reverseDictionary.keys()}findQuotedTriples(o){throw new Error("findQuotedTriples is not supported")}findQuotedTriplesEncoded(o){throw new Error("findQuotedTriplesEncoded is not supported")}};return TermDictionaryNumberMap.TermDictionaryNumberMap=r,TermDictionaryNumberMap}var TermDictionaryNumberRecord={},hasRequiredTermDictionaryNumberRecord;function requireTermDictionaryNumberRecord(){if(hasRequiredTermDictionaryNumberRecord)return TermDictionaryNumberRecord;hasRequiredTermDictionaryNumberRecord=1,Object.defineProperty(TermDictionaryNumberRecord,"__esModule",{value:!0}),TermDictionaryNumberRecord.TermDictionaryNumberRecord=void 0;const n=requireRdfDataFactory(),t=requireRdfString();let r=class{constructor(o=new n.DataFactory){this.lastId=0,this.dictionary={},this.reverseDictionary={},this.features={quotedTriples:!1},this.dataFactory=o}encode(o){const u=(0,t.termToString)(o);let s=this.dictionary[u];return s===void 0&&(s=this.lastId++,this.dictionary[u]=s,this.reverseDictionary[s]=u),s}encodeOptional(o){const u=(0,t.termToString)(o);return this.dictionary[u]}decode(o){const u=this.reverseDictionary[o];if(u===void 0)throw new Error(`The value ${o} is not present in this dictionary`);return(0,t.stringToTerm)(u,this.dataFactory)}*encodings(){for(const o of Object.keys(this.reverseDictionary))yield Number.parseInt(o,10)}findQuotedTriples(o){throw new Error("findQuotedTriples is not supported")}findQuotedTriplesEncoded(o){throw new Error("findQuotedTriplesEncoded is not supported")}};return TermDictionaryNumberRecord.TermDictionaryNumberRecord=r,TermDictionaryNumberRecord}var TermDictionaryQuoted={},hasRequiredTermDictionaryQuoted;function requireTermDictionaryQuoted(){if(hasRequiredTermDictionaryQuoted)return TermDictionaryQuoted;hasRequiredTermDictionaryQuoted=1,Object.defineProperty(TermDictionaryQuoted,"__esModule",{value:!0}),TermDictionaryQuoted.TermDictionaryQuoted=void 0;const n=requireRdfDataFactory(),t=requireRdfTerms();let r=class $r{constructor(o,u,s=new n.DataFactory){this.features={quotedTriples:!0},this.plainTermDictionary=o,this.quotedTriplesDictionary=u,this.dataFactory=s}encode(o){return o.termType==="Quad"?$r.BITMASK|1+this.quotedTriplesDictionary.encode(o):this.plainTermDictionary.encode(o)}encodeOptional(o){if(o.termType==="Quad"){const u=this.quotedTriplesDictionary.encodeOptional(o);return u===void 0?u:$r.BITMASK|1+u}return this.plainTermDictionary.encodeOptional(o)}decode(o){if($r.BITMASK&o){const u=(~$r.BITMASK&o)-1;return this.quotedTriplesDictionary.decode(u)}return this.plainTermDictionary.decode(o)}*encodings(){for(const o of this.plainTermDictionary.encodings())yield o;for(const o of this.quotedTriplesDictionary.encodings())yield $r.BITMASK|1+o}*findQuotedTriples(o){for(const u of this.findQuotedTriplesEncoded(o))yield this.decode(u)}*findQuotedTriplesEncoded(o){for(let u of this.quotedTriplesDictionary.encodings()){u=$r.BITMASK|1+u;const s=this.decode(u);(0,t.matchPattern)(s,o.subject,o.predicate,o.object,o.graph)&&(yield u)}}};return r.BITMASK=1<<31,TermDictionaryQuoted.TermDictionaryQuoted=r,TermDictionaryQuoted}var TermDictionaryQuotedReferential={},hasRequiredTermDictionaryQuotedReferential;function requireTermDictionaryQuotedReferential(){if(hasRequiredTermDictionaryQuotedReferential)return TermDictionaryQuotedReferential;hasRequiredTermDictionaryQuotedReferential=1,Object.defineProperty(TermDictionaryQuotedReferential,"__esModule",{value:!0}),TermDictionaryQuotedReferential.TermDictionaryQuotedReferential=void 0;const n=requireRdfDataFactory(),t=requireRdfTerms(),r=requireOrderUtils();let a=class cr{constructor(u,s=new n.DataFactory){this.quotedTriplesDictionary=[],this.quotedTriplesReverseDictionary={},this.features={quotedTriples:!0},this.plainTermDictionary=u,this.dataFactory=s}encode(u){return u.termType==="Quad"?this.encodeQuotedTriple(u,!1):this.plainTermDictionary.encode(u)}encodeQuotedTriple(u,s){var c;if(u.graph.termType!=="DefaultGraph")throw new Error("Encoding of quoted quads outside of the default graph is not allowed");const l=(c=(0,r.encodeOptionalTerms)([u.subject,u.predicate,u.object,void 0],this))===null||c===void 0?void 0:c.slice(0,3),d=l&&l.every(v=>v!==void 0)?this.quotedTriplesReverseDictionary[l.join(cr.SEPARATOR)]:void 0;if(d!==void 0||s)return d===void 0?void 0:cr.BITMASK|d;const f=[this.encode(u.subject),this.encode(u.predicate),this.encode(u.object)],h=this.quotedTriplesDictionary.length+1;return this.quotedTriplesDictionary.push(f),this.quotedTriplesReverseDictionary[f.join(cr.SEPARATOR)]=h,cr.BITMASK|h}encodeOptional(u){return u.termType==="Quad"?this.encodeQuotedTriple(u,!0):this.plainTermDictionary.encodeOptional(u)}decode(u){if(cr.BITMASK&u){const s=(~cr.BITMASK&u)-1;if(s>=this.quotedTriplesDictionary.length)throw new Error(`The value ${u} is not present in the quoted triples range of the dictionary`);const c=this.quotedTriplesDictionary[s];return this.dataFactory.quad(this.decode(c[0]),this.decode(c[1]),this.decode(c[2]))}return this.plainTermDictionary.decode(u)}*encodings(){for(const u of this.plainTermDictionary.encodings())yield u;for(const u of this.quotedTriplesDictionary.keys())yield cr.BITMASK|1+u}*findQuotedTriples(u){for(const s of this.findQuotedTriplesEncoded(u))yield this.decode(s)}*findQuotedTriplesEncoded(u){for(let s of this.quotedTriplesDictionary.keys()){s=cr.BITMASK|1+s;const c=this.decode(s);(0,t.matchPattern)(c,u.subject,u.predicate,u.object,u.graph)&&(yield s)}}};return a.BITMASK=1<<31,a.SEPARATOR="_",TermDictionaryQuotedReferential.TermDictionaryQuotedReferential=a,TermDictionaryQuotedReferential}var TermDictionarySymbol={},hasRequiredTermDictionarySymbol;function requireTermDictionarySymbol(){if(hasRequiredTermDictionarySymbol)return TermDictionarySymbol;hasRequiredTermDictionarySymbol=1,Object.defineProperty(TermDictionarySymbol,"__esModule",{value:!0}),TermDictionarySymbol.TermDictionarySymbol=void 0;const n=requireRdfDataFactory(),t=requireRdfString();let r=class{constructor(o=new n.DataFactory){this.features={quotedTriples:!1},this.dataFactory=o}encode(o){return Symbol.for(`rdf::${(0,t.termToString)(o)}`)}encodeOptional(o){return this.encode(o)}decode(o){const u=Symbol.keyFor(o);if(u===void 0)throw new Error(`The value ${String(o)} is not present in this dictionary`);return(0,t.stringToTerm)(u.slice(5),this.dataFactory)}encodings(){throw new Error("encodings is not supported")}findQuotedTriples(o){throw new Error("findQuotedTriples is not supported")}findQuotedTriplesEncoded(o){throw new Error("findQuotedTriplesEncoded is not supported")}};return TermDictionarySymbol.TermDictionarySymbol=r,TermDictionarySymbol}var IRdfStoreIndex={},hasRequiredIRdfStoreIndex;function requireIRdfStoreIndex(){return hasRequiredIRdfStoreIndex||(hasRequiredIRdfStoreIndex=1,Object.defineProperty(IRdfStoreIndex,"__esModule",{value:!0})),IRdfStoreIndex}var RdfStoreIndexNestedMapRecursive={},hasRequiredRdfStoreIndexNestedMapRecursive;function requireRdfStoreIndexNestedMapRecursive(){if(hasRequiredRdfStoreIndexNestedMapRecursive)return RdfStoreIndexNestedMapRecursive;hasRequiredRdfStoreIndexNestedMapRecursive=1,Object.defineProperty(RdfStoreIndexNestedMapRecursive,"__esModule",{value:!0}),RdfStoreIndexNestedMapRecursive.RdfStoreIndexNestedMapRecursive=void 0;const n=requireOrderUtils();let t=class{constructor(a){this.features={quotedTripleFiltering:!1},this.dictionary=a.dictionary,this.nestedMap=new Map}set(a,o){let u=this.nestedMap,s=!1;for(const[c,l]of a.entries()){const d=u;let f=d.get(l);f?c===a.length-1&&(s=!0):(f=c===a.length-1?o:new Map,d.set(l,f)),u=f}return!s}remove(a){const o=this.nestedMap,u=o.get(a[0]);if(!u)return!1;const s=u.get(a[1]);if(!s)return!1;const c=s.get(a[2]);if(!c)return!1;const l=c.delete(a[3]);return l&&c.size===0&&(s.delete(a[2]),s.size===0&&(u.delete(a[1]),u.size===0&&o.delete(a[0]))),l}get(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!(!o||o.includes(void 0)))return this.getEncoded(o)}getEncoded(a){const o=this.nestedMap.get(a[0]);if(!o)return;const u=o.get(a[1]);if(!u)return;const s=u.get(a[2]);if(s)return s.get(a[3])}*find(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(o)for(const u of this.findEncoded(o,a))yield[o[0]!==void 0?a[0]:this.dictionary.decode(u[0]),o[1]!==void 0?a[1]:this.dictionary.decode(u[1]),o[2]!==void 0?a[2]:this.dictionary.decode(u[2]),o[3]!==void 0?a[3]:this.dictionary.decode(u[3])]}*findEncoded(a,o){return yield*this.findEncodedInner(0,a,o,this.nestedMap,[])}*findEncodedInner(a,o,u,s,c){if(a===o.length)yield[...c];else{const l=o[a];if(u[a]){const f=l;if(f!==void 0){const h=s.get(f);h&&(c[a]=l,yield*this.findEncodedInner(a+1,o,u,h,c))}}else for(const[f,h]of s.entries())c[a]=f,yield*this.findEncodedInner(a+1,o,u,h,c)}}count(a){return this.countInner(0,a,this.nestedMap)}countInner(a,o,u){const s=o[a];let c=0;if(s){const l=this.dictionary.encodeOptional(s);if(l!==void 0){if(a===o.length-1)return u.has(l)?1:0;const d=u.get(l);d&&(c+=this.countInner(a+1,o,d))}}else{if(a===o.length-1)return u.size;for(const l of u.values())c+=this.countInner(a+1,o,l)}return c}};return RdfStoreIndexNestedMapRecursive.RdfStoreIndexNestedMapRecursive=t,RdfStoreIndexNestedMapRecursive}var RdfStoreIndexNestedMapRecursiveQuoted={},hasRequiredRdfStoreIndexNestedMapRecursiveQuoted;function requireRdfStoreIndexNestedMapRecursiveQuoted(){if(hasRequiredRdfStoreIndexNestedMapRecursiveQuoted)return RdfStoreIndexNestedMapRecursiveQuoted;hasRequiredRdfStoreIndexNestedMapRecursiveQuoted=1,Object.defineProperty(RdfStoreIndexNestedMapRecursiveQuoted,"__esModule",{value:!0}),RdfStoreIndexNestedMapRecursiveQuoted.RdfStoreIndexNestedMapRecursiveQuoted=void 0;const n=requireOrderUtils(),t=requireRdfStoreIndexNestedMapRecursive();let r=class extends t.RdfStoreIndexNestedMapRecursive{constructor(o){super(o),this.features={quotedTripleFiltering:!0}}*findEncoded(o,u){return yield*this.findEncodedInnerQuoted(0,o,u,(0,n.arePatternsQuoted)(u),this.nestedMap,[])}*findEncodedInnerQuoted(o,u,s,c,l,d){if(o===u.length)yield[...d];else{const f=u[o],h=s[o];if(h)if(c[o]){const v=this.dictionary.findQuotedTriplesEncoded(h);for(const g of v){const b=l.get(g);b&&(d[o]=g,yield*this.findEncodedInnerQuoted(o+1,u,s,c,b,d))}}else{const v=f;if(v!==void 0){const g=l.get(v);g&&(d[o]=f,yield*this.findEncodedInnerQuoted(o+1,u,s,c,g,d))}}else for(const[v,g]of l.entries())d[o]=v,yield*this.findEncodedInnerQuoted(o+1,u,s,c,g,d)}}countInner(o,u,s){const c=u[o];let l=0;if(c)if(c.termType==="Quad"&&(0,n.quadHasVariables)(c)){const d=this.dictionary.findQuotedTriplesEncoded(c);for(const f of d)if(o===u.length-1)s.has(f)&&l++;else{const h=s.get(f);h&&(l+=this.countInner(o+1,u,h))}}else{const d=this.dictionary.encodeOptional(c);if(d!==void 0){if(o===u.length-1)return s.has(d)?1:0;const f=s.get(d);f&&(l+=this.countInner(o+1,u,f))}}else{if(o===u.length-1)return s.size;for(const d of s.values())l+=this.countInner(o+1,u,d)}return l}};return RdfStoreIndexNestedMapRecursiveQuoted.RdfStoreIndexNestedMapRecursiveQuoted=r,RdfStoreIndexNestedMapRecursiveQuoted}var RdfStoreIndexNestedRecord={},hasRequiredRdfStoreIndexNestedRecord;function requireRdfStoreIndexNestedRecord(){if(hasRequiredRdfStoreIndexNestedRecord)return RdfStoreIndexNestedRecord;hasRequiredRdfStoreIndexNestedRecord=1,Object.defineProperty(RdfStoreIndexNestedRecord,"__esModule",{value:!0}),RdfStoreIndexNestedRecord.RdfStoreIndexNestedRecord=void 0;const n=requireOrderUtils();let t=class{constructor(a){this.features={quotedTripleFiltering:!1},this.dictionary=a.dictionary,this.nestedRecords={}}set(a,o){const u=this.nestedRecords,s=u[a[0]]||(u[a[0]]={}),c=s[a[1]]||(s[a[1]]={}),l=c[a[2]]||(c[a[2]]={});return l[a[3]]?!1:(l[a[3]]=o,!0)}remove(a){const o=this.nestedRecords,u=o[a[0]];if(!u)return!1;const s=u[a[1]];if(!s)return!1;const c=s[a[2]];return!c||!c[a[3]]?!1:(delete c[a[3]],Object.keys(c).length===0&&(delete s[a[2]],Object.keys(s).length===0&&(delete u[a[1]],Object.keys(u).length===0&&delete o[a[0]])),!0)}get(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!(!o||o.includes(void 0)))return this.getEncoded(o)}getEncoded(a){var o,u,s;return(s=(u=(o=this.nestedRecords[a[0]])===null||o===void 0?void 0:o[a[1]])===null||u===void 0?void 0:u[a[2]])===null||s===void 0?void 0:s[a[3]]}*find(a){const o=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!o)return;const[u,s,c,l]=o,[d,f,h,v]=a;let g,b,_,S,T,w,A;const R=this.nestedRecords,E=u!==void 0?u in R?[u]:[]:Object.keys(R);for(const I of E){T=R[I],g=d||this.dictionary.decode(Number.parseInt(I,10));const L=s!==void 0?s in T?[s]:[]:Object.keys(T);for(const F of L){w=T[F],b=f||this.dictionary.decode(Number.parseInt(F,10));const D=c!==void 0?c in w?[c]:[]:Object.keys(w);for(const $ of D){A=w[$],_=h||this.dictionary.decode(Number.parseInt($,10));const O=l!==void 0?l in A?[l]:[]:Object.keys(A);for(const P of O)S=v||this.dictionary.decode(Number.parseInt(P,10)),yield[g,b,_,S]}}}}*findEncoded(a,o){const[u,s,c,l]=a;let d,f,h;const v=this.nestedRecords,g=u!==void 0?u in v?[u]:[]:Object.keys(v);for(const b of g){d=v[b];const _=s!==void 0?s in d?[s]:[]:Object.keys(d);for(const S of _){f=d[S];const T=c!==void 0?c in f?[c]:[]:Object.keys(f);for(const w of T){h=f[w];const A=l!==void 0?l in h?[l]:[]:Object.keys(h);for(const R of A)yield[Number.parseInt(b,10),Number.parseInt(S,10),Number.parseInt(w,10),Number.parseInt(R,10)]}}}}count(a){let o=0;const u=(0,n.encodeOptionalTerms)(a,this.dictionary);if(!u)return 0;const s=u[0],c=u[1],l=u[2],d=u[3];let f,h,v;const g=this.nestedRecords,b=s!==void 0?s in g?[s]:[]:Object.keys(g);for(const _ of b){f=g[_];const S=c!==void 0?c in f?[c]:[]:Object.keys(f);for(const T of S){h=f[T];const w=l!==void 0?l in h?[l]:[]:Object.keys(h);for(const A of w)v=h[A],d!==void 0?d in v&&o++:o+=Object.keys(v).length}}return o}};return RdfStoreIndexNestedRecord.RdfStoreIndexNestedRecord=t,RdfStoreIndexNestedRecord}var RdfStoreIndexNestedRecordQuoted={},hasRequiredRdfStoreIndexNestedRecordQuoted;function requireRdfStoreIndexNestedRecordQuoted(){if(hasRequiredRdfStoreIndexNestedRecordQuoted)return RdfStoreIndexNestedRecordQuoted;hasRequiredRdfStoreIndexNestedRecordQuoted=1,Object.defineProperty(RdfStoreIndexNestedRecordQuoted,"__esModule",{value:!0}),RdfStoreIndexNestedRecordQuoted.RdfStoreIndexNestedRecordQuoted=void 0;const n=requireOrderUtils(),t=requireRdfStoreIndexNestedRecord();let r=class extends t.RdfStoreIndexNestedRecord{constructor(o){super(o),this.features={quotedTripleFiltering:!0}}*getQuotedPatternKeys(o,u){for(const s of this.dictionary.findQuotedTriplesEncoded(u))s in o&&(yield s)}*find(o){const u=(0,n.encodeOptionalTerms)(o,this.dictionary);if(!u)return;const[s,c,l,d]=u,[f,h,v,g]=o,[b,_,S,T]=(0,n.arePatternsQuoted)(o);let w,A,R,E,I,L,F;const D=this.nestedRecords,$=f!==void 0?b?this.getQuotedPatternKeys(D,f):s in D?[s]:[]:Object.keys(D);for(const O of $){I=D[O],w=!b&&f?f:this.dictionary.decode(Number.parseInt(O,10));const P=h!==void 0?_?this.getQuotedPatternKeys(I,h):c in I?[c]:[]:Object.keys(I);for(const C of P){L=I[C],A=!_&&h?h:this.dictionary.decode(Number.parseInt(C,10));const q=v!==void 0?S?this.getQuotedPatternKeys(L,v):l in L?[l]:[]:Object.keys(L);for(const M of q){F=L[M],R=!S&&v?v:this.dictionary.decode(Number.parseInt(M,10));const N=g!==void 0?T?this.getQuotedPatternKeys(F,g):d in F?[d]:[]:Object.keys(F);for(const G of N)E=!T&&g?g:this.dictionary.decode(Number.parseInt(G,10)),yield[w,A,R,E]}}}}*findEncoded(o,u){const[s,c,l,d]=o,[f,h,v,g]=u,[b,_,S,T]=(0,n.arePatternsQuoted)(u);let w,A,R;const E=this.nestedRecords,I=f!==void 0?b?this.getQuotedPatternKeys(E,f):s in E?[s]:[]:Object.keys(E);for(const L of I){w=E[L];const F=h!==void 0?_?this.getQuotedPatternKeys(w,h):c in w?[c]:[]:Object.keys(w);for(const D of F){A=w[D];const $=v!==void 0?S?this.getQuotedPatternKeys(A,v):l in A?[l]:[]:Object.keys(A);for(const O of $){R=A[O];const P=g!==void 0?T?this.getQuotedPatternKeys(R,g):d in R?[d]:[]:Object.keys(R);for(const C of P)yield[Number.parseInt(L,10),Number.parseInt(D,10),Number.parseInt(O,10),Number.parseInt(C,10)]}}}}count(o){let u=0;const s=(0,n.encodeOptionalTerms)(o,this.dictionary);if(!s)return 0;const[c,l,d,f]=s,[h,v,g,b]=o,[_,S,T,w]=(0,n.arePatternsQuoted)(o);let A,R,E;const I=this.nestedRecords,L=h!==void 0?_?this.getQuotedPatternKeys(I,h):c in I?[c]:[]:Object.keys(I);for(const F of L){A=I[F];const D=v!==void 0?S?this.getQuotedPatternKeys(A,v):l in A?[l]:[]:Object.keys(A);for(const $ of D){R=A[$];const O=g!==void 0?T?this.getQuotedPatternKeys(R,g):d in R?[d]:[]:Object.keys(R);for(const P of O)E=R[P],b!==void 0?w?u+=[...this.getQuotedPatternKeys(E,b)].length:f in E&&u++:u+=Object.keys(E).length}}return u}};return RdfStoreIndexNestedRecordQuoted.RdfStoreIndexNestedRecordQuoted=r,RdfStoreIndexNestedRecordQuoted}var IRdfStoreOptions={},hasRequiredIRdfStoreOptions;function requireIRdfStoreOptions(){return hasRequiredIRdfStoreOptions||(hasRequiredIRdfStoreOptions=1,Object.defineProperty(IRdfStoreOptions,"__esModule",{value:!0})),IRdfStoreOptions}var PatternTerm={},hasRequiredPatternTerm;function requirePatternTerm(){return hasRequiredPatternTerm||(hasRequiredPatternTerm=1,Object.defineProperty(PatternTerm,"__esModule",{value:!0})),PatternTerm}var hasRequiredRdfStores;function requireRdfStores(){return hasRequiredRdfStores||(hasRequiredRdfStores=1,function(n){var t=rdfStores&&rdfStores.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfStores&&rdfStores.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireDatasetCoreWrapper(),n),r(requireITermDictionary(),n),r(requireTermDictionaryNumberMap(),n),r(requireTermDictionaryNumberRecord(),n),r(requireTermDictionaryNumberRecordFullTerms(),n),r(requireTermDictionaryQuoted(),n),r(requireTermDictionaryQuotedIndexed(),n),r(requireTermDictionaryQuotedReferential(),n),r(requireTermDictionarySymbol(),n),r(requireIRdfStoreIndex(),n),r(requireRdfStoreIndexNestedMap(),n),r(requireRdfStoreIndexNestedMapQuoted(),n),r(requireRdfStoreIndexNestedMapRecursive(),n),r(requireRdfStoreIndexNestedMapRecursiveQuoted(),n),r(requireRdfStoreIndexNestedRecord(),n),r(requireRdfStoreIndexNestedRecordQuoted(),n),r(requireIRdfStoreOptions(),n),r(requireOrderUtils(),n),r(requirePatternTerm(),n),r(requireRdfStore(),n)}(rdfStores)),rdfStores}var hasRequiredRdfStoreStream;function requireRdfStoreStream(){if(hasRequiredRdfStoreStream)return rdfStoreStream;hasRequiredRdfStoreStream=1,Object.defineProperty(rdfStoreStream,"__esModule",{value:!0}),rdfStoreStream.storeStream=void 0;const n=requireRdfStores();function t(r){const a=n.RdfStore.createDefault();return new Promise((o,u)=>a.import(r).on("error",u).once("end",()=>o(a)))}return rdfStoreStream.storeStream=t,rdfStoreStream}var hasRequiredActorQuerySourceIdentifyHypermediaNone;function requireActorQuerySourceIdentifyHypermediaNone(){if(hasRequiredActorQuerySourceIdentifyHypermediaNone)return ActorQuerySourceIdentifyHypermediaNone;hasRequiredActorQuerySourceIdentifyHypermediaNone=1,Object.defineProperty(ActorQuerySourceIdentifyHypermediaNone,"__esModule",{value:!0}),ActorQuerySourceIdentifyHypermediaNone.ActorQuerySourceIdentifyHypermediaNone=void 0;const n=requireLib$w(),t=requireLib$A(),r=requireLib$4q(),a=requireLib$4s(),o=requireLib$1A(),u=requireRdfStoreStream();let s=class extends t.ActorQuerySourceIdentifyHypermedia{constructor(l){super(l,"file")}async testMetadata(l){return(0,a.passTest)({filterFactor:0})}async run(l){this.logInfo(l.context,`Identified as file source: ${l.url}`);const d=l.context.getSafe(r.KeysInitQuery.dataFactory),f=new n.QuerySourceRdfJs(await(0,u.storeStream)(l.quads),d,await o.BindingsFactory.create(this.mediatorMergeBindingsContext,l.context,d));return f.toString=()=>`QuerySourceRdfJs(${l.url})`,f.referenceValue=l.url,{source:f}}};return ActorQuerySourceIdentifyHypermediaNone.ActorQuerySourceIdentifyHypermediaNone=s,ActorQuerySourceIdentifyHypermediaNone}var hasRequiredLib$v;function requireLib$v(){return hasRequiredLib$v||(hasRequiredLib$v=1,function(n){var t=lib$w&&lib$w.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$w&&lib$w.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyHypermediaNone(),n)}(lib$w)),lib$w}var lib$u={},ActorExpressionEvaluatorFactoryDefault={},lib$t={},ActorExpressionEvaluatorFactory={},hasRequiredActorExpressionEvaluatorFactory;function requireActorExpressionEvaluatorFactory(){if(hasRequiredActorExpressionEvaluatorFactory)return ActorExpressionEvaluatorFactory;hasRequiredActorExpressionEvaluatorFactory=1,Object.defineProperty(ActorExpressionEvaluatorFactory,"__esModule",{value:!0}),ActorExpressionEvaluatorFactory.ActorExpressionEvaluatorFactory=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a),this.mediatorQueryOperation=a.mediatorQueryOperation,this.mediatorFunctionFactory=a.mediatorFunctionFactory,this.mediatorMergeBindingsContext=a.mediatorMergeBindingsContext}};return ActorExpressionEvaluatorFactory.ActorExpressionEvaluatorFactory=t,ActorExpressionEvaluatorFactory}var hasRequiredLib$u;function requireLib$u(){return hasRequiredLib$u||(hasRequiredLib$u=1,function(n){var t=lib$t&&lib$t.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$t&&lib$t.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorExpressionEvaluatorFactory(),n)}(lib$t)),lib$t}var AlgebraTransformer={},hasRequiredAlgebraTransformer;function requireAlgebraTransformer(){if(hasRequiredAlgebraTransformer)return AlgebraTransformer;hasRequiredAlgebraTransformer=1,Object.defineProperty(AlgebraTransformer,"__esModule",{value:!0}),AlgebraTransformer.AlgebraTransformer=void 0;const n=requireLib$4q(),t=requireLib$4n(),r=requireSparqlalgebrajs();let a=class Fn extends t.TermTransformer{constructor(u,s){super(u.getSafe(n.KeysExpressionEvaluator.superTypeProvider)),this.context=u,this.mediatorFunctionFactory=s}async transformAlgebra(u){const s=r.Algebra.expressionTypes;switch(u.expressionType){case s.TERM:return this.transformTerm(u);case s.OPERATOR:return await this.transformOperator(u);case s.NAMED:return await this.transformNamed(u);case s.EXISTENCE:return Fn.transformExistence(u);case s.AGGREGATE:return Fn.transformAggregate(u);case s.WILDCARD:return Fn.transformWildcard(u)}}static transformWildcard(u){return new t.NamedNode(u.wildcard.value)}async getOperator(u,s){const c=await this.mediatorFunctionFactory.mediate({functionName:u,arguments:s.args,context:this.context}),l=await Promise.all(s.args.map(d=>this.transformAlgebra(d)));if(!c.checkArity(l))throw new t.InvalidArity(l,u);return new t.Operator(u,l,c.apply)}async transformOperator(u){return this.getOperator(u.operator.toLowerCase(),u)}async transformNamed(u){return this.getOperator(u.name.value,u)}static transformAggregate(u){const s=u.aggregator;return new t.Aggregate(s,u)}static transformExistence(u){return new t.Existence(u)}};return AlgebraTransformer.AlgebraTransformer=a,AlgebraTransformer}var ExpressionEvaluator={},InternalEvaluator={},hasRequiredInternalEvaluator;function requireInternalEvaluator(){if(hasRequiredInternalEvaluator)return InternalEvaluator;hasRequiredInternalEvaluator=1,Object.defineProperty(InternalEvaluator,"__esModule",{value:!0}),InternalEvaluator.InternalEvaluator=void 0;const n=requireLib$4q(),t=requireLib$4p(),r=requireLib$4n(),a=requireLib$43(),o=requireSparqlalgebrajs(),u=requireAlgebraTransformer();let s=class{constructor(l,d,f,h){this.context=l,this.mediatorQueryOperation=f,this.bindingsFactory=h,this.subEvaluators={[t.ExpressionType.Term]:(v,g)=>this.term(v),[t.ExpressionType.Variable]:(v,g)=>this.variable(v,g),[t.ExpressionType.Operator]:(v,g)=>this.evalFunction(v,g),[t.ExpressionType.Existence]:(v,g)=>this.evalExistence(v,g),[t.ExpressionType.Aggregate]:(v,g)=>this.evalAggregate()},this.transformer=new u.AlgebraTransformer(l,d)}async evaluatorExpressionEvaluation(l,d){return this.subEvaluators[l.expressionType].bind(this)(l,d)}term(l){return l}variable(l,d){const f=d.get(r.expressionToVar(this.context.getSafe(n.KeysInitQuery.dataFactory),l));if(!f)throw new r.UnboundVariableError(l.name,d);return this.transformer.transformRDFTermUnsafe(f)}async evalFunction(l,d){return l.apply({args:l.args,mapping:d,exprEval:this})}async evalExistence(l,d){const f=this.context.getSafe(n.KeysInitQuery.dataFactory),h=new o.Factory(f),v=(0,a.materializeOperation)(l.expression.input,d,h,this.bindingsFactory),g=await this.mediatorQueryOperation.mediate({operation:v,context:this.context}),b=(0,a.getSafeBindings)(g);return await new Promise((_,S)=>{b.bindingsStream.on("end",()=>{_(!1)}),b.bindingsStream.on("error",S),b.bindingsStream.on("data",()=>{b.bindingsStream.close(),_(!0)})}).then(_=>l.expression.not?!_:_).then(_=>new r.BooleanLiteral(_))}evalAggregate(){throw new r.NoAggregator}};return InternalEvaluator.InternalEvaluator=s,InternalEvaluator}var hasRequiredExpressionEvaluator;function requireExpressionEvaluator(){if(hasRequiredExpressionEvaluator)return ExpressionEvaluator;hasRequiredExpressionEvaluator=1,Object.defineProperty(ExpressionEvaluator,"__esModule",{value:!0}),ExpressionEvaluator.ExpressionEvaluator=void 0;const n=requireLib$4q(),t=requireInternalEvaluator();let r=class{constructor(o,u,s,c,l){this.context=o,this.expr=u,this.mediatorFunctionFactory=s,this.mediatorQueryOperation=c,this.bindingsFactory=l,this.internalEvaluator=new t.InternalEvaluator(o,s,c,l)}async evaluate(o){return(await this.internalEvaluator.evaluatorExpressionEvaluation(this.expr,o)).toRDF(this.context.getSafe(n.KeysInitQuery.dataFactory))}async evaluateAsEBV(o){return(await this.internalEvaluator.evaluatorExpressionEvaluation(this.expr,o)).coerceEBV()}evaluateAsEvaluatorExpression(o){return this.evaluatorExpressionEvaluation(this.expr,o)}evaluatorExpressionEvaluation(o,u){return this.internalEvaluator.evaluatorExpressionEvaluation(o,u)}};return ExpressionEvaluator.ExpressionEvaluator=r,ExpressionEvaluator}var hasRequiredActorExpressionEvaluatorFactoryDefault;function requireActorExpressionEvaluatorFactoryDefault(){if(hasRequiredActorExpressionEvaluatorFactoryDefault)return ActorExpressionEvaluatorFactoryDefault;hasRequiredActorExpressionEvaluatorFactoryDefault=1,Object.defineProperty(ActorExpressionEvaluatorFactoryDefault,"__esModule",{value:!0}),ActorExpressionEvaluatorFactoryDefault.ActorExpressionEvaluatorFactoryDefault=void 0;const n=requireLib$u(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$4n(),u=requireAlgebraTransformer(),s=requireExpressionEvaluator();let c=class extends n.ActorExpressionEvaluatorFactory{constructor(d){super(d)}async test(d){return(0,r.passTestVoid)()}async run(d){const f=(0,o.prepareEvaluatorActionContext)(d.context);return new s.ExpressionEvaluator(f,await new u.AlgebraTransformer(f,this.mediatorFunctionFactory).transformAlgebra(d.algExpr),this.mediatorFunctionFactory,this.mediatorQueryOperation,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d.context,d.context.getSafe(t.KeysInitQuery.dataFactory)))}};return ActorExpressionEvaluatorFactoryDefault.ActorExpressionEvaluatorFactoryDefault=c,ActorExpressionEvaluatorFactoryDefault}var hasRequiredLib$t;function requireLib$t(){return hasRequiredLib$t||(hasRequiredLib$t=1,function(n){var t=lib$u&&lib$u.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$u&&lib$u.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorExpressionEvaluatorFactoryDefault(),n)}(lib$u)),lib$u}var lib$s={},ActorQueryOperationGroup={},GroupsState={},hasRequiredGroupsState;function requireGroupsState(){if(hasRequiredGroupsState)return GroupsState;hasRequiredGroupsState=1,Object.defineProperty(GroupsState,"__esModule",{value:!0}),GroupsState.GroupsState=void 0;const n=requireLib$4q(),t=requireLib$1A();let r=class{constructor(o,u,s,c,l){this.pattern=o,this.mediatorBindingsAggregatorFactory=u,this.context=s,this.bindingsFactory=c,this.variables=l,this.groups=new Map,this.groupsInitializer=new Map,this.groupVariables=new Set(this.pattern.variables.map(d=>d.value)),this.waitCounter=1,this.resultHasBeenCalled=!1}consumeBindings(o){const u=this.resultCheck();if(u)return u;this.waitCounter++;const s=o.filter((f,h)=>this.groupVariables.has(h.value)),c=this.hashBindings(s);let l=this.groupsInitializer.get(c),d;if(l){const f=l;d=(async()=>{const h=await f;await Promise.all(this.pattern.aggregates.map(async v=>{const g=v.variable.value;await h.aggregators[g].putBindings(o)}))})().then(async()=>{await this.subtractWaitCounterAndCollect()})}else l=(async()=>{const f={};await Promise.all(this.pattern.aggregates.map(async v=>{const g=v.variable.value;f[g]=await this.mediatorBindingsAggregatorFactory.mediate({expr:v,context:this.context}),await f[g].putBindings(o)}));const h={aggregators:f,bindings:s};return this.groups.set(c,h),await this.subtractWaitCounterAndCollect(),h})(),this.groupsInitializer.set(c,l),d=l;return d}async subtractWaitCounterAndCollect(){--this.waitCounter===0&&await this.handleResultCollection()}async handleResultCollection(){const o=this.context.getSafe(n.KeysInitQuery.dataFactory);let u=await Promise.all([...this.groups].map(async([s,c])=>{const{bindings:l,aggregators:d}=c;let f=l;for(const h in d){const v=await d[h].result();v&&(f=f.set(o.variable(h),v))}return f}));if(u.length===0&&this.groupVariables.size===0){const s=[];await Promise.all(this.pattern.aggregates.map(async c=>{const l=c.variable,f=await(await this.mediatorBindingsAggregatorFactory.mediate({expr:c,context:this.context})).result();f!==void 0&&s.push([l,f])})),u=[this.bindingsFactory.bindings(s)]}this.waitResolver(u)}resultCheck(){if(this.resultHasBeenCalled)return Promise.reject(new Error("Calling any function after calling collectResult is invalid."))}async collectResults(){const o=this.resultCheck();if(o)return o;this.resultHasBeenCalled=!0;const u=new Promise(s=>{this.waitResolver=s});return await this.subtractWaitCounterAndCollect(),u}hashBindings(o){return(0,t.bindingsToCompactString)(o,this.variables)}};return GroupsState.GroupsState=r,GroupsState}var hasRequiredActorQueryOperationGroup;function requireActorQueryOperationGroup(){if(hasRequiredActorQueryOperationGroup)return ActorQueryOperationGroup;hasRequiredActorQueryOperationGroup=1,Object.defineProperty(ActorQueryOperationGroup,"__esModule",{value:!0}),ActorQueryOperationGroup.ActorQueryOperationGroup=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$43(),u=requireAsynciterator(),s=requireGroupsState();let c=class extends n.ActorQueryOperationTypedMediated{constructor(d){super(d,"group"),this.mediatorBindingsAggregatorFactory=d.mediatorBindingsAggregatorFactory}async testOperation(){return(0,r.passTestVoid)()}async runOperation(d,f){const h=f.getSafe(t.KeysInitQuery.dataFactory),v=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,f,h),{input:g,aggregates:b}=d,_=await this.mediatorQueryOperation.mediate({operation:g,context:f}),S=(0,o.getSafeBindings)(_),T=[...d.variables,...b.map(R=>R.variable)].map(R=>({variable:R,canBeUndef:!1})),w=(await S.metadata()).variables.map(R=>R.variable);return{type:"bindings",bindingsStream:new u.TransformIterator(()=>new Promise((R,E)=>{const I=new s.GroupsState(d,this.mediatorBindingsAggregatorFactory,f,v,w);S.bindingsStream.on("end",async()=>{try{const L=new u.ArrayIterator(await I.collectResults(),{autoStart:!1});R(L)}catch(L){E(L)}}),S.bindingsStream.on("error",E),S.bindingsStream.on("data",L=>{I.consumeBindings(L).catch(E)})}),{autoStart:!1}),metadata:async()=>({...await S.metadata(),variables:T})}}};return ActorQueryOperationGroup.ActorQueryOperationGroup=c,ActorQueryOperationGroup}var hasRequiredLib$s;function requireLib$s(){return hasRequiredLib$s||(hasRequiredLib$s=1,function(n){var t=lib$s&&lib$s.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$s&&lib$s.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationGroup(),n)}(lib$s)),lib$s}var lib$r={},ActorQueryOperationNop={},hasRequiredActorQueryOperationNop;function requireActorQueryOperationNop(){if(hasRequiredActorQueryOperationNop)return ActorQueryOperationNop;hasRequiredActorQueryOperationNop=1,Object.defineProperty(ActorQueryOperationNop,"__esModule",{value:!0}),ActorQueryOperationNop.ActorQueryOperationNop=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$4l(),u=requireAsynciterator();let s=class extends n.ActorQueryOperationTypedMediated{constructor(l){super(l,"nop")}async testOperation(l,d){return(0,r.passTestVoid)()}async runOperation(l,d){const f=d.getSafe(t.KeysInitQuery.dataFactory),h=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d,f);return{bindingsStream:new u.SingletonIterator(h.bindings()),metadata:()=>Promise.resolve({state:new o.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]}),type:"bindings"}}};return ActorQueryOperationNop.ActorQueryOperationNop=s,ActorQueryOperationNop}var hasRequiredLib$r;function requireLib$r(){return hasRequiredLib$r||(hasRequiredLib$r=1,function(n){var t=lib$r&&lib$r.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$r&&lib$r.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationNop(),n)}(lib$r)),lib$r}var lib$q={},ActorQueryOperationService={},hasRequiredActorQueryOperationService;function requireActorQueryOperationService(){if(hasRequiredActorQueryOperationService)return ActorQueryOperationService;hasRequiredActorQueryOperationService=1,Object.defineProperty(ActorQueryOperationService,"__esModule",{value:!0}),ActorQueryOperationService.ActorQueryOperationService=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$4l(),u=requireLib$43(),s=requireAsynciterator();let c=class extends n.ActorQueryOperationTypedMediated{constructor(d){super(d,"service")}async testOperation(d,f){return d.name.termType!=="NamedNode"?(0,r.failTest)(`${this.name} can only query services by IRI, while a ${d.name.termType} was given.`):(0,r.passTestVoid)()}async runOperation(d,f){const{querySource:h}=await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{value:d.name.value,type:this.forceSparqlEndpoint?"sparql":void 0},context:f});let v;try{v=(0,u.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:(0,u.assignOperationSource)(d.input,h),context:f}))}catch(g){if(d.silent){const b=f.getSafe(t.KeysInitQuery.dataFactory),_=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,f,b);v={bindingsStream:new s.SingletonIterator(_.bindings()),type:"bindings",metadata:async()=>({state:new o.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]})},this.logWarn(f,`An error occurred when executing a SERVICE clause: ${g.message}`)}else throw g}return v}};return ActorQueryOperationService.ActorQueryOperationService=c,ActorQueryOperationService}var hasRequiredLib$q;function requireLib$q(){return hasRequiredLib$q||(hasRequiredLib$q=1,function(n){var t=lib$q&&lib$q.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$q&&lib$q.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationService(),n)}(lib$q)),lib$q}var lib$p={},ActorQueryOperationValues={},hasRequiredActorQueryOperationValues;function requireActorQueryOperationValues(){if(hasRequiredActorQueryOperationValues)return ActorQueryOperationValues;hasRequiredActorQueryOperationValues=1,Object.defineProperty(ActorQueryOperationValues,"__esModule",{value:!0}),ActorQueryOperationValues.ActorQueryOperationValues=void 0;const n=requireLib$4k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$4l(),u=requireAsynciterator();let s=class extends n.ActorQueryOperationTyped{constructor(l){super(l,"values")}async testOperation(l,d){return(0,r.passTestVoid)()}async runOperation(l,d){const f=d.getSafe(t.KeysInitQuery.dataFactory),h=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d,f);return{type:"bindings",bindingsStream:new u.ArrayIterator(l.bindings.map(b=>h.bindings(Object.entries(b).map(([_,S])=>[f.variable(_.slice(1)),S])))),metadata:()=>Promise.resolve({state:new o.MetadataValidationState,cardinality:{type:"exact",value:l.bindings.length},variables:l.variables.map(b=>({variable:b,canBeUndef:l.bindings.some(_=>!(`?${b.value}`in _))}))})}}};return ActorQueryOperationValues.ActorQueryOperationValues=s,ActorQueryOperationValues}var hasRequiredLib$p;function requireLib$p(){return hasRequiredLib$p||(hasRequiredLib$p=1,function(n){var t=lib$p&&lib$p.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$p&&lib$p.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationValues(),n)}(lib$p)),lib$p}var lib$o={},ActorQueryOperationPathOneOrMore={},hasRequiredActorQueryOperationPathOneOrMore;function requireActorQueryOperationPathOneOrMore(){if(hasRequiredActorQueryOperationPathOneOrMore)return ActorQueryOperationPathOneOrMore;hasRequiredActorQueryOperationPathOneOrMore=1,Object.defineProperty(ActorQueryOperationPathOneOrMore,"__esModule",{value:!0}),ActorQueryOperationPathOneOrMore.ActorQueryOperationPathOneOrMore=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireLib$1A(),a=requireLib$43(),o=requireAsynciterator(),u=requireSparqlalgebrajs();let s=class extends n.ActorAbstractPath{constructor(l){super(l,u.Algebra.types.ONE_OR_MORE_PATH)}async runOperation(l,d){const f=d.getSafe(t.KeysInitQuery.dataFactory),h=new u.Factory(f),v=await r.BindingsFactory.create(this.mediatorMergeBindingsContext,d,f),g=await this.isPathArbitraryLengthDistinct(h,d,l);if(g.operation)return g.operation;d=g.context;const b=l.predicate;if(l.subject.termType!=="Variable"&&l.object.termType==="Variable"){const w=l.object,A=await this.getObjectsPredicateStarEval(l.subject,b.path,w,l.graph,d,!1,h,v),R=(l.graph.termType==="Variable"?[w,l.graph]:[w]).map(E=>({variable:E,canBeUndef:!1}));return{type:"bindings",bindingsStream:A.bindingsStream,metadata:async()=>({...await A.metadata(),variables:R})}}if(l.subject.termType==="Variable"&&l.object.termType==="Variable"){const w=h.createDistinct(h.createPath(l.subject,l.predicate.path,l.object,l.graph)),A=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:d,operation:w})),R=l.subject,E=l.object,I={},L=new o.MultiTransformIterator(A.bindingsStream,{multiTransform:D=>{const $=D.get(R),O=D.get(E),P=l.graph.termType==="Variable"?D.get(l.graph):l.graph;return new o.TransformIterator(async()=>{const C=new o.BufferedIterator;return await this.getSubjectAndObjectBindingsPredicateStar(R,E,$,O,b.path,P,d,I,{},C,{count:0},h,v),C.transform({transform(q,M,N){l.graph.termType==="Variable"&&(q=q.set(l.graph,P)),N(q),M()}})},{maxBufferSize:128})},autoStart:!1}),F=(l.graph.termType==="Variable"?[R,E,l.graph]:[R,E]).map(D=>({variable:D,canBeUndef:!1}));return{type:"bindings",bindingsStream:L,metadata:async()=>({...await A.metadata(),variables:F})}}if(l.subject.termType==="Variable"&&l.object.termType!=="Variable")return this.mediatorQueryOperation.mediate({context:d,operation:h.createPath(l.object,h.createOneOrMorePath(h.createInv(b.path)),l.subject,l.graph)});const _=this.generateVariable(f),S=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:d,operation:h.createPath(l.subject,b,_,l.graph)}));return{type:"bindings",bindingsStream:S.bindingsStream.transform({filter:w=>l.object.equals(w.get(_)),transform(w,A,R){const E=l.graph.termType==="Variable"?v.bindings([[l.graph,w.get(l.graph)]]):v.bindings();R(E),A()}}),metadata:async()=>({...await S.metadata(),variables:(l.graph.termType==="Variable"?[l.graph]:[]).map(w=>({variable:w,canBeUndef:!1}))})}}};return ActorQueryOperationPathOneOrMore.ActorQueryOperationPathOneOrMore=s,ActorQueryOperationPathOneOrMore}var hasRequiredLib$o;function requireLib$o(){return hasRequiredLib$o||(hasRequiredLib$o=1,function(n){var t=lib$o&&lib$o.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$o&&lib$o.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathOneOrMore(),n)}(lib$o)),lib$o}var lib$n={},ActorQueryOperationPathZeroOrMore={},hasRequiredActorQueryOperationPathZeroOrMore;function requireActorQueryOperationPathZeroOrMore(){if(hasRequiredActorQueryOperationPathZeroOrMore)return ActorQueryOperationPathZeroOrMore;hasRequiredActorQueryOperationPathZeroOrMore=1,Object.defineProperty(ActorQueryOperationPathZeroOrMore,"__esModule",{value:!0}),ActorQueryOperationPathZeroOrMore.ActorQueryOperationPathZeroOrMore=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireLib$1A(),a=requireLib$43(),o=requireAsynciterator(),u=requireRdfString(),s=requireSparqlalgebrajs();let c=class extends n.ActorAbstractPath{constructor(d){super(d,s.Algebra.types.ZERO_OR_MORE_PATH)}async runOperation(d,f){const h=f.getSafe(t.KeysInitQuery.dataFactory),v=new s.Factory(h),g=await r.BindingsFactory.create(this.mediatorMergeBindingsContext,f,h),b=await this.isPathArbitraryLengthDistinct(v,f,d);if(b.operation)return b.operation;f=b.context;const _=d.predicate,S=this.getPathSources(_),T=d.subject.termType==="Variable",w=d.object.termType==="Variable";if(d.subject.termType==="Variable"&&d.object.termType==="Variable"){const F=this.generateVariable(h,d),D=this.assignPatternSources(v,v.createPattern(d.subject,F,d.object,d.graph),S),$=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:f,operation:D})),O=d.subject,P=d.object,C=new Set,q={},M=new o.MultiTransformIterator($.bindingsStream,{multiTransform:G=>{const X=G.get(O),Y=G.get(P),W=d.graph.termType==="Variable"?G.get(d.graph):d.graph,te=(0,u.termToString)(X)+(0,u.termToString)(W),ue=(0,u.termToString)(Y)+(0,u.termToString)(W);return new o.TransformIterator(async()=>{if(C.has(te)&&C.has(ue))return new o.EmptyIterator;const fe=new o.BufferedIterator,re={count:0};return C.has(te)||(C.add(te),await this.getSubjectAndObjectBindingsPredicateStar(O,P,X,X,_.path,W,f,q,{},fe,re,v,g)),C.has(ue)||(C.add(ue),await this.getSubjectAndObjectBindingsPredicateStar(O,P,Y,Y,_.path,W,f,q,{},fe,re,v,g)),fe.transform({transform(ye,Te,Re){d.graph.termType==="Variable"&&(ye=ye.set(d.graph,W)),Re(ye),Te()}})})}}),N=(d.graph.termType==="Variable"?[O,d.object,d.graph]:[O,d.object]).map(G=>({variable:G,canBeUndef:!1}));return{type:"bindings",bindingsStream:M,metadata:async()=>({...await $.metadata(),variables:N})}}if(!T&&!w){const F=this.generateVariable(h),D=await this.getObjectsPredicateStarEval(d.subject,_.path,F,d.graph,f,!0,v,g);return{type:"bindings",bindingsStream:D.bindingsStream.transform({filter:O=>d.object.equals(O.get(F)),transform(O,P,C){const q=d.graph.termType==="Variable"?g.bindings([[d.graph,O.get(d.graph)]]):g.bindings();C(q),P()}}),metadata:async()=>({...await D.metadata(),variables:(d.graph.termType==="Variable"?[d.graph]:[]).map(O=>({variable:O,canBeUndef:!1}))})}}const A=T?d.object:d.subject,R=T?d.subject:d.object,E=T?v.createInv(_.path):_.path,I=await this.getObjectsPredicateStarEval(A,E,R,d.graph,f,!0,v,g),L=(d.graph.termType==="Variable"?[R,d.graph]:[R]).map(F=>({variable:F,canBeUndef:!1}));return{type:"bindings",bindingsStream:I.bindingsStream,metadata:async()=>({...await I.metadata(),variables:L})}}};return ActorQueryOperationPathZeroOrMore.ActorQueryOperationPathZeroOrMore=c,ActorQueryOperationPathZeroOrMore}var hasRequiredLib$n;function requireLib$n(){return hasRequiredLib$n||(hasRequiredLib$n=1,function(n){var t=lib$n&&lib$n.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$n&&lib$n.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathZeroOrMore(),n)}(lib$n)),lib$n}var lib$m={},ActorQueryOperationPathZeroOrOne={},hasRequiredActorQueryOperationPathZeroOrOne;function requireActorQueryOperationPathZeroOrOne(){if(hasRequiredActorQueryOperationPathZeroOrOne)return ActorQueryOperationPathZeroOrOne;hasRequiredActorQueryOperationPathZeroOrOne=1,Object.defineProperty(ActorQueryOperationPathZeroOrOne,"__esModule",{value:!0}),ActorQueryOperationPathZeroOrOne.ActorQueryOperationPathZeroOrOne=void 0;const n=requireLib$Z(),t=requireLib$4q(),r=requireLib$1A(),a=requireLib$4l(),o=requireLib$43(),u=requireAsynciterator(),s=requireSparqlalgebrajs();let c=class extends n.ActorAbstractPath{constructor(d){super(d,s.Algebra.types.ZERO_OR_ONE_PATH)}async runOperation(d,f){const h=f.getSafe(t.KeysInitQuery.dataFactory),v=new s.Factory(h),g=await r.BindingsFactory.create(this.mediatorMergeBindingsContext,f,h),b=d.predicate,_=this.getPathSources(b),S=[];if(d.subject.termType!=="Variable"&&d.object.termType!=="Variable"&&d.subject.equals(d.object))return{type:"bindings",bindingsStream:new u.SingletonIterator(g.bindings()),metadata:()=>Promise.resolve({state:new a.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]})};const T=await this.isPathArbitraryLengthDistinct(v,f,d);if(T.operation)return T.operation;f=T.context;const w=(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:f,operation:v.createPath(d.subject,b.path,d.object,d.graph)}));let A;if(d.subject.termType==="Variable"&&d.object.termType==="Variable"){const E=this.generateVariable(h,d),I=(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:f,operation:v.createFilter(this.assignPatternSources(v,v.createPattern(d.subject,E,d.object,d.graph),_),v.createOperatorExpression("=",[v.createTermExpression(d.subject),v.createTermExpression(d.object)]))})).bindingsStream.map(L=>L.delete(E));A=new u.UnionIterator([I,w.bindingsStream],{autoStart:!1})}else d.subject.termType==="Variable"&&S.push(g.bindings([[d.subject,d.object]])),d.object.termType==="Variable"&&S.push(g.bindings([[d.object,d.subject]])),A=w.bindingsStream.prepend(S);return{type:"bindings",bindingsStream:A,metadata:async()=>{const E=await w.metadata();return{...E,cardinality:{...E.cardinality,value:E.cardinality.value+1}}}}}};return ActorQueryOperationPathZeroOrOne.ActorQueryOperationPathZeroOrOne=c,ActorQueryOperationPathZeroOrOne}var hasRequiredLib$m;function requireLib$m(){return hasRequiredLib$m||(hasRequiredLib$m=1,function(n){var t=lib$m&&lib$m.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$m&&lib$m.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationPathZeroOrOne(),n)}(lib$m)),lib$m}var lib$l={},ActorQueryOperationUpdateDeleteInsert={},hasRequiredActorQueryOperationUpdateDeleteInsert;function requireActorQueryOperationUpdateDeleteInsert(){if(hasRequiredActorQueryOperationUpdateDeleteInsert)return ActorQueryOperationUpdateDeleteInsert;hasRequiredActorQueryOperationUpdateDeleteInsert=1,Object.defineProperty(ActorQueryOperationUpdateDeleteInsert,"__esModule",{value:!0}),ActorQueryOperationUpdateDeleteInsert.ActorQueryOperationUpdateDeleteInsert=void 0;const n=requireLib$16(),t=requireLib$4k(),r=requireLib$4q(),a=requireLib$1A(),o=requireLib$43(),u=requireAsynciterator();let s=class extends t.ActorQueryOperationTypedMediated{constructor(l){super(l,"deleteinsert"),this.blankNodeCounter=0}async testOperation(l,d){return(0,o.testReadOnly)(d)}async runOperation(l,d){const f=d.getSafe(r.KeysInitQuery.dataFactory),h=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d,f),v=l.where?(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:l.where,context:d})).bindingsStream:new u.ArrayIterator([h.bindings()],{autoStart:!1});let g,b;l.insert&&(g=new n.BindingsToQuadsIterator(f,l.insert.map(n.BindingsToQuadsIterator.localizeQuad.bind(null,f,this.blankNodeCounter)),v.clone()),this.blankNodeCounter++),l.delete&&(b=new n.BindingsToQuadsIterator(f,l.delete.map(n.BindingsToQuadsIterator.localizeQuad.bind(null,f,this.blankNodeCounter)),v.clone()),this.blankNodeCounter++);const{execute:_}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:g,quadStreamDelete:b,context:d});return{type:"void",execute:_}}};return ActorQueryOperationUpdateDeleteInsert.ActorQueryOperationUpdateDeleteInsert=s,ActorQueryOperationUpdateDeleteInsert}var hasRequiredLib$l;function requireLib$l(){return hasRequiredLib$l||(hasRequiredLib$l=1,function(n){var t=lib$l&&lib$l.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$l&&lib$l.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryOperationUpdateDeleteInsert(),n)}(lib$l)),lib$l}var lib$k={},ActorQueryProcessSequential={},lib$j={},ActorQueryProcess={},hasRequiredActorQueryProcess;function requireActorQueryProcess(){if(hasRequiredActorQueryProcess)return ActorQueryProcess;hasRequiredActorQueryProcess=1,Object.defineProperty(ActorQueryProcess,"__esModule",{value:!0}),ActorQueryProcess.ActorQueryProcess=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a)}};return ActorQueryProcess.ActorQueryProcess=t,ActorQueryProcess}var hasRequiredLib$k;function requireLib$k(){return hasRequiredLib$k||(hasRequiredLib$k=1,function(n){var t=lib$j&&lib$j.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$j&&lib$j.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryProcess(),n)}(lib$j)),lib$j}var hasRequiredActorQueryProcessSequential;function requireActorQueryProcessSequential(){if(hasRequiredActorQueryProcessSequential)return ActorQueryProcessSequential;hasRequiredActorQueryProcessSequential=1,Object.defineProperty(ActorQueryProcessSequential,"__esModule",{value:!0}),ActorQueryProcessSequential.ActorQueryProcessSequential=void 0;const n=requireLib$k(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$43(),u=requireSparqlalgebrajs();let s=class extends n.ActorQueryProcess{constructor(l){super(l)}async test(l){return l.context.get(t.KeysInitQuery.explain)??l.context.get(new r.ActionContextKey("explain"))?(0,r.failTest)(`${this.name} is not able to explain queries.`):(0,r.passTestVoid)()}async run(l){let{operation:d,context:f}=await this.parse(l.query,l.context);return{operation:d,context:f}=await this.optimize(d,f),{result:await this.evaluate(d,f)}}async parse(l,d){d=(await this.mediatorContextPreprocess.mediate({context:d,initialize:!0})).context;let f;if(typeof l=="string"){d=d.set(t.KeysInitQuery.queryString,l);const h=d.get(t.KeysInitQuery.baseIRI),v=d.get(t.KeysInitQuery.queryFormat),g=await this.mediatorQueryParse.mediate({context:d,query:l,queryFormat:v,baseIRI:h});f=g.operation,g.baseIRI&&(d=d.set(t.KeysInitQuery.baseIRI,g.baseIRI))}else f=l;if(d.has(t.KeysInitQuery.initialBindings)){const h=d.getSafe(t.KeysInitQuery.dataFactory),v=new u.Factory(h),g=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d,h);f=(0,o.materializeOperation)(f,d.get(t.KeysInitQuery.initialBindings),v,g),d=d.delete(t.KeysInitQuery.queryString)}return{operation:f,context:d}}async optimize(l,d){return d=d.set(t.KeysInitQuery.query,l),{operation:l,context:d}=await this.mediatorOptimizeQueryOperation.mediate({context:d,operation:l}),d=d.set(t.KeysInitQuery.query,l),{operation:l,context:d}}async evaluate(l,d){const f=await this.mediatorQueryOperation.mediate({context:d,operation:l});return f.context=d,f}};return ActorQueryProcessSequential.ActorQueryProcessSequential=s,ActorQueryProcessSequential}var hasRequiredLib$j;function requireLib$j(){return hasRequiredLib$j||(hasRequiredLib$j=1,function(n){var t=lib$k&&lib$k.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$k&&lib$k.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryProcessSequential(),n)}(lib$k)),lib$k}var lib$i={},ActorQuerySourceIdentifyHypermedia={},QuerySourceHypermedia={},MediatedLinkedRdfSourcesAsyncRdfIterator={},LinkedRdfSourcesAsyncRdfIterator={},hasRequiredLinkedRdfSourcesAsyncRdfIterator;function requireLinkedRdfSourcesAsyncRdfIterator(){if(hasRequiredLinkedRdfSourcesAsyncRdfIterator)return LinkedRdfSourcesAsyncRdfIterator;hasRequiredLinkedRdfSourcesAsyncRdfIterator=1,Object.defineProperty(LinkedRdfSourcesAsyncRdfIterator,"__esModule",{value:!0}),LinkedRdfSourcesAsyncRdfIterator.LinkedRdfSourcesAsyncRdfIterator=void 0;const n=requireLib$4q(),t=requireLib$4l(),r=requireAsynciterator();let a=class extends r.BufferedIterator{constructor(u,s,c,l,d,f,h,v){if(super({autoStart:!1,...v}),this.started=!1,this.currentIterators=[],this.iteratorsPendingCreation=0,this.iteratorsPendingTermination=0,this.accumulatedMetadata=Promise.resolve(void 0),this._reading=!1,this.cacheSize=u,this.operation=s,this.queryBindingsOptions=c,this.context=l,this.firstUrl=d,this.maxIterators=f,this.sourceStateGetter=h,this.maxIterators<=0)throw new Error(`LinkedRdfSourcesAsyncRdfIterator.maxIterators must be larger than zero, but got ${this.maxIterators}`)}kickstart(){this.started||this._fillBufferAsync()}getProperty(u,s){return u==="metadata"&&!this.started&&(this.preflightMetadata||(this.preflightMetadata=new Promise((c,l)=>{this.sourceStateGetter({url:this.firstUrl},{}).then(d=>{const f=d.source.queryBindings(this.operation,this.context);f.getProperty("metadata",h=>{h.state=new t.MetadataValidationState,f.destroy(),this.accumulateMetadata(d.metadata,h).then(v=>{const g={...d.metadata,...h,...v};c(g)}).catch(()=>{c({...d.metadata,state:new t.MetadataValidationState})})})}).catch(l)})),this.preflightMetadata.then(c=>this.setProperty("metadata",c)).catch(()=>{})),super.getProperty(u,s)}_end(u){for(const s of this.currentIterators)s.destroy();super._end(u)}_read(u,s){if(this.started){for(const c of this.currentIterators){for(;u>0;){const l=c.read();if(l===null)break;u--,this._push(l)}if(u<=0)break}u>=0&&this.canStartNewIterator()?this.sourceStateGetter({url:this.firstUrl},{}).then(c=>{this.startIteratorsForNextUrls(c.handledDatasets,!1),s()}):s()}else this.started=!0,this.sourceStateGetter({url:this.firstUrl},{}).then(c=>{this.startIterator(c),s()}).catch(c=>setTimeout(()=>this.destroy(c)))}canStartNewIterator(){return this.currentIterators.length+this.iteratorsPendingCreation+this.iteratorsPendingTermination<this.maxIterators&&(!this.canStartNewIteratorConsiderReadable()||!this.readable)}canStartNewIteratorConsiderReadable(){return!0}areIteratorsRunning(){return this.currentIterators.length+this.iteratorsPendingCreation+this.iteratorsPendingTermination>0}startIterator(u){try{const s=u.source.queryBindings(this.operation,this.context,this.queryBindingsOptions);this.currentIterators.push(s);let c=!1,l=!1;s._destination=this,s.on("error",d=>this.destroy(d)),s.on("readable",()=>this._fillBuffer()),s.on("end",()=>{this.currentIterators.splice(this.currentIterators.indexOf(s),1),c=!0,l||this.iteratorsPendingTermination++,l&&this.startIteratorsForNextUrls(u.handledDatasets,!0)}),s.getProperty("metadata",d=>{this.accumulatedMetadata=this.accumulatedMetadata.then(f=>(async()=>(f||(f=u.metadata),this.accumulateMetadata(f,d)))().then(h=>{const v={...u.metadata,...d,...h};return v.state=new t.MetadataValidationState,this.updateMetadata(v),this.preflightMetadata&&this.preflightMetadata.then(g=>g.state.invalidate()).catch(()=>{}),this.getSourceLinks(v,u).then(g=>Promise.all(g)).then(async g=>{const b=await this.getLinkQueue();for(const _ of g)b.push(_,u.link);l=!0,c&&this.iteratorsPendingTermination--,this.startIteratorsForNextUrls(u.handledDatasets,!0)}).catch(g=>this.destroy(g)),v})).catch(f=>(this.destroy(f),{}))})}catch(s){this.destroy(s)}}updateMetadata(u){const s=this.getProperty("metadata");this.setProperty("metadata",u),s==null||s.state.invalidate()}isRunning(){return!this.done}startIteratorsForNextUrls(u,s){this.getLinkQueue().then(c=>{for(;this.canStartNewIterator()&&this.isRunning();){const l=c.pop();if(l)this.iteratorsPendingCreation++,this.sourceStateGetter(l,u).then(d=>{const f=this.context.get(n.KeysStatistics.dereferencedLinks);f&&f.updateStatistic({url:d.link.url,metadata:{...d.metadata,...d.link.metadata}},d.source),this.iteratorsPendingCreation--,this.startIterator(d)}).catch(d=>this.emit("error",d));else break}s&&this.isCloseable(c,!0)&&this.close()}).catch(c=>this.destroy(c))}isCloseable(u,s){return u.isEmpty()&&!this.areIteratorsRunning()}};return LinkedRdfSourcesAsyncRdfIterator.LinkedRdfSourcesAsyncRdfIterator=a,LinkedRdfSourcesAsyncRdfIterator}var hasRequiredMediatedLinkedRdfSourcesAsyncRdfIterator;function requireMediatedLinkedRdfSourcesAsyncRdfIterator(){if(hasRequiredMediatedLinkedRdfSourcesAsyncRdfIterator)return MediatedLinkedRdfSourcesAsyncRdfIterator;hasRequiredMediatedLinkedRdfSourcesAsyncRdfIterator=1,Object.defineProperty(MediatedLinkedRdfSourcesAsyncRdfIterator,"__esModule",{value:!0}),MediatedLinkedRdfSourcesAsyncRdfIterator.MediatedLinkedRdfSourcesAsyncRdfIterator=void 0;const n=requireLib$4q(),t=requireLinkedRdfSourcesAsyncRdfIterator();let r=class extends t.LinkedRdfSourcesAsyncRdfIterator{constructor(o,u,s,c,l,d,f,h,v,g,b,_,S,T){super(o,u,s,c,d,f,h,v?{maxBufferSize:Number.POSITIVE_INFINITY}:void 0),this.wasForcefullyClosed=!1,this.forceSourceType=l,this.mediatorMetadataAccumulate=g,this.mediatorRdfResolveHypermediaLinks=b,this.mediatorRdfResolveHypermediaLinksQueue=_,this.handledUrls={[d]:!0},this.aggregatedStore=v,this.dataFactory=S,this.algebraFactory=T}close(){if(!this.aggregatedStore){super.close();return}this.getLinkQueue().then(o=>{this.isCloseable(o,!1)?(this.aggregatedStore&&setTimeout(()=>this.aggregatedStore.end()),super.close()):this.wasForcefullyClosed=!0}).catch(o=>super.destroy(o))}destroy(o){if(!this.aggregatedStore){super.destroy(o);return}this.getLinkQueue().then(u=>{o??this.isCloseable(u,!1)?(this.aggregatedStore&&setTimeout(()=>this.aggregatedStore.end()),super.destroy(o)):this.wasForcefullyClosed=!0}).catch(u=>super.destroy(u))}isCloseable(o,u){return(u?o.isEmpty():this.wasForcefullyClosed||o.isEmpty())&&!this.areIteratorsRunning()}canStartNewIterator(){return!this.wasForcefullyClosed&&this.aggregatedStore&&this.aggregatedStore.hasRunningIterators()||super.canStartNewIterator()}canStartNewIteratorConsiderReadable(){return!this.aggregatedStore}isRunning(){return this.aggregatedStore&&this.aggregatedStore.hasRunningIterators()||!this.done}getLinkQueue(){return this.linkQueue||(this.linkQueue=this.mediatorRdfResolveHypermediaLinksQueue.mediate({firstUrl:this.firstUrl,context:this.context}).then(o=>o.linkQueue)),this.linkQueue}async getSourceLinks(o,u){try{const{links:s}=await this.mediatorRdfResolveHypermediaLinks.mediate({context:this.context,metadata:o}),c=this.context.get(n.KeysStatistics.discoveredLinks);if(c)for(const l of s)c.updateStatistic({url:l.url,metadata:{...l.metadata}},u.link);return s.filter(l=>this.handledUrls[l.url]?!1:(this.handledUrls[l.url]=!0,!0))}catch{return[]}}startIterator(o){var u;if(this.aggregatedStore&&!this.aggregatedStore.containedSources.has(o.link.url)){(u=this.aggregatedStore)==null||u.containedSources.add(o.link.url);const s=o.source.queryBindings(this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")),this.context.set(n.KeysQueryOperation.unionDefaultGraph,!0)).map(c=>this.dataFactory.quad(c.get("s"),c.get("p"),c.get("o"),c.get("g")));this.aggregatedStore.import(s).on("end",()=>{super.startIterator(o)})}else super.startIterator(o)}async accumulateMetadata(o,u){return(await this.mediatorMetadataAccumulate.mediate({mode:"append",accumulatedMetadata:o,appendingMetadata:u,context:this.context})).metadata}updateMetadata(o){var u;super.updateMetadata(o),(u=this.aggregatedStore)==null||u.setBaseMetadata(o,!0)}};return MediatedLinkedRdfSourcesAsyncRdfIterator.MediatedLinkedRdfSourcesAsyncRdfIterator=r,MediatedLinkedRdfSourcesAsyncRdfIterator}var StreamingStoreMetadata={},rdfStreamingStore={},PendingStreamsIndex={},hasRequiredPendingStreamsIndex;function requirePendingStreamsIndex(){if(hasRequiredPendingStreamsIndex)return PendingStreamsIndex;hasRequiredPendingStreamsIndex=1,Object.defineProperty(PendingStreamsIndex,"__esModule",{value:!0}),PendingStreamsIndex.PendingStreamsIndex=void 0;const n=requireRdfString(),t=requireRdfTerms();let r=class Dr{constructor(){this.indexedStreams=new Map,this.allStreams=[]}termToString(o){return o&&o.termType!=="Variable"?(0,n.termToString)(o):Dr.ID_VARIABLE}addPatternListener(o,u,s,c,l){this.allStreams.push(o);const d=`${this.termToString(u)}${Dr.ID_SEPARATOR}${this.termToString(s)}${Dr.ID_SEPARATOR}${this.termToString(c)}${Dr.ID_SEPARATOR}${this.termToString(l)}`;let f=this.indexedStreams.get(d);f||(f=[],this.indexedStreams.set(d,f)),f.push(o)}getPendingStreamsForQuad(o){let u=[(0,t.getTerms)(o).map(c=>(0,n.termToString)(c))];for(let c=0;c<t.QUAD_TERM_NAMES.length;c++){const l=u;u=[];for(const d of l){u.push(d);const f=[...d];f[c]=Dr.ID_VARIABLE,u.push(f)}}const s=[];for(const c of u){const l=this.indexedStreams.get(c.join(Dr.ID_SEPARATOR));l&&s.push(...l)}return s}};return r.ID_VARIABLE="?",r.ID_SEPARATOR=":",PendingStreamsIndex.PendingStreamsIndex=r,PendingStreamsIndex}var StreamingStore={},hasRequiredStreamingStore;function requireStreamingStore(){if(hasRequiredStreamingStore)return StreamingStore;hasRequiredStreamingStore=1;var n=StreamingStore&&StreamingStore.__asyncValues||function(c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=c[Symbol.asyncIterator],d;return l?l.call(c):(c=typeof __values=="function"?__values(c):c[Symbol.iterator](),d={},f("next"),f("throw"),f("return"),d[Symbol.asyncIterator]=function(){return this},d);function f(v){d[v]=c[v]&&function(g){return new Promise(function(b,_){g=c[v](g),h(b,_,g.done,g.value)})}}function h(v,g,b,_){Promise.resolve(_).then(function(S){v({value:S,done:b})},g)}},t=StreamingStore&&StreamingStore.__await||function(c){return this instanceof t?(this.v=c,this):new t(c)},r=StreamingStore&&StreamingStore.__asyncGenerator||function(c,l,d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var f=d.apply(c,l||[]),h,v=[];return h={},g("next"),g("throw"),g("return"),h[Symbol.asyncIterator]=function(){return this},h;function g(A){f[A]&&(h[A]=function(R){return new Promise(function(E,I){v.push([A,R,E,I])>1||b(A,R)})})}function b(A,R){try{_(f[A](R))}catch(E){w(v[0][3],E)}}function _(A){A.value instanceof t?Promise.resolve(A.value.v).then(S,T):w(v[0][2],A)}function S(A){b("next",A)}function T(A){b("throw",A)}function w(A,R){A(R),v.shift(),v.length&&b(v[0][0],v[0][1])}};Object.defineProperty(StreamingStore,"__esModule",{value:!0}),StreamingStore.StreamingStore=void 0;const a=require$$0,o=requireBrowser(),u=requirePendingStreamsIndex();let s=class pa{constructor(l=new a.Store){this.pendingStreams=new u.PendingStreamsIndex,this.ended=!1,this.store=l}end(){this.ended=!0;for(const l of this.pendingStreams.allStreams)l.push(null)}importToListeners(l){l.on("data",d=>{if(!this.ended&&!this.store.countQuads(d.subject,d.predicate,d.object,d.graph))for(const f of this.pendingStreams.getPendingStreamsForQuad(d))f.isInitialized&&(f.push(d),f.emit("quad",d))})}static concatStreams(l){return r(this,arguments,function*(){var f,h,v,g;for(const T of l)try{for(var b=!0,_=(h=void 0,n(T)),S;S=yield t(_.next()),f=S.done,!f;){g=S.value,b=!1;try{yield yield t(g)}finally{b=!0}}}catch(w){h={error:w}}finally{try{!b&&!f&&(v=_.return)&&(yield t(v.call(_)))}finally{if(h)throw h.error}}})}import(l){if(this.ended)throw new Error("Attempted to import into an ended StreamingStore");return this.importToListeners(l),this.store.import(l)}match(l,d,f,h){const v=this.store.match(l,d,f,h);let g=v;if(!this.ended){const b=new o.PassThrough({objectMode:!0});this.pendingStreams.addPatternListener(b,l,d,f,h),g=o.Readable.from(pa.concatStreams([v,b])),g._pipeSource=v;const _=v._read;v._read=S=>{b.isInitialized=!0,_.call(v,S)}}return g}getStore(){return this.store}};return StreamingStore.StreamingStore=s,StreamingStore}var hasRequiredRdfStreamingStore;function requireRdfStreamingStore(){return hasRequiredRdfStreamingStore||(hasRequiredRdfStreamingStore=1,function(n){var t=rdfStreamingStore&&rdfStreamingStore.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=rdfStreamingStore&&rdfStreamingStore.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requirePendingStreamsIndex(),n),r(requireStreamingStore(),n)}(rdfStreamingStore)),rdfStreamingStore}var hasRequiredStreamingStoreMetadata;function requireStreamingStoreMetadata(){if(hasRequiredStreamingStoreMetadata)return StreamingStoreMetadata;hasRequiredStreamingStoreMetadata=1,Object.defineProperty(StreamingStoreMetadata,"__esModule",{value:!0}),StreamingStoreMetadata.StreamingStoreMetadata=void 0;const n=requireLib$1I(),t=requireLib$4l(),r=requireRdfStreamingStore();let a=class extends r.StreamingStore{constructor(u,s){super(u),this.started=!1,this.containedSources=new Set,this.runningIterators=new Set,this.iteratorCreatedListeners=new Set,this.baseMetadata={state:new t.MetadataValidationState,cardinality:{type:"exact",value:0},variables:[]},this.metadataAccumulator=s}import(u){return this.ended||super.import(u),u}hasRunningIterators(){return this.runningIterators.size>0}match(u,s,c,l){const d=super.match(u,s,c,l),f=new n.ClosableTransformIterator(d,{autoStart:!1,onClose:()=>{this.runningIterators.delete(f)}});let h=this.getStore().countQuads(u,s,c,l);const v={state:new t.MetadataValidationState,cardinality:{type:"estimate",value:h}};f.setProperty("metadata",v),f.setProperty("lastCount",h),d.on("quad",()=>{f.setProperty("lastCount",++h),this.updateMetadataState(f,h)}),this.runningIterators.add(f);for(const g of this.iteratorCreatedListeners)g();return f}setBaseMetadata(u,s){if(this.baseMetadata={...u},this.baseMetadata.cardinality={type:"exact",value:0},s)for(const c of this.runningIterators){const l=c.getProperty("lastCount");this.updateMetadataState(c,l)}}updateMetadataState(u,s){const c={state:new t.MetadataValidationState,cardinality:{type:"estimate",value:s},variables:[]};this.metadataAccumulator(this.baseMetadata,c).then(l=>{l.state=new t.MetadataValidationState;const d=u.getProperty("metadata");u.setProperty("metadata",l),d==null||d.state.invalidate()}).catch(()=>{})}addIteratorCreatedListener(u){this.iteratorCreatedListeners.add(u)}removeIteratorCreatedListener(u){this.iteratorCreatedListeners.delete(u)}};return StreamingStoreMetadata.StreamingStoreMetadata=a,StreamingStoreMetadata}var hasRequiredQuerySourceHypermedia;function requireQuerySourceHypermedia(){if(hasRequiredQuerySourceHypermedia)return QuerySourceHypermedia;hasRequiredQuerySourceHypermedia=1,Object.defineProperty(QuerySourceHypermedia,"__esModule",{value:!0}),QuerySourceHypermedia.QuerySourceHypermedia=void 0;const n=requireLib$w(),t=requireLib$4q(),r=requireAsynciterator(),a=requireCommonjs$1(),o=requireBrowser(),u=requireSparqlalgebrajs(),s=requireMediatedLinkedRdfSourcesAsyncRdfIterator(),c=requireStreamingStoreMetadata();let l=class{constructor(f,h,v,g,b,_,S,T,w){this.referenceValue=h,this.cacheSize=f,this.firstUrl=h,this.forceSourceType=v,this.maxIterators=g,this.mediators=_,this.aggregateStore=b,this.logWarning=S,this.dataFactory=T,this.bindingsFactory=w,this.sourcesState=new a.LRUCache({max:this.cacheSize})}async getSelectorShape(f){return(await this.getSourceCached({url:this.firstUrl},{},f,this.getAggregateStore(f))).source.getSelectorShape(f)}queryBindings(f,h,v){const g=this.getAggregateStore(h);if(g&&f.type==="pattern"&&g.started)return new n.QuerySourceRdfJs(g,h.getSafe(t.KeysInitQuery.dataFactory),this.bindingsFactory).queryBindings(f,h);this.sourcesState.size===0&&this.getSourceCached({url:this.firstUrl},{},h,g).catch(T=>S.destroy(T));const b=h.getSafe(t.KeysInitQuery.dataFactory),_=new u.Factory(b),S=new s.MediatedLinkedRdfSourcesAsyncRdfIterator(this.cacheSize,f,v,h,this.forceSourceType,this.firstUrl,this.maxIterators,(T,w)=>this.getSourceCached(T,w,h,g),g,this.mediators.mediatorMetadataAccumulate,this.mediators.mediatorRdfResolveHypermediaLinks,this.mediators.mediatorRdfResolveHypermediaLinksQueue,b,_);if(g){g.started=!0;const T=()=>S.kickstart();g.addIteratorCreatedListener(T),S.on("end",()=>g.removeIteratorCreatedListener(T))}return S}queryQuads(f,h){return new r.TransformIterator(async()=>(await this.getSourceCached({url:this.firstUrl},{},h,this.getAggregateStore(h))).source.queryQuads(f,h))}async queryBoolean(f,h){return await(await this.getSourceCached({url:this.firstUrl},{},h,this.getAggregateStore(h))).source.queryBoolean(f,h)}async queryVoid(f,h){return await(await this.getSourceCached({url:this.firstUrl},{},h,this.getAggregateStore(h))).source.queryVoid(f,h)}async getSource(f,h,v,g){var A;f.context&&(v=v.merge(f.context));let b=f.url,_,S;try{const R=await this.mediators.mediatorDereferenceRdf.mediate({context:v,url:b});b=R.url;const E=await this.mediators.mediatorMetadata.mediate({context:v,url:b,quads:R.data,triples:(A=R.metadata)==null?void 0:A.triples});E.data.on("error",()=>{}),S=(await this.mediators.mediatorMetadataExtract.mediate({context:v,url:b,metadata:E.metadata,headers:R.headers,requestTime:R.requestTime})).metadata,_=E.data,f.transform&&(_=await f.transform(_))}catch(R){_=new o.Readable,_.read=()=>(setTimeout(()=>_.emit("error",R)),null),{metadata:S}=await this.mediators.mediatorMetadataAccumulate.mediate({context:v,mode:"initialize"}),this.logWarning(`Metadata extraction for ${b} failed: ${R.message}`)}g==null||g.setBaseMetadata(S,!1),g==null||g.containedSources.add(f.url),g==null||g.import(_);const{source:T,dataset:w}=await this.mediators.mediatorQuerySourceIdentifyHypermedia.mediate({context:v,forceSourceType:f.url===this.firstUrl?this.forceSourceType:void 0,handledDatasets:h,metadata:S,quads:_,url:b});return w&&(h[w]=!0),{link:f,source:T,metadata:S,handledDatasets:h}}getSourceCached(f,h,v,g){let b=this.sourcesState.get(f.url);return b||(b=this.getSource(f,h,v,g),(f.url===this.firstUrl||g===void 0)&&this.sourcesState.set(f.url,b),b)}getAggregateStore(f){let h;if(this.aggregateStore){const v=f.get(t.KeysQuerySourceIdentify.hypermediaSourcesAggregatedStores);if(v)return h=v.get(this.firstUrl),h||(h=new c.StreamingStoreMetadata(void 0,async(g,b)=>(await this.mediators.mediatorMetadataAccumulate.mediate({mode:"append",accumulatedMetadata:g,appendingMetadata:b,context:f})).metadata),v.set(this.firstUrl,h)),h}}toString(){return`QuerySourceHypermedia(${this.firstUrl})`}};return QuerySourceHypermedia.QuerySourceHypermedia=l,QuerySourceHypermedia}var hasRequiredActorQuerySourceIdentifyHypermedia;function requireActorQuerySourceIdentifyHypermedia(){if(hasRequiredActorQuerySourceIdentifyHypermedia)return ActorQuerySourceIdentifyHypermedia;hasRequiredActorQuerySourceIdentifyHypermedia=1,Object.defineProperty(ActorQuerySourceIdentifyHypermedia,"__esModule",{value:!0}),ActorQuerySourceIdentifyHypermedia.ActorQuerySourceIdentifyHypermedia=void 0;const n=requireLib$z(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireQuerySourceHypermedia();let u=class extends n.ActorQuerySourceIdentify{constructor(c){super(c)}async test(c){return typeof c.querySourceUnidentified.value!="string"?(0,r.failTest)(`${this.name} requires a single query source with a URL value to be present in the context.`):(0,r.passTestVoid)()}async run(c){var d;const l=c.context.getSafe(t.KeysInitQuery.dataFactory);return{querySource:{source:new o.QuerySourceHypermedia(this.cacheSize,c.querySourceUnidentified.value,c.querySourceUnidentified.type,this.maxIterators,this.aggregateTraversalStore&&!!((d=c.querySourceUnidentified.context)!=null&&d.get(t.KeysQuerySourceIdentify.traverse)),{mediatorMetadata:this.mediatorMetadata,mediatorMetadataExtract:this.mediatorMetadataExtract,mediatorMetadataAccumulate:this.mediatorMetadataAccumulate,mediatorDereferenceRdf:this.mediatorDereferenceRdf,mediatorQuerySourceIdentifyHypermedia:this.mediatorQuerySourceIdentifyHypermedia,mediatorRdfResolveHypermediaLinks:this.mediatorRdfResolveHypermediaLinks,mediatorRdfResolveHypermediaLinksQueue:this.mediatorRdfResolveHypermediaLinksQueue},f=>this.logWarn(c.context,f),l,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,c.context,l)),context:c.querySourceUnidentified.context??new r.ActionContext}}}};return ActorQuerySourceIdentifyHypermedia.ActorQuerySourceIdentifyHypermedia=u,ActorQuerySourceIdentifyHypermedia}var hasRequiredLib$i;function requireLib$i(){return hasRequiredLib$i||(hasRequiredLib$i=1,function(n){var t=lib$i&&lib$i.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$i&&lib$i.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifyHypermedia(),n),r(requireQuerySourceHypermedia(),n)}(lib$i)),lib$i}var lib$h={},ActorRdfJoinNone={},hasRequiredActorRdfJoinNone;function requireActorRdfJoinNone(){if(hasRequiredActorRdfJoinNone)return ActorRdfJoinNone;hasRequiredActorRdfJoinNone=1,Object.defineProperty(ActorRdfJoinNone,"__esModule",{value:!0}),ActorRdfJoinNone.ActorRdfJoinNone=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$4l(),u=requireAsynciterator();let s=class extends n.ActorRdfJoin{constructor(l){super(l,{logicalType:"inner",physicalName:"none",limitEntries:0})}async test(l){return l.entries.length>0?(0,r.failTest)(`Actor ${this.name} can only join zero entries`):await this.getJoinCoefficients(l,void 0)}async getOutput(l){const d=l.context.getSafe(t.KeysInitQuery.dataFactory),f=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,l.context,d);return{result:{bindingsStream:new u.ArrayIterator([f.bindings()],{autoStart:!1}),metadata:()=>Promise.resolve({state:new o.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]}),type:"bindings"}}}async getJoinCoefficients(l,d){return(0,r.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},d)}};return ActorRdfJoinNone.ActorRdfJoinNone=s,ActorRdfJoinNone}var hasRequiredLib$h;function requireLib$h(){return hasRequiredLib$h||(hasRequiredLib$h=1,function(n){var t=lib$h&&lib$h.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$h&&lib$h.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinNone(),n)}(lib$h)),lib$h}var lib$g={},ActorRdfJoinOptionalBind={},lib$f={},ActorRdfJoinMultiBind={},hasRequiredActorRdfJoinMultiBind;function requireActorRdfJoinMultiBind(){if(hasRequiredActorRdfJoinMultiBind)return ActorRdfJoinMultiBind;hasRequiredActorRdfJoinMultiBind=1,Object.defineProperty(ActorRdfJoinMultiBind,"__esModule",{value:!0}),ActorRdfJoinMultiBind.ActorRdfJoinMultiBind=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$43(),u=requireAsynciterator(),s=requireSparqlalgebrajs();let c=class va extends n.ActorRdfJoin{constructor(d){super(d,{logicalType:"inner",physicalName:"bind",canHandleUndefs:!0,isLeaf:!1})}static createBindStream(d,f,h,v,g,b,_){const S=d==="depth-first",T=w=>{const A=h.map(E=>(0,o.materializeOperation)(E,w,b,_,{bindFilter:!0})),R=E=>E.merge(w);return new u.TransformIterator(async()=>(await v(A,w)).transform({map:R}),{maxBufferSize:128,autoStart:S})};switch(d){case"depth-first":return new u.MultiTransformIterator(f,{autoStart:!1,multiTransform:T,optional:g});case"breadth-first":return new u.UnionIterator(f.transform({map:T,optional:g}),{autoStart:!1});default:throw new Error(`Received request for unknown bind order: ${d}`)}}async getOutput(d,f){const h=d.context.getSafe(t.KeysInitQuery.dataFactory),v=new s.Factory(h),g=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,d.context,h),b=f.entriesSorted;this.logDebug(d.context,"First entry for Bind Join: ",()=>({entry:b[0].operation,metadata:b[0].metadata}));for(const[A,R]of b.entries())A!==0&&R.output.bindingsStream.close();const _=b[0].output,S=[...b];S.splice(0,1);const T=d.context.set(t.KeysQueryOperation.joinLeftMetadata,b[0].metadata).set(t.KeysQueryOperation.joinRightMetadatas,S.map(A=>A.metadata));return{result:{type:"bindings",bindingsStream:va.createBindStream(this.bindOrder,_.bindingsStream,S.map(A=>A.operation),async(A,R)=>{const E=A.length===1?A[0]:v.createJoin(A);return(0,o.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:E,context:T==null?void 0:T.set(t.KeysQueryOperation.joinBindings,R)})).bindingsStream},!1,v,g),metadata:()=>this.constructResultMetadata(b,b.map(A=>A.metadata),d.context)},physicalPlanMetadata:{bindIndex:f.entriesUnsorted.indexOf(b[0]),bindOperation:b[0].operation,bindOperationCardinality:b[0].metadata.cardinality,bindOrder:this.bindOrder}}}canBindWithOperation(d){let f=!0;return s.Util.recurseOperation(d,{[s.Algebra.types.EXTEND](){return f=!1,!1},[s.Algebra.types.GROUP](){return f=!1,!1}}),f}async getJoinCoefficients(d,f){let{metadatas:h}=f;const v=d.entries.map((D,$)=>({...D,metadata:h[$]})),g=await n.ActorRdfJoin.sortJoinEntries(this.mediatorJoinEntriesSort,v,d.context);if(g.isFailed())return g;const b=g.get();h=b.map(D=>D.metadata);const _=n.ActorRdfJoin.getRequestInitialTimes(h),S=n.ActorRdfJoin.getRequestItemTimes(h),T=[...b],w=[..._],A=[...S];if(T.splice(0,1),w.splice(0,1),A.splice(0,1),T.some(D=>!this.canBindWithOperation(D.operation)))return(0,r.failTest)(`Actor ${this.name} can not bind on Extend and Group operations`);if(T.some(D=>D.operationModified))return(0,r.failTest)(`Actor ${this.name} can not be used over remaining entries with modified operations`);const R=S.some(D=>D>0);if(h[0].cardinality.value*this.minMaxCardinalityRatio/(R?1:3)>Math.max(...h.map(D=>D.cardinality.value)))return(0,r.failTest)(`Actor ${this.name} can only run if the smallest stream is much smaller than largest stream`);const E=await Promise.all(T.map(async D=>(await this.mediatorJoinSelectivity.mediate({entries:[b[0],D],context:d.context})).selectivity*this.selectivityModifier)),I=T.map((D,$)=>D.metadata.cardinality.value*E[$]).reduce((D,$)=>D+$,0),L=w.reduce((D,$)=>D+$,0),F=A.reduce((D,$)=>D+$,0);return(0,r.passTestWithSideData)({iterations:h[0].cardinality.value*I,persistedItems:0,blockingItems:0,requestTime:_[0]+h[0].cardinality.value*(S[0]+L+I*F)},{...f,entriesUnsorted:v,entriesSorted:b})}};return ActorRdfJoinMultiBind.ActorRdfJoinMultiBind=c,ActorRdfJoinMultiBind}var hasRequiredLib$g;function requireLib$g(){return hasRequiredLib$g||(hasRequiredLib$g=1,function(n){var t=lib$f&&lib$f.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$f&&lib$f.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMultiBind(),n)}(lib$f)),lib$f}var hasRequiredActorRdfJoinOptionalBind;function requireActorRdfJoinOptionalBind(){if(hasRequiredActorRdfJoinOptionalBind)return ActorRdfJoinOptionalBind;hasRequiredActorRdfJoinOptionalBind=1,Object.defineProperty(ActorRdfJoinOptionalBind,"__esModule",{value:!0}),ActorRdfJoinOptionalBind.ActorRdfJoinOptionalBind=void 0;const n=requireLib$g(),t=requireLib$1H(),r=requireLib$4q(),a=requireLib$4s(),o=requireLib$1A(),u=requireLib$43(),s=requireSparqlalgebrajs();let c=class extends t.ActorRdfJoin{constructor(d){super(d,{logicalType:"optional",physicalName:"bind",limitEntries:2,canHandleUndefs:!0,isLeaf:!1,requiresVariableOverlap:!0})}async getOutput(d){const f=d.context.getSafe(r.KeysInitQuery.dataFactory),h=new s.Factory(f),v=await o.BindingsFactory.create(this.mediatorMergeBindingsContext,d.context,f);d.entries[1].output.bindingsStream.close();const g=d.context.set(r.KeysQueryOperation.joinLeftMetadata,await d.entries[0].output.metadata()).set(r.KeysQueryOperation.joinRightMetadatas,[await d.entries[1].output.metadata()]);return{result:{type:"bindings",bindingsStream:n.ActorRdfJoinMultiBind.createBindStream(this.bindOrder,d.entries[0].output.bindingsStream,[d.entries[1].operation],async(_,S)=>{const T=_[0];return(0,u.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:T,context:g==null?void 0:g.set(r.KeysQueryOperation.joinBindings,S)})).bindingsStream},!0,h,v),metadata:async()=>await this.constructResultMetadata(d.entries,await t.ActorRdfJoin.getMetadatas(d.entries),d.context,{},!0)}}}async getJoinCoefficients(d,f){const{metadatas:h}=f,v=t.ActorRdfJoin.getRequestInitialTimes(h),g=t.ActorRdfJoin.getRequestItemTimes(h);if(d.entries[1].operation.type===s.Algebra.types.EXTEND||d.entries[1].operation.type===s.Algebra.types.GROUP)return(0,a.failTest)(`Actor ${this.name} can not bind on Extend and Group operations`);const b=(await this.mediatorJoinSelectivity.mediate({entries:d.entries,context:d.context})).selectivity*this.selectivityModifier;return(0,a.passTestWithSideData)({iterations:h[0].cardinality.value*h[1].cardinality.value*b,persistedItems:0,blockingItems:0,requestTime:v[0]+h[0].cardinality.value*(g[0]+v[1]+b*h[1].cardinality.value*g[1])},f)}};return ActorRdfJoinOptionalBind.ActorRdfJoinOptionalBind=c,ActorRdfJoinOptionalBind}var hasRequiredLib$f;function requireLib$f(){return hasRequiredLib$f||(hasRequiredLib$f=1,function(n){var t=lib$g&&lib$g.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$g&&lib$g.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinOptionalBind(),n)}(lib$g)),lib$g}var lib$e={},ActorTermComparatorFactoryExpressionEvaluator={},lib$d={},ActorTermComparatorFactory={},hasRequiredActorTermComparatorFactory;function requireActorTermComparatorFactory(){if(hasRequiredActorTermComparatorFactory)return ActorTermComparatorFactory;hasRequiredActorTermComparatorFactory=1,Object.defineProperty(ActorTermComparatorFactory,"__esModule",{value:!0}),ActorTermComparatorFactory.ActorTermComparatorFactory=void 0;const n=requireLib$4s();let t=class extends n.Actor{constructor(a){super(a),this.mediatorQueryOperation=a.mediatorQueryOperation,this.mediatorFunctionFactory=a.mediatorFunctionFactory,this.mediatorMergeBindingsContext=a.mediatorMergeBindingsContext}};return ActorTermComparatorFactory.ActorTermComparatorFactory=t,ActorTermComparatorFactory}var hasRequiredLib$e;function requireLib$e(){return hasRequiredLib$e||(hasRequiredLib$e=1,function(n){var t=lib$d&&lib$d.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$d&&lib$d.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorTermComparatorFactory(),n)}(lib$d)),lib$d}var TermComparatorExpressionEvaluator={},hasRequiredTermComparatorExpressionEvaluator;function requireTermComparatorExpressionEvaluator(){if(hasRequiredTermComparatorExpressionEvaluator)return TermComparatorExpressionEvaluator;hasRequiredTermComparatorExpressionEvaluator=1,Object.defineProperty(TermComparatorExpressionEvaluator,"__esModule",{value:!0}),TermComparatorExpressionEvaluator.TermComparatorExpressionEvaluator=void 0;let n=class{constructor(r,a,o){this.internalEvaluator=r,this.equalityFunction=a,this.lessThanFunction=o,this._TERM_ORDERING_PRIORITY={Variable:0,BlankNode:1,NamedNode:2,Literal:3,Quad:4,DefaultGraph:5}}orderTypes(r,a){if(r===a)return 0;if(r===void 0)return-1;if(a===void 0)return 1;if(r.termType!==a.termType)return this._TERM_ORDERING_PRIORITY[r.termType]<this._TERM_ORDERING_PRIORITY[a.termType]?-1:1;if(r.equals(a))return 0;if(r.termType==="Quad"&&a.termType==="Quad"){const o=this.orderTypes(r.subject,a.subject);if(o!==0)return o;const u=this.orderTypes(r.predicate,a.predicate);if(u!==0)return u;const s=this.orderTypes(r.object,a.object);return s!==0?s:this.orderTypes(r.graph,a.graph)}return r.termType==="Literal"?this.orderLiteralTypes(r,a):this.comparePrimitives(r.value,a.value)}orderLiteralTypes(r,a){const o=this.internalEvaluator.transformer.transformLiteral(r),u=this.internalEvaluator.transformer.transformLiteral(a);try{return this.equalityFunction.applyOnTerms([o,u],this.internalEvaluator).typedValue?0:this.lessThanFunction.applyOnTerms([o,u],this.internalEvaluator).typedValue?-1:1}catch{const s=this.comparePrimitives(o.dataType,u.dataType);return s!==0?s:this.comparePrimitives(o.str(),u.str())}}comparePrimitives(r,a){return r===a?0:r<a?-1:1}};return TermComparatorExpressionEvaluator.TermComparatorExpressionEvaluator=n,TermComparatorExpressionEvaluator}var hasRequiredActorTermComparatorFactoryExpressionEvaluator;function requireActorTermComparatorFactoryExpressionEvaluator(){if(hasRequiredActorTermComparatorFactoryExpressionEvaluator)return ActorTermComparatorFactoryExpressionEvaluator;hasRequiredActorTermComparatorFactoryExpressionEvaluator=1,Object.defineProperty(ActorTermComparatorFactoryExpressionEvaluator,"__esModule",{value:!0}),ActorTermComparatorFactoryExpressionEvaluator.ActorTermComparatorFactoryExpressionEvaluator=void 0;const n=requireInternalEvaluator(),t=requireLib$e(),r=requireLib$4q(),a=requireLib$4s(),o=requireLib$1A(),u=requireLib$4n(),s=requireTermComparatorExpressionEvaluator();let c=class extends t.ActorTermComparatorFactory{async test(d){return(0,a.passTestVoid)()}async run({context:d}){return d=u.prepareEvaluatorActionContext(d),new s.TermComparatorExpressionEvaluator(new n.InternalEvaluator(d,this.mediatorFunctionFactory,this.mediatorQueryOperation,await o.BindingsFactory.create(this.mediatorMergeBindingsContext,d,d.getSafe(r.KeysInitQuery.dataFactory))),await this.mediatorFunctionFactory.mediate({functionName:u.SparqlOperator.EQUAL,context:d,requireTermExpression:!0}),await this.mediatorFunctionFactory.mediate({functionName:u.SparqlOperator.LT,context:d,requireTermExpression:!0}))}};return ActorTermComparatorFactoryExpressionEvaluator.ActorTermComparatorFactoryExpressionEvaluator=c,ActorTermComparatorFactoryExpressionEvaluator}var hasRequiredLib$d;function requireLib$d(){return hasRequiredLib$d||(hasRequiredLib$d=1,function(n){var t=lib$e&&lib$e.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$e&&lib$e.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorTermComparatorFactoryExpressionEvaluator(),n)}(lib$e)),lib$e}var lib$c={},ActorRdfJoinMultiSmallestFilterBindings={},hasRequiredActorRdfJoinMultiSmallestFilterBindings;function requireActorRdfJoinMultiSmallestFilterBindings(){if(hasRequiredActorRdfJoinMultiSmallestFilterBindings)return ActorRdfJoinMultiSmallestFilterBindings;hasRequiredActorRdfJoinMultiSmallestFilterBindings=1,Object.defineProperty(ActorRdfJoinMultiSmallestFilterBindings,"__esModule",{value:!0}),ActorRdfJoinMultiSmallestFilterBindings.ActorRdfJoinMultiSmallestFilterBindings=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1A(),o=requireLib$1I(),u=requireLib$43(),s=requireAsynciterator(),c=requireSparqlalgebrajs();let l=class extends n.ActorRdfJoin{constructor(f){super(f,{logicalType:"inner",physicalName:"multi-smallest-filter-bindings",limitEntries:2,limitEntriesMin:!0,isLeaf:!1})}async sortJoinEntries(f,h){let{entries:v}=await this.mediatorJoinEntriesSort.mediate({entries:f,context:h});v=v.sort((w,A)=>w.operationModified&&!A.operationModified?-1:0);const g=v.splice(0,1)[0];let b,_=-1,S=0;for(const[w,A]of v.entries()){const R=g.metadata.variables.filter(E=>A.metadata.variables.some(I=>E.variable.equals(I.variable))).length;(!b||R>S||R===S&&(A.metadata.variables.length<b.metadata.variables.length||A.metadata.variables.length===b.metadata.variables.length&&A.metadata.cardinality.value<b.metadata.cardinality.value))&&(b=A,_=w,S=R)}if(S===0)return(0,r.failTest)(`Actor ${this.name} can only join with common variables`);const T=v;return T.splice(_,1),(0,r.passTest)({first:g,second:b,remaining:T})}async getOutput(f){const h=f.context.getSafe(t.KeysInitQuery.dataFactory),v=new c.Factory(h),g=await n.ActorRdfJoin.getEntriesWithMetadatas([...f.entries]),{first:b,second:_,remaining:S}=(await this.sortJoinEntries(g,f.context)).getOrThrow(),T=b.output.bindingsStream;b.output.bindingsStream=T.clone();const w=b.metadata.variables.filter(O=>_.metadata.variables.some(P=>O.variable.equals(P.variable))),A={},R=T.clone().map(O=>O.filter((P,C)=>w.some(q=>q.variable.equals(C)))).filter(O=>{const P=(0,a.bindingsToString)(O);return!(P in A)&&(A[P]=!0)}),E=new o.ChunkedIterator(R,this.blockSize,{autoStart:!1}),I=(0,u.getOperationSource)(_.operation),F={output:{type:"bindings",bindingsStream:new s.UnionIterator(E.map(O=>I.source.queryBindings(_.operation,I.context?f.context.merge(I.context):f.context,{filterBindings:{bindings:O,metadata:b.metadata}}))),metadata:_.output.metadata},operation:_.operation,operationModified:!0};_.output.bindingsStream.destroy();const D={output:(0,u.getSafeBindings)(await this.mediatorJoin.mediate({type:f.type,entries:[b,F],context:f.context.set(t.KeysRdfJoin.lastPhysicalJoin,this.physicalName)})),operation:v.createJoin([b.operation,F.operation],!1),operationModified:!0},$=S;return $.unshift(D),{result:await this.mediatorJoin.mediate({type:f.type,entries:$,context:f.context}),physicalPlanMetadata:{firstIndex:g.indexOf(b),secondIndex:g.indexOf(_)}}}async getJoinCoefficients(f,h){let{metadatas:v}=h;if(f.context.get(t.KeysRdfJoin.lastPhysicalJoin)===this.physicalName)return(0,r.failTest)(`Actor ${this.name} can not be called recursively`);v=[...v];const g=await this.sortJoinEntries(f.entries.map((F,D)=>({...F,metadata:v[D]})),f.context);if(g.isFailed())return g;const{first:b,second:_,remaining:S}=g.get(),T=(0,u.getOperationSource)(_.operation);if(!T)return(0,r.failTest)(`Actor ${this.name} can only process if entries[1] has a source`);const w=_.operation,A=await T.source.getSelectorShape(f.context);if(!(0,u.doesShapeAcceptOperation)(A,w,{filterBindings:!0}))return(0,r.failTest)(`Actor ${this.name} can only process if entries[1] accept filterBindings`);v=[b.metadata,_.metadata,...S.map(F=>F.metadata)];const R=n.ActorRdfJoin.getRequestInitialTimes(v),E=n.ActorRdfJoin.getRequestItemTimes(v),{selectivity:I}=await this.mediatorJoinSelectivity.mediate({entries:[b,_],context:f.context}),L=S.reduce((F,D)=>F*D.metadata.cardinality.value*this.selectivityModifier,1);return(0,r.passTestWithSideData)({iterations:I*this.selectivityModifier*_.metadata.cardinality.value*L,persistedItems:b.metadata.cardinality.value,blockingItems:b.metadata.cardinality.value,requestTime:R[0]+v[0].cardinality.value*E[0]+R[1]+L*E[1]},h)}};return ActorRdfJoinMultiSmallestFilterBindings.ActorRdfJoinMultiSmallestFilterBindings=l,ActorRdfJoinMultiSmallestFilterBindings}var hasRequiredLib$c;function requireLib$c(){return hasRequiredLib$c||(hasRequiredLib$c=1,function(n){var t=lib$c&&lib$c.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$c&&lib$c.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMultiSmallestFilterBindings(),n)}(lib$c)),lib$c}var lib$b={},ActorQueryProcessExplainParsed={},hasRequiredActorQueryProcessExplainParsed;function requireActorQueryProcessExplainParsed(){if(hasRequiredActorQueryProcessExplainParsed)return ActorQueryProcessExplainParsed;hasRequiredActorQueryProcessExplainParsed=1,Object.defineProperty(ActorQueryProcessExplainParsed,"__esModule",{value:!0}),ActorQueryProcessExplainParsed.ActorQueryProcessExplainParsed=void 0;const n=requireLib$k(),t=requireLib$4q(),r=requireLib$4s();let a=class extends n.ActorQueryProcess{constructor(u){super(u)}async test(u){return(u.context.get(t.KeysInitQuery.explain)??u.context.get(new r.ActionContextKey("explain")))!=="parsed"?(0,r.failTest)(`${this.name} can only explain in 'parsed' mode.`):(0,r.passTestVoid)()}async run(u){const{operation:s}=await this.queryProcessor.parse(u.query,u.context);return{result:{explain:!0,type:"parsed",data:s}}}};return ActorQueryProcessExplainParsed.ActorQueryProcessExplainParsed=a,ActorQueryProcessExplainParsed}var hasRequiredLib$b;function requireLib$b(){return hasRequiredLib$b||(hasRequiredLib$b=1,function(n){var t=lib$b&&lib$b.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$b&&lib$b.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryProcessExplainParsed(),n)}(lib$b)),lib$b}var lib$a={},ActorQueryProcessExplainLogical={},hasRequiredActorQueryProcessExplainLogical;function requireActorQueryProcessExplainLogical(){if(hasRequiredActorQueryProcessExplainLogical)return ActorQueryProcessExplainLogical;hasRequiredActorQueryProcessExplainLogical=1,Object.defineProperty(ActorQueryProcessExplainLogical,"__esModule",{value:!0}),ActorQueryProcessExplainLogical.ActorQueryProcessExplainLogical=void 0;const n=requireLib$k(),t=requireLib$4q(),r=requireLib$4s();let a=class extends n.ActorQueryProcess{constructor(u){super(u)}async test(u){return(u.context.get(t.KeysInitQuery.explain)??u.context.get(new r.ActionContextKey("explain")))!=="logical"?(0,r.failTest)(`${this.name} can only explain in 'logical' mode.`):(0,r.passTestVoid)()}async run(u){let{operation:s,context:c}=await this.queryProcessor.parse(u.query,u.context);return{operation:s,context:c}=await this.queryProcessor.optimize(s,c),{result:{explain:!0,type:"logical",data:s}}}};return ActorQueryProcessExplainLogical.ActorQueryProcessExplainLogical=a,ActorQueryProcessExplainLogical}var hasRequiredLib$a;function requireLib$a(){return hasRequiredLib$a||(hasRequiredLib$a=1,function(n){var t=lib$a&&lib$a.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$a&&lib$a.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryProcessExplainLogical(),n)}(lib$a)),lib$a}var lib$9={},ActorQueryProcessExplainPhysical={},MemoryPhysicalQueryPlanLogger={},hasRequiredMemoryPhysicalQueryPlanLogger;function requireMemoryPhysicalQueryPlanLogger(){if(hasRequiredMemoryPhysicalQueryPlanLogger)return MemoryPhysicalQueryPlanLogger;hasRequiredMemoryPhysicalQueryPlanLogger=1,Object.defineProperty(MemoryPhysicalQueryPlanLogger,"__esModule",{value:!0}),MemoryPhysicalQueryPlanLogger.numberToString=MemoryPhysicalQueryPlanLogger.MemoryPhysicalQueryPlanLogger=void 0;const n=requireRdfString();let t=class{constructor(){this.planNodes=new Map}logOperation(o,u,s,c,l,d){const f={actor:l,logicalOperator:o,physicalOperator:u,rawNode:s,children:[],metadata:d};if(this.planNodes.set(s,f),this.rootNode){if(!c)throw new Error("Detected more than one parent-less node");const h=this.planNodes.get(c);if(!h)throw new Error("Could not find parent node");h.children.push(f)}else{if(c)throw new Error("No root node has been set yet, while a parent is being referenced");this.rootNode=f}}stashChildren(o,u){const s=this.planNodes.get(o);if(!s)throw new Error("Could not find plan node");s.children=u?s.children.filter(u):[]}unstashChild(o,u){const s=this.planNodes.get(o);if(s){const c=this.planNodes.get(u);if(!c)throw new Error("Could not find plan parent node");c.children.push(s)}}appendMetadata(o,u){const s=this.planNodes.get(o);s&&(s.metadata={...s.metadata,...u})}toJson(){return this.rootNode?this.planNodeToJson(this.rootNode):{}}planNodeToJson(o){var s;const u={logical:o.logicalOperator,physical:o.physicalOperator,...this.getLogicalMetadata(o.rawNode),...this.compactMetadata(o.metadata)};if(o.children.length>0&&(u.children=o.children.map(c=>this.planNodeToJson(c))),u.physical==="bind"&&u.children){const c={};for(const d of u.children){const f=((s=d.children)==null?void 0:s.at(-1))??d,h=this.getPlanHash(f).join(",");c[h]||(c[h]=[]),c[h].push(d)}const l=[];for(const d of Object.values(c))l.push({occurrences:d.length,firstOccurrence:d[0]});u.childrenCompact=l,delete u.children}return u}getPlanHash(o){let u=[`${o.logical}-${o.physical}`];return o.children?u=[...u,...o.children.flatMap(s=>this.getPlanHash(s))]:o.childrenCompact&&(u=[...u,...o.childrenCompact.flatMap(s=>this.getPlanHash(s.firstOccurrence))]),u}compactMetadata(o){return Object.fromEntries(Object.entries(o).map(([u,s])=>[u,this.compactMetadataValue(s)]))}compactMetadataValue(o){return o&&typeof o=="object"&&"termType"in o?this.getLogicalMetadata(o):o}getLogicalMetadata(o){var s;const u={};if("type"in o){const c=o;switch((s=c.metadata)!=null&&s.scopedSource&&(u.source=c.metadata.scopedSource.source.toString()),c.type){case"pattern":u.pattern=this.quadToString(c);break;case"project":u.variables=c.variables.map(l=>l.value);break}}return u}quadToString(o){return`${(0,n.termToString)(o.subject)} ${(0,n.termToString)(o.predicate)} ${(0,n.termToString)(o.object)}${o.graph.termType==="DefaultGraph"?"":` ${(0,n.termToString)(o.graph)}`}`}toCompactString(){const o=this.toJson(),u=[],s=new Map;if("logical"in o?this.nodeToCompactString(u,s,"",o):u.push("Empty"),s.size>0){u.push(""),u.push("sources:");for(const[c,l]of s.entries())u.push(`  ${l}: ${c}`)}return u.join(`
`)}nodeToCompactString(o,u,s,c,l){let d;c.source&&(d=u.get(c.source),d===void 0&&(d=u.size,u.set(c.source,d))),o.push(`${s}${c.logical}${c.physical?`(${c.physical})`:""}${c.pattern?` (${c.pattern})`:""}${c.variables?` (${c.variables.join(",")})`:""}${c.bindOperation?` bindOperation:(${c.bindOperation.pattern}) bindCardEst:${c.bindOperationCardinality.type==="estimate"?"~":""}${r(c.bindOperationCardinality.value)}`:""}${c.cardinality?` cardEst:${c.cardinality.type==="estimate"?"~":""}${r(c.cardinality.value)}`:""}${c.source?` src:${d}`:""}${c.cardinalityReal?` cardReal:${c.cardinalityReal}`:""}${c.timeSelf?` timeSelf:${r(c.timeSelf)}ms`:""}${c.timeLife?` timeLife:${r(c.timeLife)}ms`:""}${l?` ${l}`:""}`);for(const f of c.children??[])this.nodeToCompactString(o,u,`${s}  `,f);for(const f of c.childrenCompact??[])this.nodeToCompactString(o,u,`${s}  `,f.firstOccurrence,`compacted-occurrences:${f.occurrences}`)}};MemoryPhysicalQueryPlanLogger.MemoryPhysicalQueryPlanLogger=t;function r(a){return a.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:3})}return MemoryPhysicalQueryPlanLogger.numberToString=r,MemoryPhysicalQueryPlanLogger}var hasRequiredActorQueryProcessExplainPhysical;function requireActorQueryProcessExplainPhysical(){if(hasRequiredActorQueryProcessExplainPhysical)return ActorQueryProcessExplainPhysical;hasRequiredActorQueryProcessExplainPhysical=1,Object.defineProperty(ActorQueryProcessExplainPhysical,"__esModule",{value:!0}),ActorQueryProcessExplainPhysical.ActorQueryProcessExplainPhysical=void 0;const n=requireLib$k(),t=requireLib$4q(),r=requireLib$4s(),a=requireMemoryPhysicalQueryPlanLogger();let o=class extends n.ActorQueryProcess{constructor(s){super(s)}async test(s){const c=s.context.get(t.KeysInitQuery.explain)??s.context.get(new r.ActionContextKey("explain"));return c!=="physical"&&c!=="physical-json"?(0,r.failTest)(`${this.name} can only explain in 'physical' or 'physical-json' mode.`):(0,r.passTestVoid)()}async run(s){let{operation:c,context:l}=await this.queryProcessor.parse(s.query,s.context);({operation:c,context:l}=await this.queryProcessor.optimize(c,l));const d=new a.MemoryPhysicalQueryPlanLogger;l=l.set(t.KeysInitQuery.physicalQueryPlanLogger,d);const f=await this.queryProcessor.evaluate(c,l);switch(f.type){case"bindings":await f.bindingsStream.toArray();break;case"quads":await f.quadStream.toArray();break;case"boolean":await f.execute();break;case"void":await f.execute();break}const h=s.context.get(t.KeysInitQuery.explain)??s.context.getSafe(new r.ActionContextKey("explain"));return{result:{explain:!0,type:h,data:h==="physical"?d.toCompactString():d.toJson()}}}};return ActorQueryProcessExplainPhysical.ActorQueryProcessExplainPhysical=o,ActorQueryProcessExplainPhysical}var hasRequiredLib$9;function requireLib$9(){return hasRequiredLib$9||(hasRequiredLib$9=1,function(n){var t=lib$9&&lib$9.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$9&&lib$9.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQueryProcessExplainPhysical(),n),r(requireMemoryPhysicalQueryPlanLogger(),n)}(lib$9)),lib$9}var lib$8={},ActorOptimizeQueryOperationPruneEmptySourceOperations={},hasRequiredActorOptimizeQueryOperationPruneEmptySourceOperations;function requireActorOptimizeQueryOperationPruneEmptySourceOperations(){if(hasRequiredActorOptimizeQueryOperationPruneEmptySourceOperations)return ActorOptimizeQueryOperationPruneEmptySourceOperations;hasRequiredActorOptimizeQueryOperationPruneEmptySourceOperations=1,Object.defineProperty(ActorOptimizeQueryOperationPruneEmptySourceOperations,"__esModule",{value:!0}),ActorOptimizeQueryOperationPruneEmptySourceOperations.ActorOptimizeQueryOperationPruneEmptySourceOperations=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$43(),o=requireSparqlalgebrajs();let u=class ln extends n.ActorOptimizeQueryOperation{constructor(c){super(c)}async test(c){return(0,a.getOperationSource)(c.operation)?(0,r.failTest)(`Actor ${this.name} does not work with top-level operation sources.`):(0,r.passTestVoid)()}async run(c){const l=c.context.getSafe(t.KeysInitQuery.dataFactory),d=new o.Factory(l);let f=c.operation;const h=[],v=this;o.Util.recurseOperation(f,{[o.Algebra.types.UNION](b){return v.collectMultiOperationInputs(b.input,h,o.Algebra.types.PATTERN),!0},[o.Algebra.types.ALT](b){return v.collectMultiOperationInputs(b.input,h,o.Algebra.types.LINK),!1},[o.Algebra.types.SERVICE](){return!1}});const g=new Set;return await Promise.all(h.map(async b=>{const _=b.type==="link"?d.createPattern(l.variable("?s"),b.iri,l.variable("?o")):b;await this.hasSourceResults(d,(0,a.getOperationSource)(b),_,c.context)||g.add(b)})),g.size>0&&(this.logDebug(c.context,`Pruning ${g.size} source-specific operations`),f=o.Util.mapOperation(f,{[o.Algebra.types.UNION](b,_){return v.mapMultiOperation(b,g,S=>_.createUnion(S))},[o.Algebra.types.ALT](b,_){return v.mapMultiOperation(b,g,S=>_.createAlt(S))}},d),f=o.Util.mapOperation(f,{[o.Algebra.types.PROJECT](b,_){return ln.hasEmptyOperation(b)?{recurse:!1,result:_.createUnion([])}:{recurse:!0,result:b}},[o.Algebra.types.LEFT_JOIN](b){return ln.hasEmptyOperation(b.input[1])?{recurse:!0,result:b.input[0]}:{recurse:!0,result:b}}},d)),{operation:f,context:c.context}}static hasEmptyOperation(c){let l=!1;return o.Util.recurseOperation(c,{[o.Algebra.types.UNION](d){return d.input.every(f=>ln.hasEmptyOperation(f))&&(l=!0),!1},[o.Algebra.types.ALT](d){return d.input.length===0&&(l=!0),!1},[o.Algebra.types.LEFT_JOIN](d){return ln.hasEmptyOperation(d.input[0])&&(l=!0),!1}}),l}collectMultiOperationInputs(c,l,d){for(const f of c)(0,a.getOperationSource)(f)&&f.type===d&&l.push(f)}mapMultiOperation(c,l,d){const f=c.input.filter(h=>!l.has(h));return f.length===c.input.length?{result:c,recurse:!0}:f.length===0?{result:d([]),recurse:!1}:f.length===1?{result:f[0],recurse:!0}:{result:d(f),recurse:!0}}async hasSourceResults(c,l,d,f){var v;if(((v=l.context)==null?void 0:v.get(t.KeysQuerySourceIdentify.traverse))??f.get(t.KeysQuerySourceIdentify.traverse))return!0;if(this.useAskIfSupported){const g=c.createAsk(d);if((0,a.doesShapeAcceptOperation)(await l.source.getSelectorShape(f),g))return l.source.queryBoolean(g,f)}const h=l.source.queryBindings(d,f);return new Promise((g,b)=>{h.on("error",b),h.getProperty("metadata",_=>{h.destroy(),g(_.cardinality.value>0)})})}};return ActorOptimizeQueryOperationPruneEmptySourceOperations.ActorOptimizeQueryOperationPruneEmptySourceOperations=u,ActorOptimizeQueryOperationPruneEmptySourceOperations}var hasRequiredLib$8;function requireLib$8(){return hasRequiredLib$8||(hasRequiredLib$8=1,function(n){var t=lib$8&&lib$8.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$8&&lib$8.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationPruneEmptySourceOperations(),n)}(lib$8)),lib$8}var lib$7={},ActorHttpRetry={},hasRequiredActorHttpRetry;function requireActorHttpRetry(){if(hasRequiredActorHttpRetry)return ActorHttpRetry;hasRequiredActorHttpRetry=1,Object.defineProperty(ActorHttpRetry,"__esModule",{value:!0}),ActorHttpRetry.ActorHttpRetry=void 0;const n=requireLib$1O(),t=requireLib$4q(),r=requireLib$4s();let a=class Pr extends n.ActorHttp{constructor(u){super(u),this.activeDelays={},this.httpInvalidator=u.httpInvalidator,this.httpInvalidator.addInvalidateListener(s=>this.handleHttpInvalidateEvent(s)),this.mediatorHttp=u.mediatorHttp}async test(u){if(u.context.has(Pr.keyWrapped))return(0,r.failTest)(`${this.name} can only wrap a request once`);const s=u.context.get(t.KeysHttp.httpRetryCount);return!s||s<1?(0,r.failTest)(`${this.name} requires a retry count greater than zero to function`):(0,r.passTest)({time:0})}async run(u){const s=n.ActorHttp.getInputUrl(u.input),c=u.context.getSafe(t.KeysHttp.httpRetryCount)+1,l=u.context.get(t.KeysHttp.httpRetryDelayFallback)??0,d=u.context.get(t.KeysHttp.httpRetryDelayLimit),f=u.context.get(t.KeysHttp.httpRetryStatusCodes);for(let h=1;h<=c;h++){const v=s.host in this.activeDelays?this.activeDelays[s.host].date.getTime()-Date.now():l;if(d&&v>d){this.logWarn(u.context,"Requested delay exceeds the limit",()=>({url:s.href,delay:v,delayDate:this.activeDelays[s.host].date.toISOString(),delayLimit:d,currentAttempt:`${h} / ${c}`}));break}else v>0&&h>1&&(this.logDebug(u.context,"Delaying request",()=>({url:s.href,delay:v,currentAttempt:`${h} / ${c}`})),await Pr.sleep(v));const g=await this.mediatorHttp.mediate({...u,context:u.context.set(Pr.keyWrapped,!0)});if(g.ok)return g;if(f&&f.includes(g.status)){this.logDebug(u.context,"Status code in force retry list, forcing retry",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}));continue}if(g.status===504){this.logDebug(u.context,"Received proxy timeout",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}));continue}if(g.status===429||g.status===503){const b=g.headers.get("retry-after");if(b){const _=Pr.parseRetryAfterHeader(b);_?(s.host in this.activeDelays&&clearTimeout(this.activeDelays[s.host].timeout),this.activeDelays[s.host]={date:_,timeout:setTimeout(()=>delete this.activeDelays[s.host],Date.now()-_.getTime())}):this.logDebug(u.context,"Invalid Retry-After header value from server",()=>({url:s.href,status:g.status,statusText:g.statusText,retryAfterHeader:b,currentAttempt:`${h} / ${c}`}))}this.logDebug(u.context,"Server temporarily unavailable",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}));continue}if(g.status>=400&&g.status<500){this.logDebug(u.context,"Server reported client-side error",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}));break}if(g.status>=500&&g.status<600){this.logDebug(u.context,"Server-side error encountered, terminating",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}));break}this.logDebug(u.context,"Request failed",()=>({url:s.href,status:g.status,statusText:g.statusText,currentAttempt:`${h} / ${c}`}))}throw new Error(`Request failed: ${s.href}`)}static async sleep(u){u>0&&await new Promise(s=>setTimeout(s,u))}static parseRetryAfterHeader(u){if(Pr.numberRegex.test(u))return new Date(Date.now()+Number.parseInt(u,10)*1e3);if(Pr.dateRegex.test(u))return new Date(u)}handleHttpInvalidateEvent(u){const s=u.url?new URL(u.url).host:void 0;for(const c of Object.keys(this.activeDelays))(!s||c===s)&&(clearTimeout(this.activeDelays[c].timeout),delete this.activeDelays[c])}};return ActorHttpRetry.ActorHttpRetry=a,a.dateRegex=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), [0-9]{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) [0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2} GMT$/u,a.numberRegex=/^[0-9]+$/u,a.keyWrapped=new r.ActionContextKey("urn:comunica:actor-http-retry#wrapped"),ActorHttpRetry}var hasRequiredLib$7;function requireLib$7(){return hasRequiredLib$7||(hasRequiredLib$7=1,function(n){var t=lib$7&&lib$7.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$7&&lib$7.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorHttpRetry(),n)}(lib$7)),lib$7}var lib$6={},ActorQuerySourceIdentifySerialized={},hasRequiredActorQuerySourceIdentifySerialized;function requireActorQuerySourceIdentifySerialized(){if(hasRequiredActorQuerySourceIdentifySerialized)return ActorQuerySourceIdentifySerialized;hasRequiredActorQuerySourceIdentifySerialized=1,Object.defineProperty(ActorQuerySourceIdentifySerialized,"__esModule",{value:!0}),ActorQuerySourceIdentifySerialized.ActorQuerySourceIdentifySerialized=void 0;const n=requireLib$z(),t=requireLib$4s(),r=requireRdfStoreStream(),a=requireBrowser();let o=class extends n.ActorQuerySourceIdentify{constructor(s){super(s)}async test(s){return this.isStringSource(s.querySourceUnidentified)?(0,t.passTestVoid)():(0,t.failTest)(`${this.name} requires a single query source with serialized type to be present in the context.`)}async run(s){return await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{type:"rdfjs",value:await this.getRdfSource(s.context,s.querySourceUnidentified),context:s.querySourceUnidentified.context},context:s.context})}async getRdfSource(s,c){const l=new a.Readable({objectMode:!0});l._read=()=>{},l.push(c.value),l.push(null);const d={context:s,handle:{metadata:{baseIRI:c.baseIRI},data:l,context:s},handleMediaType:c.mediaType},f=await this.mediatorRdfParse.mediate(d);return await(0,r.storeStream)(f.handle.data)}isStringSource(s){return"type"in s?s.type==="serialized":typeof s.value!="string"?!1:"mediaType"in s}};return ActorQuerySourceIdentifySerialized.ActorQuerySourceIdentifySerialized=o,ActorQuerySourceIdentifySerialized}var hasRequiredLib$6;function requireLib$6(){return hasRequiredLib$6||(hasRequiredLib$6=1,function(n){var t=lib$6&&lib$6.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$6&&lib$6.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorQuerySourceIdentifySerialized(),n)}(lib$6)),lib$6}var lib$5={},ActorRdfJoinMultiBindSource={},hasRequiredActorRdfJoinMultiBindSource;function requireActorRdfJoinMultiBindSource(){if(hasRequiredActorRdfJoinMultiBindSource)return ActorRdfJoinMultiBindSource;hasRequiredActorRdfJoinMultiBindSource=1,Object.defineProperty(ActorRdfJoinMultiBindSource,"__esModule",{value:!0}),ActorRdfJoinMultiBindSource.ActorRdfJoinMultiBindSource=void 0;const n=requireLib$1H(),t=requireLib$4q(),r=requireLib$4s(),a=requireLib$1I(),o=requireLib$43(),u=requireAsynciterator(),s=requireSparqlalgebrajs();let c=class extends n.ActorRdfJoin{constructor(d){super(d,{logicalType:"inner",physicalName:"bind-source",canHandleUndefs:!0})}async getOutput(d,f){const h=d.context.getSafe(t.KeysInitQuery.dataFactory),v=new s.Factory(h),g=f.entriesSorted;this.logDebug(d.context,"First entry for Bind Join Source: ",()=>({entry:g[0].operation,metadata:g[0].metadata}));for(const[E,I]of g.entries())E!==0&&I.output.bindingsStream.close();const b=g[0].output,_=g[0].metadata,S=[...g];S.splice(0,1);const T=(0,o.getOperationSource)(S[0].operation),w=this.createOperationFromEntries(v,S),A=new a.ChunkedIterator(b.bindingsStream,this.blockSize,{autoStart:!1});return{result:{type:"bindings",bindingsStream:new u.UnionIterator(A.map(E=>T.source.queryBindings(w,T.context?d.context.merge(T.context):d.context,{joinBindings:{bindings:E,metadata:_}}))),metadata:()=>this.constructResultMetadata(g,g.map(E=>E.metadata),d.context)},physicalPlanMetadata:{bindIndex:f.entriesUnsorted.indexOf(g[0])}}}async sortJoinEntries(d,f){const h=await n.ActorRdfJoin.sortJoinEntries(this.mediatorJoinEntriesSort,d,f);return h.isFailed()?h:(d=h.get(),d=d.sort((v,g)=>v.operationModified&&!g.operationModified?-1:0),(0,r.passTest)(d))}async getJoinCoefficients(d,f){let{metadatas:h}=f;const v=d.context.getSafe(t.KeysInitQuery.dataFactory),g=new s.Factory(v),b=d.entries.map(($,O)=>({...$,metadata:h[O]})),_=await this.sortJoinEntries(b,d.context);if(_.isFailed())return _;const S=_.get();h=S.map($=>$.metadata);const T=n.ActorRdfJoin.getRequestInitialTimes(h),w=n.ActorRdfJoin.getRequestItemTimes(h),A=[...S];[...T],[...w],A.splice(0,1);const R=A.map($=>(0,o.getOperationSource)($.operation));if(R.some($=>!$))return(0,r.failTest)(`Actor ${this.name} can not bind on remaining operations without source annotation`);if(R.some($=>$!==R[0]))return(0,r.failTest)(`Actor ${this.name} can not bind on remaining operations with non-equal source annotation`);const E=R[0],I=this.createOperationFromEntries(g,A),L=await E.source.getSelectorShape(d.context);if(!(0,o.doesShapeAcceptOperation)(L,I,{joinBindings:!0}))return(0,r.failTest)(`Actor ${this.name} detected a source that can not handle passing down join bindings`);const F=await Promise.all(A.map(async $=>(await this.mediatorJoinSelectivity.mediate({entries:[S[0],$],context:d.context})).selectivity*this.selectivityModifier)),D=A.map(($,O)=>$.metadata.cardinality.value*F[O]).reduce(($,O)=>$+O,0);return(0,r.passTestWithSideData)({iterations:1,persistedItems:h[0].cardinality.value,blockingItems:h[0].cardinality.value,requestTime:T[0]+h[0].cardinality.value*w[0]+T[1]+D*w[1]},{...f,entriesUnsorted:b,entriesSorted:S})}createOperationFromEntries(d,f){return f.length===1?f[0].operation:d.createJoin(f.map(h=>h.operation),!0)}};return ActorRdfJoinMultiBindSource.ActorRdfJoinMultiBindSource=c,ActorRdfJoinMultiBindSource}var hasRequiredLib$5;function requireLib$5(){return hasRequiredLib$5||(hasRequiredLib$5=1,function(n){var t=lib$5&&lib$5.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$5&&lib$5.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorRdfJoinMultiBindSource(),n)}(lib$5)),lib$5}var lib$4={},ActorOptimizeQueryOperationJoinConnected={},hasRequiredActorOptimizeQueryOperationJoinConnected;function requireActorOptimizeQueryOperationJoinConnected(){if(hasRequiredActorOptimizeQueryOperationJoinConnected)return ActorOptimizeQueryOperationJoinConnected;hasRequiredActorOptimizeQueryOperationJoinConnected=1,Object.defineProperty(ActorOptimizeQueryOperationJoinConnected,"__esModule",{value:!0}),ActorOptimizeQueryOperationJoinConnected.ActorOptimizeQueryOperationJoinConnected=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class Cn extends n.ActorOptimizeQueryOperation{async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c);return{operation:a.Util.mapOperation(s.operation,{join(f,h){return{recurse:!1,result:Cn.cluster(f,h)}}},l),context:s.context}}static cluster(s,c){const l=s.input.map(v=>({inScopeVariables:Object.fromEntries(a.Util.inScopeVariables(v).map(g=>[g.value,!0])),entries:[v]}));let d,f=l;do d=f,f=Cn.clusterIteration(d);while(d.length!==f.length);const h=f.map(v=>v.entries.length===1?v.entries[0]:c.createJoin(v.entries));return h.length===1?h[0]:c.createJoin(h,!1)}static clusterIteration(s){const c=[];for(const l of s){let d=!1;for(const f of c)if(Cn.haveOverlappingVariables(l.inScopeVariables,f.inScopeVariables)){f.entries=[...f.entries,...l.entries],f.inScopeVariables={...f.inScopeVariables,...l.inScopeVariables},d=!0;break}d||c.push({inScopeVariables:l.inScopeVariables,entries:l.entries})}return c}static haveOverlappingVariables(s,c){for(const l of Object.keys(s))if(c[l])return!0;return!1}};return ActorOptimizeQueryOperationJoinConnected.ActorOptimizeQueryOperationJoinConnected=o,ActorOptimizeQueryOperationJoinConnected}var hasRequiredLib$4;function requireLib$4(){return hasRequiredLib$4||(hasRequiredLib$4=1,function(n){var t=lib$4&&lib$4.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$4&&lib$4.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationJoinConnected(),n)}(lib$4)),lib$4}var lib$3={},ActorOptimizeQueryOperationBgpToJoin={},hasRequiredActorOptimizeQueryOperationBgpToJoin;function requireActorOptimizeQueryOperationBgpToJoin(){if(hasRequiredActorOptimizeQueryOperationBgpToJoin)return ActorOptimizeQueryOperationBgpToJoin;hasRequiredActorOptimizeQueryOperationBgpToJoin=1,Object.defineProperty(ActorOptimizeQueryOperationBgpToJoin,"__esModule",{value:!0}),ActorOptimizeQueryOperationBgpToJoin.ActorOptimizeQueryOperationBgpToJoin=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c);return{operation:a.Util.mapOperation(s.operation,{bgp(f,h){return{recurse:!1,result:h.createJoin(f.patterns)}}},l),context:s.context}}};return ActorOptimizeQueryOperationBgpToJoin.ActorOptimizeQueryOperationBgpToJoin=o,ActorOptimizeQueryOperationBgpToJoin}var hasRequiredLib$3;function requireLib$3(){return hasRequiredLib$3||(hasRequiredLib$3=1,function(n){var t=lib$3&&lib$3.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$3&&lib$3.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationBgpToJoin(),n)}(lib$3)),lib$3}var lib$2={},ActorOptimizeQueryOperationJoinBgp={},hasRequiredActorOptimizeQueryOperationJoinBgp;function requireActorOptimizeQueryOperationJoinBgp(){if(hasRequiredActorOptimizeQueryOperationJoinBgp)return ActorOptimizeQueryOperationJoinBgp;hasRequiredActorOptimizeQueryOperationJoinBgp=1,Object.defineProperty(ActorOptimizeQueryOperationJoinBgp,"__esModule",{value:!0}),ActorOptimizeQueryOperationJoinBgp.ActorOptimizeQueryOperationJoinBgp=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{async test(s){return(0,r.passTestVoid)()}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c);return{operation:a.Util.mapOperation(s.operation,{join(f,h){return f.input.every(v=>v.type==="bgp")?{recurse:!1,result:h.createBgp(f.input.flatMap(v=>v.patterns))}:{recurse:!1,result:f}}},l),context:s.context}}};return ActorOptimizeQueryOperationJoinBgp.ActorOptimizeQueryOperationJoinBgp=o,ActorOptimizeQueryOperationJoinBgp}var hasRequiredLib$2;function requireLib$2(){return hasRequiredLib$2||(hasRequiredLib$2=1,function(n){var t=lib$2&&lib$2.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$2&&lib$2.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationJoinBgp(),n)}(lib$2)),lib$2}var lib$1={},ActorOptimizeQueryOperationAssignSourcesExhaustive={},hasRequiredActorOptimizeQueryOperationAssignSourcesExhaustive;function requireActorOptimizeQueryOperationAssignSourcesExhaustive(){if(hasRequiredActorOptimizeQueryOperationAssignSourcesExhaustive)return ActorOptimizeQueryOperationAssignSourcesExhaustive;hasRequiredActorOptimizeQueryOperationAssignSourcesExhaustive=1,Object.defineProperty(ActorOptimizeQueryOperationAssignSourcesExhaustive,"__esModule",{value:!0}),ActorOptimizeQueryOperationAssignSourcesExhaustive.ActorOptimizeQueryOperationAssignSourcesExhaustive=void 0;const n=requireLib$47(),t=requireLib$33(),r=requireLib$4q(),a=requireLib$4s(),o=requireLib$43(),u=requireSparqlalgebrajs();let s=class extends n.ActorOptimizeQueryOperation{constructor(l){super(l)}async test(l){return(0,a.passTestVoid)()}async run(l){const d=l.context.getSafe(r.KeysInitQuery.dataFactory),f=new u.Factory(d),h=l.context.get(r.KeysQueryOperation.querySources)??[];if(h.length===0)return{operation:l.operation,context:l.context};if(h.length===1){const v=h[0],g=l.context.get(r.KeysRdfUpdateQuads.destination);if(!g||v.source.referenceValue===(0,t.getDataDestinationValue)(g))try{const b=await v.source.getSelectorShape(l.context);if((0,o.doesShapeAcceptOperation)(b,l.operation))return{operation:(0,o.assignOperationSource)(l.operation,v),context:l.context}}catch{}}return{operation:this.assignExhaustive(f,l.operation,h),context:l.context.delete(r.KeysInitQuery.queryString)}}assignExhaustive(l,d,f){const h=this;return u.Util.mapOperation(d,{[u.Algebra.types.PATTERN](v,g){return f.length===1?{result:(0,o.assignOperationSource)(v,f[0]),recurse:!1}:{result:g.createUnion(f.map(b=>(0,o.assignOperationSource)(v,b))),recurse:!1}},[u.Algebra.types.LINK](v,g){return f.length===1?{result:(0,o.assignOperationSource)(v,f[0]),recurse:!1}:{result:g.createAlt(f.map(b=>(0,o.assignOperationSource)(v,b))),recurse:!1}},[u.Algebra.types.NPS](v,g){return f.length===1?{result:(0,o.assignOperationSource)(v,f[0]),recurse:!1}:{result:g.createAlt(f.map(b=>(0,o.assignOperationSource)(v,b))),recurse:!1}},[u.Algebra.types.SERVICE](v){return{result:v,recurse:!1}},[u.Algebra.types.CONSTRUCT](v,g){return{result:g.createConstruct(h.assignExhaustive(l,v.input,f),v.template),recurse:!1}},[u.Algebra.types.DELETE_INSERT](v,g){return{result:g.createDeleteInsert(v.delete,v.insert,v.where?h.assignExhaustive(l,v.where,f):void 0),recurse:!1}}},l)}};return ActorOptimizeQueryOperationAssignSourcesExhaustive.ActorOptimizeQueryOperationAssignSourcesExhaustive=s,ActorOptimizeQueryOperationAssignSourcesExhaustive}var hasRequiredLib$1;function requireLib$1(){return hasRequiredLib$1||(hasRequiredLib$1=1,function(n){var t=lib$1&&lib$1.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib$1&&lib$1.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationAssignSourcesExhaustive(),n)}(lib$1)),lib$1}var lib={},ActorOptimizeQueryOperationDescribeToConstructsSubject={},hasRequiredActorOptimizeQueryOperationDescribeToConstructsSubject;function requireActorOptimizeQueryOperationDescribeToConstructsSubject(){if(hasRequiredActorOptimizeQueryOperationDescribeToConstructsSubject)return ActorOptimizeQueryOperationDescribeToConstructsSubject;hasRequiredActorOptimizeQueryOperationDescribeToConstructsSubject=1,Object.defineProperty(ActorOptimizeQueryOperationDescribeToConstructsSubject,"__esModule",{value:!0}),ActorOptimizeQueryOperationDescribeToConstructsSubject.ActorOptimizeQueryOperationDescribeToConstructsSubject=void 0;const n=requireLib$47(),t=requireLib$4q(),r=requireLib$4s(),a=requireSparqlalgebrajs();let o=class extends n.ActorOptimizeQueryOperation{constructor(s){super(s)}async test(s){return s.operation.type!==a.Algebra.types.DESCRIBE?(0,r.failTest)(`Actor ${this.name} only supports describe operations, but got ${s.operation.type}`):(0,r.passTest)(!0)}async run(s){const c=s.context.getSafe(t.KeysInitQuery.dataFactory),l=new a.Factory(c),d=s.operation,f=d.terms.filter(v=>v.termType!=="Variable").map(v=>{const g=[c.quad(v,c.variable("__predicate"),c.variable("__object"))];return g.forEach(_=>_.type="pattern"),{input:{type:a.Algebra.types.BGP,patterns:g},template:g,type:"construct"}});if(f.length!==d.terms.length){let v=[];d.terms.filter(g=>g.termType==="Variable").forEach((g,b)=>{const _=[c.quad(g,c.variable(`__predicate${b}`),c.variable(`__object${b}`))];_.forEach(S=>S.type="pattern"),v=[...v,..._]}),f.push({input:{type:a.Algebra.types.JOIN,input:[d.input,{type:a.Algebra.types.BGP,patterns:v}]},template:v,type:a.Algebra.types.CONSTRUCT})}return{operation:l.createUnion(f,!1),context:s.context}}};return ActorOptimizeQueryOperationDescribeToConstructsSubject.ActorOptimizeQueryOperationDescribeToConstructsSubject=o,ActorOptimizeQueryOperationDescribeToConstructsSubject}var hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,function(n){var t=lib&&lib.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=lib&&lib.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireActorOptimizeQueryOperationDescribeToConstructsSubject(),n)}(lib)),lib}var engineDefault,hasRequiredEngineDefault;function requireEngineDefault(){return hasRequiredEngineDefault||(hasRequiredEngineDefault=1,engineDefault=function(n){const t=new(requireLib$4o()).LoggerVoid,r=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-init/^4.0.0/components/ActorInit.jsonld#ActorInit_default_bus"}),a=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-context-preprocess/^4.0.0/components/ActorContextPreprocess.jsonld#ActorContextPreprocess_default_bus"}),o=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-hash-bindings/^4.0.0/components/ActorHashBindings.jsonld#ActorHashBindings_default_bus"}),u=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-hash-quads/^4.0.0/components/ActorHashQuads.jsonld#ActorHashQuads_default_bus"}),s=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-optimize-query-operation/^4.0.0/components/ActorOptimizeQueryOperation.jsonld#ActorOptimizeQueryOperation_default_bus"}),c=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-parse/^4.0.0/components/ActorQueryParse.jsonld#ActorQueryParse_default_bus"}),l=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-result-serialize/^4.0.0/components/ActorQueryResultSerialize.jsonld#ActorQueryResultSerialize_default_bus"}),d=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-source-identify-hypermedia/^4.0.0/components/ActorQuerySourceIdentifyHypermedia.jsonld#ActorQuerySourceIdentifyHypermedia_default_bus"}),f=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-dereference/^4.0.0/components/ActorDereference.jsonld#ActorDereference_default_bus"}),h=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-dereference-rdf/^4.0.0/components/ActorDereferenceRdf.jsonld#ActorDereferenceRdf_default_bus"}),v=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-entries-sort/^4.0.0/components/ActorRdfJoinEntriesSort.jsonld#ActorRdfJoinEntriesSort_default_bus"}),g=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-selectivity/^4.0.0/components/ActorRdfJoinSelectivity.jsonld#ActorRdfJoinSelectivity_default_bus"}),b=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata/^4.0.0/components/ActorRdfMetadata.jsonld#ActorRdfMetadata_default_bus"}),_=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata-accumulate/^4.0.0/components/ActorRdfMetadataAccumulate.jsonld#ActorRdfMetadataAccumulate_default_bus"}),S=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata-extract/^4.0.0/components/ActorRdfMetadataExtract.jsonld#ActorRdfMetadataExtract_default_bus"}),T=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse/^4.0.0/components/ActorRdfParse.jsonld#ActorRdfParse_default_bus"}),w=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse-html/^4.0.0/components/ActorRdfParseHtml.jsonld#ActorRdfParseHtml_default_bus"}),A=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links/^4.0.0/components/ActorRdfResolveHypermediaLinks.jsonld#ActorRdfResolveHypermediaLinks_default_bus"}),R=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links-queue/^4.0.0/components/ActorRdfResolveHypermediaLinksQueue.jsonld#ActorRdfResolveHypermediaLinksQueue_default_bus"}),E=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-serialize/^4.0.0/components/ActorRdfSerialize.jsonld#ActorRdfSerialize_default_bus"}),I=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-hypermedia/^4.0.0/components/ActorRdfUpdateHypermedia.jsonld#ActorRdfUpdateHypermedia_default_bus"}),L=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-quads/^4.0.0/components/ActorRdfUpdateQuads.jsonld#ActorRdfUpdateQuads_default_bus"}),F=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-bindings-aggregator-factory/^4.0.0/components/ActorBindingsAggregatorFactory.jsonld#ActorBindingsAggregatorFactory_default_bus"}),D=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-expression-evaluator-factory/^4.0.0/components/ActorExpressionEvaluatorFactory.jsonld#ActorExpressionEvaluatorFactory_default_bus"}),$=new(requireLib$4m()).BusFunctionFactory({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-function-factory/^4.0.0/components/ActorFunctionFactory.jsonld#ActorFunctionFactory_default_bus"}),O=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http/^4.0.0/components/ActorHttp.jsonld#ActorHttp_default_bus"}),P=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http/^4.0.0/components/ActorHttp.jsonld#ActorHttp_fallback_bus"}),C=new(requireLib$4k()).BusQueryOperation({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-operation/^4.0.0/components/ActorQueryOperation.jsonld#ActorQueryOperation_default_bus"}),q=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-process/^4.0.0/components/ActorQueryProcess.jsonld#ActorQueryProcess_default_bus"}),M=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-source-identify/^4.0.0/components/ActorQuerySourceIdentify.jsonld#ActorQuerySourceIdentify_default_bus"}),N=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join/^4.0.0/components/ActorRdfJoin.jsonld#ActorRdfJoin_default_bus"}),G=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-term-comparator-factory/^4.0.0/components/ActorTermComparatorFactory.jsonld#ActorTermComparatorFactory_default_bus"}),X=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http-invalidate/^4.0.0/components/ActorHttpInvalidate.jsonld#ActorHttpInvalidate_default_bus"}),Y=new(requireLib$4s()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-merge-bindings-context/^4.0.0/components/ActorMergeBindingsContext.jsonld#ActorMergeBindingsContext_default_bus"});new(requireLib$4i()).ActorContextPreprocessConvertShortcuts({contextKeyShortcuts:{baseIRI:"@comunica/actor-init-query:baseIRI",dataFactory:"@comunica/actor-init-query:dataFactory",datetime:"@comunica/actor-http-memento:datetime",destination:"@comunica/bus-rdf-update-quads:destination",distinctConstruct:"@comunica/actor-init-query:distinctConstruct",explain:"@comunica/actor-init-query:explain",extensionFunctionCreator:"@comunica/actor-init-query:extensionFunctionCreator",extensionFunctions:"@comunica/actor-init-query:extensionFunctions",fetch:"@comunica/bus-http:fetch",functionArgumentsCache:"@comunica/actor-init-query:functionArgumentsCache",httpAuth:"@comunica/bus-http:auth",httpBodyTimeout:"@comunica/bus-http:http-body-timeout",httpIncludeCredentials:"@comunica/bus-http:include-credentials",httpProxyHandler:"@comunica/actor-http-proxy:httpProxyHandler",httpRetryCount:"@comunica/bus-http:http-retry-count",httpRetryDelayFallback:"@comunica/bus-http:http-retry-delay-fallback",httpRetryDelayLimit:"@comunica/bus-http:http-retry-delay-limit",httpTimeout:"@comunica/bus-http:http-timeout",initialBindings:"@comunica/actor-init-query:initialBindings",invalidateCache:"@comunica/actor-init-query:invalidateCache",lenient:"@comunica/actor-init-query:lenient",log:"@comunica/core:log",queryFormat:"@comunica/actor-init-query:queryFormat",queryTimestamp:"@comunica/actor-init-query:queryTimestamp",queryTimestampHighResolution:"@comunica/actor-init-query:queryTimestampHighResolution",readOnly:"@comunica/bus-query-operation:readOnly",recoverBrokenLinks:"@comunica/bus-http-wayback:recover-broken-links",sources:"@comunica/actor-init-query:querySourcesUnidentified",traverse:"@comunica/bus-query-source-identify:traverse",unionDefaultGraph:"@comunica/bus-query-operation:unionDefaultGraph"},name:"urn:comunica:default:context-preprocess/actors#convert-shortcuts",bus:a,busFailMessage:"Context preprocessing failed"}),new(requireLib$4h()).ActorContextPreprocessSetDefaults({logger:t,name:"urn:comunica:default:context-preprocess/actors#set-defaults",bus:a,busFailMessage:"Context preprocessing failed"}),new(requireLib$4g()).ActorContextPreprocessSourceToDestination({name:"urn:comunica:default:context-preprocess/actors#source-to-destination",bus:a,busFailMessage:"Context preprocessing failed"});const W=new(requireLib$4e()).ActorContextPreprocessQuerySourceSkolemize({name:"urn:comunica:default:context-preprocess/actors#query-source-skolemize",bus:a,busFailMessage:"Context preprocessing failed"}),te=new(requireLib$4d()).MediatorCombinePipeline({name:"urn:comunica:default:context-preprocess/mediators#main",bus:a});new(requireLib$4b()).ActorHashBindingsMurmur({name:"urn:comunica:default:hash-bindings/actors#murmur",bus:o,busFailMessage:"Failed to obtaining hash functions for bindings"});const ue=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:hash-bindings/mediators#main",bus:o});new(requireLib$48()).ActorHashQuadsMurmur({name:"urn:comunica:default:hash-quads/actors#murmur",bus:u,busFailMessage:"Failed to obtaining hash functions for quads"});const fe=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:hash-quads/mediators#main",bus:u});new(requireLib$46()).ActorOptimizeQueryOperationRewriteCopy({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-copy",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"}),new(requireLib$45()).ActorOptimizeQueryOperationRewriteMove({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-move",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"}),new(requireLib$44()).ActorOptimizeQueryOperationRewriteAdd({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-add",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});const re=new(requireLib$42()).ActorOptimizeQueryOperationGroupSources({name:"urn:comunica:default:optimize-query-operation/actors#group-sources",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});new(requireLib$41()).ActorOptimizeQueryOperationConstructDistinct({name:"urn:comunica:default:optimize-query-operation/actors#construct-distinct",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});const ye=new(requireLib$4d()).MediatorCombinePipeline({filterFailures:!0,name:"urn:comunica:default:optimize-query-operation/mediators#main",bus:s});new(requireLib$3$()).ActorQueryParseSparql({prefixes:{dbpedia:"http://dbpedia.org/resource/","dbpedia-owl":"http://dbpedia.org/ontology/",dbpprop:"http://dbpedia.org/property/",dc:"http://purl.org/dc/terms/",dc11:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",owl:"http://www.w3.org/2002/07/owl#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",schema:"http://schema.org/",skos:"http://www.w3.org/2008/05/skos#",xsd:"http://www.w3.org/2001/XMLSchema#"},name:"urn:comunica:default:query-parse/actors#sparql",bus:c,busFailMessage:'Query parsing failed: none of the configured parsers were able to the query "${action.query}"'}),new(requireLib$3_()).ActorQueryParseGraphql({name:"urn:comunica:default:query-parse/actors#graphql",bus:c,busFailMessage:'Query parsing failed: none of the configured parsers were able to the query "${action.query}"'});const Te=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:query-parse/mediators#main",bus:c});new(requireLib$3X()).ActorQueryResultSerializeJson({mediaTypePriorities:{"application/json":1},mediaTypeFormats:{"application/json":"https://comunica.linkeddatafragments.org/#results_JSON"},name:"urn:comunica:default:query-result-serialize/actors#json",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3W()).ActorQueryResultSerializeSimple({mediaTypePriorities:{simple:.9},mediaTypeFormats:{simple:"https://comunica.linkeddatafragments.org/#results_simple"},name:"urn:comunica:default:query-result-serialize/actors#simple",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3V()).ActorQueryResultSerializeSparqlCsv({mediaTypePriorities:{"text/csv":.75},mediaTypeFormats:{"text/csv":"http://www.w3.org/ns/formats/SPARQL_Results_CSV"},name:"urn:comunica:default:query-result-serialize/actors#csv",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3U()).ActorQueryResultSerializeSparqlTsv({mediaTypePriorities:{"text/tab-separated-values":.75},mediaTypeFormats:{"text/tab-separated-values":"http://www.w3.org/ns/formats/SPARQL_Results_TSV"},name:"urn:comunica:default:query-result-serialize/actors#sparql-tsv",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3T()).ActorQueryResultSerializeSparqlXml({mediaTypePriorities:{"application/sparql-results+xml":.8},mediaTypeFormats:{"application/sparql-results+xml":"http://www.w3.org/ns/formats/SPARQL_Results_XML"},name:"urn:comunica:default:query-result-serialize/actors#sparql-xml",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3S()).ActorQueryResultSerializeTable({columnWidth:50,mediaTypePriorities:{table:.6},mediaTypeFormats:{table:"https://comunica.linkeddatafragments.org/#results_table"},name:"urn:comunica:default:query-result-serialize/actors#table",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$3R()).ActorQueryResultSerializeTree({mediaTypePriorities:{tree:.5},mediaTypeFormats:{tree:"https://comunica.linkeddatafragments.org/#results_tree"},name:"urn:comunica:default:query-result-serialize/actors#tree",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"});const Re=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:query-result-serialize/mediators#serialize",bus:l}),ve=new(requireLib$3Q()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:query-result-serialize/mediators#mediaType",bus:l}),ce=new(requireLib$3Q()).MediatorCombineUnion({field:"mediaTypeFormats",name:"urn:comunica:default:query-result-serialize/mediators#mediaTypeFormat",bus:l}),J=new(requireLib$3P()).MediatorNumber({field:"filterFactor",type:"max",ignoreFailures:!0,name:"urn:comunica:default:query-source-identify-hypermedia/mediators#main",bus:d}),j=new(requireLib$3N()).ActorDereferenceFallback({name:"urn:comunica:default:dereference/actors#fallback",bus:f,busFailMessage:"Dereferencing failed: none of the configured actors were able to handle ${action.url}"}),z=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:dereference/mediators#main",bus:f}),B=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:dereference-rdf/mediators#main",bus:h});new(requireLib$3L()).ActorRdfJoinEntriesSortCardinality({name:"urn:comunica:default:rdf-join-entries-sort/actors#cardinality",bus:v,busFailMessage:"Sorting join entries failed: none of the configured actors were able to sort"});const U=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-join-entries-sort/mediators#main",bus:v});new(requireLib$3J()).ActorRdfJoinSelectivityVariableCounting({name:"urn:comunica:default:rdf-join-selectivity/actors#variable-counting",bus:g,busFailMessage:"Determining join selectivity failed: none of the configured actors were able to calculate selectivities"});const Z=new(requireLib$3P()).MediatorNumber({field:"accuracy",type:"max",ignoreFailures:!0,name:"urn:comunica:default:rdf-join-selectivity/mediators#main",bus:g});new(requireLib$3H()).ActorRdfMetadataPrimaryTopic({metadataToData:!1,dataToMetadataOnInvalidMetadataGraph:!0,name:"urn:comunica:default:rdf-metadata/actors#primary-topic",bus:b,busFailMessage:"Metadata splicing failed: none of the configured actors were able to splice metadata from ${action.url}"}),new(requireLib$3G()).ActorRdfMetadataAll({name:"urn:comunica:default:rdf-metadata/actors#all",bus:b,busFailMessage:"Metadata splicing failed: none of the configured actors were able to splice metadata from ${action.url}"});const oe=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-metadata/mediators#main",bus:b});new(requireLib$3E()).ActorRdfMetadataAccumulateCardinality({name:"urn:comunica:default:rdf-metadata-accumulate/actors#cardinality",bus:_,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"}),new(requireLib$3D()).ActorRdfMetadataAccumulatePageSize({name:"urn:comunica:default:rdf-metadata-accumulate/actors#pagesize",bus:_,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"}),new(requireLib$3C()).ActorRdfMetadataAccumulateRequestTime({name:"urn:comunica:default:rdf-metadata-accumulate/actors#requesttime",bus:_,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"});const ie=new(requireLib$3Q()).MediatorCombineUnion({field:"metadata",name:"urn:comunica:default:rdf-metadata-accumulate/mediators#main",bus:_});new(requireLib$3A()).ActorRdfMetadataExtractHydraControls({name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-controls",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3z()).ActorRdfMetadataExtractHydraCount({predicates:["http://www.w3.org/ns/hydra/core#totalItems","http://rdfs.org/ns/void#triples"],name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-count",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3y()).ActorRdfMetadataExtractHydraPagesize({predicates:["http://www.w3.org/ns/hydra/core#itemsPerPage"],name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-pagesize",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3x()).ActorRdfMetadataExtractRequestTime({name:"urn:comunica:default:rdf-metadata-extract/actors#request-time",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3w()).ActorRdfMetadataExtractAllowHttpMethods({name:"urn:comunica:default:rdf-metadata-extract/actors#allow-http-methods",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3v()).ActorRdfMetadataExtractPutAccepted({name:"urn:comunica:default:rdf-metadata-extract/actors#put-accepted",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3u()).ActorRdfMetadataExtractPatchSparqlUpdate({name:"urn:comunica:default:rdf-metadata-extract/actors#patch-sparql-update",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(requireLib$3t()).ActorRdfMetadataExtractSparqlService({inferHttpsEndpoint:!0,name:"urn:comunica:default:rdf-metadata-extract/actors#sparql-service",bus:S,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"});const se=new(requireLib$3Q()).MediatorCombineUnion({filterFailures:!0,field:"metadata",name:"urn:comunica:default:rdf-metadata-extract/mediators#main",bus:S});new(requireLib$3r()).ActorRdfParseN3({mediaTypePriorities:{"application/n-quads":1,"application/n-triples":.8,"application/trig":.95,"text/n3":.35,"text/turtle":.6},mediaTypeFormats:{"application/n-quads":"http://www.w3.org/ns/formats/N-Quads","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","application/trig":"http://www.w3.org/ns/formats/TriG","text/n3":"http://www.w3.org/ns/formats/N3","text/turtle":"http://www.w3.org/ns/formats/Turtle"},priorityScale:1,name:"urn:comunica:default:rdf-parse/actors#n3",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$3q()).ActorRdfParseRdfXml({mediaTypePriorities:{"application/rdf+xml":1},mediaTypeFormats:{"application/rdf+xml":"http://www.w3.org/ns/formats/RDF_XML"},priorityScale:.5,name:"urn:comunica:default:rdf-parse/actors#rdfxml",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$3j()).ActorRdfParseXmlRdfa({mediaTypePriorities:{"application/xml":1,"image/svg+xml":1,"text/xml":1},mediaTypeFormats:{"application/xml":"http://www.w3.org/ns/formats/RDFa","image/svg+xml":"http://www.w3.org/ns/formats/RDFa","text/xml":"http://www.w3.org/ns/formats/RDFa"},priorityScale:.3,name:"urn:comunica:default:rdf-parse/actors#xmlrdfa",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$3h()).ActorRdfParseShaclc({mediaTypePriorities:{"text/shaclc":1,"text/shaclc-ext":.5},mediaTypeFormats:{"text/shaclc":"http://www.w3.org/ns/formats/Shaclc","text/shaclc-ext":"http://www.w3.org/ns/formats/ShaclcExtended"},priorityScale:.1,name:"urn:comunica:default:rdf-parse/actors#shaclc",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"});const ne=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-parse/mediators#parse",bus:T}),he=new(requireLib$3Q()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:rdf-parse/mediators#mediaType",bus:T});new(requireLib$3g()).ActorRdfParseHtml({busRdfParseHtml:w,mediaTypePriorities:{"application/xhtml+xml":.9,"text/html":1},mediaTypeFormats:{"application/xhtml+xml":"http://www.w3.org/ns/formats/HTML","text/html":"http://www.w3.org/ns/formats/HTML"},priorityScale:.2,name:"urn:comunica:default:rdf-parse/actors#html",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$3d()).ActorRdfParseHtmlMicrodata({name:"urn:comunica:default:rdf-parse-html/actors#microdata",bus:w,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(requireLib$3c()).ActorRdfParseHtmlRdfa({name:"urn:comunica:default:rdf-parse-html/actors#rdfa",bus:w,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(requireLib$3a()).ActorRdfResolveHypermediaLinksNext({name:"urn:comunica:default:rdf-resolve-hypermedia-links/actors#next",bus:A,busFailMessage:"Hypermedia link resolution failed: none of the configured actors were able to resolve links from metadata"});const xe=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-resolve-hypermedia-links/mediators#main",bus:A});new(requireLib$38()).ActorRdfResolveHypermediaLinksQueueFifo({name:"urn:comunica:default:rdf-resolve-hypermedia-links-queue/actors#fifo",bus:R,busFailMessage:"Link queue creation failed: none of the configured actors were able to create a link queue starting from ${action.firstUrl}"});const me=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-resolve-hypermedia-links-queue/mediators#main",bus:R});new(requireLib$36()).ActorRdfSerializeN3({mediaTypePriorities:{"application/n-quads":1,"application/n-triples":.8,"application/trig":.95,"text/n3":.35,"text/turtle":.6},mediaTypeFormats:{"application/n-quads":"http://www.w3.org/ns/formats/N-Quads","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","application/trig":"http://www.w3.org/ns/formats/TriG","text/n3":"http://www.w3.org/ns/formats/N3","text/turtle":"http://www.w3.org/ns/formats/Turtle"},name:"urn:comunica:default:rdf-serialize/actors#n3",bus:E,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"}),new(requireLib$35()).ActorRdfSerializeJsonLd({jsonStringifyIndentSpaces:2,mediaTypePriorities:{"application/ld+json":1},mediaTypeFormats:{"application/ld+json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:.9,name:"urn:comunica:default:rdf-serialize/actors#jsonld",bus:E,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"}),new(requireLib$34()).ActorRdfSerializeShaclc({mediaTypePriorities:{"text/shaclc":1,"text/shaclc-ext":.5},mediaTypeFormats:{"text/shaclc":"http://www.w3.org/ns/formats/Shaclc","text/shaclc-ext":"http://www.w3.org/ns/formats/ShaclcExtended"},priorityScale:.1,name:"urn:comunica:default:rdf-serialize/actors#shaclc",bus:E,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"});const Ie=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-serialize/mediators#serialize",bus:E}),Pe=new(requireLib$3Q()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:rdf-serialize/mediators#mediaType",bus:E}),Ce=new(requireLib$3Q()).MediatorCombineUnion({field:"mediaTypeFormats",name:"urn:comunica:default:rdf-serialize/mediators#mediaTypeFormat",bus:E}),pe=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-update-hypermedia/mediators#main",bus:I});new(requireLib$32()).ActorRdfUpdateQuadsRdfJsStore({name:"urn:comunica:default:rdf-update-quads/actors#rdfjs-store",bus:L,busFailMessage:"RDF updating failed: none of the configured actors were able to handle an update"});const H=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:rdf-update-quads/mediators#main",bus:L}),V=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:bindings-aggregator-factory/mediators#main",bus:F}),Q=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:expression-evaluator-factory/mediators#main",bus:D});new(requireLib$31()).ActorFunctionFactoryExpressionBound({name:"urn:comunica:default:function-factory/actors#expression-function-bound",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$30()).ActorFunctionFactoryExpressionBnode({name:"urn:comunica:default:function-factory/actors#expression-function-bnode",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2$()).ActorFunctionFactoryExpressionCoalesce({name:"urn:comunica:default:function-factory/actors#expression-function-coalesce",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2_()).ActorFunctionFactoryExpressionConcat({name:"urn:comunica:default:function-factory/actors#expression-function-concat",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2Z()).ActorFunctionFactoryExpressionExtensions({name:"urn:comunica:default:function-factory/actors#expression-function-extensions",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2Y()).ActorFunctionFactoryExpressionIf({name:"urn:comunica:default:function-factory/actors#expression-function-if",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2X()).ActorFunctionFactoryExpressionLogicalAnd({name:"urn:comunica:default:function-factory/actors#expression-function-logical-and",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2W()).ActorFunctionFactoryExpressionLogicalOr({name:"urn:comunica:default:function-factory/actors#expression-function-logical-or",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2V()).ActorFunctionFactoryExpressionSameTerm({name:"urn:comunica:default:function-factory/actors#expression-function-same-term",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2U()).ActorFunctionFactoryTermAbs({name:"urn:comunica:default:function-factory/actors#term-function-abs",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2T()).ActorFunctionFactoryTermAddition({name:"urn:comunica:default:function-factory/actors#term-function-addition",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2S()).ActorFunctionFactoryTermCeil({name:"urn:comunica:default:function-factory/actors#term-function-ceil",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2R()).ActorFunctionFactoryTermContains({name:"urn:comunica:default:function-factory/actors#term-function-contains",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2Q()).ActorFunctionFactoryTermDatatype({name:"urn:comunica:default:function-factory/actors#term-function-datatype",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2P()).ActorFunctionFactoryTermDay({name:"urn:comunica:default:function-factory/actors#term-function-day",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2O()).ActorFunctionFactoryTermDivision({name:"urn:comunica:default:function-factory/actors#term-function-division",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2N()).ActorFunctionFactoryTermEncodeForUri({name:"urn:comunica:default:function-factory/actors#term-function-encode-for-uri",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2M()).ActorFunctionFactoryTermEquality({name:"urn:comunica:default:function-factory/actors#term-function-equality",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2L()).ActorFunctionFactoryTermFloor({name:"urn:comunica:default:function-factory/actors#term-function-floor",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2K()).ActorFunctionFactoryTermHours({name:"urn:comunica:default:function-factory/actors#term-function-hours",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2J()).ActorFunctionFactoryTermIri({name:"urn:comunica:default:function-factory/actors#term-function-iri",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2I()).ActorFunctionFactoryTermIsBlank({name:"urn:comunica:default:function-factory/actors#term-function-is-blank",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2H()).ActorFunctionFactoryTermIsIri({name:"urn:comunica:default:function-factory/actors#term-function-is-iri",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2G()).ActorFunctionFactoryTermIsNumeric({name:"urn:comunica:default:function-factory/actors#term-function-is-numeric",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2F()).ActorFunctionFactoryTermIsTriple({name:"urn:comunica:default:function-factory/actors#term-function-is-triple",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2E()).ActorFunctionFactoryTermIsLiteral({name:"urn:comunica:default:function-factory/actors#term-function-is-literal",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2D()).ActorFunctionFactoryTermLang({name:"urn:comunica:default:function-factory/actors#term-function-lang",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2C()).ActorFunctionFactoryTermLcase({name:"urn:comunica:default:function-factory/actors#term-function-lcase",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2B()).ActorFunctionFactoryTermLangmatches({name:"urn:comunica:default:function-factory/actors#term-function-langmatches",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2A()).ActorFunctionFactoryTermMinutes({name:"urn:comunica:default:function-factory/actors#term-function-minutes",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2z()).ActorFunctionFactoryTermMd5({name:"urn:comunica:default:function-factory/actors#term-function-md5",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2y()).ActorFunctionFactoryTermMultiplication({name:"urn:comunica:default:function-factory/actors#term-function-multiplication",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2x()).ActorFunctionFactoryTermMonth({name:"urn:comunica:default:function-factory/actors#term-function-month",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2w()).ActorFunctionFactoryTermNot({name:"urn:comunica:default:function-factory/actors#term-function-not",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2v()).ActorFunctionFactoryTermObject({name:"urn:comunica:default:function-factory/actors#term-function-object",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2u()).ActorFunctionFactoryTermNow({name:"urn:comunica:default:function-factory/actors#term-function-now",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2t()).ActorFunctionFactoryTermPredicate({name:"urn:comunica:default:function-factory/actors#term-function-predicate",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2s()).ActorFunctionFactoryTermRand({name:"urn:comunica:default:function-factory/actors#term-function-rand",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2r()).ActorFunctionFactoryTermRegex({name:"urn:comunica:default:function-factory/actors#term-function-regex",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2q()).ActorFunctionFactoryTermReplace({name:"urn:comunica:default:function-factory/actors#term-function-replace",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2p()).ActorFunctionFactoryTermRound({name:"urn:comunica:default:function-factory/actors#term-function-round",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2o()).ActorFunctionFactoryTermSeconds({name:"urn:comunica:default:function-factory/actors#term-function-seconds",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2n()).ActorFunctionFactoryTermSha256({name:"urn:comunica:default:function-factory/actors#term-function-sha256",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2m()).ActorFunctionFactoryTermSha1({name:"urn:comunica:default:function-factory/actors#term-function-sha1",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2l()).ActorFunctionFactoryTermSha384({name:"urn:comunica:default:function-factory/actors#term-function-sha384",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2k()).ActorFunctionFactoryTermSha512({name:"urn:comunica:default:function-factory/actors#term-function-sha512",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2j()).ActorFunctionFactoryTermStrAfter({name:"urn:comunica:default:function-factory/actors#term-function-str-after",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2i()).ActorFunctionFactoryTermStrBefore({name:"urn:comunica:default:function-factory/actors#term-function-str-before",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2h()).ActorFunctionFactoryTermStrDt({name:"urn:comunica:default:function-factory/actors#term-function-str-dt",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2g()).ActorFunctionFactoryTermStrEnds({name:"urn:comunica:default:function-factory/actors#term-function-str-ends",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2f()).ActorFunctionFactoryTermStrLang({name:"urn:comunica:default:function-factory/actors#term-function-str-lang",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2e()).ActorFunctionFactoryTermStrLen({name:"urn:comunica:default:function-factory/actors#term-function-str-len",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2d()).ActorFunctionFactoryTermStrStarts({name:"urn:comunica:default:function-factory/actors#term-function-str-starts",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2c()).ActorFunctionFactoryTermStrUuid({name:"urn:comunica:default:function-factory/actors#term-function-str-uuid",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2b()).ActorFunctionFactoryTermStr({name:"urn:comunica:default:function-factory/actors#term-function-str",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$2a()).ActorFunctionFactoryTermSubStr({name:"urn:comunica:default:function-factory/actors#term-function-sub-str",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$29()).ActorFunctionFactoryTermSubject({name:"urn:comunica:default:function-factory/actors#term-function-subject",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$28()).ActorFunctionFactoryTermSubtraction({name:"urn:comunica:default:function-factory/actors#term-function-subtraction",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$27()).ActorFunctionFactoryTermTimezone({name:"urn:comunica:default:function-factory/actors#term-function-timezone",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$26()).ActorFunctionFactoryTermTriple({name:"urn:comunica:default:function-factory/actors#term-function-triple",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$25()).ActorFunctionFactoryTermTz({name:"urn:comunica:default:function-factory/actors#term-function-tz",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$24()).ActorFunctionFactoryTermUcase({name:"urn:comunica:default:function-factory/actors#term-function-ucase",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$23()).ActorFunctionFactoryTermUnaryMinus({name:"urn:comunica:default:function-factory/actors#term-function-unary-minus",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$22()).ActorFunctionFactoryTermUnaryPlus({name:"urn:comunica:default:function-factory/actors#term-function-unary-plus",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$21()).ActorFunctionFactoryTermUuid({name:"urn:comunica:default:function-factory/actors#term-function-uuid",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$20()).ActorFunctionFactoryTermXsdToBoolean({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-boolean",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1$()).ActorFunctionFactoryTermXsdToDate({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-date",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1_()).ActorFunctionFactoryTermXsdToDatetime({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-datetime",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1Z()).ActorFunctionFactoryTermXsdToDayTimeDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-day-time-duration",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1Y()).ActorFunctionFactoryTermXsdToDouble({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-double",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1X()).ActorFunctionFactoryTermXsdToDecimal({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-decimal",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1W()).ActorFunctionFactoryTermXsdToDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-duration",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1V()).ActorFunctionFactoryTermXsdToFloat({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-float",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1U()).ActorFunctionFactoryTermXsdToInteger({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-integer",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1T()).ActorFunctionFactoryTermXsdToTime({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-time",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1S()).ActorFunctionFactoryTermXsdToString({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-string",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1R()).ActorFunctionFactoryTermXsdToYearMonthDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-year-month-duration",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1Q()).ActorFunctionFactoryTermYear({name:"urn:comunica:default:function-factory/actors#term-function-year",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"});const ee=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:function-factory/mediators#main",bus:$}),ae=new(requireLib$1N()).ActorHttpFetch({agentOptions:{keepAlive:!0,maxSockets:5},name:"urn:comunica:default:http/actors#fetch",bus:O,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}"}),be=new(requireLib$3P()).MediatorNumber({field:"time",type:"min",ignoreFailures:!0,name:"urn:comunica:default:http/mediators#no-fallback",bus:O}),le=new(requireLib$3P()).MediatorNumber({field:"time",type:"min",ignoreFailures:!0,name:"urn:comunica:default:http/mediators#main",bus:P});new(requireLib$1M()).ActorQueryOperationSource({name:"urn:comunica:default:query-operation/actors#source",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const we=new(requireLib$3P()).MediatorNumber({field:"httpRequests",type:"min",ignoreFailures:!0,name:"urn:comunica:default:query-operation/mediators#main",bus:C}),De=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:query-process/mediators#main",bus:q}),Fe=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:query-source-identify/mediators#main",bus:M}),Ne=new(requireLib$1L()).MediatorJoinCoefficientsFixed({cpuWeight:10,memoryWeight:1,timeWeight:2,ioWeight:10,name:"urn:comunica:default:rdf-join/mediators#main",bus:N}),de=new(requireLib$4a()).MediatorRace({name:"urn:comunica:default:term-comparator-factory/mediators#main",bus:G}),Le=new(requireLib$1K()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-context-preprocess-query-source-identify/^4.0.0/components/ActorContextPreprocessQuerySourceIdentify.jsonld#IActorContextPreprocessQuerySourceIdentifyArgs_default_invalidator",bus:X,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),$e=new(requireLib$1J()).MediatorAll({name:"urn:comunica:default:http-invalidate/mediators#main",bus:X}),je=new(requireLib$1K()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-rdf-update-quads-hypermedia/^4.0.0/components/ActorRdfUpdateQuadsHypermedia.jsonld#IActorRdfUpdateQuadsHypermediaArgs_default_invalidator",bus:X,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),Me=new(requireLib$1K()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-http-retry/^4.0.0/components/ActorHttpRetry.jsonld#IActorHttpQueueArgs_default_invalidator",bus:X,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),ze=new(requireLib$1K()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-sparql-json/^4.0.0/components/ActionObserverHttp.jsonld#IActionObserverHttpArgs_default_invalidator",bus:X,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),Je=new(requireLib$1K()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-stats/^4.0.0/components/ActionObserverHttp.jsonld#IActionObserverHttpArgs_default_invalidator",bus:X,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),Ke=new(requireLib$3Q()).MediatorCombineUnion({field:"mergeHandlers",name:"urn:comunica:default:merge-bindings-context/mediators#main",bus:Y});new(requireLib$1G()).ActorRdfJoinSingle({mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-single",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1F()).ActorRdfJoinMultiEmpty({mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-multi-empty",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});const ot=new(requireLib$1D()).ActorRdfJoinHash({mediatorHashBindings:ue,canHandleUndefs:!1,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-hash-def",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),_e=new(requireLib$1D()).ActorRdfJoinHash({mediatorHashBindings:ue,canHandleUndefs:!0,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-hash-undef",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),Ae=new(requireLib$1C()).ActorRdfJoinSymmetricHash({mediatorHashBindings:ue,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-symmetric-hash",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),Ve=new(requireLib$1B()).ActorRdfJoinNestedLoop({mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-nested-loop",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});new(requireLib$1z()).ActorRdfJoinMinusHash({canHandleUndefs:!1,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#minus-hash-def",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1z()).ActorRdfJoinMinusHash({canHandleUndefs:!0,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#minus-hash-undef",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1y()).ActorRdfJoinOptionalHash({canHandleUndefs:!1,blocking:!1,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-hash-def-nonblocking",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1y()).ActorRdfJoinOptionalHash({canHandleUndefs:!1,blocking:!0,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-hash-def-blocking",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1y()).ActorRdfJoinOptionalHash({canHandleUndefs:!0,blocking:!1,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-hash-undef-nonblocking",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1y()).ActorRdfJoinOptionalHash({canHandleUndefs:!0,blocking:!0,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-hash-undef-blocking",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1x()).ActorRdfJoinOptionalNestedLoop({mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-nested-loop",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$1v()).ActorDereferenceRdfParse({mediatorDereference:z,mediatorParse:ne,mediatorParseMediatypes:he,mediaMappings:{htm:"text/html",html:"text/html",json:"application/json",jsonld:"application/ld+json",n3:"text/n3",nq:"application/n-quads",nquads:"application/n-quads",nt:"application/n-triples",ntriples:"application/n-triples",owl:"application/rdf+xml",rdf:"application/rdf+xml",rdfxml:"application/rdf+xml",shaclc:"text/shaclc",shaclce:"text/shaclc-ext",shc:"text/shaclc",shce:"text/shaclc-ext",svg:"image/svg+xml",svgz:"image/svg+xml",trig:"application/trig",ttl:"text/turtle",turtle:"text/turtle",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xml:"application/xml"},name:"urn:comunica:default:dereference-rdf/actors#parse",bus:h,busFailMessage:"RDF dereferencing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$1u()).ActorRdfParseHtmlScript({mediatorRdfParseMediatypes:he,mediatorRdfParseHandle:ne,name:"urn:comunica:default:rdf-parse-html/actors#script",bus:w,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(requireLib$1t()).ActorQueryResultSerializeRdf({mediatorRdfSerialize:Ie,mediatorMediaTypeCombiner:Pe,mediatorMediaTypeFormatCombiner:Ce,name:"urn:comunica:default:query-result-serialize/actors#rdf",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$1r()).ActorBindingsAggregatorFactoryCount({mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#count",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1q()).ActorBindingsAggregatorFactoryGroupConcat({mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#group-concat",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1p()).ActorBindingsAggregatorFactorySample({mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#sample",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1o()).ActorBindingsAggregatorFactoryWildcardCount({mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#wildcard-count",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1n()).ActorBindingsAggregatorFactoryAverage({mediatorFunctionFactory:ee,mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#average",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1m()).ActorBindingsAggregatorFactorySum({mediatorFunctionFactory:ee,mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#sum",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$1l()).ActorFunctionFactoryExpressionIn({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#expression-function-in",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1k()).ActorFunctionFactoryExpressionNotIn({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#expression-function-not-in",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1j()).ActorFunctionFactoryTermGreaterThanEqual({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#term-function-greater-than-equal",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1i()).ActorFunctionFactoryTermGreaterThan({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#term-function-greater-than",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1h()).ActorFunctionFactoryTermInequality({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#term-function-inequality",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1g()).ActorFunctionFactoryTermLesserThanEqual({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#term-function-lesser-than-equal",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1f()).ActorFunctionFactoryTermLesserThan({mediatorFunctionFactory:ee,name:"urn:comunica:default:function-factory/actors#term-function-lesser-than",bus:$,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(requireLib$1e()).ActorHttpWayback({mediatorHttp:be,name:"urn:comunica:default:http/actors#wayback",bus:P,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}"}),new(requireLib$1d()).ActorRdfParseJsonLd({mediatorHttp:le,mediaTypePriorities:{"application/json":.15,"application/ld+json":1},mediaTypeFormats:{"application/json":"http://www.w3.org/ns/formats/JSON-LD","application/ld+json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:.9,name:"urn:comunica:default:rdf-parse/actors#jsonld",bus:T,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(requireLib$1b()).ActorRdfUpdateHypermediaPatchSparqlUpdate({mediatorHttp:le,name:"urn:comunica:default:rdf-update-hypermedia/actors#patch-sparql-update",bus:I,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(requireLib$1a()).ActorRdfUpdateHypermediaPutLdp({mediatorHttp:le,mediatorRdfSerializeMediatypes:Pe,mediatorRdfSerialize:Ie,name:"urn:comunica:default:rdf-update-hypermedia/actors#put-ldp",bus:I,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(requireLib$19()).ActorRdfUpdateHypermediaSparql({mediatorHttp:le,checkUrlSuffixSparql:!0,checkUrlSuffixUpdate:!0,name:"urn:comunica:default:rdf-update-hypermedia/actors#sparql",bus:I,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(requireLib$18()).ActorQueryOperationAsk({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#ask",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$17()).ActorQueryOperationBgpJoin({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#bgp",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$16()).ActorQueryOperationConstruct({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#construct",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$15()).ActorQueryOperationDistinctHash({mediatorHashBindings:ue,mediatorHashQuads:fe,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#distinct",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$14()).ActorQueryOperationExtend({mediatorExpressionEvaluatorFactory:Q,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#extend",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$13()).ActorQueryOperationFilter({mediatorExpressionEvaluatorFactory:Q,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#filter",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$12()).ActorQueryOperationFromQuad({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#from",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$11()).ActorQueryOperationProject({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#project",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$10()).ActorQueryOperationReducedHash({mediatorHashBindings:ue,cacheSize:100,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#reduced",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$$()).ActorQueryOperationSlice({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#slice",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$_()).ActorQueryOperationUnion({mediatorRdfMetadataAccumulate:ie,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#union",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$Y()).ActorQueryOperationPathAlt({mediatorRdfMetadataAccumulate:ie,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-alt",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$X()).ActorQueryOperationPathInv({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-inv",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$W()).ActorQueryOperationPathLink({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-link",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$V()).ActorQueryOperationPathNps({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-nps",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$U()).ActorQueryOperationClear({mediatorUpdateQuads:H,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-clear",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$T()).ActorQueryOperationUpdateCompositeUpdate({mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-composite",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$S()).ActorQueryOperationCreate({mediatorUpdateQuads:H,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-create",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$R()).ActorQueryOperationDrop({mediatorUpdateQuads:H,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-drop",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$Q()).ActorQueryOperationLoad({mediatorUpdateQuads:H,mediatorQuerySourceIdentify:Fe,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-load",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$P()).ActorQueryOperationJoin({mediatorJoin:Ne,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#join",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$O()).ActorQueryOperationLeftJoin({mediatorJoin:Ne,mediatorExpressionEvaluatorFactory:Q,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#leftjoin",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$N()).ActorQueryOperationMinus({mediatorJoin:Ne,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#minus",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$M()).ActorQueryOperationPathSeq({mediatorJoin:Ne,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-seq",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const Ue=new(requireLib$L()).ActorRdfJoinMultiSmallest({mediatorJoinEntriesSort:U,mediatorJoin:Ne,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-multi-smallest",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});new(requireLib$K()).ActorBindingsAggregatorFactoryMax({mediatorTermComparatorFactory:de,mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#max",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$J()).ActorBindingsAggregatorFactoryMin({mediatorTermComparatorFactory:de,mediatorExpressionEvaluatorFactory:Q,name:"urn:comunica:default:bindings-aggregator-factory/actors#min",bus:F,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(requireLib$I()).ActorQueryOperationOrderBy({mediatorExpressionEvaluatorFactory:Q,mediatorTermComparatorFactory:de,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#orderby",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const We=new(requireLib$H()).ActorOptimizeQueryOperationFilterPushdown({aggressivePushdown:!1,maxIterations:10,splitConjunctive:!0,mergeConjunctive:!0,pushIntoLeftJoins:!0,pushEqualityIntoPatterns:!0,name:"urn:comunica:default:optimize-query-operation/actors#filter-pushdown",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[re]});new(requireLib$G()).ActorDereferenceHttp({mediatorHttp:le,maxAcceptHeaderLength:1024,maxAcceptHeaderLengthBrowser:128,name:"urn:comunica:default:dereference/actors#http",bus:f,busFailMessage:"Dereferencing failed: none of the configured actors were able to handle ${action.url}",beforeActors:[j]});const pt=new(requireLib$F()).ActorHttpProxy({mediatorHttp:le,name:"urn:comunica:default:http/actors#proxy",bus:O,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}",beforeActors:[ae]});new(requireLib$E()).ActorContextPreprocessQuerySourceIdentify({cacheSize:100,httpInvalidator:Le,mediatorQuerySourceIdentify:Fe,mediatorContextPreprocess:te,name:"urn:comunica:default:context-preprocess/actors#query-source-identify",bus:a,busFailMessage:"Context preprocessing failed",beforeActors:[W]});const Ge=new(requireIndexBrowser$1()).ActorInitQuery({mediatorQueryProcess:De,mediatorQueryResultSerialize:Re,mediatorQueryResultSerializeMediaTypeCombiner:ve,mediatorQueryResultSerializeMediaTypeFormatCombiner:ce,mediatorHttpInvalidate:$e,defaultQueryInputFormat:"sparql",allowNoSources:!1,name:"urn:comunica:default:init/actors#query",bus:r,busFailMessage:"Initialization failed: none of the configured actors were to initialize"});new(requireLib$D()).ActorRdfUpdateQuadsHypermedia({cacheSize:100,httpInvalidator:je,mediatorDereferenceRdf:B,mediatorMetadata:oe,mediatorMetadataExtract:se,mediatorRdfUpdateHypermedia:pe,name:"urn:comunica:default:rdf-update-quads/actors#hypermedia",bus:L,busFailMessage:"RDF updating failed: none of the configured actors were able to handle an update"});const ct=new(requireLib$C()).ActionObserverHttp({httpInvalidator:ze,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-sparql-json/^4.0.0/components/ActorQueryResultSerializeSparqlJson.jsonld#ActorQueryResultSerializeSparqlJson_default_observer",bus:O}),Xe=new(requireLib$B()).ActionObserverHttp({httpInvalidator:Je,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-stats/^4.0.0/components/ActorQueryResultSerializeStats.jsonld#ActorQueryResultSerializeStats_default_observer",bus:O});new(requireLib$y()).ActorQuerySourceIdentifyHypermediaQpf({mediatorMetadata:oe,mediatorMetadataExtract:se,mediatorDereferenceRdf:B,mediatorMergeBindingsContext:Ke,subjectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#subject",predicateUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate",objectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#object",graphUri:"http://www.w3.org/ns/sparql-service-description#graph",name:"urn:comunica:default:query-source-identify-hypermedia/actors#qpf",bus:d,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(requireLib$x()).ActorQuerySourceIdentifyHypermediaSparql({mediatorHttp:le,mediatorMergeBindingsContext:Ke,checkUrlSuffix:!0,forceHttpGet:!1,cacheSize:1024,bindMethod:"values",countTimeout:3e3,name:"urn:comunica:default:rdf-resolve-quad-pattern/actors#sparql",bus:d,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(requireLib$v()).ActorQuerySourceIdentifyHypermediaNone({mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:query-source-identify-hypermedia/actors#none",bus:d,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(requireLib$t()).ActorExpressionEvaluatorFactoryDefault({mediatorQueryOperation:we,mediatorFunctionFactory:ee,mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:expression-evaluator-factory/actors#default",bus:D,busFailMessage:"Creation of Expression Evaluator failed"}),new(requireLib$s()).ActorQueryOperationGroup({mediatorMergeBindingsContext:Ke,mediatorBindingsAggregatorFactory:V,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#group",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$r()).ActorQueryOperationNop({mediatorMergeBindingsContext:Ke,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#nop",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$q()).ActorQueryOperationService({forceSparqlEndpoint:!1,mediatorMergeBindingsContext:Ke,mediatorQuerySourceIdentify:Fe,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#service",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$p()).ActorQueryOperationValues({mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:query-operation/actors#values",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$o()).ActorQueryOperationPathOneOrMore({mediatorMergeBindingsContext:Ke,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-one-or-more",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$n()).ActorQueryOperationPathZeroOrMore({mediatorMergeBindingsContext:Ke,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-zero-or-more",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$m()).ActorQueryOperationPathZeroOrOne({mediatorMergeBindingsContext:Ke,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#path-zero-or-one",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(requireLib$l()).ActorQueryOperationUpdateDeleteInsert({mediatorUpdateQuads:H,mediatorMergeBindingsContext:Ke,mediatorQueryOperation:we,name:"urn:comunica:default:query-operation/actors#update-delete-insert",bus:C,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const Ye=new(requireLib$j()).ActorQueryProcessSequential({mediatorContextPreprocess:te,mediatorQueryParse:Te,mediatorOptimizeQueryOperation:ye,mediatorQueryOperation:we,mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:query-process/actors#sequential",bus:q,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),nt=new(requireLib$i()).ActorQuerySourceIdentifyHypermedia({cacheSize:100,maxIterators:64,aggregateTraversalStore:!0,mediatorDereferenceRdf:B,mediatorMetadata:oe,mediatorMetadataExtract:se,mediatorMetadataAccumulate:ie,mediatorQuerySourceIdentifyHypermedia:J,mediatorRdfResolveHypermediaLinks:xe,mediatorRdfResolveHypermediaLinksQueue:me,mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:query-source-identify/actors#hypermedia",bus:M,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}"});new(requireLib$h()).ActorRdfJoinNone({mediatorMergeBindingsContext:Ke,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-none",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$f()).ActorRdfJoinOptionalBind({bindOrder:"depth-first",selectivityModifier:1e-6,mediatorQueryOperation:we,mediatorMergeBindingsContext:Ke,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#optional-bind",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(requireLib$d()).ActorTermComparatorFactoryExpressionEvaluator({mediatorQueryOperation:we,mediatorFunctionFactory:ee,mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:term-comparator-factory/actors#expression-evaluator",bus:G,busFailMessage:"Creation of term comparator failed"});const gt=new(requireLib$g()).ActorRdfJoinMultiBind({bindOrder:"depth-first",selectivityModifier:1e-4,minMaxCardinalityRatio:60,mediatorJoinEntriesSort:U,mediatorQueryOperation:we,mediatorMergeBindingsContext:Ke,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-multi-bind",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[Ue,ot,_e,Ae,Ve]});new(requireLib$c()).ActorRdfJoinMultiSmallestFilterBindings({selectivityModifier:1e-4,blockSize:64,mediatorJoinEntriesSort:U,mediatorJoin:Ne,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-multi-smallest-filter-bindings",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[Ue,ot,_e,Ae,Ve]}),new(requireLib$C()).ActorQueryResultSerializeSparqlJson({emitMetadata:!0,httpObserver:ct,mediaTypePriorities:{"application/sparql-results+json":.8},mediaTypeFormats:{"application/sparql-results+json":"http://www.w3.org/ns/formats/SPARQL_Results_JSON"},name:"urn:comunica:default:query-result-serialize/actors#sparql-json",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$B()).ActorQueryResultSerializeStats({httpObserver:Xe,mediaTypePriorities:{stats:.5},mediaTypeFormats:{stats:"https://comunica.linkeddatafragments.org/#results_stats"},name:"urn:comunica:default:query-result-serialize/actors#stats",bus:l,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(requireLib$b()).ActorQueryProcessExplainParsed({queryProcessor:Ye,name:"urn:comunica:default:query-process/actors#explain-parsed",bus:q,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),new(requireLib$a()).ActorQueryProcessExplainLogical({queryProcessor:Ye,name:"urn:comunica:default:query-process/actors#explain-logical",bus:q,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),new(requireLib$9()).ActorQueryProcessExplainPhysical({queryProcessor:Ye,name:"urn:comunica:default:query-process/actors#explain-physical",bus:q,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'});const ut=new(requireLib$8()).ActorOptimizeQueryOperationPruneEmptySourceOperations({useAskIfSupported:!1,name:"urn:comunica:default:optimize-query-operation/actors#prune-empty-source-operations",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[We]});new(requireLib$7()).ActorHttpRetry({mediatorHttp:le,httpInvalidator:Me,name:"urn:comunica:default:http/actors#retry",bus:O,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}",beforeActors:[pt]}),new(requireLib$w()).ActorQuerySourceIdentifyRdfJs({mediatorMergeBindingsContext:Ke,name:"urn:comunica:default:query-source-identify/actors#rdfjs",bus:M,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}",beforeActors:[nt]}),new(requireLib$6()).ActorQuerySourceIdentifySerialized({mediatorRdfParse:ne,mediatorQuerySourceIdentify:Fe,name:"urn:comunica:default:query-source-identify/actors#serialized",bus:M,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}",beforeActors:[nt]}),new(requireLib$5()).ActorRdfJoinMultiBindSource({selectivityModifier:1e-4,blockSize:16,mediatorJoinEntriesSort:U,mediatorJoinSelectivity:Z,name:"urn:comunica:default:rdf-join/actors#inner-multi-bind-source",bus:N,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[Ue,gt,ot,_e,Ae,Ve]});const tt=new(requireLib$4()).ActorOptimizeQueryOperationJoinConnected({name:"urn:comunica:default:optimize-query-operation/actors#join-connected",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[ut]}),Ct=new(requireLib$3()).ActorOptimizeQueryOperationBgpToJoin({name:"urn:comunica:default:optimize-query-operation/actors#bgp-to-join",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[tt]}),Ze=new(requireLib$2()).ActorOptimizeQueryOperationJoinBgp({name:"urn:comunica:default:optimize-query-operation/actors#join-bgp",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[Ct]}),Ee=new(requireLib$1()).ActorOptimizeQueryOperationAssignSourcesExhaustive({name:"urn:comunica:default:optimize-query-operation/actors#assign-sources-exhaustive",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[Ze]});return new(requireLib()).ActorOptimizeQueryOperationDescribeToConstructsSubject({name:"urn:comunica:default:optimize-query-operation/actors#describe-to-constructs-subject",bus:s,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[Ee]}),Ge}),engineDefault}var hasRequiredQueryEngine;function requireQueryEngine(){if(hasRequiredQueryEngine)return QueryEngine;hasRequiredQueryEngine=1,Object.defineProperty(QueryEngine,"__esModule",{value:!0}),QueryEngine.QueryEngine=void 0;const n=requireIndexBrowser$1(),t=requireEngineDefault();let r=class extends n.QueryEngineBase{constructor(o=t()){super(o)}};return QueryEngine.QueryEngine=r,QueryEngine}var hasRequiredIndexBrowser;function requireIndexBrowser(){return hasRequiredIndexBrowser||(hasRequiredIndexBrowser=1,function(n){var t=indexBrowser$1&&indexBrowser$1.__createBinding||(Object.create?function(a,o,u,s){s===void 0&&(s=u);var c=Object.getOwnPropertyDescriptor(o,u);(!c||("get"in c?!o.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(a,s,c)}:function(a,o,u,s){s===void 0&&(s=u),a[s]=o[u]}),r=indexBrowser$1&&indexBrowser$1.__exportStar||function(a,o){for(var u in a)u!=="default"&&!Object.prototype.hasOwnProperty.call(o,u)&&t(o,a,u)};Object.defineProperty(n,"__esModule",{value:!0}),r(requireQueryEngine(),n)}(indexBrowser$1)),indexBrowser$1}var indexBrowserExports=requireIndexBrowser();const data$2=writable$1({nodes:[],edges:[]}),selectedNode=writable$1(null),selectedSourceNode=writable$1(null),showNodeEditor=writable$1(!1),nodeColor=writable$1(""),nodeLabel=writable$1(""),nodeDescription=writable$1(""),nodeDomain=writable$1(""),nodeType=writable$1(""),selectedEdge=writable$1(null),showEdgeEditor=writable$1(!1),edgeLabel=writable$1(""),edgeColor=writable$1(""),edgeDomain=writable$1(""),edgeType=writable$1(""),edgeDescription=writable$1(""),nodeFlags=writable$1(null),edgeFlags=writable$1(null),nodeRestrictions=writable$1(null),edgeRestrictions=writable$1(null),edgeName=writable$1(""),nodeName=writable$1(""),showSearchEditor=writable$1(!1),searchDocuments=writable$1([]);function _typeof(n){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(n)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}function _createClass(n,t,r){return t&&_defineProperties(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function _defineProperty$1(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function _slicedToArray(n,t){return _arrayWithHoles(n)||_iterableToArrayLimit(n,t)||_unsupportedIterableToArray(n,t)||_nonIterableRest()}function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayWithHoles(n){if(Array.isArray(n))return n}function _iterableToArray(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function _iterableToArrayLimit(n,t){var r=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(r!=null){var a=[],o=!0,u=!1,s,c;try{for(r=r.call(n);!(o=(s=r.next()).done)&&(a.push(s.value),!(t&&a.length===t));o=!0);}catch(l){u=!0,c=l}finally{try{!o&&r.return!=null&&r.return()}finally{if(u)throw c}}return a}}function _unsupportedIterableToArray(n,t){if(n){if(typeof n=="string")return _arrayLikeToArray(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(n,t)}}function _arrayLikeToArray(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=n[r];return a}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _createForOfIteratorHelper(n,t){var r=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!r){if(Array.isArray(n)||(r=_unsupportedIterableToArray(n))||t){r&&(n=r);var a=0,o=function(){};return{s:o,n:function(){return a>=n.length?{done:!0}:{done:!1,value:n[a++]}},e:function(l){throw l},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=!0,s=!1,c;return{s:function(){r=r.call(n)},n:function(){var l=r.next();return u=l.done,l},e:function(l){s=!0,c=l},f:function(){try{!u&&r.return!=null&&r.return()}finally{if(s)throw c}}}}var _window=typeof window>"u"?null:window,navigator$1=_window?_window.navigator:null;_window&&_window.document;var typeofstr=_typeof(""),typeofobj=_typeof({}),typeoffn=_typeof(function(){}),typeofhtmlele=typeof HTMLElement>"u"?"undefined":_typeof(HTMLElement),instanceStr=function(t){return t&&t.instanceString&&fn$6(t.instanceString)?t.instanceString():null},string=function(t){return t!=null&&_typeof(t)==typeofstr},fn$6=function(t){return t!=null&&_typeof(t)===typeoffn},array=function(t){return!elementOrCollection(t)&&(Array.isArray?Array.isArray(t):t!=null&&t instanceof Array)},plainObject=function(t){return t!=null&&_typeof(t)===typeofobj&&!array(t)&&t.constructor===Object},object=function(t){return t!=null&&_typeof(t)===typeofobj},number$1=function(t){return t!=null&&_typeof(t)===_typeof(1)&&!isNaN(t)},integer=function(t){return number$1(t)&&Math.floor(t)===t},htmlElement=function(t){if(typeofhtmlele!=="undefined")return t!=null&&t instanceof HTMLElement},elementOrCollection=function(t){return element(t)||collection(t)},element=function(t){return instanceStr(t)==="collection"&&t._private.single},collection=function(t){return instanceStr(t)==="collection"&&!t._private.single},core=function(t){return instanceStr(t)==="core"},stylesheet=function(t){return instanceStr(t)==="stylesheet"},event=function(t){return instanceStr(t)==="event"},emptyString=function(t){return t==null?!0:!!(t===""||t.match(/^\s+$/))},domElement=function(t){return typeof HTMLElement>"u"?!1:t instanceof HTMLElement},boundingBox=function(t){return plainObject(t)&&number$1(t.x1)&&number$1(t.x2)&&number$1(t.y1)&&number$1(t.y2)},promise=function(t){return object(t)&&fn$6(t.then)},ms=function(){return navigator$1&&navigator$1.userAgent.match(/msie|trident|edge/i)},memoize$1=function(t,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var u=[],s=0;s<arguments.length;s++)u.push(arguments[s]);return u.join("$")});var a=function o(){var u=this,s=arguments,c,l=r.apply(u,s),d=o.cache;return(c=d[l])||(c=d[l]=t.apply(u,s)),c};return a.cache={},a},camel2dash=memoize$1(function(n){return n.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}),dash2camel=memoize$1(function(n){return n.replace(/(-\w)/g,function(t){return t[1].toUpperCase()})}),prependCamel=memoize$1(function(n,t){return n+t[0].toUpperCase()+t.substring(1)},function(n,t){return n+"$"+t}),capitalize=function(t){return emptyString(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},number="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",rgba="rgb[a]?\\(("+number+"[%]?)\\s*,\\s*("+number+"[%]?)\\s*,\\s*("+number+"[%]?)(?:\\s*,\\s*("+number+"))?\\)",rgbaNoBackRefs="rgb[a]?\\((?:"+number+"[%]?)\\s*,\\s*(?:"+number+"[%]?)\\s*,\\s*(?:"+number+"[%]?)(?:\\s*,\\s*(?:"+number+"))?\\)",hsla="hsl[a]?\\(("+number+")\\s*,\\s*("+number+"[%])\\s*,\\s*("+number+"[%])(?:\\s*,\\s*("+number+"))?\\)",hslaNoBackRefs="hsl[a]?\\((?:"+number+")\\s*,\\s*(?:"+number+"[%])\\s*,\\s*(?:"+number+"[%])(?:\\s*,\\s*(?:"+number+"))?\\)",hex3="\\#[0-9a-fA-F]{3}",hex6="\\#[0-9a-fA-F]{6}",ascending=function(t,r){return t<r?-1:t>r?1:0},descending=function(t,r){return-1*ascending(t,r)},extend=Object.assign!=null?Object.assign.bind(Object):function(n){for(var t=arguments,r=1;r<t.length;r++){var a=t[r];if(a!=null)for(var o=Object.keys(a),u=0;u<o.length;u++){var s=o[u];n[s]=a[s]}}return n},hex2tuple=function(t){if(!(!(t.length===4||t.length===7)||t[0]!=="#")){var r=t.length===4,a,o,u,s=16;return r?(a=parseInt(t[1]+t[1],s),o=parseInt(t[2]+t[2],s),u=parseInt(t[3]+t[3],s)):(a=parseInt(t[1]+t[2],s),o=parseInt(t[3]+t[4],s),u=parseInt(t[5]+t[6],s)),[a,o,u]}},hsl2tuple=function(t){var r,a,o,u,s,c,l,d;function f(b,_,S){return S<0&&(S+=1),S>1&&(S-=1),S<1/6?b+(_-b)*6*S:S<1/2?_:S<2/3?b+(_-b)*(2/3-S)*6:b}var h=new RegExp("^"+hsla+"$").exec(t);if(h){if(a=parseInt(h[1]),a<0?a=(360- -1*a%360)%360:a>360&&(a=a%360),a/=360,o=parseFloat(h[2]),o<0||o>100||(o=o/100,u=parseFloat(h[3]),u<0||u>100)||(u=u/100,s=h[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(o===0)c=l=d=Math.round(u*255);else{var v=u<.5?u*(1+o):u+o-u*o,g=2*u-v;c=Math.round(255*f(g,v,a+1/3)),l=Math.round(255*f(g,v,a)),d=Math.round(255*f(g,v,a-1/3))}r=[c,l,d,s]}return r},rgb2tuple=function(t){var r,a=new RegExp("^"+rgba+"$").exec(t);if(a){r=[];for(var o=[],u=1;u<=3;u++){var s=a[u];if(s[s.length-1]==="%"&&(o[u]=!0),s=parseFloat(s),o[u]&&(s=s/100*255),s<0||s>255)return;r.push(Math.floor(s))}var c=o[1]||o[2]||o[3],l=o[1]&&o[2]&&o[3];if(c&&!l)return;var d=a[4];if(d!==void 0){if(d=parseFloat(d),d<0||d>1)return;r.push(d)}}return r},colorname2tuple=function(t){return colors[t.toLowerCase()]},color2tuple=function(t){return(array(t)?t:null)||colorname2tuple(t)||hex2tuple(t)||rgb2tuple(t)||hsl2tuple(t)},colors={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},setMap=function(t){for(var r=t.map,a=t.keys,o=a.length,u=0;u<o;u++){var s=a[u];if(plainObject(s))throw Error("Tried to set map with object key");u<a.length-1?(r[s]==null&&(r[s]={}),r=r[s]):r[s]=t.value}},getMap=function(t){for(var r=t.map,a=t.keys,o=a.length,u=0;u<o;u++){var s=a[u];if(plainObject(s))throw Error("Tried to get map with object key");if(r=r[s],r==null)return r}return r};function isObject(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}var isObject_1=isObject,commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function createCommonjsModule(n,t){return t={exports:{}},n(t,t.exports),t.exports}var freeGlobal=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$5=_freeGlobal||freeSelf||Function("return this")(),_root=root$5,now=function(){return _root.Date.now()},now_1=now,reWhitespace=/\s/;function trimmedEndIndex(n){for(var t=n.length;t--&&reWhitespace.test(n.charAt(t)););return t}var _trimmedEndIndex=trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim(n){return n&&n.slice(0,_trimmedEndIndex(n)+1).replace(reTrimStart,"")}var _baseTrim=baseTrim,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty,nativeObjectToString$1=objectProto$5.toString,symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(n){var t=hasOwnProperty$4.call(n,symToStringTag$1),r=n[symToStringTag$1];try{n[symToStringTag$1]=void 0;var a=!0}catch{}var o=nativeObjectToString$1.call(n);return a&&(t?n[symToStringTag$1]=r:delete n[symToStringTag$1]),o}var _getRawTag=getRawTag,objectProto$4=Object.prototype,nativeObjectToString=objectProto$4.toString;function objectToString(n){return nativeObjectToString.call(n)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(n){return n==null?n===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(n)?_getRawTag(n):_objectToString(n)}var _baseGetTag=baseGetTag;function isObjectLike(n){return n!=null&&typeof n=="object"}var isObjectLike_1=isObjectLike,symbolTag="[object Symbol]";function isSymbol(n){return typeof n=="symbol"||isObjectLike_1(n)&&_baseGetTag(n)==symbolTag}var isSymbol_1=isSymbol,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(n){if(typeof n=="number")return n;if(isSymbol_1(n))return NAN;if(isObject_1(n)){var t=typeof n.valueOf=="function"?n.valueOf():n;n=isObject_1(t)?t+"":t}if(typeof n!="string")return n===0?n:+n;n=_baseTrim(n);var r=reIsBinary.test(n);return r||reIsOctal.test(n)?freeParseInt(n.slice(2),r?2:8):reIsBadHex.test(n)?NAN:+n}var toNumber_1=toNumber,FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(n,t,r){var a,o,u,s,c,l,d=0,f=!1,h=!1,v=!0;if(typeof n!="function")throw new TypeError(FUNC_ERROR_TEXT$1);t=toNumber_1(t)||0,isObject_1(r)&&(f=!!r.leading,h="maxWait"in r,u=h?nativeMax(toNumber_1(r.maxWait)||0,t):u,v="trailing"in r?!!r.trailing:v);function g(I){var L=a,F=o;return a=o=void 0,d=I,s=n.apply(F,L),s}function b(I){return d=I,c=setTimeout(T,t),f?g(I):s}function _(I){var L=I-l,F=I-d,D=t-L;return h?nativeMin(D,u-F):D}function S(I){var L=I-l,F=I-d;return l===void 0||L>=t||L<0||h&&F>=u}function T(){var I=now_1();if(S(I))return w(I);c=setTimeout(T,_(I))}function w(I){return c=void 0,v&&a?g(I):(a=o=void 0,s)}function A(){c!==void 0&&clearTimeout(c),d=0,a=l=o=c=void 0}function R(){return c===void 0?s:w(now_1())}function E(){var I=now_1(),L=S(I);if(a=arguments,o=this,l=I,L){if(c===void 0)return b(l);if(h)return clearTimeout(c),c=setTimeout(T,t),g(l)}return c===void 0&&(c=setTimeout(T,t)),s}return E.cancel=A,E.flush=R,E}var debounce_1=debounce,performance$1=_window?_window.performance:null,pnow=performance$1&&performance$1.now?function(){return performance$1.now()}:function(){return Date.now()},raf=function(){if(_window){if(_window.requestAnimationFrame)return function(n){_window.requestAnimationFrame(n)};if(_window.mozRequestAnimationFrame)return function(n){_window.mozRequestAnimationFrame(n)};if(_window.webkitRequestAnimationFrame)return function(n){_window.webkitRequestAnimationFrame(n)};if(_window.msRequestAnimationFrame)return function(n){_window.msRequestAnimationFrame(n)}}return function(n){n&&setTimeout(function(){n(pnow())},1e3/60)}}(),requestAnimationFrame=function(t){return raf(t)},performanceNow=pnow,DEFAULT_HASH_SEED=9261,K=65599,DEFAULT_HASH_SEED_ALT=5381,hashIterableInts=function(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED,a=r,o;o=t.next(),!o.done;)a=a*K+o.value|0;return a},hashInt=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED;return r*K+t|0},hashIntAlt=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED_ALT;return(r<<5)+r+t|0},combineHashes=function(t,r){return t*2097152+r},combineHashesArray=function(t){return t[0]*2097152+t[1]},hashArrays=function(t,r){return[hashInt(t[0],r[0]),hashIntAlt(t[1],r[1])]},hashIntsArray=function(t,r){var a={value:0,done:!1},o=0,u=t.length,s={next:function(){return o<u?a.value=t[o++]:a.done=!0,a}};return hashIterableInts(s,r)},hashString=function(t,r){var a={value:0,done:!1},o=0,u=t.length,s={next:function(){return o<u?a.value=t.charCodeAt(o++):a.done=!0,a}};return hashIterableInts(s,r)},hashStrings=function(){return hashStringsArray(arguments)},hashStringsArray=function(t){for(var r,a=0;a<t.length;a++){var o=t[a];a===0?r=hashString(o):r=hashString(o,r)}return r},warningsEnabled=!0,warnSupported=console.warn!=null,traceSupported=console.trace!=null,MAX_INT$1=Number.MAX_SAFE_INTEGER||9007199254740991,trueify=function(){return!0},falsify=function(){return!1},zeroify=function(){return 0},noop$1=function(){},error=function(t){throw new Error(t)},warnings=function(t){if(t!==void 0)warningsEnabled=!!t;else return warningsEnabled},warn=function(t){warnings()&&(warnSupported?console.warn(t):(console.log(t),traceSupported&&console.trace()))},clone=function(t){return extend({},t)},copy=function(t){return t==null?t:array(t)?t.slice():plainObject(t)?clone(t):t},copyArray$1=function(t){return t.slice()},uuid=function(t,r){for(r=t="";t++<36;r+=t*51&52?(t^15?8^Math.random()*(t^20?16:4):4).toString(16):"-");return r},_staticEmptyObject={},staticEmptyObject=function(){return _staticEmptyObject},defaults$g=function(t){var r=Object.keys(t);return function(a){for(var o={},u=0;u<r.length;u++){var s=r[u],c=a==null?void 0:a[s];o[s]=c===void 0?t[s]:c}return o}},removeFromArray=function(t,r,a){for(var o=t.length-1;o>=0;o--)t[o]===r&&t.splice(o,1)},clearArray=function(t){t.splice(0,t.length)},push=function(t,r){for(var a=0;a<r.length;a++){var o=r[a];t.push(o)}},getPrefixedProperty=function(t,r,a){return a&&(r=prependCamel(a,r)),t[r]},setPrefixedProperty=function(t,r,a,o){a&&(r=prependCamel(a,r)),t[r]=o},ObjectMap=function(){function n(){_classCallCheck(this,n),this._obj={}}return _createClass(n,[{key:"set",value:function(r,a){return this._obj[r]=a,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}]),n}(),Map$2=typeof Map<"u"?Map:ObjectMap,undef="undefined",ObjectSet=function(){function n(t){if(_classCallCheck(this,n),this._obj=Object.create(null),this.size=0,t!=null){var r;t.instanceString!=null&&t.instanceString()===this.instanceString()?r=t.toArray():r=t;for(var a=0;a<r.length;a++)this.add(r[a])}}return _createClass(n,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var a=this._obj;a[r]!==1&&(a[r]=1,this.size++)}},{key:"delete",value:function(r){var a=this._obj;a[r]===1&&(a[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(a){return r.has(a)})}},{key:"forEach",value:function(r,a){return this.toArray().forEach(r,a)}}]),n}(),Set$1=(typeof Set>"u"?"undefined":_typeof(Set))!==undef?Set:ObjectSet,Element$1=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(t===void 0||r===void 0||!core(t)){error("An element must have a core reference and parameters set");return}var o=r.group;if(o==null&&(r.data&&r.data.source!=null&&r.data.target!=null?o="edges":o="nodes"),o!=="nodes"&&o!=="edges"){error("An element must be of type `nodes` or `edges`; you specified `"+o+"`");return}this.length=1,this[0]=this;var u=this._private={cy:t,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:o,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?o==="edges":!!r.pannable,active:!1,classes:new Set$1,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(u.position.x==null&&(u.position.x=0),u.position.y==null&&(u.position.y=0),r.renderedPosition){var s=r.renderedPosition,c=t.pan(),l=t.zoom();u.position={x:(s.x-c.x)/l,y:(s.y-c.y)/l}}var d=[];array(r.classes)?d=r.classes:string(r.classes)&&(d=r.classes.split(/\s+/));for(var f=0,h=d.length;f<h;f++){var v=d[f];!v||v===""||u.classes.add(v)}this.createEmitter();var g=r.style||r.css;g&&(warn("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(g)),(a===void 0||a)&&this.restore()},defineSearch=function(t){return t={bfs:t.bfs||!t.dfs,dfs:t.dfs||!t.bfs},function(a,o,u){var s;plainObject(a)&&!elementOrCollection(a)&&(s=a,a=s.roots||s.root,o=s.visit,u=s.directed),u=arguments.length===2&&!fn$6(o)?o:u,o=fn$6(o)?o:function(){};for(var c=this._private.cy,l=a=string(a)?this.filter(a):a,d=[],f=[],h={},v={},g={},b=0,_,S=this.byGroup(),T=S.nodes,w=S.edges,A=0;A<l.length;A++){var R=l[A],E=R.id();R.isNode()&&(d.unshift(R),t.bfs&&(g[E]=!0,f.push(R)),v[E]=0)}for(var I=function(){var C=t.bfs?d.shift():d.pop(),q=C.id();if(t.dfs){if(g[q])return"continue";g[q]=!0,f.push(C)}var M=v[q],N=h[q],G=N!=null?N.source():null,X=N!=null?N.target():null,Y=N==null?void 0:C.same(G)?X[0]:G[0],W=void 0;if(W=o(C,N,Y,b++,M),W===!0)return _=C,"break";if(W===!1)return"break";for(var te=C.connectedEdges().filter(function(Te){return(!u||Te.source().same(C))&&w.has(Te)}),ue=0;ue<te.length;ue++){var fe=te[ue],re=fe.connectedNodes().filter(function(Te){return!Te.same(C)&&T.has(Te)}),ye=re.id();re.length!==0&&!g[ye]&&(re=re[0],d.push(re),t.bfs&&(g[ye]=!0,f.push(re)),h[ye]=fe,v[ye]=v[q]+1)}};d.length!==0;){var L=I();if(L!=="continue"&&L==="break")break}for(var F=c.collection(),D=0;D<f.length;D++){var $=f[D],O=h[$.id()];O!=null&&F.push(O),F.push($)}return{path:c.collection(F),found:c.collection(_)}}},elesfn$v={breadthFirstSearch:defineSearch({bfs:!0}),depthFirstSearch:defineSearch({dfs:!0})};elesfn$v.bfs=elesfn$v.breadthFirstSearch;elesfn$v.dfs=elesfn$v.depthFirstSearch;var heap$1=createCommonjsModule(function(n,t){(function(){var r,a,o,u,s,c,l,d,f,h,v,g,b,_,S;o=Math.floor,h=Math.min,a=function(T,w){return T<w?-1:T>w?1:0},f=function(T,w,A,R,E){var I;if(A==null&&(A=0),E==null&&(E=a),A<0)throw new Error("lo must be non-negative");for(R==null&&(R=T.length);A<R;)I=o((A+R)/2),E(w,T[I])<0?R=I:A=I+1;return[].splice.apply(T,[A,A-A].concat(w)),w},c=function(T,w,A){return A==null&&(A=a),T.push(w),_(T,0,T.length-1,A)},s=function(T,w){var A,R;return w==null&&(w=a),A=T.pop(),T.length?(R=T[0],T[0]=A,S(T,0,w)):R=A,R},d=function(T,w,A){var R;return A==null&&(A=a),R=T[0],T[0]=w,S(T,0,A),R},l=function(T,w,A){var R;return A==null&&(A=a),T.length&&A(T[0],w)<0&&(R=[T[0],w],w=R[0],T[0]=R[1],S(T,0,A)),w},u=function(T,w){var A,R,E,I,L,F;for(w==null&&(w=a),I=(function(){F=[];for(var D=0,$=o(T.length/2);0<=$?D<$:D>$;0<=$?D++:D--)F.push(D);return F}).apply(this).reverse(),L=[],R=0,E=I.length;R<E;R++)A=I[R],L.push(S(T,A,w));return L},b=function(T,w,A){var R;if(A==null&&(A=a),R=T.indexOf(w),R!==-1)return _(T,0,R,A),S(T,R,A)},v=function(T,w,A){var R,E,I,L,F;if(A==null&&(A=a),E=T.slice(0,w),!E.length)return E;for(u(E,A),F=T.slice(w),I=0,L=F.length;I<L;I++)R=F[I],l(E,R,A);return E.sort(A).reverse()},g=function(T,w,A){var R,E,I,L,F,D,$,O,P;if(A==null&&(A=a),w*10<=T.length){if(I=T.slice(0,w).sort(A),!I.length)return I;for(E=I[I.length-1],$=T.slice(w),L=0,D=$.length;L<D;L++)R=$[L],A(R,E)<0&&(f(I,R,0,null,A),I.pop(),E=I[I.length-1]);return I}for(u(T,A),P=[],F=0,O=h(w,T.length);0<=O?F<O:F>O;0<=O?++F:--F)P.push(s(T,A));return P},_=function(T,w,A,R){var E,I,L;for(R==null&&(R=a),E=T[A];A>w;){if(L=A-1>>1,I=T[L],R(E,I)<0){T[A]=I,A=L;continue}break}return T[A]=E},S=function(T,w,A){var R,E,I,L,F;for(A==null&&(A=a),E=T.length,F=w,I=T[w],R=2*w+1;R<E;)L=R+1,L<E&&!(A(T[R],T[L])<0)&&(R=L),T[w]=T[R],w=R,R=2*w+1;return T[w]=I,_(T,F,w,A)},r=function(){T.push=c,T.pop=s,T.replace=d,T.pushpop=l,T.heapify=u,T.updateItem=b,T.nlargest=v,T.nsmallest=g;function T(w){this.cmp=w??a,this.nodes=[]}return T.prototype.push=function(w){return c(this.nodes,w,this.cmp)},T.prototype.pop=function(){return s(this.nodes,this.cmp)},T.prototype.peek=function(){return this.nodes[0]},T.prototype.contains=function(w){return this.nodes.indexOf(w)!==-1},T.prototype.replace=function(w){return d(this.nodes,w,this.cmp)},T.prototype.pushpop=function(w){return l(this.nodes,w,this.cmp)},T.prototype.heapify=function(){return u(this.nodes,this.cmp)},T.prototype.updateItem=function(w){return b(this.nodes,w,this.cmp)},T.prototype.clear=function(){return this.nodes=[]},T.prototype.empty=function(){return this.nodes.length===0},T.prototype.size=function(){return this.nodes.length},T.prototype.clone=function(){var w;return w=new T,w.nodes=this.nodes.slice(0),w},T.prototype.toArray=function(){return this.nodes.slice(0)},T.prototype.insert=T.prototype.push,T.prototype.top=T.prototype.peek,T.prototype.front=T.prototype.peek,T.prototype.has=T.prototype.contains,T.prototype.copy=T.prototype.clone,T}(),function(T,w){return n.exports=w()}(this,function(){return r})}).call(commonjsGlobal)}),heap=heap$1,dijkstraDefaults=defaults$g({root:null,weight:function(t){return 1},directed:!1}),elesfn$u={dijkstra:function(t){if(!plainObject(t)){var r=arguments;t={root:r[0],weight:r[1],directed:r[2]}}var a=dijkstraDefaults(t),o=a.root,u=a.weight,s=a.directed,c=this,l=u,d=string(o)?this.filter(o)[0]:o[0],f={},h={},v={},g=this.byGroup(),b=g.nodes,_=g.edges;_.unmergeBy(function(M){return M.isLoop()});for(var S=function(N){return f[N.id()]},T=function(N,G){f[N.id()]=G,w.updateItem(N)},w=new heap(function(M,N){return S(M)-S(N)}),A=0;A<b.length;A++){var R=b[A];f[R.id()]=R.same(d)?0:1/0,w.push(R)}for(var E=function(N,G){for(var X=(s?N.edgesTo(G):N.edgesWith(G)).intersect(_),Y=1/0,W,te=0;te<X.length;te++){var ue=X[te],fe=l(ue);(fe<Y||!W)&&(Y=fe,W=ue)}return{edge:W,dist:Y}};w.size()>0;){var I=w.pop(),L=S(I),F=I.id();if(v[F]=L,L!==1/0)for(var D=I.neighborhood().intersect(b),$=0;$<D.length;$++){var O=D[$],P=O.id(),C=E(I,O),q=L+C.dist;q<S(O)&&(T(O,q),h[P]={node:I,edge:C.edge})}}return{distanceTo:function(N){var G=string(N)?b.filter(N)[0]:N[0];return v[G.id()]},pathTo:function(N){var G=string(N)?b.filter(N)[0]:N[0],X=[],Y=G,W=Y.id();if(G.length>0)for(X.unshift(G);h[W];){var te=h[W];X.unshift(te.edge),X.unshift(te.node),Y=te.node,W=Y.id()}return c.spawn(X)}}}},elesfn$t={kruskal:function(t){t=t||function(A){return 1};for(var r=this.byGroup(),a=r.nodes,o=r.edges,u=a.length,s=new Array(u),c=a,l=function(R){for(var E=0;E<s.length;E++){var I=s[E];if(I.has(R))return E}},d=0;d<u;d++)s[d]=this.spawn(a[d]);for(var f=o.sort(function(A,R){return t(A)-t(R)}),h=0;h<f.length;h++){var v=f[h],g=v.source()[0],b=v.target()[0],_=l(g),S=l(b),T=s[_],w=s[S];_!==S&&(c.merge(v),T.merge(w),s.splice(S,1))}return c}},aStarDefaults=defaults$g({root:null,goal:null,weight:function(t){return 1},heuristic:function(t){return 0},directed:!1}),elesfn$s={aStar:function(t){var r=this.cy(),a=aStarDefaults(t),o=a.root,u=a.goal,s=a.heuristic,c=a.directed,l=a.weight;o=r.collection(o)[0],u=r.collection(u)[0];var d=o.id(),f=u.id(),h={},v={},g={},b=new heap(function(W,te){return v[W.id()]-v[te.id()]}),_=new Set$1,S={},T={},w=function(te,ue){b.push(te),_.add(ue)},A,R,E=function(){A=b.pop(),R=A.id(),_.delete(R)},I=function(te){return _.has(te)};w(o,d),h[d]=0,v[d]=s(o);for(var L=0;b.size()>0;){if(E(),L++,R===f){for(var F=[],D=u,$=f,O=T[$];F.unshift(D),O!=null&&F.unshift(O),D=S[$],D!=null;)$=D.id(),O=T[$];return{found:!0,distance:h[R],path:this.spawn(F),steps:L}}g[R]=!0;for(var P=A._private.edges,C=0;C<P.length;C++){var q=P[C];if(this.hasElementWithId(q.id())&&!(c&&q.data("source")!==R)){var M=q.source(),N=q.target(),G=M.id()!==R?M:N,X=G.id();if(this.hasElementWithId(X)&&!g[X]){var Y=h[R]+l(q);if(!I(X)){h[X]=Y,v[X]=Y+s(G),w(G,X),S[X]=A,T[X]=q;continue}Y<h[X]&&(h[X]=Y,v[X]=Y+s(G),S[X]=A,T[X]=q)}}}}return{found:!1,distance:void 0,path:void 0,steps:L}}},floydWarshallDefaults=defaults$g({weight:function(t){return 1},directed:!1}),elesfn$r={floydWarshall:function(t){for(var r=this.cy(),a=floydWarshallDefaults(t),o=a.weight,u=a.directed,s=o,c=this.byGroup(),l=c.nodes,d=c.edges,f=l.length,h=f*f,v=function(fe){return l.indexOf(fe)},g=function(fe){return l[fe]},b=new Array(h),_=0;_<h;_++){var S=_%f,T=(_-S)/f;T===S?b[_]=0:b[_]=1/0}for(var w=new Array(h),A=new Array(h),R=0;R<d.length;R++){var E=d[R],I=E.source()[0],L=E.target()[0];if(I!==L){var F=v(I),D=v(L),$=F*f+D,O=s(E);if(b[$]>O&&(b[$]=O,w[$]=D,A[$]=E),!u){var P=D*f+F;!u&&b[P]>O&&(b[P]=O,w[P]=F,A[P]=E)}}}for(var C=0;C<f;C++)for(var q=0;q<f;q++)for(var M=q*f+C,N=0;N<f;N++){var G=q*f+N,X=C*f+N;b[M]+b[X]<b[G]&&(b[G]=b[M]+b[X],w[G]=w[M])}var Y=function(fe){return(string(fe)?r.filter(fe):fe)[0]},W=function(fe){return v(Y(fe))},te={distance:function(fe,re){var ye=W(fe),Te=W(re);return b[ye*f+Te]},path:function(fe,re){var ye=W(fe),Te=W(re),Re=g(ye);if(ye===Te)return Re.collection();if(w[ye*f+Te]==null)return r.collection();var ve=r.collection(),ce=ye,J;for(ve.merge(Re);ye!==Te;)ce=ye,ye=w[ye*f+Te],J=A[ce*f+ye],ve.merge(J),ve.merge(g(ye));return ve}};return te}},bellmanFordDefaults=defaults$g({weight:function(t){return 1},directed:!1,root:null}),elesfn$q={bellmanFord:function(t){var r=this,a=bellmanFordDefaults(t),o=a.weight,u=a.directed,s=a.root,c=o,l=this,d=this.cy(),f=this.byGroup(),h=f.edges,v=f.nodes,g=v.length,b=new Map$2,_=!1,S=[];s=d.collection(s)[0],h.unmergeBy(function(ie){return ie.isLoop()});for(var T=h.length,w=function(se){var ne=b.get(se.id());return ne||(ne={},b.set(se.id(),ne)),ne},A=function(se){return(string(se)?d.$(se):se)[0]},R=function(se){return w(A(se)).dist},E=function(se){for(var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,he=A(se),xe=[],me=he;;){if(me==null)return r.spawn();var Ie=w(me),Pe=Ie.edge,Ce=Ie.pred;if(xe.unshift(me[0]),me.same(ne)&&xe.length>0)break;Pe!=null&&xe.unshift(Pe),me=Ce}return l.spawn(xe)},I=0;I<g;I++){var L=v[I],F=w(L);L.same(s)?F.dist=0:F.dist=1/0,F.pred=null,F.edge=null}for(var D=!1,$=function(se,ne,he,xe,me,Ie){var Pe=xe.dist+Ie;Pe<me.dist&&!he.same(xe.edge)&&(me.dist=Pe,me.pred=se,me.edge=he,D=!0)},O=1;O<g;O++){D=!1;for(var P=0;P<T;P++){var C=h[P],q=C.source(),M=C.target(),N=c(C),G=w(q),X=w(M);$(q,M,C,G,X,N),u||$(M,q,C,X,G,N)}if(!D)break}if(D)for(var Y=[],W=0;W<T;W++){var te=h[W],ue=te.source(),fe=te.target(),re=c(te),ye=w(ue).dist,Te=w(fe).dist;if(ye+re<Te||!u&&Te+re<ye)if(_||(warn("Graph contains a negative weight cycle for Bellman-Ford"),_=!0),t.findNegativeWeightCycles!==!1){var Re=[];ye+re<Te&&Re.push(ue),!u&&Te+re<ye&&Re.push(fe);for(var ve=Re.length,ce=0;ce<ve;ce++){var J=Re[ce],j=[J];j.push(w(J).edge);for(var z=w(J).pred;j.indexOf(z)===-1;)j.push(z),j.push(w(z).edge),z=w(z).pred;j=j.slice(j.indexOf(z));for(var B=j[0].id(),U=0,Z=2;Z<j.length;Z+=2)j[Z].id()<B&&(B=j[Z].id(),U=Z);j=j.slice(U).concat(j.slice(0,U)),j.push(j[0]);var oe=j.map(function(ie){return ie.id()}).join(",");Y.indexOf(oe)===-1&&(S.push(l.spawn(j)),Y.push(oe))}}else break}return{distanceTo:R,pathTo:E,hasNegativeWeightCycle:_,negativeWeightCycles:S}}},sqrt2=Math.sqrt(2),collapse=function(t,r,a){a.length===0&&error("Karger-Stein must be run on a connected (sub)graph");for(var o=a[t],u=o[1],s=o[2],c=r[u],l=r[s],d=a,f=d.length-1;f>=0;f--){var h=d[f],v=h[1],g=h[2];(r[v]===c&&r[g]===l||r[v]===l&&r[g]===c)&&d.splice(f,1)}for(var b=0;b<d.length;b++){var _=d[b];_[1]===l?(d[b]=_.slice(),d[b][1]=c):_[2]===l&&(d[b]=_.slice(),d[b][2]=c)}for(var S=0;S<r.length;S++)r[S]===l&&(r[S]=c);return d},contractUntil=function(t,r,a,o){for(;a>o;){var u=Math.floor(Math.random()*r.length);r=collapse(u,t,r),a--}return r},elesfn$p={kargerStein:function(){var t=this,r=this.byGroup(),a=r.nodes,o=r.edges;o.unmergeBy(function(X){return X.isLoop()});var u=a.length,s=o.length,c=Math.ceil(Math.pow(Math.log(u)/Math.LN2,2)),l=Math.floor(u/sqrt2);if(u<2){error("At least 2 nodes are required for Karger-Stein algorithm");return}for(var d=[],f=0;f<s;f++){var h=o[f];d.push([f,a.indexOf(h.source()),a.indexOf(h.target())])}for(var v=1/0,g=[],b=new Array(u),_=new Array(u),S=new Array(u),T=function(Y,W){for(var te=0;te<u;te++)W[te]=Y[te]},w=0;w<=c;w++){for(var A=0;A<u;A++)_[A]=A;var R=contractUntil(_,d.slice(),u,l),E=R.slice();T(_,S);var I=contractUntil(_,R,l,2),L=contractUntil(S,E,l,2);I.length<=L.length&&I.length<v?(v=I.length,g=I,T(_,b)):L.length<=I.length&&L.length<v&&(v=L.length,g=L,T(S,b))}for(var F=this.spawn(g.map(function(X){return o[X[0]]})),D=this.spawn(),$=this.spawn(),O=b[0],P=0;P<b.length;P++){var C=b[P],q=a[P];C===O?D.merge(q):$.merge(q)}var M=function(Y){var W=t.spawn();return Y.forEach(function(te){W.merge(te),te.connectedEdges().forEach(function(ue){t.contains(ue)&&!F.contains(ue)&&W.merge(ue)})}),W},N=[M(D),M($)],G={cut:F,components:N,partition1:D,partition2:$};return G}},copyPosition=function(t){return{x:t.x,y:t.y}},modelToRenderedPosition$1=function(t,r,a){return{x:t.x*r+a.x,y:t.y*r+a.y}},renderedToModelPosition=function(t,r,a){return{x:(t.x-a.x)/r,y:(t.y-a.y)/r}},array2point=function(t){return{x:t[0],y:t[1]}},min=function(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,o=1/0,u=r;u<a;u++){var s=t[u];isFinite(s)&&(o=Math.min(s,o))}return o},max=function(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,o=-1/0,u=r;u<a;u++){var s=t[u];isFinite(s)&&(o=Math.max(s,o))}return o},mean=function(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,o=0,u=0,s=r;s<a;s++){var c=t[s];isFinite(c)&&(o+=c,u++)}return o/u},median=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;o?t=t.slice(r,a):(a<t.length&&t.splice(a,t.length-a),r>0&&t.splice(0,r));for(var c=0,l=t.length-1;l>=0;l--){var d=t[l];s?isFinite(d)||(t[l]=-1/0,c++):t.splice(l,1)}u&&t.sort(function(v,g){return v-g});var f=t.length,h=Math.floor(f/2);return f%2!==0?t[h+1+c]:(t[h-1+c]+t[h+c])/2},deg2rad=function(t){return Math.PI*t/180},getAngleFromDisp=function(t,r){return Math.atan2(r,t)-Math.PI/2},log2=Math.log2||function(n){return Math.log(n)/Math.log(2)},signum=function(t){return t>0?1:t<0?-1:0},dist$1=function(t,r){return Math.sqrt(sqdist(t,r))},sqdist=function(t,r){var a=r.x-t.x,o=r.y-t.y;return a*a+o*o},inPlaceSumNormalize=function(t){for(var r=t.length,a=0,o=0;o<r;o++)a+=t[o];for(var u=0;u<r;u++)t[u]=t[u]/a;return t},qbezierAt=function(t,r,a,o){return(1-o)*(1-o)*t+2*(1-o)*o*r+o*o*a},qbezierPtAt=function(t,r,a,o){return{x:qbezierAt(t.x,r.x,a.x,o),y:qbezierAt(t.y,r.y,a.y,o)}},lineAt=function(t,r,a,o){var u={x:r.x-t.x,y:r.y-t.y},s=dist$1(t,r),c={x:u.x/s,y:u.y/s};return a=a??0,o=o??a*s,{x:t.x+c.x*o,y:t.y+c.y*o}},bound=function(t,r,a){return Math.max(t,Math.min(a,r))},makeBoundingBox=function(t){if(t==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(t.x1!=null&&t.y1!=null){if(t.x2!=null&&t.y2!=null&&t.x2>=t.x1&&t.y2>=t.y1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1};if(t.w!=null&&t.h!=null&&t.w>=0&&t.h>=0)return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}},copyBoundingBox=function(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}},clearBoundingBox=function(t){t.x1=1/0,t.y1=1/0,t.x2=-1/0,t.y2=-1/0,t.w=0,t.h=0},shiftBoundingBox=function(t,r,a){return{x1:t.x1+r,x2:t.x2+r,y1:t.y1+a,y2:t.y2+a,w:t.w,h:t.h}},updateBoundingBox=function(t,r){t.x1=Math.min(t.x1,r.x1),t.x2=Math.max(t.x2,r.x2),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,r.y1),t.y2=Math.max(t.y2,r.y2),t.h=t.y2-t.y1},expandBoundingBoxByPoint=function(t,r,a){t.x1=Math.min(t.x1,r),t.x2=Math.max(t.x2,r),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,a),t.y2=Math.max(t.y2,a),t.h=t.y2-t.y1},expandBoundingBox=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.x1-=r,t.x2+=r,t.y1-=r,t.y2+=r,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},expandBoundingBoxSides=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],a,o,u,s;if(r.length===1)a=o=u=s=r[0];else if(r.length===2)a=u=r[0],s=o=r[1];else if(r.length===4){var c=_slicedToArray(r,4);a=c[0],o=c[1],u=c[2],s=c[3]}return t.x1-=s,t.x2+=o,t.y1-=a,t.y2+=u,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},assignBoundingBox=function(t,r){t.x1=r.x1,t.y1=r.y1,t.x2=r.x2,t.y2=r.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1},boundingBoxesIntersect=function(t,r){return!(t.x1>r.x2||r.x1>t.x2||t.x2<r.x1||r.x2<t.x1||t.y2<r.y1||r.y2<t.y1||t.y1>r.y2||r.y1>t.y2)},inBoundingBox=function(t,r,a){return t.x1<=r&&r<=t.x2&&t.y1<=a&&a<=t.y2},pointInBoundingBox=function(t,r){return inBoundingBox(t,r.x,r.y)},boundingBoxInBoundingBox=function(t,r){return inBoundingBox(t,r.x1,r.y1)&&inBoundingBox(t,r.x2,r.y2)},roundRectangleIntersectLine=function(t,r,a,o,u,s,c){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",d=l==="auto"?getRoundRectangleRadius(u,s):l,f=u/2,h=s/2;d=Math.min(d,f,h);var v=d!==f,g=d!==h,b;if(v){var _=a-f+d-c,S=o-h-c,T=a+f-d+c,w=S;if(b=finiteLinesIntersect(t,r,a,o,_,S,T,w,!1),b.length>0)return b}if(g){var A=a+f+c,R=o-h+d-c,E=A,I=o+h-d+c;if(b=finiteLinesIntersect(t,r,a,o,A,R,E,I,!1),b.length>0)return b}if(v){var L=a-f+d-c,F=o+h+c,D=a+f-d+c,$=F;if(b=finiteLinesIntersect(t,r,a,o,L,F,D,$,!1),b.length>0)return b}if(g){var O=a-f-c,P=o-h+d-c,C=O,q=o+h-d+c;if(b=finiteLinesIntersect(t,r,a,o,O,P,C,q,!1),b.length>0)return b}var M;{var N=a-f+d,G=o-h+d;if(M=intersectLineCircle(t,r,a,o,N,G,d+c),M.length>0&&M[0]<=N&&M[1]<=G)return[M[0],M[1]]}{var X=a+f-d,Y=o-h+d;if(M=intersectLineCircle(t,r,a,o,X,Y,d+c),M.length>0&&M[0]>=X&&M[1]<=Y)return[M[0],M[1]]}{var W=a+f-d,te=o+h-d;if(M=intersectLineCircle(t,r,a,o,W,te,d+c),M.length>0&&M[0]>=W&&M[1]>=te)return[M[0],M[1]]}{var ue=a-f+d,fe=o+h-d;if(M=intersectLineCircle(t,r,a,o,ue,fe,d+c),M.length>0&&M[0]<=ue&&M[1]>=fe)return[M[0],M[1]]}return[]},inLineVicinity=function(t,r,a,o,u,s,c){var l=c,d=Math.min(a,u),f=Math.max(a,u),h=Math.min(o,s),v=Math.max(o,s);return d-l<=t&&t<=f+l&&h-l<=r&&r<=v+l},inBezierVicinity=function(t,r,a,o,u,s,c,l,d){var f={x1:Math.min(a,c,u)-d,x2:Math.max(a,c,u)+d,y1:Math.min(o,l,s)-d,y2:Math.max(o,l,s)+d};return!(t<f.x1||t>f.x2||r<f.y1||r>f.y2)},solveQuadratic=function(t,r,a,o){a-=o;var u=r*r-4*t*a;if(u<0)return[];var s=Math.sqrt(u),c=2*t,l=(-r+s)/c,d=(-r-s)/c;return[l,d]},solveCubic=function(t,r,a,o,u){var s=1e-5;t===0&&(t=s),r/=t,a/=t,o/=t;var c,l,d,f,h,v,g,b;if(l=(3*a-r*r)/9,d=-(27*o)+r*(9*a-2*(r*r)),d/=54,c=l*l*l+d*d,u[1]=0,g=r/3,c>0){h=d+Math.sqrt(c),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),v=d-Math.sqrt(c),v=v<0?-Math.pow(-v,1/3):Math.pow(v,1/3),u[0]=-g+h+v,g+=(h+v)/2,u[4]=u[2]=-g,g=Math.sqrt(3)*(-v+h)/2,u[3]=g,u[5]=-g;return}if(u[5]=u[3]=0,c===0){b=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),u[0]=-g+2*b,u[4]=u[2]=-(b+g);return}l=-l,f=l*l*l,f=Math.acos(d/Math.sqrt(f)),b=2*Math.sqrt(l),u[0]=-g+b*Math.cos(f/3),u[2]=-g+b*Math.cos((f+2*Math.PI)/3),u[4]=-g+b*Math.cos((f+4*Math.PI)/3)},sqdistToQuadraticBezier=function(t,r,a,o,u,s,c,l){var d=1*a*a-4*a*u+2*a*c+4*u*u-4*u*c+c*c+o*o-4*o*s+2*o*l+4*s*s-4*s*l+l*l,f=1*9*a*u-3*a*a-3*a*c-6*u*u+3*u*c+9*o*s-3*o*o-3*o*l-6*s*s+3*s*l,h=1*3*a*a-6*a*u+a*c-a*t+2*u*u+2*u*t-c*t+3*o*o-6*o*s+o*l-o*r+2*s*s+2*s*r-l*r,v=1*a*u-a*a+a*t-u*t+o*s-o*o+o*r-s*r,g=[];solveCubic(d,f,h,v,g);for(var b=1e-7,_=[],S=0;S<6;S+=2)Math.abs(g[S+1])<b&&g[S]>=0&&g[S]<=1&&_.push(g[S]);_.push(1),_.push(0);for(var T=-1,w,A,R,E=0;E<_.length;E++)w=Math.pow(1-_[E],2)*a+2*(1-_[E])*_[E]*u+_[E]*_[E]*c,A=Math.pow(1-_[E],2)*o+2*(1-_[E])*_[E]*s+_[E]*_[E]*l,R=Math.pow(w-t,2)+Math.pow(A-r,2),T>=0?R<T&&(T=R):T=R;return T},sqdistToFiniteLine=function(t,r,a,o,u,s){var c=[t-a,r-o],l=[u-a,s-o],d=l[0]*l[0]+l[1]*l[1],f=c[0]*c[0]+c[1]*c[1],h=c[0]*l[0]+c[1]*l[1],v=h*h/d;return h<0?f:v>d?(t-u)*(t-u)+(r-s)*(r-s):f-v},pointInsidePolygonPoints=function(t,r,a){for(var o,u,s,c,l,d=0,f=0;f<a.length/2;f++)if(o=a[f*2],u=a[f*2+1],f+1<a.length/2?(s=a[(f+1)*2],c=a[(f+1)*2+1]):(s=a[(f+1-a.length/2)*2],c=a[(f+1-a.length/2)*2+1]),!(o==t&&s==t))if(o>=t&&t>=s||o<=t&&t<=s)l=(t-o)/(s-o)*(c-u)+u,l>r&&d++;else continue;return d%2!==0},pointInsidePolygon=function(t,r,a,o,u,s,c,l,d){var f=new Array(a.length),h;l[0]!=null?(h=Math.atan(l[1]/l[0]),l[0]<0?h=h+Math.PI/2:h=-h-Math.PI/2):h=l;for(var v=Math.cos(-h),g=Math.sin(-h),b=0;b<f.length/2;b++)f[b*2]=s/2*(a[b*2]*v-a[b*2+1]*g),f[b*2+1]=c/2*(a[b*2+1]*v+a[b*2]*g),f[b*2]+=o,f[b*2+1]+=u;var _;if(d>0){var S=expandPolygon(f,-d);_=joinLines(S)}else _=f;return pointInsidePolygonPoints(t,r,_)},pointInsideRoundPolygon=function(t,r,a,o,u,s,c,l){for(var d=new Array(a.length*2),f=0;f<l.length;f++){var h=l[f];d[f*4+0]=h.startX,d[f*4+1]=h.startY,d[f*4+2]=h.stopX,d[f*4+3]=h.stopY;var v=Math.pow(h.cx-t,2)+Math.pow(h.cy-r,2);if(v<=Math.pow(h.radius,2))return!0}return pointInsidePolygonPoints(t,r,d)},joinLines=function(t){for(var r=new Array(t.length/2),a,o,u,s,c,l,d,f,h=0;h<t.length/4;h++){a=t[h*4],o=t[h*4+1],u=t[h*4+2],s=t[h*4+3],h<t.length/4-1?(c=t[(h+1)*4],l=t[(h+1)*4+1],d=t[(h+1)*4+2],f=t[(h+1)*4+3]):(c=t[0],l=t[1],d=t[2],f=t[3]);var v=finiteLinesIntersect(a,o,u,s,c,l,d,f,!0);r[h*2]=v[0],r[h*2+1]=v[1]}return r},expandPolygon=function(t,r){for(var a=new Array(t.length*2),o,u,s,c,l=0;l<t.length/2;l++){o=t[l*2],u=t[l*2+1],l<t.length/2-1?(s=t[(l+1)*2],c=t[(l+1)*2+1]):(s=t[0],c=t[1]);var d=c-u,f=-(s-o),h=Math.sqrt(d*d+f*f),v=d/h,g=f/h;a[l*4]=o+v*r,a[l*4+1]=u+g*r,a[l*4+2]=s+v*r,a[l*4+3]=c+g*r}return a},intersectLineEllipse=function(t,r,a,o,u,s){var c=a-t,l=o-r;c/=u,l/=s;var d=Math.sqrt(c*c+l*l),f=d-1;if(f<0)return[];var h=f/d;return[(a-t)*h+t,(o-r)*h+r]},checkInEllipse=function(t,r,a,o,u,s,c){return t-=u,r-=s,t/=a/2+c,r/=o/2+c,t*t+r*r<=1},intersectLineCircle=function(t,r,a,o,u,s,c){var l=[a-t,o-r],d=[t-u,r-s],f=l[0]*l[0]+l[1]*l[1],h=2*(d[0]*l[0]+d[1]*l[1]),v=d[0]*d[0]+d[1]*d[1]-c*c,g=h*h-4*f*v;if(g<0)return[];var b=(-h+Math.sqrt(g))/(2*f),_=(-h-Math.sqrt(g))/(2*f),S=Math.min(b,_),T=Math.max(b,_),w=[];if(S>=0&&S<=1&&w.push(S),T>=0&&T<=1&&w.push(T),w.length===0)return[];var A=w[0]*l[0]+t,R=w[0]*l[1]+r;if(w.length>1){if(w[0]==w[1])return[A,R];var E=w[1]*l[0]+t,I=w[1]*l[1]+r;return[A,R,E,I]}else return[A,R]},midOfThree=function(t,r,a){return r<=t&&t<=a||a<=t&&t<=r?t:t<=r&&r<=a||a<=r&&r<=t?r:a},finiteLinesIntersect=function(t,r,a,o,u,s,c,l,d){var f=t-u,h=a-t,v=c-u,g=r-s,b=o-r,_=l-s,S=v*g-_*f,T=h*g-b*f,w=_*h-v*b;if(w!==0){var A=S/w,R=T/w,E=.001,I=0-E,L=1+E;return I<=A&&A<=L&&I<=R&&R<=L?[t+A*h,r+A*b]:d?[t+A*h,r+A*b]:[]}else return S===0||T===0?midOfThree(t,a,c)===c?[c,l]:midOfThree(t,a,u)===u?[u,s]:midOfThree(u,c,a)===a?[a,o]:[]:[]},polygonIntersectLine=function(t,r,a,o,u,s,c,l){var d=[],f,h=new Array(a.length),v=!0;s==null&&(v=!1);var g;if(v){for(var b=0;b<h.length/2;b++)h[b*2]=a[b*2]*s+o,h[b*2+1]=a[b*2+1]*c+u;if(l>0){var _=expandPolygon(h,-l);g=joinLines(_)}else g=h}else g=a;for(var S,T,w,A,R=0;R<g.length/2;R++)S=g[R*2],T=g[R*2+1],R<g.length/2-1?(w=g[(R+1)*2],A=g[(R+1)*2+1]):(w=g[0],A=g[1]),f=finiteLinesIntersect(t,r,o,u,S,T,w,A),f.length!==0&&d.push(f[0],f[1]);return d},roundPolygonIntersectLine=function(t,r,a,o,u,s,c,l,d){var f=[],h,v=new Array(a.length*2);d.forEach(function(w,A){A===0?(v[v.length-2]=w.startX,v[v.length-1]=w.startY):(v[A*4-2]=w.startX,v[A*4-1]=w.startY),v[A*4]=w.stopX,v[A*4+1]=w.stopY,h=intersectLineCircle(t,r,o,u,w.cx,w.cy,w.radius),h.length!==0&&f.push(h[0],h[1])});for(var g=0;g<v.length/4;g++)h=finiteLinesIntersect(t,r,o,u,v[g*4],v[g*4+1],v[g*4+2],v[g*4+3],!1),h.length!==0&&f.push(h[0],h[1]);if(f.length>2){for(var b=[f[0],f[1]],_=Math.pow(b[0]-t,2)+Math.pow(b[1]-r,2),S=1;S<f.length/2;S++){var T=Math.pow(f[S*2]-t,2)+Math.pow(f[S*2+1]-r,2);T<=_&&(b[0]=f[S*2],b[1]=f[S*2+1],_=T)}return b}return f},shortenIntersection=function(t,r,a){var o=[t[0]-r[0],t[1]-r[1]],u=Math.sqrt(o[0]*o[0]+o[1]*o[1]),s=(u-a)/u;return s<0&&(s=1e-5),[r[0]+s*o[0],r[1]+s*o[1]]},generateUnitNgonPointsFitToSquare=function(t,r){var a=generateUnitNgonPoints(t,r);return a=fitPolygonToSquare(a),a},fitPolygonToSquare=function(t){for(var r,a,o=t.length/2,u=1/0,s=1/0,c=-1/0,l=-1/0,d=0;d<o;d++)r=t[2*d],a=t[2*d+1],u=Math.min(u,r),c=Math.max(c,r),s=Math.min(s,a),l=Math.max(l,a);for(var f=2/(c-u),h=2/(l-s),v=0;v<o;v++)r=t[2*v]=t[2*v]*f,a=t[2*v+1]=t[2*v+1]*h,u=Math.min(u,r),c=Math.max(c,r),s=Math.min(s,a),l=Math.max(l,a);if(s<-1)for(var g=0;g<o;g++)a=t[2*g+1]=t[2*g+1]+(-1-s);return t},generateUnitNgonPoints=function(t,r){var a=1/t*2*Math.PI,o=t%2===0?Math.PI/2+a/2:Math.PI/2;o+=r;for(var u=new Array(t*2),s,c=0;c<t;c++)s=c*a+o,u[2*c]=Math.cos(s),u[2*c+1]=Math.sin(-s);return u},getRoundRectangleRadius=function(t,r){return Math.min(t/4,r/4,8)},getRoundPolygonRadius=function(t,r){return Math.min(t/10,r/10,8)},getCutRectangleCornerLength=function(){return 8},bezierPtsToQuadCoeff=function(t,r,a){return[t-2*r+a,2*(r-t),t]},getBarrelCurveConstants=function(t,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}},pageRankDefaults=defaults$g({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(t){return 1}}),elesfn$o={pageRank:function(t){for(var r=pageRankDefaults(t),a=r.dampingFactor,o=r.precision,u=r.iterations,s=r.weight,c=this._private.cy,l=this.byGroup(),d=l.nodes,f=l.edges,h=d.length,v=h*h,g=f.length,b=new Array(v),_=new Array(h),S=(1-a)/h,T=0;T<h;T++){for(var w=0;w<h;w++){var A=T*h+w;b[A]=0}_[T]=0}for(var R=0;R<g;R++){var E=f[R],I=E.data("source"),L=E.data("target");if(I!==L){var F=d.indexOfId(I),D=d.indexOfId(L),$=s(E),O=D*h+F;b[O]+=$,_[F]+=$}}for(var P=1/h+S,C=0;C<h;C++)if(_[C]===0)for(var q=0;q<h;q++){var M=q*h+C;b[M]=P}else for(var N=0;N<h;N++){var G=N*h+C;b[G]=b[G]/_[C]+S}for(var X=new Array(h),Y=new Array(h),W,te=0;te<h;te++)X[te]=1;for(var ue=0;ue<u;ue++){for(var fe=0;fe<h;fe++)Y[fe]=0;for(var re=0;re<h;re++)for(var ye=0;ye<h;ye++){var Te=re*h+ye;Y[re]+=b[Te]*X[ye]}inPlaceSumNormalize(Y),W=X,X=Y,Y=W;for(var Re=0,ve=0;ve<h;ve++){var ce=W[ve]-X[ve];Re+=ce*ce}if(Re<o)break}var J={rank:function(z){return z=c.collection(z)[0],X[d.indexOf(z)]}};return J}},defaults$f=defaults$g({root:null,weight:function(t){return 1},directed:!1,alpha:0}),elesfn$n={degreeCentralityNormalized:function(t){t=defaults$f(t);var r=this.cy(),a=this.nodes(),o=a.length;if(t.directed){for(var f={},h={},v=0,g=0,b=0;b<o;b++){var _=a[b],S=_.id();t.root=_;var T=this.degreeCentrality(t);v<T.indegree&&(v=T.indegree),g<T.outdegree&&(g=T.outdegree),f[S]=T.indegree,h[S]=T.outdegree}return{indegree:function(A){return v==0?0:(string(A)&&(A=r.filter(A)),f[A.id()]/v)},outdegree:function(A){return g===0?0:(string(A)&&(A=r.filter(A)),h[A.id()]/g)}}}else{for(var u={},s=0,c=0;c<o;c++){var l=a[c];t.root=l;var d=this.degreeCentrality(t);s<d.degree&&(s=d.degree),u[l.id()]=d.degree}return{degree:function(A){return s===0?0:(string(A)&&(A=r.filter(A)),u[A.id()]/s)}}}},degreeCentrality:function(t){t=defaults$f(t);var r=this.cy(),a=this,o=t,u=o.root,s=o.weight,c=o.directed,l=o.alpha;if(u=r.collection(u)[0],c){for(var g=u.connectedEdges(),b=g.filter(function(I){return I.target().same(u)&&a.has(I)}),_=g.filter(function(I){return I.source().same(u)&&a.has(I)}),S=b.length,T=_.length,w=0,A=0,R=0;R<b.length;R++)w+=s(b[R]);for(var E=0;E<_.length;E++)A+=s(_[E]);return{indegree:Math.pow(S,1-l)*Math.pow(w,l),outdegree:Math.pow(T,1-l)*Math.pow(A,l)}}else{for(var d=u.connectedEdges().intersection(a),f=d.length,h=0,v=0;v<d.length;v++)h+=s(d[v]);return{degree:Math.pow(f,1-l)*Math.pow(h,l)}}}};elesfn$n.dc=elesfn$n.degreeCentrality;elesfn$n.dcn=elesfn$n.degreeCentralityNormalised=elesfn$n.degreeCentralityNormalized;var defaults$e=defaults$g({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),elesfn$m={closenessCentralityNormalized:function(t){for(var r=defaults$e(t),a=r.harmonic,o=r.weight,u=r.directed,s=this.cy(),c={},l=0,d=this.nodes(),f=this.floydWarshall({weight:o,directed:u}),h=0;h<d.length;h++){for(var v=0,g=d[h],b=0;b<d.length;b++)if(h!==b){var _=f.distance(g,d[b]);a?v+=1/_:v+=_}a||(v=1/v),l<v&&(l=v),c[g.id()]=v}return{closeness:function(T){return l==0?0:(string(T)?T=s.filter(T)[0].id():T=T.id(),c[T]/l)}}},closenessCentrality:function(t){var r=defaults$e(t),a=r.root,o=r.weight,u=r.directed,s=r.harmonic;a=this.filter(a)[0];for(var c=this.dijkstra({root:a,weight:o,directed:u}),l=0,d=this.nodes(),f=0;f<d.length;f++){var h=d[f];if(!h.same(a)){var v=c.distanceTo(h);s?l+=1/v:l+=v}}return s?l:1/l}};elesfn$m.cc=elesfn$m.closenessCentrality;elesfn$m.ccn=elesfn$m.closenessCentralityNormalised=elesfn$m.closenessCentralityNormalized;var defaults$d=defaults$g({weight:null,directed:!1}),elesfn$l={betweennessCentrality:function(t){for(var r=defaults$d(t),a=r.directed,o=r.weight,u=o!=null,s=this.cy(),c=this.nodes(),l={},d={},f=0,h={set:function(A,R){d[A]=R,R>f&&(f=R)},get:function(A){return d[A]}},v=0;v<c.length;v++){var g=c[v],b=g.id();a?l[b]=g.outgoers().nodes():l[b]=g.openNeighborhood().nodes(),h.set(b,0)}for(var _=function(A){for(var R=c[A].id(),E=[],I={},L={},F={},D=new heap(function(ye,Te){return F[ye]-F[Te]}),$=0;$<c.length;$++){var O=c[$].id();I[O]=[],L[O]=0,F[O]=1/0}for(L[R]=1,F[R]=0,D.push(R);!D.empty();){var P=D.pop();if(E.push(P),u)for(var C=0;C<l[P].length;C++){var q=l[P][C],M=s.getElementById(P),N=void 0;M.edgesTo(q).length>0?N=M.edgesTo(q)[0]:N=q.edgesTo(M)[0];var G=o(N);q=q.id(),F[q]>F[P]+G&&(F[q]=F[P]+G,D.nodes.indexOf(q)<0?D.push(q):D.updateItem(q),L[q]=0,I[q]=[]),F[q]==F[P]+G&&(L[q]=L[q]+L[P],I[q].push(P))}else for(var X=0;X<l[P].length;X++){var Y=l[P][X].id();F[Y]==1/0&&(D.push(Y),F[Y]=F[P]+1),F[Y]==F[P]+1&&(L[Y]=L[Y]+L[P],I[Y].push(P))}}for(var W={},te=0;te<c.length;te++)W[c[te].id()]=0;for(;E.length>0;){for(var ue=E.pop(),fe=0;fe<I[ue].length;fe++){var re=I[ue][fe];W[re]=W[re]+L[re]/L[ue]*(1+W[ue])}ue!=c[A].id()&&h.set(ue,h.get(ue)+W[ue])}},S=0;S<c.length;S++)_(S);var T={betweenness:function(A){var R=s.collection(A).id();return h.get(R)},betweennessNormalized:function(A){if(f==0)return 0;var R=s.collection(A).id();return h.get(R)/f}};return T.betweennessNormalised=T.betweennessNormalized,T}};elesfn$l.bc=elesfn$l.betweennessCentrality;var defaults$c=defaults$g({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(n){return 1}]}),setOptions$3=function(t){return defaults$c(t)},getSimilarity$1=function(t,r){for(var a=0,o=0;o<r.length;o++)a+=r[o](t);return a},addLoops=function(t,r,a){for(var o=0;o<r;o++)t[o*r+o]=a},normalize=function(t,r){for(var a,o=0;o<r;o++){a=0;for(var u=0;u<r;u++)a+=t[u*r+o];for(var s=0;s<r;s++)t[s*r+o]=t[s*r+o]/a}},mmult=function(t,r,a){for(var o=new Array(a*a),u=0;u<a;u++){for(var s=0;s<a;s++)o[u*a+s]=0;for(var c=0;c<a;c++)for(var l=0;l<a;l++)o[u*a+l]+=t[u*a+c]*r[c*a+l]}return o},expand=function(t,r,a){for(var o=t.slice(0),u=1;u<a;u++)t=mmult(t,o,r);return t},inflate=function(t,r,a){for(var o=new Array(r*r),u=0;u<r*r;u++)o[u]=Math.pow(t[u],a);return normalize(o,r),o},hasConverged=function(t,r,a,o){for(var u=0;u<a;u++){var s=Math.round(t[u]*Math.pow(10,o))/Math.pow(10,o),c=Math.round(r[u]*Math.pow(10,o))/Math.pow(10,o);if(s!==c)return!1}return!0},assign$2=function(t,r,a,o){for(var u=[],s=0;s<r;s++){for(var c=[],l=0;l<r;l++)Math.round(t[s*r+l]*1e3)/1e3>0&&c.push(a[l]);c.length!==0&&u.push(o.collection(c))}return u},isDuplicate=function(t,r){for(var a=0;a<t.length;a++)if(!r[a]||t[a].id()!==r[a].id())return!1;return!0},removeDuplicates=function(t){for(var r=0;r<t.length;r++)for(var a=0;a<t.length;a++)r!=a&&isDuplicate(t[r],t[a])&&t.splice(a,1);return t},markovClustering=function(t){for(var r=this.nodes(),a=this.edges(),o=this.cy(),u=setOptions$3(t),s={},c=0;c<r.length;c++)s[r[c].id()]=c;for(var l=r.length,d=l*l,f=new Array(d),h,v=0;v<d;v++)f[v]=0;for(var g=0;g<a.length;g++){var b=a[g],_=s[b.source().id()],S=s[b.target().id()],T=getSimilarity$1(b,u.attributes);f[_*l+S]+=T,f[S*l+_]+=T}addLoops(f,l,u.multFactor),normalize(f,l);for(var w=!0,A=0;w&&A<u.maxIterations;)w=!1,h=expand(f,l,u.expandFactor),f=inflate(h,l,u.inflateFactor),hasConverged(f,h,d,4)||(w=!0),A++;var R=assign$2(f,l,r,o);return R=removeDuplicates(R),R},markovClustering$1={markovClustering,mcl:markovClustering},identity$1=function(t){return t},absDiff=function(t,r){return Math.abs(r-t)},addAbsDiff=function(t,r,a){return t+absDiff(r,a)},addSquaredDiff=function(t,r,a){return t+Math.pow(a-r,2)},sqrt=function(t){return Math.sqrt(t)},maxAbsDiff=function(t,r,a){return Math.max(t,absDiff(r,a))},getDistance=function(t,r,a,o,u){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:identity$1,c=o,l,d,f=0;f<t;f++)l=r(f),d=a(f),c=u(c,l,d);return s(c)},distances={euclidean:function(t,r,a){return t>=2?getDistance(t,r,a,0,addSquaredDiff,sqrt):getDistance(t,r,a,0,addAbsDiff)},squaredEuclidean:function(t,r,a){return getDistance(t,r,a,0,addSquaredDiff)},manhattan:function(t,r,a){return getDistance(t,r,a,0,addAbsDiff)},max:function(t,r,a){return getDistance(t,r,a,-1/0,maxAbsDiff)}};distances["squared-euclidean"]=distances.squaredEuclidean;distances.squaredeuclidean=distances.squaredEuclidean;function clusteringDistance(n,t,r,a,o,u){var s;return fn$6(n)?s=n:s=distances[n]||distances.euclidean,t===0&&fn$6(n)?s(o,u):s(t,r,a,o,u)}var defaults$b=defaults$g({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),setOptions$2=function(t){return defaults$b(t)},getDist=function(t,r,a,o,u){var s=u!=="kMedoids",c=s?function(h){return a[h]}:function(h){return o[h](a)},l=function(v){return o[v](r)},d=a,f=r;return clusteringDistance(t,o.length,c,l,d,f)},randomCentroids=function(t,r,a){for(var o=a.length,u=new Array(o),s=new Array(o),c=new Array(r),l=null,d=0;d<o;d++)u[d]=t.min(a[d]).value,s[d]=t.max(a[d]).value;for(var f=0;f<r;f++){l=[];for(var h=0;h<o;h++)l[h]=Math.random()*(s[h]-u[h])+u[h];c[f]=l}return c},classify=function(t,r,a,o,u){for(var s=1/0,c=0,l=0;l<r.length;l++){var d=getDist(a,t,r[l],o,u);d<s&&(s=d,c=l)}return c},buildCluster=function(t,r,a){for(var o=[],u=null,s=0;s<r.length;s++)u=r[s],a[u.id()]===t&&o.push(u);return o},haveValuesConverged=function(t,r,a){return Math.abs(r-t)<=a},haveMatricesConverged=function(t,r,a){for(var o=0;o<t.length;o++)for(var u=0;u<t[o].length;u++){var s=Math.abs(t[o][u]-r[o][u]);if(s>a)return!1}return!0},seenBefore=function(t,r,a){for(var o=0;o<a;o++)if(t===r[o])return!0;return!1},randomMedoids=function(t,r){var a=new Array(r);if(t.length<50)for(var o=0;o<r;o++){for(var u=t[Math.floor(Math.random()*t.length)];seenBefore(u,a,o);)u=t[Math.floor(Math.random()*t.length)];a[o]=u}else for(var s=0;s<r;s++)a[s]=t[Math.floor(Math.random()*t.length)];return a},findCost=function(t,r,a){for(var o=0,u=0;u<r.length;u++)o+=getDist("manhattan",r[u],t,a,"kMedoids");return o},kMeans=function(t){var r=this.cy(),a=this.nodes(),o=null,u=setOptions$2(t),s=new Array(u.k),c={},l;u.testMode?typeof u.testCentroids=="number"?(u.testCentroids,l=randomCentroids(a,u.k,u.attributes)):_typeof(u.testCentroids)==="object"?l=u.testCentroids:l=randomCentroids(a,u.k,u.attributes):l=randomCentroids(a,u.k,u.attributes);for(var d=!0,f=0;d&&f<u.maxIterations;){for(var h=0;h<a.length;h++)o=a[h],c[o.id()]=classify(o,l,u.distance,u.attributes,"kMeans");d=!1;for(var v=0;v<u.k;v++){var g=buildCluster(v,a,c);if(g.length!==0){for(var b=u.attributes.length,_=l[v],S=new Array(b),T=new Array(b),w=0;w<b;w++){T[w]=0;for(var A=0;A<g.length;A++)o=g[A],T[w]+=u.attributes[w](o);S[w]=T[w]/g.length,haveValuesConverged(S[w],_[w],u.sensitivityThreshold)||(d=!0)}l[v]=S,s[v]=r.collection(g)}}f++}return s},kMedoids=function(t){var r=this.cy(),a=this.nodes(),o=null,u=setOptions$2(t),s=new Array(u.k),c,l={},d,f=new Array(u.k);u.testMode?typeof u.testCentroids=="number"||(_typeof(u.testCentroids)==="object"?c=u.testCentroids:c=randomMedoids(a,u.k)):c=randomMedoids(a,u.k);for(var h=!0,v=0;h&&v<u.maxIterations;){for(var g=0;g<a.length;g++)o=a[g],l[o.id()]=classify(o,c,u.distance,u.attributes,"kMedoids");h=!1;for(var b=0;b<c.length;b++){var _=buildCluster(b,a,l);if(_.length!==0){f[b]=findCost(c[b],_,u.attributes);for(var S=0;S<_.length;S++)d=findCost(_[S],_,u.attributes),d<f[b]&&(f[b]=d,c[b]=_[S],h=!0);s[b]=r.collection(_)}}v++}return s},updateCentroids=function(t,r,a,o,u){for(var s,c,l=0;l<r.length;l++)for(var d=0;d<t.length;d++)o[l][d]=Math.pow(a[l][d],u.m);for(var f=0;f<t.length;f++)for(var h=0;h<u.attributes.length;h++){s=0,c=0;for(var v=0;v<r.length;v++)s+=o[v][f]*u.attributes[h](r[v]),c+=o[v][f];t[f][h]=s/c}},updateMembership=function(t,r,a,o,u){for(var s=0;s<t.length;s++)r[s]=t[s].slice();for(var c,l,d,f=2/(u.m-1),h=0;h<a.length;h++)for(var v=0;v<o.length;v++){c=0;for(var g=0;g<a.length;g++)l=getDist(u.distance,o[v],a[h],u.attributes,"cmeans"),d=getDist(u.distance,o[v],a[g],u.attributes,"cmeans"),c+=Math.pow(l/d,f);t[v][h]=1/c}},assign$1=function(t,r,a,o){for(var u=new Array(a.k),s=0;s<u.length;s++)u[s]=[];for(var c,l,d=0;d<r.length;d++){c=-1/0,l=-1;for(var f=0;f<r[0].length;f++)r[d][f]>c&&(c=r[d][f],l=f);u[l].push(t[d])}for(var h=0;h<u.length;h++)u[h]=o.collection(u[h]);return u},fuzzyCMeans=function(t){var r=this.cy(),a=this.nodes(),o=setOptions$2(t),u,s,c,l,d;l=new Array(a.length);for(var f=0;f<a.length;f++)l[f]=new Array(o.k);c=new Array(a.length);for(var h=0;h<a.length;h++)c[h]=new Array(o.k);for(var v=0;v<a.length;v++){for(var g=0,b=0;b<o.k;b++)c[v][b]=Math.random(),g+=c[v][b];for(var _=0;_<o.k;_++)c[v][_]=c[v][_]/g}s=new Array(o.k);for(var S=0;S<o.k;S++)s[S]=new Array(o.attributes.length);d=new Array(a.length);for(var T=0;T<a.length;T++)d[T]=new Array(o.k);for(var w=!0,A=0;w&&A<o.maxIterations;)w=!1,updateCentroids(s,a,c,d,o),updateMembership(c,l,s,a,o),haveMatricesConverged(c,l,o.sensitivityThreshold)||(w=!0),A++;return u=assign$1(a,c,o,r),{clusters:u,degreeOfMembership:c}},kClustering={kMeans,kMedoids,fuzzyCMeans,fcm:fuzzyCMeans},defaults$a=defaults$g({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),linkageAliases={single:"min",complete:"max"},setOptions$1=function(t){var r=defaults$a(t),a=linkageAliases[r.linkage];return a!=null&&(r.linkage=a),r},mergeClosest=function(t,r,a,o,u){for(var s=0,c=1/0,l,d=u.attributes,f=function(D,$){return clusteringDistance(u.distance,d.length,function(O){return d[O](D)},function(O){return d[O]($)},D,$)},h=0;h<t.length;h++){var v=t[h].key,g=a[v][o[v]];g<c&&(s=v,c=g)}if(u.mode==="threshold"&&c>=u.threshold||u.mode==="dendrogram"&&t.length===1)return!1;var b=r[s],_=r[o[s]],S;u.mode==="dendrogram"?S={left:b,right:_,key:b.key}:S={value:b.value.concat(_.value),key:b.key},t[b.index]=S,t.splice(_.index,1),r[b.key]=S;for(var T=0;T<t.length;T++){var w=t[T];b.key===w.key?l=1/0:u.linkage==="min"?(l=a[b.key][w.key],a[b.key][w.key]>a[_.key][w.key]&&(l=a[_.key][w.key])):u.linkage==="max"?(l=a[b.key][w.key],a[b.key][w.key]<a[_.key][w.key]&&(l=a[_.key][w.key])):u.linkage==="mean"?l=(a[b.key][w.key]*b.size+a[_.key][w.key]*_.size)/(b.size+_.size):u.mode==="dendrogram"?l=f(w.value,b.value):l=f(w.value[0],b.value[0]),a[b.key][w.key]=a[w.key][b.key]=l}for(var A=0;A<t.length;A++){var R=t[A].key;if(o[R]===b.key||o[R]===_.key){for(var E=R,I=0;I<t.length;I++){var L=t[I].key;a[R][L]<a[R][E]&&(E=L)}o[R]=E}t[A].index=A}return b.key=_.key=b.index=_.index=null,!0},getAllChildren=function n(t,r,a){t&&(t.value?r.push(t.value):(t.left&&n(t.left,r),t.right&&n(t.right,r)))},buildDendrogram=function n(t,r){if(!t)return"";if(t.left&&t.right){var a=n(t.left,r),o=n(t.right,r),u=r.add({group:"nodes",data:{id:a+","+o}});return r.add({group:"edges",data:{source:a,target:u.id()}}),r.add({group:"edges",data:{source:o,target:u.id()}}),u.id()}else if(t.value)return t.value.id()},buildClustersFromTree=function n(t,r,a){if(!t)return[];var o=[],u=[],s=[];return r===0?(t.left&&getAllChildren(t.left,o),t.right&&getAllChildren(t.right,u),s=o.concat(u),[a.collection(s)]):r===1?t.value?[a.collection(t.value)]:(t.left&&getAllChildren(t.left,o),t.right&&getAllChildren(t.right,u),[a.collection(o),a.collection(u)]):t.value?[a.collection(t.value)]:(t.left&&(o=n(t.left,r-1,a)),t.right&&(u=n(t.right,r-1,a)),o.concat(u))},hierarchicalClustering=function(t){for(var r=this.cy(),a=this.nodes(),o=setOptions$1(t),u=o.attributes,s=function(A,R){return clusteringDistance(o.distance,u.length,function(E){return u[E](A)},function(E){return u[E](R)},A,R)},c=[],l=[],d=[],f=[],h=0;h<a.length;h++){var v={value:o.mode==="dendrogram"?a[h]:[a[h]],key:h,index:h};c[h]=v,f[h]=v,l[h]=[],d[h]=0}for(var g=0;g<c.length;g++)for(var b=0;b<=g;b++){var _=void 0;o.mode==="dendrogram"?_=g===b?1/0:s(c[g].value,c[b].value):_=g===b?1/0:s(c[g].value[0],c[b].value[0]),l[g][b]=_,l[b][g]=_,_<l[g][d[g]]&&(d[g]=b)}for(var S=mergeClosest(c,f,l,d,o);S;)S=mergeClosest(c,f,l,d,o);var T;return o.mode==="dendrogram"?(T=buildClustersFromTree(c[0],o.dendrogramDepth,r),o.addDendrogram&&buildDendrogram(c[0],r)):(T=new Array(c.length),c.forEach(function(w,A){w.key=w.index=null,T[A]=r.collection(w.value)})),T},hierarchicalClustering$1={hierarchicalClustering,hca:hierarchicalClustering},defaults$9=defaults$g({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),setOptions=function(t){var r=t.damping,a=t.preference;.5<=r&&r<1||error("Damping must range on [0.5, 1).  Got: ".concat(r));var o=["median","mean","min","max"];return o.some(function(u){return u===a})||number$1(a)||error("Preference must be one of [".concat(o.map(function(u){return"'".concat(u,"'")}).join(", "),"] or a number.  Got: ").concat(a)),defaults$9(t)},getSimilarity=function(t,r,a,o){var u=function(c,l){return o[l](c)};return-clusteringDistance(t,o.length,function(s){return u(r,s)},function(s){return u(a,s)},r,a)},getPreference=function(t,r){var a=null;return r==="median"?a=median(t):r==="mean"?a=mean(t):r==="min"?a=min(t):r==="max"?a=max(t):a=r,a},findExemplars=function(t,r,a){for(var o=[],u=0;u<t;u++)r[u*t+u]+a[u*t+u]>0&&o.push(u);return o},assignClusters=function(t,r,a){for(var o=[],u=0;u<t;u++){for(var s=-1,c=-1/0,l=0;l<a.length;l++){var d=a[l];r[u*t+d]>c&&(s=d,c=r[u*t+d])}s>0&&o.push(s)}for(var f=0;f<a.length;f++)o[a[f]]=a[f];return o},assign=function(t,r,a){for(var o=assignClusters(t,r,a),u=0;u<a.length;u++){for(var s=[],c=0;c<o.length;c++)o[c]===a[u]&&s.push(c);for(var l=-1,d=-1/0,f=0;f<s.length;f++){for(var h=0,v=0;v<s.length;v++)h+=r[s[v]*t+s[f]];h>d&&(l=f,d=h)}a[u]=s[l]}return o=assignClusters(t,r,a),o},affinityPropagation=function(t){for(var r=this.cy(),a=this.nodes(),o=setOptions(t),u={},s=0;s<a.length;s++)u[a[s].id()]=s;var c,l,d,f,h,v;c=a.length,l=c*c,d=new Array(l);for(var g=0;g<l;g++)d[g]=-1/0;for(var b=0;b<c;b++)for(var _=0;_<c;_++)b!==_&&(d[b*c+_]=getSimilarity(o.distance,a[b],a[_],o.attributes));f=getPreference(d,o.preference);for(var S=0;S<c;S++)d[S*c+S]=f;h=new Array(l);for(var T=0;T<l;T++)h[T]=0;v=new Array(l);for(var w=0;w<l;w++)v[w]=0;for(var A=new Array(c),R=new Array(c),E=new Array(c),I=0;I<c;I++)A[I]=0,R[I]=0,E[I]=0;for(var L=new Array(c*o.minIterations),F=0;F<L.length;F++)L[F]=0;var D;for(D=0;D<o.maxIterations;D++){for(var $=0;$<c;$++){for(var O=-1/0,P=-1/0,C=-1,q=0,M=0;M<c;M++)A[M]=h[$*c+M],q=v[$*c+M]+d[$*c+M],q>=O?(P=O,O=q,C=M):q>P&&(P=q);for(var N=0;N<c;N++)h[$*c+N]=(1-o.damping)*(d[$*c+N]-O)+o.damping*A[N];h[$*c+C]=(1-o.damping)*(d[$*c+C]-P)+o.damping*A[C]}for(var G=0;G<c;G++){for(var X=0,Y=0;Y<c;Y++)A[Y]=v[Y*c+G],R[Y]=Math.max(0,h[Y*c+G]),X+=R[Y];X-=R[G],R[G]=h[G*c+G],X+=R[G];for(var W=0;W<c;W++)v[W*c+G]=(1-o.damping)*Math.min(0,X-R[W])+o.damping*A[W];v[G*c+G]=(1-o.damping)*(X-R[G])+o.damping*A[G]}for(var te=0,ue=0;ue<c;ue++){var fe=v[ue*c+ue]+h[ue*c+ue]>0?1:0;L[D%o.minIterations*c+ue]=fe,te+=fe}if(te>0&&(D>=o.minIterations-1||D==o.maxIterations-1)){for(var re=0,ye=0;ye<c;ye++){E[ye]=0;for(var Te=0;Te<o.minIterations;Te++)E[ye]+=L[Te*c+ye];(E[ye]===0||E[ye]===o.minIterations)&&re++}if(re===c)break}}for(var Re=findExemplars(c,h,v),ve=assign(c,d,Re),ce={},J=0;J<Re.length;J++)ce[Re[J]]=[];for(var j=0;j<a.length;j++){var z=u[a[j].id()],B=ve[z];B!=null&&ce[B].push(a[j])}for(var U=new Array(Re.length),Z=0;Z<Re.length;Z++)U[Z]=r.collection(ce[Re[Z]]);return U},affinityPropagation$1={affinityPropagation,ap:affinityPropagation},hierholzerDefaults=defaults$g({root:void 0,directed:!1}),elesfn$k={hierholzer:function(t){if(!plainObject(t)){var r=arguments;t={root:r[0],directed:r[1]}}var a=hierholzerDefaults(t),o=a.root,u=a.directed,s=this,c=!1,l,d,f;o&&(f=string(o)?this.filter(o)[0].id():o[0].id());var h={},v={};u?s.forEach(function(w){var A=w.id();if(w.isNode()){var R=w.indegree(!0),E=w.outdegree(!0),I=R-E,L=E-R;I==1?l?c=!0:l=A:L==1?d?c=!0:d=A:(L>1||I>1)&&(c=!0),h[A]=[],w.outgoers().forEach(function(F){F.isEdge()&&h[A].push(F.id())})}else v[A]=[void 0,w.target().id()]}):s.forEach(function(w){var A=w.id();if(w.isNode()){var R=w.degree(!0);R%2&&(l?d?c=!0:d=A:l=A),h[A]=[],w.connectedEdges().forEach(function(E){return h[A].push(E.id())})}else v[A]=[w.source().id(),w.target().id()]});var g={found:!1,trail:void 0};if(c)return g;if(d&&l)if(u){if(f&&d!=f)return g;f=d}else{if(f&&d!=f&&l!=f)return g;f||(f=d)}else f||(f=s[0].id());var b=function(A){for(var R=A,E=[A],I,L,F;h[R].length;)I=h[R].shift(),L=v[I][0],F=v[I][1],R!=F?(h[F]=h[F].filter(function(D){return D!=I}),R=F):!u&&R!=L&&(h[L]=h[L].filter(function(D){return D!=I}),R=L),E.unshift(I),E.unshift(R);return E},_=[],S=[];for(S=b(f);S.length!=1;)h[S[0]].length==0?(_.unshift(s.getElementById(S.shift())),_.unshift(s.getElementById(S.shift()))):S=b(S.shift()).concat(S);_.unshift(s.getElementById(S.shift()));for(var T in h)if(h[T].length)return g;return g.found=!0,g.trail=this.spawn(_,!0),g}},hopcroftTarjanBiconnected=function(){var t=this,r={},a=0,o=0,u=[],s=[],c={},l=function(v,g){for(var b=s.length-1,_=[],S=t.spawn();s[b].x!=v||s[b].y!=g;)_.push(s.pop().edge),b--;_.push(s.pop().edge),_.forEach(function(T){var w=T.connectedNodes().intersection(t);S.merge(T),w.forEach(function(A){var R=A.id(),E=A.connectedEdges().intersection(t);S.merge(A),r[R].cutVertex?S.merge(E.filter(function(I){return I.isLoop()})):S.merge(E)})}),u.push(S)},d=function h(v,g,b){v===b&&(o+=1),r[g]={id:a,low:a++,cutVertex:!1};var _=t.getElementById(g).connectedEdges().intersection(t);if(_.size()===0)u.push(t.spawn(t.getElementById(g)));else{var S,T,w,A;_.forEach(function(R){S=R.source().id(),T=R.target().id(),w=S===g?T:S,w!==b&&(A=R.id(),c[A]||(c[A]=!0,s.push({x:g,y:w,edge:R})),w in r?r[g].low=Math.min(r[g].low,r[w].id):(h(v,w,g),r[g].low=Math.min(r[g].low,r[w].low),r[g].id<=r[w].low&&(r[g].cutVertex=!0,l(g,w))))})}};t.forEach(function(h){if(h.isNode()){var v=h.id();v in r||(o=0,d(v,v),r[v].cutVertex=o>1)}});var f=Object.keys(r).filter(function(h){return r[h].cutVertex}).map(function(h){return t.getElementById(h)});return{cut:t.spawn(f),components:u}},hopcroftTarjanBiconnected$1={hopcroftTarjanBiconnected,htbc:hopcroftTarjanBiconnected,htb:hopcroftTarjanBiconnected,hopcroftTarjanBiconnectedComponents:hopcroftTarjanBiconnected},tarjanStronglyConnected=function(){var t=this,r={},a=0,o=[],u=[],s=t.spawn(t),c=function l(d){u.push(d),r[d]={index:a,low:a++,explored:!1};var f=t.getElementById(d).connectedEdges().intersection(t);if(f.forEach(function(_){var S=_.target().id();S!==d&&(S in r||l(S),r[S].explored||(r[d].low=Math.min(r[d].low,r[S].low)))}),r[d].index===r[d].low){for(var h=t.spawn();;){var v=u.pop();if(h.merge(t.getElementById(v)),r[v].low=r[d].index,r[v].explored=!0,v===d)break}var g=h.edgesWith(h),b=h.merge(g);o.push(b),s=s.difference(b)}};return t.forEach(function(l){if(l.isNode()){var d=l.id();d in r||c(d)}}),{cut:s,components:o}},tarjanStronglyConnected$1={tarjanStronglyConnected,tsc:tarjanStronglyConnected,tscc:tarjanStronglyConnected,tarjanStronglyConnectedComponents:tarjanStronglyConnected},elesfn$j={};[elesfn$v,elesfn$u,elesfn$t,elesfn$s,elesfn$r,elesfn$q,elesfn$p,elesfn$o,elesfn$n,elesfn$m,elesfn$l,markovClustering$1,kClustering,hierarchicalClustering$1,affinityPropagation$1,elesfn$k,hopcroftTarjanBiconnected$1,tarjanStronglyConnected$1].forEach(function(n){extend(elesfn$j,n)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var STATE_PENDING=0,STATE_FULFILLED=1,STATE_REJECTED=2,api=function n(t){if(!(this instanceof n))return new n(t);this.id="Thenable/1.0.7",this.state=STATE_PENDING,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof t=="function"&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};api.prototype={fulfill:function(t){return deliver(this,STATE_FULFILLED,"fulfillValue",t)},reject:function(t){return deliver(this,STATE_REJECTED,"rejectReason",t)},then:function(t,r){var a=this,o=new api;return a.onFulfilled.push(resolver(t,o,"fulfill")),a.onRejected.push(resolver(r,o,"reject")),execute(a),o.proxy}};var deliver=function(t,r,a,o){return t.state===STATE_PENDING&&(t.state=r,t[a]=o,execute(t)),t},execute=function(t){t.state===STATE_FULFILLED?execute_handlers(t,"onFulfilled",t.fulfillValue):t.state===STATE_REJECTED&&execute_handlers(t,"onRejected",t.rejectReason)},execute_handlers=function(t,r,a){if(t[r].length!==0){var o=t[r];t[r]=[];var u=function(){for(var c=0;c<o.length;c++)o[c](a)};typeof setImmediate=="function"?setImmediate(u):setTimeout(u,0)}},resolver=function(t,r,a){return function(o){if(typeof t!="function")r[a].call(r,o);else{var u;try{u=t(o)}catch(s){r.reject(s);return}resolve(r,u)}}},resolve=function n(t,r){if(t===r||t.proxy===r){t.reject(new TypeError("cannot resolve promise with itself"));return}var a;if(_typeof(r)==="object"&&r!==null||typeof r=="function")try{a=r.then}catch(u){t.reject(u);return}if(typeof a=="function"){var o=!1;try{a.call(r,function(u){o||(o=!0,u===r?t.reject(new TypeError("circular thenable chain")):n(t,u))},function(u){o||(o=!0,t.reject(u))})}catch(u){o||t.reject(u)}return}t.fulfill(r)};api.all=function(n){return new api(function(t,r){for(var a=new Array(n.length),o=0,u=function(l,d){a[l]=d,o++,o===n.length&&t(a)},s=0;s<n.length;s++)(function(c){var l=n[c],d=l!=null&&l.then!=null;if(d)l.then(function(h){u(c,h)},function(h){r(h)});else{var f=l;u(c,f)}})(s)})};api.resolve=function(n){return new api(function(t,r){t(n)})};api.reject=function(n){return new api(function(t,r){r(n)})};var Promise$1=typeof Promise<"u"?Promise:api,Animation=function(t,r,a){var o=core(t),u=!o,s=this._private=extend({duration:1e3},r,a);if(s.target=t,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&fn$6(s.complete)&&s.completes.push(s.complete),u){var c=t.position();s.startPosition=s.startPosition||{x:c.x,y:c.y},s.startStyle=s.startStyle||t.cy().style().getAnimationStartStyle(t,s.style)}if(o){var l=t.pan();s.startPan={x:l.x,y:l.y},s.startZoom=t.zoom()}this.length=1,this[0]=this},anifn=Animation.prototype;extend(anifn,{instanceString:function(){return"animation"},hook:function(){var t=this._private;if(!t.hooked){var r,a=t.target._private.animation;t.queue?r=a.queue:r=a.current,r.push(this),elementOrCollection(t.target)&&t.target.cy().addToAnimationPool(t.target),t.hooked=!0}return this},play:function(){var t=this._private;return t.progress===1&&(t.progress=0),t.playing=!0,t.started=!1,t.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var t=this._private;return t.applying=!0,t.started=!1,t.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var t=this._private;return t.playing=!1,t.started=!1,this},stop:function(){var t=this._private;return t.playing=!1,t.started=!1,t.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var r=this._private;return t===void 0?r.progress*r.duration:this.progress(t/r.duration)},progress:function(t){var r=this._private,a=r.playing;return t===void 0?r.progress:(a&&this.pause(),r.progress=t,r.started=!1,a&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var t=this._private,r=t.playing;r&&this.pause(),t.progress=1-t.progress,t.started=!1;var a=function(d,f){var h=t[d];h!=null&&(t[d]=t[f],t[f]=h)};if(a("zoom","startZoom"),a("pan","startPan"),a("position","startPosition"),t.style)for(var o=0;o<t.style.length;o++){var u=t.style[o],s=u.name,c=t.startStyle[s];t.startStyle[s]=u,t.style[o]=c}return r&&this.play(),this},promise:function(t){var r=this._private,a;switch(t){case"frame":a=r.frames;break;default:case"complete":case"completed":a=r.completes}return new Promise$1(function(o,u){a.push(function(){o()})})}});anifn.complete=anifn.completed;anifn.run=anifn.play;anifn.running=anifn.playing;var define$3={animated:function(){return function(){var r=this,a=r.length!==void 0,o=a?r:[r],u=this._private.cy||this;if(!u.styleEnabled())return!1;var s=o[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,a=r.length!==void 0,o=a?r:[r],u=this._private.cy||this;if(!u.styleEnabled())return this;for(var s=0;s<o.length;s++){var c=o[s];c._private.animation.queue=[]}return this}},delay:function(){return function(r,a){var o=this._private.cy||this;return o.styleEnabled()?this.animate({delay:r,duration:r,complete:a}):this}},delayAnimation:function(){return function(r,a){var o=this._private.cy||this;return o.styleEnabled()?this.animation({delay:r,duration:r,complete:a}):this}},animation:function(){return function(r,a){var o=this,u=o.length!==void 0,s=u?o:[o],c=this._private.cy||this,l=!u,d=!l;if(!c.styleEnabled())return this;var f=c.style();r=extend({},r,a);var h=Object.keys(r).length===0;if(h)return new Animation(s[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(d&&(r.style=f.getPropsList(r.style||r.css),r.css=void 0),d&&r.renderedPosition!=null){var v=r.renderedPosition,g=c.pan(),b=c.zoom();r.position=renderedToModelPosition(v,b,g)}if(l&&r.panBy!=null){var _=r.panBy,S=c.pan();r.pan={x:S.x+_.x,y:S.y+_.y}}var T=r.center||r.centre;if(l&&T!=null){var w=c.getCenterPan(T.eles,r.zoom);w!=null&&(r.pan=w)}if(l&&r.fit!=null){var A=r.fit,R=c.getFitViewport(A.eles||A.boundingBox,A.padding);R!=null&&(r.pan=R.pan,r.zoom=R.zoom)}if(l&&plainObject(r.zoom)){var E=c.getZoomedViewport(r.zoom);E!=null?(E.zoomed&&(r.zoom=E.zoom),E.panned&&(r.pan=E.pan)):r.zoom=null}return new Animation(s[0],r)}},animate:function(){return function(r,a){var o=this,u=o.length!==void 0,s=u?o:[o],c=this._private.cy||this;if(!c.styleEnabled())return this;a&&(r=extend({},r,a));for(var l=0;l<s.length;l++){var d=s[l],f=d.animated()&&(r.queue===void 0||r.queue),h=d.animation(r,f?{queue:!0}:void 0);h.play()}return this}},stop:function(){return function(r,a){var o=this,u=o.length!==void 0,s=u?o:[o],c=this._private.cy||this;if(!c.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var d=s[l],f=d._private,h=f.animation.current,v=0;v<h.length;v++){var g=h[v],b=g._private;a&&(b.duration=0)}r&&(f.animation.queue=[]),a||(f.animation.current=[])}return c.notify("draw"),this}}},isArray=Array.isArray,isArray_1=isArray,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(n,t){if(isArray_1(n))return!1;var r=typeof n;return r=="number"||r=="symbol"||r=="boolean"||n==null||isSymbol_1(n)?!0:reIsPlainProp.test(n)||!reIsDeepProp.test(n)||t!=null&&n in Object(t)}var _isKey=isKey,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(n){if(!isObject_1(n))return!1;var t=_baseGetTag(n);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var n=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function isMasked(n){return!!maskSrcKey&&maskSrcKey in n}var _isMasked=isMasked,funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(n){if(n!=null){try{return funcToString$1.call(n)}catch{}try{return n+""}catch{}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$3=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$3=objectProto$3.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$3).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(n){if(!isObject_1(n)||_isMasked(n))return!1;var t=isFunction_1(n)?reIsNative:reIsHostCtor;return t.test(_toSource(n))}var _baseIsNative=baseIsNative;function getValue$1(n,t){return n==null?void 0:n[t]}var _getValue=getValue$1;function getNative(n,t){var r=_getValue(n,t);return _baseIsNative(r)?r:void 0}var _getNative=getNative,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function hashGet(n){var t=this.__data__;if(_nativeCreate){var r=t[n];return r===HASH_UNDEFINED$1?void 0:r}return hasOwnProperty$2.call(t,n)?t[n]:void 0}var _hashGet=hashGet,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function hashHas(n){var t=this.__data__;return _nativeCreate?t[n]!==void 0:hasOwnProperty$1.call(t,n)}var _hashHas=hashHas,HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=_nativeCreate&&t===void 0?HASH_UNDEFINED:t,this}var _hashSet=hashSet;function Hash(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var a=n[t];this.set(a[0],a[1])}}Hash.prototype.clear=_hashClear;Hash.prototype.delete=_hashDelete;Hash.prototype.get=_hashGet;Hash.prototype.has=_hashHas;Hash.prototype.set=_hashSet;var _Hash=Hash;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(n,t){return n===t||n!==n&&t!==t}var eq_1=eq;function assocIndexOf(n,t){for(var r=n.length;r--;)if(eq_1(n[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(n){var t=this.__data__,r=_assocIndexOf(t,n);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():splice.call(t,r,1),--this.size,!0}var _listCacheDelete=listCacheDelete;function listCacheGet(n){var t=this.__data__,r=_assocIndexOf(t,n);return r<0?void 0:t[r][1]}var _listCacheGet=listCacheGet;function listCacheHas(n){return _assocIndexOf(this.__data__,n)>-1}var _listCacheHas=listCacheHas;function listCacheSet(n,t){var r=this.__data__,a=_assocIndexOf(r,n);return a<0?(++this.size,r.push([n,t])):r[a][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var a=n[t];this.set(a[0],a[1])}}ListCache.prototype.clear=_listCacheClear;ListCache.prototype.delete=_listCacheDelete;ListCache.prototype.get=_listCacheGet;ListCache.prototype.has=_listCacheHas;ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache,Map$1=_getNative(_root,"Map"),_Map=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}var _isKeyable=isKeyable;function getMapData(n,t){var r=n.__data__;return _isKeyable(t)?r[typeof t=="string"?"string":"hash"]:r.map}var _getMapData=getMapData;function mapCacheDelete(n){var t=_getMapData(this,n).delete(n);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(n){return _getMapData(this,n).get(n)}var _mapCacheGet=mapCacheGet;function mapCacheHas(n){return _getMapData(this,n).has(n)}var _mapCacheHas=mapCacheHas;function mapCacheSet(n,t){var r=_getMapData(this,n),a=r.size;return r.set(n,t),this.size+=r.size==a?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var a=n[t];this.set(a[0],a[1])}}MapCache.prototype.clear=_mapCacheClear;MapCache.prototype.delete=_mapCacheDelete;MapCache.prototype.get=_mapCacheGet;MapCache.prototype.has=_mapCacheHas;MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,FUNC_ERROR_TEXT="Expected a function";function memoize(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);var r=function(){var a=arguments,o=t?t.apply(this,a):a[0],u=r.cache;if(u.has(o))return u.get(o);var s=n.apply(this,a);return r.cache=u.set(o,s)||u,s};return r.cache=new(memoize.Cache||_MapCache),r}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(n){var t=memoize_1(n,function(a){return r.size===MAX_MEMOIZE_SIZE&&r.clear(),a}),r=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(rePropName,function(r,a,o,u){t.push(o?u.replace(reEscapeChar,"$1"):a||r)}),t}),_stringToPath=stringToPath;function arrayMap(n,t){for(var r=-1,a=n==null?0:n.length,o=Array(a);++r<a;)o[r]=t(n[r],r,n);return o}var _arrayMap=arrayMap,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(n){if(typeof n=="string")return n;if(isArray_1(n))return _arrayMap(n,baseToString)+"";if(isSymbol_1(n))return symbolToString?symbolToString.call(n):"";var t=n+"";return t=="0"&&1/n==-1/0?"-0":t}var _baseToString=baseToString;function toString$1(n){return n==null?"":_baseToString(n)}var toString_1=toString$1;function castPath(n,t){return isArray_1(n)?n:_isKey(n,t)?[n]:_stringToPath(toString_1(n))}var _castPath=castPath;function toKey(n){if(typeof n=="string"||isSymbol_1(n))return n;var t=n+"";return t=="0"&&1/n==-1/0?"-0":t}var _toKey=toKey;function baseGet(n,t){t=_castPath(t,n);for(var r=0,a=t.length;n!=null&&r<a;)n=n[_toKey(t[r++])];return r&&r==a?n:void 0}var _baseGet=baseGet;function get(n,t,r){var a=n==null?void 0:_baseGet(n,t);return a===void 0?r:a}var get_1=get,defineProperty=function(){try{var n=_getNative(Object,"defineProperty");return n({},"",{}),n}catch{}}(),_defineProperty=defineProperty;function baseAssignValue(n,t,r){t=="__proto__"&&_defineProperty?_defineProperty(n,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):n[t]=r}var _baseAssignValue=baseAssignValue,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function assignValue(n,t,r){var a=n[t];(!(hasOwnProperty.call(n,t)&&eq_1(a,r))||r===void 0&&!(t in n))&&_baseAssignValue(n,t,r)}var _assignValue=assignValue,MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(n,t){var r=typeof n;return t=t??MAX_SAFE_INTEGER,!!t&&(r=="number"||r!="symbol"&&reIsUint.test(n))&&n>-1&&n%1==0&&n<t}var _isIndex=isIndex;function baseSet(n,t,r,a){if(!isObject_1(n))return n;t=_castPath(t,n);for(var o=-1,u=t.length,s=u-1,c=n;c!=null&&++o<u;){var l=_toKey(t[o]),d=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(o!=s){var f=c[l];d=a?a(f,l,c):void 0,d===void 0&&(d=isObject_1(f)?f:_isIndex(t[o+1])?[]:{})}_assignValue(c,l,d),c=c[l]}return n}var _baseSet=baseSet;function set(n,t,r){return n==null?n:_baseSet(n,t,r)}var set_1=set;function copyArray(n,t){var r=-1,a=n.length;for(t||(t=Array(a));++r<a;)t[r]=n[r];return t}var _copyArray=copyArray;function toPath(n){return isArray_1(n)?_arrayMap(n,_toKey):isSymbol_1(n)?[n]:_copyArray(_stringToPath(toString_1(n)))}var toPath_1=toPath,define$2={data:function(t){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(o){},beforeSet:function(o,u){},onSet:function(o){},canSet:function(o){return!0}};return t=extend({},r,t),function(o,u){var s=t,c=this,l=c.length!==void 0,d=l?c:[c],f=l?c[0]:c;if(string(o)){var h=o.indexOf(".")!==-1,v=h&&toPath_1(o);if(s.allowGetting&&u===void 0){var g;return f&&(s.beforeGet(f),v&&f._private[s.field][o]===void 0?g=get_1(f._private[s.field],v):g=f._private[s.field][o]),g}else if(s.allowSetting&&u!==void 0){var b=!s.immutableKeys[o];if(b){var _=_defineProperty$1({},o,u);s.beforeSet(c,_);for(var S=0,T=d.length;S<T;S++){var w=d[S];s.canSet(w)&&(v&&f._private[s.field][o]===void 0?set_1(w._private[s.field],v,u):w._private[s.field][o]=u)}s.updateStyle&&c.updateStyle(),s.onSet(c),s.settingTriggersEvent&&c[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&plainObject(o)){var A=o,R,E,I=Object.keys(A);s.beforeSet(c,A);for(var L=0;L<I.length;L++){R=I[L],E=A[R];var F=!s.immutableKeys[R];if(F)for(var D=0;D<d.length;D++){var $=d[D];s.canSet($)&&($._private[s.field][R]=E)}}s.updateStyle&&c.updateStyle(),s.onSet(c),s.settingTriggersEvent&&c[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&fn$6(o)){var O=o;c.on(s.bindingEvent,O)}else if(s.allowGetting&&o===void 0){var P;return f&&(s.beforeGet(f),P=f._private[s.field]),P}return c}},removeData:function(t){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return t=extend({},r,t),function(o){var u=t,s=this,c=s.length!==void 0,l=c?s:[s];if(string(o)){for(var d=o.split(/\s+/),f=d.length,h=0;h<f;h++){var v=d[h];if(!emptyString(v)){var g=!u.immutableKeys[v];if(g)for(var b=0,_=l.length;b<_;b++)l[b]._private[u.field][v]=void 0}}u.triggerEvent&&s[u.triggerFnName](u.event)}else if(o===void 0){for(var S=0,T=l.length;S<T;S++)for(var w=l[S]._private[u.field],A=Object.keys(w),R=0;R<A.length;R++){var E=A[R],I=!u.immutableKeys[E];I&&(w[E]=void 0)}u.triggerEvent&&s[u.triggerFnName](u.event)}return s}}},define$1={eventAliasesOn:function(t){var r=t;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(a,o){var u=this,s=Array.prototype.slice.call(arguments,0);return new Promise$1(function(c,l){var d=function(g){u.off.apply(u,h),c(g)},f=s.concat([d]),h=f.concat([]);u.on.apply(u,f)})}}},define={};[define$3,define$2,define$1].forEach(function(n){extend(define,n)});var elesfn$i={animate:define.animate(),animation:define.animation(),animated:define.animated(),clearQueue:define.clearQueue(),delay:define.delay(),delayAnimation:define.delayAnimation(),stop:define.stop()},elesfn$h={classes:function(t){var r=this;if(t===void 0){var a=[];return r[0]._private.classes.forEach(function(b){return a.push(b)}),a}else array(t)||(t=(t||"").match(/\S+/g)||[]);for(var o=[],u=new Set$1(t),s=0;s<r.length;s++){for(var c=r[s],l=c._private,d=l.classes,f=!1,h=0;h<t.length;h++){var v=t[h],g=d.has(v);if(!g){f=!0;break}}f||(f=d.size!==t.length),f&&(l.classes=u,o.push(c))}return o.length>0&&this.spawn(o).updateStyle().emit("class"),r},addClass:function(t){return this.toggleClass(t,!0)},hasClass:function(t){var r=this[0];return r!=null&&r._private.classes.has(t)},toggleClass:function(t,r){array(t)||(t=t.match(/\S+/g)||[]);for(var a=this,o=r===void 0,u=[],s=0,c=a.length;s<c;s++)for(var l=a[s],d=l._private.classes,f=!1,h=0;h<t.length;h++){var v=t[h],g=d.has(v),b=!1;r||o&&!g?(d.add(v),b=!0):(!r||o&&g)&&(d.delete(v),b=!0),!f&&b&&(u.push(l),f=!0)}return u.length>0&&this.spawn(u).updateStyle().emit("class"),a},removeClass:function(t){return this.toggleClass(t,!1)},flashClass:function(t,r){var a=this;if(r==null)r=250;else if(r===0)return a;return a.addClass(t),setTimeout(function(){a.removeClass(t)},r),a}};elesfn$h.className=elesfn$h.classNames=elesfn$h.classes;var tokens={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};tokens.variable="(?:[\\w-.]|(?:\\\\"+tokens.metaChar+"))+";tokens.className="(?:[\\w-]|(?:\\\\"+tokens.metaChar+"))+";tokens.value=tokens.string+"|"+tokens.number;tokens.id=tokens.variable;(function(){var n,t,r;for(n=tokens.comparatorOp.split("|"),r=0;r<n.length;r++)t=n[r],tokens.comparatorOp+="|@"+t;for(n=tokens.comparatorOp.split("|"),r=0;r<n.length;r++)t=n[r],!(t.indexOf("!")>=0)&&t!=="="&&(tokens.comparatorOp+="|\\!"+t)})();var newQuery=function(){return{checks:[]}},Type={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},stateSelectors=[{selector:":selected",matches:function(t){return t.selected()}},{selector:":unselected",matches:function(t){return!t.selected()}},{selector:":selectable",matches:function(t){return t.selectable()}},{selector:":unselectable",matches:function(t){return!t.selectable()}},{selector:":locked",matches:function(t){return t.locked()}},{selector:":unlocked",matches:function(t){return!t.locked()}},{selector:":visible",matches:function(t){return t.visible()}},{selector:":hidden",matches:function(t){return!t.visible()}},{selector:":transparent",matches:function(t){return t.transparent()}},{selector:":grabbed",matches:function(t){return t.grabbed()}},{selector:":free",matches:function(t){return!t.grabbed()}},{selector:":removed",matches:function(t){return t.removed()}},{selector:":inside",matches:function(t){return!t.removed()}},{selector:":grabbable",matches:function(t){return t.grabbable()}},{selector:":ungrabbable",matches:function(t){return!t.grabbable()}},{selector:":animated",matches:function(t){return t.animated()}},{selector:":unanimated",matches:function(t){return!t.animated()}},{selector:":parent",matches:function(t){return t.isParent()}},{selector:":childless",matches:function(t){return t.isChildless()}},{selector:":child",matches:function(t){return t.isChild()}},{selector:":orphan",matches:function(t){return t.isOrphan()}},{selector:":nonorphan",matches:function(t){return t.isChild()}},{selector:":compound",matches:function(t){return t.isNode()?t.isParent():t.source().isParent()||t.target().isParent()}},{selector:":loop",matches:function(t){return t.isLoop()}},{selector:":simple",matches:function(t){return t.isSimple()}},{selector:":active",matches:function(t){return t.active()}},{selector:":inactive",matches:function(t){return!t.active()}},{selector:":backgrounding",matches:function(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function(t){return!t.backgrounding()}}].sort(function(n,t){return descending(n.selector,t.selector)}),lookup$1=function(){for(var n={},t,r=0;r<stateSelectors.length;r++)t=stateSelectors[r],n[t.selector]=t.matches;return n}(),stateSelectorMatches=function(t,r){return lookup$1[t](r)},stateSelectorRegex="("+stateSelectors.map(function(n){return n.selector}).join("|")+")",cleanMetaChars=function(t){return t.replace(new RegExp("\\\\("+tokens.metaChar+")","g"),function(r,a){return a})},replaceLastQuery=function(t,r,a){t[t.length-1]=a},exprs=[{name:"group",query:!0,regex:"("+tokens.group+")",populate:function(t,r,a){var o=_slicedToArray(a,1),u=o[0];r.checks.push({type:Type.GROUP,value:u==="*"?u:u+"s"})}},{name:"state",query:!0,regex:stateSelectorRegex,populate:function(t,r,a){var o=_slicedToArray(a,1),u=o[0];r.checks.push({type:Type.STATE,value:u})}},{name:"id",query:!0,regex:"\\#("+tokens.id+")",populate:function(t,r,a){var o=_slicedToArray(a,1),u=o[0];r.checks.push({type:Type.ID,value:cleanMetaChars(u)})}},{name:"className",query:!0,regex:"\\.("+tokens.className+")",populate:function(t,r,a){var o=_slicedToArray(a,1),u=o[0];r.checks.push({type:Type.CLASS,value:cleanMetaChars(u)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*\\]",populate:function(t,r,a){var o=_slicedToArray(a,1),u=o[0];r.checks.push({type:Type.DATA_EXIST,field:cleanMetaChars(u)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.value+")\\s*\\]",populate:function(t,r,a){var o=_slicedToArray(a,3),u=o[0],s=o[1],c=o[2],l=new RegExp("^"+tokens.string+"$").exec(c)!=null;l?c=c.substring(1,c.length-1):c=parseFloat(c),r.checks.push({type:Type.DATA_COMPARE,field:cleanMetaChars(u),operator:s,value:c})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+tokens.boolOp+")\\s*("+tokens.variable+")\\s*\\]",populate:function(t,r,a){var o=_slicedToArray(a,2),u=o[0],s=o[1];r.checks.push({type:Type.DATA_BOOL,field:cleanMetaChars(s),operator:u})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+tokens.meta+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.number+")\\s*\\]\\]",populate:function(t,r,a){var o=_slicedToArray(a,3),u=o[0],s=o[1],c=o[2];r.checks.push({type:Type.META_COMPARE,field:cleanMetaChars(u),operator:s,value:parseFloat(c)})}},{name:"nextQuery",separator:!0,regex:tokens.separator,populate:function(t,r){var a=t.currentSubject,o=t.edgeCount,u=t.compoundCount,s=t[t.length-1];a!=null&&(s.subject=a,t.currentSubject=null),s.edgeCount=o,s.compoundCount=u,t.edgeCount=0,t.compoundCount=0;var c=t[t.length++]=newQuery();return c}},{name:"directedEdge",separator:!0,regex:tokens.directedEdge,populate:function(t,r){if(t.currentSubject==null){var a=newQuery(),o=r,u=newQuery();return a.checks.push({type:Type.DIRECTED_EDGE,source:o,target:u}),replaceLastQuery(t,r,a),t.edgeCount++,u}else{var s=newQuery(),c=r,l=newQuery();return s.checks.push({type:Type.NODE_SOURCE,source:c,target:l}),replaceLastQuery(t,r,s),t.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:tokens.undirectedEdge,populate:function(t,r){if(t.currentSubject==null){var a=newQuery(),o=r,u=newQuery();return a.checks.push({type:Type.UNDIRECTED_EDGE,nodes:[o,u]}),replaceLastQuery(t,r,a),t.edgeCount++,u}else{var s=newQuery(),c=r,l=newQuery();return s.checks.push({type:Type.NODE_NEIGHBOR,node:c,neighbor:l}),replaceLastQuery(t,r,s),l}}},{name:"child",separator:!0,regex:tokens.child,populate:function(t,r){if(t.currentSubject==null){var a=newQuery(),o=newQuery(),u=t[t.length-1];return a.checks.push({type:Type.CHILD,parent:u,child:o}),replaceLastQuery(t,r,a),t.compoundCount++,o}else if(t.currentSubject===r){var s=newQuery(),c=t[t.length-1],l=newQuery(),d=newQuery(),f=newQuery(),h=newQuery();return s.checks.push({type:Type.COMPOUND_SPLIT,left:c,right:l,subject:d}),d.checks=r.checks,r.checks=[{type:Type.TRUE}],h.checks.push({type:Type.TRUE}),l.checks.push({type:Type.PARENT,parent:h,child:f}),replaceLastQuery(t,c,s),t.currentSubject=d,t.compoundCount++,f}else{var v=newQuery(),g=newQuery(),b=[{type:Type.PARENT,parent:v,child:g}];return v.checks=r.checks,r.checks=b,t.compoundCount++,g}}},{name:"descendant",separator:!0,regex:tokens.descendant,populate:function(t,r){if(t.currentSubject==null){var a=newQuery(),o=newQuery(),u=t[t.length-1];return a.checks.push({type:Type.DESCENDANT,ancestor:u,descendant:o}),replaceLastQuery(t,r,a),t.compoundCount++,o}else if(t.currentSubject===r){var s=newQuery(),c=t[t.length-1],l=newQuery(),d=newQuery(),f=newQuery(),h=newQuery();return s.checks.push({type:Type.COMPOUND_SPLIT,left:c,right:l,subject:d}),d.checks=r.checks,r.checks=[{type:Type.TRUE}],h.checks.push({type:Type.TRUE}),l.checks.push({type:Type.ANCESTOR,ancestor:h,descendant:f}),replaceLastQuery(t,c,s),t.currentSubject=d,t.compoundCount++,f}else{var v=newQuery(),g=newQuery(),b=[{type:Type.ANCESTOR,ancestor:v,descendant:g}];return v.checks=r.checks,r.checks=b,t.compoundCount++,g}}},{name:"subject",modifier:!0,regex:tokens.subject,populate:function(t,r){if(t.currentSubject!=null&&t.currentSubject!==r)return warn("Redefinition of subject in selector `"+t.toString()+"`"),!1;t.currentSubject=r;var a=t[t.length-1],o=a.checks[0],u=o==null?null:o.type;u===Type.DIRECTED_EDGE?o.type=Type.NODE_TARGET:u===Type.UNDIRECTED_EDGE&&(o.type=Type.NODE_NEIGHBOR,o.node=o.nodes[1],o.neighbor=o.nodes[0],o.nodes=null)}}];exprs.forEach(function(n){return n.regexObj=new RegExp("^"+n.regex)});var consumeExpr=function(t){for(var r,a,o,u=0;u<exprs.length;u++){var s=exprs[u],c=s.name,l=t.match(s.regexObj);if(l!=null){a=l,r=s,o=c;var d=l[0];t=t.substring(d.length);break}}return{expr:r,match:a,name:o,remaining:t}},consumeWhitespace=function(t){var r=t.match(/^\s+/);if(r){var a=r[0];t=t.substring(a.length)}return t},parse=function(t){var r=this,a=r.inputText=t,o=r[0]=newQuery();for(r.length=1,a=consumeWhitespace(a);;){var u=consumeExpr(a);if(u.expr==null)return warn("The selector `"+t+"`is invalid"),!1;var s=u.match.slice(1),c=u.expr.populate(r,o,s);if(c===!1)return!1;if(c!=null&&(o=c),a=u.remaining,a.match(/^\s*$/))break}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject),l.edgeCount=r.edgeCount,l.compoundCount=r.compoundCount;for(var d=0;d<r.length;d++){var f=r[d];if(f.compoundCount>0&&f.edgeCount>0)return warn("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(f.edgeCount>1)return warn("The selector `"+t+"` is invalid because it uses multiple edge selectors"),!1;f.edgeCount===1&&warn("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString=function(){if(this.toStringCache!=null)return this.toStringCache;for(var t=function(f){return f??""},r=function(f){return string(f)?'"'+f+'"':t(f)},a=function(f){return" "+f+" "},o=function(f,h){var v=f.type,g=f.value;switch(v){case Type.GROUP:{var b=t(g);return b.substring(0,b.length-1)}case Type.DATA_COMPARE:{var _=f.field,S=f.operator;return"["+_+a(t(S))+r(g)+"]"}case Type.DATA_BOOL:{var T=f.operator,w=f.field;return"["+t(T)+w+"]"}case Type.DATA_EXIST:{var A=f.field;return"["+A+"]"}case Type.META_COMPARE:{var R=f.operator,E=f.field;return"[["+E+a(t(R))+r(g)+"]]"}case Type.STATE:return g;case Type.ID:return"#"+g;case Type.CLASS:return"."+g;case Type.PARENT:case Type.CHILD:return u(f.parent,h)+a(">")+u(f.child,h);case Type.ANCESTOR:case Type.DESCENDANT:return u(f.ancestor,h)+" "+u(f.descendant,h);case Type.COMPOUND_SPLIT:{var I=u(f.left,h),L=u(f.subject,h),F=u(f.right,h);return I+(I.length>0?" ":"")+L+F}case Type.TRUE:return""}},u=function(f,h){return f.checks.reduce(function(v,g,b){return v+(h===f&&b===0?"$":"")+o(g,h)},"")},s="",c=0;c<this.length;c++){var l=this[c];s+=u(l,l.subject),this.length>1&&c<this.length-1&&(s+=", ")}return this.toStringCache=s,s},parse$1={parse,toString},valCmp=function(t,r,a){var o,u=string(t),s=number$1(t),c=string(a),l,d,f=!1,h=!1,v=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),h=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),f=!0),(u||c||f)&&(l=!u&&!s?"":""+t,d=""+a),f&&(t=l=l.toLowerCase(),a=d=d.toLowerCase()),r){case"*=":o=l.indexOf(d)>=0;break;case"$=":o=l.indexOf(d,l.length-d.length)>=0;break;case"^=":o=l.indexOf(d)===0;break;case"=":o=t===a;break;case">":v=!0,o=t>a;break;case">=":v=!0,o=t>=a;break;case"<":v=!0,o=t<a;break;case"<=":v=!0,o=t<=a;break;default:o=!1;break}return h&&(t!=null||!v)&&(o=!o),o},boolCmp=function(t,r){switch(r){case"?":return!!t;case"!":return!t;case"^":return t===void 0}},existCmp=function(t){return t!==void 0},data$1=function(t,r){return t.data(r)},meta=function(t,r){return t[r]()},match=[],matches$1=function(t,r){return t.checks.every(function(a){return match[a.type](a,r)})};match[Type.GROUP]=function(n,t){var r=n.value;return r==="*"||r===t.group()};match[Type.STATE]=function(n,t){var r=n.value;return stateSelectorMatches(r,t)};match[Type.ID]=function(n,t){var r=n.value;return t.id()===r};match[Type.CLASS]=function(n,t){var r=n.value;return t.hasClass(r)};match[Type.META_COMPARE]=function(n,t){var r=n.field,a=n.operator,o=n.value;return valCmp(meta(t,r),a,o)};match[Type.DATA_COMPARE]=function(n,t){var r=n.field,a=n.operator,o=n.value;return valCmp(data$1(t,r),a,o)};match[Type.DATA_BOOL]=function(n,t){var r=n.field,a=n.operator;return boolCmp(data$1(t,r),a)};match[Type.DATA_EXIST]=function(n,t){var r=n.field;return n.operator,existCmp(data$1(t,r))};match[Type.UNDIRECTED_EDGE]=function(n,t){var r=n.nodes[0],a=n.nodes[1],o=t.source(),u=t.target();return matches$1(r,o)&&matches$1(a,u)||matches$1(a,o)&&matches$1(r,u)};match[Type.NODE_NEIGHBOR]=function(n,t){return matches$1(n.node,t)&&t.neighborhood().some(function(r){return r.isNode()&&matches$1(n.neighbor,r)})};match[Type.DIRECTED_EDGE]=function(n,t){return matches$1(n.source,t.source())&&matches$1(n.target,t.target())};match[Type.NODE_SOURCE]=function(n,t){return matches$1(n.source,t)&&t.outgoers().some(function(r){return r.isNode()&&matches$1(n.target,r)})};match[Type.NODE_TARGET]=function(n,t){return matches$1(n.target,t)&&t.incomers().some(function(r){return r.isNode()&&matches$1(n.source,r)})};match[Type.CHILD]=function(n,t){return matches$1(n.child,t)&&matches$1(n.parent,t.parent())};match[Type.PARENT]=function(n,t){return matches$1(n.parent,t)&&t.children().some(function(r){return matches$1(n.child,r)})};match[Type.DESCENDANT]=function(n,t){return matches$1(n.descendant,t)&&t.ancestors().some(function(r){return matches$1(n.ancestor,r)})};match[Type.ANCESTOR]=function(n,t){return matches$1(n.ancestor,t)&&t.descendants().some(function(r){return matches$1(n.descendant,r)})};match[Type.COMPOUND_SPLIT]=function(n,t){return matches$1(n.subject,t)&&matches$1(n.left,t)&&matches$1(n.right,t)};match[Type.TRUE]=function(){return!0};match[Type.COLLECTION]=function(n,t){var r=n.value;return r.has(t)};match[Type.FILTER]=function(n,t){var r=n.value;return r(t)};var filter=function(t){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===Type.ID)return t.getElementById(r[0].checks[0].value).collection();var a=function(u){for(var s=0;s<r.length;s++){var c=r[s];if(matches$1(c,u))return!0}return!1};return r.text()==null&&(a=function(){return!0}),t.filter(a)},matches=function(t){for(var r=this,a=0;a<r.length;a++){var o=r[a];if(matches$1(o,t))return!0}return!1},matching={matches,filter},Selector=function(t){this.inputText=t,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,t==null||string(t)&&t.match(/^\s*$/)||(elementOrCollection(t)?this.addQuery({checks:[{type:Type.COLLECTION,value:t.collection()}]}):fn$6(t)?this.addQuery({checks:[{type:Type.FILTER,value:t}]}):string(t)?this.parse(t)||(this.invalid=!0):error("A selector must be created from a string; found "))},selfn=Selector.prototype;[parse$1,matching].forEach(function(n){return extend(selfn,n)});selfn.text=function(){return this.inputText};selfn.size=function(){return this.length};selfn.eq=function(n){return this[n]};selfn.sameText=function(n){return!this.invalid&&!n.invalid&&this.text()===n.text()};selfn.addQuery=function(n){this[this.length++]=n};selfn.selector=selfn.toString;var elesfn$g={allAre:function(t){var r=new Selector(t);return this.every(function(a){return r.matches(a)})},is:function(t){var r=new Selector(t);return this.some(function(a){return r.matches(a)})},some:function(t,r){for(var a=0;a<this.length;a++){var o=r?t.apply(r,[this[a],a,this]):t(this[a],a,this);if(o)return!0}return!1},every:function(t,r){for(var a=0;a<this.length;a++){var o=r?t.apply(r,[this[a],a,this]):t(this[a],a,this);if(!o)return!1}return!0},same:function(t){if(this===t)return!0;t=this.cy().collection(t);var r=this.length,a=t.length;return r!==a?!1:r===1?this[0]===t[0]:this.every(function(o){return t.hasElementWithId(o.id())})},anySame:function(t){return t=this.cy().collection(t),this.some(function(r){return t.hasElementWithId(r.id())})},allAreNeighbors:function(t){t=this.cy().collection(t);var r=this.neighborhood();return t.every(function(a){return r.hasElementWithId(a.id())})},contains:function(t){t=this.cy().collection(t);var r=this;return t.every(function(a){return r.hasElementWithId(a.id())})}};elesfn$g.allAreNeighbours=elesfn$g.allAreNeighbors;elesfn$g.has=elesfn$g.contains;elesfn$g.equal=elesfn$g.equals=elesfn$g.same;var cache=function(t,r){return function(o,u,s,c){var l=o,d=this,f;if(l==null?f="":elementOrCollection(l)&&l.length===1&&(f=l.id()),d.length===1&&f){var h=d[0]._private,v=h.traversalCache=h.traversalCache||{},g=v[r]=v[r]||[],b=hashString(f),_=g[b];return _||(g[b]=t.call(d,o,u,s,c))}else return t.call(d,o,u,s,c)}},elesfn$f={parent:function(t){var r=[];if(this.length===1){var a=this[0]._private.parent;if(a)return a}for(var o=0;o<this.length;o++){var u=this[o],s=u._private.parent;s&&r.push(s)}return this.spawn(r,!0).filter(t)},parents:function(t){for(var r=[],a=this.parent();a.nonempty();){for(var o=0;o<a.length;o++){var u=a[o];r.push(u)}a=a.parent()}return this.spawn(r,!0).filter(t)},commonAncestors:function(t){for(var r,a=0;a<this.length;a++){var o=this[a],u=o.parents();r=r||u,r=r.intersect(u)}return r.filter(t)},orphans:function(t){return this.stdFilter(function(r){return r.isOrphan()}).filter(t)},nonorphans:function(t){return this.stdFilter(function(r){return r.isChild()}).filter(t)},children:cache(function(n){for(var t=[],r=0;r<this.length;r++)for(var a=this[r],o=a._private.children,u=0;u<o.length;u++)t.push(o[u]);return this.spawn(t,!0).filter(n)},"children"),siblings:function(t){return this.parent().children().not(this).filter(t)},isParent:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length!==0},isChildless:function(){var t=this[0];if(t)return t.isNode()&&t._private.children.length===0},isChild:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent!=null},isOrphan:function(){var t=this[0];if(t)return t.isNode()&&t._private.parent==null},descendants:function(t){var r=[];function a(o){for(var u=0;u<o.length;u++){var s=o[u];r.push(s),s.children().nonempty()&&a(s.children())}}return a(this.children()),this.spawn(r,!0).filter(t)}};function forEachCompound(n,t,r,a){for(var o=[],u=new Set$1,s=n.cy(),c=s.hasCompoundNodes(),l=0;l<n.length;l++){var d=n[l];r?o.push(d):c&&a(o,u,d)}for(;o.length>0;){var f=o.shift();t(f),u.add(f.id()),c&&a(o,u,f)}return n}function addChildren(n,t,r){if(r.isParent())for(var a=r._private.children,o=0;o<a.length;o++){var u=a[o];t.has(u.id())||n.push(u)}}elesfn$f.forEachDown=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,n,t,addChildren)};function addParent(n,t,r){if(r.isChild()){var a=r._private.parent;t.has(a.id())||n.push(a)}}elesfn$f.forEachUp=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,n,t,addParent)};function addParentAndChildren(n,t,r){addParent(n,t,r),addChildren(n,t,r)}elesfn$f.forEachUpAndDown=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,n,t,addParentAndChildren)};elesfn$f.ancestors=elesfn$f.parents;var fn$5,elesfn$e;fn$5=elesfn$e={data:define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:define.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:define.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:define.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var t=this[0];if(t)return t._private.data.id}};fn$5.attr=fn$5.data;fn$5.removeAttr=fn$5.removeData;var data=elesfn$e,elesfn$d={};function defineDegreeFunction(n){return function(t){var r=this;if(t===void 0&&(t=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var a=0,o=r[0],u=o._private.edges,s=0;s<u.length;s++){var c=u[s];!t&&c.isLoop()||(a+=n(o,c))}return a}else return}}extend(elesfn$d,{degree:defineDegreeFunction(function(n,t){return t.source().same(t.target())?2:1}),indegree:defineDegreeFunction(function(n,t){return t.target().same(n)?1:0}),outdegree:defineDegreeFunction(function(n,t){return t.source().same(n)?1:0})});function defineDegreeBoundsFunction(n,t){return function(r){for(var a,o=this.nodes(),u=0;u<o.length;u++){var s=o[u],c=s[n](r);c!==void 0&&(a===void 0||t(c,a))&&(a=c)}return a}}extend(elesfn$d,{minDegree:defineDegreeBoundsFunction("degree",function(n,t){return n<t}),maxDegree:defineDegreeBoundsFunction("degree",function(n,t){return n>t}),minIndegree:defineDegreeBoundsFunction("indegree",function(n,t){return n<t}),maxIndegree:defineDegreeBoundsFunction("indegree",function(n,t){return n>t}),minOutdegree:defineDegreeBoundsFunction("outdegree",function(n,t){return n<t}),maxOutdegree:defineDegreeBoundsFunction("outdegree",function(n,t){return n>t})});extend(elesfn$d,{totalDegree:function(t){for(var r=0,a=this.nodes(),o=0;o<a.length;o++)r+=a[o].degree(t);return r}});var fn$4,elesfn$c,beforePositionSet=function(t,r,a){for(var o=0;o<t.length;o++){var u=t[o];if(!u.locked()){var s=u._private.position,c={x:r.x!=null?r.x-s.x:0,y:r.y!=null?r.y-s.y:0};u.isParent()&&!(c.x===0&&c.y===0)&&u.children().shift(c,a),u.dirtyBoundingBoxCache()}}},positionDef={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(t){t.updateCompoundBounds()},beforeSet:function(t,r){beforePositionSet(t,r,!1)},onSet:function(t){t.dirtyCompoundBoundsCache()},canSet:function(t){return!t.locked()}};fn$4=elesfn$c={position:define.data(positionDef),silentPosition:define.data(extend({},positionDef,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(t,r){beforePositionSet(t,r,!0)},onSet:function(t){t.dirtyCompoundBoundsCache()}})),positions:function(t,r){if(plainObject(t))r?this.silentPosition(t):this.position(t);else if(fn$6(t)){var a=t,o=this.cy();o.startBatch();for(var u=0;u<this.length;u++){var s=this[u],c=void 0;(c=a(s,u))&&(r?s.silentPosition(c):s.position(c))}o.endBatch()}return this},silentPositions:function(t){return this.positions(t,!0)},shift:function(t,r,a){var o;if(plainObject(t)?(o={x:number$1(t.x)?t.x:0,y:number$1(t.y)?t.y:0},a=r):string(t)&&number$1(r)&&(o={x:0,y:0},o[t]=r),o!=null){var u=this.cy();u.startBatch();for(var s=0;s<this.length;s++){var c=this[s];if(!(u.hasCompoundNodes()&&c.isChild()&&c.ancestors().anySame(this))){var l=c.position(),d={x:l.x+o.x,y:l.y+o.y};a?c.silentPosition(d):c.position(d)}}u.endBatch()}return this},silentShift:function(t,r){return plainObject(t)?this.shift(t,!0):string(t)&&number$1(r)&&this.shift(t,r,!0),this},renderedPosition:function(t,r){var a=this[0],o=this.cy(),u=o.zoom(),s=o.pan(),c=plainObject(t)?t:void 0,l=c!==void 0||r!==void 0&&string(t);if(a&&a.isNode())if(l)for(var d=0;d<this.length;d++){var f=this[d];r!==void 0?f.position(t,(r-s[t])/u):c!==void 0&&f.position(renderedToModelPosition(c,u,s))}else{var h=a.position();return c=modelToRenderedPosition$1(h,u,s),t===void 0?c:c[t]}else if(!l)return;return this},relativePosition:function(t,r){var a=this[0],o=this.cy(),u=plainObject(t)?t:void 0,s=u!==void 0||r!==void 0&&string(t),c=o.hasCompoundNodes();if(a&&a.isNode())if(s)for(var l=0;l<this.length;l++){var d=this[l],f=c?d.parent():null,h=f&&f.length>0,v=h;h&&(f=f[0]);var g=v?f.position():{x:0,y:0};r!==void 0?d.position(t,r+g[t]):u!==void 0&&d.position({x:u.x+g.x,y:u.y+g.y})}else{var b=a.position(),_=c?a.parent():null,S=_&&_.length>0,T=S;S&&(_=_[0]);var w=T?_.position():{x:0,y:0};return u={x:b.x-w.x,y:b.y-w.y},t===void 0?u:u[t]}else if(!s)return;return this}};fn$4.modelPosition=fn$4.point=fn$4.position;fn$4.modelPositions=fn$4.points=fn$4.positions;fn$4.renderedPoint=fn$4.renderedPosition;fn$4.relativePoint=fn$4.relativePosition;var position=elesfn$c,fn$3,elesfn$b;fn$3=elesfn$b={};elesfn$b.renderedBoundingBox=function(n){var t=this.boundingBox(n),r=this.cy(),a=r.zoom(),o=r.pan(),u=t.x1*a+o.x,s=t.x2*a+o.x,c=t.y1*a+o.y,l=t.y2*a+o.y;return{x1:u,x2:s,y1:c,y2:l,w:s-u,h:l-c}};elesfn$b.dirtyCompoundBoundsCache=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();return!t.styleEnabled()||!t.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var a=r._private;a.compoundBoundsClean=!1,a.bbCache=null,n||r.emitAndNotify("bounds")}}),this)};elesfn$b.updateCompoundBounds=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!n&&t.batching())return this;function r(s){if(!s.isParent())return;var c=s._private,l=s.children(),d=s.pstyle("compound-sizing-wrt-labels").value==="include",f={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},h=l.boundingBox({includeLabels:d,includeOverlays:!1,useCache:!1}),v=c.position;(h.w===0||h.h===0)&&(h={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},h.x1=v.x-h.w/2,h.x2=v.x+h.w/2,h.y1=v.y-h.h/2,h.y2=v.y+h.h/2);function g(D,$,O){var P=0,C=0,q=$+O;return D>0&&q>0&&(P=$/q*D,C=O/q*D),{biasDiff:P,biasComplementDiff:C}}function b(D,$,O,P){if(O.units==="%")switch(P){case"width":return D>0?O.pfValue*D:0;case"height":return $>0?O.pfValue*$:0;case"average":return D>0&&$>0?O.pfValue*(D+$)/2:0;case"min":return D>0&&$>0?D>$?O.pfValue*$:O.pfValue*D:0;case"max":return D>0&&$>0?D>$?O.pfValue*D:O.pfValue*$:0;default:return 0}else return O.units==="px"?O.pfValue:0}var _=f.width.left.value;f.width.left.units==="px"&&f.width.val>0&&(_=_*100/f.width.val);var S=f.width.right.value;f.width.right.units==="px"&&f.width.val>0&&(S=S*100/f.width.val);var T=f.height.top.value;f.height.top.units==="px"&&f.height.val>0&&(T=T*100/f.height.val);var w=f.height.bottom.value;f.height.bottom.units==="px"&&f.height.val>0&&(w=w*100/f.height.val);var A=g(f.width.val-h.w,_,S),R=A.biasDiff,E=A.biasComplementDiff,I=g(f.height.val-h.h,T,w),L=I.biasDiff,F=I.biasComplementDiff;c.autoPadding=b(h.w,h.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),c.autoWidth=Math.max(h.w,f.width.val),v.x=(-R+h.x1+h.x2+E)/2,c.autoHeight=Math.max(h.h,f.height.val),v.y=(-L+h.y1+h.y2+F)/2}for(var a=0;a<this.length;a++){var o=this[a],u=o._private;(!u.compoundBoundsClean||n)&&(r(o),t.batching()||(u.compoundBoundsClean=!0))}return this};var noninf=function(t){return t===1/0||t===-1/0?0:t},updateBounds=function(t,r,a,o,u){o-r===0||u-a===0||r==null||a==null||o==null||u==null||(t.x1=r<t.x1?r:t.x1,t.x2=o>t.x2?o:t.x2,t.y1=a<t.y1?a:t.y1,t.y2=u>t.y2?u:t.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1)},updateBoundsFromBox=function(t,r){return r==null?t:updateBounds(t,r.x1,r.y1,r.x2,r.y2)},prefixedProperty=function(t,r,a){return getPrefixedProperty(t,r,a)},updateBoundsFromArrow=function(t,r,a){if(!r.cy().headless()){var o=r._private,u=o.rstyle,s=u.arrowWidth/2,c=r.pstyle(a+"-arrow-shape").value,l,d;if(c!=="none"){a==="source"?(l=u.srcX,d=u.srcY):a==="target"?(l=u.tgtX,d=u.tgtY):(l=u.midX,d=u.midY);var f=o.arrowBounds=o.arrowBounds||{},h=f[a]=f[a]||{};h.x1=l-s,h.y1=d-s,h.x2=l+s,h.y2=d+s,h.w=h.x2-h.x1,h.h=h.y2-h.y1,expandBoundingBox(h,1),updateBounds(t,h.x1,h.y1,h.x2,h.y2)}}},updateBoundsFromLabel=function(t,r,a){if(!r.cy().headless()){var o;a?o=a+"-":o="";var u=r._private,s=u.rstyle,c=r.pstyle(o+"label").strValue;if(c){var l=r.pstyle("text-halign"),d=r.pstyle("text-valign"),f=prefixedProperty(s,"labelWidth",a),h=prefixedProperty(s,"labelHeight",a),v=prefixedProperty(s,"labelX",a),g=prefixedProperty(s,"labelY",a),b=r.pstyle(o+"text-margin-x").pfValue,_=r.pstyle(o+"text-margin-y").pfValue,S=r.isEdge(),T=r.pstyle(o+"text-rotation"),w=r.pstyle("text-outline-width").pfValue,A=r.pstyle("text-border-width").pfValue,R=A/2,E=r.pstyle("text-background-padding").pfValue,I=2,L=h,F=f,D=F/2,$=L/2,O,P,C,q;if(S)O=v-D,P=v+D,C=g-$,q=g+$;else{switch(l.value){case"left":O=v-F,P=v;break;case"center":O=v-D,P=v+D;break;case"right":O=v,P=v+F;break}switch(d.value){case"top":C=g-L,q=g;break;case"center":C=g-$,q=g+$;break;case"bottom":C=g,q=g+L;break}}var M=b-Math.max(w,R)-E-I,N=b+Math.max(w,R)+E+I,G=_-Math.max(w,R)-E-I,X=_+Math.max(w,R)+E+I;O+=M,P+=N,C+=G,q+=X;var Y=a||"main",W=u.labelBounds,te=W[Y]=W[Y]||{};te.x1=O,te.y1=C,te.x2=P,te.y2=q,te.w=P-O,te.h=q-C,te.leftPad=M,te.rightPad=N,te.topPad=G,te.botPad=X;var ue=S&&T.strValue==="autorotate",fe=T.pfValue!=null&&T.pfValue!==0;if(ue||fe){var re=ue?prefixedProperty(u.rstyle,"labelAngle",a):T.pfValue,ye=Math.cos(re),Te=Math.sin(re),Re=(O+P)/2,ve=(C+q)/2;if(!S){switch(l.value){case"left":Re=P;break;case"right":Re=O;break}switch(d.value){case"top":ve=q;break;case"bottom":ve=C;break}}var ce=function(ie,se){return ie=ie-Re,se=se-ve,{x:ie*ye-se*Te+Re,y:ie*Te+se*ye+ve}},J=ce(O,C),j=ce(O,q),z=ce(P,C),B=ce(P,q);O=Math.min(J.x,j.x,z.x,B.x),P=Math.max(J.x,j.x,z.x,B.x),C=Math.min(J.y,j.y,z.y,B.y),q=Math.max(J.y,j.y,z.y,B.y)}var U=Y+"Rot",Z=W[U]=W[U]||{};Z.x1=O,Z.y1=C,Z.x2=P,Z.y2=q,Z.w=P-O,Z.h=q-C,updateBounds(t,O,C,P,q),updateBounds(u.labelBounds.all,O,C,P,q)}return t}},updateBoundsFromOutline=function(t,r){if(!r.cy().headless()){var a=r.pstyle("outline-opacity").value,o=r.pstyle("outline-width").value;if(a>0&&o>0){var u=r.pstyle("outline-offset").value,s=r.pstyle("shape").value,c=o+u,l=(t.w+c*2)/t.w,d=(t.h+c*2)/t.h,f=0,h=0;["diamond","pentagon","round-triangle"].includes(s)?(l=(t.w+c*2.4)/t.w,h=-c/3.6):["concave-hexagon","rhomboid","right-rhomboid"].includes(s)?l=(t.w+c*2.4)/t.w:s==="star"?(l=(t.w+c*2.8)/t.w,d=(t.h+c*2.6)/t.h,h=-c/3.8):s==="triangle"?(l=(t.w+c*2.8)/t.w,d=(t.h+c*2.4)/t.h,h=-c/1.4):s==="vee"&&(l=(t.w+c*4.4)/t.w,d=(t.h+c*3.8)/t.h,h=-c*.5);var v=t.h*d-t.h,g=t.w*l-t.w;if(expandBoundingBoxSides(t,[Math.ceil(v/2),Math.ceil(g/2)]),f!=0||h!==0){var b=shiftBoundingBox(t,f,h);updateBoundingBox(t,b)}}}},boundingBoxImpl=function(t,r){var a=t._private.cy,o=a.styleEnabled(),u=a.headless(),s=makeBoundingBox(),c=t._private,l=t.isNode(),d=t.isEdge(),f,h,v,g,b,_,S=c.rstyle,T=l&&o?t.pstyle("bounds-expansion").pfValue:[0],w=function(oe){return oe.pstyle("display").value!=="none"},A=!o||w(t)&&(!d||w(t.source())&&w(t.target()));if(A){var R=0,E=0;o&&r.includeOverlays&&(R=t.pstyle("overlay-opacity").value,R!==0&&(E=t.pstyle("overlay-padding").value));var I=0,L=0;o&&r.includeUnderlays&&(I=t.pstyle("underlay-opacity").value,I!==0&&(L=t.pstyle("underlay-padding").value));var F=Math.max(E,L),D=0,$=0;if(o&&(D=t.pstyle("width").pfValue,$=D/2),l&&r.includeNodes){var O=t.position();b=O.x,_=O.y;var P=t.outerWidth(),C=P/2,q=t.outerHeight(),M=q/2;f=b-C,h=b+C,v=_-M,g=_+M,updateBounds(s,f,v,h,g),o&&r.includeOutlines&&updateBoundsFromOutline(s,t)}else if(d&&r.includeEdges)if(o&&!u){var N=t.pstyle("curve-style").strValue;if(f=Math.min(S.srcX,S.midX,S.tgtX),h=Math.max(S.srcX,S.midX,S.tgtX),v=Math.min(S.srcY,S.midY,S.tgtY),g=Math.max(S.srcY,S.midY,S.tgtY),f-=$,h+=$,v-=$,g+=$,updateBounds(s,f,v,h,g),N==="haystack"){var G=S.haystackPts;if(G&&G.length===2){if(f=G[0].x,v=G[0].y,h=G[1].x,g=G[1].y,f>h){var X=f;f=h,h=X}if(v>g){var Y=v;v=g,g=Y}updateBounds(s,f-$,v-$,h+$,g+$)}}else if(N==="bezier"||N==="unbundled-bezier"||N.endsWith("segments")||N.endsWith("taxi")){var W;switch(N){case"bezier":case"unbundled-bezier":W=S.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":W=S.linePts;break}if(W!=null)for(var te=0;te<W.length;te++){var ue=W[te];f=ue.x-$,h=ue.x+$,v=ue.y-$,g=ue.y+$,updateBounds(s,f,v,h,g)}}}else{var fe=t.source(),re=fe.position(),ye=t.target(),Te=ye.position();if(f=re.x,h=Te.x,v=re.y,g=Te.y,f>h){var Re=f;f=h,h=Re}if(v>g){var ve=v;v=g,g=ve}f-=$,h+=$,v-=$,g+=$,updateBounds(s,f,v,h,g)}if(o&&r.includeEdges&&d&&(updateBoundsFromArrow(s,t,"mid-source"),updateBoundsFromArrow(s,t,"mid-target"),updateBoundsFromArrow(s,t,"source"),updateBoundsFromArrow(s,t,"target")),o){var ce=t.pstyle("ghost").value==="yes";if(ce){var J=t.pstyle("ghost-offset-x").pfValue,j=t.pstyle("ghost-offset-y").pfValue;updateBounds(s,s.x1+J,s.y1+j,s.x2+J,s.y2+j)}}var z=c.bodyBounds=c.bodyBounds||{};assignBoundingBox(z,s),expandBoundingBoxSides(z,T),expandBoundingBox(z,1),o&&(f=s.x1,h=s.x2,v=s.y1,g=s.y2,updateBounds(s,f-F,v-F,h+F,g+F));var B=c.overlayBounds=c.overlayBounds||{};assignBoundingBox(B,s),expandBoundingBoxSides(B,T),expandBoundingBox(B,1);var U=c.labelBounds=c.labelBounds||{};U.all!=null?clearBoundingBox(U.all):U.all=makeBoundingBox(),o&&r.includeLabels&&(r.includeMainLabels&&updateBoundsFromLabel(s,t,null),d&&(r.includeSourceLabels&&updateBoundsFromLabel(s,t,"source"),r.includeTargetLabels&&updateBoundsFromLabel(s,t,"target")))}return s.x1=noninf(s.x1),s.y1=noninf(s.y1),s.x2=noninf(s.x2),s.y2=noninf(s.y2),s.w=noninf(s.x2-s.x1),s.h=noninf(s.y2-s.y1),s.w>0&&s.h>0&&A&&(expandBoundingBoxSides(s,T),expandBoundingBox(s,1)),s},getKey=function(t){var r=0,a=function(s){return(s?1:0)<<r++},o=0;return o+=a(t.incudeNodes),o+=a(t.includeEdges),o+=a(t.includeLabels),o+=a(t.includeMainLabels),o+=a(t.includeSourceLabels),o+=a(t.includeTargetLabels),o+=a(t.includeOverlays),o+=a(t.includeOutlines),o},getBoundingBoxPosKey=function(t){if(t.isEdge()){var r=t.source().position(),a=t.target().position(),o=function(s){return Math.round(s)};return hashIntsArray([o(r.x),o(r.y),o(a.x),o(a.y)])}else return 0},cachedBoundingBoxImpl=function(t,r){var a=t._private,o,u=t.isEdge(),s=r==null?defBbOptsKey:getKey(r),c=s===defBbOptsKey,l=getBoundingBoxPosKey(t),d=a.bbCachePosKey===l,f=r.useCache&&d,h=function(_){return _._private.bbCache==null||_._private.styleDirty},v=!f||h(t)||u&&(h(t.source())||h(t.target()));if(v?(d||t.recalculateRenderedStyle(f),o=boundingBoxImpl(t,defBbOpts),a.bbCache=o,a.bbCachePosKey=l):o=a.bbCache,!c){var g=t.isNode();o=makeBoundingBox(),(r.includeNodes&&g||r.includeEdges&&!g)&&(r.includeOverlays?updateBoundsFromBox(o,a.overlayBounds):updateBoundsFromBox(o,a.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!u||r.includeSourceLabels&&r.includeTargetLabels)?updateBoundsFromBox(o,a.labelBounds.all):(r.includeMainLabels&&updateBoundsFromBox(o,a.labelBounds.mainRot),r.includeSourceLabels&&updateBoundsFromBox(o,a.labelBounds.sourceRot),r.includeTargetLabels&&updateBoundsFromBox(o,a.labelBounds.targetRot))),o.w=o.x2-o.x1,o.h=o.y2-o.y1}return o},defBbOpts={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},defBbOptsKey=getKey(defBbOpts),filledBbOpts=defaults$g(defBbOpts);elesfn$b.boundingBox=function(n){var t;if(this.length===1&&this[0]._private.bbCache!=null&&!this[0]._private.styleDirty&&(n===void 0||n.useCache===void 0||n.useCache===!0))n===void 0?n=defBbOpts:n=filledBbOpts(n),t=cachedBoundingBoxImpl(this[0],n);else{t=makeBoundingBox(),n=n||defBbOpts;var r=filledBbOpts(n),a=this,o=a.cy(),u=o.styleEnabled();if(u)for(var s=0;s<a.length;s++){var c=a[s],l=c._private,d=getBoundingBoxPosKey(c),f=l.bbCachePosKey===d,h=r.useCache&&f&&!l.styleDirty;c.recalculateRenderedStyle(h)}this.updateCompoundBounds(!n.useCache);for(var v=0;v<a.length;v++){var g=a[v];updateBoundsFromBox(t,cachedBoundingBoxImpl(g,r))}}return t.x1=noninf(t.x1),t.y1=noninf(t.y1),t.x2=noninf(t.x2),t.y2=noninf(t.y2),t.w=noninf(t.x2-t.x1),t.h=noninf(t.y2-t.y1),t};elesfn$b.dirtyBoundingBoxCache=function(){for(var n=0;n<this.length;n++){var t=this[n]._private;t.bbCache=null,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.labelBounds.sourceRot=null,t.labelBounds.targetRot=null,t.labelBounds.mainRot=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};elesfn$b.boundingBoxAt=function(n){var t=this.nodes(),r=this.cy(),a=r.hasCompoundNodes(),o=r.collection();if(a&&(o=t.filter(function(d){return d.isParent()}),t=t.not(o)),plainObject(n)){var u=n;n=function(){return u}}var s=function(f,h){return f._private.bbAtOldPos=n(f,h)},c=function(f){return f._private.bbAtOldPos};r.startBatch(),t.forEach(s).silentPositions(n),a&&(o.dirtyCompoundBoundsCache(),o.dirtyBoundingBoxCache(),o.updateCompoundBounds(!0));var l=copyBoundingBox(this.boundingBox({useCache:!1}));return t.silentPositions(c),a&&(o.dirtyCompoundBoundsCache(),o.dirtyBoundingBoxCache(),o.updateCompoundBounds(!0)),r.endBatch(),l};fn$3.boundingbox=fn$3.bb=fn$3.boundingBox;fn$3.renderedBoundingbox=fn$3.renderedBoundingBox;var bounds=elesfn$b,fn$2,elesfn$a;fn$2=elesfn$a={};var defineDimFns=function(t){t.uppercaseName=capitalize(t.name),t.autoName="auto"+t.uppercaseName,t.labelName="label"+t.uppercaseName,t.outerName="outer"+t.uppercaseName,t.uppercaseOuterName=capitalize(t.outerName),fn$2[t.name]=function(){var a=this[0],o=a._private,u=o.cy,s=u._private.styleEnabled;if(a)if(s){if(a.isParent())return a.updateCompoundBounds(),o[t.autoName]||0;var c=a.pstyle(t.name);switch(c.strValue){case"label":return a.recalculateRenderedStyle(),o.rstyle[t.labelName]||0;default:return c.pfValue}}else return 1},fn$2["outer"+t.uppercaseName]=function(){var a=this[0],o=a._private,u=o.cy,s=u._private.styleEnabled;if(a)if(s){var c=a[t.name](),l=a.pstyle("border-width").pfValue,d=2*a.padding();return c+l+d}else return 1},fn$2["rendered"+t.uppercaseName]=function(){var a=this[0];if(a){var o=a[t.name]();return o*this.cy().zoom()}},fn$2["rendered"+t.uppercaseOuterName]=function(){var a=this[0];if(a){var o=a[t.outerName]();return o*this.cy().zoom()}}};defineDimFns({name:"width"});defineDimFns({name:"height"});elesfn$a.padding=function(){var n=this[0],t=n._private;return n.isParent()?(n.updateCompoundBounds(),t.autoPadding!==void 0?t.autoPadding:n.pstyle("padding").pfValue):n.pstyle("padding").pfValue};elesfn$a.paddedHeight=function(){var n=this[0];return n.height()+2*n.padding()};elesfn$a.paddedWidth=function(){var n=this[0];return n.width()+2*n.padding()};var widthHeight=elesfn$a,ifEdge=function(t,r){if(t.isEdge())return r(t)},ifEdgeRenderedPosition=function(t,r){if(t.isEdge()){var a=t.cy();return modelToRenderedPosition$1(r(t),a.zoom(),a.pan())}},ifEdgeRenderedPositions=function(t,r){if(t.isEdge()){var a=t.cy(),o=a.pan(),u=a.zoom();return r(t).map(function(s){return modelToRenderedPosition$1(s,u,o)})}},controlPoints=function(t){return t.renderer().getControlPoints(t)},segmentPoints=function(t){return t.renderer().getSegmentPoints(t)},sourceEndpoint=function(t){return t.renderer().getSourceEndpoint(t)},targetEndpoint=function(t){return t.renderer().getTargetEndpoint(t)},midpoint=function(t){return t.renderer().getEdgeMidpoint(t)},pts={controlPoints:{get:controlPoints,mult:!0},segmentPoints:{get:segmentPoints,mult:!0},sourceEndpoint:{get:sourceEndpoint},targetEndpoint:{get:targetEndpoint},midpoint:{get:midpoint}},renderedName=function(t){return"rendered"+t[0].toUpperCase()+t.substr(1)},edgePoints=Object.keys(pts).reduce(function(n,t){var r=pts[t],a=renderedName(t);return n[t]=function(){return ifEdge(this,r.get)},r.mult?n[a]=function(){return ifEdgeRenderedPositions(this,r.get)}:n[a]=function(){return ifEdgeRenderedPosition(this,r.get)},n},{}),dimensions=extend({},position,bounds,widthHeight,edgePoints);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var Event=function(t,r){this.recycle(t,r)};function returnFalse(){return!1}function returnTrue(){return!0}Event.prototype={instanceString:function(){return"event"},recycle:function(t,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=returnFalse,t!=null&&t.preventDefault?(this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?returnTrue:returnFalse):t!=null&&t.type?r=t:this.type=t,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var a=this.position,o=this.cy.zoom(),u=this.cy.pan();this.renderedPosition={x:a.x*o+u.x,y:a.y*o+u.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=returnTrue;var t=this.originalEvent;t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.isPropagationStopped=returnTrue;var t=this.originalEvent;t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var eventRegex=/^([^.]+)(\.(?:[^.]+))?$/,universalNamespace=".*",defaults$8={qualifierCompare:function(t,r){return t===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(t){return t},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},defaultsKeys=Object.keys(defaults$8),emptyOpts={};function Emitter(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:emptyOpts,t=arguments.length>1?arguments[1]:void 0,r=0;r<defaultsKeys.length;r++){var a=defaultsKeys[r];this[a]=n[a]||defaults$8[a]}this.context=t||this.context,this.listeners=[],this.emitting=0}var p=Emitter.prototype,forEachEvent=function(t,r,a,o,u,s,c){fn$6(o)&&(u=o,o=null),c&&(s==null?s=c:s=extend({},s,c));for(var l=array(a)?a:a.split(/\s+/),d=0;d<l.length;d++){var f=l[d];if(!emptyString(f)){var h=f.match(eventRegex);if(h){var v=h[1],g=h[2]?h[2]:null,b=r(t,f,v,g,o,u,s);if(b===!1)break}}}},makeEventObj=function(t,r){return t.addEventFields(t.context,r),new Event(r.type,r)},forEachEventObj=function(t,r,a){if(event(a)){r(t,a);return}else if(plainObject(a)){r(t,makeEventObj(t,a));return}for(var o=array(a)?a:a.split(/\s+/),u=0;u<o.length;u++){var s=o[u];if(!emptyString(s)){var c=s.match(eventRegex);if(c){var l=c[1],d=c[2]?c[2]:null,f=makeEventObj(t,{type:l,namespace:d,target:t.context});r(t,f)}}}};p.on=p.addListener=function(n,t,r,a,o){return forEachEvent(this,function(u,s,c,l,d,f,h){fn$6(f)&&u.listeners.push({event:s,callback:f,type:c,namespace:l,qualifier:d,conf:h})},n,t,r,a,o),this};p.one=function(n,t,r,a){return this.on(n,t,r,a,{one:!0})};p.removeListener=p.off=function(n,t,r,a){var o=this;this.emitting!==0&&(this.listeners=copyArray$1(this.listeners));for(var u=this.listeners,s=function(d){var f=u[d];forEachEvent(o,function(h,v,g,b,_,S){if((f.type===g||n==="*")&&(!b&&f.namespace!==".*"||f.namespace===b)&&(!_||h.qualifierCompare(f.qualifier,_))&&(!S||f.callback===S))return u.splice(d,1),!1},n,t,r,a)},c=u.length-1;c>=0;c--)s(c);return this};p.removeAllListeners=function(){return this.removeListener("*")};p.emit=p.trigger=function(n,t,r){var a=this.listeners,o=a.length;return this.emitting++,array(t)||(t=[t]),forEachEventObj(this,function(u,s){r!=null&&(a=[{event:s.event,type:s.type,namespace:s.namespace,callback:r}],o=a.length);for(var c=function(f){var h=a[f];if(h.type===s.type&&(!h.namespace||h.namespace===s.namespace||h.namespace===universalNamespace)&&u.eventMatches(u.context,h,s)){var v=[s];t!=null&&push(v,t),u.beforeEmit(u.context,h,s),h.conf&&h.conf.one&&(u.listeners=u.listeners.filter(function(_){return _!==h}));var g=u.callbackContext(u.context,h,s),b=h.callback.apply(g,v);u.afterEmit(u.context,h,s),b===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<o;l++)c(l);u.bubble(u.context)&&!s.isPropagationStopped()&&u.parent(u.context).emit(s,t)},n),this.emitting--,this};var emitterOptions$1={qualifierCompare:function(t,r){return t==null||r==null?t==null&&r==null:t.sameText(r)},eventMatches:function(t,r,a){var o=r.qualifier;return o!=null?t!==a.target&&element(a.target)&&o.matches(a.target):!0},addEventFields:function(t,r){r.cy=t.cy(),r.target=t},callbackContext:function(t,r,a){return r.qualifier!=null?a.target:t},beforeEmit:function(t,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(t){return t.isChild()?t.parent():t.cy()}},argSelector$1=function(t){return string(t)?new Selector(t):t},elesfn$9={createEmitter:function(){for(var t=0;t<this.length;t++){var r=this[t],a=r._private;a.emitter||(a.emitter=new Emitter(emitterOptions$1,r))}return this},emitter:function(){return this._private.emitter},on:function(t,r,a){for(var o=argSelector$1(r),u=0;u<this.length;u++){var s=this[u];s.emitter().on(t,o,a)}return this},removeListener:function(t,r,a){for(var o=argSelector$1(r),u=0;u<this.length;u++){var s=this[u];s.emitter().removeListener(t,o,a)}return this},removeAllListeners:function(){for(var t=0;t<this.length;t++){var r=this[t];r.emitter().removeAllListeners()}return this},one:function(t,r,a){for(var o=argSelector$1(r),u=0;u<this.length;u++){var s=this[u];s.emitter().one(t,o,a)}return this},once:function(t,r,a){for(var o=argSelector$1(r),u=0;u<this.length;u++){var s=this[u];s.emitter().on(t,o,a,{once:!0,onceCollection:this})}},emit:function(t,r){for(var a=0;a<this.length;a++){var o=this[a];o.emitter().emit(t,r)}return this},emitAndNotify:function(t,r){if(this.length!==0)return this.cy().notify(t,this),this.emit(t,r),this}};define.eventAliasesOn(elesfn$9);var elesfn$8={nodes:function(t){return this.filter(function(r){return r.isNode()}).filter(t)},edges:function(t){return this.filter(function(r){return r.isEdge()}).filter(t)},byGroup:function(){for(var t=this.spawn(),r=this.spawn(),a=0;a<this.length;a++){var o=this[a];o.isNode()?t.push(o):r.push(o)}return{nodes:t,edges:r}},filter:function(t,r){if(t===void 0)return this;if(string(t)||elementOrCollection(t))return new Selector(t).filter(this);if(fn$6(t)){for(var a=this.spawn(),o=this,u=0;u<o.length;u++){var s=o[u],c=r?t.apply(r,[s,u,o]):t(s,u,o);c&&a.push(s)}return a}return this.spawn()},not:function(t){if(t){string(t)&&(t=this.filter(t));for(var r=this.spawn(),a=0;a<this.length;a++){var o=this[a],u=t.has(o);u||r.push(o)}return r}else return this},absoluteComplement:function(){var t=this.cy();return t.mutableElements().not(this)},intersect:function(t){if(string(t)){var r=t;return this.filter(r)}for(var a=this.spawn(),o=this,u=t,s=this.length<t.length,c=s?o:u,l=s?u:o,d=0;d<c.length;d++){var f=c[d];l.has(f)&&a.push(f)}return a},xor:function(t){var r=this._private.cy;string(t)&&(t=r.$(t));var a=this.spawn(),o=this,u=t,s=function(l,d){for(var f=0;f<l.length;f++){var h=l[f],v=h._private.data.id,g=d.hasElementWithId(v);g||a.push(h)}};return s(o,u),s(u,o),a},diff:function(t){var r=this._private.cy;string(t)&&(t=r.$(t));var a=this.spawn(),o=this.spawn(),u=this.spawn(),s=this,c=t,l=function(f,h,v){for(var g=0;g<f.length;g++){var b=f[g],_=b._private.data.id,S=h.hasElementWithId(_);S?u.merge(b):v.push(b)}};return l(s,c,a),l(c,s,o),{left:a,right:o,both:u}},add:function(t){var r=this._private.cy;if(!t)return this;if(string(t)){var a=t;t=r.mutableElements().filter(a)}for(var o=this.spawnSelf(),u=0;u<t.length;u++){var s=t[u],c=!this.has(s);c&&o.push(s)}return o},merge:function(t){var r=this._private,a=r.cy;if(!t)return this;if(t&&string(t)){var o=t;t=a.mutableElements().filter(o)}for(var u=r.map,s=0;s<t.length;s++){var c=t[s],l=c._private.data.id,d=!u.has(l);if(d){var f=this.length++;this[f]=c,u.set(l,{ele:c,index:f})}}return this},unmergeAt:function(t){var r=this[t],a=r.id(),o=this._private,u=o.map;this[t]=void 0,u.delete(a);var s=t===this.length-1;if(this.length>1&&!s){var c=this.length-1,l=this[c],d=l._private.data.id;this[c]=void 0,this[t]=l,u.set(d,{ele:l,index:t})}return this.length--,this},unmergeOne:function(t){t=t[0];var r=this._private,a=t._private.data.id,o=r.map,u=o.get(a);if(!u)return this;var s=u.index;return this.unmergeAt(s),this},unmerge:function(t){var r=this._private.cy;if(!t)return this;if(t&&string(t)){var a=t;t=r.mutableElements().filter(a)}for(var o=0;o<t.length;o++)this.unmergeOne(t[o]);return this},unmergeBy:function(t){for(var r=this.length-1;r>=0;r--){var a=this[r];t(a)&&this.unmergeAt(r)}return this},map:function(t,r){for(var a=[],o=this,u=0;u<o.length;u++){var s=o[u],c=r?t.apply(r,[s,u,o]):t(s,u,o);a.push(c)}return a},reduce:function(t,r){for(var a=r,o=this,u=0;u<o.length;u++)a=t(a,o[u],u,o);return a},max:function(t,r){for(var a=-1/0,o,u=this,s=0;s<u.length;s++){var c=u[s],l=r?t.apply(r,[c,s,u]):t(c,s,u);l>a&&(a=l,o=c)}return{value:a,ele:o}},min:function(t,r){for(var a=1/0,o,u=this,s=0;s<u.length;s++){var c=u[s],l=r?t.apply(r,[c,s,u]):t(c,s,u);l<a&&(a=l,o=c)}return{value:a,ele:o}}},fn$1=elesfn$8;fn$1.u=fn$1["|"]=fn$1["+"]=fn$1.union=fn$1.or=fn$1.add;fn$1["\\"]=fn$1["!"]=fn$1["-"]=fn$1.difference=fn$1.relativeComplement=fn$1.subtract=fn$1.not;fn$1.n=fn$1["&"]=fn$1["."]=fn$1.and=fn$1.intersection=fn$1.intersect;fn$1["^"]=fn$1["(+)"]=fn$1["(-)"]=fn$1.symmetricDifference=fn$1.symdiff=fn$1.xor;fn$1.fnFilter=fn$1.filterFn=fn$1.stdFilter=fn$1.filter;fn$1.complement=fn$1.abscomp=fn$1.absoluteComplement;var elesfn$7={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var t=this[0];if(t)return t._private.group}},zIndexSort=function(t,r){var a=t.cy(),o=a.hasCompoundNodes();function u(f){var h=f.pstyle("z-compound-depth");return h.value==="auto"?o?f.zDepth():0:h.value==="bottom"?-1:h.value==="top"?MAX_INT$1:0}var s=u(t)-u(r);if(s!==0)return s;function c(f){var h=f.pstyle("z-index-compare");return h.value==="auto"&&f.isNode()?1:0}var l=c(t)-c(r);if(l!==0)return l;var d=t.pstyle("z-index").value-r.pstyle("z-index").value;return d!==0?d:t.poolIndex()-r.poolIndex()},elesfn$6={forEach:function(t,r){if(fn$6(t))for(var a=this.length,o=0;o<a;o++){var u=this[o],s=r?t.apply(r,[u,o,this]):t(u,o,this);if(s===!1)break}return this},toArray:function(){for(var t=[],r=0;r<this.length;r++)t.push(this[r]);return t},slice:function(t,r){var a=[],o=this.length;r==null&&(r=o),t==null&&(t=0),t<0&&(t=o+t),r<0&&(r=o+r);for(var u=t;u>=0&&u<r&&u<o;u++)a.push(this[u]);return this.spawn(a)},size:function(){return this.length},eq:function(t){return this[t]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(t){if(!fn$6(t))return this;var r=this.toArray().sort(t);return this.spawn(r)},sortByZIndex:function(){return this.sort(zIndexSort)},zDepth:function(){var t=this[0];if(t){var r=t._private,a=r.group;if(a==="nodes"){var o=r.data.parent?t.parents().size():0;return t.isParent()?o:MAX_INT$1-1}else{var u=r.source,s=r.target,c=u.zDepth(),l=s.zDepth();return Math.max(c,l,0)}}}};elesfn$6.each=elesfn$6.forEach;var defineSymbolIterator=function(){var t="undefined",r=(typeof Symbol>"u"?"undefined":_typeof(Symbol))!=t&&_typeof(Symbol.iterator)!=t;r&&(elesfn$6[Symbol.iterator]=function(){var a=this,o={value:void 0,done:!1},u=0,s=this.length;return _defineProperty$1({next:function(){return u<s?o.value=a[u++]:(o.value=void 0,o.done=!0),o}},Symbol.iterator,function(){return this})})};defineSymbolIterator();var getLayoutDimensionOptions=defaults$g({nodeDimensionsIncludeLabels:!1}),elesfn$5={layoutDimensions:function(t){t=getLayoutDimensionOptions(t);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(t.nodeDimensionsIncludeLabels){var a=this.boundingBox();r={w:a.w,h:a.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(t,r,a){var o=this.nodes().filter(function(E){return!E.isParent()}),u=this.cy(),s=r.eles,c=function(I){return I.id()},l=memoize$1(a,c);t.emit({type:"layoutstart",layout:t}),t.animations=[];var d=function(I,L,F){var D={x:L.x1+L.w/2,y:L.y1+L.h/2},$={x:(F.x-D.x)*I,y:(F.y-D.y)*I};return{x:D.x+$.x,y:D.y+$.y}},f=r.spacingFactor&&r.spacingFactor!==1,h=function(){if(!f)return null;for(var I=makeBoundingBox(),L=0;L<o.length;L++){var F=o[L],D=l(F,L);expandBoundingBoxByPoint(I,D.x,D.y)}return I},v=h(),g=memoize$1(function(E,I){var L=l(E,I);if(f){var F=Math.abs(r.spacingFactor);L=d(F,v,L)}return r.transform!=null&&(L=r.transform(E,L)),L},c);if(r.animate){for(var b=0;b<o.length;b++){var _=o[b],S=g(_,b),T=r.animateFilter==null||r.animateFilter(_,b);if(T){var w=_.animation({position:S,duration:r.animationDuration,easing:r.animationEasing});t.animations.push(w)}else _.position(S)}if(r.fit){var A=u.animation({fit:{boundingBox:s.boundingBoxAt(g),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});t.animations.push(A)}else if(r.zoom!==void 0&&r.pan!==void 0){var R=u.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});t.animations.push(R)}t.animations.forEach(function(E){return E.play()}),t.one("layoutready",r.ready),t.emit({type:"layoutready",layout:t}),Promise$1.all(t.animations.map(function(E){return E.promise()})).then(function(){t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t})})}else o.positions(g),r.fit&&u.fit(r.eles,r.padding),r.zoom!=null&&u.zoom(r.zoom),r.pan&&u.pan(r.pan),t.one("layoutready",r.ready),t.emit({type:"layoutready",layout:t}),t.one("layoutstop",r.stop),t.emit({type:"layoutstop",layout:t});return this},layout:function(t){var r=this.cy();return r.makeLayout(extend({},t,{eles:this}))}};elesfn$5.createLayout=elesfn$5.makeLayout=elesfn$5.layout;function styleCache(n,t,r){var a=r._private,o=a.styleCache=a.styleCache||[],u;return(u=o[n])!=null||(u=o[n]=t(r)),u}function cacheStyleFunction(n,t){return n=hashString(n),function(a){return styleCache(n,t,a)}}function cachePrototypeStyleFunction(n,t){n=hashString(n);var r=function(o){return t.call(o)};return function(){var o=this[0];if(o)return styleCache(n,r,o)}}var elesfn$4={recalculateRenderedStyle:function(t){var r=this.cy(),a=r.renderer(),o=r.styleEnabled();return a&&o&&a.recalculateRenderedStyle(this,t),this},dirtyStyleCache:function(){var t=this.cy(),r=function(u){return u._private.styleCache=null};if(t.hasCompoundNodes()){var a;a=this.spawnSelf().merge(this.descendants()).merge(this.parents()),a.merge(a.connectedEdges()),a.forEach(r)}else this.forEach(function(o){r(o),o.connectedEdges().forEach(r)});return this},updateStyle:function(t){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var a=r._private.batchStyleEles;return a.merge(this),this}var o=r.hasCompoundNodes(),u=this;t=!!(t||t===void 0),o&&(u=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=u;return t?s.emitAndNotify("style"):s.emit("style"),u.forEach(function(c){return c._private.styleDirty=!0}),this},cleanStyle:function(){var t=this.cy();if(t.styleEnabled())for(var r=0;r<this.length;r++){var a=this[r];a._private.styleDirty&&(a._private.styleDirty=!1,t.style().apply(a))}},parsedStyle:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=this[0],o=a.cy();if(o.styleEnabled()&&a){a._private.styleDirty&&(a._private.styleDirty=!1,o.style().apply(a));var u=a._private.style[t];return u??(r?o.style().getDefaultProperty(t):null)}},numericStyle:function(t){var r=this[0];if(r.cy().styleEnabled()&&r){var a=r.pstyle(t);return a.pfValue!==void 0?a.pfValue:a.value}},numericStyleUnits:function(t){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(t).units},renderedStyle:function(t){var r=this.cy();if(!r.styleEnabled())return this;var a=this[0];if(a)return r.style().getRenderedStyle(a,t)},style:function(t,r){var a=this.cy();if(!a.styleEnabled())return this;var o=!1,u=a.style();if(plainObject(t)){var s=t;u.applyBypass(this,s,o),this.emitAndNotify("style")}else if(string(t))if(r===void 0){var c=this[0];return c?u.getStylePropertyValue(c,t):void 0}else u.applyBypass(this,t,r,o),this.emitAndNotify("style");else if(t===void 0){var l=this[0];return l?u.getRawStyle(l):void 0}return this},removeStyle:function(t){var r=this.cy();if(!r.styleEnabled())return this;var a=!1,o=r.style(),u=this;if(t===void 0)for(var s=0;s<u.length;s++){var c=u[s];o.removeAllBypasses(c,a)}else{t=t.split(/\s+/);for(var l=0;l<u.length;l++){var d=u[l];o.removeBypasses(d,t,a)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var t=this.cy();if(!t.styleEnabled())return 1;var r=t.hasCompoundNodes(),a=this[0];if(a){var o=a._private,u=a.pstyle("opacity").value;if(!r)return u;var s=o.data.parent?a.parents():null;if(s)for(var c=0;c<s.length;c++){var l=s[c],d=l.pstyle("opacity").value;u=d*u}return u}},transparent:function(){var t=this.cy();if(!t.styleEnabled())return!1;var r=this[0],a=r.cy().hasCompoundNodes();if(r)return a?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var t=this.cy();if(!t.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function checkCompound(n,t){var r=n._private,a=r.data.parent?n.parents():null;if(a)for(var o=0;o<a.length;o++){var u=a[o];if(!t(u))return!1}return!0}function defineDerivedStateFunction(n){var t=n.ok,r=n.edgeOkViaNode||n.ok,a=n.parentOk||n.ok;return function(){var o=this.cy();if(!o.styleEnabled())return!0;var u=this[0],s=o.hasCompoundNodes();if(u){var c=u._private;if(!t(u))return!1;if(u.isNode())return!s||checkCompound(u,a);var l=c.source,d=c.target;return r(l)&&(!s||checkCompound(l,r))&&(l===d||r(d)&&(!s||checkCompound(d,r)))}}}var eleTakesUpSpace=cacheStyleFunction("eleTakesUpSpace",function(n){return n.pstyle("display").value==="element"&&n.width()!==0&&(n.isNode()?n.height()!==0:!0)});elesfn$4.takesUpSpace=cachePrototypeStyleFunction("takesUpSpace",defineDerivedStateFunction({ok:eleTakesUpSpace}));var eleInteractive=cacheStyleFunction("eleInteractive",function(n){return n.pstyle("events").value==="yes"&&n.pstyle("visibility").value==="visible"&&eleTakesUpSpace(n)}),parentInteractive=cacheStyleFunction("parentInteractive",function(n){return n.pstyle("visibility").value==="visible"&&eleTakesUpSpace(n)});elesfn$4.interactive=cachePrototypeStyleFunction("interactive",defineDerivedStateFunction({ok:eleInteractive,parentOk:parentInteractive,edgeOkViaNode:eleTakesUpSpace}));elesfn$4.noninteractive=function(){var n=this[0];if(n)return!n.interactive()};var eleVisible=cacheStyleFunction("eleVisible",function(n){return n.pstyle("visibility").value==="visible"&&n.pstyle("opacity").pfValue!==0&&eleTakesUpSpace(n)}),edgeVisibleViaNode=eleTakesUpSpace;elesfn$4.visible=cachePrototypeStyleFunction("visible",defineDerivedStateFunction({ok:eleVisible,edgeOkViaNode:edgeVisibleViaNode}));elesfn$4.hidden=function(){var n=this[0];if(n)return!n.visible()};elesfn$4.isBundledBezier=cachePrototypeStyleFunction("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});elesfn$4.bypass=elesfn$4.css=elesfn$4.style;elesfn$4.renderedCss=elesfn$4.renderedStyle;elesfn$4.removeBypass=elesfn$4.removeCss=elesfn$4.removeStyle;elesfn$4.pstyle=elesfn$4.parsedStyle;var elesfn$3={};function defineSwitchFunction(n){return function(){var t=arguments,r=[];if(t.length===2){var a=t[0],o=t[1];this.on(n.event,a,o)}else if(t.length===1&&fn$6(t[0])){var u=t[0];this.on(n.event,u)}else if(t.length===0||t.length===1&&array(t[0])){for(var s=t.length===1?t[0]:null,c=0;c<this.length;c++){var l=this[c],d=!n.ableField||l._private[n.ableField],f=l._private[n.field]!=n.value;if(n.overrideAble){var h=n.overrideAble(l);if(h!==void 0&&(d=h,!h))return this}d&&(l._private[n.field]=n.value,f&&r.push(l))}var v=this.spawn(r);v.updateStyle(),v.emit(n.event),s&&v.emit(s)}return this}}function defineSwitchSet(n){elesfn$3[n.field]=function(){var t=this[0];if(t){if(n.overrideField){var r=n.overrideField(t);if(r!==void 0)return r}return t._private[n.field]}},elesfn$3[n.on]=defineSwitchFunction({event:n.on,field:n.field,ableField:n.ableField,overrideAble:n.overrideAble,value:!0}),elesfn$3[n.off]=defineSwitchFunction({event:n.off,field:n.field,ableField:n.ableField,overrideAble:n.overrideAble,value:!1})}defineSwitchSet({field:"locked",overrideField:function(t){return t.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});defineSwitchSet({field:"grabbable",overrideField:function(t){return t.cy().autoungrabify()||t.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});defineSwitchSet({field:"selected",ableField:"selectable",overrideAble:function(t){return t.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});defineSwitchSet({field:"selectable",overrideField:function(t){return t.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});elesfn$3.deselect=elesfn$3.unselect;elesfn$3.grabbed=function(){var n=this[0];if(n)return n._private.grabbed};defineSwitchSet({field:"active",on:"activate",off:"unactivate"});defineSwitchSet({field:"pannable",on:"panify",off:"unpanify"});elesfn$3.inactive=function(){var n=this[0];if(n)return!n._private.active};var elesfn$2={},defineDagExtremity=function(t){return function(a){for(var o=this,u=[],s=0;s<o.length;s++){var c=o[s];if(c.isNode()){for(var l=!1,d=c.connectedEdges(),f=0;f<d.length;f++){var h=d[f],v=h.source(),g=h.target();if(t.noIncomingEdges&&g===c&&v!==c||t.noOutgoingEdges&&v===c&&g!==c){l=!0;break}}l||u.push(c)}}return this.spawn(u,!0).filter(a)}},defineDagOneHop=function(t){return function(r){for(var a=this,o=[],u=0;u<a.length;u++){var s=a[u];if(s.isNode())for(var c=s.connectedEdges(),l=0;l<c.length;l++){var d=c[l],f=d.source(),h=d.target();t.outgoing&&f===s?(o.push(d),o.push(h)):t.incoming&&h===s&&(o.push(d),o.push(f))}}return this.spawn(o,!0).filter(r)}},defineDagAllHops=function(t){return function(r){for(var a=this,o=[],u={};;){var s=t.outgoing?a.outgoers():a.incomers();if(s.length===0)break;for(var c=!1,l=0;l<s.length;l++){var d=s[l],f=d.id();u[f]||(u[f]=!0,o.push(d),c=!0)}if(!c)break;a=s}return this.spawn(o,!0).filter(r)}};elesfn$2.clearTraversalCache=function(){for(var n=0;n<this.length;n++)this[n]._private.traversalCache=null};extend(elesfn$2,{roots:defineDagExtremity({noIncomingEdges:!0}),leaves:defineDagExtremity({noOutgoingEdges:!0}),outgoers:cache(defineDagOneHop({outgoing:!0}),"outgoers"),successors:defineDagAllHops({outgoing:!0}),incomers:cache(defineDagOneHop({incoming:!0}),"incomers"),predecessors:defineDagAllHops({})});extend(elesfn$2,{neighborhood:cache(function(n){for(var t=[],r=this.nodes(),a=0;a<r.length;a++)for(var o=r[a],u=o.connectedEdges(),s=0;s<u.length;s++){var c=u[s],l=c.source(),d=c.target(),f=o===l?d:l;f.length>0&&t.push(f[0]),t.push(c[0])}return this.spawn(t,!0).filter(n)},"neighborhood"),closedNeighborhood:function(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function(t){return this.neighborhood(t)}});elesfn$2.neighbourhood=elesfn$2.neighborhood;elesfn$2.closedNeighbourhood=elesfn$2.closedNeighborhood;elesfn$2.openNeighbourhood=elesfn$2.openNeighborhood;extend(elesfn$2,{source:cache(function(t){var r=this[0],a;return r&&(a=r._private.source||r.cy().collection()),a&&t?a.filter(t):a},"source"),target:cache(function(t){var r=this[0],a;return r&&(a=r._private.target||r.cy().collection()),a&&t?a.filter(t):a},"target"),sources:defineSourceFunction({attr:"source"}),targets:defineSourceFunction({attr:"target"})});function defineSourceFunction(n){return function(r){for(var a=[],o=0;o<this.length;o++){var u=this[o],s=u._private[n.attr];s&&a.push(s)}return this.spawn(a,!0).filter(r)}}extend(elesfn$2,{edgesWith:cache(defineEdgesWithFunction(),"edgesWith"),edgesTo:cache(defineEdgesWithFunction({thisIsSrc:!0}),"edgesTo")});function defineEdgesWithFunction(n){return function(r){var a=[],o=this._private.cy,u=n||{};string(r)&&(r=o.$(r));for(var s=0;s<r.length;s++)for(var c=r[s]._private.edges,l=0;l<c.length;l++){var d=c[l],f=d._private.data,h=this.hasElementWithId(f.source)&&r.hasElementWithId(f.target),v=r.hasElementWithId(f.source)&&this.hasElementWithId(f.target),g=h||v;g&&((u.thisIsSrc||u.thisIsTgt)&&(u.thisIsSrc&&!h||u.thisIsTgt&&!v)||a.push(d))}return this.spawn(a,!0)}}extend(elesfn$2,{connectedEdges:cache(function(n){for(var t=[],r=this,a=0;a<r.length;a++){var o=r[a];if(o.isNode())for(var u=o._private.edges,s=0;s<u.length;s++){var c=u[s];t.push(c)}}return this.spawn(t,!0).filter(n)},"connectedEdges"),connectedNodes:cache(function(n){for(var t=[],r=this,a=0;a<r.length;a++){var o=r[a];o.isEdge()&&(t.push(o.source()[0]),t.push(o.target()[0]))}return this.spawn(t,!0).filter(n)},"connectedNodes"),parallelEdges:cache(defineParallelEdgesFunction(),"parallelEdges"),codirectedEdges:cache(defineParallelEdgesFunction({codirected:!0}),"codirectedEdges")});function defineParallelEdgesFunction(n){var t={codirected:!1};return n=extend({},t,n),function(a){for(var o=[],u=this.edges(),s=n,c=0;c<u.length;c++)for(var l=u[c],d=l._private,f=d.source,h=f._private.data.id,v=d.data.target,g=f._private.edges,b=0;b<g.length;b++){var _=g[b],S=_._private.data,T=S.target,w=S.source,A=T===v&&w===h,R=h===T&&v===w;(s.codirected&&A||!s.codirected&&(A||R))&&o.push(_)}return this.spawn(o,!0).filter(a)}}extend(elesfn$2,{components:function(t){var r=this,a=r.cy(),o=a.collection(),u=t==null?r.nodes():t.nodes(),s=[];t!=null&&u.empty()&&(u=t.sources());var c=function(f,h){o.merge(f),u.unmerge(f),h.merge(f)};if(u.empty())return r.spawn();var l=function(){var f=a.collection();s.push(f);var h=u[0];c(h,f),r.bfs({directed:!1,roots:h,visit:function(g){return c(g,f)}}),f.forEach(function(v){v.connectedEdges().forEach(function(g){r.has(g)&&f.has(g.source())&&f.has(g.target())&&f.merge(g)})})};do l();while(u.length>0);return s},component:function(){var t=this[0];return t.cy().mutableElements().components(t)[0]}});elesfn$2.componentsOf=elesfn$2.components;var Collection=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t===void 0){error("A collection must have a reference to the core");return}var u=new Map$2,s=!1;if(!r)r=[];else if(r.length>0&&plainObject(r[0])&&!element(r[0])){s=!0;for(var c=[],l=new Set$1,d=0,f=r.length;d<f;d++){var h=r[d];h.data==null&&(h.data={});var v=h.data;if(v.id==null)v.id=uuid();else if(t.hasElementWithId(v.id)||l.has(v.id))continue;var g=new Element$1(t,h,!1);c.push(g),l.add(v.id)}r=c}this.length=0;for(var b=0,_=r.length;b<_;b++){var S=r[b][0];if(S!=null){var T=S._private.data.id;(!a||!u.has(T))&&(a&&u.set(T,{index:this.length,ele:S}),this[this.length]=S,this.length++)}}this._private={eles:this,cy:t,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(w){this.lazyMap=w},rebuildMap:function(){for(var A=this.lazyMap=new Map$2,R=this.eles,E=0;E<R.length;E++){var I=R[E];A.set(I.id(),{index:E,ele:I})}}},a&&(this._private.map=u),s&&!o&&this.restore()},elesfn$1=Element$1.prototype=Collection.prototype=Object.create(Array.prototype);elesfn$1.instanceString=function(){return"collection"};elesfn$1.spawn=function(n,t){return new Collection(this.cy(),n,t)};elesfn$1.spawnSelf=function(){return this.spawn(this)};elesfn$1.cy=function(){return this._private.cy};elesfn$1.renderer=function(){return this._private.cy.renderer()};elesfn$1.element=function(){return this[0]};elesfn$1.collection=function(){return collection(this)?this:new Collection(this._private.cy,[this])};elesfn$1.unique=function(){return new Collection(this._private.cy,this,!0)};elesfn$1.hasElementWithId=function(n){return n=""+n,this._private.map.has(n)};elesfn$1.getElementById=function(n){n=""+n;var t=this._private.cy,r=this._private.map.get(n);return r?r.ele:new Collection(t)};elesfn$1.$id=elesfn$1.getElementById;elesfn$1.poolIndex=function(){var n=this._private.cy,t=n._private.elements,r=this[0]._private.data.id;return t._private.map.get(r).index};elesfn$1.indexOf=function(n){var t=n[0]._private.data.id;return this._private.map.get(t).index};elesfn$1.indexOfId=function(n){return n=""+n,this._private.map.get(n).index};elesfn$1.json=function(n){var t=this.element(),r=this.cy();if(t==null&&n)return this;if(t!=null){var a=t._private;if(plainObject(n)){if(r.startBatch(),n.data){t.data(n.data);var o=a.data;if(t.isEdge()){var u=!1,s={},c=n.data.source,l=n.data.target;c!=null&&c!=o.source&&(s.source=""+c,u=!0),l!=null&&l!=o.target&&(s.target=""+l,u=!0),u&&(t=t.move(s))}else{var d="parent"in n.data,f=n.data.parent;d&&(f!=null||o.parent!=null)&&f!=o.parent&&(f===void 0&&(f=null),f!=null&&(f=""+f),t=t.move({parent:f}))}}n.position&&t.position(n.position);var h=function(_,S,T){var w=n[_];w!=null&&w!==a[_]&&(w?t[S]():t[T]())};return h("removed","remove","restore"),h("selected","select","unselect"),h("selectable","selectify","unselectify"),h("locked","lock","unlock"),h("grabbable","grabify","ungrabify"),h("pannable","panify","unpanify"),n.classes!=null&&t.classes(n.classes),r.endBatch(),this}else if(n===void 0){var v={data:copy(a.data),position:copy(a.position),group:a.group,removed:a.removed,selected:a.selected,selectable:a.selectable,locked:a.locked,grabbable:a.grabbable,pannable:a.pannable,classes:null};v.classes="";var g=0;return a.classes.forEach(function(b){return v.classes+=g++===0?b:" "+b}),v}}};elesfn$1.jsons=function(){for(var n=[],t=0;t<this.length;t++){var r=this[t],a=r.json();n.push(a)}return n};elesfn$1.clone=function(){for(var n=this.cy(),t=[],r=0;r<this.length;r++){var a=this[r],o=a.json(),u=new Element$1(n,o,!1);t.push(u)}return new Collection(n,t)};elesfn$1.copy=elesfn$1.clone;elesfn$1.restore=function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,a=r.cy(),o=a._private,u=[],s=[],c,l=0,d=r.length;l<d;l++){var f=r[l];t&&!f.removed()||(f.isNode()?u.push(f):s.push(f))}c=u.concat(s);var h,v=function(){c.splice(h,1),h--};for(h=0;h<c.length;h++){var g=c[h],b=g._private,_=b.data;if(g.clearTraversalCache(),!(!t&&!b.removed)){if(_.id===void 0)_.id=uuid();else if(number$1(_.id))_.id=""+_.id;else if(emptyString(_.id)||!string(_.id)){error("Can not create element with invalid string ID `"+_.id+"`"),v();continue}else if(a.hasElementWithId(_.id)){error("Can not create second element with ID `"+_.id+"`"),v();continue}}var S=_.id;if(g.isNode()){var T=b.position;T.x==null&&(T.x=0),T.y==null&&(T.y=0)}if(g.isEdge()){for(var w=g,A=["source","target"],R=A.length,E=!1,I=0;I<R;I++){var L=A[I],F=_[L];number$1(F)&&(F=_[L]=""+_[L]),F==null||F===""?(error("Can not create edge `"+S+"` with unspecified "+L),E=!0):a.hasElementWithId(F)||(error("Can not create edge `"+S+"` with nonexistant "+L+" `"+F+"`"),E=!0)}if(E){v();continue}var D=a.getElementById(_.source),$=a.getElementById(_.target);D.same($)?D._private.edges.push(w):(D._private.edges.push(w),$._private.edges.push(w)),w._private.source=D,w._private.target=$}b.map=new Map$2,b.map.set(S,{ele:g,index:0}),b.removed=!1,t&&a.addToPool(g)}for(var O=0;O<u.length;O++){var P=u[O],C=P._private.data;number$1(C.parent)&&(C.parent=""+C.parent);var q=C.parent,M=q!=null;if(M||P._private.parent){var N=P._private.parent?a.collection().merge(P._private.parent):a.getElementById(q);if(N.empty())C.parent=void 0;else if(N[0].removed())warn("Node added with missing parent, reference to parent removed"),C.parent=void 0,P._private.parent=null;else{for(var G=!1,X=N;!X.empty();){if(P.same(X)){G=!0,C.parent=void 0;break}X=X.parent()}G||(N[0]._private.children.push(P),P._private.parent=N[0],o.hasCompoundNodes=!0)}}}if(c.length>0){for(var Y=c.length===r.length?r:new Collection(a,c),W=0;W<Y.length;W++){var te=Y[W];te.isNode()||(te.parallelEdges().clearTraversalCache(),te.source().clearTraversalCache(),te.target().clearTraversalCache())}var ue;o.hasCompoundNodes?ue=a.collection().merge(Y).merge(Y.connectedNodes()).merge(Y.parent()):ue=Y,ue.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(n),n?Y.emitAndNotify("add"):t&&Y.emit("add")}return r};elesfn$1.removed=function(){var n=this[0];return n&&n._private.removed};elesfn$1.inside=function(){var n=this[0];return n&&!n._private.removed};elesfn$1.remove=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,a=[],o={},u=r._private.cy;function s(q){for(var M=q._private.edges,N=0;N<M.length;N++)l(M[N])}function c(q){for(var M=q._private.children,N=0;N<M.length;N++)l(M[N])}function l(q){var M=o[q.id()];t&&q.removed()||M||(o[q.id()]=!0,q.isNode()?(a.push(q),s(q),c(q)):a.unshift(q))}for(var d=0,f=r.length;d<f;d++){var h=r[d];l(h)}function v(q,M){var N=q._private.edges;removeFromArray(N,M),q.clearTraversalCache()}function g(q){q.clearTraversalCache()}var b=[];b.ids={};function _(q,M){M=M[0],q=q[0];var N=q._private.children,G=q.id();removeFromArray(N,M),M._private.parent=null,b.ids[G]||(b.ids[G]=!0,b.push(q))}r.dirtyCompoundBoundsCache(),t&&u.removeFromPool(a);for(var S=0;S<a.length;S++){var T=a[S];if(T.isEdge()){var w=T.source()[0],A=T.target()[0];v(w,T),v(A,T);for(var R=T.parallelEdges(),E=0;E<R.length;E++){var I=R[E];g(I),I.isBundledBezier()&&I.dirtyBoundingBoxCache()}}else{var L=T.parent();L.length!==0&&_(L,T)}t&&(T._private.removed=!0)}var F=u._private.elements;u._private.hasCompoundNodes=!1;for(var D=0;D<F.length;D++){var $=F[D];if($.isParent()){u._private.hasCompoundNodes=!0;break}}var O=new Collection(this.cy(),a);O.size()>0&&(n?O.emitAndNotify("remove"):t&&O.emit("remove"));for(var P=0;P<b.length;P++){var C=b[P];(!t||!C.removed())&&C.updateStyle()}return O};elesfn$1.move=function(n){var t=this._private.cy,r=this,a=!1,o=!1,u=function(b){return b==null?b:""+b};if(n.source!==void 0||n.target!==void 0){var s=u(n.source),c=u(n.target),l=s!=null&&t.hasElementWithId(s),d=c!=null&&t.hasElementWithId(c);(l||d)&&(t.batch(function(){r.remove(a,o),r.emitAndNotify("moveout");for(var g=0;g<r.length;g++){var b=r[g],_=b._private.data;b.isEdge()&&(l&&(_.source=s),d&&(_.target=c))}r.restore(a,o)}),r.emitAndNotify("move"))}else if(n.parent!==void 0){var f=u(n.parent),h=f===null||t.hasElementWithId(f);if(h){var v=f===null?void 0:f;t.batch(function(){var g=r.remove(a,o);g.emitAndNotify("moveout");for(var b=0;b<r.length;b++){var _=r[b],S=_._private.data;_.isNode()&&(S.parent=v)}g.restore(a,o)}),r.emitAndNotify("move")}}return this};[elesfn$j,elesfn$i,elesfn$h,elesfn$g,elesfn$f,data,elesfn$d,dimensions,elesfn$9,elesfn$8,elesfn$7,elesfn$6,elesfn$5,elesfn$4,elesfn$3,elesfn$2].forEach(function(n){extend(elesfn$1,n)});var corefn$9={add:function(t){var r,a=this;if(elementOrCollection(t)){var o=t;if(o._private.cy===a)r=o.restore();else{for(var u=[],s=0;s<o.length;s++){var c=o[s];u.push(c.json())}r=new Collection(a,u)}}else if(array(t)){var l=t;r=new Collection(a,l)}else if(plainObject(t)&&(array(t.nodes)||array(t.edges))){for(var d=t,f=[],h=["nodes","edges"],v=0,g=h.length;v<g;v++){var b=h[v],_=d[b];if(array(_))for(var S=0,T=_.length;S<T;S++){var w=extend({group:b},_[S]);f.push(w)}}r=new Collection(a,f)}else{var A=t;r=new Element$1(a,A).collection()}return r},remove:function(t){if(!elementOrCollection(t)){if(string(t)){var r=t;t=this.$(r)}}return t.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function generateCubicBezier(n,t,r,a){var o=4,u=.001,s=1e-7,c=10,l=11,d=1/(l-1),f=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var h=0;h<4;++h)if(typeof arguments[h]!="number"||isNaN(arguments[h])||!isFinite(arguments[h]))return!1;n=Math.min(n,1),r=Math.min(r,1),n=Math.max(n,0),r=Math.max(r,0);var v=f?new Float32Array(l):new Array(l);function g($,O){return 1-3*O+3*$}function b($,O){return 3*O-6*$}function _($){return 3*$}function S($,O,P){return((g(O,P)*$+b(O,P))*$+_(O))*$}function T($,O,P){return 3*g(O,P)*$*$+2*b(O,P)*$+_(O)}function w($,O){for(var P=0;P<o;++P){var C=T(O,n,r);if(C===0)return O;var q=S(O,n,r)-$;O-=q/C}return O}function A(){for(var $=0;$<l;++$)v[$]=S($*d,n,r)}function R($,O,P){var C,q,M=0;do q=O+(P-O)/2,C=S(q,n,r)-$,C>0?P=q:O=q;while(Math.abs(C)>s&&++M<c);return q}function E($){for(var O=0,P=1,C=l-1;P!==C&&v[P]<=$;++P)O+=d;--P;var q=($-v[P])/(v[P+1]-v[P]),M=O+q*d,N=T(M,n,r);return N>=u?w($,M):N===0?M:R($,O,O+d)}var I=!1;function L(){I=!0,(n!==t||r!==a)&&A()}var F=function(O){return I||L(),n===t&&r===a?O:O===0?0:O===1?1:S(E(O),t,a)};F.getControlPoints=function(){return[{x:n,y:t},{x:r,y:a}]};var D="generateBezier("+[n,t,r,a]+")";return F.toString=function(){return D},F}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var generateSpringRK4=function(){function n(a){return-a.tension*a.x-a.friction*a.v}function t(a,o,u){var s={x:a.x+u.dx*o,v:a.v+u.dv*o,tension:a.tension,friction:a.friction};return{dx:s.v,dv:n(s)}}function r(a,o){var u={dx:a.v,dv:n(a)},s=t(a,o*.5,u),c=t(a,o*.5,s),l=t(a,o,c),d=1/6*(u.dx+2*(s.dx+c.dx)+l.dx),f=1/6*(u.dv+2*(s.dv+c.dv)+l.dv);return a.x=a.x+d*o,a.v=a.v+f*o,a}return function a(o,u,s){var c={x:-1,v:0,tension:null,friction:null},l=[0],d=0,f=1/1e4,h=16/1e3,v,g,b;for(o=parseFloat(o)||500,u=parseFloat(u)||20,s=s||null,c.tension=o,c.friction=u,v=s!==null,v?(d=a(o,u),g=d/s*h):g=h;b=r(b||c,g),l.push(1+b.x),d+=16,Math.abs(b.x)>f&&Math.abs(b.v)>f;);return v?function(_){return l[_*(l.length-1)|0]}:d}}(),cubicBezier=function(t,r,a,o){var u=generateCubicBezier(t,r,a,o);return function(s,c,l){return s+(c-s)*u(l)}},easings={linear:function(t,r,a){return t+(r-t)*a},ease:cubicBezier(.25,.1,.25,1),"ease-in":cubicBezier(.42,0,1,1),"ease-out":cubicBezier(0,0,.58,1),"ease-in-out":cubicBezier(.42,0,.58,1),"ease-in-sine":cubicBezier(.47,0,.745,.715),"ease-out-sine":cubicBezier(.39,.575,.565,1),"ease-in-out-sine":cubicBezier(.445,.05,.55,.95),"ease-in-quad":cubicBezier(.55,.085,.68,.53),"ease-out-quad":cubicBezier(.25,.46,.45,.94),"ease-in-out-quad":cubicBezier(.455,.03,.515,.955),"ease-in-cubic":cubicBezier(.55,.055,.675,.19),"ease-out-cubic":cubicBezier(.215,.61,.355,1),"ease-in-out-cubic":cubicBezier(.645,.045,.355,1),"ease-in-quart":cubicBezier(.895,.03,.685,.22),"ease-out-quart":cubicBezier(.165,.84,.44,1),"ease-in-out-quart":cubicBezier(.77,0,.175,1),"ease-in-quint":cubicBezier(.755,.05,.855,.06),"ease-out-quint":cubicBezier(.23,1,.32,1),"ease-in-out-quint":cubicBezier(.86,0,.07,1),"ease-in-expo":cubicBezier(.95,.05,.795,.035),"ease-out-expo":cubicBezier(.19,1,.22,1),"ease-in-out-expo":cubicBezier(1,0,0,1),"ease-in-circ":cubicBezier(.6,.04,.98,.335),"ease-out-circ":cubicBezier(.075,.82,.165,1),"ease-in-out-circ":cubicBezier(.785,.135,.15,.86),spring:function(t,r,a){if(a===0)return easings.linear;var o=generateSpringRK4(t,r,a);return function(u,s,c){return u+(s-u)*o(c)}},"cubic-bezier":cubicBezier};function getEasedValue(n,t,r,a,o){if(a===1||t===r)return r;var u=o(t,r,a);return n==null||((n.roundValue||n.color)&&(u=Math.round(u)),n.min!==void 0&&(u=Math.max(u,n.min)),n.max!==void 0&&(u=Math.min(u,n.max))),u}function getValue(n,t){return n.pfValue!=null||n.value!=null?n.pfValue!=null&&(t==null||t.type.units!=="%")?n.pfValue:n.value:n}function ease(n,t,r,a,o){var u=o!=null?o.type:null;r<0?r=0:r>1&&(r=1);var s=getValue(n,o),c=getValue(t,o);if(number$1(s)&&number$1(c))return getEasedValue(u,s,c,r,a);if(array(s)&&array(c)){for(var l=[],d=0;d<c.length;d++){var f=s[d],h=c[d];if(f!=null&&h!=null){var v=getEasedValue(u,f,h,r,a);l.push(v)}else l.push(h)}return l}}function step$1(n,t,r,a){var o=!a,u=n._private,s=t._private,c=s.easing,l=s.startTime,d=a?n:n.cy(),f=d.style();if(!s.easingImpl)if(c==null)s.easingImpl=easings.linear;else{var h;if(string(c)){var v=f.parse("transition-timing-function",c);h=v.value}else h=c;var g,b;string(h)?(g=h,b=[]):(g=h[1],b=h.slice(2).map(function(Y){return+Y})),b.length>0?(g==="spring"&&b.push(s.duration),s.easingImpl=easings[g].apply(null,b)):s.easingImpl=easings[g]}var _=s.easingImpl,S;if(s.duration===0?S=1:S=(r-l)/s.duration,s.applying&&(S=s.progress),S<0?S=0:S>1&&(S=1),s.delay==null){var T=s.startPosition,w=s.position;if(w&&o&&!n.locked()){var A={};valid(T.x,w.x)&&(A.x=ease(T.x,w.x,S,_)),valid(T.y,w.y)&&(A.y=ease(T.y,w.y,S,_)),n.position(A)}var R=s.startPan,E=s.pan,I=u.pan,L=E!=null&&a;L&&(valid(R.x,E.x)&&(I.x=ease(R.x,E.x,S,_)),valid(R.y,E.y)&&(I.y=ease(R.y,E.y,S,_)),n.emit("pan"));var F=s.startZoom,D=s.zoom,$=D!=null&&a;$&&(valid(F,D)&&(u.zoom=bound(u.minZoom,ease(F,D,S,_),u.maxZoom)),n.emit("zoom")),(L||$)&&n.emit("viewport");var O=s.style;if(O&&O.length>0&&o){for(var P=0;P<O.length;P++){var C=O[P],q=C.name,M=C,N=s.startStyle[q],G=f.properties[N.name],X=ease(N,M,S,_,G);f.overrideBypass(n,q,X)}n.emit("style")}}return s.progress=S,S}function valid(n,t){return n==null||t==null?!1:number$1(n)&&number$1(t)?!0:!!(n&&t)}function startAnimation(n,t,r,a){var o=t._private;o.started=!0,o.startTime=r-o.progress*o.duration}function stepAll(n,t){var r=t._private.aniEles,a=[];function o(f,h){var v=f._private,g=v.animation.current,b=v.animation.queue,_=!1;if(g.length===0){var S=b.shift();S&&g.push(S)}for(var T=function(I){for(var L=I.length-1;L>=0;L--){var F=I[L];F()}I.splice(0,I.length)},w=g.length-1;w>=0;w--){var A=g[w],R=A._private;if(R.stopped){g.splice(w,1),R.hooked=!1,R.playing=!1,R.started=!1,T(R.frames);continue}!R.playing&&!R.applying||(R.playing&&R.applying&&(R.applying=!1),R.started||startAnimation(f,A,n),step$1(f,A,n,h),R.applying&&(R.applying=!1),T(R.frames),R.step!=null&&R.step(n),A.completed()&&(g.splice(w,1),R.hooked=!1,R.playing=!1,R.started=!1,T(R.completes)),_=!0)}return!h&&g.length===0&&b.length===0&&a.push(f),_}for(var u=!1,s=0;s<r.length;s++){var c=r[s],l=o(c);u=u||l}var d=o(t,!0);(u||d)&&(r.length>0?t.notify("draw",r):t.notify("draw")),r.unmerge(a),t.emit("step")}var corefn$8={animate:define.animate(),animation:define.animation(),animated:define.animated(),clearQueue:define.clearQueue(),delay:define.delay(),delayAnimation:define.delayAnimation(),stop:define.stop(),addToAnimationPool:function(t){var r=this;r.styleEnabled()&&r._private.aniEles.merge(t)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var t=this;if(t._private.animationsRunning=!0,!t.styleEnabled())return;function r(){t._private.animationsRunning&&requestAnimationFrame(function(u){stepAll(u,t),r()})}var a=t.renderer();a&&a.beforeRender?a.beforeRender(function(u,s){stepAll(s,t)},a.beforeRenderPriorities.animations):r()}},emitterOptions={qualifierCompare:function(t,r){return t==null||r==null?t==null&&r==null:t.sameText(r)},eventMatches:function(t,r,a){var o=r.qualifier;return o!=null?t!==a.target&&element(a.target)&&o.matches(a.target):!0},addEventFields:function(t,r){r.cy=t,r.target=t},callbackContext:function(t,r,a){return r.qualifier!=null?a.target:t}},argSelector=function(t){return string(t)?new Selector(t):t},elesfn={createEmitter:function(){var t=this._private;return t.emitter||(t.emitter=new Emitter(emitterOptions,this)),this},emitter:function(){return this._private.emitter},on:function(t,r,a){return this.emitter().on(t,argSelector(r),a),this},removeListener:function(t,r,a){return this.emitter().removeListener(t,argSelector(r),a),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(t,r,a){return this.emitter().one(t,argSelector(r),a),this},once:function(t,r,a){return this.emitter().one(t,argSelector(r),a),this},emit:function(t,r){return this.emitter().emit(t,r),this},emitAndNotify:function(t,r){return this.emit(t),this.notify(t,r),this}};define.eventAliasesOn(elesfn);var corefn$7={png:function(t){var r=this._private.renderer;return t=t||{},r.png(t)},jpg:function(t){var r=this._private.renderer;return t=t||{},t.bg=t.bg||"#fff",r.jpg(t)}};corefn$7.jpeg=corefn$7.jpg;var corefn$6={layout:function(t){var r=this;if(t==null){error("Layout options must be specified to make a layout");return}if(t.name==null){error("A `name` must be specified to make a layout");return}var a=t.name,o=r.extension("layout",a);if(o==null){error("No such layout `"+a+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var u;string(t.eles)?u=r.$(t.eles):u=t.eles!=null?t.eles:r.$();var s=new o(extend({},t,{cy:r,eles:u}));return s}};corefn$6.createLayout=corefn$6.makeLayout=corefn$6.layout;var corefn$5={notify:function(t,r){var a=this._private;if(this.batching()){a.batchNotifications=a.batchNotifications||{};var o=a.batchNotifications[t]=a.batchNotifications[t]||this.collection();r!=null&&o.merge(r);return}if(a.notificationsEnabled){var u=this.renderer();this.destroyed()||!u||u.notify(t,r)}},notifications:function(t){var r=this._private;return t===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!t,this)},noNotifications:function(t){this.notifications(!1),t(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var t=this._private;return t.batchCount==null&&(t.batchCount=0),t.batchCount===0&&(t.batchStyleEles=this.collection(),t.batchNotifications={}),t.batchCount++,this},endBatch:function(){var t=this._private;if(t.batchCount===0)return this;if(t.batchCount--,t.batchCount===0){t.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(t.batchNotifications).forEach(function(a){var o=t.batchNotifications[a];o.empty()?r.notify(a):r.notify(a,o)})}return this},batch:function(t){return this.startBatch(),t(),this.endBatch(),this},batchData:function(t){var r=this;return this.batch(function(){for(var a=Object.keys(t),o=0;o<a.length;o++){var u=a[o],s=t[u],c=r.getElementById(u);c.data(s)}})}},rendererDefaults=defaults$g({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:12,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),corefn$4={renderTo:function(t,r,a,o){var u=this._private.renderer;return u.renderTo(t,r,a,o),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(t){var r=this,a=r.extension("renderer",t.name);if(a==null){error("Can not initialise: No such renderer `".concat(t.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}t.wheelSensitivity!==void 0&&warn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var o=rendererDefaults(t);o.cy=r,r._private.renderer=new a(o),this.notify("init")},destroyRenderer:function(){var t=this;t.notify("destroy");var r=t.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);t._private.renderer=null,t.mutableElements().forEach(function(a){var o=a._private;o.rscratch={},o.rstyle={},o.animation.current=[],o.animation.queue=[]})},onRender:function(t){return this.on("render",t)},offRender:function(t){return this.off("render",t)}};corefn$4.invalidateDimensions=corefn$4.resize;var corefn$3={collection:function(t,r){return string(t)?this.$(t):elementOrCollection(t)?t.collection():array(t)?(r||(r={}),new Collection(this,t,r.unique,r.removed)):new Collection(this)},nodes:function(t){var r=this.$(function(a){return a.isNode()});return t?r.filter(t):r},edges:function(t){var r=this.$(function(a){return a.isEdge()});return t?r.filter(t):r},$:function(t){var r=this._private.elements;return t?r.filter(t):r.spawnSelf()},mutableElements:function(){return this._private.elements}};corefn$3.elements=corefn$3.filter=corefn$3.$;var styfn$8={},TRUE="t",FALSE="f";styfn$8.apply=function(n){for(var t=this,r=t._private,a=r.cy,o=a.collection(),u=0;u<n.length;u++){var s=n[u],c=t.getContextMeta(s);if(!c.empty){var l=t.getContextStyle(c),d=t.applyContextStyle(c,l,s);s._private.appliedInitStyle?t.updateTransitions(s,d.diffProps):s._private.appliedInitStyle=!0;var f=t.updateStyleHints(s);f&&o.push(s)}}return o};styfn$8.getPropertiesDiff=function(n,t){var r=this,a=r._private.propDiffs=r._private.propDiffs||{},o=n+"-"+t,u=a[o];if(u)return u;for(var s=[],c={},l=0;l<r.length;l++){var d=r[l],f=n[l]===TRUE,h=t[l]===TRUE,v=f!==h,g=d.mappedProperties.length>0;if(v||h&&g){var b=void 0;v&&g||v?b=d.properties:g&&(b=d.mappedProperties);for(var _=0;_<b.length;_++){for(var S=b[_],T=S.name,w=!1,A=l+1;A<r.length;A++){var R=r[A],E=t[A]===TRUE;if(E&&(w=R.properties[S.name]!=null,w))break}!c[T]&&!w&&(c[T]=!0,s.push(T))}}}return a[o]=s,s};styfn$8.getContextMeta=function(n){for(var t=this,r="",a,o=n._private.styleCxtKey||"",u=0;u<t.length;u++){var s=t[u],c=s.selector&&s.selector.matches(n);c?r+=TRUE:r+=FALSE}return a=t.getPropertiesDiff(o,r),n._private.styleCxtKey=r,{key:r,diffPropNames:a,empty:a.length===0}};styfn$8.getContextStyle=function(n){var t=n.key,r=this,a=this._private.contextStyles=this._private.contextStyles||{};if(a[t])return a[t];for(var o={_private:{key:t}},u=0;u<r.length;u++){var s=r[u],c=t[u]===TRUE;if(c)for(var l=0;l<s.properties.length;l++){var d=s.properties[l];o[d.name]=d}}return a[t]=o,o};styfn$8.applyContextStyle=function(n,t,r){for(var a=this,o=n.diffPropNames,u={},s=a.types,c=0;c<o.length;c++){var l=o[c],d=t[l],f=r.pstyle(l);if(!d)if(f)f.bypass?d={name:l,deleteBypassed:!0}:d={name:l,delete:!0};else continue;if(f!==d){if(d.mapped===s.fn&&f!=null&&f.mapping!=null&&f.mapping.value===d.value){var h=f.mapping,v=h.fnValue=d.value(r);if(v===h.prevFnValue)continue}var g=u[l]={prev:f};a.applyParsedProperty(r,d),g.next=r.pstyle(l),g.next&&g.next.bypass&&(g.next=g.next.bypassed)}}return{diffProps:u}};styfn$8.updateStyleHints=function(n){var t=n._private,r=this,a=r.propertyGroupNames,o=r.propertyGroupKeys,u=function(j,z,B){return r.getPropertiesHash(j,z,B)},s=t.styleKey;if(n.removed())return!1;var c=t.group==="nodes",l=n._private.style;a=Object.keys(l);for(var d=0;d<o.length;d++){var f=o[d];t.styleKeys[f]=[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT]}for(var h=function(j,z){return t.styleKeys[z][0]=hashInt(j,t.styleKeys[z][0])},v=function(j,z){return t.styleKeys[z][1]=hashIntAlt(j,t.styleKeys[z][1])},g=function(j,z){h(j,z),v(j,z)},b=function(j,z){for(var B=0;B<j.length;B++){var U=j.charCodeAt(B);h(U,z),v(U,z)}},_=2e9,S=function(j){return-128<j&&j<128&&Math.floor(j)!==j?_-(j*1024|0):j},T=0;T<a.length;T++){var w=a[T],A=l[w];if(A!=null){var R=this.properties[w],E=R.type,I=R.groupKey,L=void 0;R.hashOverride!=null?L=R.hashOverride(n,A):A.pfValue!=null&&(L=A.pfValue);var F=R.enums==null?A.value:null,D=L!=null,$=F!=null,O=D||$,P=A.units;if(E.number&&O&&!E.multiple){var C=D?L:F;g(S(C),I),!D&&P!=null&&b(P,I)}else b(A.strValue,I)}}for(var q=[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT],M=0;M<o.length;M++){var N=o[M],G=t.styleKeys[N];q[0]=hashInt(G[0],q[0]),q[1]=hashIntAlt(G[1],q[1])}t.styleKey=combineHashes(q[0],q[1]);var X=t.styleKeys;t.labelDimsKey=combineHashesArray(X.labelDimensions);var Y=u(n,["label"],X.labelDimensions);if(t.labelKey=combineHashesArray(Y),t.labelStyleKey=combineHashesArray(hashArrays(X.commonLabel,Y)),!c){var W=u(n,["source-label"],X.labelDimensions);t.sourceLabelKey=combineHashesArray(W),t.sourceLabelStyleKey=combineHashesArray(hashArrays(X.commonLabel,W));var te=u(n,["target-label"],X.labelDimensions);t.targetLabelKey=combineHashesArray(te),t.targetLabelStyleKey=combineHashesArray(hashArrays(X.commonLabel,te))}if(c){var ue=t.styleKeys,fe=ue.nodeBody,re=ue.nodeBorder,ye=ue.nodeOutline,Te=ue.backgroundImage,Re=ue.compound,ve=ue.pie,ce=[fe,re,ye,Te,Re,ve].filter(function(J){return J!=null}).reduce(hashArrays,[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT]);t.nodeKey=combineHashesArray(ce),t.hasPie=ve!=null&&ve[0]!==DEFAULT_HASH_SEED&&ve[1]!==DEFAULT_HASH_SEED_ALT}return s!==t.styleKey};styfn$8.clearStyleHints=function(n){var t=n._private;t.styleCxtKey="",t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null};styfn$8.applyParsedProperty=function(n,t){var r=this,a=t,o=n._private.style,u,s=r.types,c=r.properties[a.name].type,l=a.bypass,d=o[a.name],f=d&&d.bypass,h=n._private,v="mapping",g=function(fe){return fe==null?null:fe.pfValue!=null?fe.pfValue:fe.value},b=function(){var fe=g(d),re=g(a);r.checkTriggers(n,a.name,fe,re)};if(t.name==="curve-style"&&n.isEdge()&&(t.value!=="bezier"&&n.isLoop()||t.value==="haystack"&&(n.source().isParent()||n.target().isParent()))&&(a=t=this.parse(t.name,"bezier",l)),a.delete)return o[a.name]=void 0,b(),!0;if(a.deleteBypassed)return d?d.bypass?(d.bypassed=void 0,b(),!0):!1:(b(),!0);if(a.deleteBypass)return d?d.bypass?(o[a.name]=d.bypassed,b(),!0):!1:(b(),!0);var _=function(){warn("Do not assign mappings to elements without corresponding data (i.e. ele `"+n.id()+"` has no mapping for property `"+a.name+"` with data field `"+a.field+"`); try a `["+a.field+"]` selector to limit scope to elements with `"+a.field+"` defined")};switch(a.mapped){case s.mapData:{for(var S=a.field.split("."),T=h.data,w=0;w<S.length&&T;w++){var A=S[w];T=T[A]}if(T==null)return _(),!1;var R;if(number$1(T)){var E=a.fieldMax-a.fieldMin;E===0?R=0:R=(T-a.fieldMin)/E}else return warn("Do not use continuous mappers without specifying numeric data (i.e. `"+a.field+": "+T+"` for `"+n.id()+"` is non-numeric)"),!1;if(R<0?R=0:R>1&&(R=1),c.color){var I=a.valueMin[0],L=a.valueMax[0],F=a.valueMin[1],D=a.valueMax[1],$=a.valueMin[2],O=a.valueMax[2],P=a.valueMin[3]==null?1:a.valueMin[3],C=a.valueMax[3]==null?1:a.valueMax[3],q=[Math.round(I+(L-I)*R),Math.round(F+(D-F)*R),Math.round($+(O-$)*R),Math.round(P+(C-P)*R)];u={bypass:a.bypass,name:a.name,value:q,strValue:"rgb("+q[0]+", "+q[1]+", "+q[2]+")"}}else if(c.number){var M=a.valueMin+(a.valueMax-a.valueMin)*R;u=this.parse(a.name,M,a.bypass,v)}else return!1;if(!u)return _(),!1;u.mapping=a,a=u;break}case s.data:{for(var N=a.field.split("."),G=h.data,X=0;X<N.length&&G;X++){var Y=N[X];G=G[Y]}if(G!=null&&(u=this.parse(a.name,G,a.bypass,v)),!u)return _(),!1;u.mapping=a,a=u;break}case s.fn:{var W=a.value,te=a.fnValue!=null?a.fnValue:W(n);if(a.prevFnValue=te,te==null)return warn("Custom function mappers may not return null (i.e. `"+a.name+"` for ele `"+n.id()+"` is null)"),!1;if(u=this.parse(a.name,te,a.bypass,v),!u)return warn("Custom function mappers may not return invalid values for the property type (i.e. `"+a.name+"` for ele `"+n.id()+"` is invalid)"),!1;u.mapping=copy(a),a=u;break}case void 0:break;default:return!1}return l?(f?a.bypassed=d.bypassed:a.bypassed=d,o[a.name]=a):f?d.bypassed=a:o[a.name]=a,b(),!0};styfn$8.cleanElements=function(n,t){for(var r=0;r<n.length;r++){var a=n[r];if(this.clearStyleHints(a),a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),!t)a._private.style={};else for(var o=a._private.style,u=Object.keys(o),s=0;s<u.length;s++){var c=u[s],l=o[c];l!=null&&(l.bypass?l.bypassed=null:o[c]=null)}}};styfn$8.update=function(){var n=this._private.cy,t=n.mutableElements();t.updateStyle()};styfn$8.updateTransitions=function(n,t){var r=this,a=n._private,o=n.pstyle("transition-property").value,u=n.pstyle("transition-duration").pfValue,s=n.pstyle("transition-delay").pfValue;if(o.length>0&&u>0){for(var c={},l=!1,d=0;d<o.length;d++){var f=o[d],h=n.pstyle(f),v=t[f];if(v){var g=v.prev,b=g,_=v.next!=null?v.next:h,S=!1,T=void 0,w=1e-6;b&&(number$1(b.pfValue)&&number$1(_.pfValue)?(S=_.pfValue-b.pfValue,T=b.pfValue+w*S):number$1(b.value)&&number$1(_.value)?(S=_.value-b.value,T=b.value+w*S):array(b.value)&&array(_.value)&&(S=b.value[0]!==_.value[0]||b.value[1]!==_.value[1]||b.value[2]!==_.value[2],T=b.strValue),S&&(c[f]=_.strValue,this.applyBypass(n,f,T),l=!0))}}if(!l)return;a.transitioning=!0,new Promise$1(function(A){s>0?n.delayAnimation(s).play().promise().then(A):A()}).then(function(){return n.animation({style:c,duration:u,easing:n.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(n,o),n.emitAndNotify("style"),a.transitioning=!1})}else a.transitioning&&(this.removeBypasses(n,o),n.emitAndNotify("style"),a.transitioning=!1)};styfn$8.checkTrigger=function(n,t,r,a,o,u){var s=this.properties[t],c=o(s);c!=null&&c(r,a)&&u(s)};styfn$8.checkZOrderTrigger=function(n,t,r,a){var o=this;this.checkTrigger(n,t,r,a,function(u){return u.triggersZOrder},function(){o._private.cy.notify("zorder",n)})};styfn$8.checkBoundsTrigger=function(n,t,r,a){this.checkTrigger(n,t,r,a,function(o){return o.triggersBounds},function(o){n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),o.triggersBoundsOfParallelBeziers&&t==="curve-style"&&(r==="bezier"||a==="bezier")&&n.parallelEdges().forEach(function(u){u.dirtyBoundingBoxCache()}),o.triggersBoundsOfConnectedEdges&&t==="display"&&(r==="none"||a==="none")&&n.connectedEdges().forEach(function(u){u.dirtyBoundingBoxCache()})})};styfn$8.checkTriggers=function(n,t,r,a){n.dirtyStyleCache(),this.checkZOrderTrigger(n,t,r,a),this.checkBoundsTrigger(n,t,r,a)};var styfn$7={};styfn$7.applyBypass=function(n,t,r,a){var o=this,u=[],s=!0;if(t==="*"||t==="**"){if(r!==void 0)for(var c=0;c<o.properties.length;c++){var l=o.properties[c],d=l.name,f=this.parse(d,r,!0);f&&u.push(f)}}else if(string(t)){var h=this.parse(t,r,!0);h&&u.push(h)}else if(plainObject(t)){var v=t;a=r;for(var g=Object.keys(v),b=0;b<g.length;b++){var _=g[b],S=v[_];if(S===void 0&&(S=v[dash2camel(_)]),S!==void 0){var T=this.parse(_,S,!0);T&&u.push(T)}}}else return!1;if(u.length===0)return!1;for(var w=!1,A=0;A<n.length;A++){for(var R=n[A],E={},I=void 0,L=0;L<u.length;L++){var F=u[L];if(a){var D=R.pstyle(F.name);I=E[F.name]={prev:D}}w=this.applyParsedProperty(R,copy(F))||w,a&&(I.next=R.pstyle(F.name))}w&&this.updateStyleHints(R),a&&this.updateTransitions(R,E,s)}return w};styfn$7.overrideBypass=function(n,t,r){t=camel2dash(t);for(var a=0;a<n.length;a++){var o=n[a],u=o._private.style[t],s=this.properties[t].type,c=s.color,l=s.mutiple,d=u?u.pfValue!=null?u.pfValue:u.value:null;!u||!u.bypass?this.applyBypass(o,t,r):(u.value=r,u.pfValue!=null&&(u.pfValue=r),c?u.strValue="rgb("+r.join(",")+")":l?u.strValue=r.join(" "):u.strValue=""+r,this.updateStyleHints(o)),this.checkTriggers(o,t,d,r)}};styfn$7.removeAllBypasses=function(n,t){return this.removeBypasses(n,this.propertyNames,t)};styfn$7.removeBypasses=function(n,t,r){for(var a=!0,o=0;o<n.length;o++){for(var u=n[o],s={},c=0;c<t.length;c++){var l=t[c],d=this.properties[l],f=u.pstyle(d.name);if(!(!f||!f.bypass)){var h="",v=this.parse(l,h,!0),g=s[d.name]={prev:f};this.applyParsedProperty(u,v),g.next=u.pstyle(d.name)}}this.updateStyleHints(u),r&&this.updateTransitions(u,s,a)}};var styfn$6={};styfn$6.getEmSizeInPixels=function(){var n=this.containerCss("font-size");return n!=null?parseFloat(n):1};styfn$6.containerCss=function(n){var t=this._private.cy,r=t.container(),a=t.window();if(a&&r&&a.getComputedStyle)return a.getComputedStyle(r).getPropertyValue(n)};var styfn$5={};styfn$5.getRenderedStyle=function(n,t){return t?this.getStylePropertyValue(n,t,!0):this.getRawStyle(n,!0)};styfn$5.getRawStyle=function(n,t){var r=this;if(n=n[0],n){for(var a={},o=0;o<r.properties.length;o++){var u=r.properties[o],s=r.getStylePropertyValue(n,u.name,t);s!=null&&(a[u.name]=s,a[dash2camel(u.name)]=s)}return a}};styfn$5.getIndexedStyle=function(n,t,r,a){var o=n.pstyle(t)[r][a];return o??n.cy().style().getDefaultProperty(t)[r][0]};styfn$5.getStylePropertyValue=function(n,t,r){var a=this;if(n=n[0],n){var o=a.properties[t];o.alias&&(o=o.pointsTo);var u=o.type,s=n.pstyle(o.name);if(s){var c=s.value,l=s.units,d=s.strValue;if(r&&u.number&&c!=null&&number$1(c)){var f=n.cy().zoom(),h=function(S){return S*f},v=function(S,T){return h(S)+T},g=array(c),b=g?l.every(function(_){return _!=null}):l!=null;return b?g?c.map(function(_,S){return v(_,l[S])}).join(" "):v(c,l):g?c.map(function(_){return string(_)?_:""+h(_)}).join(" "):""+h(c)}else if(d!=null)return d}return null}};styfn$5.getAnimationStartStyle=function(n,t){for(var r={},a=0;a<t.length;a++){var o=t[a],u=o.name,s=n.pstyle(u);s!==void 0&&(plainObject(s)?s=this.parse(u,s.strValue):s=this.parse(u,s)),s&&(r[u]=s)}return r};styfn$5.getPropsList=function(n){var t=this,r=[],a=n,o=t.properties;if(a)for(var u=Object.keys(a),s=0;s<u.length;s++){var c=u[s],l=a[c],d=o[c]||o[camel2dash(c)],f=this.parse(d.name,l);f&&r.push(f)}return r};styfn$5.getNonDefaultPropertiesHash=function(n,t,r){var a=r.slice(),o,u,s,c,l,d;for(l=0;l<t.length;l++)if(o=t[l],u=n.pstyle(o,!1),u!=null)if(u.pfValue!=null)a[0]=hashInt(c,a[0]),a[1]=hashIntAlt(c,a[1]);else for(s=u.strValue,d=0;d<s.length;d++)c=s.charCodeAt(d),a[0]=hashInt(c,a[0]),a[1]=hashIntAlt(c,a[1]);return a};styfn$5.getPropertiesHash=styfn$5.getNonDefaultPropertiesHash;var styfn$4={};styfn$4.appendFromJson=function(n){for(var t=this,r=0;r<n.length;r++){var a=n[r],o=a.selector,u=a.style||a.css,s=Object.keys(u);t.selector(o);for(var c=0;c<s.length;c++){var l=s[c],d=u[l];t.css(l,d)}}return t};styfn$4.fromJson=function(n){var t=this;return t.resetToDefault(),t.appendFromJson(n),t};styfn$4.json=function(){for(var n=[],t=this.defaultLength;t<this.length;t++){for(var r=this[t],a=r.selector,o=r.properties,u={},s=0;s<o.length;s++){var c=o[s];u[c.name]=c.strValue}n.push({selector:a?a.toString():"core",style:u})}return n};var styfn$3={};styfn$3.appendFromString=function(n){var t=this,r=this,a=""+n,o,u,s;a=a.replace(/[/][*](\s|.)+?[*][/]/g,"");function c(){a.length>o.length?a=a.substr(o.length):a=""}function l(){u.length>s.length?u=u.substr(s.length):u=""}for(;;){var d=a.match(/^\s*$/);if(d)break;var f=a.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!f){warn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+a);break}o=f[0];var h=f[1];if(h!=="core"){var v=new Selector(h);if(v.invalid){warn("Skipping parsing of block: Invalid selector found in string stylesheet: "+h),c();continue}}var g=f[2],b=!1;u=g;for(var _=[];;){var S=u.match(/^\s*$/);if(S)break;var T=u.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!T){warn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+g),b=!0;break}s=T[0];var w=T[1],A=T[2],R=t.properties[w];if(!R){warn("Skipping property: Invalid property name in: "+s),l();continue}var E=r.parse(w,A);if(!E){warn("Skipping property: Invalid property definition in: "+s),l();continue}_.push({name:w,val:A}),l()}if(b){c();break}r.selector(h);for(var I=0;I<_.length;I++){var L=_[I];r.css(L.name,L.val)}c()}return r};styfn$3.fromString=function(n){var t=this;return t.resetToDefault(),t.appendFromString(n),t};var styfn$2={};(function(){var n=number,t=rgbaNoBackRefs,r=hslaNoBackRefs,a=hex3,o=hex6,u=function(ce){return"^"+ce+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(ce){var J=n+"|\\w+|"+t+"|"+r+"|"+a+"|"+o;return"^"+ce+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+n+")\\s*\\,\\s*("+n+")\\s*,\\s*("+J+")\\s*\\,\\s*("+J+")\\)$"},c=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];styfn$2.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:u("data")},layoutData:{mapping:!0,regex:u("layoutData")},scratch:{mapping:!0,regex:u("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:c,singleRegexMatchValue:!0},urls:{regexes:c,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ce,J){switch(ce.length){case 2:return J[0]!=="deg"&&J[0]!=="rad"&&J[1]!=="deg"&&J[1]!=="rad";case 1:return string(ce[0])||J[0]==="deg"||J[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+n+")\\s*,\\s*("+n+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+n+")\\s*,\\s*("+n+")\\s*,\\s*("+n+")\\s*,\\s*("+n+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ce){var J=ce.length;return J===1||J===2||J===4}}};var l={zeroNonZero:function(ce,J){return(ce==null||J==null)&&ce!==J||ce==0&&J!=0?!0:ce!=0&&J==0},any:function(ce,J){return ce!=J},emptyNonEmpty:function(ce,J){var j=emptyString(ce),z=emptyString(J);return j&&!z||!j&&z}},d=styfn$2.types,f=[{name:"label",type:d.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:d.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:d.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:d.bidirectionalSize,triggersBounds:l.any}],h=[{name:"source-label",type:d.text,triggersBounds:l.any},{name:"source-text-rotation",type:d.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:d.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:d.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:d.size,triggersBounds:l.any}],v=[{name:"target-label",type:d.text,triggersBounds:l.any},{name:"target-text-rotation",type:d.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:d.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:d.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:d.size,triggersBounds:l.any}],g=[{name:"font-family",type:d.fontFamily,triggersBounds:l.any},{name:"font-style",type:d.fontStyle,triggersBounds:l.any},{name:"font-weight",type:d.fontWeight,triggersBounds:l.any},{name:"font-size",type:d.size,triggersBounds:l.any},{name:"text-transform",type:d.textTransform,triggersBounds:l.any},{name:"text-wrap",type:d.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:d.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:d.size,triggersBounds:l.any},{name:"text-outline-width",type:d.size,triggersBounds:l.any},{name:"line-height",type:d.positiveNumber,triggersBounds:l.any}],b=[{name:"text-valign",type:d.valign,triggersBounds:l.any},{name:"text-halign",type:d.halign,triggersBounds:l.any},{name:"color",type:d.color},{name:"text-outline-color",type:d.color},{name:"text-outline-opacity",type:d.zeroOneNumber},{name:"text-background-color",type:d.color},{name:"text-background-opacity",type:d.zeroOneNumber},{name:"text-background-padding",type:d.size,triggersBounds:l.any},{name:"text-border-opacity",type:d.zeroOneNumber},{name:"text-border-color",type:d.color},{name:"text-border-width",type:d.size,triggersBounds:l.any},{name:"text-border-style",type:d.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:d.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:d.justification}],_=[{name:"events",type:d.bool,triggersZOrder:l.any},{name:"text-events",type:d.bool,triggersZOrder:l.any}],S=[{name:"display",type:d.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:!0},{name:"visibility",type:d.visibility,triggersZOrder:l.any},{name:"opacity",type:d.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:d.zeroOneNumber},{name:"min-zoomed-font-size",type:d.size},{name:"z-compound-depth",type:d.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:d.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:d.number,triggersZOrder:l.any}],T=[{name:"overlay-padding",type:d.size,triggersBounds:l.any},{name:"overlay-color",type:d.color},{name:"overlay-opacity",type:d.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:d.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:d.cornerRadius}],w=[{name:"underlay-padding",type:d.size,triggersBounds:l.any},{name:"underlay-color",type:d.color},{name:"underlay-opacity",type:d.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:d.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:d.cornerRadius}],A=[{name:"transition-property",type:d.propList},{name:"transition-duration",type:d.time},{name:"transition-delay",type:d.time},{name:"transition-timing-function",type:d.easing}],R=function(ce,J){return J.value==="label"?-ce.poolIndex():J.pfValue},E=[{name:"height",type:d.nodeSize,triggersBounds:l.any,hashOverride:R},{name:"width",type:d.nodeSize,triggersBounds:l.any,hashOverride:R},{name:"shape",type:d.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:d.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:d.cornerRadius},{name:"background-color",type:d.color},{name:"background-fill",type:d.fill},{name:"background-opacity",type:d.zeroOneNumber},{name:"background-blacken",type:d.nOneOneNumber},{name:"background-gradient-stop-colors",type:d.colors},{name:"background-gradient-stop-positions",type:d.percentages},{name:"background-gradient-direction",type:d.gradientDirection},{name:"padding",type:d.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:d.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:d.boundsExpansion,triggersBounds:l.any}],I=[{name:"border-color",type:d.color},{name:"border-opacity",type:d.zeroOneNumber},{name:"border-width",type:d.size,triggersBounds:l.any},{name:"border-style",type:d.borderStyle},{name:"border-cap",type:d.lineCap},{name:"border-join",type:d.lineJoin},{name:"border-dash-pattern",type:d.numbers},{name:"border-dash-offset",type:d.number},{name:"border-position",type:d.linePosition}],L=[{name:"outline-color",type:d.color},{name:"outline-opacity",type:d.zeroOneNumber},{name:"outline-width",type:d.size,triggersBounds:l.any},{name:"outline-style",type:d.borderStyle},{name:"outline-offset",type:d.size,triggersBounds:l.any}],F=[{name:"background-image",type:d.urls},{name:"background-image-crossorigin",type:d.bgCrossOrigin},{name:"background-image-opacity",type:d.zeroOneNumbers},{name:"background-image-containment",type:d.bgContainment},{name:"background-image-smoothing",type:d.bools},{name:"background-position-x",type:d.bgPos},{name:"background-position-y",type:d.bgPos},{name:"background-width-relative-to",type:d.bgRelativeTo},{name:"background-height-relative-to",type:d.bgRelativeTo},{name:"background-repeat",type:d.bgRepeat},{name:"background-fit",type:d.bgFit},{name:"background-clip",type:d.bgClip},{name:"background-width",type:d.bgWH},{name:"background-height",type:d.bgWH},{name:"background-offset-x",type:d.bgPos},{name:"background-offset-y",type:d.bgPos}],D=[{name:"position",type:d.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:d.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:d.size,triggersBounds:l.any},{name:"min-width-bias-left",type:d.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:d.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:d.size,triggersBounds:l.any},{name:"min-height-bias-top",type:d.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:d.sizeMaybePercent,triggersBounds:l.any}],$=[{name:"line-style",type:d.lineStyle},{name:"line-color",type:d.color},{name:"line-fill",type:d.fill},{name:"line-cap",type:d.lineCap},{name:"line-opacity",type:d.zeroOneNumber},{name:"line-dash-pattern",type:d.numbers},{name:"line-dash-offset",type:d.number},{name:"line-outline-width",type:d.size},{name:"line-outline-color",type:d.color},{name:"line-gradient-stop-colors",type:d.colors},{name:"line-gradient-stop-positions",type:d.percentages},{name:"curve-style",type:d.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:d.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:d.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:d.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:d.size,triggersBounds:l.any},{name:"control-point-distances",type:d.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:d.numbers,triggersBounds:l.any},{name:"segment-distances",type:d.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:d.numbers,triggersBounds:l.any},{name:"segment-radii",type:d.numbers,triggersBounds:l.any},{name:"radius-type",type:d.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:d.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:d.size,triggersBounds:l.any},{name:"taxi-direction",type:d.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:d.number,triggersBounds:l.any},{name:"edge-distances",type:d.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:d.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:d.angle,triggersBounds:l.any},{name:"loop-sweep",type:d.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:d.size,triggersBounds:l.any},{name:"target-distance-from-node",type:d.size,triggersBounds:l.any}],O=[{name:"ghost",type:d.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:d.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:d.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:d.zeroOneNumber}],P=[{name:"selection-box-color",type:d.color},{name:"selection-box-opacity",type:d.zeroOneNumber},{name:"selection-box-border-color",type:d.color},{name:"selection-box-border-width",type:d.size},{name:"active-bg-color",type:d.color},{name:"active-bg-opacity",type:d.zeroOneNumber},{name:"active-bg-size",type:d.size},{name:"outside-texture-bg-color",type:d.color},{name:"outside-texture-bg-opacity",type:d.zeroOneNumber}],C=[];styfn$2.pieBackgroundN=16,C.push({name:"pie-size",type:d.sizeMaybePercent});for(var q=1;q<=styfn$2.pieBackgroundN;q++)C.push({name:"pie-"+q+"-background-color",type:d.color}),C.push({name:"pie-"+q+"-background-size",type:d.percent}),C.push({name:"pie-"+q+"-background-opacity",type:d.zeroOneNumber});var M=[],N=styfn$2.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:d.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:d.color},{name:"arrow-fill",type:d.arrowFill},{name:"arrow-width",type:d.arrowWidth}].forEach(function(ve){N.forEach(function(ce){var J=ce+"-"+ve.name,j=ve.type,z=ve.triggersBounds;M.push({name:J,type:j,triggersBounds:z})})},{});var G=styfn$2.properties=[].concat(_,A,S,T,w,O,b,g,f,h,v,E,I,L,F,C,D,$,M,P),X=styfn$2.propertyGroups={behavior:_,transition:A,visibility:S,overlay:T,underlay:w,ghost:O,commonLabel:b,labelDimensions:g,mainLabel:f,sourceLabel:h,targetLabel:v,nodeBody:E,nodeBorder:I,nodeOutline:L,backgroundImage:F,pie:C,compound:D,edgeLine:$,edgeArrow:M,core:P},Y=styfn$2.propertyGroupNames={},W=styfn$2.propertyGroupKeys=Object.keys(X);W.forEach(function(ve){Y[ve]=X[ve].map(function(ce){return ce.name}),X[ve].forEach(function(ce){return ce.groupKey=ve})});var te=styfn$2.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];styfn$2.propertyNames=G.map(function(ve){return ve.name});for(var ue=0;ue<G.length;ue++){var fe=G[ue];G[fe.name]=fe}for(var re=0;re<te.length;re++){var ye=te[re],Te=G[ye.pointsTo],Re={name:ye.name,alias:!0,pointsTo:Te};G.push(Re),G[ye.name]=Re}})();styfn$2.getDefaultProperty=function(n){return this.getDefaultProperties()[n]};styfn$2.getDefaultProperties=function(){var n=this._private;if(n.defaultProperties!=null)return n.defaultProperties;for(var t=extend({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,d){for(var f=1;f<=styfn$2.pieBackgroundN;f++){var h=d.name.replace("{{i}}",f),v=d.value;l[h]=v}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,d){return styfn$2.arrowPrefixes.forEach(function(f){var h=f+"-"+d.name,v=d.value;l[h]=v}),l},{})),r={},a=0;a<this.properties.length;a++){var o=this.properties[a];if(!o.pointsTo){var u=o.name,s=t[u],c=this.parse(u,s);r[u]=c}}return n.defaultProperties=r,n.defaultProperties};styfn$2.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var styfn$1={};styfn$1.parse=function(n,t,r,a){var o=this;if(fn$6(t))return o.parseImplWarn(n,t,r,a);var u=a==="mapping"||a===!0||a===!1||a==null?"dontcare":a,s=r?"t":"f",c=""+t,l=hashStrings(n,c,s,u),d=o.propCache=o.propCache||[],f;return(f=d[l])||(f=d[l]=o.parseImplWarn(n,t,r,a)),(r||a==="mapping")&&(f=copy(f),f&&(f.value=copy(f.value))),f};styfn$1.parseImplWarn=function(n,t,r,a){var o=this.parseImpl(n,t,r,a);return!o&&t!=null&&warn("The style property `".concat(n,": ").concat(t,"` is invalid")),o&&(o.name==="width"||o.name==="height")&&t==="label"&&warn("The style value of `label` is deprecated for `"+o.name+"`"),o};styfn$1.parseImpl=function(n,t,r,a){var o=this;n=camel2dash(n);var u=o.properties[n],s=t,c=o.types;if(!u||t===void 0)return null;u.alias&&(u=u.pointsTo,n=u.name);var l=string(t);l&&(t=t.trim());var d=u.type;if(!d)return null;if(r&&(t===""||t===null))return{name:n,value:t,bypass:!0,deleteBypass:!0};if(fn$6(t))return{name:n,value:t,strValue:"fn",mapped:c.fn,bypass:r};var f,h;if(!(!l||a||t.length<7||t[1]!=="a")){if(t.length>=7&&t[0]==="d"&&(f=new RegExp(c.data.regex).exec(t))){if(r)return!1;var v=c.data;return{name:n,value:f,strValue:""+t,mapped:v,field:f[1],bypass:r}}else if(t.length>=10&&t[0]==="m"&&(h=new RegExp(c.mapData.regex).exec(t))){if(r||d.multiple)return!1;var g=c.mapData;if(!(d.color||d.number))return!1;var b=this.parse(n,h[4]);if(!b||b.mapped)return!1;var _=this.parse(n,h[5]);if(!_||_.mapped)return!1;if(b.pfValue===_.pfValue||b.strValue===_.strValue)return warn("`"+n+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+n+": "+b.strValue+"`"),this.parse(n,b.strValue);if(d.color){var S=b.value,T=_.value,w=S[0]===T[0]&&S[1]===T[1]&&S[2]===T[2]&&(S[3]===T[3]||(S[3]==null||S[3]===1)&&(T[3]==null||T[3]===1));if(w)return!1}return{name:n,value:h,strValue:""+t,mapped:g,field:h[1],fieldMin:parseFloat(h[2]),fieldMax:parseFloat(h[3]),valueMin:b.value,valueMax:_.value,bypass:r}}}if(d.multiple&&a!=="multiple"){var A;if(l?A=t.split(/\s+/):array(t)?A=t:A=[t],d.evenMultiple&&A.length%2!==0)return null;for(var R=[],E=[],I=[],L="",F=!1,D=0;D<A.length;D++){var $=o.parse(n,A[D],r,"multiple");F=F||string($.value),R.push($.value),I.push($.pfValue!=null?$.pfValue:$.value),E.push($.units),L+=(D>0?" ":"")+$.strValue}return d.validate&&!d.validate(R,E)?null:d.singleEnum&&F?R.length===1&&string(R[0])?{name:n,value:R[0],strValue:R[0],bypass:r}:null:{name:n,value:R,pfValue:I,strValue:L,bypass:r,units:E}}var O=function(){for(var ce=0;ce<d.enums.length;ce++){var J=d.enums[ce];if(J===t)return{name:n,value:t,strValue:""+t,bypass:r}}return null};if(d.number){var P,C="px";if(d.units&&(P=d.units),d.implicitUnits&&(C=d.implicitUnits),!d.unitless)if(l){var q="px|em"+(d.allowPercent?"|\\%":"");P&&(q=P);var M=t.match("^("+number+")("+q+")?$");M&&(t=M[1],P=M[2]||C)}else(!P||d.implicitUnits)&&(P=C);if(t=parseFloat(t),isNaN(t)&&d.enums===void 0)return null;if(isNaN(t)&&d.enums!==void 0)return t=s,O();if(d.integer&&!integer(t)||d.min!==void 0&&(t<d.min||d.strictMin&&t===d.min)||d.max!==void 0&&(t>d.max||d.strictMax&&t===d.max))return null;var N={name:n,value:t,strValue:""+t+(P||""),units:P,bypass:r};return d.unitless||P!=="px"&&P!=="em"?N.pfValue=t:N.pfValue=P==="px"||!P?t:this.getEmSizeInPixels()*t,(P==="ms"||P==="s")&&(N.pfValue=P==="ms"?t:1e3*t),(P==="deg"||P==="rad")&&(N.pfValue=P==="rad"?t:deg2rad(t)),P==="%"&&(N.pfValue=t/100),N}else if(d.propList){var G=[],X=""+t;if(X!=="none"){for(var Y=X.split(/\s*,\s*|\s+/),W=0;W<Y.length;W++){var te=Y[W].trim();o.properties[te]?G.push(te):warn("`"+te+"` is not a valid property name")}if(G.length===0)return null}return{name:n,value:G,strValue:G.length===0?"none":G.join(" "),bypass:r}}else if(d.color){var ue=color2tuple(t);return ue?{name:n,value:ue,pfValue:ue,strValue:"rgb("+ue[0]+","+ue[1]+","+ue[2]+")",bypass:r}:null}else if(d.regex||d.regexes){if(d.enums){var fe=O();if(fe)return fe}for(var re=d.regexes?d.regexes:[d.regex],ye=0;ye<re.length;ye++){var Te=new RegExp(re[ye]),Re=Te.exec(t);if(Re)return{name:n,value:d.singleRegexMatchValue?Re[1]:Re,strValue:""+t,bypass:r}}return null}else return d.string?{name:n,value:""+t,strValue:""+t,bypass:r}:d.enums?O():null};var Style=function n(t){if(!(this instanceof n))return new n(t);if(!core(t)){error("A style must have a core reference");return}this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()},styfn=Style.prototype;styfn.instanceString=function(){return"style"};styfn.clear=function(){for(var n=this._private,t=n.cy,r=t.elements(),a=0;a<this.length;a++)this[a]=void 0;return this.length=0,n.contextStyles={},n.propDiffs={},this.cleanElements(r,!0),r.forEach(function(o){var u=o[0]._private;u.styleDirty=!0,u.appliedInitStyle=!1}),this};styfn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};styfn.core=function(n){return this._private.coreStyle[n]||this.getDefaultProperty(n)};styfn.selector=function(n){var t=n==="core"?null:new Selector(n),r=this.length++;return this[r]={selector:t,properties:[],mappedProperties:[],index:r},this};styfn.css=function(){var n=this,t=arguments;if(t.length===1)for(var r=t[0],a=0;a<n.properties.length;a++){var o=n.properties[a],u=r[o.name];u===void 0&&(u=r[dash2camel(o.name)]),u!==void 0&&this.cssRule(o.name,u)}else t.length===2&&this.cssRule(t[0],t[1]);return this};styfn.style=styfn.css;styfn.cssRule=function(n,t){var r=this.parse(n,t);if(r){var a=this.length-1;this[a].properties.push(r),this[a].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.mapped&&this[a].mappedProperties.push(r);var o=!this[a].selector;o&&(this._private.coreStyle[r.name]=r)}return this};styfn.append=function(n){return stylesheet(n)?n.appendToStyle(this):array(n)?this.appendFromJson(n):string(n)&&this.appendFromString(n),this};Style.fromJson=function(n,t){var r=new Style(n);return r.fromJson(t),r};Style.fromString=function(n,t){return new Style(n).fromString(t)};[styfn$8,styfn$7,styfn$6,styfn$5,styfn$4,styfn$3,styfn$2,styfn$1].forEach(function(n){extend(styfn,n)});Style.types=styfn.types;Style.properties=styfn.properties;Style.propertyGroups=styfn.propertyGroups;Style.propertyGroupNames=styfn.propertyGroupNames;Style.propertyGroupKeys=styfn.propertyGroupKeys;var corefn$2={style:function(t){if(t){var r=this.setStyle(t);r.update()}return this._private.style},setStyle:function(t){var r=this._private;return stylesheet(t)?r.style=t.generateStyle(this):array(t)?r.style=Style.fromJson(this,t):string(t)?r.style=Style.fromString(this,t):r.style=Style(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},defaultSelectionType="single",corefn$1={autolock:function(t){if(t!==void 0)this._private.autolock=!!t;else return this._private.autolock;return this},autoungrabify:function(t){if(t!==void 0)this._private.autoungrabify=!!t;else return this._private.autoungrabify;return this},autounselectify:function(t){if(t!==void 0)this._private.autounselectify=!!t;else return this._private.autounselectify;return this},selectionType:function(t){var r=this._private;if(r.selectionType==null&&(r.selectionType=defaultSelectionType),t!==void 0)(t==="additive"||t==="single")&&(r.selectionType=t);else return r.selectionType;return this},panningEnabled:function(t){if(t!==void 0)this._private.panningEnabled=!!t;else return this._private.panningEnabled;return this},userPanningEnabled:function(t){if(t!==void 0)this._private.userPanningEnabled=!!t;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(t){if(t!==void 0)this._private.zoomingEnabled=!!t;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(t){if(t!==void 0)this._private.userZoomingEnabled=!!t;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(t){if(t!==void 0)this._private.boxSelectionEnabled=!!t;else return this._private.boxSelectionEnabled;return this},pan:function(){var t=arguments,r=this._private.pan,a,o,u,s,c;switch(t.length){case 0:return r;case 1:if(string(t[0]))return a=t[0],r[a];if(plainObject(t[0])){if(!this._private.panningEnabled)return this;u=t[0],s=u.x,c=u.y,number$1(s)&&(r.x=s),number$1(c)&&(r.y=c),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;a=t[0],o=t[1],(a==="x"||a==="y")&&number$1(o)&&(r[a]=o),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(t,r){var a=arguments,o=this._private.pan,u,s,c,l,d;if(!this._private.panningEnabled)return this;switch(a.length){case 1:plainObject(t)&&(c=a[0],l=c.x,d=c.y,number$1(l)&&(o.x+=l),number$1(d)&&(o.y+=d),this.emit("pan viewport"));break;case 2:u=t,s=r,(u==="x"||u==="y")&&number$1(s)&&(o[u]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(t,r){var a=this.getFitViewport(t,r);if(a){var o=this._private;o.zoom=a.zoom,o.pan=a.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(t,r){if(number$1(t)&&r===void 0&&(r=t,t=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var a;if(string(t)){var o=t;t=this.$(o)}else if(boundingBox(t)){var u=t;a={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2},a.w=a.x2-a.x1,a.h=a.y2-a.y1}else elementOrCollection(t)||(t=this.mutableElements());if(!(elementOrCollection(t)&&t.empty())){a=a||t.boundingBox();var s=this.width(),c=this.height(),l;if(r=number$1(r)?r:0,!isNaN(s)&&!isNaN(c)&&s>0&&c>0&&!isNaN(a.w)&&!isNaN(a.h)&&a.w>0&&a.h>0){l=Math.min((s-2*r)/a.w,(c-2*r)/a.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var d={x:(s-l*(a.x1+a.x2))/2,y:(c-l*(a.y1+a.y2))/2};return{zoom:l,pan:d}}}}},zoomRange:function(t,r){var a=this._private;if(r==null){var o=t;t=o.min,r=o.max}return number$1(t)&&number$1(r)&&t<=r?(a.minZoom=t,a.maxZoom=r):number$1(t)&&r===void 0&&t<=a.maxZoom?a.minZoom=t:number$1(r)&&t===void 0&&r>=a.minZoom&&(a.maxZoom=r),this},minZoom:function(t){return t===void 0?this._private.minZoom:this.zoomRange({min:t})},maxZoom:function(t){return t===void 0?this._private.maxZoom:this.zoomRange({max:t})},getZoomedViewport:function(t){var r=this._private,a=r.pan,o=r.zoom,u,s,c=!1;if(r.zoomingEnabled||(c=!0),number$1(t)?s=t:plainObject(t)&&(s=t.level,t.position!=null?u=modelToRenderedPosition$1(t.position,o,a):t.renderedPosition!=null&&(u=t.renderedPosition),u!=null&&!r.panningEnabled&&(c=!0)),s=s>r.maxZoom?r.maxZoom:s,s=s<r.minZoom?r.minZoom:s,c||!number$1(s)||s===o||u!=null&&(!number$1(u.x)||!number$1(u.y)))return null;if(u!=null){var l=a,d=o,f=s,h={x:-f/d*(u.x-l.x)+u.x,y:-f/d*(u.y-l.y)+u.y};return{zoomed:!0,panned:!0,zoom:f,pan:h}}else return{zoomed:!0,panned:!1,zoom:s,pan:a}},zoom:function(t){if(t===void 0)return this._private.zoom;var r=this.getZoomedViewport(t),a=this._private;return r==null||!r.zoomed?this:(a.zoom=r.zoom,r.panned&&(a.pan.x=r.pan.x,a.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(t){var r=this._private,a=!0,o=!0,u=[],s=!1,c=!1;if(!t)return this;if(number$1(t.zoom)||(a=!1),plainObject(t.pan)||(o=!1),!a&&!o)return this;if(a){var l=t.zoom;l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled?s=!0:(r.zoom=l,u.push("zoom"))}if(o&&(!s||!t.cancelOnFailedZoom)&&r.panningEnabled){var d=t.pan;number$1(d.x)&&(r.pan.x=d.x,c=!1),number$1(d.y)&&(r.pan.y=d.y,c=!1),c||u.push("pan")}return u.length>0&&(u.push("viewport"),this.emit(u.join(" ")),this.notify("viewport")),this},center:function(t){var r=this.getCenterPan(t);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(t,r){if(this._private.panningEnabled){if(string(t)){var a=t;t=this.mutableElements().filter(a)}else elementOrCollection(t)||(t=this.mutableElements());if(t.length!==0){var o=t.boundingBox(),u=this.width(),s=this.height();r=r===void 0?this._private.zoom:r;var c={x:(u-r*(o.x1+o.x2))/2,y:(s-r*(o.y1+o.y2))/2};return c}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var t=this._private,r=t.container,a=this;return t.sizeCache=t.sizeCache||(r?function(){var o=a.window().getComputedStyle(r),u=function(c){return parseFloat(o.getPropertyValue(c))};return{width:r.clientWidth-u("padding-left")-u("padding-right"),height:r.clientHeight-u("padding-top")-u("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var t=this._private.pan,r=this._private.zoom,a=this.renderedExtent(),o={x1:(a.x1-t.x)/r,x2:(a.x2-t.x)/r,y1:(a.y1-t.y)/r,y2:(a.y2-t.y)/r};return o.w=o.x2-o.x1,o.h=o.y2-o.y1,o},renderedExtent:function(){var t=this.width(),r=this.height();return{x1:0,y1:0,x2:t,y2:r,w:t,h:r}},multiClickDebounceTime:function(t){if(t)this._private.multiClickDebounceTime=t;else return this._private.multiClickDebounceTime;return this}};corefn$1.centre=corefn$1.center;corefn$1.autolockNodes=corefn$1.autolock;corefn$1.autoungrabifyNodes=corefn$1.autoungrabify;var fn={data:define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:define.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};fn.attr=fn.data;fn.removeAttr=fn.removeData;var Core=function(t){var r=this;t=extend({},t);var a=t.container;a&&!htmlElement(a)&&htmlElement(a[0])&&(a=a[0]);var o=a?a._cyreg:null;o=o||{},o&&o.cy&&(o.cy.destroy(),o={});var u=o.readies=o.readies||[];a&&(a._cyreg=o),o.cy=r;var s=_window!==void 0&&a!==void 0&&!t.headless,c=t;c.layout=extend({name:s?"grid":"null"},c.layout),c.renderer=extend({name:s?"canvas":"null"},c.renderer);var l=function(b,_,S){return _!==void 0?_:S!==void 0?S:b},d=this._private={container:a,ready:!1,options:c,elements:new Collection(this),listeners:[],aniEles:new Collection(this),data:c.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,c.zoomingEnabled),userZoomingEnabled:l(!0,c.userZoomingEnabled),panningEnabled:l(!0,c.panningEnabled),userPanningEnabled:l(!0,c.userPanningEnabled),boxSelectionEnabled:l(!0,c.boxSelectionEnabled),autolock:l(!1,c.autolock,c.autolockNodes),autoungrabify:l(!1,c.autoungrabify,c.autoungrabifyNodes),autounselectify:l(!1,c.autounselectify),styleEnabled:c.styleEnabled===void 0?s:c.styleEnabled,zoom:number$1(c.zoom)?c.zoom:1,pan:{x:plainObject(c.pan)&&number$1(c.pan.x)?c.pan.x:0,y:plainObject(c.pan)&&number$1(c.pan.y)?c.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,c.multiClickDebounceTime)};this.createEmitter(),this.selectionType(c.selectionType),this.zoomRange({min:c.minZoom,max:c.maxZoom});var f=function(b,_){var S=b.some(promise);if(S)return Promise$1.all(b).then(_);_(b)};d.styleEnabled&&r.setStyle([]);var h=extend({},c,c.renderer);r.initRenderer(h);var v=function(b,_,S){r.notifications(!1);var T=r.mutableElements();T.length>0&&T.remove(),b!=null&&(plainObject(b)||array(b))&&r.add(b),r.one("layoutready",function(A){r.notifications(!0),r.emit(A),r.one("load",_),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",S),r.emit("done")});var w=extend({},r._private.options.layout);w.eles=r.elements(),r.layout(w).run()};f([c.style,c.elements],function(g){var b=g[0],_=g[1];d.styleEnabled&&r.style().append(b),v(_,function(){r.startAnimationLoop(),d.ready=!0,fn$6(c.ready)&&r.on("ready",c.ready);for(var S=0;S<u.length;S++){var T=u[S];r.on("ready",T)}o&&(o.readies=[]),r.emit("ready")},c.done)})},corefn=Core.prototype;extend(corefn,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(t){return this.isReady()?this.emitter().emit("ready",[],t):this.on("ready",t),this},destroy:function(){var t=this;if(!t.destroyed())return t.stopAnimationLoop(),t.destroyRenderer(),this.emit("destroy"),t._private.destroyed=!0,t},hasElementWithId:function(t){return this._private.elements.hasElementWithId(t)},getElementById:function(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(t){return this._private.elements.merge(t),this},removeFromPool:function(t){return this._private.elements.unmerge(t),this},container:function(){return this._private.container||null},window:function(){var t=this._private.container;if(t==null)return _window;var r=this._private.container.ownerDocument;return r===void 0||r==null?_window:r.defaultView||_window},mount:function(t){if(t!=null){var r=this,a=r._private,o=a.options;return!htmlElement(t)&&htmlElement(t[0])&&(t=t[0]),r.stopAnimationLoop(),r.destroyRenderer(),a.container=t,a.styleEnabled=!0,r.invalidateSize(),r.initRenderer(extend({},o,o.renderer,{name:o.renderer.name==="null"?"canvas":o.renderer.name})),r.startAnimationLoop(),r.style(o.style),r.emit("mount"),r}},unmount:function(){var t=this;return t.stopAnimationLoop(),t.destroyRenderer(),t.initRenderer({name:"null"}),t.emit("unmount"),t},options:function(){return copy(this._private.options)},json:function(t){var r=this,a=r._private,o=r.mutableElements(),u=function(R){return r.getElementById(R.id())};if(plainObject(t)){if(r.startBatch(),t.elements){var s={},c=function(R,E){for(var I=[],L=[],F=0;F<R.length;F++){var D=R[F];if(!D.data.id){warn("cy.json() cannot handle elements without an ID attribute");continue}var $=""+D.data.id,O=r.getElementById($);s[$]=!0,O.length!==0?L.push({ele:O,json:D}):(E&&(D.group=E),I.push(D))}r.add(I);for(var P=0;P<L.length;P++){var C=L[P],q=C.ele,M=C.json;q.json(M)}};if(array(t.elements))c(t.elements);else for(var l=["nodes","edges"],d=0;d<l.length;d++){var f=l[d],h=t.elements[f];array(h)&&c(h,f)}var v=r.collection();o.filter(function(A){return!s[A.id()]}).forEach(function(A){A.isParent()?v.merge(A):A.remove()}),v.forEach(function(A){return A.children().move({parent:null})}),v.forEach(function(A){return u(A).remove()})}t.style&&r.style(t.style),t.zoom!=null&&t.zoom!==a.zoom&&r.zoom(t.zoom),t.pan&&(t.pan.x!==a.pan.x||t.pan.y!==a.pan.y)&&r.pan(t.pan),t.data&&r.data(t.data);for(var g=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],b=0;b<g.length;b++){var _=g[b];t[_]!=null&&r[_](t[_])}return r.endBatch(),this}else{var S=!!t,T={};S?T.elements=this.elements().map(function(A){return A.json()}):(T.elements={},o.forEach(function(A){var R=A.group();T.elements[R]||(T.elements[R]=[]),T.elements[R].push(A.json())})),this._private.styleEnabled&&(T.style=r.style().json()),T.data=copy(r.data());var w=a.options;return T.zoomingEnabled=a.zoomingEnabled,T.userZoomingEnabled=a.userZoomingEnabled,T.zoom=a.zoom,T.minZoom=a.minZoom,T.maxZoom=a.maxZoom,T.panningEnabled=a.panningEnabled,T.userPanningEnabled=a.userPanningEnabled,T.pan=copy(a.pan),T.boxSelectionEnabled=a.boxSelectionEnabled,T.renderer=copy(w.renderer),T.hideEdgesOnViewport=w.hideEdgesOnViewport,T.textureOnViewport=w.textureOnViewport,T.wheelSensitivity=w.wheelSensitivity,T.motionBlur=w.motionBlur,T.multiClickDebounceTime=w.multiClickDebounceTime,T}}});corefn.$id=corefn.getElementById;[corefn$9,corefn$8,elesfn,corefn$7,corefn$6,corefn$5,corefn$4,corefn$3,corefn$2,corefn$1,fn].forEach(function(n){extend(corefn,n)});var defaults$7={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}},deprecatedOptionDefaults={maximal:!1,acyclic:!1},getInfo=function(t){return t.scratch("breadthfirst")},setInfo=function(t,r){return t.scratch("breadthfirst",r)};function BreadthFirstLayout(n){this.options=extend({},defaults$7,deprecatedOptionDefaults,n)}BreadthFirstLayout.prototype.run=function(){var n=this.options,t=n.cy,r=n.eles,a=r.nodes().filter(function(se){return se.isChildless()}),o=r,u=n.directed,s=n.acyclic||n.maximal||n.maximalAdjustments>0,c=!!n.boundingBox,l=t.extent(),d=makeBoundingBox(c?n.boundingBox:{x1:l.x1,y1:l.y1,w:l.w,h:l.h}),f;if(elementOrCollection(n.roots))f=n.roots;else if(array(n.roots)){for(var h=[],v=0;v<n.roots.length;v++){var g=n.roots[v],b=t.getElementById(g);h.push(b)}f=t.collection(h)}else if(string(n.roots))f=t.$(n.roots);else if(u)f=a.roots();else{var _=r.components();f=t.collection();for(var S=function(ne){var he=_[ne],xe=he.maxDegree(!1),me=he.filter(function(Ie){return Ie.degree(!1)===xe});f=f.add(me)},T=0;T<_.length;T++)S(T)}var w=[],A={},R=function(ne,he){w[he]==null&&(w[he]=[]);var xe=w[he].length;w[he].push(ne),setInfo(ne,{index:xe,depth:he})},E=function(ne,he){var xe=getInfo(ne),me=xe.depth,Ie=xe.index;w[me][Ie]=null,ne.isChildless()&&R(ne,he)};o.bfs({roots:f,directed:n.directed,visit:function(ne,he,xe,me,Ie){var Pe=ne[0],Ce=Pe.id();Pe.isChildless()&&R(Pe,Ie),A[Ce]=!0}});for(var I=[],L=0;L<a.length;L++){var F=a[L];A[F.id()]||I.push(F)}var D=function(ne){for(var he=w[ne],xe=0;xe<he.length;xe++){var me=he[xe];if(me==null){he.splice(xe,1),xe--;continue}setInfo(me,{depth:ne,index:xe})}},$=function(ne,he){for(var xe=getInfo(ne),me=ne.incomers().filter(function(Q){return Q.isNode()&&r.has(Q)}),Ie=-1,Pe=ne.id(),Ce=0;Ce<me.length;Ce++){var pe=me[Ce],H=getInfo(pe);Ie=Math.max(Ie,H.depth)}if(xe.depth<=Ie){if(!n.acyclic&&he[Pe])return null;var V=Ie+1;return E(ne,V),he[Pe]=V,!0}return!1};if(u&&s){var O=[],P={},C=function(ne){return O.push(ne)},q=function(){return O.shift()};for(a.forEach(function(se){return O.push(se)});O.length>0;){var M=q(),N=$(M,P);if(N)M.outgoers().filter(function(se){return se.isNode()&&r.has(se)}).forEach(C);else if(N===null){warn("Detected double maximal shift for node `"+M.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var G=0;if(n.avoidOverlap)for(var X=0;X<a.length;X++){var Y=a[X],W=Y.layoutDimensions(n),te=W.w,ue=W.h;G=Math.max(G,te,ue)}var fe={},re=function(ne){if(fe[ne.id()])return fe[ne.id()];for(var he=getInfo(ne).depth,xe=ne.neighborhood(),me=0,Ie=0,Pe=0;Pe<xe.length;Pe++){var Ce=xe[Pe];if(!(Ce.isEdge()||Ce.isParent()||!a.has(Ce))){var pe=getInfo(Ce);if(pe!=null){var H=pe.index,V=pe.depth;if(!(H==null||V==null)){var Q=w[V].length;V<he&&(me+=H/Q,Ie++)}}}}return Ie=Math.max(1,Ie),me=me/Ie,Ie===0&&(me=0),fe[ne.id()]=me,me},ye=function(ne,he){var xe=re(ne),me=re(he),Ie=xe-me;return Ie===0?ascending(ne.id(),he.id()):Ie};n.depthSort!==void 0&&(ye=n.depthSort);for(var Te=w.length,Re=0;Re<Te;Re++)w[Re].sort(ye),D(Re);for(var ve=[],ce=0;ce<I.length;ce++)ve.push(I[ce]);var J=function(){for(var ne=0;ne<Te;ne++)D(ne)};ve.length&&(w.unshift(ve),Te=w.length,J());for(var j=0,z=0;z<Te;z++)j=Math.max(w[z].length,j);var B={x:d.x1+d.w/2,y:d.y1+d.h/2},U=a.reduce(function(se,ne){return function(he){return{w:se.w===-1?he.w:(se.w+he.w)/2,h:se.h===-1?he.h:(se.h+he.h)/2}}(ne.boundingBox({includeLabels:n.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Z=Math.max(Te===1?0:c?(d.h-n.padding*2-U.h)/(Te-1):(d.h-n.padding*2-U.h)/(Te+1),G),oe=w.reduce(function(se,ne){return Math.max(se,ne.length)},0),ie=function(ne){var he=getInfo(ne),xe=he.depth,me=he.index;if(n.circle){var Ie=Math.min(d.w/2/Te,d.h/2/Te);Ie=Math.max(Ie,G);var Pe=Ie*xe+Ie-(Te>0&&w[0].length<=3?Ie/2:0),Ce=2*Math.PI/w[xe].length*me;return xe===0&&w[0].length===1&&(Pe=1),{x:B.x+Pe*Math.cos(Ce),y:B.y+Pe*Math.sin(Ce)}}else{var pe=w[xe].length,H=Math.max(pe===1?0:c?(d.w-n.padding*2-U.w)/((n.grid?oe:pe)-1):(d.w-n.padding*2-U.w)/((n.grid?oe:pe)+1),G),V={x:B.x+(me+1-(pe+1)/2)*H,y:B.y+(xe+1-(Te+1)/2)*Z};return V}};return r.nodes().layoutPositions(this,n,ie),this};var defaults$6={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}};function CircleLayout(n){this.options=extend({},defaults$6,n)}CircleLayout.prototype.run=function(){var n=this.options,t=n,r=n.cy,a=t.eles,o=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,u=a.nodes().not(":parent");t.sort&&(u=u.sort(t.sort));for(var s=makeBoundingBox(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),c={x:s.x1+s.w/2,y:s.y1+s.h/2},l=t.sweep===void 0?2*Math.PI-2*Math.PI/u.length:t.sweep,d=l/Math.max(1,u.length-1),f,h=0,v=0;v<u.length;v++){var g=u[v],b=g.layoutDimensions(t),_=b.w,S=b.h;h=Math.max(h,_,S)}if(number$1(t.radius)?f=t.radius:u.length<=1?f=0:f=Math.min(s.h,s.w)/2-h,u.length>1&&t.avoidOverlap){h*=1.75;var T=Math.cos(d)-Math.cos(0),w=Math.sin(d)-Math.sin(0),A=Math.sqrt(h*h/(T*T+w*w));f=Math.max(A,f)}var R=function(I,L){var F=t.startAngle+L*d*(o?1:-1),D=f*Math.cos(F),$=f*Math.sin(F),O={x:c.x+D,y:c.y+$};return O};return a.nodes().layoutPositions(this,t,R),this};var defaults$5={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(t){return t.degree()},levelWidth:function(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}};function ConcentricLayout(n){this.options=extend({},defaults$5,n)}ConcentricLayout.prototype.run=function(){for(var n=this.options,t=n,r=t.counterclockwise!==void 0?!t.counterclockwise:t.clockwise,a=n.cy,o=t.eles,u=o.nodes().not(":parent"),s=makeBoundingBox(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()}),c={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],d=0,f=0;f<u.length;f++){var h=u[f],v=void 0;v=t.concentric(h),l.push({value:v,node:h}),h._private.scratch.concentric=v}u.updateStyle();for(var g=0;g<u.length;g++){var b=u[g],_=b.layoutDimensions(t);d=Math.max(d,_.w,_.h)}l.sort(function(U,Z){return Z.value-U.value});for(var S=t.levelWidth(u),T=[[]],w=T[0],A=0;A<l.length;A++){var R=l[A];if(w.length>0){var E=Math.abs(w[0].value-R.value);E>=S&&(w=[],T.push(w))}w.push(R)}var I=d+t.minNodeSpacing;if(!t.avoidOverlap){var L=T.length>0&&T[0].length>1,F=Math.min(s.w,s.h)/2-I,D=F/(T.length+L?1:0);I=Math.min(I,D)}for(var $=0,O=0;O<T.length;O++){var P=T[O],C=t.sweep===void 0?2*Math.PI-2*Math.PI/P.length:t.sweep,q=P.dTheta=C/Math.max(1,P.length-1);if(P.length>1&&t.avoidOverlap){var M=Math.cos(q)-Math.cos(0),N=Math.sin(q)-Math.sin(0),G=Math.sqrt(I*I/(M*M+N*N));$=Math.max(G,$)}P.r=$,$+=I}if(t.equidistant){for(var X=0,Y=0,W=0;W<T.length;W++){var te=T[W],ue=te.r-Y;X=Math.max(X,ue)}Y=0;for(var fe=0;fe<T.length;fe++){var re=T[fe];fe===0&&(Y=re.r),re.r=Y,Y+=X}}for(var ye={},Te=0;Te<T.length;Te++)for(var Re=T[Te],ve=Re.dTheta,ce=Re.r,J=0;J<Re.length;J++){var j=Re[J],z=t.startAngle+(r?1:-1)*ve*J,B={x:c.x+ce*Math.cos(z),y:c.y+ce*Math.sin(z)};ye[j.node.id()]=B}return o.nodes().layoutPositions(this,t,function(U){var Z=U.id();return ye[Z]}),this};var DEBUG,defaults$4={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(t,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(t){return 2048},nodeOverlap:4,idealEdgeLength:function(t){return 32},edgeElasticity:function(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function CoseLayout(n){this.options=extend({},defaults$4,n),this.options.layout=this;var t=this.options.eles.nodes(),r=this.options.eles.edges(),a=r.filter(function(o){var u=o.source().data("id"),s=o.target().data("id"),c=t.some(function(d){return d.data("id")===u}),l=t.some(function(d){return d.data("id")===s});return!c||!l});this.options.eles=this.options.eles.not(a)}CoseLayout.prototype.run=function(){var n=this.options,t=n.cy,r=this;r.stopped=!1,(n.animate===!0||n.animate===!1)&&r.emit({type:"layoutstart",layout:r}),n.debug===!0?DEBUG=!0:DEBUG=!1;var a=createLayoutInfo(t,r,n);DEBUG&&printLayoutInfo(a),n.randomize&&randomizePositions(a);var o=performanceNow(),u=function(){refreshPositions(a,t,n),n.fit===!0&&t.fit(n.padding)},s=function(v){return!(r.stopped||v>=n.numIter||(step(a,n),a.temperature=a.temperature*n.coolingFactor,a.temperature<n.minTemp))},c=function(){if(n.animate===!0||n.animate===!1)u(),r.one("layoutstop",n.stop),r.emit({type:"layoutstop",layout:r});else{var v=n.eles.nodes(),g=getScaleInBoundsFn(a,n,v);v.layoutPositions(r,n,g)}},l=0,d=!0;if(n.animate===!0){var f=function h(){for(var v=0;d&&v<n.refresh;)d=s(l),l++,v++;if(!d)separateComponents(a,n),c();else{var g=performanceNow();g-o>=n.animationThreshold&&u(),requestAnimationFrame(h)}};f()}else{for(;d;)d=s(l),l++;separateComponents(a,n),c()}return this};CoseLayout.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};CoseLayout.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var createLayoutInfo=function(t,r,a){for(var o=a.eles.edges(),u=a.eles.nodes(),s=makeBoundingBox(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),c={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:u.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:o.size(),temperature:a.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=a.eles.components(),d={},f=0;f<l.length;f++)for(var h=l[f],v=0;v<h.length;v++){var g=h[v];d[g.id()]=f}for(var f=0;f<c.nodeSize;f++){var b=u[f],_=b.layoutDimensions(a),S={};S.isLocked=b.locked(),S.id=b.data("id"),S.parentId=b.data("parent"),S.cmptId=d[b.id()],S.children=[],S.positionX=b.position("x"),S.positionY=b.position("y"),S.offsetX=0,S.offsetY=0,S.height=_.w,S.width=_.h,S.maxX=S.positionX+S.width/2,S.minX=S.positionX-S.width/2,S.maxY=S.positionY+S.height/2,S.minY=S.positionY-S.height/2,S.padLeft=parseFloat(b.style("padding")),S.padRight=parseFloat(b.style("padding")),S.padTop=parseFloat(b.style("padding")),S.padBottom=parseFloat(b.style("padding")),S.nodeRepulsion=fn$6(a.nodeRepulsion)?a.nodeRepulsion(b):a.nodeRepulsion,c.layoutNodes.push(S),c.idToIndex[S.id]=f}for(var T=[],w=0,A=-1,R=[],f=0;f<c.nodeSize;f++){var b=c.layoutNodes[f],E=b.parentId;E!=null?c.layoutNodes[c.idToIndex[E]].children.push(b.id):(T[++A]=b.id,R.push(b.id))}for(c.graphSet.push(R);w<=A;){var I=T[w++],L=c.idToIndex[I],g=c.layoutNodes[L],F=g.children;if(F.length>0){c.graphSet.push(F);for(var f=0;f<F.length;f++)T[++A]=F[f]}}for(var f=0;f<c.graphSet.length;f++)for(var D=c.graphSet[f],v=0;v<D.length;v++){var $=c.idToIndex[D[v]];c.indexToGraph[$]=f}for(var f=0;f<c.edgeSize;f++){var O=o[f],P={};P.id=O.data("id"),P.sourceId=O.data("source"),P.targetId=O.data("target");var C=fn$6(a.idealEdgeLength)?a.idealEdgeLength(O):a.idealEdgeLength,q=fn$6(a.edgeElasticity)?a.edgeElasticity(O):a.edgeElasticity,M=c.idToIndex[P.sourceId],N=c.idToIndex[P.targetId],G=c.indexToGraph[M],X=c.indexToGraph[N];if(G!=X){for(var Y=findLCA(P.sourceId,P.targetId,c),W=c.graphSet[Y],te=0,S=c.layoutNodes[M];W.indexOf(S.id)===-1;)S=c.layoutNodes[c.idToIndex[S.parentId]],te++;for(S=c.layoutNodes[N];W.indexOf(S.id)===-1;)S=c.layoutNodes[c.idToIndex[S.parentId]],te++;C*=te*a.nestingFactor}P.idealLength=C,P.elasticity=q,c.layoutEdges.push(P)}return c},findLCA=function(t,r,a){var o=findLCA_aux(t,r,0,a);return 2>o.count?0:o.graph},findLCA_aux=function n(t,r,a,o){var u=o.graphSet[a];if(-1<u.indexOf(t)&&-1<u.indexOf(r))return{count:2,graph:a};for(var s=0,c=0;c<u.length;c++){var l=u[c],d=o.idToIndex[l],f=o.layoutNodes[d].children;if(f.length!==0){var h=o.indexToGraph[o.idToIndex[f[0]]],v=n(t,r,h,o);if(v.count!==0)if(v.count===1){if(s++,s===2)break}else return v}}return{count:s,graph:a}},printLayoutInfo,randomizePositions=function(t,r){for(var a=t.clientWidth,o=t.clientHeight,u=0;u<t.nodeSize;u++){var s=t.layoutNodes[u];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*a,s.positionY=Math.random()*o)}},getScaleInBoundsFn=function(t,r,a){var o=t.boundingBox,u={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(a.forEach(function(s){var c=t.layoutNodes[t.idToIndex[s.data("id")]];u.x1=Math.min(u.x1,c.positionX),u.x2=Math.max(u.x2,c.positionX),u.y1=Math.min(u.y1,c.positionY),u.y2=Math.max(u.y2,c.positionY)}),u.w=u.x2-u.x1,u.h=u.y2-u.y1),function(s,c){var l=t.layoutNodes[t.idToIndex[s.data("id")]];if(r.boundingBox){var d=(l.positionX-u.x1)/u.w,f=(l.positionY-u.y1)/u.h;return{x:o.x1+d*o.w,y:o.y1+f*o.h}}else return{x:l.positionX,y:l.positionY}}},refreshPositions=function(t,r,a){var o=a.layout,u=a.eles.nodes(),s=getScaleInBoundsFn(t,a,u);u.positions(s),t.ready!==!0&&(t.ready=!0,o.one("layoutready",a.ready),o.emit({type:"layoutready",layout:this}))},step=function(t,r,a){calculateNodeForces(t,r),calculateEdgeForces(t),calculateGravityForces(t,r),propagateForces(t),updatePositions(t)},calculateNodeForces=function(t,r){for(var a=0;a<t.graphSet.length;a++)for(var o=t.graphSet[a],u=o.length,s=0;s<u;s++)for(var c=t.layoutNodes[t.idToIndex[o[s]]],l=s+1;l<u;l++){var d=t.layoutNodes[t.idToIndex[o[l]]];nodeRepulsion(c,d,t,r)}},randomDistance=function(t){return-1+2*t*Math.random()},nodeRepulsion=function(t,r,a,o){var u=t.cmptId,s=r.cmptId;if(!(u!==s&&!a.isCompound)){var c=r.positionX-t.positionX,l=r.positionY-t.positionY,d=1;c===0&&l===0&&(c=randomDistance(d),l=randomDistance(d));var f=nodesOverlap(t,r,c,l);if(f>0)var h=o.nodeOverlap*f,v=Math.sqrt(c*c+l*l),g=h*c/v,b=h*l/v;else var _=findClippingPoint(t,c,l),S=findClippingPoint(r,-1*c,-1*l),T=S.x-_.x,w=S.y-_.y,A=T*T+w*w,v=Math.sqrt(A),h=(t.nodeRepulsion+r.nodeRepulsion)/A,g=h*T/v,b=h*w/v;t.isLocked||(t.offsetX-=g,t.offsetY-=b),r.isLocked||(r.offsetX+=g,r.offsetY+=b)}},nodesOverlap=function(t,r,a,o){if(a>0)var u=t.maxX-r.minX;else var u=r.maxX-t.minX;if(o>0)var s=t.maxY-r.minY;else var s=r.maxY-t.minY;return u>=0&&s>=0?Math.sqrt(u*u+s*s):0},findClippingPoint=function(t,r,a){var o=t.positionX,u=t.positionY,s=t.height||1,c=t.width||1,l=a/r,d=s/c,f={};return r===0&&0<a||r===0&&0>a?(f.x=o,f.y=u+s/2,f):0<r&&-1*d<=l&&l<=d?(f.x=o+c/2,f.y=u+c*a/2/r,f):0>r&&-1*d<=l&&l<=d?(f.x=o-c/2,f.y=u-c*a/2/r,f):0<a&&(l<=-1*d||l>=d)?(f.x=o+s*r/2/a,f.y=u+s/2,f):(0>a&&(l<=-1*d||l>=d)&&(f.x=o-s*r/2/a,f.y=u-s/2),f)},calculateEdgeForces=function(t,r){for(var a=0;a<t.edgeSize;a++){var o=t.layoutEdges[a],u=t.idToIndex[o.sourceId],s=t.layoutNodes[u],c=t.idToIndex[o.targetId],l=t.layoutNodes[c],d=l.positionX-s.positionX,f=l.positionY-s.positionY;if(!(d===0&&f===0)){var h=findClippingPoint(s,d,f),v=findClippingPoint(l,-1*d,-1*f),g=v.x-h.x,b=v.y-h.y,_=Math.sqrt(g*g+b*b),S=Math.pow(o.idealLength-_,2)/o.elasticity;if(_!==0)var T=S*g/_,w=S*b/_;else var T=0,w=0;s.isLocked||(s.offsetX+=T,s.offsetY+=w),l.isLocked||(l.offsetX-=T,l.offsetY-=w)}}},calculateGravityForces=function(t,r){if(r.gravity!==0)for(var a=1,o=0;o<t.graphSet.length;o++){var u=t.graphSet[o],s=u.length;if(o===0)var c=t.clientHeight/2,l=t.clientWidth/2;else var d=t.layoutNodes[t.idToIndex[u[0]]],f=t.layoutNodes[t.idToIndex[d.parentId]],c=f.positionX,l=f.positionY;for(var h=0;h<s;h++){var v=t.layoutNodes[t.idToIndex[u[h]]];if(!v.isLocked){var g=c-v.positionX,b=l-v.positionY,_=Math.sqrt(g*g+b*b);if(_>a){var S=r.gravity*g/_,T=r.gravity*b/_;v.offsetX+=S,v.offsetY+=T}}}}},propagateForces=function(t,r){var a=[],o=0,u=-1;for(a.push.apply(a,t.graphSet[0]),u+=t.graphSet[0].length;o<=u;){var s=a[o++],c=t.idToIndex[s],l=t.layoutNodes[c],d=l.children;if(0<d.length&&!l.isLocked){for(var f=l.offsetX,h=l.offsetY,v=0;v<d.length;v++){var g=t.layoutNodes[t.idToIndex[d[v]]];g.offsetX+=f,g.offsetY+=h,a[++u]=d[v]}l.offsetX=0,l.offsetY=0}}},updatePositions=function(t,r){for(var a=0;a<t.nodeSize;a++){var o=t.layoutNodes[a];0<o.children.length&&(o.maxX=void 0,o.minX=void 0,o.maxY=void 0,o.minY=void 0)}for(var a=0;a<t.nodeSize;a++){var o=t.layoutNodes[a];if(!(0<o.children.length||o.isLocked)){var u=limitForce(o.offsetX,o.offsetY,t.temperature);o.positionX+=u.x,o.positionY+=u.y,o.offsetX=0,o.offsetY=0,o.minX=o.positionX-o.width,o.maxX=o.positionX+o.width,o.minY=o.positionY-o.height,o.maxY=o.positionY+o.height,updateAncestryBoundaries(o,t)}}for(var a=0;a<t.nodeSize;a++){var o=t.layoutNodes[a];0<o.children.length&&!o.isLocked&&(o.positionX=(o.maxX+o.minX)/2,o.positionY=(o.maxY+o.minY)/2,o.width=o.maxX-o.minX,o.height=o.maxY-o.minY)}},limitForce=function(t,r,a){var o=Math.sqrt(t*t+r*r);if(o>a)var u={x:a*t/o,y:a*r/o};else var u={x:t,y:r};return u},updateAncestryBoundaries=function n(t,r){var a=t.parentId;if(a!=null){var o=r.layoutNodes[r.idToIndex[a]],u=!1;if((o.maxX==null||t.maxX+o.padRight>o.maxX)&&(o.maxX=t.maxX+o.padRight,u=!0),(o.minX==null||t.minX-o.padLeft<o.minX)&&(o.minX=t.minX-o.padLeft,u=!0),(o.maxY==null||t.maxY+o.padBottom>o.maxY)&&(o.maxY=t.maxY+o.padBottom,u=!0),(o.minY==null||t.minY-o.padTop<o.minY)&&(o.minY=t.minY-o.padTop,u=!0),u)return n(o,r)}},separateComponents=function(t,r){for(var a=t.layoutNodes,o=[],u=0;u<a.length;u++){var s=a[u],c=s.cmptId,l=o[c]=o[c]||[];l.push(s)}for(var d=0,u=0;u<o.length;u++){var f=o[u];if(f){f.x1=1/0,f.x2=-1/0,f.y1=1/0,f.y2=-1/0;for(var h=0;h<f.length;h++){var v=f[h];f.x1=Math.min(f.x1,v.positionX-v.width/2),f.x2=Math.max(f.x2,v.positionX+v.width/2),f.y1=Math.min(f.y1,v.positionY-v.height/2),f.y2=Math.max(f.y2,v.positionY+v.height/2)}f.w=f.x2-f.x1,f.h=f.y2-f.y1,d+=f.w*f.h}}o.sort(function(w,A){return A.w*A.h-w.w*w.h});for(var g=0,b=0,_=0,S=0,T=Math.sqrt(d)*t.clientWidth/t.clientHeight,u=0;u<o.length;u++){var f=o[u];if(f){for(var h=0;h<f.length;h++){var v=f[h];v.isLocked||(v.positionX+=g-f.x1,v.positionY+=b-f.y1)}g+=f.w+r.componentSpacing,_+=f.w+r.componentSpacing,S=Math.max(S,f.h),_>T&&(b+=S+r.componentSpacing,g=0,_=0,S=0)}}},defaults$3={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(t){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}};function GridLayout(n){this.options=extend({},defaults$3,n)}GridLayout.prototype.run=function(){var n=this.options,t=n,r=n.cy,a=t.eles,o=a.nodes().not(":parent");t.sort&&(o=o.sort(t.sort));var u=makeBoundingBox(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(u.h===0||u.w===0)a.nodes().layoutPositions(this,t,function(fe){return{x:u.x1,y:u.y1}});else{var s=o.size(),c=Math.sqrt(s*u.h/u.w),l=Math.round(c),d=Math.round(u.w/u.h*c),f=function(re){if(re==null)return Math.min(l,d);var ye=Math.min(l,d);ye==l?l=re:d=re},h=function(re){if(re==null)return Math.max(l,d);var ye=Math.max(l,d);ye==l?l=re:d=re},v=t.rows,g=t.cols!=null?t.cols:t.columns;if(v!=null&&g!=null)l=v,d=g;else if(v!=null&&g==null)l=v,d=Math.ceil(s/l);else if(v==null&&g!=null)d=g,l=Math.ceil(s/d);else if(d*l>s){var b=f(),_=h();(b-1)*_>=s?f(b-1):(_-1)*b>=s&&h(_-1)}else for(;d*l<s;){var S=f(),T=h();(T+1)*S>=s?h(T+1):f(S+1)}var w=u.w/d,A=u.h/l;if(t.condense&&(w=0,A=0),t.avoidOverlap)for(var R=0;R<o.length;R++){var E=o[R],I=E._private.position;(I.x==null||I.y==null)&&(I.x=0,I.y=0);var L=E.layoutDimensions(t),F=t.avoidOverlapPadding,D=L.w+F,$=L.h+F;w=Math.max(w,D),A=Math.max(A,$)}for(var O={},P=function(re,ye){return!!O["c-"+re+"-"+ye]},C=function(re,ye){O["c-"+re+"-"+ye]=!0},q=0,M=0,N=function(){M++,M>=d&&(M=0,q++)},G={},X=0;X<o.length;X++){var Y=o[X],W=t.position(Y);if(W&&(W.row!==void 0||W.col!==void 0)){var te={row:W.row,col:W.col};if(te.col===void 0)for(te.col=0;P(te.row,te.col);)te.col++;else if(te.row===void 0)for(te.row=0;P(te.row,te.col);)te.row++;G[Y.id()]=te,C(te.row,te.col)}}var ue=function(re,ye){var Te,Re;if(re.locked()||re.isParent())return!1;var ve=G[re.id()];if(ve)Te=ve.col*w+w/2+u.x1,Re=ve.row*A+A/2+u.y1;else{for(;P(q,M);)N();Te=M*w+w/2+u.x1,Re=q*A+A/2+u.y1,C(q,M),N()}return{x:Te,y:Re}};o.layoutPositions(this,t,ue)}return this};var defaults$2={ready:function(){},stop:function(){}};function NullLayout(n){this.options=extend({},defaults$2,n)}NullLayout.prototype.run=function(){var n=this.options,t=n.eles,r=this;return n.cy,r.emit("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",n.ready),r.emit("layoutready"),r.one("layoutstop",n.stop),r.emit("layoutstop"),this};NullLayout.prototype.stop=function(){return this};var defaults$1={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}};function PresetLayout(n){this.options=extend({},defaults$1,n)}PresetLayout.prototype.run=function(){var n=this.options,t=n.eles,r=t.nodes(),a=fn$6(n.positions);function o(u){if(n.positions==null)return copyPosition(u.position());if(a)return n.positions(u);var s=n.positions[u._private.data.id];return s??null}return r.layoutPositions(this,n,function(u,s){var c=o(u);return u.locked()||c==null?!1:c}),this};var defaults={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,r){return!0},ready:void 0,stop:void 0,transform:function(t,r){return r}};function RandomLayout(n){this.options=extend({},defaults,n)}RandomLayout.prototype.run=function(){var n=this.options,t=n.cy,r=n.eles,a=makeBoundingBox(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()}),o=function(s,c){return{x:a.x1+Math.round(Math.random()*a.w),y:a.y1+Math.round(Math.random()*a.h)}};return r.nodes().layoutPositions(this,n,o),this};var layout$1=[{name:"breadthfirst",impl:BreadthFirstLayout},{name:"circle",impl:CircleLayout},{name:"concentric",impl:ConcentricLayout},{name:"cose",impl:CoseLayout},{name:"grid",impl:GridLayout},{name:"null",impl:NullLayout},{name:"preset",impl:PresetLayout},{name:"random",impl:RandomLayout}];function NullRenderer(n){this.options=n,this.notifications=0}var noop=function(){},throwImgErr=function(){throw new Error("A headless instance can not render images")};NullRenderer.prototype={recalculateRenderedStyle:noop,notify:function(){this.notifications++},init:noop,isHeadless:function(){return!0},png:throwImgErr,jpg:throwImgErr};var BRp$f={};BRp$f.arrowShapeWidth=.3;BRp$f.registerArrowShapes=function(){var n=this.arrowShapes={},t=this,r=function(d,f,h,v,g,b,_){var S=g.x-h/2-_,T=g.x+h/2+_,w=g.y-h/2-_,A=g.y+h/2+_,R=S<=d&&d<=T&&w<=f&&f<=A;return R},a=function(d,f,h,v,g){var b=d*Math.cos(v)-f*Math.sin(v),_=d*Math.sin(v)+f*Math.cos(v),S=b*h,T=_*h,w=S+g.x,A=T+g.y;return{x:w,y:A}},o=function(d,f,h,v){for(var g=[],b=0;b<d.length;b+=2){var _=d[b],S=d[b+1];g.push(a(_,S,f,h,v))}return g},u=function(d){for(var f=[],h=0;h<d.length;h++){var v=d[h];f.push(v.x,v.y)}return f},s=function(d){return d.pstyle("width").pfValue*d.pstyle("arrow-scale").pfValue*2},c=function(d,f){string(f)&&(f=n[f]),n[d]=extend({name:d,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(v,g,b,_,S,T){var w=u(o(this.points,b+2*T,_,S)),A=pointInsidePolygonPoints(v,g,w);return A},roughCollide:r,draw:function(v,g,b,_){var S=o(this.points,g,b,_);t.arrowShapeImpl("polygon")(v,S)},spacing:function(v){return 0},gap:s},f)};c("none",{collide:falsify,roughCollide:falsify,draw:noop$1,spacing:zeroify,gap:zeroify}),c("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),c("arrow","triangle"),c("triangle-backcurve",{points:n.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(d,f,h,v,g){var b=o(this.points,f,h,v),_=this.controlPoint,S=a(_[0],_[1],f,h,v);t.arrowShapeImpl(this.name)(d,b,S)},gap:function(d){return s(d)*.8}}),c("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(d,f,h,v,g,b,_){var S=u(o(this.points,h+2*_,v,g)),T=u(o(this.pointsTee,h+2*_,v,g)),w=pointInsidePolygonPoints(d,f,S)||pointInsidePolygonPoints(d,f,T);return w},draw:function(d,f,h,v,g){var b=o(this.points,f,h,v),_=o(this.pointsTee,f,h,v);t.arrowShapeImpl(this.name)(d,b,_)}}),c("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(d,f,h,v,g,b,_){var S=g,T=Math.pow(S.x-d,2)+Math.pow(S.y-f,2)<=Math.pow((h+2*_)*this.radius,2),w=u(o(this.points,h+2*_,v,g));return pointInsidePolygonPoints(d,f,w)||T},draw:function(d,f,h,v,g){var b=o(this.pointsTr,f,h,v);t.arrowShapeImpl(this.name)(d,b,v.x,v.y,this.radius*f)},spacing:function(d){return t.getArrowWidth(d.pstyle("width").pfValue,d.pstyle("arrow-scale").value)*this.radius}}),c("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(d,f){var h=this.baseCrossLinePts.slice(),v=f/d,g=3,b=5;return h[g]=h[g]-v,h[b]=h[b]-v,h},collide:function(d,f,h,v,g,b,_){var S=u(o(this.points,h+2*_,v,g)),T=u(o(this.crossLinePts(h,b),h+2*_,v,g)),w=pointInsidePolygonPoints(d,f,S)||pointInsidePolygonPoints(d,f,T);return w},draw:function(d,f,h,v,g){var b=o(this.points,f,h,v),_=o(this.crossLinePts(f,g),f,h,v);t.arrowShapeImpl(this.name)(d,b,_)}}),c("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(d){return s(d)*.525}}),c("circle",{radius:.15,collide:function(d,f,h,v,g,b,_){var S=g,T=Math.pow(S.x-d,2)+Math.pow(S.y-f,2)<=Math.pow((h+2*_)*this.radius,2);return T},draw:function(d,f,h,v,g){t.arrowShapeImpl(this.name)(d,v.x,v.y,this.radius*f)},spacing:function(d){return t.getArrowWidth(d.pstyle("width").pfValue,d.pstyle("arrow-scale").value)*this.radius}}),c("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(d){return 1},gap:function(d){return 1}}),c("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),c("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(d){return d.pstyle("width").pfValue*d.pstyle("arrow-scale").value}}),c("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(d){return .95*d.pstyle("width").pfValue*d.pstyle("arrow-scale").value}})};var BRp$e={};BRp$e.projectIntoViewport=function(n,t){var r=this.cy,a=this.findContainerClientCoords(),o=a[0],u=a[1],s=a[4],c=r.pan(),l=r.zoom(),d=((n-o)/s-c.x)/l,f=((t-u)/s-c.y)/l;return[d,f]};BRp$e.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var n=this.container,t=n.getBoundingClientRect(),r=this.cy.window().getComputedStyle(n),a=function(T){return parseFloat(r.getPropertyValue(T))},o={left:a("padding-left"),right:a("padding-right"),top:a("padding-top"),bottom:a("padding-bottom")},u={left:a("border-left-width"),right:a("border-right-width"),top:a("border-top-width"),bottom:a("border-bottom-width")},s=n.clientWidth,c=n.clientHeight,l=o.left+o.right,d=o.top+o.bottom,f=u.left+u.right,h=t.width/(s+f),v=s-l,g=c-d,b=t.left+o.left+u.left,_=t.top+o.top+u.top;return this.containerBB=[b,_,v,g,h]};BRp$e.invalidateContainerClientCoordsCache=function(){this.containerBB=null};BRp$e.findNearestElement=function(n,t,r,a){return this.findNearestElements(n,t,r,a)[0]};BRp$e.findNearestElements=function(n,t,r,a){var o=this,u=this,s=u.getCachedZSortedEles(),c=[],l=u.cy.zoom(),d=u.cy.hasCompoundNodes(),f=(a?24:8)/l,h=(a?8:2)/l,v=(a?8:2)/l,g=1/0,b,_;r&&(s=s.interactive);function S(L,F){if(L.isNode()){if(_)return;_=L,c.push(L)}if(L.isEdge()&&(F==null||F<g))if(b){if(b.pstyle("z-compound-depth").value===L.pstyle("z-compound-depth").value&&b.pstyle("z-compound-depth").value===L.pstyle("z-compound-depth").value){for(var D=0;D<c.length;D++)if(c[D].isEdge()){c[D]=L,b=L,g=F??g;break}}}else c.push(L),b=L,g=F??g}function T(L){var F=L.outerWidth()+2*h,D=L.outerHeight()+2*h,$=F/2,O=D/2,P=L.position(),C=L.pstyle("corner-radius").value==="auto"?"auto":L.pstyle("corner-radius").pfValue,q=L._private.rscratch;if(P.x-$<=n&&n<=P.x+$&&P.y-O<=t&&t<=P.y+O){var M=u.nodeShapes[o.getNodeShape(L)];if(M.checkPoint(n,t,0,F,D,P.x,P.y,C,q))return S(L,0),!0}}function w(L){var F=L._private,D=F.rscratch,$=L.pstyle("width").pfValue,O=L.pstyle("arrow-scale").value,P=$/2+f,C=P*P,q=P*2,X=F.source,Y=F.target,M;if(D.edgeType==="segments"||D.edgeType==="straight"||D.edgeType==="haystack"){for(var N=D.allpts,G=0;G+3<N.length;G+=2)if(inLineVicinity(n,t,N[G],N[G+1],N[G+2],N[G+3],q)&&C>(M=sqdistToFiniteLine(n,t,N[G],N[G+1],N[G+2],N[G+3])))return S(L,M),!0}else if(D.edgeType==="bezier"||D.edgeType==="multibezier"||D.edgeType==="self"||D.edgeType==="compound"){for(var N=D.allpts,G=0;G+5<D.allpts.length;G+=4)if(inBezierVicinity(n,t,N[G],N[G+1],N[G+2],N[G+3],N[G+4],N[G+5],q)&&C>(M=sqdistToQuadraticBezier(n,t,N[G],N[G+1],N[G+2],N[G+3],N[G+4],N[G+5])))return S(L,M),!0}for(var X=X||F.source,Y=Y||F.target,W=o.getArrowWidth($,O),te=[{name:"source",x:D.arrowStartX,y:D.arrowStartY,angle:D.srcArrowAngle},{name:"target",x:D.arrowEndX,y:D.arrowEndY,angle:D.tgtArrowAngle},{name:"mid-source",x:D.midX,y:D.midY,angle:D.midsrcArrowAngle},{name:"mid-target",x:D.midX,y:D.midY,angle:D.midtgtArrowAngle}],G=0;G<te.length;G++){var ue=te[G],fe=u.arrowShapes[L.pstyle(ue.name+"-arrow-shape").value],re=L.pstyle("width").pfValue;if(fe.roughCollide(n,t,W,ue.angle,{x:ue.x,y:ue.y},re,f)&&fe.collide(n,t,W,ue.angle,{x:ue.x,y:ue.y},re,f))return S(L),!0}d&&c.length>0&&(T(X),T(Y))}function A(L,F,D){return getPrefixedProperty(L,F,D)}function R(L,F){var D=L._private,$=v,O;F?O=F+"-":O="",L.boundingBox();var P=D.labelBounds[F||"main"],C=L.pstyle(O+"label").value,q=L.pstyle("text-events").strValue==="yes";if(!(!q||!C)){var M=A(D.rscratch,"labelX",F),N=A(D.rscratch,"labelY",F),G=A(D.rscratch,"labelAngle",F),X=L.pstyle(O+"text-margin-x").pfValue,Y=L.pstyle(O+"text-margin-y").pfValue,W=P.x1-$-X,te=P.x2+$-X,ue=P.y1-$-Y,fe=P.y2+$-Y;if(G){var re=Math.cos(G),ye=Math.sin(G),Te=function(B,U){return B=B-M,U=U-N,{x:B*re-U*ye+M,y:B*ye+U*re+N}},Re=Te(W,ue),ve=Te(W,fe),ce=Te(te,ue),J=Te(te,fe),j=[Re.x+X,Re.y+Y,ce.x+X,ce.y+Y,J.x+X,J.y+Y,ve.x+X,ve.y+Y];if(pointInsidePolygonPoints(n,t,j))return S(L),!0}else if(inBoundingBox(P,n,t))return S(L),!0}}for(var E=s.length-1;E>=0;E--){var I=s[E];I.isNode()?T(I)||R(I):w(I)||R(I)||R(I,"source")||R(I,"target")}return c};BRp$e.getAllInBox=function(n,t,r,a){var o=this.getCachedZSortedEles().interactive,u=[],s=Math.min(n,r),c=Math.max(n,r),l=Math.min(t,a),d=Math.max(t,a);n=s,r=c,t=l,a=d;for(var f=makeBoundingBox({x1:n,y1:t,x2:r,y2:a}),h=0;h<o.length;h++){var v=o[h];if(v.isNode()){var g=v,b=g.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});boundingBoxesIntersect(f,b)&&!boundingBoxInBoundingBox(b,f)&&u.push(g)}else{var _=v,S=_._private,T=S.rscratch;if(T.startX!=null&&T.startY!=null&&!inBoundingBox(f,T.startX,T.startY)||T.endX!=null&&T.endY!=null&&!inBoundingBox(f,T.endX,T.endY))continue;if(T.edgeType==="bezier"||T.edgeType==="multibezier"||T.edgeType==="self"||T.edgeType==="compound"||T.edgeType==="segments"||T.edgeType==="haystack"){for(var w=S.rstyle.bezierPts||S.rstyle.linePts||S.rstyle.haystackPts,A=!0,R=0;R<w.length;R++)if(!pointInBoundingBox(f,w[R])){A=!1;break}A&&u.push(_)}else(T.edgeType==="haystack"||T.edgeType==="straight")&&u.push(_)}}return u};var BRp$d={};BRp$d.calculateArrowAngles=function(n){var t=n._private.rscratch,r=t.edgeType==="haystack",a=t.edgeType==="bezier",o=t.edgeType==="multibezier",u=t.edgeType==="segments",s=t.edgeType==="compound",c=t.edgeType==="self",l,d,f,h,v,g,T,w;if(r?(f=t.haystackPts[0],h=t.haystackPts[1],v=t.haystackPts[2],g=t.haystackPts[3]):(f=t.arrowStartX,h=t.arrowStartY,v=t.arrowEndX,g=t.arrowEndY),T=t.midX,w=t.midY,u)l=f-t.segpts[0],d=h-t.segpts[1];else if(o||s||c||a){var b=t.allpts,_=qbezierAt(b[0],b[2],b[4],.1),S=qbezierAt(b[1],b[3],b[5],.1);l=f-_,d=h-S}else l=f-T,d=h-w;t.srcArrowAngle=getAngleFromDisp(l,d);var T=t.midX,w=t.midY;if(r&&(T=(f+v)/2,w=(h+g)/2),l=v-f,d=g-h,u){var b=t.allpts;if(b.length/2%2===0){var A=b.length/2,R=A-2;l=b[A]-b[R],d=b[A+1]-b[R+1]}else if(t.isRound)l=t.midVector[1],d=-t.midVector[0];else{var A=b.length/2-1,R=A-2;l=b[A]-b[R],d=b[A+1]-b[R+1]}}else if(o||s||c){var b=t.allpts,E=t.ctrlpts,I,L,F,D;if(E.length/2%2===0){var $=b.length/2-1,O=$+2,P=O+2;I=qbezierAt(b[$],b[O],b[P],0),L=qbezierAt(b[$+1],b[O+1],b[P+1],0),F=qbezierAt(b[$],b[O],b[P],1e-4),D=qbezierAt(b[$+1],b[O+1],b[P+1],1e-4)}else{var O=b.length/2-1,$=O-2,P=O+2;I=qbezierAt(b[$],b[O],b[P],.4999),L=qbezierAt(b[$+1],b[O+1],b[P+1],.4999),F=qbezierAt(b[$],b[O],b[P],.5),D=qbezierAt(b[$+1],b[O+1],b[P+1],.5)}l=F-I,d=D-L}if(t.midtgtArrowAngle=getAngleFromDisp(l,d),t.midDispX=l,t.midDispY=d,l*=-1,d*=-1,u){var b=t.allpts;if(b.length/2%2!==0){if(!t.isRound){var A=b.length/2-1,C=A+2;l=-(b[C]-b[A]),d=-(b[C+1]-b[A+1])}}}if(t.midsrcArrowAngle=getAngleFromDisp(l,d),u)l=v-t.segpts[t.segpts.length-2],d=g-t.segpts[t.segpts.length-1];else if(o||s||c||a){var b=t.allpts,q=b.length,_=qbezierAt(b[q-6],b[q-4],b[q-2],.9),S=qbezierAt(b[q-5],b[q-3],b[q-1],.9);l=v-_,d=g-S}else l=v-T,d=g-w;t.tgtArrowAngle=getAngleFromDisp(l,d)};BRp$d.getArrowWidth=BRp$d.getArrowHeight=function(n,t){var r=this.arrowWidthCache=this.arrowWidthCache||{},a=r[n+", "+t];return a||(a=Math.max(Math.pow(n*13.37,.9),29)*t,r[n+", "+t]=a,a)};var x,y,v1={},v2={},sinA,sinA90,radDirection,drawDirection,angle,halfAngle,cRadius,lenOut,radius,limit,startX,startY,stopX,stopY,lastPoint,asVec=function(t,r,a){a.x=r.x-t.x,a.y=r.y-t.y,a.len=Math.sqrt(a.x*a.x+a.y*a.y),a.nx=a.x/a.len,a.ny=a.y/a.len,a.ang=Math.atan2(a.ny,a.nx)},invertVec=function(t,r){r.x=t.x*-1,r.y=t.y*-1,r.nx=t.nx*-1,r.ny=t.ny*-1,r.ang=t.ang>0?-(Math.PI-t.ang):Math.PI+t.ang},calcCornerArc=function(t,r,a,o,u){if(t!==lastPoint?asVec(r,t,v1):invertVec(v2,v1),asVec(r,a,v2),sinA=v1.nx*v2.ny-v1.ny*v2.nx,sinA90=v1.nx*v2.nx-v1.ny*-v2.ny,angle=Math.asin(Math.max(-1,Math.min(1,sinA))),Math.abs(angle)<1e-6){x=r.x,y=r.y,cRadius=radius=0;return}radDirection=1,drawDirection=!1,sinA90<0?angle<0?angle=Math.PI+angle:(angle=Math.PI-angle,radDirection=-1,drawDirection=!0):angle>0&&(radDirection=-1,drawDirection=!0),r.radius!==void 0?radius=r.radius:radius=o,halfAngle=angle/2,limit=Math.min(v1.len/2,v2.len/2),u?(lenOut=Math.abs(Math.cos(halfAngle)*radius/Math.sin(halfAngle)),lenOut>limit?(lenOut=limit,cRadius=Math.abs(lenOut*Math.sin(halfAngle)/Math.cos(halfAngle))):cRadius=radius):(lenOut=Math.min(limit,radius),cRadius=Math.abs(lenOut*Math.sin(halfAngle)/Math.cos(halfAngle))),stopX=r.x+v2.nx*lenOut,stopY=r.y+v2.ny*lenOut,x=stopX-v2.ny*cRadius*radDirection,y=stopY+v2.nx*cRadius*radDirection,startX=r.x+v1.nx*lenOut,startY=r.y+v1.ny*lenOut,lastPoint=r};function drawPreparedRoundCorner(n,t){t.radius===0?n.lineTo(t.cx,t.cy):n.arc(t.cx,t.cy,t.radius,t.startAngle,t.endAngle,t.counterClockwise)}function getRoundCorner(n,t,r,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return a===0||t.radius===0?{cx:t.x,cy:t.y,radius:0,startX:t.x,startY:t.y,stopX:t.x,stopY:t.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(calcCornerArc(n,t,r,a,o),{cx:x,cy:y,radius:cRadius,startX,startY,stopX,stopY,startAngle:v1.ang+Math.PI/2*radDirection,endAngle:v2.ang-Math.PI/2*radDirection,counterClockwise:drawDirection})}var BRp$c={};BRp$c.findMidptPtsEtc=function(n,t){var r=t.posPts,a=t.intersectionPts,o=t.vectorNormInverse,u,s=n.pstyle("source-endpoint"),c=n.pstyle("target-endpoint"),l=s.units!=null&&c.units!=null,d=function(E,I,L,F){var D=F-I,$=L-E,O=Math.sqrt($*$+D*D);return{x:-D/O,y:$/O}},f=n.pstyle("edge-distances").value;switch(f){case"node-position":u=r;break;case"intersection":u=a;break;case"endpoints":{if(l){var h=this.manualEndptToPx(n.source()[0],s),v=_slicedToArray(h,2),g=v[0],b=v[1],_=this.manualEndptToPx(n.target()[0],c),S=_slicedToArray(_,2),T=S[0],w=S[1],A={x1:g,y1:b,x2:T,y2:w};o=d(g,b,T,w),u=A}else warn("Edge ".concat(n.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),u=a;break}}return{midptPts:u,vectorNormInverse:o}};BRp$c.findHaystackPoints=function(n){for(var t=0;t<n.length;t++){var r=n[t],a=r._private,o=a.rscratch;if(!o.haystack){var u=Math.random()*2*Math.PI;o.source={x:Math.cos(u),y:Math.sin(u)},u=Math.random()*2*Math.PI,o.target={x:Math.cos(u),y:Math.sin(u)}}var s=a.source,c=a.target,l=s.position(),d=c.position(),f=s.width(),h=c.width(),v=s.height(),g=c.height(),b=r.pstyle("haystack-radius").value,_=b/2;o.haystackPts=o.allpts=[o.source.x*f*_+l.x,o.source.y*v*_+l.y,o.target.x*h*_+d.x,o.target.y*g*_+d.y],o.midX=(o.allpts[0]+o.allpts[2])/2,o.midY=(o.allpts[1]+o.allpts[3])/2,o.edgeType="haystack",o.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};BRp$c.findSegmentsPoints=function(n,t){var r=n._private.rscratch,a=n.pstyle("segment-weights"),o=n.pstyle("segment-distances"),u=n.pstyle("segment-radii"),s=n.pstyle("radius-type"),c=Math.min(a.pfValue.length,o.pfValue.length),l=u.pfValue[u.pfValue.length-1],d=s.pfValue[s.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var f=0;f<c;f++){var h=a.pfValue[f],v=o.pfValue[f],g=1-h,b=h,_=this.findMidptPtsEtc(n,t),S=_.midptPts,T=_.vectorNormInverse,w={x:S.x1*g+S.x2*b,y:S.y1*g+S.y2*b};r.segpts.push(w.x+T.x*v,w.y+T.y*v),r.radii.push(u.pfValue[f]!==void 0?u.pfValue[f]:l),r.isArcRadius.push((s.pfValue[f]!==void 0?s.pfValue[f]:d)==="arc-radius")}};BRp$c.findLoopPoints=function(n,t,r,a){var o=n._private.rscratch,u=t.dirCounts,s=t.srcPos,c=n.pstyle("control-point-distances"),l=c?c.pfValue[0]:void 0,d=n.pstyle("loop-direction").pfValue,f=n.pstyle("loop-sweep").pfValue,h=n.pstyle("control-point-step-size").pfValue;o.edgeType="self";var v=r,g=h;a&&(v=0,g=l);var b=d-Math.PI/2,_=b-f/2,S=b+f/2,T=d+"_"+f;v=u[T]===void 0?u[T]=0:++u[T],o.ctrlpts=[s.x+Math.cos(_)*1.4*g*(v/3+1),s.y+Math.sin(_)*1.4*g*(v/3+1),s.x+Math.cos(S)*1.4*g*(v/3+1),s.y+Math.sin(S)*1.4*g*(v/3+1)]};BRp$c.findCompoundLoopPoints=function(n,t,r,a){var o=n._private.rscratch;o.edgeType="compound";var u=t.srcPos,s=t.tgtPos,c=t.srcW,l=t.srcH,d=t.tgtW,f=t.tgtH,h=n.pstyle("control-point-step-size").pfValue,v=n.pstyle("control-point-distances"),g=v?v.pfValue[0]:void 0,b=r,_=h;a&&(b=0,_=g);var S=50,T={x:u.x-c/2,y:u.y-l/2},w={x:s.x-d/2,y:s.y-f/2},A={x:Math.min(T.x,w.x),y:Math.min(T.y,w.y)},R=.5,E=Math.max(R,Math.log(c*.01)),I=Math.max(R,Math.log(d*.01));o.ctrlpts=[A.x,A.y-(1+Math.pow(S,1.12)/100)*_*(b/3+1)*E,A.x-(1+Math.pow(S,1.12)/100)*_*(b/3+1)*I,A.y]};BRp$c.findStraightEdgePoints=function(n){n._private.rscratch.edgeType="straight"};BRp$c.findBezierPoints=function(n,t,r,a,o){var u=n._private.rscratch,s=n.pstyle("control-point-step-size").pfValue,c=n.pstyle("control-point-distances"),l=n.pstyle("control-point-weights"),d=c&&l?Math.min(c.value.length,l.value.length):1,f=c?c.pfValue[0]:void 0,h=l.value[0],v=a;u.edgeType=v?"multibezier":"bezier",u.ctrlpts=[];for(var g=0;g<d;g++){var b=(.5-t.eles.length/2+r)*s*(o?-1:1),_=void 0,S=signum(b);v&&(f=c?c.pfValue[g]:s,h=l.value[g]),a?_=f:_=f!==void 0?S*f:void 0;var T=_!==void 0?_:b,w=1-h,A=h,R=this.findMidptPtsEtc(n,t),E=R.midptPts,I=R.vectorNormInverse,L={x:E.x1*w+E.x2*A,y:E.y1*w+E.y2*A};u.ctrlpts.push(L.x+I.x*T,L.y+I.y*T)}};BRp$c.findTaxiPoints=function(n,t){var r=n._private.rscratch;r.edgeType="segments";var a="vertical",o="horizontal",u="leftward",s="rightward",c="downward",l="upward",d="auto",f=t.posPts,h=t.srcW,v=t.srcH,g=t.tgtW,b=t.tgtH,_=n.pstyle("edge-distances").value,S=_!=="node-position",T=n.pstyle("taxi-direction").value,w=T,A=n.pstyle("taxi-turn"),R=A.units==="%",E=A.pfValue,I=E<0,L=n.pstyle("taxi-turn-min-distance").pfValue,F=S?(h+g)/2:0,D=S?(v+b)/2:0,$=f.x2-f.x1,O=f.y2-f.y1,P=function(le,we){return le>0?Math.max(le-we,0):Math.min(le+we,0)},C=P($,F),q=P(O,D),M=!1;w===d?T=Math.abs(C)>Math.abs(q)?o:a:w===l||w===c?(T=a,M=!0):(w===u||w===s)&&(T=o,M=!0);var N=T===a,G=N?q:C,X=N?O:$,Y=signum(X),W=!1;!(M&&(R||I))&&(w===c&&X<0||w===l&&X>0||w===u&&X>0||w===s&&X<0)&&(Y*=-1,G=Y*Math.abs(G),W=!0);var te;if(R){var ue=E<0?1+E:E;te=ue*G}else{var fe=E<0?G:0;te=fe+E*Y}var re=function(le){return Math.abs(le)<L||Math.abs(le)>=Math.abs(G)},ye=re(te),Te=re(Math.abs(G)-Math.abs(te)),Re=ye||Te;if(Re&&!W)if(N){var ve=Math.abs(X)<=v/2,ce=Math.abs($)<=g/2;if(ve){var J=(f.x1+f.x2)/2,j=f.y1,z=f.y2;r.segpts=[J,j,J,z]}else if(ce){var B=(f.y1+f.y2)/2,U=f.x1,Z=f.x2;r.segpts=[U,B,Z,B]}else r.segpts=[f.x1,f.y2]}else{var oe=Math.abs(X)<=h/2,ie=Math.abs(O)<=b/2;if(oe){var se=(f.y1+f.y2)/2,ne=f.x1,he=f.x2;r.segpts=[ne,se,he,se]}else if(ie){var xe=(f.x1+f.x2)/2,me=f.y1,Ie=f.y2;r.segpts=[xe,me,xe,Ie]}else r.segpts=[f.x2,f.y1]}else if(N){var Pe=f.y1+te+(S?v/2*Y:0),Ce=f.x1,pe=f.x2;r.segpts=[Ce,Pe,pe,Pe]}else{var H=f.x1+te+(S?h/2*Y:0),V=f.y1,Q=f.y2;r.segpts=[H,V,H,Q]}if(r.isRound){var ee=n.pstyle("taxi-radius").value,ae=n.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(ee),r.isArcRadius=new Array(r.segpts.length/2).fill(ae)}};BRp$c.tryToCorrectInvalidPoints=function(n,t){var r=n._private.rscratch;if(r.edgeType==="bezier"){var a=t.srcPos,o=t.tgtPos,u=t.srcW,s=t.srcH,c=t.tgtW,l=t.tgtH,d=t.srcShape,f=t.tgtShape,h=t.srcCornerRadius,v=t.tgtCornerRadius,g=t.srcRs,b=t.tgtRs,_=!number$1(r.startX)||!number$1(r.startY),S=!number$1(r.arrowStartX)||!number$1(r.arrowStartY),T=!number$1(r.endX)||!number$1(r.endY),w=!number$1(r.arrowEndX)||!number$1(r.arrowEndY),A=3,R=this.getArrowWidth(n.pstyle("width").pfValue,n.pstyle("arrow-scale").value)*this.arrowShapeWidth,E=A*R,I=dist$1({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),L=I<E,F=dist$1({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),D=F<E,$=!1;if(_||S||L){$=!0;var O={x:r.ctrlpts[0]-a.x,y:r.ctrlpts[1]-a.y},P=Math.sqrt(O.x*O.x+O.y*O.y),C={x:O.x/P,y:O.y/P},q=Math.max(u,s),M={x:r.ctrlpts[0]+C.x*2*q,y:r.ctrlpts[1]+C.y*2*q},N=d.intersectLine(a.x,a.y,u,s,M.x,M.y,0,h,g);L?(r.ctrlpts[0]=r.ctrlpts[0]+C.x*(E-I),r.ctrlpts[1]=r.ctrlpts[1]+C.y*(E-I)):(r.ctrlpts[0]=N[0]+C.x*E,r.ctrlpts[1]=N[1]+C.y*E)}if(T||w||D){$=!0;var G={x:r.ctrlpts[0]-o.x,y:r.ctrlpts[1]-o.y},X=Math.sqrt(G.x*G.x+G.y*G.y),Y={x:G.x/X,y:G.y/X},W=Math.max(u,s),te={x:r.ctrlpts[0]+Y.x*2*W,y:r.ctrlpts[1]+Y.y*2*W},ue=f.intersectLine(o.x,o.y,c,l,te.x,te.y,0,v,b);D?(r.ctrlpts[0]=r.ctrlpts[0]+Y.x*(E-F),r.ctrlpts[1]=r.ctrlpts[1]+Y.y*(E-F)):(r.ctrlpts[0]=ue[0]+Y.x*E,r.ctrlpts[1]=ue[1]+Y.y*E)}$&&this.findEndpoints(n)}};BRp$c.storeAllpts=function(n){var t=n._private.rscratch;if(t.edgeType==="multibezier"||t.edgeType==="bezier"||t.edgeType==="self"||t.edgeType==="compound"){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var r=0;r+1<t.ctrlpts.length;r+=2)t.allpts.push(t.ctrlpts[r],t.ctrlpts[r+1]),r+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[r]+t.ctrlpts[r+2])/2,(t.ctrlpts[r+1]+t.ctrlpts[r+3])/2);t.allpts.push(t.endX,t.endY);var a,o;t.ctrlpts.length/2%2===0?(a=t.allpts.length/2-1,t.midX=t.allpts[a],t.midY=t.allpts[a+1]):(a=t.allpts.length/2-3,o=.5,t.midX=qbezierAt(t.allpts[a],t.allpts[a+2],t.allpts[a+4],o),t.midY=qbezierAt(t.allpts[a+1],t.allpts[a+3],t.allpts[a+5],o))}else if(t.edgeType==="straight")t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if(t.edgeType==="segments"){if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.isRound){t.roundCorners=[];for(var u=2;u+3<t.allpts.length;u+=2){var s=t.radii[u/2-1],c=t.isArcRadius[u/2-1];t.roundCorners.push(getRoundCorner({x:t.allpts[u-2],y:t.allpts[u-1]},{x:t.allpts[u],y:t.allpts[u+1],radius:s},{x:t.allpts[u+2],y:t.allpts[u+3]},s,c))}}if(t.segpts.length%4===0){var l=t.segpts.length/2,d=l-2;t.midX=(t.segpts[d]+t.segpts[l])/2,t.midY=(t.segpts[d+1]+t.segpts[l+1])/2}else{var f=t.segpts.length/2-1;if(!t.isRound)t.midX=t.segpts[f],t.midY=t.segpts[f+1];else{var h={x:t.segpts[f],y:t.segpts[f+1]},v=t.roundCorners[f/2],g=[h.x-v.cx,h.y-v.cy],b=v.radius/Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2));g=g.map(function(_){return _*b}),t.midX=v.cx+g[0],t.midY=v.cy+g[1],t.midVector=g}}}};BRp$c.checkForInvalidEdgeWarning=function(n){var t=n[0]._private.rscratch;t.nodesOverlap||number$1(t.startX)&&number$1(t.startY)&&number$1(t.endX)&&number$1(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,warn("Edge `"+n.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};BRp$c.findEdgeControlPoints=function(n){var t=this;if(!(!n||n.length===0)){for(var r=this,a=r.cy,o=a.hasCompoundNodes(),u={map:new Map$2,get:function(L){var F=this.map.get(L[0]);return F!=null?F.get(L[1]):null},set:function(L,F){var D=this.map.get(L[0]);D==null&&(D=new Map$2,this.map.set(L[0],D)),D.set(L[1],F)}},s=[],c=[],l=0;l<n.length;l++){var d=n[l],f=d._private,h=d.pstyle("curve-style").value;if(!(d.removed()||!d.takesUpSpace())){if(h==="haystack"){c.push(d);continue}var v=h==="unbundled-bezier"||h.endsWith("segments")||h==="straight"||h==="straight-triangle"||h.endsWith("taxi"),g=h==="unbundled-bezier"||h==="bezier",b=f.source,_=f.target,S=b.poolIndex(),T=_.poolIndex(),w=[S,T].sort(),A=u.get(w);A==null&&(A={eles:[]},u.set(w,A),s.push(w)),A.eles.push(d),v&&(A.hasUnbundled=!0),g&&(A.hasBezier=!0)}}for(var R=function(L){var F=s[L],D=u.get(F),$=void 0;if(!D.hasUnbundled){var O=D.eles[0].parallelEdges().filter(function(H){return H.isBundledBezier()});clearArray(D.eles),O.forEach(function(H){return D.eles.push(H)}),D.eles.sort(function(H,V){return H.poolIndex()-V.poolIndex()})}var P=D.eles[0],C=P.source(),q=P.target();if(C.poolIndex()>q.poolIndex()){var M=C;C=q,q=M}var N=D.srcPos=C.position(),G=D.tgtPos=q.position(),X=D.srcW=C.outerWidth(),Y=D.srcH=C.outerHeight(),W=D.tgtW=q.outerWidth(),te=D.tgtH=q.outerHeight(),ue=D.srcShape=r.nodeShapes[t.getNodeShape(C)],fe=D.tgtShape=r.nodeShapes[t.getNodeShape(q)],re=D.srcCornerRadius=C.pstyle("corner-radius").value==="auto"?"auto":C.pstyle("corner-radius").pfValue,ye=D.tgtCornerRadius=q.pstyle("corner-radius").value==="auto"?"auto":q.pstyle("corner-radius").pfValue,Te=D.tgtRs=q._private.rscratch,Re=D.srcRs=C._private.rscratch;D.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var ve=0;ve<D.eles.length;ve++){var ce=D.eles[ve],J=ce[0]._private.rscratch,j=ce.pstyle("curve-style").value,z=j==="unbundled-bezier"||j.endsWith("segments")||j.endsWith("taxi"),B=!C.same(ce.source());if(!D.calculatedIntersection&&C!==q&&(D.hasBezier||D.hasUnbundled)){D.calculatedIntersection=!0;var U=ue.intersectLine(N.x,N.y,X,Y,G.x,G.y,0,re,Re),Z=D.srcIntn=U,oe=fe.intersectLine(G.x,G.y,W,te,N.x,N.y,0,ye,Te),ie=D.tgtIntn=oe,se=D.intersectionPts={x1:U[0],x2:oe[0],y1:U[1],y2:oe[1]},ne=D.posPts={x1:N.x,x2:G.x,y1:N.y,y2:G.y},he=oe[1]-U[1],xe=oe[0]-U[0],me=Math.sqrt(xe*xe+he*he),Ie=D.vector={x:xe,y:he},Pe=D.vectorNorm={x:Ie.x/me,y:Ie.y/me},Ce={x:-Pe.y,y:Pe.x};D.nodesOverlap=!number$1(me)||fe.checkPoint(U[0],U[1],0,W,te,G.x,G.y,ye,Te)||ue.checkPoint(oe[0],oe[1],0,X,Y,N.x,N.y,re,Re),D.vectorNormInverse=Ce,$={nodesOverlap:D.nodesOverlap,dirCounts:D.dirCounts,calculatedIntersection:!0,hasBezier:D.hasBezier,hasUnbundled:D.hasUnbundled,eles:D.eles,srcPos:G,srcRs:Te,tgtPos:N,tgtRs:Re,srcW:W,srcH:te,tgtW:X,tgtH:Y,srcIntn:ie,tgtIntn:Z,srcShape:fe,tgtShape:ue,posPts:{x1:ne.x2,y1:ne.y2,x2:ne.x1,y2:ne.y1},intersectionPts:{x1:se.x2,y1:se.y2,x2:se.x1,y2:se.y1},vector:{x:-Ie.x,y:-Ie.y},vectorNorm:{x:-Pe.x,y:-Pe.y},vectorNormInverse:{x:-Ce.x,y:-Ce.y}}}var pe=B?$:D;J.nodesOverlap=pe.nodesOverlap,J.srcIntn=pe.srcIntn,J.tgtIntn=pe.tgtIntn,J.isRound=j.startsWith("round"),o&&(C.isParent()||C.isChild()||q.isParent()||q.isChild())&&(C.parents().anySame(q)||q.parents().anySame(C)||C.same(q)&&C.isParent())?t.findCompoundLoopPoints(ce,pe,ve,z):C===q?t.findLoopPoints(ce,pe,ve,z):j.endsWith("segments")?t.findSegmentsPoints(ce,pe):j.endsWith("taxi")?t.findTaxiPoints(ce,pe):j==="straight"||!z&&D.eles.length%2===1&&ve===Math.floor(D.eles.length/2)?t.findStraightEdgePoints(ce):t.findBezierPoints(ce,pe,ve,z,B),t.findEndpoints(ce),t.tryToCorrectInvalidPoints(ce,pe),t.checkForInvalidEdgeWarning(ce),t.storeAllpts(ce),t.storeEdgeProjections(ce),t.calculateArrowAngles(ce),t.recalculateEdgeLabelProjections(ce),t.calculateLabelAngles(ce)}},E=0;E<s.length;E++)R(E);this.findHaystackPoints(c)}};function getPts(n){var t=[];if(n!=null){for(var r=0;r<n.length;r+=2){var a=n[r],o=n[r+1];t.push({x:a,y:o})}return t}}BRp$c.getSegmentPoints=function(n){var t=n[0]._private.rscratch;this.recalculateRenderedStyle(n);var r=t.edgeType;if(r==="segments")return getPts(t.segpts)};BRp$c.getControlPoints=function(n){var t=n[0]._private.rscratch;this.recalculateRenderedStyle(n);var r=t.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return getPts(t.ctrlpts)};BRp$c.getEdgeMidpoint=function(n){var t=n[0]._private.rscratch;return this.recalculateRenderedStyle(n),{x:t.midX,y:t.midY}};var BRp$b={};BRp$b.manualEndptToPx=function(n,t){var r=this,a=n.position(),o=n.outerWidth(),u=n.outerHeight(),s=n._private.rscratch;if(t.value.length===2){var c=[t.pfValue[0],t.pfValue[1]];return t.units[0]==="%"&&(c[0]=c[0]*o),t.units[1]==="%"&&(c[1]=c[1]*u),c[0]+=a.x,c[1]+=a.y,c}else{var l=t.pfValue[0];l=-Math.PI/2+l;var d=2*Math.max(o,u),f=[a.x+Math.cos(l)*d,a.y+Math.sin(l)*d];return r.nodeShapes[this.getNodeShape(n)].intersectLine(a.x,a.y,o,u,f[0],f[1],0,n.pstyle("corner-radius").value==="auto"?"auto":n.pstyle("corner-radius").pfValue,s)}};BRp$b.findEndpoints=function(n){var t=this,r,a=n.source()[0],o=n.target()[0],u=a.position(),s=o.position(),c=n.pstyle("target-arrow-shape").value,l=n.pstyle("source-arrow-shape").value,d=n.pstyle("target-distance-from-node").pfValue,f=n.pstyle("source-distance-from-node").pfValue,h=a._private.rscratch,v=o._private.rscratch,g=n.pstyle("curve-style").value,b=n._private.rscratch,_=b.edgeType,S=g==="taxi",T=_==="self"||_==="compound",w=_==="bezier"||_==="multibezier"||T,A=_!=="bezier",R=_==="straight"||_==="segments",E=_==="segments",I=w||A||R,L=T||S,F=n.pstyle("source-endpoint"),D=L?"outside-to-node":F.value,$=a.pstyle("corner-radius").value==="auto"?"auto":a.pstyle("corner-radius").pfValue,O=n.pstyle("target-endpoint"),P=L?"outside-to-node":O.value,C=o.pstyle("corner-radius").value==="auto"?"auto":o.pstyle("corner-radius").pfValue;b.srcManEndpt=F,b.tgtManEndpt=O;var q,M,N,G;if(w){var X=[b.ctrlpts[0],b.ctrlpts[1]],Y=A?[b.ctrlpts[b.ctrlpts.length-2],b.ctrlpts[b.ctrlpts.length-1]]:X;q=Y,M=X}else if(R){var W=E?b.segpts.slice(0,2):[s.x,s.y],te=E?b.segpts.slice(b.segpts.length-2):[u.x,u.y];q=te,M=W}if(P==="inside-to-node")r=[s.x,s.y];else if(O.units)r=this.manualEndptToPx(o,O);else if(P==="outside-to-line")r=b.tgtIntn;else if(P==="outside-to-node"||P==="outside-to-node-or-label"?N=q:(P==="outside-to-line"||P==="outside-to-line-or-label")&&(N=[u.x,u.y]),r=t.nodeShapes[this.getNodeShape(o)].intersectLine(s.x,s.y,o.outerWidth(),o.outerHeight(),N[0],N[1],0,C,v),P==="outside-to-node-or-label"||P==="outside-to-line-or-label"){var ue=o._private.rscratch,fe=ue.labelWidth,re=ue.labelHeight,ye=ue.labelX,Te=ue.labelY,Re=fe/2,ve=re/2,ce=o.pstyle("text-valign").value;ce==="top"?Te-=ve:ce==="bottom"&&(Te+=ve);var J=o.pstyle("text-halign").value;J==="left"?ye-=Re:J==="right"&&(ye+=Re);var j=polygonIntersectLine(N[0],N[1],[ye-Re,Te-ve,ye+Re,Te-ve,ye+Re,Te+ve,ye-Re,Te+ve],s.x,s.y);if(j.length>0){var z=u,B=sqdist(z,array2point(r)),U=sqdist(z,array2point(j)),Z=B;if(U<B&&(r=j,Z=U),j.length>2){var oe=sqdist(z,{x:j[2],y:j[3]});oe<Z&&(r=[j[2],j[3]])}}}var ie=shortenIntersection(r,q,t.arrowShapes[c].spacing(n)+d),se=shortenIntersection(r,q,t.arrowShapes[c].gap(n)+d);if(b.endX=se[0],b.endY=se[1],b.arrowEndX=ie[0],b.arrowEndY=ie[1],D==="inside-to-node")r=[u.x,u.y];else if(F.units)r=this.manualEndptToPx(a,F);else if(D==="outside-to-line")r=b.srcIntn;else if(D==="outside-to-node"||D==="outside-to-node-or-label"?G=M:(D==="outside-to-line"||D==="outside-to-line-or-label")&&(G=[s.x,s.y]),r=t.nodeShapes[this.getNodeShape(a)].intersectLine(u.x,u.y,a.outerWidth(),a.outerHeight(),G[0],G[1],0,$,h),D==="outside-to-node-or-label"||D==="outside-to-line-or-label"){var ne=a._private.rscratch,he=ne.labelWidth,xe=ne.labelHeight,me=ne.labelX,Ie=ne.labelY,Pe=he/2,Ce=xe/2,pe=a.pstyle("text-valign").value;pe==="top"?Ie-=Ce:pe==="bottom"&&(Ie+=Ce);var H=a.pstyle("text-halign").value;H==="left"?me-=Pe:H==="right"&&(me+=Pe);var V=polygonIntersectLine(G[0],G[1],[me-Pe,Ie-Ce,me+Pe,Ie-Ce,me+Pe,Ie+Ce,me-Pe,Ie+Ce],u.x,u.y);if(V.length>0){var Q=s,ee=sqdist(Q,array2point(r)),ae=sqdist(Q,array2point(V)),be=ee;if(ae<ee&&(r=[V[0],V[1]],be=ae),V.length>2){var le=sqdist(Q,{x:V[2],y:V[3]});le<be&&(r=[V[2],V[3]])}}}var we=shortenIntersection(r,M,t.arrowShapes[l].spacing(n)+f),De=shortenIntersection(r,M,t.arrowShapes[l].gap(n)+f);b.startX=De[0],b.startY=De[1],b.arrowStartX=we[0],b.arrowStartY=we[1],I&&(!number$1(b.startX)||!number$1(b.startY)||!number$1(b.endX)||!number$1(b.endY)?b.badLine=!0:b.badLine=!1)};BRp$b.getSourceEndpoint=function(n){var t=n[0]._private.rscratch;switch(this.recalculateRenderedStyle(n),t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}};BRp$b.getTargetEndpoint=function(n){var t=n[0]._private.rscratch;switch(this.recalculateRenderedStyle(n),t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}};var BRp$a={};function pushBezierPts(n,t,r){for(var a=function(d,f,h,v){return qbezierAt(d,f,h,v)},o=t._private,u=o.rstyle.bezierPts,s=0;s<n.bezierProjPcts.length;s++){var c=n.bezierProjPcts[s];u.push({x:a(r[0],r[2],r[4],c),y:a(r[1],r[3],r[5],c)})}}BRp$a.storeEdgeProjections=function(n){var t=n._private,r=t.rscratch,a=r.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,a==="multibezier"||a==="bezier"||a==="self"||a==="compound"){t.rstyle.bezierPts=[];for(var o=0;o+5<r.allpts.length;o+=4)pushBezierPts(this,n,r.allpts.slice(o,o+6))}else if(a==="segments")for(var u=t.rstyle.linePts=[],o=0;o+1<r.allpts.length;o+=2)u.push({x:r.allpts[o],y:r.allpts[o+1]});else if(a==="haystack"){var s=r.haystackPts;t.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(n.pstyle("width").pfValue,n.pstyle("arrow-scale").value)*this.arrowShapeWidth};BRp$a.recalculateEdgeProjections=function(n){this.findEdgeControlPoints(n)};var BRp$9={};BRp$9.recalculateNodeLabelProjection=function(n){var t=n.pstyle("label").strValue;if(!emptyString(t)){var r,a,o=n._private,u=n.width(),s=n.height(),c=n.padding(),l=n.position(),d=n.pstyle("text-halign").strValue,f=n.pstyle("text-valign").strValue,h=o.rscratch,v=o.rstyle;switch(d){case"left":r=l.x-u/2-c;break;case"right":r=l.x+u/2+c;break;default:r=l.x}switch(f){case"top":a=l.y-s/2-c;break;case"bottom":a=l.y+s/2+c;break;default:a=l.y}h.labelX=r,h.labelY=a,v.labelX=r,v.labelY=a,this.calculateLabelAngles(n),this.applyLabelDimensions(n)}};var lineAngleFromDelta=function(t,r){var a=Math.atan(r/t);return t===0&&a<0&&(a=a*-1),a},lineAngle=function(t,r){var a=r.x-t.x,o=r.y-t.y;return lineAngleFromDelta(a,o)},bezierAngle=function(t,r,a,o){var u=bound(0,o-.001,1),s=bound(0,o+.001,1),c=qbezierPtAt(t,r,a,u),l=qbezierPtAt(t,r,a,s);return lineAngle(c,l)};BRp$9.recalculateEdgeLabelProjections=function(n){var t,r=n._private,a=r.rscratch,o=this,u={mid:n.pstyle("label").strValue,source:n.pstyle("source-label").strValue,target:n.pstyle("target-label").strValue};if(u.mid||u.source||u.target){t={x:a.midX,y:a.midY};var s=function(h,v,g){setPrefixedProperty(r.rscratch,h,v,g),setPrefixedProperty(r.rstyle,h,v,g)};s("labelX",null,t.x),s("labelY",null,t.y);var c=lineAngleFromDelta(a.midDispX,a.midDispY);s("labelAutoAngle",null,c);var l=function f(){if(f.cache)return f.cache;for(var h=[],v=0;v+5<a.allpts.length;v+=4){var g={x:a.allpts[v],y:a.allpts[v+1]},b={x:a.allpts[v+2],y:a.allpts[v+3]},_={x:a.allpts[v+4],y:a.allpts[v+5]};h.push({p0:g,p1:b,p2:_,startDist:0,length:0,segments:[]})}var S=r.rstyle.bezierPts,T=o.bezierProjPcts.length;function w(L,F,D,$,O){var P=dist$1(F,D),C=L.segments[L.segments.length-1],q={p0:F,p1:D,t0:$,t1:O,startDist:C?C.startDist+C.length:0,length:P};L.segments.push(q),L.length+=P}for(var A=0;A<h.length;A++){var R=h[A],E=h[A-1];E&&(R.startDist=E.startDist+E.length),w(R,R.p0,S[A*T],0,o.bezierProjPcts[0]);for(var I=0;I<T-1;I++)w(R,S[A*T+I],S[A*T+I+1],o.bezierProjPcts[I],o.bezierProjPcts[I+1]);w(R,S[A*T+T-1],R.p2,o.bezierProjPcts[T-1],1)}return f.cache=h},d=function(h){var v,g=h==="source";if(u[h]){var b=n.pstyle(h+"-text-offset").pfValue;switch(a.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var _=l(),S,T=0,w=0,A=0;A<_.length;A++){for(var R=_[g?A:_.length-1-A],E=0;E<R.segments.length;E++){var I=R.segments[g?E:R.segments.length-1-E],L=A===_.length-1&&E===R.segments.length-1;if(T=w,w+=I.length,w>=b||L){S={cp:R,segment:I};break}}if(S)break}var F=S.cp,D=S.segment,$=(b-T)/D.length,O=D.t1-D.t0,P=g?D.t0+O*$:D.t1-O*$;P=bound(0,P,1),t=qbezierPtAt(F.p0,F.p1,F.p2,P),v=bezierAngle(F.p0,F.p1,F.p2,P);break}case"straight":case"segments":case"haystack":{for(var C=0,q,M,N,G,X=a.allpts.length,Y=0;Y+3<X&&(g?(N={x:a.allpts[Y],y:a.allpts[Y+1]},G={x:a.allpts[Y+2],y:a.allpts[Y+3]}):(N={x:a.allpts[X-2-Y],y:a.allpts[X-1-Y]},G={x:a.allpts[X-4-Y],y:a.allpts[X-3-Y]}),q=dist$1(N,G),M=C,C+=q,!(C>=b));Y+=2);var W=b-M,te=W/q;te=bound(0,te,1),t=lineAt(N,G,te),v=lineAngle(N,G);break}}s("labelX",h,t.x),s("labelY",h,t.y),s("labelAutoAngle",h,v)}};d("source"),d("target"),this.applyLabelDimensions(n)}};BRp$9.applyLabelDimensions=function(n){this.applyPrefixedLabelDimensions(n),n.isEdge()&&(this.applyPrefixedLabelDimensions(n,"source"),this.applyPrefixedLabelDimensions(n,"target"))};BRp$9.applyPrefixedLabelDimensions=function(n,t){var r=n._private,a=this.getLabelText(n,t),o=this.calculateLabelDimensions(n,a),u=n.pstyle("line-height").pfValue,s=n.pstyle("text-wrap").strValue,c=getPrefixedProperty(r.rscratch,"labelWrapCachedLines",t)||[],l=s!=="wrap"?1:Math.max(c.length,1),d=o.height/l,f=d*u,h=o.width,v=o.height+(l-1)*(u-1)*d;setPrefixedProperty(r.rstyle,"labelWidth",t,h),setPrefixedProperty(r.rscratch,"labelWidth",t,h),setPrefixedProperty(r.rstyle,"labelHeight",t,v),setPrefixedProperty(r.rscratch,"labelHeight",t,v),setPrefixedProperty(r.rscratch,"labelLineHeight",t,f)};BRp$9.getLabelText=function(n,t){var r=n._private,a=t?t+"-":"",o=n.pstyle(a+"label").strValue,u=n.pstyle("text-transform").value,s=function(fe,re){return re?(setPrefixedProperty(r.rscratch,fe,t,re),re):getPrefixedProperty(r.rscratch,fe,t)};if(!o)return"";u=="none"||(u=="uppercase"?o=o.toUpperCase():u=="lowercase"&&(o=o.toLowerCase()));var c=n.pstyle("text-wrap").value;if(c==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var d="",f=o.split(`
`),h=n.pstyle("text-max-width").pfValue,v=n.pstyle("text-overflow-wrap").value,g=v==="anywhere",b=[],_=/[\s\u200b]+|$/g,S=0;S<f.length;S++){var T=f[S],w=this.calculateLabelDimensions(n,T),A=w.width;if(g){var R=T.split("").join(d);T=R}if(A>h){var E=T.matchAll(_),I="",L=0,F=_createForOfIteratorHelper(E),D;try{for(F.s();!(D=F.n()).done;){var $=D.value,O=$[0],P=T.substring(L,$.index);L=$.index+O.length;var C=I.length===0?P:I+P+O,q=this.calculateLabelDimensions(n,C),M=q.width;M<=h?I+=P+O:(I&&b.push(I),I=P+O)}}catch(ue){F.e(ue)}finally{F.f()}I.match(/^[\s\u200b]+$/)||b.push(I)}else b.push(T)}s("labelWrapCachedLines",b),o=s("labelWrapCachedText",b.join(`
`)),s("labelWrapKey",l)}else if(c==="ellipsis"){var N=n.pstyle("text-max-width").pfValue,G="",X="",Y=!1;if(this.calculateLabelDimensions(n,o).width<N)return o;for(var W=0;W<o.length;W++){var te=this.calculateLabelDimensions(n,G+o[W]+X).width;if(te>N)break;G+=o[W],W===o.length-1&&(Y=!0)}return Y||(G+=X),G}return o};BRp$9.getLabelJustification=function(n){var t=n.pstyle("text-justification").strValue,r=n.pstyle("text-halign").strValue;if(t==="auto")if(n.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return t};BRp$9.calculateLabelDimensions=function(n,t){var r=this,a=r.cy.window(),o=a.document,u=hashString(t,n._private.labelDimsKey),s=r.labelDimCache||(r.labelDimCache=[]),c=s[u];if(c!=null)return c;var l=0,d=n.pstyle("font-style").strValue,f=n.pstyle("font-size").pfValue,h=n.pstyle("font-family").strValue,v=n.pstyle("font-weight").strValue,g=this.labelCalcCanvas,b=this.labelCalcCanvasContext;if(!g){g=this.labelCalcCanvas=o.createElement("canvas"),b=this.labelCalcCanvasContext=g.getContext("2d");var _=g.style;_.position="absolute",_.left="-9999px",_.top="-9999px",_.zIndex="-1",_.visibility="hidden",_.pointerEvents="none"}b.font="".concat(d," ").concat(v," ").concat(f,"px ").concat(h);for(var S=0,T=0,w=t.split(`
`),A=0;A<w.length;A++){var R=w[A],E=b.measureText(R),I=Math.ceil(E.width),L=f;S=Math.max(I,S),T+=L}return S+=l,T+=l,s[u]={width:S,height:T}};BRp$9.calculateLabelAngle=function(n,t){var r=n._private,a=r.rscratch,o=n.isEdge(),u=t?t+"-":"",s=n.pstyle(u+"text-rotation"),c=s.strValue;return c==="none"?0:o&&c==="autorotate"?a.labelAutoAngle:c==="autorotate"?0:s.pfValue};BRp$9.calculateLabelAngles=function(n){var t=this,r=n.isEdge(),a=n._private,o=a.rscratch;o.labelAngle=t.calculateLabelAngle(n),r&&(o.sourceLabelAngle=t.calculateLabelAngle(n,"source"),o.targetLabelAngle=t.calculateLabelAngle(n,"target"))};var BRp$8={},TOO_SMALL_CUT_RECT=28,warnedCutRect=!1;BRp$8.getNodeShape=function(n){var t=this,r=n.pstyle("shape").value;if(r==="cutrectangle"&&(n.width()<TOO_SMALL_CUT_RECT||n.height()<TOO_SMALL_CUT_RECT))return warnedCutRect||(warn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),warnedCutRect=!0),"rectangle";if(n.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var a=n.pstyle("shape-polygon-points").value;return t.nodeShapes.makePolygon(a).name}return r};var BRp$7={};BRp$7.registerCalculationListeners=function(){var n=this.cy,t=n.collection(),r=this,a=function(s){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(t.merge(s),c)for(var l=0;l<s.length;l++){var d=s[l],f=d._private,h=f.rstyle;h.clean=!1,h.cleanConnected=!1}};r.binder(n).on("bounds.* dirty.*",function(s){var c=s.target;a(c)}).on("style.* background.*",function(s){var c=s.target;a(c,!1)});var o=function(s){if(s){var c=r.onUpdateEleCalcsFns;t.cleanStyle();for(var l=0;l<t.length;l++){var d=t[l],f=d._private.rstyle;d.isNode()&&!f.cleanConnected&&(a(d.connectedEdges()),f.cleanConnected=!0)}if(c)for(var h=0;h<c.length;h++){var v=c[h];v(s,t)}r.recalculateRenderedStyle(t),t=n.collection()}};r.flushRenderedStyleQueue=function(){o(!0)},r.beforeRender(o,r.beforeRenderPriorities.eleCalcs)};BRp$7.onUpdateEleCalcs=function(n){var t=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];t.push(n)};BRp$7.recalculateRenderedStyle=function(n,t){var r=function(R){return R._private.rstyle.cleanConnected},a=[],o=[];if(!this.destroyed){t===void 0&&(t=!0);for(var u=0;u<n.length;u++){var s=n[u],c=s._private,l=c.rstyle;s.isEdge()&&(!r(s.source())||!r(s.target()))&&(l.clean=!1),!(t&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(c.group==="nodes"?o.push(s):a.push(s),l.clean=!0)}for(var d=0;d<o.length;d++){var f=o[d],h=f._private,v=h.rstyle,g=f.position();this.recalculateNodeLabelProjection(f),v.nodeX=g.x,v.nodeY=g.y,v.nodeW=f.pstyle("width").pfValue,v.nodeH=f.pstyle("height").pfValue}this.recalculateEdgeProjections(a);for(var b=0;b<a.length;b++){var _=a[b],S=_._private,T=S.rstyle,w=S.rscratch;T.srcX=w.arrowStartX,T.srcY=w.arrowStartY,T.tgtX=w.arrowEndX,T.tgtY=w.arrowEndY,T.midX=w.midX,T.midY=w.midY,T.labelAngle=w.labelAngle,T.sourceLabelAngle=w.sourceLabelAngle,T.targetLabelAngle=w.targetLabelAngle}}};var BRp$6={};BRp$6.updateCachedGrabbedEles=function(){var n=this.cachedZSortedEles;if(n){n.drag=[],n.nondrag=[];for(var t=[],r=0;r<n.length;r++){var a=n[r],o=a._private.rscratch;a.grabbed()&&!a.isParent()?t.push(a):o.inDragLayer?n.drag.push(a):n.nondrag.push(a)}for(var r=0;r<t.length;r++){var a=t[r];n.drag.push(a)}}};BRp$6.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};BRp$6.getCachedZSortedEles=function(n){if(n||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(zIndexSort),t.interactive=t.filter(function(r){return r.interactive()}),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t};var BRp$5={};[BRp$e,BRp$d,BRp$c,BRp$b,BRp$a,BRp$9,BRp$8,BRp$7,BRp$6].forEach(function(n){extend(BRp$5,n)});var BRp$4={};BRp$4.getCachedImage=function(n,t,r){var a=this,o=a.imageCache=a.imageCache||{},u=o[n];if(u)return u.image.complete||u.image.addEventListener("load",r),u.image;u=o[n]=o[n]||{};var s=u.image=new Image;s.addEventListener("load",r),s.addEventListener("error",function(){s.error=!0});var c="data:",l=n.substring(0,c.length).toLowerCase()===c;return l||(t=t==="null"?null:t,s.crossOrigin=t),s.src=n,s};var BRp$3={};BRp$3.registerBinding=function(n,t,r,a){var o=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(n)){for(var u=[],s=0;s<n.length;s++){var c=n[s];if(c!==void 0){var l=this.binder(c);u.push(l.on.apply(l,o))}}return u}var l=this.binder(n);return l.on.apply(l,o)};BRp$3.binder=function(n){var t=this,r=t.cy.window(),a=n===r||n===r.document||n===r.document.body||domElement(n);if(t.supportsPassiveEvents==null){var o=!1;try{var u=Object.defineProperty({},"passive",{get:function(){return o=!0,!0}});r.addEventListener("test",null,u)}catch{}t.supportsPassiveEvents=o}var s=function(l,d,f){var h=Array.prototype.slice.call(arguments);return a&&t.supportsPassiveEvents&&(h[2]={capture:f??!1,passive:!1,once:!1}),t.bindings.push({target:n,args:h}),(n.addEventListener||n.on).apply(n,h),this};return{on:s,addEventListener:s,addListener:s,bind:s}};BRp$3.nodeIsDraggable=function(n){return n&&n.isNode()&&!n.locked()&&n.grabbable()};BRp$3.nodeIsGrabbable=function(n){return this.nodeIsDraggable(n)&&n.interactive()};BRp$3.load=function(){var n=this,t=n.cy.window(),r=function(H){return H.selected()},a=function(H){var V=H.getRootNode();if(V&&V.nodeType===11&&V.host!==void 0)return V},o=function(H,V,Q,ee){H==null&&(H=n.cy);for(var ae=0;ae<V.length;ae++){var be=V[ae];H.emit({originalEvent:Q,type:be,position:ee})}},u=function(H){return H.shiftKey||H.metaKey||H.ctrlKey},s=function(H,V){var Q=!0;if(n.cy.hasCompoundNodes()&&H&&H.pannable())for(var ee=0;V&&ee<V.length;ee++){var H=V[ee];if(H.isNode()&&H.isParent()&&!H.pannable()){Q=!1;break}}else Q=!0;return Q},c=function(H){H[0]._private.grabbed=!0},l=function(H){H[0]._private.grabbed=!1},d=function(H){H[0]._private.rscratch.inDragLayer=!0},f=function(H){H[0]._private.rscratch.inDragLayer=!1},h=function(H){H[0]._private.rscratch.isGrabTarget=!0},v=function(H){H[0]._private.rscratch.isGrabTarget=!1},g=function(H,V){var Q=V.addToList,ee=Q.has(H);!ee&&H.grabbable()&&!H.locked()&&(Q.merge(H),c(H))},b=function(H,V){if(H.cy().hasCompoundNodes()&&!(V.inDragLayer==null&&V.addToList==null)){var Q=H.descendants();V.inDragLayer&&(Q.forEach(d),Q.connectedEdges().forEach(d)),V.addToList&&g(Q,V)}},_=function(H,V){V=V||{};var Q=H.cy().hasCompoundNodes();V.inDragLayer&&(H.forEach(d),H.neighborhood().stdFilter(function(ee){return!Q||ee.isEdge()}).forEach(d)),V.addToList&&H.forEach(function(ee){g(ee,V)}),b(H,V),w(H,{inDragLayer:V.inDragLayer}),n.updateCachedGrabbedEles()},S=_,T=function(H){H&&(n.getCachedZSortedEles().forEach(function(V){l(V),f(V),v(V)}),n.updateCachedGrabbedEles())},w=function(H,V){if(!(V.inDragLayer==null&&V.addToList==null)&&H.cy().hasCompoundNodes()){var Q=H.ancestors().orphans();if(!Q.same(H)){var ee=Q.descendants().spawnSelf().merge(Q).unmerge(H).unmerge(H.descendants()),ae=ee.connectedEdges();V.inDragLayer&&(ae.forEach(d),ee.forEach(d)),V.addToList&&ee.forEach(function(be){g(be,V)})}}},A=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},R=typeof MutationObserver<"u",E=typeof ResizeObserver<"u";R?(n.removeObserver=new MutationObserver(function(pe){for(var H=0;H<pe.length;H++){var V=pe[H],Q=V.removedNodes;if(Q)for(var ee=0;ee<Q.length;ee++){var ae=Q[ee];if(ae===n.container){n.destroy();break}}}}),n.container.parentNode&&n.removeObserver.observe(n.container.parentNode,{childList:!0})):n.registerBinding(n.container,"DOMNodeRemoved",function(pe){n.destroy()});var I=debounce_1(function(){n.cy.resize()},100);R&&(n.styleObserver=new MutationObserver(I),n.styleObserver.observe(n.container,{attributes:!0})),n.registerBinding(t,"resize",I),E&&(n.resizeObserver=new ResizeObserver(I),n.resizeObserver.observe(n.container));var L=function(H,V){for(;H!=null;)V(H),H=H.parentNode},F=function(){n.invalidateContainerClientCoordsCache()};L(n.container,function(pe){n.registerBinding(pe,"transitionend",F),n.registerBinding(pe,"animationend",F),n.registerBinding(pe,"scroll",F)}),n.registerBinding(n.container,"contextmenu",function(pe){pe.preventDefault()});var D=function(){return n.selection[4]!==0},$=function(H){for(var V=n.findContainerClientCoords(),Q=V[0],ee=V[1],ae=V[2],be=V[3],le=H.touches?H.touches:[H],we=!1,De=0;De<le.length;De++){var Fe=le[De];if(Q<=Fe.clientX&&Fe.clientX<=Q+ae&&ee<=Fe.clientY&&Fe.clientY<=ee+be){we=!0;break}}if(!we)return!1;for(var Ne=n.container,de=H.target,Le=de.parentNode,$e=!1;Le;){if(Le===Ne){$e=!0;break}Le=Le.parentNode}return!!$e};n.registerBinding(n.container,"mousedown",function(H){if($(H)&&!(n.hoverData.which===1&&H.which!==1)){H.preventDefault(),A(),n.hoverData.capture=!0,n.hoverData.which=H.which;var V=n.cy,Q=[H.clientX,H.clientY],ee=n.projectIntoViewport(Q[0],Q[1]),ae=n.selection,be=n.findNearestElements(ee[0],ee[1],!0,!1),le=be[0],we=n.dragData.possibleDragElements;n.hoverData.mdownPos=ee,n.hoverData.mdownGPos=Q;var De=function(){n.hoverData.tapholdCancelled=!1,clearTimeout(n.hoverData.tapholdTimeout),n.hoverData.tapholdTimeout=setTimeout(function(){if(!n.hoverData.tapholdCancelled){var je=n.hoverData.down;je?je.emit({originalEvent:H,type:"taphold",position:{x:ee[0],y:ee[1]}}):V.emit({originalEvent:H,type:"taphold",position:{x:ee[0],y:ee[1]}})}},n.tapholdDuration)};if(H.which==3){n.hoverData.cxtStarted=!0;var Fe={originalEvent:H,type:"cxttapstart",position:{x:ee[0],y:ee[1]}};le?(le.activate(),le.emit(Fe),n.hoverData.down=le):V.emit(Fe),n.hoverData.downTime=new Date().getTime(),n.hoverData.cxtDragged=!1}else if(H.which==1){le&&le.activate();{if(le!=null&&n.nodeIsGrabbable(le)){var Ne=function(je){return{originalEvent:H,type:je,position:{x:ee[0],y:ee[1]}}},de=function(je){je.emit(Ne("grab"))};if(h(le),!le.selected())we=n.dragData.possibleDragElements=V.collection(),S(le,{addToList:we}),le.emit(Ne("grabon")).emit(Ne("grab"));else{we=n.dragData.possibleDragElements=V.collection();var Le=V.$(function($e){return $e.isNode()&&$e.selected()&&n.nodeIsGrabbable($e)});_(Le,{addToList:we}),le.emit(Ne("grabon")),Le.forEach(de)}n.redrawHint("eles",!0),n.redrawHint("drag",!0)}n.hoverData.down=le,n.hoverData.downs=be,n.hoverData.downTime=new Date().getTime()}o(le,["mousedown","tapstart","vmousedown"],H,{x:ee[0],y:ee[1]}),le==null?(ae[4]=1,n.data.bgActivePosistion={x:ee[0],y:ee[1]},n.redrawHint("select",!0),n.redraw()):le.pannable()&&(ae[4]=1),De()}ae[0]=ae[2]=ee[0],ae[1]=ae[3]=ee[1]}},!1);var O=a(n.container);n.registerBinding([t,O],"mousemove",function(H){var V=n.hoverData.capture;if(!(!V&&!$(H))){var Q=!1,ee=n.cy,ae=ee.zoom(),be=[H.clientX,H.clientY],le=n.projectIntoViewport(be[0],be[1]),we=n.hoverData.mdownPos,De=n.hoverData.mdownGPos,Fe=n.selection,Ne=null;!n.hoverData.draggingEles&&!n.hoverData.dragging&&!n.hoverData.selecting&&(Ne=n.findNearestElement(le[0],le[1],!0,!1));var de=n.hoverData.last,Le=n.hoverData.down,$e=[le[0]-Fe[2],le[1]-Fe[3]],je=n.dragData.possibleDragElements,Me;if(De){var ze=be[0]-De[0],Je=ze*ze,Ke=be[1]-De[1],ot=Ke*Ke,_e=Je+ot;n.hoverData.isOverThresholdDrag=Me=_e>=n.desktopTapThreshold2}var Ae=u(H);Me&&(n.hoverData.tapholdCancelled=!0);var Ve=function(){var ut=n.hoverData.dragDelta=n.hoverData.dragDelta||[];ut.length===0?(ut.push($e[0]),ut.push($e[1])):(ut[0]+=$e[0],ut[1]+=$e[1])};Q=!0,o(Ne,["mousemove","vmousemove","tapdrag"],H,{x:le[0],y:le[1]});var Ue=function(){n.data.bgActivePosistion=void 0,n.hoverData.selecting||ee.emit({originalEvent:H,type:"boxstart",position:{x:le[0],y:le[1]}}),Fe[4]=1,n.hoverData.selecting=!0,n.redrawHint("select",!0),n.redraw()};if(n.hoverData.which===3){if(Me){var We={originalEvent:H,type:"cxtdrag",position:{x:le[0],y:le[1]}};Le?Le.emit(We):ee.emit(We),n.hoverData.cxtDragged=!0,(!n.hoverData.cxtOver||Ne!==n.hoverData.cxtOver)&&(n.hoverData.cxtOver&&n.hoverData.cxtOver.emit({originalEvent:H,type:"cxtdragout",position:{x:le[0],y:le[1]}}),n.hoverData.cxtOver=Ne,Ne&&Ne.emit({originalEvent:H,type:"cxtdragover",position:{x:le[0],y:le[1]}}))}}else if(n.hoverData.dragging){if(Q=!0,ee.panningEnabled()&&ee.userPanningEnabled()){var pt;if(n.hoverData.justStartedPan){var Ge=n.hoverData.mdownPos;pt={x:(le[0]-Ge[0])*ae,y:(le[1]-Ge[1])*ae},n.hoverData.justStartedPan=!1}else pt={x:$e[0]*ae,y:$e[1]*ae};ee.panBy(pt),ee.emit("dragpan"),n.hoverData.dragged=!0}le=n.projectIntoViewport(H.clientX,H.clientY)}else if(Fe[4]==1&&(Le==null||Le.pannable())){if(Me){if(!n.hoverData.dragging&&ee.boxSelectionEnabled()&&(Ae||!ee.panningEnabled()||!ee.userPanningEnabled()))Ue();else if(!n.hoverData.selecting&&ee.panningEnabled()&&ee.userPanningEnabled()){var ct=s(Le,n.hoverData.downs);ct&&(n.hoverData.dragging=!0,n.hoverData.justStartedPan=!0,Fe[4]=0,n.data.bgActivePosistion=array2point(we),n.redrawHint("select",!0),n.redraw())}Le&&Le.pannable()&&Le.active()&&Le.unactivate()}}else{if(Le&&Le.pannable()&&Le.active()&&Le.unactivate(),(!Le||!Le.grabbed())&&Ne!=de&&(de&&o(de,["mouseout","tapdragout"],H,{x:le[0],y:le[1]}),Ne&&o(Ne,["mouseover","tapdragover"],H,{x:le[0],y:le[1]}),n.hoverData.last=Ne),Le)if(Me){if(ee.boxSelectionEnabled()&&Ae)Le&&Le.grabbed()&&(T(je),Le.emit("freeon"),je.emit("free"),n.dragData.didDrag&&(Le.emit("dragfreeon"),je.emit("dragfree"))),Ue();else if(Le&&Le.grabbed()&&n.nodeIsDraggable(Le)){var Xe=!n.dragData.didDrag;Xe&&n.redrawHint("eles",!0),n.dragData.didDrag=!0,n.hoverData.draggingEles||_(je,{inDragLayer:!0});var Ye={x:0,y:0};if(number$1($e[0])&&number$1($e[1])&&(Ye.x+=$e[0],Ye.y+=$e[1],Xe)){var nt=n.hoverData.dragDelta;nt&&number$1(nt[0])&&number$1(nt[1])&&(Ye.x+=nt[0],Ye.y+=nt[1])}n.hoverData.draggingEles=!0,je.silentShift(Ye).emit("position drag"),n.redrawHint("drag",!0),n.redraw()}}else Ve();Q=!0}if(Fe[2]=le[0],Fe[3]=le[1],Q)return H.stopPropagation&&H.stopPropagation(),H.preventDefault&&H.preventDefault(),!1}},!1);var P,C,q;n.registerBinding(t,"mouseup",function(H){if(!(n.hoverData.which===1&&H.which!==1&&n.hoverData.capture)){var V=n.hoverData.capture;if(V){n.hoverData.capture=!1;var Q=n.cy,ee=n.projectIntoViewport(H.clientX,H.clientY),ae=n.selection,be=n.findNearestElement(ee[0],ee[1],!0,!1),le=n.dragData.possibleDragElements,we=n.hoverData.down,De=u(H);if(n.data.bgActivePosistion&&(n.redrawHint("select",!0),n.redraw()),n.hoverData.tapholdCancelled=!0,n.data.bgActivePosistion=void 0,we&&we.unactivate(),n.hoverData.which===3){var Fe={originalEvent:H,type:"cxttapend",position:{x:ee[0],y:ee[1]}};if(we?we.emit(Fe):Q.emit(Fe),!n.hoverData.cxtDragged){var Ne={originalEvent:H,type:"cxttap",position:{x:ee[0],y:ee[1]}};we?we.emit(Ne):Q.emit(Ne)}n.hoverData.cxtDragged=!1,n.hoverData.which=null}else if(n.hoverData.which===1){if(o(be,["mouseup","tapend","vmouseup"],H,{x:ee[0],y:ee[1]}),!n.dragData.didDrag&&!n.hoverData.dragged&&!n.hoverData.selecting&&!n.hoverData.isOverThresholdDrag&&(o(we,["click","tap","vclick"],H,{x:ee[0],y:ee[1]}),C=!1,H.timeStamp-q<=Q.multiClickDebounceTime()?(P&&clearTimeout(P),C=!0,q=null,o(we,["dblclick","dbltap","vdblclick"],H,{x:ee[0],y:ee[1]})):(P=setTimeout(function(){C||o(we,["oneclick","onetap","voneclick"],H,{x:ee[0],y:ee[1]})},Q.multiClickDebounceTime()),q=H.timeStamp)),we==null&&!n.dragData.didDrag&&!n.hoverData.selecting&&!n.hoverData.dragged&&!u(H)&&(Q.$(r).unselect(["tapunselect"]),le.length>0&&n.redrawHint("eles",!0),n.dragData.possibleDragElements=le=Q.collection()),be==we&&!n.dragData.didDrag&&!n.hoverData.selecting&&be!=null&&be._private.selectable&&(n.hoverData.dragging||(Q.selectionType()==="additive"||De?be.selected()?be.unselect(["tapunselect"]):be.select(["tapselect"]):De||(Q.$(r).unmerge(be).unselect(["tapunselect"]),be.select(["tapselect"]))),n.redrawHint("eles",!0)),n.hoverData.selecting){var de=Q.collection(n.getAllInBox(ae[0],ae[1],ae[2],ae[3]));n.redrawHint("select",!0),de.length>0&&n.redrawHint("eles",!0),Q.emit({type:"boxend",originalEvent:H,position:{x:ee[0],y:ee[1]}});var Le=function(Me){return Me.selectable()&&!Me.selected()};Q.selectionType()==="additive"||De||Q.$(r).unmerge(de).unselect(),de.emit("box").stdFilter(Le).select().emit("boxselect"),n.redraw()}if(n.hoverData.dragging&&(n.hoverData.dragging=!1,n.redrawHint("select",!0),n.redrawHint("eles",!0),n.redraw()),!ae[4]){n.redrawHint("drag",!0),n.redrawHint("eles",!0);var $e=we&&we.grabbed();T(le),$e&&(we.emit("freeon"),le.emit("free"),n.dragData.didDrag&&(we.emit("dragfreeon"),le.emit("dragfree")))}}ae[4]=0,n.hoverData.down=null,n.hoverData.cxtStarted=!1,n.hoverData.draggingEles=!1,n.hoverData.selecting=!1,n.hoverData.isOverThresholdDrag=!1,n.dragData.didDrag=!1,n.hoverData.dragged=!1,n.hoverData.dragDelta=[],n.hoverData.mdownPos=null,n.hoverData.mdownGPos=null,n.hoverData.which=null}}},!1);var M=function(H){if(!n.scrollingPage){var V=n.cy,Q=V.zoom(),ee=V.pan(),ae=n.projectIntoViewport(H.clientX,H.clientY),be=[ae[0]*Q+ee.x,ae[1]*Q+ee.y];if(n.hoverData.draggingEles||n.hoverData.dragging||n.hoverData.cxtStarted||D()){H.preventDefault();return}if(V.panningEnabled()&&V.userPanningEnabled()&&V.zoomingEnabled()&&V.userZoomingEnabled()){H.preventDefault(),n.data.wheelZooming=!0,clearTimeout(n.data.wheelTimeout),n.data.wheelTimeout=setTimeout(function(){n.data.wheelZooming=!1,n.redrawHint("eles",!0),n.redraw()},150);var le;H.deltaY!=null?le=H.deltaY/-250:H.wheelDeltaY!=null?le=H.wheelDeltaY/1e3:le=H.wheelDelta/1e3,le=le*n.wheelSensitivity;var we=H.deltaMode===1;we&&(le*=33);var De=V.zoom()*Math.pow(10,le);H.type==="gesturechange"&&(De=n.gestureStartZoom*H.scale),V.zoom({level:De,renderedPosition:{x:be[0],y:be[1]}}),V.emit(H.type==="gesturechange"?"pinchzoom":"scrollzoom")}}};n.registerBinding(n.container,"wheel",M,!0),n.registerBinding(t,"scroll",function(H){n.scrollingPage=!0,clearTimeout(n.scrollingPageTimeout),n.scrollingPageTimeout=setTimeout(function(){n.scrollingPage=!1},250)},!0),n.registerBinding(n.container,"gesturestart",function(H){n.gestureStartZoom=n.cy.zoom(),n.hasTouchStarted||H.preventDefault()},!0),n.registerBinding(n.container,"gesturechange",function(pe){n.hasTouchStarted||M(pe)},!0),n.registerBinding(n.container,"mouseout",function(H){var V=n.projectIntoViewport(H.clientX,H.clientY);n.cy.emit({originalEvent:H,type:"mouseout",position:{x:V[0],y:V[1]}})},!1),n.registerBinding(n.container,"mouseover",function(H){var V=n.projectIntoViewport(H.clientX,H.clientY);n.cy.emit({originalEvent:H,type:"mouseover",position:{x:V[0],y:V[1]}})},!1);var N,G,X,Y,W,te,ue,fe,re,ye,Te,Re,ve,ce=function(H,V,Q,ee){return Math.sqrt((Q-H)*(Q-H)+(ee-V)*(ee-V))},J=function(H,V,Q,ee){return(Q-H)*(Q-H)+(ee-V)*(ee-V)},j;n.registerBinding(n.container,"touchstart",j=function(H){if(n.hasTouchStarted=!0,!!$(H)){A(),n.touchData.capture=!0,n.data.bgActivePosistion=void 0;var V=n.cy,Q=n.touchData.now,ee=n.touchData.earlier;if(H.touches[0]){var ae=n.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);Q[0]=ae[0],Q[1]=ae[1]}if(H.touches[1]){var ae=n.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);Q[2]=ae[0],Q[3]=ae[1]}if(H.touches[2]){var ae=n.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);Q[4]=ae[0],Q[5]=ae[1]}if(H.touches[1]){n.touchData.singleTouchMoved=!0,T(n.dragData.touchDragEles);var be=n.findContainerClientCoords();re=be[0],ye=be[1],Te=be[2],Re=be[3],N=H.touches[0].clientX-re,G=H.touches[0].clientY-ye,X=H.touches[1].clientX-re,Y=H.touches[1].clientY-ye,ve=0<=N&&N<=Te&&0<=X&&X<=Te&&0<=G&&G<=Re&&0<=Y&&Y<=Re;var le=V.pan(),we=V.zoom();W=ce(N,G,X,Y),te=J(N,G,X,Y),ue=[(N+X)/2,(G+Y)/2],fe=[(ue[0]-le.x)/we,(ue[1]-le.y)/we];var De=200,Fe=De*De;if(te<Fe&&!H.touches[2]){var Ne=n.findNearestElement(Q[0],Q[1],!0,!0),de=n.findNearestElement(Q[2],Q[3],!0,!0);Ne&&Ne.isNode()?(Ne.activate().emit({originalEvent:H,type:"cxttapstart",position:{x:Q[0],y:Q[1]}}),n.touchData.start=Ne):de&&de.isNode()?(de.activate().emit({originalEvent:H,type:"cxttapstart",position:{x:Q[0],y:Q[1]}}),n.touchData.start=de):V.emit({originalEvent:H,type:"cxttapstart",position:{x:Q[0],y:Q[1]}}),n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxt=!0,n.touchData.cxtDragged=!1,n.data.bgActivePosistion=void 0,n.redraw();return}}if(H.touches[2])V.boxSelectionEnabled()&&H.preventDefault();else if(!H.touches[1]){if(H.touches[0]){var Le=n.findNearestElements(Q[0],Q[1],!0,!0),$e=Le[0];if($e!=null&&($e.activate(),n.touchData.start=$e,n.touchData.starts=Le,n.nodeIsGrabbable($e))){var je=n.dragData.touchDragEles=V.collection(),Me=null;n.redrawHint("eles",!0),n.redrawHint("drag",!0),$e.selected()?(Me=V.$(function(_e){return _e.selected()&&n.nodeIsGrabbable(_e)}),_(Me,{addToList:je})):S($e,{addToList:je}),h($e);var ze=function(Ae){return{originalEvent:H,type:Ae,position:{x:Q[0],y:Q[1]}}};$e.emit(ze("grabon")),Me?Me.forEach(function(_e){_e.emit(ze("grab"))}):$e.emit(ze("grab"))}o($e,["touchstart","tapstart","vmousedown"],H,{x:Q[0],y:Q[1]}),$e==null&&(n.data.bgActivePosistion={x:ae[0],y:ae[1]},n.redrawHint("select",!0),n.redraw()),n.touchData.singleTouchMoved=!1,n.touchData.singleTouchStartTime=+new Date,clearTimeout(n.touchData.tapholdTimeout),n.touchData.tapholdTimeout=setTimeout(function(){n.touchData.singleTouchMoved===!1&&!n.pinching&&!n.touchData.selecting&&o(n.touchData.start,["taphold"],H,{x:Q[0],y:Q[1]})},n.tapholdDuration)}}if(H.touches.length>=1){for(var Je=n.touchData.startPosition=[null,null,null,null,null,null],Ke=0;Ke<Q.length;Ke++)Je[Ke]=ee[Ke]=Q[Ke];var ot=H.touches[0];n.touchData.startGPosition=[ot.clientX,ot.clientY]}}},!1);var z;n.registerBinding(t,"touchmove",z=function(H){var V=n.touchData.capture;if(!(!V&&!$(H))){var Q=n.selection,ee=n.cy,ae=n.touchData.now,be=n.touchData.earlier,le=ee.zoom();if(H.touches[0]){var we=n.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ae[0]=we[0],ae[1]=we[1]}if(H.touches[1]){var we=n.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ae[2]=we[0],ae[3]=we[1]}if(H.touches[2]){var we=n.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ae[4]=we[0],ae[5]=we[1]}var De=n.touchData.startGPosition,Fe;if(V&&H.touches[0]&&De){for(var Ne=[],de=0;de<ae.length;de++)Ne[de]=ae[de]-be[de];var Le=H.touches[0].clientX-De[0],$e=Le*Le,je=H.touches[0].clientY-De[1],Me=je*je,ze=$e+Me;Fe=ze>=n.touchTapThreshold2}if(V&&n.touchData.cxt){H.preventDefault();var Je=H.touches[0].clientX-re,Ke=H.touches[0].clientY-ye,ot=H.touches[1].clientX-re,_e=H.touches[1].clientY-ye,Ae=J(Je,Ke,ot,_e),Ve=Ae/te,Ue=150,We=Ue*Ue,pt=1.5,Ge=pt*pt;if(Ve>=Ge||Ae>=We){n.touchData.cxt=!1,n.data.bgActivePosistion=void 0,n.redrawHint("select",!0);var ct={originalEvent:H,type:"cxttapend",position:{x:ae[0],y:ae[1]}};n.touchData.start?(n.touchData.start.unactivate().emit(ct),n.touchData.start=null):ee.emit(ct)}}if(V&&n.touchData.cxt){var ct={originalEvent:H,type:"cxtdrag",position:{x:ae[0],y:ae[1]}};n.data.bgActivePosistion=void 0,n.redrawHint("select",!0),n.touchData.start?n.touchData.start.emit(ct):ee.emit(ct),n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxtDragged=!0;var Xe=n.findNearestElement(ae[0],ae[1],!0,!0);(!n.touchData.cxtOver||Xe!==n.touchData.cxtOver)&&(n.touchData.cxtOver&&n.touchData.cxtOver.emit({originalEvent:H,type:"cxtdragout",position:{x:ae[0],y:ae[1]}}),n.touchData.cxtOver=Xe,Xe&&Xe.emit({originalEvent:H,type:"cxtdragover",position:{x:ae[0],y:ae[1]}}))}else if(V&&H.touches[2]&&ee.boxSelectionEnabled())H.preventDefault(),n.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,n.touchData.selecting||ee.emit({originalEvent:H,type:"boxstart",position:{x:ae[0],y:ae[1]}}),n.touchData.selecting=!0,n.touchData.didSelect=!0,Q[4]=1,!Q||Q.length===0||Q[0]===void 0?(Q[0]=(ae[0]+ae[2]+ae[4])/3,Q[1]=(ae[1]+ae[3]+ae[5])/3,Q[2]=(ae[0]+ae[2]+ae[4])/3+1,Q[3]=(ae[1]+ae[3]+ae[5])/3+1):(Q[2]=(ae[0]+ae[2]+ae[4])/3,Q[3]=(ae[1]+ae[3]+ae[5])/3),n.redrawHint("select",!0),n.redraw();else if(V&&H.touches[1]&&!n.touchData.didSelect&&ee.zoomingEnabled()&&ee.panningEnabled()&&ee.userZoomingEnabled()&&ee.userPanningEnabled()){H.preventDefault(),n.data.bgActivePosistion=void 0,n.redrawHint("select",!0);var Ye=n.dragData.touchDragEles;if(Ye){n.redrawHint("drag",!0);for(var nt=0;nt<Ye.length;nt++){var gt=Ye[nt]._private;gt.grabbed=!1,gt.rscratch.inDragLayer=!1}}var ut=n.touchData.start,Je=H.touches[0].clientX-re,Ke=H.touches[0].clientY-ye,ot=H.touches[1].clientX-re,_e=H.touches[1].clientY-ye,tt=ce(Je,Ke,ot,_e),Ct=tt/W;if(ve){var Ze=Je-N,Ee=Ke-G,qe=ot-X,Be=_e-Y,it=(Ze+qe)/2,at=(Ee+Be)/2,vt=ee.zoom(),At=vt*Ct,St=ee.pan(),Xt=fe[0]*vt+St.x,jt=fe[1]*vt+St.y,xt={x:-At/vt*(Xt-St.x-it)+Xt,y:-At/vt*(jt-St.y-at)+jt};if(ut&&ut.active()){var Ye=n.dragData.touchDragEles;T(Ye),n.redrawHint("drag",!0),n.redrawHint("eles",!0),ut.unactivate().emit("freeon"),Ye.emit("free"),n.dragData.didDrag&&(ut.emit("dragfreeon"),Ye.emit("dragfree"))}ee.viewport({zoom:At,pan:xt,cancelOnFailedZoom:!0}),ee.emit("pinchzoom"),W=tt,N=Je,G=Ke,X=ot,Y=_e,n.pinching=!0}if(H.touches[0]){var we=n.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ae[0]=we[0],ae[1]=we[1]}if(H.touches[1]){var we=n.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ae[2]=we[0],ae[3]=we[1]}if(H.touches[2]){var we=n.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ae[4]=we[0],ae[5]=we[1]}}else if(H.touches[0]&&!n.touchData.didSelect){var Rt=n.touchData.start,Lt=n.touchData.last,Xe;if(!n.hoverData.draggingEles&&!n.swipePanning&&(Xe=n.findNearestElement(ae[0],ae[1],!0,!0)),V&&Rt!=null&&H.preventDefault(),V&&Rt!=null&&n.nodeIsDraggable(Rt))if(Fe){var Ye=n.dragData.touchDragEles,Ht=!n.dragData.didDrag;Ht&&_(Ye,{inDragLayer:!0}),n.dragData.didDrag=!0;var It={x:0,y:0};if(number$1(Ne[0])&&number$1(Ne[1])&&(It.x+=Ne[0],It.y+=Ne[1],Ht)){n.redrawHint("eles",!0);var Ft=n.touchData.dragDelta;Ft&&number$1(Ft[0])&&number$1(Ft[1])&&(It.x+=Ft[0],It.y+=Ft[1])}n.hoverData.draggingEles=!0,Ye.silentShift(It).emit("position drag"),n.redrawHint("drag",!0),n.touchData.startPosition[0]==be[0]&&n.touchData.startPosition[1]==be[1]&&n.redrawHint("eles",!0),n.redraw()}else{var Ft=n.touchData.dragDelta=n.touchData.dragDelta||[];Ft.length===0?(Ft.push(Ne[0]),Ft.push(Ne[1])):(Ft[0]+=Ne[0],Ft[1]+=Ne[1])}if(o(Rt||Xe,["touchmove","tapdrag","vmousemove"],H,{x:ae[0],y:ae[1]}),(!Rt||!Rt.grabbed())&&Xe!=Lt&&(Lt&&Lt.emit({originalEvent:H,type:"tapdragout",position:{x:ae[0],y:ae[1]}}),Xe&&Xe.emit({originalEvent:H,type:"tapdragover",position:{x:ae[0],y:ae[1]}})),n.touchData.last=Xe,V)for(var nt=0;nt<ae.length;nt++)ae[nt]&&n.touchData.startPosition[nt]&&Fe&&(n.touchData.singleTouchMoved=!0);if(V&&(Rt==null||Rt.pannable())&&ee.panningEnabled()&&ee.userPanningEnabled()){var qt=s(Rt,n.touchData.starts);qt&&(H.preventDefault(),n.data.bgActivePosistion||(n.data.bgActivePosistion=array2point(n.touchData.startPosition)),n.swipePanning?(ee.panBy({x:Ne[0]*le,y:Ne[1]*le}),ee.emit("dragpan")):Fe&&(n.swipePanning=!0,ee.panBy({x:Le*le,y:je*le}),ee.emit("dragpan"),Rt&&(Rt.unactivate(),n.redrawHint("select",!0),n.touchData.start=null)));var we=n.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ae[0]=we[0],ae[1]=we[1]}}for(var de=0;de<ae.length;de++)be[de]=ae[de];V&&H.touches.length>0&&!n.hoverData.draggingEles&&!n.swipePanning&&n.data.bgActivePosistion!=null&&(n.data.bgActivePosistion=void 0,n.redrawHint("select",!0),n.redraw())}},!1);var B;n.registerBinding(t,"touchcancel",B=function(H){var V=n.touchData.start;n.touchData.capture=!1,V&&V.unactivate()});var U,Z,oe,ie;if(n.registerBinding(t,"touchend",U=function(H){var V=n.touchData.start,Q=n.touchData.capture;if(Q)H.touches.length===0&&(n.touchData.capture=!1),H.preventDefault();else return;var ee=n.selection;n.swipePanning=!1,n.hoverData.draggingEles=!1;var ae=n.cy,be=ae.zoom(),le=n.touchData.now,we=n.touchData.earlier;if(H.touches[0]){var De=n.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);le[0]=De[0],le[1]=De[1]}if(H.touches[1]){var De=n.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);le[2]=De[0],le[3]=De[1]}if(H.touches[2]){var De=n.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);le[4]=De[0],le[5]=De[1]}V&&V.unactivate();var Fe;if(n.touchData.cxt){if(Fe={originalEvent:H,type:"cxttapend",position:{x:le[0],y:le[1]}},V?V.emit(Fe):ae.emit(Fe),!n.touchData.cxtDragged){var Ne={originalEvent:H,type:"cxttap",position:{x:le[0],y:le[1]}};V?V.emit(Ne):ae.emit(Ne)}n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxt=!1,n.touchData.start=null,n.redraw();return}if(!H.touches[2]&&ae.boxSelectionEnabled()&&n.touchData.selecting){n.touchData.selecting=!1;var de=ae.collection(n.getAllInBox(ee[0],ee[1],ee[2],ee[3]));ee[0]=void 0,ee[1]=void 0,ee[2]=void 0,ee[3]=void 0,ee[4]=0,n.redrawHint("select",!0),ae.emit({type:"boxend",originalEvent:H,position:{x:le[0],y:le[1]}});var Le=function(We){return We.selectable()&&!We.selected()};de.emit("box").stdFilter(Le).select().emit("boxselect"),de.nonempty()&&n.redrawHint("eles",!0),n.redraw()}if(V!=null&&V.unactivate(),H.touches[2])n.data.bgActivePosistion=void 0,n.redrawHint("select",!0);else if(!H.touches[1]){if(!H.touches[0]){if(!H.touches[0]){n.data.bgActivePosistion=void 0,n.redrawHint("select",!0);var $e=n.dragData.touchDragEles;if(V!=null){var je=V._private.grabbed;T($e),n.redrawHint("drag",!0),n.redrawHint("eles",!0),je&&(V.emit("freeon"),$e.emit("free"),n.dragData.didDrag&&(V.emit("dragfreeon"),$e.emit("dragfree"))),o(V,["touchend","tapend","vmouseup","tapdragout"],H,{x:le[0],y:le[1]}),V.unactivate(),n.touchData.start=null}else{var Me=n.findNearestElement(le[0],le[1],!0,!0);o(Me,["touchend","tapend","vmouseup","tapdragout"],H,{x:le[0],y:le[1]})}var ze=n.touchData.startPosition[0]-le[0],Je=ze*ze,Ke=n.touchData.startPosition[1]-le[1],ot=Ke*Ke,_e=Je+ot,Ae=_e*be*be;n.touchData.singleTouchMoved||(V||ae.$(":selected").unselect(["tapunselect"]),o(V,["tap","vclick"],H,{x:le[0],y:le[1]}),Z=!1,H.timeStamp-ie<=ae.multiClickDebounceTime()?(oe&&clearTimeout(oe),Z=!0,ie=null,o(V,["dbltap","vdblclick"],H,{x:le[0],y:le[1]})):(oe=setTimeout(function(){Z||o(V,["onetap","voneclick"],H,{x:le[0],y:le[1]})},ae.multiClickDebounceTime()),ie=H.timeStamp)),V!=null&&!n.dragData.didDrag&&V._private.selectable&&Ae<n.touchTapThreshold2&&!n.pinching&&(ae.selectionType()==="single"?(ae.$(r).unmerge(V).unselect(["tapunselect"]),V.select(["tapselect"])):V.selected()?V.unselect(["tapunselect"]):V.select(["tapselect"]),n.redrawHint("eles",!0)),n.touchData.singleTouchMoved=!0}}}for(var Ve=0;Ve<le.length;Ve++)we[Ve]=le[Ve];n.dragData.didDrag=!1,H.touches.length===0&&(n.touchData.dragDelta=[],n.touchData.startPosition=[null,null,null,null,null,null],n.touchData.startGPosition=null,n.touchData.didSelect=!1),H.touches.length<2&&(H.touches.length===1&&(n.touchData.startGPosition=[H.touches[0].clientX,H.touches[0].clientY]),n.pinching=!1,n.redrawHint("eles",!0),n.redraw())},!1),typeof TouchEvent>"u"){var se=[],ne=function(H){return{clientX:H.clientX,clientY:H.clientY,force:1,identifier:H.pointerId,pageX:H.pageX,pageY:H.pageY,radiusX:H.width/2,radiusY:H.height/2,screenX:H.screenX,screenY:H.screenY,target:H.target}},he=function(H){return{event:H,touch:ne(H)}},xe=function(H){se.push(he(H))},me=function(H){for(var V=0;V<se.length;V++){var Q=se[V];if(Q.event.pointerId===H.pointerId){se.splice(V,1);return}}},Ie=function(H){var V=se.filter(function(Q){return Q.event.pointerId===H.pointerId})[0];V.event=H,V.touch=ne(H)},Pe=function(H){H.touches=se.map(function(V){return V.touch})},Ce=function(H){return H.pointerType==="mouse"||H.pointerType===4};n.registerBinding(n.container,"pointerdown",function(pe){Ce(pe)||(pe.preventDefault(),xe(pe),Pe(pe),j(pe))}),n.registerBinding(n.container,"pointerup",function(pe){Ce(pe)||(me(pe),Pe(pe),U(pe))}),n.registerBinding(n.container,"pointercancel",function(pe){Ce(pe)||(me(pe),Pe(pe),B(pe))}),n.registerBinding(n.container,"pointermove",function(pe){Ce(pe)||(pe.preventDefault(),Ie(pe),Pe(pe),z(pe))})}};var BRp$2={};BRp$2.generatePolygon=function(n,t){return this.nodeShapes[n]={renderer:this,name:n,points:t,draw:function(a,o,u,s,c,l){this.renderer.nodeShapeImpl("polygon",a,o,u,s,c,this.points)},intersectLine:function(a,o,u,s,c,l,d,f){return polygonIntersectLine(c,l,this.points,a,o,u/2,s/2,d)},checkPoint:function(a,o,u,s,c,l,d,f){return pointInsidePolygon(a,o,this.points,l,d,s,c,[0,-1],u)}}};BRp$2.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(t,r,a,o,u,s){this.renderer.nodeShapeImpl(this.name,t,r,a,o,u)},intersectLine:function(t,r,a,o,u,s,c,l){return intersectLineEllipse(u,s,t,r,a/2+c,o/2+c)},checkPoint:function(t,r,a,o,u,s,c,l){return checkInEllipse(t,r,o,u,s,c,a)}}};BRp$2.generateRoundPolygon=function(n,t){return this.nodeShapes[n]={renderer:this,name:n,points:t,getOrCreateCorners:function(a,o,u,s,c,l,d){if(l[d]!==void 0&&l[d+"-cx"]===a&&l[d+"-cy"]===o)return l[d];l[d]=new Array(t.length/2),l[d+"-cx"]=a,l[d+"-cy"]=o;var f=u/2,h=s/2;c=c==="auto"?getRoundPolygonRadius(u,s):c;for(var v=new Array(t.length/2),g=0;g<t.length/2;g++)v[g]={x:a+f*t[g*2],y:o+h*t[g*2+1]};var b,_,S,T,w=v.length;for(_=v[w-1],b=0;b<w;b++)S=v[b%w],T=v[(b+1)%w],l[d][b]=getRoundCorner(_,S,T,c),_=S,S=T;return l[d]},draw:function(a,o,u,s,c,l,d){this.renderer.nodeShapeImpl("round-polygon",a,o,u,s,c,this.points,this.getOrCreateCorners(o,u,s,c,l,d,"drawCorners"))},intersectLine:function(a,o,u,s,c,l,d,f,h){return roundPolygonIntersectLine(c,l,this.points,a,o,u,s,d,this.getOrCreateCorners(a,o,u,s,f,h,"corners"))},checkPoint:function(a,o,u,s,c,l,d,f,h){return pointInsideRoundPolygon(a,o,this.points,l,d,s,c,this.getOrCreateCorners(l,d,s,c,f,h,"corners"))}}};BRp$2.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(t,r,a,o,u,s){this.renderer.nodeShapeImpl(this.name,t,r,a,o,u,this.points,s)},intersectLine:function(t,r,a,o,u,s,c,l){return roundRectangleIntersectLine(u,s,t,r,a,o,c,l)},checkPoint:function(t,r,a,o,u,s,c,l){var d=o/2,f=u/2;l=l==="auto"?getRoundRectangleRadius(o,u):l,l=Math.min(d,f,l);var h=l*2;return!!(pointInsidePolygon(t,r,this.points,s,c,o,u-h,[0,-1],a)||pointInsidePolygon(t,r,this.points,s,c,o-h,u,[0,-1],a)||checkInEllipse(t,r,h,h,s-d+l,c-f+l,a)||checkInEllipse(t,r,h,h,s+d-l,c-f+l,a)||checkInEllipse(t,r,h,h,s+d-l,c+f-l,a)||checkInEllipse(t,r,h,h,s-d+l,c+f-l,a))}}};BRp$2.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:getCutRectangleCornerLength(),points:generateUnitNgonPointsFitToSquare(4,0),draw:function(t,r,a,o,u,s){this.renderer.nodeShapeImpl(this.name,t,r,a,o,u,null,s)},generateCutTrianglePts:function(t,r,a,o,u){var s=u==="auto"?this.cornerLength:u,c=r/2,l=t/2,d=a-l,f=a+l,h=o-c,v=o+c;return{topLeft:[d,h+s,d+s,h,d+s,h+s],topRight:[f-s,h,f,h+s,f-s,h+s],bottomRight:[f,v-s,f-s,v,f-s,v-s],bottomLeft:[d+s,v,d,v-s,d+s,v-s]}},intersectLine:function(t,r,a,o,u,s,c,l){var d=this.generateCutTrianglePts(a+2*c,o+2*c,t,r,l),f=[].concat.apply([],[d.topLeft.splice(0,4),d.topRight.splice(0,4),d.bottomRight.splice(0,4),d.bottomLeft.splice(0,4)]);return polygonIntersectLine(u,s,f,t,r)},checkPoint:function(t,r,a,o,u,s,c,l){var d=l==="auto"?this.cornerLength:l;if(pointInsidePolygon(t,r,this.points,s,c,o,u-2*d,[0,-1],a)||pointInsidePolygon(t,r,this.points,s,c,o-2*d,u,[0,-1],a))return!0;var f=this.generateCutTrianglePts(o,u,s,c);return pointInsidePolygonPoints(t,r,f.topLeft)||pointInsidePolygonPoints(t,r,f.topRight)||pointInsidePolygonPoints(t,r,f.bottomRight)||pointInsidePolygonPoints(t,r,f.bottomLeft)}}};BRp$2.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(t,r,a,o,u,s){this.renderer.nodeShapeImpl(this.name,t,r,a,o,u)},intersectLine:function(t,r,a,o,u,s,c,l){var d=.15,f=.5,h=.85,v=this.generateBarrelBezierPts(a+2*c,o+2*c,t,r),g=function(S){var T=qbezierPtAt({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},d),w=qbezierPtAt({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},f),A=qbezierPtAt({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},h);return[S[0],S[1],T.x,T.y,w.x,w.y,A.x,A.y,S[4],S[5]]},b=[].concat(g(v.topLeft),g(v.topRight),g(v.bottomRight),g(v.bottomLeft));return polygonIntersectLine(u,s,b,t,r)},generateBarrelBezierPts:function(t,r,a,o){var u=r/2,s=t/2,c=a-s,l=a+s,d=o-u,f=o+u,h=getBarrelCurveConstants(t,r),v=h.heightOffset,g=h.widthOffset,b=h.ctrlPtOffsetPct*t,_={topLeft:[c,d+v,c+b,d,c+g,d],topRight:[l-g,d,l-b,d,l,d+v],bottomRight:[l,f-v,l-b,f,l-g,f],bottomLeft:[c+g,f,c+b,f,c,f-v]};return _.topLeft.isTop=!0,_.topRight.isTop=!0,_.bottomLeft.isBottom=!0,_.bottomRight.isBottom=!0,_},checkPoint:function(t,r,a,o,u,s,c,l){var d=getBarrelCurveConstants(o,u),f=d.heightOffset,h=d.widthOffset;if(pointInsidePolygon(t,r,this.points,s,c,o,u-2*f,[0,-1],a)||pointInsidePolygon(t,r,this.points,s,c,o-2*h,u,[0,-1],a))return!0;for(var v=this.generateBarrelBezierPts(o,u,s,c),g=function(F,D,$){var O=$[4],P=$[2],C=$[0],q=$[5],M=$[1],N=Math.min(O,C),G=Math.max(O,C),X=Math.min(q,M),Y=Math.max(q,M);if(N<=F&&F<=G&&X<=D&&D<=Y){var W=bezierPtsToQuadCoeff(O,P,C),te=solveQuadratic(W[0],W[1],W[2],F),ue=te.filter(function(fe){return 0<=fe&&fe<=1});if(ue.length>0)return ue[0]}return null},b=Object.keys(v),_=0;_<b.length;_++){var S=b[_],T=v[S],w=g(t,r,T);if(w!=null){var A=T[5],R=T[3],E=T[1],I=qbezierAt(A,R,E,w);if(T.isTop&&I<=r||T.isBottom&&r<=I)return!0}}return!1}}};BRp$2.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(t,r,a,o,u,s){this.renderer.nodeShapeImpl(this.name,t,r,a,o,u,this.points,s)},intersectLine:function(t,r,a,o,u,s,c,l){var d=t-(a/2+c),f=r-(o/2+c),h=f,v=t+(a/2+c),g=finiteLinesIntersect(u,s,t,r,d,f,v,h,!1);return g.length>0?g:roundRectangleIntersectLine(u,s,t,r,a,o,c,l)},checkPoint:function(t,r,a,o,u,s,c,l){l=l==="auto"?getRoundRectangleRadius(o,u):l;var d=2*l;if(pointInsidePolygon(t,r,this.points,s,c,o,u-d,[0,-1],a)||pointInsidePolygon(t,r,this.points,s,c,o-d,u,[0,-1],a))return!0;var f=o/2+2*a,h=u/2+2*a,v=[s-f,c-h,s-f,c,s+f,c,s+f,c-h];return!!(pointInsidePolygonPoints(t,r,v)||checkInEllipse(t,r,d,d,s+o/2-l,c+u/2-l,a)||checkInEllipse(t,r,d,d,s-o/2+l,c+u/2-l,a))}}};BRp$2.registerNodeShapes=function(){var n=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generateRoundPolygon("round-triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generatePolygon("rectangle",generateUnitNgonPointsFitToSquare(4,0)),n.square=n.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generateRoundPolygon("round-pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generatePolygon("hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generateRoundPolygon("round-hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generatePolygon("heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generateRoundPolygon("round-heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generatePolygon("octagon",generateUnitNgonPointsFitToSquare(8,0)),this.generateRoundPolygon("round-octagon",generateUnitNgonPointsFitToSquare(8,0));var a=new Array(20);{var o=generateUnitNgonPoints(5,0),u=generateUnitNgonPoints(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var c=0;c<u.length/2;c++)u[c*2]*=s,u[c*2+1]*=s;for(var c=0;c<20/4;c++)a[c*4]=o[c*2],a[c*4+1]=o[c*2+1],a[c*4+2]=u[c*2],a[c*4+3]=u[c*2+1]}a=fitPolygonToSquare(a),this.generatePolygon("star",a),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}n.makePolygon=function(d){var f=d.join("$"),h="polygon-"+f,v;return(v=this[h])?v:t.generatePolygon(h,d)}};var BRp$1={};BRp$1.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};BRp$1.redraw=function(n){n=n||staticEmptyObject();var t=this;t.averageRedrawTime===void 0&&(t.averageRedrawTime=0),t.lastRedrawTime===void 0&&(t.lastRedrawTime=0),t.lastDrawTime===void 0&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=n};BRp$1.beforeRender=function(n,t){if(!this.destroyed){t==null&&error("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:n,priority:t}),r.sort(function(a,o){return o.priority-a.priority})}};var beforeRenderCallbacks=function(t,r,a){for(var o=t.beforeRenderCallbacks,u=0;u<o.length;u++)o[u].fn(r,a)};BRp$1.startRenderLoop=function(){var n=this,t=n.cy;if(!n.renderLoopStarted){n.renderLoopStarted=!0;var r=function a(o){if(!n.destroyed){if(!t.batching())if(n.requestedFrame&&!n.skipFrame){beforeRenderCallbacks(n,!0,o);var u=performanceNow();n.render(n.renderOptions);var s=n.lastDrawTime=performanceNow();n.averageRedrawTime===void 0&&(n.averageRedrawTime=s-u),n.redrawCount===void 0&&(n.redrawCount=0),n.redrawCount++,n.redrawTotalTime===void 0&&(n.redrawTotalTime=0);var c=s-u;n.redrawTotalTime+=c,n.lastRedrawTime=c,n.averageRedrawTime=n.averageRedrawTime/2+c/2,n.requestedFrame=!1}else beforeRenderCallbacks(n,!1,o);n.skipFrame=!1,requestAnimationFrame(a)}};requestAnimationFrame(r)}};var BaseRenderer=function(t){this.init(t)},BR=BaseRenderer,BRp=BR.prototype;BRp.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];BRp.init=function(n){var t=this;t.options=n,t.cy=n.cy;var r=t.container=n.cy.container(),a=t.cy.window();if(a){var o=a.document,u=o.head,s="__________cytoscape_stylesheet",c="__________cytoscape_container",l=o.getElementById(s)!=null;if(r.className.indexOf(c)<0&&(r.className=(r.className||"")+" "+c),!l){var d=o.createElement("style");d.id=s,d.textContent="."+c+" { position: relative; }",u.insertBefore(d,u.children[0])}var f=a.getComputedStyle(r),h=f.getPropertyValue("position");h==="static"&&warn("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=n.showFps,t.debug=n.debug,t.webgl=n.webgl,t.hideEdgesOnViewport=n.hideEdgesOnViewport,t.textureOnViewport=n.textureOnViewport,t.wheelSensitivity=n.wheelSensitivity,t.motionBlurEnabled=n.motionBlur,t.forcedPixelRatio=number$1(n.pixelRatio)?n.pixelRatio:null,t.motionBlur=n.motionBlur,t.motionBlurOpacity=n.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=n.desktopTapThreshold,t.desktopTapThreshold2=n.desktopTapThreshold*n.desktopTapThreshold,t.touchTapThreshold=n.touchTapThreshold,t.touchTapThreshold2=n.touchTapThreshold*n.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()};BRp.notify=function(n,t){var r=this,a=r.cy;if(!this.destroyed){if(n==="init"){r.load();return}if(n==="destroy"){r.destroy();return}(n==="add"||n==="remove"||n==="move"&&a.hasCompoundNodes()||n==="load"||n==="zorder"||n==="mount")&&r.invalidateCachedZSortedEles(),n==="viewport"&&r.redrawHint("select",!0),n==="gc"&&r.redrawHint("gc",!0),(n==="load"||n==="resize"||n==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};BRp.destroy=function(){var n=this;n.destroyed=!0,n.cy.stopAnimationLoop();for(var t=0;t<n.bindings.length;t++){var r=n.bindings[t],a=r,o=a.target;(o.off||o.removeEventListener).apply(o,a.args)}if(n.bindings=[],n.beforeRenderCallbacks=[],n.onUpdateEleCalcsFns=[],n.removeObserver&&n.removeObserver.disconnect(),n.styleObserver&&n.styleObserver.disconnect(),n.resizeObserver&&n.resizeObserver.disconnect(),n.labelCalcDiv)try{document.body.removeChild(n.labelCalcDiv)}catch{}};BRp.isHeadless=function(){return!1};[BRp$f,BRp$5,BRp$4,BRp$3,BRp$2,BRp$1].forEach(function(n){extend(BRp,n)});var fullFpsTime=1e3/60,defs={setupDequeueing:function(t){return function(){var a=this,o=this.renderer;if(!a.dequeueingSetup){a.dequeueingSetup=!0;var u=debounce_1(function(){o.redrawHint("eles",!0),o.redrawHint("drag",!0),o.redraw()},t.deqRedrawThreshold),s=function(d,f){var h=performanceNow(),v=o.averageRedrawTime,g=o.lastRedrawTime,b=[],_=o.cy.extent(),S=o.getPixelRatio();for(d||o.flushRenderedStyleQueue();;){var T=performanceNow(),w=T-h,A=T-f;if(g<fullFpsTime){var R=fullFpsTime-(d?v:0);if(A>=t.deqFastCost*R)break}else if(d){if(w>=t.deqCost*g||w>=t.deqAvgCost*v)break}else if(A>=t.deqNoDrawCost*fullFpsTime)break;var E=t.deq(a,S,_);if(E.length>0)for(var I=0;I<E.length;I++)b.push(E[I]);else break}b.length>0&&(t.onDeqd(a,b),!d&&t.shouldRedraw(a,b,S,_)&&u())},c=t.priority||noop$1;o.beforeRender(s,c(a))}}}},ElementTextureCacheLookup=function(){function n(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:falsify;_classCallCheck(this,n),this.idsByKey=new Map$2,this.keyForId=new Map$2,this.cachesByLvl=new Map$2,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=r}return _createClass(n,[{key:"getIdsFor",value:function(r){r==null&&error("Can not get id list for null key");var a=this.idsByKey,o=this.idsByKey.get(r);return o||(o=new Set$1,a.set(r,o)),o}},{key:"addIdForKey",value:function(r,a){r!=null&&this.getIdsFor(r).add(a)}},{key:"deleteIdForKey",value:function(r,a){r!=null&&this.getIdsFor(r).delete(a)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var a=r.id(),o=this.keyForId.get(a),u=this.getKey(r);this.deleteIdForKey(o,a),this.addIdForKey(u,a),this.keyForId.set(a,u)}},{key:"deleteKeyMappingFor",value:function(r){var a=r.id(),o=this.keyForId.get(a);this.deleteIdForKey(o,a),this.keyForId.delete(a)}},{key:"keyHasChangedFor",value:function(r){var a=r.id(),o=this.keyForId.get(a),u=this.getKey(r);return o!==u}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var a=this.cachesByLvl,o=this.lvls,u=a.get(r);return u||(u=new Map$2,a.set(r,u),o.push(r)),u}},{key:"getCache",value:function(r,a){return this.getCachesAt(a).get(r)}},{key:"get",value:function(r,a){var o=this.getKey(r),u=this.getCache(o,a);return u!=null&&this.updateKeyMappingFor(r),u}},{key:"getForCachedKey",value:function(r,a){var o=this.keyForId.get(r.id()),u=this.getCache(o,a);return u}},{key:"hasCache",value:function(r,a){return this.getCachesAt(a).has(r)}},{key:"has",value:function(r,a){var o=this.getKey(r);return this.hasCache(o,a)}},{key:"setCache",value:function(r,a,o){o.key=r,this.getCachesAt(a).set(r,o)}},{key:"set",value:function(r,a,o){var u=this.getKey(r);this.setCache(u,a,o),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,a){this.getCachesAt(a).delete(r)}},{key:"delete",value:function(r,a){var o=this.getKey(r);this.deleteCache(o,a)}},{key:"invalidateKey",value:function(r){var a=this;this.lvls.forEach(function(o){return a.deleteCache(r,o)})}},{key:"invalidate",value:function(r){var a=r.id(),o=this.keyForId.get(a);this.deleteKeyMappingFor(r);var u=this.doesEleInvalidateKey(r);return u&&this.invalidateKey(o),u||this.getNumberOfIdsForKey(o)===0}}]),n}(),minTxrH=25,txrStepH=50,minLvl$1=-4,maxLvl$1=3,maxZoom$1=7.99,eleTxrSpacing=8,defTxrWidth=1024,maxTxrW=1024,maxTxrH=1024,minUtility=.2,maxFullness=.8,maxFullnessChecks=10,deqCost$1=.15,deqAvgCost$1=.1,deqNoDrawCost$1=.9,deqFastCost$1=.9,deqRedrawThreshold$1=100,maxDeqSize$1=1,getTxrReasons={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},initDefaults=defaults$g({getKey:null,doesEleInvalidateKey:falsify,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:trueify,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ElementTextureCache=function(t,r){var a=this;a.renderer=t,a.onDequeues=[];var o=initDefaults(r);extend(a,o),a.lookup=new ElementTextureCacheLookup(o.getKey,o.doesEleInvalidateKey),a.setupDequeueing()},ETCp=ElementTextureCache.prototype;ETCp.reasons=getTxrReasons;ETCp.getTextureQueue=function(n){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[n]=t.eleImgCaches[n]||[]};ETCp.getRetiredTextureQueue=function(n){var t=this,r=t.eleImgCaches.retired=t.eleImgCaches.retired||{},a=r[n]=r[n]||[];return a};ETCp.getElementQueue=function(){var n=this,t=n.eleCacheQueue=n.eleCacheQueue||new heap(function(r,a){return a.reqs-r.reqs});return t};ETCp.getElementKeyToQueue=function(){var n=this,t=n.eleKeyToCacheQueue=n.eleKeyToCacheQueue||{};return t};ETCp.getElement=function(n,t,r,a,o){var u=this,s=this.renderer,c=s.cy.zoom(),l=this.lookup;if(!t||t.w===0||t.h===0||isNaN(t.w)||isNaN(t.h)||!n.visible()||n.removed()||!u.allowEdgeTxrCaching&&n.isEdge()||!u.allowParentTxrCaching&&n.isParent())return null;if(a==null&&(a=Math.ceil(log2(c*r))),a<minLvl$1)a=minLvl$1;else if(c>=maxZoom$1||a>maxLvl$1)return null;var d=Math.pow(2,a),f=t.h*d,h=t.w*d,v=s.eleTextBiggerThanMin(n,d);if(!this.isVisible(n,v))return null;var g=l.get(n,a);if(g&&g.invalidated&&(g.invalidated=!1,g.texture.invalidatedWidth-=g.width),g)return g;var b;if(f<=minTxrH?b=minTxrH:f<=txrStepH?b=txrStepH:b=Math.ceil(f/txrStepH)*txrStepH,f>maxTxrH||h>maxTxrW)return null;var _=u.getTextureQueue(b),S=_[_.length-2],T=function(){return u.recycleTexture(b,h)||u.addTexture(b,h)};S||(S=_[_.length-1]),S||(S=T()),S.width-S.usedWidth<h&&(S=T());for(var w=function(N){return N&&N.scaledLabelShown===v},A=o&&o===getTxrReasons.dequeue,R=o&&o===getTxrReasons.highQuality,E=o&&o===getTxrReasons.downscale,I,L=a+1;L<=maxLvl$1;L++){var F=l.get(n,L);if(F){I=F;break}}var D=I&&I.level===a+1?I:null,$=function(){S.context.drawImage(D.texture.canvas,D.x,0,D.width,D.height,S.usedWidth,0,h,f)};if(S.context.setTransform(1,0,0,1,0,0),S.context.clearRect(S.usedWidth,0,h,b),w(D))$();else if(w(I))if(R){for(var O=I.level;O>a;O--)D=u.getElement(n,t,r,O,getTxrReasons.downscale);$()}else return u.queueElement(n,I.level-1),I;else{var P;if(!A&&!R&&!E)for(var C=a-1;C>=minLvl$1;C--){var q=l.get(n,C);if(q){P=q;break}}if(w(P))return u.queueElement(n,a),P;S.context.translate(S.usedWidth,0),S.context.scale(d,d),this.drawElement(S.context,n,t,v,!1),S.context.scale(1/d,1/d),S.context.translate(-S.usedWidth,0)}return g={x:S.usedWidth,texture:S,level:a,scale:d,width:h,height:f,scaledLabelShown:v},S.usedWidth+=Math.ceil(h+eleTxrSpacing),S.eleCaches.push(g),l.set(n,a,g),u.checkTextureFullness(S),g};ETCp.invalidateElements=function(n){for(var t=0;t<n.length;t++)this.invalidateElement(n[t])};ETCp.invalidateElement=function(n){var t=this,r=t.lookup,a=[],o=r.isInvalid(n);if(o){for(var u=minLvl$1;u<=maxLvl$1;u++){var s=r.getForCachedKey(n,u);s&&a.push(s)}var c=r.invalidate(n);if(c)for(var l=0;l<a.length;l++){var d=a[l],f=d.texture;f.invalidatedWidth+=d.width,d.invalidated=!0,t.checkTextureUtility(f)}t.removeFromQueue(n)}};ETCp.checkTextureUtility=function(n){n.invalidatedWidth>=minUtility*n.width&&this.retireTexture(n)};ETCp.checkTextureFullness=function(n){var t=this,r=t.getTextureQueue(n.height);n.usedWidth/n.width>maxFullness&&n.fullnessChecks>=maxFullnessChecks?removeFromArray(r,n):n.fullnessChecks++};ETCp.retireTexture=function(n){var t=this,r=n.height,a=t.getTextureQueue(r),o=this.lookup;removeFromArray(a,n),n.retired=!0;for(var u=n.eleCaches,s=0;s<u.length;s++){var c=u[s];o.deleteCache(c.key,c.level)}clearArray(u);var l=t.getRetiredTextureQueue(r);l.push(n)};ETCp.addTexture=function(n,t){var r=this,a=r.getTextureQueue(n),o={};return a.push(o),o.eleCaches=[],o.height=n,o.width=Math.max(defTxrWidth,t),o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,o.canvas=r.renderer.makeOffscreenCanvas(o.width,o.height),o.context=o.canvas.getContext("2d"),o};ETCp.recycleTexture=function(n,t){for(var r=this,a=r.getTextureQueue(n),o=r.getRetiredTextureQueue(n),u=0;u<o.length;u++){var s=o[u];if(s.width>=t)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,clearArray(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),removeFromArray(o,s),a.push(s),s}};ETCp.queueElement=function(n,t){var r=this,a=r.getElementQueue(),o=r.getElementKeyToQueue(),u=this.getKey(n),s=o[u];if(s)s.level=Math.max(s.level,t),s.eles.merge(n),s.reqs++,a.updateItem(s);else{var c={eles:n.spawn().merge(n),level:t,reqs:1,key:u};a.push(c),o[u]=c}};ETCp.dequeue=function(n){for(var t=this,r=t.getElementQueue(),a=t.getElementKeyToQueue(),o=[],u=t.lookup,s=0;s<maxDeqSize$1&&r.size()>0;s++){var c=r.pop(),l=c.key,d=c.eles[0],f=u.hasCache(d,c.level);if(a[l]=null,f)continue;o.push(c);var h=t.getBoundingBox(d);t.getElement(d,h,n,c.level,getTxrReasons.dequeue)}return o};ETCp.removeFromQueue=function(n){var t=this,r=t.getElementQueue(),a=t.getElementKeyToQueue(),o=this.getKey(n),u=a[o];u!=null&&(u.eles.length===1?(u.reqs=MAX_INT$1,r.updateItem(u),r.pop(),a[o]=null):u.eles.unmerge(n))};ETCp.onDequeue=function(n){this.onDequeues.push(n)};ETCp.offDequeue=function(n){removeFromArray(this.onDequeues,n)};ETCp.setupDequeueing=defs.setupDequeueing({deqRedrawThreshold:deqRedrawThreshold$1,deqCost:deqCost$1,deqAvgCost:deqAvgCost$1,deqNoDrawCost:deqNoDrawCost$1,deqFastCost:deqFastCost$1,deq:function(t,r,a){return t.dequeue(r,a)},onDeqd:function(t,r){for(var a=0;a<t.onDequeues.length;a++){var o=t.onDequeues[a];o(r)}},shouldRedraw:function(t,r,a,o){for(var u=0;u<r.length;u++)for(var s=r[u].eles,c=0;c<s.length;c++){var l=s[c].boundingBox();if(boundingBoxesIntersect(l,o))return!0}return!1},priority:function(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});var defNumLayers=1,minLvl=-4,maxLvl=2,maxZoom=3.99,deqRedrawThreshold=50,refineEleDebounceTime=50,deqCost=.15,deqAvgCost=.1,deqNoDrawCost=.9,deqFastCost=.9,maxDeqSize=1,invalidThreshold=250,maxLayerArea=4e3*4e3,maxLayerDim=32767,useHighQualityEleTxrReqs=!0,LayeredTextureCache=function(t){var r=this,a=r.renderer=t,o=a.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=performanceNow()-2*invalidThreshold,r.skipping=!1,r.eleTxrDeqs=o.collection(),r.scheduleElementRefinement=debounce_1(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},refineEleDebounceTime),a.beforeRender(function(s,c){c-r.lastInvalidationTime<=invalidThreshold?r.skipping=!0:r.skipping=!1},a.beforeRenderPriorities.lyrTxrSkip);var u=function(c,l){return l.reqs-c.reqs};r.layersQueue=new heap(u),r.setupDequeueing()},LTCp=LayeredTextureCache.prototype,layerIdPool=0,MAX_INT=Math.pow(2,53)-1;LTCp.makeLayer=function(n,t){var r=Math.pow(2,t),a=Math.ceil(n.w*r),o=Math.ceil(n.h*r),u=this.renderer.makeOffscreenCanvas(a,o),s={id:layerIdPool=++layerIdPool%MAX_INT,bb:n,level:t,width:a,height:o,canvas:u,context:u.getContext("2d"),eles:[],elesQueue:[],reqs:0},c=s.context,l=-s.bb.x1,d=-s.bb.y1;return c.scale(r,r),c.translate(l,d),s};LTCp.getLayers=function(n,t,r){var a=this,o=a.renderer,u=o.cy,s=u.zoom(),c=a.firstGet;if(a.firstGet=!1,r==null){if(r=Math.ceil(log2(s*t)),r<minLvl)r=minLvl;else if(s>=maxZoom||r>maxLvl)return null}a.validateLayersElesOrdering(r,n);var l=a.layersByLevel,d=Math.pow(2,r),f=l[r]=l[r]||[],h,v=a.levelIsComplete(r,n),g,b=function(){var $=function(M){if(a.validateLayersElesOrdering(M,n),a.levelIsComplete(M,n))return g=l[M],!0},O=function(M){if(!g)for(var N=r+M;minLvl<=N&&N<=maxLvl&&!$(N);N+=M);};O(1),O(-1);for(var P=f.length-1;P>=0;P--){var C=f[P];C.invalid&&removeFromArray(f,C)}};if(!v)b();else return f;var _=function(){if(!h){h=makeBoundingBox();for(var $=0;$<n.length;$++)updateBoundingBox(h,n[$].boundingBox())}return h},S=function($){$=$||{};var O=$.after;_();var P=Math.ceil(h.w*d),C=Math.ceil(h.h*d);if(P>maxLayerDim||C>maxLayerDim)return null;var q=P*C;if(q>maxLayerArea)return null;var M=a.makeLayer(h,r);if(O!=null){var N=f.indexOf(O)+1;f.splice(N,0,M)}else($.insert===void 0||$.insert)&&f.unshift(M);return M};if(a.skipping&&!c)return null;for(var T=null,w=n.length/defNumLayers,A=!c,R=0;R<n.length;R++){var E=n[R],I=E._private.rscratch,L=I.imgLayerCaches=I.imgLayerCaches||{},F=L[r];if(F){T=F;continue}if((!T||T.eles.length>=w||!boundingBoxInBoundingBox(T.bb,E.boundingBox()))&&(T=S({insert:!0,after:T}),!T))return null;g||A?a.queueLayer(T,E):a.drawEleInLayer(T,E,r,t),T.eles.push(E),L[r]=T}return g||(A?null:f)};LTCp.getEleLevelForLayerLevel=function(n,t){return n};LTCp.drawEleInLayer=function(n,t,r,a){var o=this,u=this.renderer,s=n.context,c=t.boundingBox();c.w===0||c.h===0||!t.visible()||(r=o.getEleLevelForLayerLevel(r,a),u.setImgSmoothing(s,!1),u.drawCachedElement(s,t,null,null,r,useHighQualityEleTxrReqs),u.setImgSmoothing(s,!0))};LTCp.levelIsComplete=function(n,t){var r=this,a=r.layersByLevel[n];if(!a||a.length===0)return!1;for(var o=0,u=0;u<a.length;u++){var s=a[u];if(s.reqs>0||s.invalid)return!1;o+=s.eles.length}return o===t.length};LTCp.validateLayersElesOrdering=function(n,t){var r=this.layersByLevel[n];if(r)for(var a=0;a<r.length;a++){for(var o=r[a],u=-1,s=0;s<t.length;s++)if(o.eles[0]===t[s]){u=s;break}if(u<0){this.invalidateLayer(o);continue}for(var c=u,s=0;s<o.eles.length;s++)if(o.eles[s]!==t[c+s]){this.invalidateLayer(o);break}}};LTCp.updateElementsInLayers=function(n,t){for(var r=this,a=element(n[0]),o=0;o<n.length;o++)for(var u=a?null:n[o],s=a?n[o]:n[o].ele,c=s._private.rscratch,l=c.imgLayerCaches=c.imgLayerCaches||{},d=minLvl;d<=maxLvl;d++){var f=l[d];f&&(u&&r.getEleLevelForLayerLevel(f.level)!==u.level||t(f,s,u))}};LTCp.haveLayers=function(){for(var n=this,t=!1,r=minLvl;r<=maxLvl;r++){var a=n.layersByLevel[r];if(a&&a.length>0){t=!0;break}}return t};LTCp.invalidateElements=function(n){var t=this;n.length!==0&&(t.lastInvalidationTime=performanceNow(),!(n.length===0||!t.haveLayers())&&t.updateElementsInLayers(n,function(a,o,u){t.invalidateLayer(a)}))};LTCp.invalidateLayer=function(n){if(this.lastInvalidationTime=performanceNow(),!n.invalid){var t=n.level,r=n.eles,a=this.layersByLevel[t];removeFromArray(a,n),n.elesQueue=[],n.invalid=!0,n.replacement&&(n.replacement.invalid=!0);for(var o=0;o<r.length;o++){var u=r[o]._private.rscratch.imgLayerCaches;u&&(u[t]=null)}}};LTCp.refineElementTextures=function(n){var t=this;t.updateElementsInLayers(n,function(a,o,u){var s=a.replacement;if(s||(s=a.replacement=t.makeLayer(a.bb,a.level),s.replaces=a,s.eles=a.eles),!s.reqs)for(var c=0;c<s.eles.length;c++)t.queueLayer(s,s.eles[c])})};LTCp.enqueueElementRefinement=function(n){this.eleTxrDeqs.merge(n),this.scheduleElementRefinement()};LTCp.queueLayer=function(n,t){var r=this,a=r.layersQueue,o=n.elesQueue,u=o.hasId=o.hasId||{};if(!n.replacement){if(t){if(u[t.id()])return;o.push(t),u[t.id()]=!0}n.reqs?(n.reqs++,a.updateItem(n)):(n.reqs=1,a.push(n))}};LTCp.dequeue=function(n){for(var t=this,r=t.layersQueue,a=[],o=0;o<maxDeqSize&&r.size()!==0;){var u=r.peek();if(u.replacement){r.pop();continue}if(u.replaces&&u!==u.replaces.replacement){r.pop();continue}if(u.invalid){r.pop();continue}var s=u.elesQueue.shift();s&&(t.drawEleInLayer(u,s,u.level,n),o++),a.length===0&&a.push(!0),u.elesQueue.length===0&&(r.pop(),u.reqs=0,u.replaces&&t.applyLayerReplacement(u),t.requestRedraw())}return a};LTCp.applyLayerReplacement=function(n){var t=this,r=t.layersByLevel[n.level],a=n.replaces,o=r.indexOf(a);if(!(o<0||a.invalid)){r[o]=n;for(var u=0;u<n.eles.length;u++){var s=n.eles[u]._private,c=s.imgLayerCaches=s.imgLayerCaches||{};c&&(c[n.level]=n)}t.requestRedraw()}};LTCp.requestRedraw=debounce_1(function(){var n=this.renderer;n.redrawHint("eles",!0),n.redrawHint("drag",!0),n.redraw()},100);LTCp.setupDequeueing=defs.setupDequeueing({deqRedrawThreshold,deqCost,deqAvgCost,deqNoDrawCost,deqFastCost,deq:function(t,r){return t.dequeue(r)},onDeqd:noop$1,shouldRedraw:trueify,priority:function(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});var CRp$b={},impl;function polygon(n,t){for(var r=0;r<t.length;r++){var a=t[r];n.lineTo(a.x,a.y)}}function triangleBackcurve(n,t,r){for(var a,o=0;o<t.length;o++){var u=t[o];o===0&&(a=u),n.lineTo(u.x,u.y)}n.quadraticCurveTo(r.x,r.y,a.x,a.y)}function triangleTee(n,t,r){n.beginPath&&n.beginPath();for(var a=t,o=0;o<a.length;o++){var u=a[o];n.lineTo(u.x,u.y)}var s=r,c=r[0];n.moveTo(c.x,c.y);for(var o=1;o<s.length;o++){var u=s[o];n.lineTo(u.x,u.y)}n.closePath&&n.closePath()}function circleTriangle(n,t,r,a,o){n.beginPath&&n.beginPath(),n.arc(r,a,o,0,Math.PI*2,!1);var u=t,s=u[0];n.moveTo(s.x,s.y);for(var c=0;c<u.length;c++){var l=u[c];n.lineTo(l.x,l.y)}n.closePath&&n.closePath()}function circle(n,t,r,a){n.arc(t,r,a,0,Math.PI*2,!1)}CRp$b.arrowShapeImpl=function(n){return(impl||(impl={polygon,"triangle-backcurve":triangleBackcurve,"triangle-tee":triangleTee,"circle-triangle":circleTriangle,"triangle-cross":triangleTee,circle}))[n]};var CRp$a={};CRp$a.drawElement=function(n,t,r,a,o,u){var s=this;t.isNode()?s.drawNode(n,t,r,a,o,u):s.drawEdge(n,t,r,a,o,u)};CRp$a.drawElementOverlay=function(n,t){var r=this;t.isNode()?r.drawNodeOverlay(n,t):r.drawEdgeOverlay(n,t)};CRp$a.drawElementUnderlay=function(n,t){var r=this;t.isNode()?r.drawNodeUnderlay(n,t):r.drawEdgeUnderlay(n,t)};CRp$a.drawCachedElementPortion=function(n,t,r,a,o,u,s,c){var l=this,d=r.getBoundingBox(t);if(!(d.w===0||d.h===0)){var f=r.getElement(t,d,a,o,u);if(f!=null){var h=c(l,t);if(h===0)return;var v=s(l,t),g=d.x1,b=d.y1,_=d.w,S=d.h,T,w,A,R,E;if(v!==0){var I=r.getRotationPoint(t);A=I.x,R=I.y,n.translate(A,R),n.rotate(v),E=l.getImgSmoothing(n),E||l.setImgSmoothing(n,!0);var L=r.getRotationOffset(t);T=L.x,w=L.y}else T=g,w=b;var F;h!==1&&(F=n.globalAlpha,n.globalAlpha=F*h),n.drawImage(f.texture.canvas,f.x,0,f.width,f.height,T,w,_,S),h!==1&&(n.globalAlpha=F),v!==0&&(n.rotate(-v),n.translate(-A,-R),E||l.setImgSmoothing(n,!1))}else r.drawElement(n,t)}};var getZeroRotation=function(){return 0},getLabelRotation=function(t,r){return t.getTextAngle(r,null)},getSourceLabelRotation=function(t,r){return t.getTextAngle(r,"source")},getTargetLabelRotation=function(t,r){return t.getTextAngle(r,"target")},getOpacity=function(t,r){return r.effectiveOpacity()},getTextOpacity=function(t,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};CRp$a.drawCachedElement=function(n,t,r,a,o,u){var s=this,c=s.data,l=c.eleTxrCache,d=c.lblTxrCache,f=c.slbTxrCache,h=c.tlbTxrCache,v=t.boundingBox(),g=u===!0?l.reasons.highQuality:null;if(!(v.w===0||v.h===0||!t.visible())&&(!a||boundingBoxesIntersect(v,a))){var b=t.isEdge(),_=t.element()._private.rscratch.badLine;s.drawElementUnderlay(n,t),s.drawCachedElementPortion(n,t,l,r,o,g,getZeroRotation,getOpacity),(!b||!_)&&s.drawCachedElementPortion(n,t,d,r,o,g,getLabelRotation,getTextOpacity),b&&!_&&(s.drawCachedElementPortion(n,t,f,r,o,g,getSourceLabelRotation,getTextOpacity),s.drawCachedElementPortion(n,t,h,r,o,g,getTargetLabelRotation,getTextOpacity)),s.drawElementOverlay(n,t)}};CRp$a.drawElements=function(n,t){for(var r=this,a=0;a<t.length;a++){var o=t[a];r.drawElement(n,o)}};CRp$a.drawCachedElements=function(n,t,r,a){for(var o=this,u=0;u<t.length;u++){var s=t[u];o.drawCachedElement(n,s,r,a)}};CRp$a.drawCachedNodes=function(n,t,r,a){for(var o=this,u=0;u<t.length;u++){var s=t[u];s.isNode()&&o.drawCachedElement(n,s,r,a)}};CRp$a.drawLayeredElements=function(n,t,r,a){var o=this,u=o.data.lyrTxrCache.getLayers(t,r);if(u)for(var s=0;s<u.length;s++){var c=u[s],l=c.bb;l.w===0||l.h===0||n.drawImage(c.canvas,l.x1,l.y1,l.w,l.h)}else o.drawCachedElements(n,t,r,a)};var CRp$9={};CRp$9.drawEdge=function(n,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,c=t._private.rscratch;if(!(u&&!t.visible())&&!(c.badLine||c.allpts==null||isNaN(c.allpts[0]))){var l;r&&(l=r,n.translate(-l.x1,-l.y1));var d=u?t.pstyle("opacity").value:1,f=u?t.pstyle("line-opacity").value:1,h=t.pstyle("curve-style").value,v=t.pstyle("line-style").value,g=t.pstyle("width").pfValue,b=t.pstyle("line-cap").value,_=t.pstyle("line-outline-width").value,S=t.pstyle("line-outline-color").value,T=d*f,w=d*f,A=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;h==="straight-triangle"?(s.eleStrokeStyle(n,t,M),s.drawEdgeTrianglePath(t,n,c.allpts)):(n.lineWidth=g,n.lineCap=b,s.eleStrokeStyle(n,t,M),s.drawEdgePath(t,n,c.allpts,v),n.lineCap="butt")},R=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;if(n.lineWidth=g+_,n.lineCap=b,_>0)s.colorStrokeStyle(n,S[0],S[1],S[2],M);else{n.lineCap="butt";return}h==="straight-triangle"?s.drawEdgeTrianglePath(t,n,c.allpts):(s.drawEdgePath(t,n,c.allpts,v),n.lineCap="butt")},E=function(){o&&s.drawEdgeOverlay(n,t)},I=function(){o&&s.drawEdgeUnderlay(n,t)},L=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w;s.drawArrowheads(n,t,M)},F=function(){s.drawElementText(n,t,null,a)};n.lineJoin="round";var D=t.pstyle("ghost").value==="yes";if(D){var $=t.pstyle("ghost-offset-x").pfValue,O=t.pstyle("ghost-offset-y").pfValue,P=t.pstyle("ghost-opacity").value,C=T*P;n.translate($,O),A(C),L(C),n.translate(-$,-O)}else R();I(),A(),L(),E(),F(),r&&n.translate(l.x1,l.y1)}};var drawEdgeOverlayUnderlay=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(r,a){if(a.visible()){var o=a.pstyle("".concat(t,"-opacity")).value;if(o!==0){var u=this,s=u.usePaths(),c=a._private.rscratch,l=a.pstyle("".concat(t,"-padding")).pfValue,d=2*l,f=a.pstyle("".concat(t,"-color")).value;r.lineWidth=d,c.edgeType==="self"&&!s?r.lineCap="butt":r.lineCap="round",u.colorStrokeStyle(r,f[0],f[1],f[2],o),u.drawEdgePath(a,r,c.allpts,"solid")}}}};CRp$9.drawEdgeOverlay=drawEdgeOverlayUnderlay("overlay");CRp$9.drawEdgeUnderlay=drawEdgeOverlayUnderlay("underlay");CRp$9.drawEdgePath=function(n,t,r,a){var o=n._private.rscratch,u=t,s,c=!1,l=this.usePaths(),d=n.pstyle("line-dash-pattern").pfValue,f=n.pstyle("line-dash-offset").pfValue;if(l){var h=r.join("$"),v=o.pathCacheKey&&o.pathCacheKey===h;v?(s=t=o.pathCache,c=!0):(s=t=new Path2D,o.pathCacheKey=h,o.pathCache=s)}if(u.setLineDash)switch(a){case"dotted":u.setLineDash([1,1]);break;case"dashed":u.setLineDash(d),u.lineDashOffset=f;break;case"solid":u.setLineDash([]);break}if(!c&&!o.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(r[0],r[1]),o.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var g=2;g+3<r.length;g+=4)t.quadraticCurveTo(r[g],r[g+1],r[g+2],r[g+3]);break;case"straight":case"haystack":for(var b=2;b+1<r.length;b+=2)t.lineTo(r[b],r[b+1]);break;case"segments":if(o.isRound){var _=_createForOfIteratorHelper(o.roundCorners),S;try{for(_.s();!(S=_.n()).done;){var T=S.value;drawPreparedRoundCorner(t,T)}}catch(A){_.e(A)}finally{_.f()}t.lineTo(r[r.length-2],r[r.length-1])}else for(var w=2;w+1<r.length;w+=2)t.lineTo(r[w],r[w+1]);break}t=u,l?t.stroke(s):t.stroke(),t.setLineDash&&t.setLineDash([])};CRp$9.drawEdgeTrianglePath=function(n,t,r){t.fillStyle=t.strokeStyle;for(var a=n.pstyle("width").pfValue,o=0;o+1<r.length;o+=2){var u=[r[o+2]-r[o],r[o+3]-r[o+1]],s=Math.sqrt(u[0]*u[0]+u[1]*u[1]),c=[u[1]/s,-u[0]/s],l=[c[0]*a/2,c[1]*a/2];t.beginPath(),t.moveTo(r[o]-l[0],r[o+1]-l[1]),t.lineTo(r[o]+l[0],r[o+1]+l[1]),t.lineTo(r[o+2],r[o+3]),t.closePath(),t.fill()}};CRp$9.drawArrowheads=function(n,t,r){var a=t._private.rscratch,o=a.edgeType==="haystack";o||this.drawArrowhead(n,t,"source",a.arrowStartX,a.arrowStartY,a.srcArrowAngle,r),this.drawArrowhead(n,t,"mid-target",a.midX,a.midY,a.midtgtArrowAngle,r),this.drawArrowhead(n,t,"mid-source",a.midX,a.midY,a.midsrcArrowAngle,r),o||this.drawArrowhead(n,t,"target",a.arrowEndX,a.arrowEndY,a.tgtArrowAngle,r)};CRp$9.drawArrowhead=function(n,t,r,a,o,u,s){if(!(isNaN(a)||a==null||isNaN(o)||o==null||isNaN(u)||u==null)){var c=this,l=t.pstyle(r+"-arrow-shape").value;if(l!=="none"){var d=t.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",f=t.pstyle(r+"-arrow-fill").value,h=t.pstyle("width").pfValue,v=t.pstyle(r+"-arrow-width"),g=v.value==="match-line"?h:v.pfValue;v.units==="%"&&(g*=h);var b=t.pstyle("opacity").value;s===void 0&&(s=b);var _=n.globalCompositeOperation;(s!==1||f==="hollow")&&(n.globalCompositeOperation="destination-out",c.colorFillStyle(n,255,255,255,1),c.colorStrokeStyle(n,255,255,255,1),c.drawArrowShape(t,n,d,h,l,g,a,o,u),n.globalCompositeOperation=_);var S=t.pstyle(r+"-arrow-color").value;c.colorFillStyle(n,S[0],S[1],S[2],s),c.colorStrokeStyle(n,S[0],S[1],S[2],s),c.drawArrowShape(t,n,f,h,l,g,a,o,u)}}};CRp$9.drawArrowShape=function(n,t,r,a,o,u,s,c,l){var d=this,f=this.usePaths()&&o!=="triangle-cross",h=!1,v,g=t,b={x:s,y:c},_=n.pstyle("arrow-scale").value,S=this.getArrowWidth(a,_),T=d.arrowShapes[o];if(f){var w=d.arrowPathCache=d.arrowPathCache||[],A=hashString(o),R=w[A];R!=null?(v=t=R,h=!0):(v=t=new Path2D,w[A]=v)}h||(t.beginPath&&t.beginPath(),f?T.draw(t,1,0,{x:0,y:0},1):T.draw(t,S,l,b,a),t.closePath&&t.closePath()),t=g,f&&(t.translate(s,c),t.rotate(l),t.scale(S,S)),(r==="filled"||r==="both")&&(f?t.fill(v):t.fill()),(r==="hollow"||r==="both")&&(t.lineWidth=u/(f?S:1),t.lineJoin="miter",f?t.stroke(v):t.stroke()),f&&(t.scale(1/S,1/S),t.rotate(-l),t.translate(-s,-c))};var CRp$8={};CRp$8.safeDrawImage=function(n,t,r,a,o,u,s,c,l,d){if(!(o<=0||u<=0||l<=0||d<=0))try{n.drawImage(t,r,a,o,u,s,c,l,d)}catch(f){warn(f)}};CRp$8.drawInscribedImage=function(n,t,r,a,o){var u=this,s=r.position(),c=s.x,l=s.y,d=r.cy().style(),f=d.getIndexedStyle.bind(d),h=f(r,"background-fit","value",a),v=f(r,"background-repeat","value",a),g=r.width(),b=r.height(),_=r.padding()*2,S=g+(f(r,"background-width-relative-to","value",a)==="inner"?0:_),T=b+(f(r,"background-height-relative-to","value",a)==="inner"?0:_),w=r._private.rscratch,A=f(r,"background-clip","value",a),R=A==="node",E=f(r,"background-image-opacity","value",a)*o,I=f(r,"background-image-smoothing","value",a),L=r.pstyle("corner-radius").value;L!=="auto"&&(L=r.pstyle("corner-radius").pfValue);var F=t.width||t.cachedW,D=t.height||t.cachedH;(F==null||D==null)&&(document.body.appendChild(t),F=t.cachedW=t.width||t.offsetWidth,D=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var $=F,O=D;if(f(r,"background-width","value",a)!=="auto"&&(f(r,"background-width","units",a)==="%"?$=f(r,"background-width","pfValue",a)*S:$=f(r,"background-width","pfValue",a)),f(r,"background-height","value",a)!=="auto"&&(f(r,"background-height","units",a)==="%"?O=f(r,"background-height","pfValue",a)*T:O=f(r,"background-height","pfValue",a)),!($===0||O===0)){if(h==="contain"){var P=Math.min(S/$,T/O);$*=P,O*=P}else if(h==="cover"){var P=Math.max(S/$,T/O);$*=P,O*=P}var C=c-S/2,q=f(r,"background-position-x","units",a),M=f(r,"background-position-x","pfValue",a);q==="%"?C+=(S-$)*M:C+=M;var N=f(r,"background-offset-x","units",a),G=f(r,"background-offset-x","pfValue",a);N==="%"?C+=(S-$)*G:C+=G;var X=l-T/2,Y=f(r,"background-position-y","units",a),W=f(r,"background-position-y","pfValue",a);Y==="%"?X+=(T-O)*W:X+=W;var te=f(r,"background-offset-y","units",a),ue=f(r,"background-offset-y","pfValue",a);te==="%"?X+=(T-O)*ue:X+=ue,w.pathCache&&(C-=c,X-=l,c=0,l=0);var fe=n.globalAlpha;n.globalAlpha=E;var re=u.getImgSmoothing(n),ye=!1;if(I==="no"&&re?(u.setImgSmoothing(n,!1),ye=!0):I==="yes"&&!re&&(u.setImgSmoothing(n,!0),ye=!0),v==="no-repeat")R&&(n.save(),w.pathCache?n.clip(w.pathCache):(u.nodeShapes[u.getNodeShape(r)].draw(n,c,l,S,T,L,w),n.clip())),u.safeDrawImage(n,t,0,0,F,D,C,X,$,O),R&&n.restore();else{var Te=n.createPattern(t,v);n.fillStyle=Te,u.nodeShapes[u.getNodeShape(r)].draw(n,c,l,S,T,L,w),n.translate(C,X),n.fill(),n.translate(-C,-X)}n.globalAlpha=fe,ye&&u.setImgSmoothing(n,re)}};var CRp$7={};CRp$7.eleTextBiggerThanMin=function(n,t){if(!t){var r=n.cy().zoom(),a=this.getPixelRatio(),o=Math.ceil(log2(r*a));t=Math.pow(2,o)}var u=n.pstyle("font-size").pfValue*t,s=n.pstyle("min-zoomed-font-size").pfValue;return!(u<s)};CRp$7.drawElementText=function(n,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(a==null){if(u&&!s.eleTextBiggerThanMin(t))return}else if(a===!1)return;if(t.isNode()){var c=t.pstyle("label");if(!c||!c.value)return;var l=s.getLabelJustification(t);n.textAlign=l,n.textBaseline="bottom"}else{var d=t.element()._private.rscratch.badLine,f=t.pstyle("label"),h=t.pstyle("source-label"),v=t.pstyle("target-label");if(d||(!f||!f.value)&&(!h||!h.value)&&(!v||!v.value))return;n.textAlign="center",n.textBaseline="bottom"}var g=!r,b;r&&(b=r,n.translate(-b.x1,-b.y1)),o==null?(s.drawText(n,t,null,g,u),t.isEdge()&&(s.drawText(n,t,"source",g,u),s.drawText(n,t,"target",g,u))):s.drawText(n,t,o,g,u),r&&n.translate(b.x1,b.y1)};CRp$7.getFontCache=function(n){var t;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(t=this.fontCaches[r],t.context===n)return t;return t={context:n},this.fontCaches.push(t),t};CRp$7.setupTextStyle=function(n,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=t.pstyle("font-style").strValue,o=t.pstyle("font-size").pfValue+"px",u=t.pstyle("font-family").strValue,s=t.pstyle("font-weight").strValue,c=r?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*c,d=t.pstyle("color").value,f=t.pstyle("text-outline-color").value;n.font=a+" "+s+" "+o+" "+u,n.lineJoin="round",this.colorFillStyle(n,d[0],d[1],d[2],c),this.colorStrokeStyle(n,f[0],f[1],f[2],l)};function roundRect(n,t,r,a,o){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=arguments.length>6?arguments[6]:void 0;n.beginPath(),n.moveTo(t+u,r),n.lineTo(t+a-u,r),n.quadraticCurveTo(t+a,r,t+a,r+u),n.lineTo(t+a,r+o-u),n.quadraticCurveTo(t+a,r+o,t+a-u,r+o),n.lineTo(t+u,r+o),n.quadraticCurveTo(t,r+o,t,r+o-u),n.lineTo(t,r+u),n.quadraticCurveTo(t,r,t+u,r),n.closePath(),s?n.stroke():n.fill()}CRp$7.getTextAngle=function(n,t){var r,a=n._private,o=a.rscratch,u=t?t+"-":"",s=n.pstyle(u+"text-rotation");if(s.strValue==="autorotate"){var c=getPrefixedProperty(o,"labelAngle",t);r=n.isEdge()?c:0}else s.strValue==="none"?r=0:r=s.pfValue;return r};CRp$7.drawText=function(n,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=t._private,s=u.rscratch,c=o?t.effectiveOpacity():1;if(!(o&&(c===0||t.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var l=getPrefixedProperty(s,"labelX",r),d=getPrefixedProperty(s,"labelY",r),f,h,v=this.getLabelText(t,r);if(v!=null&&v!==""&&!isNaN(l)&&!isNaN(d)){this.setupTextStyle(n,t,o);var g=r?r+"-":"",b=getPrefixedProperty(s,"labelWidth",r),_=getPrefixedProperty(s,"labelHeight",r),S=t.pstyle(g+"text-margin-x").pfValue,T=t.pstyle(g+"text-margin-y").pfValue,w=t.isEdge(),A=t.pstyle("text-halign").value,R=t.pstyle("text-valign").value;w&&(A="center",R="center"),l+=S,d+=T;var E;switch(a?E=this.getTextAngle(t,r):E=0,E!==0&&(f=l,h=d,n.translate(f,h),n.rotate(E),l=0,d=0),R){case"top":break;case"center":d+=_/2;break;case"bottom":d+=_;break}var I=t.pstyle("text-background-opacity").value,L=t.pstyle("text-border-opacity").value,F=t.pstyle("text-border-width").pfValue,D=t.pstyle("text-background-padding").pfValue,$=t.pstyle("text-background-shape").strValue,O=$.indexOf("round")===0,P=2;if(I>0||F>0&&L>0){var C=l-D;switch(A){case"left":C-=b;break;case"center":C-=b/2;break}var q=d-_-D,M=b+2*D,N=_+2*D;if(I>0){var G=n.fillStyle,X=t.pstyle("text-background-color").value;n.fillStyle="rgba("+X[0]+","+X[1]+","+X[2]+","+I*c+")",O?roundRect(n,C,q,M,N,P):n.fillRect(C,q,M,N),n.fillStyle=G}if(F>0&&L>0){var Y=n.strokeStyle,W=n.lineWidth,te=t.pstyle("text-border-color").value,ue=t.pstyle("text-border-style").value;if(n.strokeStyle="rgba("+te[0]+","+te[1]+","+te[2]+","+L*c+")",n.lineWidth=F,n.setLineDash)switch(ue){case"dotted":n.setLineDash([1,1]);break;case"dashed":n.setLineDash([4,2]);break;case"double":n.lineWidth=F/4,n.setLineDash([]);break;case"solid":n.setLineDash([]);break}if(O?roundRect(n,C,q,M,N,P,"stroke"):n.strokeRect(C,q,M,N),ue==="double"){var fe=F/2;O?roundRect(n,C+fe,q+fe,M-fe*2,N-fe*2,P,"stroke"):n.strokeRect(C+fe,q+fe,M-fe*2,N-fe*2)}n.setLineDash&&n.setLineDash([]),n.lineWidth=W,n.strokeStyle=Y}}var re=2*t.pstyle("text-outline-width").pfValue;if(re>0&&(n.lineWidth=re),t.pstyle("text-wrap").value==="wrap"){var ye=getPrefixedProperty(s,"labelWrapCachedLines",r),Te=getPrefixedProperty(s,"labelLineHeight",r),Re=b/2,ve=this.getLabelJustification(t);switch(ve==="auto"||(A==="left"?ve==="left"?l+=-b:ve==="center"&&(l+=-Re):A==="center"?ve==="left"?l+=-Re:ve==="right"&&(l+=Re):A==="right"&&(ve==="center"?l+=Re:ve==="right"&&(l+=b))),R){case"top":d-=(ye.length-1)*Te;break;case"center":case"bottom":d-=(ye.length-1)*Te;break}for(var ce=0;ce<ye.length;ce++)re>0&&n.strokeText(ye[ce],l,d),n.fillText(ye[ce],l,d),d+=Te}else re>0&&n.strokeText(v,l,d),n.fillText(v,l,d);E!==0&&(n.rotate(-E),n.translate(-f,-h))}}};var CRp$6={};CRp$6.drawNode=function(n,t,r){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,c,l,d=t._private,f=d.rscratch,h=t.position();if(!(!number$1(h.x)||!number$1(h.y))&&!(u&&!t.visible())){var v=u?t.effectiveOpacity():1,g=s.usePaths(),b,_=!1,S=t.padding();c=t.width()+2*S,l=t.height()+2*S;var T;r&&(T=r,n.translate(-T.x1,-T.y1));for(var w=t.pstyle("background-image"),A=w.value,R=new Array(A.length),E=new Array(A.length),I=0,L=0;L<A.length;L++){var F=A[L],D=R[L]=F!=null&&F!=="none";if(D){var $=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",L);I++,E[L]=s.getCachedImage(F,$,function(){d.backgroundTimestamp=Date.now(),t.emitAndNotify("background")})}}var O=t.pstyle("background-blacken").value,P=t.pstyle("border-width").pfValue,C=t.pstyle("background-opacity").value*v,q=t.pstyle("border-color").value,M=t.pstyle("border-style").value,N=t.pstyle("border-join").value,G=t.pstyle("border-cap").value,X=t.pstyle("border-position").value,Y=t.pstyle("border-dash-pattern").pfValue,W=t.pstyle("border-dash-offset").pfValue,te=t.pstyle("border-opacity").value*v,ue=t.pstyle("outline-width").pfValue,fe=t.pstyle("outline-color").value,re=t.pstyle("outline-style").value,ye=t.pstyle("outline-opacity").value*v,Te=t.pstyle("outline-offset").value,Re=t.pstyle("corner-radius").value;Re!=="auto"&&(Re=t.pstyle("corner-radius").pfValue);var ve=function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C;s.eleFillStyle(n,t,ee)},ce=function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:te;s.colorStrokeStyle(n,q[0],q[1],q[2],ee)},J=function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ye;s.colorStrokeStyle(n,fe[0],fe[1],fe[2],ee)},j=function(ee,ae,be,le){var we=s.nodePathCache=s.nodePathCache||[],De=hashStrings(be==="polygon"?be+","+le.join(","):be,""+ae,""+ee,""+Re),Fe=we[De],Ne,de=!1;return Fe!=null?(Ne=Fe,de=!0,f.pathCache=Ne):(Ne=new Path2D,we[De]=f.pathCache=Ne),{path:Ne,cacheHit:de}},z=t.pstyle("shape").strValue,B=t.pstyle("shape-polygon-points").pfValue;if(g){n.translate(h.x,h.y);var U=j(c,l,z,B);b=U.path,_=U.cacheHit}var Z=function(){if(!_){var ee=h;g&&(ee={x:0,y:0}),s.nodeShapes[s.getNodeShape(t)].draw(b||n,ee.x,ee.y,c,l,Re,f)}g?n.fill(b):n.fill()},oe=function(){for(var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,be=d.backgrounding,le=0,we=0;we<E.length;we++){var De=t.cy().style().getIndexedStyle(t,"background-image-containment","value",we);if(ae&&De==="over"||!ae&&De==="inside"){le++;continue}R[we]&&E[we].complete&&!E[we].error&&(le++,s.drawInscribedImage(n,E[we],t,we,ee))}d.backgrounding=le!==I,be!==d.backgrounding&&t.updateStyle(!1)},ie=function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;s.hasPie(t)&&(s.drawPie(n,t,ae),ee&&(g||s.nodeShapes[s.getNodeShape(t)].draw(n,h.x,h.y,c,l,Re,f)))},se=function(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,ae=(O>0?O:-O)*ee,be=O>0?0:255;O!==0&&(s.colorFillStyle(n,be,be,be,ae),g?n.fill(b):n.fill())},ne=function(){if(P>0){if(n.lineWidth=P,n.lineCap=G,n.lineJoin=N,n.setLineDash)switch(M){case"dotted":n.setLineDash([1,1]);break;case"dashed":n.setLineDash(Y),n.lineDashOffset=W;break;case"solid":case"double":n.setLineDash([]);break}if(X!=="center"){if(n.save(),n.lineWidth*=2,X==="inside")g?n.clip(b):n.clip();else{var ee=new Path2D;ee.rect(-c/2-P,-l/2-P,c+2*P,l+2*P),ee.addPath(b),n.clip(ee,"evenodd")}g?n.stroke(b):n.stroke(),n.restore()}else g?n.stroke(b):n.stroke();if(M==="double"){n.lineWidth=P/3;var ae=n.globalCompositeOperation;n.globalCompositeOperation="destination-out",g?n.stroke(b):n.stroke(),n.globalCompositeOperation=ae}n.setLineDash&&n.setLineDash([])}},he=function(){if(ue>0){if(n.lineWidth=ue,n.lineCap="butt",n.setLineDash)switch(re){case"dotted":n.setLineDash([1,1]);break;case"dashed":n.setLineDash([4,2]);break;case"solid":case"double":n.setLineDash([]);break}var ee=h;g&&(ee={x:0,y:0});var ae=s.getNodeShape(t),be=P;X==="inside"&&(be=0),X==="outside"&&(be*=2);var le=(c+be+(ue+Te))/c,we=(l+be+(ue+Te))/l,De=c*le,Fe=l*we,Ne=s.nodeShapes[ae].points,de;if(g){var Le=j(De,Fe,ae,Ne);de=Le.path}if(ae==="ellipse")s.drawEllipsePath(de||n,ee.x,ee.y,De,Fe);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(ae)){var $e=0,je=0,Me=0;ae==="round-diamond"?$e=(be+Te+ue)*1.4:ae==="round-heptagon"?($e=(be+Te+ue)*1.075,Me=-(be/2+Te+ue)/35):ae==="round-hexagon"?$e=(be+Te+ue)*1.12:ae==="round-pentagon"?($e=(be+Te+ue)*1.13,Me=-(be/2+Te+ue)/15):ae==="round-tag"?($e=(be+Te+ue)*1.12,je=(be/2+ue+Te)*.07):ae==="round-triangle"&&($e=(be+Te+ue)*(Math.PI/2),Me=-(be+Te/2+ue)/Math.PI),$e!==0&&(le=(c+$e)/c,De=c*le,["round-hexagon","round-tag"].includes(ae)||(we=(l+$e)/l,Fe=l*we)),Re=Re==="auto"?getRoundPolygonRadius(De,Fe):Re;for(var ze=De/2,Je=Fe/2,Ke=Re+(be+ue+Te)/2,ot=new Array(Ne.length/2),_e=new Array(Ne.length/2),Ae=0;Ae<Ne.length/2;Ae++)ot[Ae]={x:ee.x+je+ze*Ne[Ae*2],y:ee.y+Me+Je*Ne[Ae*2+1]};var Ve,Ue,We,pt,Ge=ot.length;for(Ue=ot[Ge-1],Ve=0;Ve<Ge;Ve++)We=ot[Ve%Ge],pt=ot[(Ve+1)%Ge],_e[Ve]=getRoundCorner(Ue,We,pt,Ke),Ue=We,We=pt;s.drawRoundPolygonPath(de||n,ee.x+je,ee.y+Me,c*le,l*we,Ne,_e)}else if(["roundrectangle","round-rectangle"].includes(ae))Re=Re==="auto"?getRoundRectangleRadius(De,Fe):Re,s.drawRoundRectanglePath(de||n,ee.x,ee.y,De,Fe,Re+(be+ue+Te)/2);else if(["cutrectangle","cut-rectangle"].includes(ae))Re=Re==="auto"?getCutRectangleCornerLength():Re,s.drawCutRectanglePath(de||n,ee.x,ee.y,De,Fe,null,Re+(be+ue+Te)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(ae))Re=Re==="auto"?getRoundRectangleRadius(De,Fe):Re,s.drawBottomRoundRectanglePath(de||n,ee.x,ee.y,De,Fe,Re+(be+ue+Te)/2);else if(ae==="barrel")s.drawBarrelPath(de||n,ee.x,ee.y,De,Fe);else if(ae.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(ae)){var ct=(be+ue+Te)/c;Ne=joinLines(expandPolygon(Ne,ct)),s.drawPolygonPath(de||n,ee.x,ee.y,c,l,Ne)}else{var Xe=(be+ue+Te)/c;Ne=joinLines(expandPolygon(Ne,-Xe)),s.drawPolygonPath(de||n,ee.x,ee.y,c,l,Ne)}if(g?n.stroke(de):n.stroke(),re==="double"){n.lineWidth=be/3;var Ye=n.globalCompositeOperation;n.globalCompositeOperation="destination-out",g?n.stroke(de):n.stroke(),n.globalCompositeOperation=Ye}n.setLineDash&&n.setLineDash([])}},xe=function(){o&&s.drawNodeOverlay(n,t,h,c,l)},me=function(){o&&s.drawNodeUnderlay(n,t,h,c,l)},Ie=function(){s.drawElementText(n,t,null,a)},Pe=t.pstyle("ghost").value==="yes";if(Pe){var Ce=t.pstyle("ghost-offset-x").pfValue,pe=t.pstyle("ghost-offset-y").pfValue,H=t.pstyle("ghost-opacity").value,V=H*v;n.translate(Ce,pe),J(),he(),ve(H*C),Z(),oe(V,!0),ce(H*te),ne(),ie(O!==0||P!==0),oe(V,!1),se(V),n.translate(-Ce,-pe)}g&&n.translate(-h.x,-h.y),me(),g&&n.translate(h.x,h.y),J(),he(),ve(),Z(),oe(v,!0),ce(),ne(),ie(O!==0||P!==0),oe(v,!1),se(),g&&n.translate(-h.x,-h.y),Ie(),xe(),r&&n.translate(T.x1,T.y1)}};var drawNodeOverlayUnderlay=function(t){if(!["overlay","underlay"].includes(t))throw new Error("Invalid state");return function(r,a,o,u,s){var c=this;if(a.visible()){var l=a.pstyle("".concat(t,"-padding")).pfValue,d=a.pstyle("".concat(t,"-opacity")).value,f=a.pstyle("".concat(t,"-color")).value,h=a.pstyle("".concat(t,"-shape")).value,v=a.pstyle("".concat(t,"-corner-radius")).value;if(d>0){if(o=o||a.position(),u==null||s==null){var g=a.padding();u=a.width()+2*g,s=a.height()+2*g}c.colorFillStyle(r,f[0],f[1],f[2],d),c.nodeShapes[h].draw(r,o.x,o.y,u+l*2,s+l*2,v),r.fill()}}}};CRp$6.drawNodeOverlay=drawNodeOverlayUnderlay("overlay");CRp$6.drawNodeUnderlay=drawNodeOverlayUnderlay("underlay");CRp$6.hasPie=function(n){return n=n[0],n._private.hasPie};CRp$6.drawPie=function(n,t,r,a){t=t[0],a=a||t.position();var o=t.cy().style(),u=t.pstyle("pie-size"),s=a.x,c=a.y,l=t.width(),d=t.height(),f=Math.min(l,d)/2,h=0,v=this.usePaths();v&&(s=0,c=0),u.units==="%"?f=f*u.pfValue:u.pfValue!==void 0&&(f=u.pfValue/2);for(var g=1;g<=o.pieBackgroundN;g++){var b=t.pstyle("pie-"+g+"-background-size").value,_=t.pstyle("pie-"+g+"-background-color").value,S=t.pstyle("pie-"+g+"-background-opacity").value*r,T=b/100;T+h>1&&(T=1-h);var w=1.5*Math.PI+2*Math.PI*h,A=2*Math.PI*T,R=w+A;b===0||h>=1||h+T>1||(n.beginPath(),n.moveTo(s,c),n.arc(s,c,f,w,R),n.closePath(),this.colorFillStyle(n,_[0],_[1],_[2],S),n.fill(),h+=T)}};var CRp$5={},motionBlurDelay=100;CRp$5.getPixelRatio=function(){var n=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var t=this.cy.window(),r=n.backingStorePixelRatio||n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;return(t.devicePixelRatio||1)/r};CRp$5.paintCache=function(n){for(var t=this.paintCaches=this.paintCaches||[],r=!0,a,o=0;o<t.length;o++)if(a=t[o],a.context===n){r=!1;break}return r&&(a={context:n},t.push(a)),a};CRp$5.createGradientStyleFor=function(n,t,r,a,o){var u,s=this.usePaths(),c=r.pstyle(t+"-gradient-stop-colors").value,l=r.pstyle(t+"-gradient-stop-positions").pfValue;if(a==="radial-gradient")if(r.isEdge()){var d=r.sourceEndpoint(),f=r.targetEndpoint(),h=r.midpoint(),v=dist$1(d,h),g=dist$1(f,h);u=n.createRadialGradient(h.x,h.y,0,h.x,h.y,Math.max(v,g))}else{var b=s?{x:0,y:0}:r.position(),_=r.paddedWidth(),S=r.paddedHeight();u=n.createRadialGradient(b.x,b.y,0,b.x,b.y,Math.max(_,S))}else if(r.isEdge()){var T=r.sourceEndpoint(),w=r.targetEndpoint();u=n.createLinearGradient(T.x,T.y,w.x,w.y)}else{var A=s?{x:0,y:0}:r.position(),R=r.paddedWidth(),E=r.paddedHeight(),I=R/2,L=E/2,F=r.pstyle("background-gradient-direction").value;switch(F){case"to-bottom":u=n.createLinearGradient(A.x,A.y-L,A.x,A.y+L);break;case"to-top":u=n.createLinearGradient(A.x,A.y+L,A.x,A.y-L);break;case"to-left":u=n.createLinearGradient(A.x+I,A.y,A.x-I,A.y);break;case"to-right":u=n.createLinearGradient(A.x-I,A.y,A.x+I,A.y);break;case"to-bottom-right":case"to-right-bottom":u=n.createLinearGradient(A.x-I,A.y-L,A.x+I,A.y+L);break;case"to-top-right":case"to-right-top":u=n.createLinearGradient(A.x-I,A.y+L,A.x+I,A.y-L);break;case"to-bottom-left":case"to-left-bottom":u=n.createLinearGradient(A.x+I,A.y-L,A.x-I,A.y+L);break;case"to-top-left":case"to-left-top":u=n.createLinearGradient(A.x+I,A.y+L,A.x-I,A.y-L);break}}if(!u)return null;for(var D=l.length===c.length,$=c.length,O=0;O<$;O++)u.addColorStop(D?l[O]:O/($-1),"rgba("+c[O][0]+","+c[O][1]+","+c[O][2]+","+o+")");return u};CRp$5.gradientFillStyle=function(n,t,r,a){var o=this.createGradientStyleFor(n,"background",t,r,a);if(!o)return null;n.fillStyle=o};CRp$5.colorFillStyle=function(n,t,r,a,o){n.fillStyle="rgba("+t+","+r+","+a+","+o+")"};CRp$5.eleFillStyle=function(n,t,r){var a=t.pstyle("background-fill").value;if(a==="linear-gradient"||a==="radial-gradient")this.gradientFillStyle(n,t,a,r);else{var o=t.pstyle("background-color").value;this.colorFillStyle(n,o[0],o[1],o[2],r)}};CRp$5.gradientStrokeStyle=function(n,t,r,a){var o=this.createGradientStyleFor(n,"line",t,r,a);if(!o)return null;n.strokeStyle=o};CRp$5.colorStrokeStyle=function(n,t,r,a,o){n.strokeStyle="rgba("+t+","+r+","+a+","+o+")"};CRp$5.eleStrokeStyle=function(n,t,r){var a=t.pstyle("line-fill").value;if(a==="linear-gradient"||a==="radial-gradient")this.gradientStrokeStyle(n,t,a,r);else{var o=t.pstyle("line-color").value;this.colorStrokeStyle(n,o[0],o[1],o[2],r)}};CRp$5.matchCanvasSize=function(n){var t=this,r=t.data,a=t.findContainerClientCoords(),o=a[2],u=a[3],s=t.getPixelRatio(),c=t.motionBlurPxRatio;(n===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]||n===t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG])&&(s=c);var l=o*s,d=u*s,f;if(!(l===t.canvasWidth&&d===t.canvasHeight)){t.fontCaches=null;var h=r.canvasContainer;h.style.width=o+"px",h.style.height=u+"px";for(var v=0;v<t.CANVAS_LAYERS;v++)f=r.canvases[v],f.width=l,f.height=d,f.style.width=o+"px",f.style.height=u+"px";for(var v=0;v<t.BUFFER_COUNT;v++)f=r.bufferCanvases[v],f.width=l,f.height=d,f.style.width=o+"px",f.style.height=u+"px";t.textureMult=1,s<=1&&(f=r.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,f.width=l*t.textureMult,f.height=d*t.textureMult),t.canvasWidth=l,t.canvasHeight=d,t.pixelRatio=s}};CRp$5.renderTo=function(n,t,r,a){this.render({forcedContext:n,forcedZoom:t,forcedPan:r,drawAllLayers:!0,forcedPxRatio:a})};CRp$5.clearCanvas=function(){var n=this,t=n.data;function r(a){a.clearRect(0,0,n.canvasWidth,n.canvasHeight)}r(t.contexts[n.NODE]),r(t.contexts[n.DRAG])};CRp$5.render=function(n){var t=this;n=n||staticEmptyObject();var r=t.cy,a=n.forcedContext,o=n.drawAllLayers,u=n.drawOnlyNodeLayer,s=n.forcedZoom,c=n.forcedPan,l=n.forcedPxRatio===void 0?this.getPixelRatio():n.forcedPxRatio,d=t.data,f=d.canvasNeedsRedraw,h=t.textureOnViewport&&!a&&(t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming),v=n.motionBlur!==void 0?n.motionBlur:t.motionBlur,g=t.motionBlurPxRatio,b=r.hasCompoundNodes(),_=t.hoverData.draggingEles,S=!!(t.hoverData.selecting||t.touchData.selecting);v=v&&!a&&t.motionBlurEnabled&&!S;var T=v;a||(t.prevPxRatio!==l&&(t.invalidateContainerClientCoordsCache(),t.matchCanvasSize(t.container),t.redrawHint("eles",!0),t.redrawHint("drag",!0)),t.prevPxRatio=l),!a&&t.motionBlurTimeout&&clearTimeout(t.motionBlurTimeout),v&&(t.mbFrames==null&&(t.mbFrames=0),t.mbFrames++,t.mbFrames<3&&(T=!1),t.mbFrames>t.minMbLowQualFrames&&(t.motionBlurPxRatio=t.mbPxRBlurry)),t.clearingMotionBlur&&(t.motionBlurPxRatio=1),t.textureDrawLastFrame&&!h&&(f[t.NODE]=!0,f[t.SELECT_BOX]=!0);var w=r.style(),A=r.zoom(),R=s!==void 0?s:A,E=r.pan(),I={x:E.x,y:E.y},L={zoom:A,pan:{x:E.x,y:E.y}},F=t.prevViewport,D=F===void 0||L.zoom!==F.zoom||L.pan.x!==F.pan.x||L.pan.y!==F.pan.y;!D&&!(_&&!b)&&(t.motionBlurPxRatio=1),c&&(I=c),R*=l,I.x*=l,I.y*=l;var $=t.getCachedZSortedEles();function O(ce,J,j,z,B){var U=ce.globalCompositeOperation;ce.globalCompositeOperation="destination-out",t.colorFillStyle(ce,255,255,255,t.motionBlurTransparency),ce.fillRect(J,j,z,B),ce.globalCompositeOperation=U}function P(ce,J){var j,z,B,U;!t.clearingMotionBlur&&(ce===d.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]||ce===d.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG])?(j={x:E.x*g,y:E.y*g},z=A*g,B=t.canvasWidth*g,U=t.canvasHeight*g):(j=I,z=R,B=t.canvasWidth,U=t.canvasHeight),ce.setTransform(1,0,0,1,0,0),J==="motionBlur"?O(ce,0,0,B,U):!a&&(J===void 0||J)&&ce.clearRect(0,0,B,U),o||(ce.translate(j.x,j.y),ce.scale(z,z)),c&&ce.translate(c.x,c.y),s&&ce.scale(s,s)}if(h||(t.textureDrawLastFrame=!1),h){if(t.textureDrawLastFrame=!0,!t.textureCache){t.textureCache={},t.textureCache.bb=r.mutableElements().boundingBox(),t.textureCache.texture=t.data.bufferCanvases[t.TEXTURE_BUFFER];var C=t.data.bufferContexts[t.TEXTURE_BUFFER];C.setTransform(1,0,0,1,0,0),C.clearRect(0,0,t.canvasWidth*t.textureMult,t.canvasHeight*t.textureMult),t.render({forcedContext:C,drawOnlyNodeLayer:!0,forcedPxRatio:l*t.textureMult});var L=t.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:t.canvasWidth,height:t.canvasHeight};L.mpan={x:(0-L.pan.x)/L.zoom,y:(0-L.pan.y)/L.zoom}}f[t.DRAG]=!1,f[t.NODE]=!1;var q=d.contexts[t.NODE],M=t.textureCache.texture,L=t.textureCache.viewport;q.setTransform(1,0,0,1,0,0),v?O(q,0,0,L.width,L.height):q.clearRect(0,0,L.width,L.height);var N=w.core("outside-texture-bg-color").value,G=w.core("outside-texture-bg-opacity").value;t.colorFillStyle(q,N[0],N[1],N[2],G),q.fillRect(0,0,L.width,L.height);var A=r.zoom();P(q,!1),q.clearRect(L.mpan.x,L.mpan.y,L.width/L.zoom/l,L.height/L.zoom/l),q.drawImage(M,L.mpan.x,L.mpan.y,L.width/L.zoom/l,L.height/L.zoom/l)}else t.textureOnViewport&&!a&&(t.textureCache=null);var X=r.extent(),Y=t.pinching||t.hoverData.dragging||t.swipePanning||t.data.wheelZooming||t.hoverData.draggingEles||t.cy.animated(),W=t.hideEdgesOnViewport&&Y,te=[];if(te[t.NODE]=!f[t.NODE]&&v&&!t.clearedForMotionBlur[t.NODE]||t.clearingMotionBlur,te[t.NODE]&&(t.clearedForMotionBlur[t.NODE]=!0),te[t.DRAG]=!f[t.DRAG]&&v&&!t.clearedForMotionBlur[t.DRAG]||t.clearingMotionBlur,te[t.DRAG]&&(t.clearedForMotionBlur[t.DRAG]=!0),f[t.NODE]||o||u||te[t.NODE]){var ue=v&&!te[t.NODE]&&g!==1,q=a||(ue?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_NODE]:d.contexts[t.NODE]),fe=v&&!ue?"motionBlur":void 0;P(q,fe),W?t.drawCachedNodes(q,$.nondrag,l,X):t.drawLayeredElements(q,$.nondrag,l,X),t.debug&&t.drawDebugPoints(q,$.nondrag),!o&&!v&&(f[t.NODE]=!1)}if(!u&&(f[t.DRAG]||o||te[t.DRAG])){var ue=v&&!te[t.DRAG]&&g!==1,q=a||(ue?t.data.bufferContexts[t.MOTIONBLUR_BUFFER_DRAG]:d.contexts[t.DRAG]);P(q,v&&!ue?"motionBlur":void 0),W?t.drawCachedNodes(q,$.drag,l,X):t.drawCachedElements(q,$.drag,l,X),t.debug&&t.drawDebugPoints(q,$.drag),!o&&!v&&(f[t.DRAG]=!1)}if(this.drawSelectionRectangle(n,P),v&&g!==1){var re=d.contexts[t.NODE],ye=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE],Te=d.contexts[t.DRAG],Re=t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG],ve=function(J,j,z){J.setTransform(1,0,0,1,0,0),z||!T?J.clearRect(0,0,t.canvasWidth,t.canvasHeight):O(J,0,0,t.canvasWidth,t.canvasHeight);var B=g;J.drawImage(j,0,0,t.canvasWidth*B,t.canvasHeight*B,0,0,t.canvasWidth,t.canvasHeight)};(f[t.NODE]||te[t.NODE])&&(ve(re,ye,te[t.NODE]),f[t.NODE]=!1),(f[t.DRAG]||te[t.DRAG])&&(ve(Te,Re,te[t.DRAG]),f[t.DRAG]=!1)}t.prevViewport=L,t.clearingMotionBlur&&(t.clearingMotionBlur=!1,t.motionBlurCleared=!0,t.motionBlur=!0),v&&(t.motionBlurTimeout=setTimeout(function(){t.motionBlurTimeout=null,t.clearedForMotionBlur[t.NODE]=!1,t.clearedForMotionBlur[t.DRAG]=!1,t.motionBlur=!1,t.clearingMotionBlur=!h,t.mbFrames=0,f[t.NODE]=!0,f[t.DRAG]=!0,t.redraw()},motionBlurDelay)),a||r.emit("render")};var fpsHeight;CRp$5.drawSelectionRectangle=function(n,t){var r=this,a=r.cy,o=r.data,u=a.style(),s=n.drawOnlyNodeLayer,c=n.drawAllLayers,l=o.canvasNeedsRedraw,d=n.forcedContext;if(r.showFps||!s&&l[r.SELECT_BOX]&&!c){var f=d||o.contexts[r.SELECT_BOX];if(t(f),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var h=r.cy.zoom(),v=u.core("selection-box-border-width").value/h;f.lineWidth=v,f.fillStyle="rgba("+u.core("selection-box-color").value[0]+","+u.core("selection-box-color").value[1]+","+u.core("selection-box-color").value[2]+","+u.core("selection-box-opacity").value+")",f.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),v>0&&(f.strokeStyle="rgba("+u.core("selection-box-border-color").value[0]+","+u.core("selection-box-border-color").value[1]+","+u.core("selection-box-border-color").value[2]+","+u.core("selection-box-opacity").value+")",f.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(o.bgActivePosistion&&!r.hoverData.selecting){var h=r.cy.zoom(),g=o.bgActivePosistion;f.fillStyle="rgba("+u.core("active-bg-color").value[0]+","+u.core("active-bg-color").value[1]+","+u.core("active-bg-color").value[2]+","+u.core("active-bg-opacity").value+")",f.beginPath(),f.arc(g.x,g.y,u.core("active-bg-size").pfValue/h,0,2*Math.PI),f.fill()}var b=r.lastRedrawTime;if(r.showFps&&b){b=Math.round(b);var _=Math.round(1e3/b),S="1 frame = "+b+" ms = "+_+" fps";if(f.setTransform(1,0,0,1,0,0),f.fillStyle="rgba(255, 0, 0, 0.75)",f.strokeStyle="rgba(255, 0, 0, 0.75)",f.font="30px Arial",!fpsHeight){var T=f.measureText(S);fpsHeight=T.actualBoundingBoxAscent}f.fillText(S,0,fpsHeight);var w=60;f.strokeRect(0,fpsHeight+10,250,20),f.fillRect(0,fpsHeight+10,250*Math.min(_/w,1),20)}c||(l[r.SELECT_BOX]=!1)}};function compileShader(n,t,r){var a=n.createShader(t);if(n.shaderSource(a,r),n.compileShader(a),!n.getShaderParameter(a,n.COMPILE_STATUS))throw new Error(n.getShaderInfoLog(a));return a}function createProgram(n,t,r){var a=compileShader(n,n.VERTEX_SHADER,t),o=compileShader(n,n.FRAGMENT_SHADER,r),u=n.createProgram();if(n.attachShader(u,a),n.attachShader(u,o),n.linkProgram(u),!n.getProgramParameter(u,n.LINK_STATUS))throw new Error("Could not initialize shaders");return u}function createTextureCanvas(n,t,r){r===void 0&&(r=t);var a=n.makeOffscreenCanvas(t,r),o=a.context=a.getContext("2d");return a.clear=function(){return o.clearRect(0,0,a.width,a.height)},a.clear(),a}function getEffectivePanZoom(n){var t=n.pixelRatio,r=n.cy.zoom(),a=n.cy.pan();return{zoom:r*t,pan:{x:a.x*t,y:a.y*t}}}function modelToRenderedPosition(n,t,r,a,o){var u=a*r+t.x,s=o*r+t.y;return s=Math.round(n.canvasHeight-s),[u,s]}function toWebGLColor(n,t,r){var a=n[0]/255,o=n[1]/255,u=n[2]/255,s=t,c=r||new Array(4);return c[0]=a*s,c[1]=o*s,c[2]=u*s,c[3]=s,c}function indexToVec4(n,t){var r=t||new Array(4);return r[0]=(n>>0&255)/255,r[1]=(n>>8&255)/255,r[2]=(n>>16&255)/255,r[3]=(n>>24&255)/255,r}function vec4ToIndex(n){return n[0]+(n[1]<<8)+(n[2]<<16)+(n[3]<<24)}function createTexture(n,t){var r=n.createTexture();return r.buffer=function(a){n.bindTexture(n.TEXTURE_2D,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,a),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)},r.deleteTexture=function(){n.deleteTexture(r)},r}function getTypeInfo(n,t){switch(t){case"float":return[1,n.FLOAT,4];case"vec2":return[2,n.FLOAT,4];case"vec3":return[3,n.FLOAT,4];case"vec4":return[4,n.FLOAT,4];case"int":return[1,n.INT,4];case"ivec2":return[2,n.INT,4]}}function createTypedArray(n,t,r){switch(t){case n.FLOAT:return new Float32Array(r);case n.INT:return new Int32Array(r)}}function createTypedArrayView(n,t,r,a,o,u){switch(t){case n.FLOAT:return new Float32Array(r.buffer,u*a,o);case n.INT:return new Int32Array(r.buffer,u*a,o)}}function createBufferStaticDraw(n,t,r,a){var o=getTypeInfo(n,t),u=_slicedToArray(o,2),s=u[0],c=u[1],l=createTypedArray(n,c,a),d=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,d),n.bufferData(n.ARRAY_BUFFER,l,n.STATIC_DRAW),c===n.FLOAT?n.vertexAttribPointer(r,s,c,!1,0,0):c===n.INT&&n.vertexAttribIPointer(r,s,c,0,0),n.enableVertexAttribArray(r),n.bindBuffer(n.ARRAY_BUFFER,null),d}function createBufferDynamicDraw(n,t,r,a){var o=getTypeInfo(n,r),u=_slicedToArray(o,3),s=u[0],c=u[1],l=u[2],d=createTypedArray(n,c,t*s),f=s*l,h=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,h),n.bufferData(n.ARRAY_BUFFER,t*f,n.DYNAMIC_DRAW),n.enableVertexAttribArray(a),c===n.FLOAT?n.vertexAttribPointer(a,s,c,!1,f,0):c===n.INT&&n.vertexAttribIPointer(a,s,c,f,0),n.vertexAttribDivisor(a,1),n.bindBuffer(n.ARRAY_BUFFER,null);for(var v=new Array(t),g=0;g<t;g++)v[g]=createTypedArrayView(n,c,d,f,s,g);return h.dataArray=d,h.stride=f,h.size=s,h.getView=function(b){return v[b]},h.setPoint=function(b,_,S){var T=v[b];T[0]=_,T[1]=S},h.bufferSubData=function(b){n.bindBuffer(n.ARRAY_BUFFER,h),b?n.bufferSubData(n.ARRAY_BUFFER,0,d,0,b*s):n.bufferSubData(n.ARRAY_BUFFER,0,d)},h}function createPickingFrameBuffer(n){var t=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,t);var r=n.createTexture();return n.bindTexture(n.TEXTURE_2D,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0),n.bindFramebuffer(n.FRAMEBUFFER,null),t.setFramebufferAttachmentSizes=function(a,o){n.bindTexture(n.TEXTURE_2D,r),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,a,o,0,n.RGBA,n.UNSIGNED_BYTE,null)},t}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function create(){var n=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function identity(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function multiply(n,t,r){var a=t[0],o=t[1],u=t[2],s=t[3],c=t[4],l=t[5],d=t[6],f=t[7],h=t[8],v=r[0],g=r[1],b=r[2],_=r[3],S=r[4],T=r[5],w=r[6],A=r[7],R=r[8];return n[0]=v*a+g*s+b*d,n[1]=v*o+g*c+b*f,n[2]=v*u+g*l+b*h,n[3]=_*a+S*s+T*d,n[4]=_*o+S*c+T*f,n[5]=_*u+S*l+T*h,n[6]=w*a+A*s+R*d,n[7]=w*o+A*c+R*f,n[8]=w*u+A*l+R*h,n}function translate(n,t,r){var a=t[0],o=t[1],u=t[2],s=t[3],c=t[4],l=t[5],d=t[6],f=t[7],h=t[8],v=r[0],g=r[1];return n[0]=a,n[1]=o,n[2]=u,n[3]=s,n[4]=c,n[5]=l,n[6]=v*a+g*s+d,n[7]=v*o+g*c+f,n[8]=v*u+g*l+h,n}function rotate(n,t,r){var a=t[0],o=t[1],u=t[2],s=t[3],c=t[4],l=t[5],d=t[6],f=t[7],h=t[8],v=Math.sin(r),g=Math.cos(r);return n[0]=g*a+v*s,n[1]=g*o+v*c,n[2]=g*u+v*l,n[3]=g*s-v*a,n[4]=g*c-v*o,n[5]=g*l-v*u,n[6]=d,n[7]=f,n[8]=h,n}function scale(n,t,r){var a=r[0],o=r[1];return n[0]=a*t[0],n[1]=a*t[1],n[2]=a*t[2],n[3]=o*t[3],n[4]=o*t[4],n[5]=o*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function projection(n,t,r){return n[0]=2/t,n[1]=0,n[2]=0,n[3]=0,n[4]=-2/r,n[5]=0,n[6]=-1,n[7]=1,n[8]=1,n}var RENDER_TARGET={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},renderDefaults=defaults$g({getKey:null,drawElement:null,getBoundingBox:null,getRotation:null,getRotationPoint:null,getRotationOffset:null,isVisible:null,getPadding:null}),Atlas=function(){function n(t,r){_classCallCheck(this,n),this.debugID=Math.floor(Math.random()*1e4),this.r=t,this.atlasSize=r.webglTexSize,this.rows=r.webglTexRows,this.enableWrapping=r.enableWrapping,this.texHeight=Math.floor(this.atlasSize/this.rows),this.maxTexWidth=this.atlasSize,this.texture=null,this.canvas=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=r.createTextureCanvas(t,this.atlasSize,this.atlasSize),this.scratch=r.createTextureCanvas(t,this.atlasSize,this.texHeight,"scratch")}return _createClass(n,[{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var a=r.w,o=r.h,u=this.texHeight,s=this.maxTexWidth,c=u/o,l=a*c,d=o*c;return l>s&&(c=s/a,l=a*c,d=o*c),{scale:c,texW:l,texH:d}}},{key:"draw",value:function(r,a,o){var u=this,s=this.atlasSize,c=this.rows,l=this.texHeight,d=this.getScale(a),f=d.scale,h=d.texW,v=d.texH,g=[null,null],b=function(A,R){if(o&&R){var E=R.context,I=A.x,L=A.row,F=I,D=l*L;E.save(),E.translate(F,D),E.scale(f,f),o(E,a),E.restore()}},_=function(){b(u.freePointer,u.canvas),g[0]={x:u.freePointer.x,y:u.freePointer.row*l,w:h,h:v},g[1]={x:u.freePointer.x+h,y:u.freePointer.row*l,w:0,h:v},u.freePointer.x+=h,u.freePointer.x==s&&(u.freePointer.x=0,u.freePointer.row++)},S=function(){var A=u.scratch,R=u.canvas;A.clear(),b({x:0,row:0},A);var E=s-u.freePointer.x,I=h-E,L=l;{var F=u.freePointer.x,D=u.freePointer.row*l,$=E;R.context.drawImage(A,0,0,$,L,F,D,$,L),g[0]={x:F,y:D,w:$,h:v}}{var O=E,P=(u.freePointer.row+1)*l,C=I;R&&R.context.drawImage(A,O,0,C,L,0,P,C,L),g[1]={x:0,y:P,w:C,h:v}}u.freePointer.x=I,u.freePointer.row++},T=function(){u.freePointer.x=0,u.freePointer.row++};if(this.freePointer.x+h<=s)_();else{if(this.freePointer.row>=c-1)return!1;this.freePointer.x===s?(T(),_()):this.enableWrapping?S():(T(),_())}return this.keyToLocation.set(r,g),this.needsBuffer=!0,g}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){var a=this.atlasSize,o=this.rows,u=this.getScale(r),s=u.texW;return this.freePointer.x+s>a?this.freePointer.row<o-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=createTexture(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1)}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null,this.needsBuffer=!0)}}]),n}(),AtlasCollection=function(){function n(t,r){_classCallCheck(this,n),this.r=t,this.opts=r,this.keyToIds=new Map,this.idToKey=new Map,this.atlases=[],this.styleKeyToAtlas=new Map,this.styleKeyNeedsRedraw=new Set,this.forceGC=!1}return _createClass(n,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"getIdsFor",value:function(r){var a=this.keyToIds.get(r);return a||(a=new Set,this.keyToIds.set(r,a)),a}},{key:"_createAtlas",value:function(){var r=this.r,a=this.opts;return new Atlas(r,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,a=this.opts,o=a.webglTexSize,u=Math.floor(o/a.webglTexRows);this.scratch=a.createTextureCanvas(r,o,u,"scratch")}return this.scratch}},{key:"draw",value:function(r,a,o,u){if(this.styleKeyNeedsRedraw.has(a)){this.styleKeyNeedsRedraw.delete(a),this.deleteKey(r,a);var s=this.styleKeyToAtlas.get(a);s&&(s.forceGC=!0),this.styleKeyToAtlas.delete(a)}var c=this.styleKeyToAtlas.get(a);return c||(c=this.atlases[this.atlases.length-1],(!c||!c.canFit(o))&&(c=this._createAtlas(),this.atlases.push(c)),c.draw(a,o,u),this.styleKeyToAtlas.set(a,c),this.getIdsFor(a).add(r),this.idToKey.set(r,a)),c}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"deleteKey",value:function(r,a){this.idToKey.delete(r),this.getIdsFor(a).delete(r)}},{key:"checkKeyIsInvalid",value:function(r,a){if(!this.idToKey.has(r))return!1;var o=this.idToKey.get(r);return o!=a?(this.deleteKey(r,o),!0):!1}},{key:"_getKeysToCollect",value:function(){var r=new Set,a=_createForOfIteratorHelper(this.styleKeyToAtlas.keys()),o;try{for(a.s();!(o=a.n()).done;){var u=o.value;this.getIdsFor(u).size==0&&r.add(u)}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"gc",value:function(){var r=this,a=this.atlases.some(function(v){return v.forceGC}),o=this._getKeysToCollect();if(o.size===0&&!a){console.log("nothing to garbage collect");return}var u=[],s=new Map,c=null,l=_createForOfIteratorHelper(this.atlases),d;try{var f=function(){var g=d.value,b=g.getKeys(),_=intersection(o,b);if(_.size===0&&!g.forceGC)return u.push(g),b.forEach(function(L){return s.set(L,g)}),"continue";c||(c=r._createAtlas(),u.push(c));var S=_createForOfIteratorHelper(b),T;try{for(S.s();!(T=S.n()).done;){var w=T.value;if(!_.has(w)){var A=g.getOffsets(w),R=_slicedToArray(A,2),E=R[0],I=R[1];c.canFit({w:E.w+I.w,h:E.h})||(c=r._createAtlas(),u.push(c)),r._copyTextureToNewAtlas(w,g,c),s.set(w,c)}}}catch(L){S.e(L)}finally{S.f()}};for(l.s();!(d=l.n()).done;)var h=f()}catch(v){l.e(v)}finally{l.f()}this.atlases=u,this.styleKeyToAtlas=s}},{key:"_copyTextureToNewAtlas",value:function(r,a,o){var u=a.getOffsets(r),s=_slicedToArray(u,2),c=s[0],l=s[1];if(l.w===0)o.draw(r,c,function(v){v.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,0,c.w,c.h)});else{var d=this._getScratchCanvas();d.clear(),d.context.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,0,c.w,c.h),d.context.drawImage(a.canvas,l.x,l.y,l.w,l.h,c.w,0,l.w,l.h);var f=c.w+l.w,h=c.h;o.draw(r,{w:f,h},function(v){v.drawImage(d,0,0,f,h,0,0,f,h)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}]),n}();function intersection(n,t){return n.intersection?n.intersection(t):new Set(_toConsumableArray(n).filter(function(r){return t.has(r)}))}var AtlasManager=function(){function n(t,r){_classCallCheck(this,n),this.r=t;var a=r;this.globalOptions=a,this.maxAtlases=a.webglTexPerBatch,this.atlasSize=a.webglTexSize,this.renderTypes=new Map,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.batchAtlases=[],this._cacheScratchCanvas(a)}return _createClass(n,[{key:"_cacheScratchCanvas",value:function(r){var a=-1,o=-1,u=null,s=r.createTextureCanvas;r.createTextureCanvas=function(c,l,d,f){return f?((!u||l!=a||d!=o)&&(a=l,o=d,u=s(c,l,d)),u):s(c,l,d)}}},{key:"addRenderType",value:function(r,a){var o=new AtlasCollection(this.r,this.globalOptions),u=a;this.renderTypes.set(r,extend({type:r,atlasCollection:o},u))}},{key:"getRenderTypes",value:function(){return _toConsumableArray(this.renderTypes.values())}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"invalidate",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.forceRedraw,u=o===void 0?!1:o,s=a.filterEle,c=s===void 0?function(){return!0}:s,l=a.filterType,d=l===void 0?function(){return!0}:l,f=!1,h=_createForOfIteratorHelper(r),v;try{for(h.s();!(v=h.n()).done;){var g=v.value;if(c(g)){var b=g.id(),_=_createForOfIteratorHelper(this.getRenderTypes()),S;try{for(_.s();!(S=_.n()).done;){var T=S.value;if(d(T.type)){var w=T.getKey(g);u?(T.atlasCollection.deleteKey(b,w),T.atlasCollection.styleKeyNeedsRedraw.add(w),f=!0):f|=T.atlasCollection.checkKeyIsInvalid(b,w)}}}catch(A){_.e(A)}finally{_.f()}}}}catch(A){h.e(A)}finally{h.f()}return f}},{key:"gc",value:function(){var r=_createForOfIteratorHelper(this.getRenderTypes()),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;o.atlasCollection.gc()}}catch(u){r.e(u)}finally{r.f()}}},{key:"isRenderable",value:function(r,a){var o=this.getRenderTypeOpts(a);return o&&o.isVisible(r)}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"getOrCreateAtlas",value:function(r,a,o){var u=this.renderTypes.get(o),s=u.getKey(r),c=r.id();return u.atlasCollection.draw(c,s,a,function(l){u.drawElement(l,r,a,!0,!0)})}},{key:"getAtlasIndexForBatch",value:function(r){var a=this.batchAtlases.indexOf(r);if(a<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)return;this.batchAtlases.push(r),a=this.batchAtlases.length-1}return a}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlases},function(r,a){return a})}},{key:"getAtlasInfo",value:function(r,a){var o=this.renderTypes.get(a),u=o.getBoundingBox(r),s=this.getOrCreateAtlas(r,u,a),c=this.getAtlasIndexForBatch(s);if(c!==void 0){var l=o.getKey(r),d=s.getOffsets(l),f=_slicedToArray(d,2),h=f[0],v=f[1];return{atlasID:c,tex:h,tex1:h,tex2:v,bb:u,type:a,styleKey:l}}}},{key:"canAddToCurrentBatch",value:function(r,a){if(this.batchAtlases.length===this.maxAtlasesPerBatch){var o=this.renderTypes.get(a),u=o.getKey(r),s=o.atlasCollection.getAtlas(u);return s&&this.batchAtlases.includes(s)}return!0}},{key:"setTransformMatrix",value:function(r,a,o){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=a.bb,c=a.type,l=a.tex1,d=a.tex2,f=this.getRenderTypeOpts(c),h=f.getPadding?f.getPadding(o):0,v=l.w/(l.w+d.w);u||(v=1-v);var g=this.getAdjustedBB(s,h,u,v),b,_;identity(r);var S=f.getRotation?f.getRotation(o):0;if(S!==0){var T=f.getRotationPoint(o),w=T.x,A=T.y;translate(r,r,[w,A]),rotate(r,r,S);var R=f.getRotationOffset(o);b=R.x+g.xOffset,_=R.y}else b=g.x1,_=g.y1;translate(r,r,[b,_]),scale(r,r,[g.w,g.h])}},{key:"getTransformMatrix",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=create();return this.setTransformMatrix(u,r,a,o),u}},{key:"getAdjustedBB",value:function(r,a,o,u){var s=r.x1,c=r.y1,l=r.w,d=r.h;a&&(s-=a,c-=a,l+=2*a,d+=2*a);var f=0,h=l*u;return o&&u<1?l=h:!o&&u<1&&(f=l-h,s+=f,l=h),{x1:s,y1:c,w:l,h:d,xOffset:f}}},{key:"getDebugInfo",value:function(){var r=[],a=_createForOfIteratorHelper(this.renderTypes),o;try{for(a.s();!(o=a.n()).done;){var u=_slicedToArray(o.value,2),s=u[0],c=u[1],l=c.atlasCollection.getCounts(),d=l.keyCount,f=l.atlasCount;r.push({type:s,keyCount:d,atlasCount:f})}}catch(h){a.e(h)}finally{a.f()}return r}}]),n}(),TEXTURE=0,EDGE_STRAIGHT=1,EDGE_CURVE_SEGMENT=2,EDGE_ARROW=3,ElementDrawingWebGL=function(){function n(t,r,a){_classCallCheck(this,n),this.r=t,this.gl=r,this.maxInstances=a.webglBatchSize,this.maxAtlases=a.webglTexPerBatch,this.atlasSize=a.webglTexSize,this.bgColor=a.bgColor,a.enableWrapping=!0,a.createTextureCanvas=createTextureCanvas,this.atlasManager=new AtlasManager(t,a),this.program=this.createShaderProgram(RENDER_TARGET.SCREEN),this.pickingProgram=this.createShaderProgram(RENDER_TARGET.PICKING),this.vao=this.createVAO(),this.debugInfo=[]}return _createClass(n,[{key:"addTextureRenderType",value:function(r,a){this.atlasManager.addRenderType(r,a)}},{key:"invalidate",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.type,u=this.atlasManager;return o?u.invalidate(r,{filterType:function(c){return c===o},forceRedraw:!0}):u.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"createShaderProgram",value:function(r){var a=this.gl,o=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; 

      // what are we rendering?
      in int aVertType;

      // for picking
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex1; // x/y/w/h of texture in atlas
      in vec4 aTex2; 

      // for any transforms that are needed
      in vec4 aScaleRotate1;  // vectors use fewer attributes than matrices
      in vec2 aTranslate1;
      in vec4 aScaleRotate2;
      in vec2 aTranslate2;

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in float aLineWidth;
      in vec4 aEdgeColor;

      out vec2 vTexCoord;
      out vec4 vEdgeColor;
      flat out int vAtlasId;
      flat out vec4 vIndex;
      flat out int vVertType;

      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition;

        if(aVertType == `.concat(TEXTURE,`) {
          float texX;
          float texY;
          float texW;
          float texH;
          mat3  texMatrix;

          int vid = gl_VertexID;
          if(vid <= 5) {
            texX = aTex1.x;
            texY = aTex1.y;
            texW = aTex1.z;
            texH = aTex1.w;
            texMatrix = mat3(
              vec3(aScaleRotate1.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate1,      1.0)
            );
          } else {
            texX = aTex2.x;
            texY = aTex2.y;
            texW = aTex2.z;
            texH = aTex2.w;
            texMatrix = mat3(
              vec3(aScaleRotate2.xy, 0.0),
              vec3(aScaleRotate2.zw, 0.0),
              vec3(aTranslate2,      1.0)
            );
          }

          if(vid == 1 || vid == 2 || vid == 4 || vid == 7 || vid == 8 || vid == 10) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5 || vid == 8 || vid == 10 || vid == 11) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * texMatrix * vec3(position, 1.0), 1.0);
        } 
        else if(aVertType == `).concat(EDGE_STRAIGHT,` && vid < 6) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(EDGE_CURVE_SEGMENT,` && vid < 6) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0 = pointA;
          vec2 p1 = pointB;
          vec2 p2 = pointC;
          vec2 pos = position;
          if(position.x == 1.0) {
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth;

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vEdgeColor = aEdgeColor;
        } 
        else if(aVertType == `).concat(EDGE_ARROW,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2( 0.0,   0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          mat3 transform = mat3(
            vec3(aScaleRotate1.xy, 0.0),
            vec3(aScaleRotate1.zw, 0.0),
            vec3(aTranslate1,      1.0)
          );
          gl_Position = vec4(uPanZoomMatrix * transform * vec3(position, 1.0), 1.0);
          vEdgeColor = aEdgeColor;
        } else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vIndex = aIndex;
        vVertType = aVertType;
      }
    `),u=this.atlasManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // define texture unit for each node in the batch
      `.concat(u.map(function(d){return"uniform sampler2D uTexture".concat(d,";")}).join(`
	`),`

      uniform vec4 uBGColor;

      in vec2 vTexCoord;
      in vec4 vEdgeColor;
      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;

      out vec4 outColor;

      void main(void) {
        if(vVertType == `).concat(TEXTURE,`) {
          `).concat(u.map(function(d){return"if(vAtlasId == ".concat(d,") outColor = texture(uTexture").concat(d,", vTexCoord);")}).join(`
	else `),`
        } else if(vVertType == `).concat(EDGE_ARROW,`) {
          // blend arrow color with background (using premultiplied alpha)
          outColor.rgb = vEdgeColor.rgb + (uBGColor.rgb * (1.0 - vEdgeColor.a)); 
          outColor.a = 1.0; // make opaque, masks out line under arrow
        } else {
          outColor = vEdgeColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),c=createProgram(a,o,s);c.aPosition=a.getAttribLocation(c,"aPosition"),c.aIndex=a.getAttribLocation(c,"aIndex"),c.aVertType=a.getAttribLocation(c,"aVertType"),c.aAtlasId=a.getAttribLocation(c,"aAtlasId"),c.aTex1=a.getAttribLocation(c,"aTex1"),c.aTex2=a.getAttribLocation(c,"aTex2"),c.aScaleRotate1=a.getAttribLocation(c,"aScaleRotate1"),c.aTranslate1=a.getAttribLocation(c,"aTranslate1"),c.aScaleRotate2=a.getAttribLocation(c,"aScaleRotate2"),c.aTranslate2=a.getAttribLocation(c,"aTranslate2"),c.aPointAPointB=a.getAttribLocation(c,"aPointAPointB"),c.aPointCPointD=a.getAttribLocation(c,"aPointCPointD"),c.aLineWidth=a.getAttribLocation(c,"aLineWidth"),c.aEdgeColor=a.getAttribLocation(c,"aEdgeColor"),c.uPanZoomMatrix=a.getUniformLocation(c,"uPanZoomMatrix"),c.uAtlasSize=a.getUniformLocation(c,"uAtlasSize"),c.uBGColor=a.getUniformLocation(c,"uBGColor"),c.uTextures=[];for(var l=0;l<this.atlasManager.maxAtlases;l++)c.uTextures.push(a.getUniformLocation(c,"uTexture".concat(l)));return c}},{key:"createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1],a=[].concat(r,r);this.vertexCount=a.length/2;var o=this.maxInstances,u=this.gl,s=this.program,c=u.createVertexArray();return u.bindVertexArray(c),createBufferStaticDraw(u,"vec2",s.aPosition,a),this.indexBuffer=createBufferDynamicDraw(u,o,"vec4",s.aIndex),this.vertTypeBuffer=createBufferDynamicDraw(u,o,"int",s.aVertType),this.atlasIdBuffer=createBufferDynamicDraw(u,o,"int",s.aAtlasId),this.tex1Buffer=createBufferDynamicDraw(u,o,"vec4",s.aTex1),this.tex2Buffer=createBufferDynamicDraw(u,o,"vec4",s.aTex2),this.scaleRotate1Buffer=createBufferDynamicDraw(u,o,"vec4",s.aScaleRotate1),this.translate1Buffer=createBufferDynamicDraw(u,o,"vec2",s.aTranslate1),this.scaleRotate2Buffer=createBufferDynamicDraw(u,o,"vec4",s.aScaleRotate2),this.translate2Buffer=createBufferDynamicDraw(u,o,"vec2",s.aTranslate2),this.pointAPointBBuffer=createBufferDynamicDraw(u,o,"vec4",s.aPointAPointB),this.pointCPointDBuffer=createBufferDynamicDraw(u,o,"vec4",s.aPointCPointD),this.lineWidthBuffer=createBufferDynamicDraw(u,o,"float",s.aLineWidth),this.edgeColorBuffer=createBufferDynamicDraw(u,o,"vec4",s.aEdgeColor),u.bindVertexArray(null),c}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(a){return a.endsWith("Buffer")}).map(function(a){return r[a]})),this._buffers}},{key:"startFrame",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:RENDER_TARGET.SCREEN;this.panZoomMatrix=r,this.debugInfo=a,this.renderTarget=o,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.atlasManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"getTempMatrix",value:function(){return this.tempMatrix=this.tempMatrix||create()}},{key:"drawTexture",value:function(r,a,o){var u=this.atlasManager;if(u.isRenderable(r,o)){u.canAddToCurrentBatch(r,o)||this.endBatch();var s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=TEXTURE;var c=this.indexBuffer.getView(s);indexToVec4(a,c);var l=u.getAtlasInfo(r,o,l),d=l.atlasID,f=l.tex1,h=l.tex2,v=this.atlasIdBuffer.getView(s);v[0]=d;var g=this.tex1Buffer.getView(s);g[0]=f.x,g[1]=f.y,g[2]=f.w,g[3]=f.h;var b=this.tex2Buffer.getView(s);b[0]=h.x,b[1]=h.y,b[2]=h.w,b[3]=h.h;for(var _=this.getTempMatrix(),S=0,T=[1,2];S<T.length;S++){var w=T[S];u.setTransformMatrix(_,l,r,w===1);var A=this["scaleRotate".concat(w,"Buffer")].getView(s);A[0]=_[0],A[1]=_[1],A[2]=_[3],A[3]=_[4];var R=this["translate".concat(w,"Buffer")].getView(s);R[0]=_[6],R[1]=_[7]}this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"drawEdgeArrow",value:function(r,a,o){var u=r._private.rscratch,s,c,l;if(o==="source"?(s=u.arrowStartX,c=u.arrowStartY,l=u.srcArrowAngle):(s=u.arrowEndX,c=u.arrowEndY,l=u.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(c)||c==null||isNaN(l)||l==null)){var d=r.pstyle(o+"-arrow-shape").value;if(d!=="none"){var f=r.pstyle(o+"-arrow-color").value,h=r.pstyle("opacity").value,v=r.pstyle("line-opacity").value,g=h*v,b=r.pstyle("width").pfValue,_=r.pstyle("arrow-scale").value,S=this.r.getArrowWidth(b,_),T=this.getTempMatrix();identity(T),translate(T,T,[s,c]),scale(T,T,[S,S]),rotate(T,T,l);var w=this.instanceCount;this.vertTypeBuffer.getView(w)[0]=EDGE_ARROW;var A=this.indexBuffer.getView(w);indexToVec4(a,A);var R=this.edgeColorBuffer.getView(w);toWebGLColor(f,g,R);var E=this.scaleRotate1Buffer.getView(w);E[0]=T[0],E[1]=T[1],E[2]=T[3],E[3]=T[4];var I=this.translate1Buffer.getView(w);I[0]=T[6],I[1]=T[7],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}},{key:"drawEdgeLine",value:function(r,a){var o=r.pstyle("opacity").value,u=r.pstyle("line-opacity").value,s=r.pstyle("width").pfValue,c=r.pstyle("line-color").value,l=o*u,d=this.getEdgePoints(r);if(d.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),d.length==4){var f=this.instanceCount;this.vertTypeBuffer.getView(f)[0]=EDGE_STRAIGHT;var h=this.indexBuffer.getView(f);indexToVec4(a,h);var v=this.edgeColorBuffer.getView(f);toWebGLColor(c,l,v);var g=this.lineWidthBuffer.getView(f);g[0]=s;var b=this.pointAPointBBuffer.getView(f);b[0]=d[0],b[1]=d[1],b[2]=d[2],b[3]=d[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var _=0;_<d.length-2;_+=2){var S=this.instanceCount;this.vertTypeBuffer.getView(S)[0]=EDGE_CURVE_SEGMENT;var T=this.indexBuffer.getView(S);indexToVec4(a,T);var w=this.edgeColorBuffer.getView(S);toWebGLColor(c,l,w);var A=this.lineWidthBuffer.getView(S);A[0]=s;var R=d[_-2],E=d[_-1],I=d[_],L=d[_+1],F=d[_+2],D=d[_+3],$=d[_+4],O=d[_+5];_==0&&(R=2*I-F+.001,E=2*L-D+.001),_==d.length-4&&($=2*F-I+.001,O=2*D-L+.001);var P=this.pointAPointBBuffer.getView(S);P[0]=R,P[1]=E,P[2]=I,P[3]=L;var C=this.pointCPointDBuffer.getView(S);C[0]=F,C[1]=D,C[2]=$,C[3]=O,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"getEdgePoints",value:function(r){var a=r._private.rscratch,o=a.allpts;if(o.length==4)return o;var u=this.getNumSegments(r);return this.getCurveSegmentPoints(o,u)}},{key:"getNumSegments",value:function(r){var a=15;return Math.min(Math.max(a,5),this.maxInstances)}},{key:"getCurveSegmentPoints",value:function(r,a){if(r.length==4)return r;for(var o=Array((a+1)*2),u=0;u<=a;u++)if(u==0)o[0]=r[0],o[1]=r[1];else if(u==a)o[u*2]=r[r.length-2],o[u*2+1]=r[r.length-1];else{var s=u/a;this.setCurvePoint(r,s,o,u*2)}return o}},{key:"setCurvePoint",value:function(r,a,o,u){if(r.length<=2)o[u]=r[0],o[u+1]=r[1];else{for(var s=Array(r.length-2),c=0;c<s.length;c+=2){var l=(1-a)*r[c]+a*r[c+2],d=(1-a)*r[c+1]+a*r[c+3];s[c]=l,s[c+1]=d}return this.setCurvePoint(s,a,o,u)}}},{key:"endBatch",value:function(){var r=this.gl,a=this.vao,o=this.vertexCount,u=this.instanceCount;if(u!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(s),r.bindVertexArray(a);var c=_createForOfIteratorHelper(this.buffers),l;try{for(c.s();!(l=c.n()).done;){var d=l.value;d.bufferSubData(u)}}catch(b){c.e(b)}finally{c.f()}for(var f=this.atlasManager.getAtlases(),h=0;h<f.length;h++)f[h].bufferIfNeeded(r);for(var v=0;v<f.length;v++)r.activeTexture(r.TEXTURE0+v),r.bindTexture(r.TEXTURE_2D,f[v].texture),r.uniform1i(s.uTextures[v],v);r.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(s.uAtlasSize,this.atlasManager.atlasSize);var g=toWebGLColor(this.bgColor,1);r.uniform4fv(s.uBGColor,g),r.drawArraysInstanced(r.TRIANGLES,0,o,u),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debugInfo&&this.debugInfo.push({count:u,atlasCount:f.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){return this.debugInfo}},{key:"getAtlasDebugInfo",value:function(){return this.atlasManager.getDebugInfo()}}]),n}();function fillStyle(n,t){return"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", ").concat(t,")")}var OverlayUnderlayRenderer=function(){function n(t){_classCallCheck(this,n),this.r=t}return _createClass(n,[{key:"getStyleKey",value:function(r,a){var o=this.getStyle(r,a),u=o.shape,s=o.opacity,c=o.color;if(!u)return null;var l=a.width(),d=a.height(),f=fillStyle(c,s);return hashString("".concat(u,"-").concat(l,"-").concat(d,"-").concat(f))}},{key:"isVisible",value:function(r,a){var o=a.pstyle("".concat(r,"-opacity")).value;return o>0}},{key:"getStyle",value:function(r,a){var o=a.pstyle("".concat(r,"-opacity")).value,u=a.pstyle("".concat(r,"-color")).value,s=a.pstyle("".concat(r,"-shape")).value;return{opacity:o,color:u,shape:s}}},{key:"getPadding",value:function(r,a){return a.pstyle("".concat(r,"-padding")).pfValue}},{key:"draw",value:function(r,a,o,u){if(this.isVisible(r,o)){var s=this.r,c=u.w,l=u.h,d=c/2,f=l/2,h=this.getStyle(r,o),v=h.shape,g=h.color,b=h.opacity;a.save(),a.fillStyle=fillStyle(g,b),v==="round-rectangle"||v==="roundrectangle"?s.drawRoundRectanglePath(a,d,f,c,l,"auto"):v==="ellipse"&&s.drawEllipsePath(a,d,f,c,l),a.fill(),a.restore()}}}]),n}();function getBGColor(n){var t=n&&n.style&&n.style.backgroundColor||"white";return color2tuple(t)}var CRp$4={};CRp$4.initWebgl=function(n,t){var r=this,a=r.data.contexts[r.WEBGL],o=n.cy.container();n.bgColor=getBGColor(o),n.webglTexSize=Math.min(n.webglTexSize,a.getParameter(a.MAX_TEXTURE_SIZE)),n.webglTexRows=Math.min(n.webglTexRows,54),n.webglBatchSize=Math.min(n.webglBatchSize,16384),n.webglTexPerBatch=Math.min(n.webglTexPerBatch,a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=n.webglDebug,r.webglDebugShowAtlases=n.webglDebugShowAtlases,console.log("max texture units",a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)),console.log("max texture size",a.getParameter(a.MAX_TEXTURE_SIZE)),console.log("webgl options",n),r.pickingFrameBuffer=createPickingFrameBuffer(a),r.pickingFrameBuffer.needsDraw=!0;var u=function(f){return r.getTextAngle(f,null)},s=function(f){var h=f.pstyle("label");return h&&h.value};r.eleDrawing=new ElementDrawingWebGL(r,a,n);var c=new OverlayUnderlayRenderer(r);r.eleDrawing.addTextureRenderType("node-body",renderDefaults({getKey:t.getStyleKey,getBoundingBox:t.getElementBox,drawElement:t.drawElement,isVisible:function(f){return f.visible()}})),r.eleDrawing.addTextureRenderType("node-label",renderDefaults({getKey:t.getLabelKey,getBoundingBox:t.getLabelBox,drawElement:t.drawLabel,getRotation:u,getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:s})),r.eleDrawing.addTextureRenderType("node-overlay",renderDefaults({getBoundingBox:t.getElementBox,getKey:function(f){return c.getStyleKey("overlay",f)},drawElement:function(f,h,v){return c.draw("overlay",f,h,v)},isVisible:function(f){return c.isVisible("overlay",f)},getPadding:function(f){return c.getPadding("overlay",f)}})),r.eleDrawing.addTextureRenderType("node-underlay",renderDefaults({getBoundingBox:t.getElementBox,getKey:function(f){return c.getStyleKey("underlay",f)},drawElement:function(f,h,v){return c.draw("underlay",f,h,v)},isVisible:function(f){return c.isVisible("underlay",f)},getPadding:function(f){return c.getPadding("underlay",f)}})),r.eleDrawing.addTextureRenderType("edge-label",renderDefaults({getKey:t.getLabelKey,getBoundingBox:t.getLabelBox,drawElement:t.drawLabel,getRotation:u,getRotationPoint:t.getLabelRotationPoint,getRotationOffset:t.getLabelRotationOffset,isVisible:s}));var l=debounce_1(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(d,f){var h=!1;f&&f.length>0&&(h|=r.eleDrawing.invalidate(f)),h&&l()}),overrideCanvasRendererFunctions(r)};function overrideCanvasRendererFunctions(n){{var t=n.render;n.render=function(u){u=u||{};var s=n.cy;n.webgl&&(s.zoom()>maxZoom$1?(clearWebgl(n),t.call(n,u)):(clearCanvas(n),renderWebgl(n,u,RENDER_TARGET.SCREEN)))}}{var r=n.matchCanvasSize;n.matchCanvasSize=function(u){r.call(n,u),n.pickingFrameBuffer.setFramebufferAttachmentSizes(n.canvasWidth,n.canvasHeight),n.pickingFrameBuffer.needsDraw=!0}}n.findNearestElements=function(u,s,c,l){return findNearestElementsWebgl(n,u,s)};{var a=n.invalidateCachedZSortedEles;n.invalidateCachedZSortedEles=function(){a.call(n),n.pickingFrameBuffer.needsDraw=!0}}{var o=n.notify;n.notify=function(u,s){o.call(n,u,s),u==="viewport"||u==="bounds"?n.pickingFrameBuffer.needsDraw=!0:u==="background"&&n.eleDrawing.invalidate(s,{type:"node-body"})}}}function clearWebgl(n){var t=n.data.contexts[n.WEBGL];t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}function clearCanvas(n){var t=function(a){a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,n.canvasWidth,n.canvasHeight),a.restore()};t(n.data.contexts[n.NODE]),t(n.data.contexts[n.DRAG])}function createPanZoomMatrix(n){var t=n.canvasWidth,r=n.canvasHeight,a=getEffectivePanZoom(n),o=a.pan,u=a.zoom,s=create();translate(s,s,[o.x,o.y]),scale(s,s,[u,u]);var c=create();projection(c,t,r);var l=create();return multiply(l,c,s),l}function setContextTransform(n,t){var r=n.canvasWidth,a=n.canvasHeight,o=getEffectivePanZoom(n),u=o.pan,s=o.zoom;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,r,a),t.translate(u.x,u.y),t.scale(s,s)}function drawSelectionRectangle(n,t){n.drawSelectionRectangle(t,function(r){return setContextTransform(n,r)})}function drawAxes(n){var t=n.data.contexts[n.NODE];t.save(),setContextTransform(n,t),t.strokeStyle="rgba(0, 0, 0, 0.3)",t.beginPath(),t.moveTo(-1e3,0),t.lineTo(1e3,0),t.stroke(),t.beginPath(),t.moveTo(0,-1e3),t.lineTo(0,1e3),t.stroke(),t.restore()}function drawAtlases(n){var t=function(o,u,s){for(var c=o.atlasManager.getRenderTypeOpts(u),l=n.data.contexts[n.NODE],d=.125,f=c.atlasCollection.atlases,h=0;h<f.length;h++){var v=f[h],g=v.canvas,b=g.width,_=g.height,S=b*h,T=g.height*s;l.save(),l.scale(d,d),l.drawImage(g,S,T),l.strokeStyle="black",l.rect(S,T,b,_),l.stroke(),l.restore()}},r=0;t(n.eleDrawing,"node-body",r++),t(n.eleDrawing,"node-label",r++)}function getPickingIndexes(n,t,r,a,o){var u,s,c,l,d=getEffectivePanZoom(n),f=d.pan,h=d.zoom;{var v=modelToRenderedPosition(n,f,h,t,r),g=_slicedToArray(v,2),b=g[0],_=g[1],S=6;u=b-S/2,s=_-S/2,c=S,l=S}if(c===0||l===0)return[];var T=n.data.contexts[n.WEBGL];T.bindFramebuffer(T.FRAMEBUFFER,n.pickingFrameBuffer),n.pickingFrameBuffer.needsDraw&&(T.viewport(0,0,T.canvas.width,T.canvas.height),renderWebgl(n,null,RENDER_TARGET.PICKING),n.pickingFrameBuffer.needsDraw=!1);var w=c*l,A=new Uint8Array(w*4);T.readPixels(u,s,c,l,T.RGBA,T.UNSIGNED_BYTE,A),T.bindFramebuffer(T.FRAMEBUFFER,null);for(var R=new Set,E=0;E<w;E++){var I=A.slice(E*4,E*4+4),L=vec4ToIndex(I)-1;L>=0&&R.add(L)}return R}function findNearestElementsWebgl(n,t,r){var a=getPickingIndexes(n,t,r),o=n.getCachedZSortedEles(),u,s,c=_createForOfIteratorHelper(a),l;try{for(c.s();!(l=c.n()).done;){var d=l.value,f=o[d];if(!u&&f.isNode()&&(u=f),!s&&f.isEdge()&&(s=f),u&&s)break}}catch(h){c.e(h)}finally{c.f()}return[u,s].filter(Boolean)}function renderWebgl(n,t,r){var a,o;n.webglDebug&&(o=[],a=performance.now());var u=n.eleDrawing,s=0;if(r.screen&&n.data.canvasNeedsRedraw[n.SELECT_BOX]&&drawSelectionRectangle(n,t),n.data.canvasNeedsRedraw[n.NODE]||r.picking){var c=function(P,C){C+=1,P.isNode()?(u.drawTexture(P,C,"node-underlay"),u.drawTexture(P,C,"node-body"),u.drawTexture(P,C,"node-label"),u.drawTexture(P,C,"node-overlay")):(u.drawEdgeLine(P,C),u.drawEdgeArrow(P,C,"source"),u.drawEdgeArrow(P,C,"target"),u.drawTexture(P,C,"edge-label"))},l=n.data.contexts[n.WEBGL];r.screen?(l.clearColor(0,0,0,0),l.enable(l.BLEND),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA)):l.disable(l.BLEND),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.viewport(0,0,l.canvas.width,l.canvas.height);var d=createPanZoomMatrix(n),f=n.getCachedZSortedEles();if(s=f.length,u.startFrame(d,o,r),r.screen){for(var h=0;h<f.nondrag.length;h++)c(f.nondrag[h],h);for(var v=0;v<f.drag.length;v++)c(f.drag[v],-1)}else if(r.picking)for(var g=0;g<f.length;g++)c(f[g],g);u.endFrame(),n.data.gc&&(console.log("Garbage Collect!"),n.data.gc=!1,u.gc()),r.screen&&n.webglDebugShowAtlases&&(drawAxes(n),drawAtlases(n)),n.data.canvasNeedsRedraw[n.NODE]=!1,n.data.canvasNeedsRedraw[n.DRAG]=!1}if(n.webglDebug){var b=performance.now(),_=!0,S=0,T=0,w=_createForOfIteratorHelper(o),A;try{for(w.s();!(A=w.n()).done;){var R=A.value;S++,T+=R.count}}catch(O){w.e(O)}finally{w.f()}var E=Math.ceil(b-a),I="".concat(s," elements, ").concat(T," rectangles, ").concat(S," batches");if(_)console.log("WebGL (".concat(r.name,") - ").concat(I));else{console.log("WebGL render (".concat(r.name,") - frame time ").concat(E,"ms")),console.log("  ".concat(I)),console.log("Texture Atlases Used:");var L=u.getAtlasDebugInfo(),F=_createForOfIteratorHelper(L),D;try{for(F.s();!(D=F.n()).done;){var $=D.value;console.log("  ".concat($.type,": ").concat($.keyCount," keys, ").concat($.atlasCount," atlases"))}}catch(O){F.e(O)}finally{F.f()}console.log("")}}}var CRp$3={};CRp$3.drawPolygonPath=function(n,t,r,a,o,u){var s=a/2,c=o/2;n.beginPath&&n.beginPath(),n.moveTo(t+s*u[0],r+c*u[1]);for(var l=1;l<u.length/2;l++)n.lineTo(t+s*u[l*2],r+c*u[l*2+1]);n.closePath()};CRp$3.drawRoundPolygonPath=function(n,t,r,a,o,u,s){s.forEach(function(c){return drawPreparedRoundCorner(n,c)}),n.closePath()};CRp$3.drawRoundRectanglePath=function(n,t,r,a,o,u){var s=a/2,c=o/2,l=u==="auto"?getRoundRectangleRadius(a,o):Math.min(u,c,s);n.beginPath&&n.beginPath(),n.moveTo(t,r-c),n.arcTo(t+s,r-c,t+s,r,l),n.arcTo(t+s,r+c,t,r+c,l),n.arcTo(t-s,r+c,t-s,r,l),n.arcTo(t-s,r-c,t,r-c,l),n.lineTo(t,r-c),n.closePath()};CRp$3.drawBottomRoundRectanglePath=function(n,t,r,a,o,u){var s=a/2,c=o/2,l=u==="auto"?getRoundRectangleRadius(a,o):u;n.beginPath&&n.beginPath(),n.moveTo(t,r-c),n.lineTo(t+s,r-c),n.lineTo(t+s,r),n.arcTo(t+s,r+c,t,r+c,l),n.arcTo(t-s,r+c,t-s,r,l),n.lineTo(t-s,r-c),n.lineTo(t,r-c),n.closePath()};CRp$3.drawCutRectanglePath=function(n,t,r,a,o,u,s){var c=a/2,l=o/2,d=s==="auto"?getCutRectangleCornerLength():s;n.beginPath&&n.beginPath(),n.moveTo(t-c+d,r-l),n.lineTo(t+c-d,r-l),n.lineTo(t+c,r-l+d),n.lineTo(t+c,r+l-d),n.lineTo(t+c-d,r+l),n.lineTo(t-c+d,r+l),n.lineTo(t-c,r+l-d),n.lineTo(t-c,r-l+d),n.closePath()};CRp$3.drawBarrelPath=function(n,t,r,a,o){var u=a/2,s=o/2,c=t-u,l=t+u,d=r-s,f=r+s,h=getBarrelCurveConstants(a,o),v=h.widthOffset,g=h.heightOffset,b=h.ctrlPtOffsetPct*v;n.beginPath&&n.beginPath(),n.moveTo(c,d+g),n.lineTo(c,f-g),n.quadraticCurveTo(c+b,f,c+v,f),n.lineTo(l-v,f),n.quadraticCurveTo(l-b,f,l,f-g),n.lineTo(l,d+g),n.quadraticCurveTo(l-b,d,l-v,d),n.lineTo(c+v,d),n.quadraticCurveTo(c+b,d,c,d+g),n.closePath()};var sin0=Math.sin(0),cos0=Math.cos(0),sin={},cos={},ellipseStepSize=Math.PI/40;for(var i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)sin[i]=Math.sin(i),cos[i]=Math.cos(i);CRp$3.drawEllipsePath=function(n,t,r,a,o){if(n.beginPath&&n.beginPath(),n.ellipse)n.ellipse(t,r,a/2,o/2,0,0,2*Math.PI);else for(var u,s,c=a/2,l=o/2,d=0*Math.PI;d<2*Math.PI;d+=ellipseStepSize)u=t-c*sin[d]*sin0+c*cos[d]*cos0,s=r+l*cos[d]*sin0+l*sin[d]*cos0,d===0?n.moveTo(u,s):n.lineTo(u,s);n.closePath()};var CRp$2={};CRp$2.createBuffer=function(n,t){var r=document.createElement("canvas");return r.width=n,r.height=t,[r,r.getContext("2d")]};CRp$2.bufferCanvasImage=function(n){var t=this.cy,r=t.mutableElements(),a=r.boundingBox(),o=this.findContainerClientCoords(),u=n.full?Math.ceil(a.w):o[2],s=n.full?Math.ceil(a.h):o[3],c=number$1(n.maxWidth)||number$1(n.maxHeight),l=this.getPixelRatio(),d=1;if(n.scale!==void 0)u*=n.scale,s*=n.scale,d=n.scale;else if(c){var f=1/0,h=1/0;number$1(n.maxWidth)&&(f=d*n.maxWidth/u),number$1(n.maxHeight)&&(h=d*n.maxHeight/s),d=Math.min(f,h),u*=d,s*=d}c||(u*=l,s*=l,d*=l);var v=document.createElement("canvas");v.width=u,v.height=s,v.style.width=u+"px",v.style.height=s+"px";var g=v.getContext("2d");if(u>0&&s>0){g.clearRect(0,0,u,s),g.globalCompositeOperation="source-over";var b=this.getCachedZSortedEles();if(n.full)g.translate(-a.x1*d,-a.y1*d),g.scale(d,d),this.drawElements(g,b),g.scale(1/d,1/d),g.translate(a.x1*d,a.y1*d);else{var _=t.pan(),S={x:_.x*d,y:_.y*d};d*=t.zoom(),g.translate(S.x,S.y),g.scale(d,d),this.drawElements(g,b),g.scale(1/d,1/d),g.translate(-S.x,-S.y)}n.bg&&(g.globalCompositeOperation="destination-over",g.fillStyle=n.bg,g.rect(0,0,u,s),g.fill())}return v};function b64ToBlob(n,t){for(var r=atob(n),a=new ArrayBuffer(r.length),o=new Uint8Array(a),u=0;u<r.length;u++)o[u]=r.charCodeAt(u);return new Blob([a],{type:t})}function b64UriToB64(n){var t=n.indexOf(",");return n.substr(t+1)}function output(n,t,r){var a=function(){return t.toDataURL(r,n.quality)};switch(n.output){case"blob-promise":return new Promise$1(function(o,u){try{t.toBlob(function(s){s!=null?o(s):u(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,n.quality)}catch(s){u(s)}});case"blob":return b64ToBlob(b64UriToB64(a()),r);case"base64":return b64UriToB64(a());case"base64uri":default:return a()}}CRp$2.png=function(n){return output(n,this.bufferCanvasImage(n),"image/png")};CRp$2.jpg=function(n){return output(n,this.bufferCanvasImage(n),"image/jpeg")};var CRp$1={};CRp$1.nodeShapeImpl=function(n,t,r,a,o,u,s,c){switch(n){case"ellipse":return this.drawEllipsePath(t,r,a,o,u);case"polygon":return this.drawPolygonPath(t,r,a,o,u,s);case"round-polygon":return this.drawRoundPolygonPath(t,r,a,o,u,s,c);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,r,a,o,u,c);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,r,a,o,u,s,c);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,r,a,o,u,c);case"barrel":return this.drawBarrelPath(t,r,a,o,u)}};var CR=CanvasRenderer,CRp=CanvasRenderer.prototype;CRp.CANVAS_LAYERS=3;CRp.SELECT_BOX=0;CRp.DRAG=1;CRp.NODE=2;CRp.WEBGL=3;CRp.CANVAS_TYPES=["2d","2d","2d","webgl2"];CRp.BUFFER_COUNT=3;CRp.TEXTURE_BUFFER=0;CRp.MOTIONBLUR_BUFFER_NODE=1;CRp.MOTIONBLUR_BUFFER_DRAG=2;function CanvasRenderer(n){var t=this,r=t.cy.window(),a=r.document;n.webgl&&(CRp.CANVAS_LAYERS=t.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),t.data={canvases:new Array(CRp.CANVAS_LAYERS),contexts:new Array(CRp.CANVAS_LAYERS),canvasNeedsRedraw:new Array(CRp.CANVAS_LAYERS),bufferCanvases:new Array(CRp.BUFFER_COUNT),bufferContexts:new Array(CRp.CANVAS_LAYERS)};var o="-webkit-tap-highlight-color",u="rgba(0,0,0,0)";t.data.canvasContainer=a.createElement("div");var s=t.data.canvasContainer.style;t.data.canvasContainer.style[o]=u,s.position="relative",s.zIndex="0",s.overflow="hidden";var c=n.cy.container();c.appendChild(t.data.canvasContainer),c.style[o]=u;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};ms()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var d=0;d<CRp.CANVAS_LAYERS;d++){var f=t.data.canvases[d]=a.createElement("canvas"),h=CRp.CANVAS_TYPES[d];t.data.contexts[d]=f.getContext(h),t.data.contexts[d]||error("Could not create canvas of type "+h),Object.keys(l).forEach(function(ce){f.style[ce]=l[ce]}),f.style.position="absolute",f.setAttribute("data-id","layer"+d),f.style.zIndex=String(CRp.CANVAS_LAYERS-d),t.data.canvasContainer.appendChild(f),t.data.canvasNeedsRedraw[d]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[CRp.NODE].setAttribute("data-id","layer"+CRp.NODE+"-node"),t.data.canvases[CRp.SELECT_BOX].setAttribute("data-id","layer"+CRp.SELECT_BOX+"-selectbox"),t.data.canvases[CRp.DRAG].setAttribute("data-id","layer"+CRp.DRAG+"-drag"),t.data.canvases[CRp.WEBGL]&&t.data.canvases[CRp.WEBGL].setAttribute("data-id","layer"+CRp.WEBGL+"-webgl");for(var d=0;d<CRp.BUFFER_COUNT;d++)t.data.bufferCanvases[d]=a.createElement("canvas"),t.data.bufferContexts[d]=t.data.bufferCanvases[d].getContext("2d"),t.data.bufferCanvases[d].style.position="absolute",t.data.bufferCanvases[d].setAttribute("data-id","buffer"+d),t.data.bufferCanvases[d].style.zIndex=String(-d-1),t.data.bufferCanvases[d].style.visibility="hidden";t.pathsEnabled=!0;var v=makeBoundingBox(),g=function(J){return{x:(J.x1+J.x2)/2,y:(J.y1+J.y2)/2}},b=function(J){return{x:-J.w/2,y:-J.h/2}},_=function(J){var j=J[0]._private,z=j.oldBackgroundTimestamp===j.backgroundTimestamp;return!z},S=function(J){return J[0]._private.nodeKey},T=function(J){return J[0]._private.labelStyleKey},w=function(J){return J[0]._private.sourceLabelStyleKey},A=function(J){return J[0]._private.targetLabelStyleKey},R=function(J,j,z,B,U){return t.drawElement(J,j,z,!1,!1,U)},E=function(J,j,z,B,U){return t.drawElementText(J,j,z,B,"main",U)},I=function(J,j,z,B,U){return t.drawElementText(J,j,z,B,"source",U)},L=function(J,j,z,B,U){return t.drawElementText(J,j,z,B,"target",U)},F=function(J){return J.boundingBox(),J[0]._private.bodyBounds},D=function(J){return J.boundingBox(),J[0]._private.labelBounds.main||v},$=function(J){return J.boundingBox(),J[0]._private.labelBounds.source||v},O=function(J){return J.boundingBox(),J[0]._private.labelBounds.target||v},P=function(J,j){return j},C=function(J){return g(F(J))},q=function(J,j,z){var B=J?J+"-":"";return{x:j.x+z.pstyle(B+"text-margin-x").pfValue,y:j.y+z.pstyle(B+"text-margin-y").pfValue}},M=function(J,j,z){var B=J[0]._private.rscratch;return{x:B[j],y:B[z]}},N=function(J){return q("",M(J,"labelX","labelY"),J)},G=function(J){return q("source",M(J,"sourceLabelX","sourceLabelY"),J)},X=function(J){return q("target",M(J,"targetLabelX","targetLabelY"),J)},Y=function(J){return b(F(J))},W=function(J){return b($(J))},te=function(J){return b(O(J))},ue=function(J){var j=D(J),z=b(D(J));if(J.isNode()){switch(J.pstyle("text-halign").value){case"left":z.x=-j.w-(j.leftPad||0);break;case"right":z.x=-(j.rightPad||0);break}switch(J.pstyle("text-valign").value){case"top":z.y=-j.h-(j.topPad||0);break;case"bottom":z.y=-(j.botPad||0);break}}return z},fe=t.data.eleTxrCache=new ElementTextureCache(t,{getKey:S,doesEleInvalidateKey:_,drawElement:R,getBoundingBox:F,getRotationPoint:C,getRotationOffset:Y,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),re=t.data.lblTxrCache=new ElementTextureCache(t,{getKey:T,drawElement:E,getBoundingBox:D,getRotationPoint:N,getRotationOffset:ue,isVisible:P}),ye=t.data.slbTxrCache=new ElementTextureCache(t,{getKey:w,drawElement:I,getBoundingBox:$,getRotationPoint:G,getRotationOffset:W,isVisible:P}),Te=t.data.tlbTxrCache=new ElementTextureCache(t,{getKey:A,drawElement:L,getBoundingBox:O,getRotationPoint:X,getRotationOffset:te,isVisible:P}),Re=t.data.lyrTxrCache=new LayeredTextureCache(t);t.onUpdateEleCalcs(function(J,j){fe.invalidateElements(j),re.invalidateElements(j),ye.invalidateElements(j),Te.invalidateElements(j),Re.invalidateElements(j);for(var z=0;z<j.length;z++){var B=j[z]._private;B.oldBackgroundTimestamp=B.backgroundTimestamp}});var ve=function(J){for(var j=0;j<J.length;j++)Re.enqueueElementRefinement(J[j].ele)};fe.onDequeue(ve),re.onDequeue(ve),ye.onDequeue(ve),Te.onDequeue(ve),n.webgl&&t.initWebgl(n,{getStyleKey:S,getLabelKey:T,drawElement:R,drawLabel:E,getElementBox:F,getLabelBox:D,getElementRotationPoint:C,getElementRotationOffset:Y,getLabelRotationPoint:N,getLabelRotationOffset:ue})}CRp.redrawHint=function(n,t){var r=this;switch(n){case"eles":r.data.canvasNeedsRedraw[CRp.NODE]=t;break;case"drag":r.data.canvasNeedsRedraw[CRp.DRAG]=t;break;case"select":r.data.canvasNeedsRedraw[CRp.SELECT_BOX]=t;break;case"gc":r.data.gc=!0;break}};var pathsImpld=typeof Path2D<"u";CRp.path2dEnabled=function(n){if(n===void 0)return this.pathsEnabled;this.pathsEnabled=!!n};CRp.usePaths=function(){return pathsImpld&&this.pathsEnabled};CRp.setImgSmoothing=function(n,t){n.imageSmoothingEnabled!=null?n.imageSmoothingEnabled=t:(n.webkitImageSmoothingEnabled=t,n.mozImageSmoothingEnabled=t,n.msImageSmoothingEnabled=t)};CRp.getImgSmoothing=function(n){return n.imageSmoothingEnabled!=null?n.imageSmoothingEnabled:n.webkitImageSmoothingEnabled||n.mozImageSmoothingEnabled||n.msImageSmoothingEnabled};CRp.makeOffscreenCanvas=function(n,t){var r;if((typeof OffscreenCanvas>"u"?"undefined":_typeof(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(n,t);else{var a=this.cy.window(),o=a.document;r=o.createElement("canvas"),r.width=n,r.height=t}return r};[CRp$b,CRp$a,CRp$9,CRp$8,CRp$7,CRp$6,CRp$5,CRp$4,CRp$3,CRp$2,CRp$1].forEach(function(n){extend(CRp,n)});var renderer=[{name:"null",impl:NullRenderer},{name:"base",impl:BR},{name:"canvas",impl:CR}],incExts=[{type:"layout",extensions:layout$1},{type:"renderer",extensions:renderer}],extensions={},modules={};function setExtension(n,t,r){var a=r,o=function(F){warn("Can not register `"+t+"` for `"+n+"` since `"+F+"` already exists in the prototype and can not be overridden")};if(n==="core"){if(Core.prototype[t])return o(t);Core.prototype[t]=r}else if(n==="collection"){if(Collection.prototype[t])return o(t);Collection.prototype[t]=r}else if(n==="layout"){for(var u=function(F){this.options=F,r.call(this,F),plainObject(this._private)||(this._private={}),this._private.cy=F.cy,this._private.listeners=[],this.createEmitter()},s=u.prototype=Object.create(r.prototype),c=[],l=0;l<c.length;l++){var d=c[l];s[d]=s[d]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var f=r.prototype.stop;s.stop=function(){var L=this.options;if(L&&L.animate){var F=this.animations;if(F)for(var D=0;D<F.length;D++)F[D].stop()}return f?f.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var h=function(F){return F._private.cy},v={addEventFields:function(F,D){D.layout=F,D.cy=h(F),D.target=F},bubble:function(){return!0},parent:function(F){return h(F)}};extend(s,{createEmitter:function(){return this._private.emitter=new Emitter(v,this),this},emitter:function(){return this._private.emitter},on:function(F,D){return this.emitter().on(F,D),this},one:function(F,D){return this.emitter().one(F,D),this},once:function(F,D){return this.emitter().one(F,D),this},removeListener:function(F,D){return this.emitter().removeListener(F,D),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(F,D){return this.emitter().emit(F,D),this}}),define.eventAliasesOn(s),a=u}else if(n==="renderer"&&t!=="null"&&t!=="base"){var g=getExtension("renderer","base"),b=g.prototype,_=r,S=r.prototype,T=function(){g.apply(this,arguments),_.apply(this,arguments)},w=T.prototype;for(var A in b){var R=b[A],E=S[A]!=null;if(E)return o(A);w[A]=R}for(var I in S)w[I]=S[I];b.clientFunctions.forEach(function(L){w[L]=w[L]||function(){error("Renderer does not implement `renderer."+L+"()` on its prototype")}}),a=T}else if(n==="__proto__"||n==="constructor"||n==="prototype")return error(n+" is an illegal type to be registered, possibly lead to prototype pollutions");return setMap({map:extensions,keys:[n,t],value:a})}function getExtension(n,t){return getMap({map:extensions,keys:[n,t]})}function setModule(n,t,r,a,o){return setMap({map:modules,keys:[n,t,r,a],value:o})}function getModule(n,t,r,a){return getMap({map:modules,keys:[n,t,r,a]})}var extension=function(){if(arguments.length===2)return getExtension.apply(null,arguments);if(arguments.length===3)return setExtension.apply(null,arguments);if(arguments.length===4)return getModule.apply(null,arguments);if(arguments.length===5)return setModule.apply(null,arguments);error("Invalid extension access syntax")};Core.prototype.extension=extension;incExts.forEach(function(n){n.extensions.forEach(function(t){setExtension(n.type,t.name,t.impl)})});var Stylesheet=function n(){if(!(this instanceof n))return new n;this.length=0},sheetfn=Stylesheet.prototype;sheetfn.instanceString=function(){return"stylesheet"};sheetfn.selector=function(n){var t=this.length++;return this[t]={selector:n,properties:[]},this};sheetfn.css=function(n,t){var r=this.length-1;if(string(n))this[r].properties.push({name:n,value:t});else if(plainObject(n))for(var a=n,o=Object.keys(a),u=0;u<o.length;u++){var s=o[u],c=a[s];if(c!=null){var l=Style.properties[s]||Style.properties[dash2camel(s)];if(l!=null){var d=l.name,f=c;this[r].properties.push({name:d,value:f})}}}return this};sheetfn.style=sheetfn.css;sheetfn.generateStyle=function(n){var t=new Style(n);return this.appendToStyle(t)};sheetfn.appendToStyle=function(n){for(var t=0;t<this.length;t++){var r=this[t],a=r.selector,o=r.properties;n.selector(a);for(var u=0;u<o.length;u++){var s=o[u];n.css(s.name,s.value)}}return n};var version="3.31.0",cytoscape$1=function(t){if(t===void 0&&(t={}),plainObject(t))return new Core(t);if(string(t))return extension.apply(extension,arguments)};cytoscape$1.use=function(n){var t=Array.prototype.slice.call(arguments,1);return t.unshift(cytoscape$1),n.apply(null,t),this};cytoscape$1.warnings=function(n){return warnings(n)};cytoscape$1.version=version;cytoscape$1.stylesheet=cytoscape$1.Stylesheet=Stylesheet;const cytoscapeConfig={style:[{selector:"node",style:{"border-color":"black","border-width":"1px"}},{selector:"node[type='class']",style:{shape:"roundrectangle","background-color":"data(color)",label:"data(label)",width:60,height:40,"text-valign":"center","text-halign":"center"}},{selector:"node[type='individual']",style:{shape:"rectangle","background-color":"data(color)",label:"data(label)",width:35,height:35,"text-valign":"center","text-halign":"center"}},{selector:"node[type='dt-property']",style:{shape:"ellipse","background-color":"data(color)",label:"data(label)",width:25,height:25,"text-valign":"top","text-halign":"center"}},{selector:"node[type='composition']",style:{shape:"diamond","background-color":"data(color)",label:"data(label)",width:50,height:50,"text-valign":"center","text-halign":"center"}},{selector:"node[type='collection']",style:{shape:"pentagon","background-color":"data(color)",label:"data(label)",width:50,height:50,"text-valign":"center","text-halign":"center"}},{selector:"node:selected",style:{"background-color":"#C9E9D2","border-width":3,"border-color":"#578E7E"}},{selector:"edge",style:{width:6,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"triangle","curve-style":"bezier",label:"data(label)","font-size":12}},{selector:"edge[type='connection']",style:{width:3,"line-color":"data(color)","curve-style":"bezier","target-arrow-shape":"none","source-arrow-shape":"none",label:"data(label)","font-size":12,"source-label":"data(sourcelabel)","target-label":"data(targetlabel)","source-text-offset":25,"target-text-offset":25,"source-text-rotation":"autorotate","target-text-rotation":"autorotate"}},{selector:"edge[type='type']",style:{width:3,"line-color":"data(color)","curve-style":"bezier","target-arrow-shape":"circle","source-arrow-shape":"none",label:"data(label)","font-size":12,"source-label":"data(sourcelabel)","target-label":"data(targetlabel)","source-text-offset":25,"target-text-offset":25,"source-text-rotation":"autorotate","target-text-rotation":"autorotate"}},{selector:"edge[type='compose']",style:{width:3,"line-color":"data(color)","line-style":"dashed","curve-style":"bezier","target-arrow-shape":"none",label:"data(label)","font-size":12}},{selector:"edge[type='subclass']",style:{width:3,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"triangle","arrow-scale":1.5,"target-arrow-fill":"hollow","curve-style":"bezier",label:"data(label)","font-size":12}},{selector:"edge[type='equivalent']",style:{width:3,"line-color":"data(color)","source-arrow-color":"data(color)","source-arrow-shape":"triangle","source-arrow-fill":"hollow","target-arrow-color":"data(color)","target-arrow-shape":"triangle","arrow-scale":1.5,"target-arrow-fill":"hollow","curve-style":"bezier",label:"data(label)","font-size":12}},{selector:"edge[type='property']",style:{width:3,"line-color":"data(color)","target-arrow-color":"data(color)","target-arrow-shape":"vee","target-arrow-fill":"filled","curve-style":"bezier",label:"data(label)","font-size":12,"source-label":"data(sourcelabel)","target-label":"data(targetlabel)","source-text-offset":25,"target-text-offset":25,"source-text-rotation":"autorotate","target-text-rotation":"autorotate"}}],layout:{name:"cola",animate:!0,refresh:1,maxSimulationTime:5e3,ungrabifyWhileSimulating:!1,fit:!1,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,ready:function(){},stop:function(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,convergenceThreshold:.01,nodeSpacing:function(n){return 50},flow:void 0,alignment:void 0,gapInequalities:void 0,centerGraph:!0,edgeLength:150,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0}},nodeTypes=[{id:"class",label:"Class",description:"Una classe  un concetto astratto che rappresenta un insieme di entit con caratteristiche comuni",color:"#FFFFFF",icon:"square.svg"},{id:"individual",label:"Individual",color:"#B17457",icon:"square.svg"},{id:"dt-property",label:"Attribute",color:"#C1D8C3",icon:"circle.svg"},{id:"composition",label:"Coposition",color:"#6A9C89",icon:"rhombus.svg"},{id:"collection",label:"Collection",color:"#9CB1D0",icon:"pentagon.svg"}],toolTypes=[{id:"search",label:"Search",color:"#bbbbbb",icon:"search.svg",onclick:"(event) => {toggleSearch()}"},{id:"fit",label:"Fit",color:"#bbbbbb",icon:"fittoscreen.svg",onclick:"(event) => {cyInstance.fit()}"},{id:"layout",label:"Layout",color:"#bbbbbb",icon:"layout.svg",onclick:"(event) => {reLayout(cyInstance)}"},{id:"delete",label:"Delete",color:"#bbbbbb",icon:"delete.svg",onclick:"(event) => {deleteSelectedNodes(cyInstance)}"},{id:"save",label:"Save",color:"#bbbbbb",icon:"file-download.svg",onclick:"(event) => {saveGraphData(cyInstance)}"},{id:"load",label:"Load",color:"#bbbbbb",icon:"file-upload.svg",onclick:"(event) => {loadGraphData(cyInstance)}"},{id:"owlexp",label:"OWL export",color:"#bbbbbb",icon:"owlexp.svg",onclick:"(event) => {console.log(cytoscape2OWL(cyInstance))}"},{id:"owlimp",label:"OWL import",color:"#bbbbbb",icon:"owlimp.svg",onclick:"(event) => importOwl(cyInstance)"}];function getEdgeTypes(){let n=/edge\[type='(.*?)']/,t=cytoscapeConfig.style.map(r=>{var a;return r.selector.match(n)!=null?(a=r.selector.match(n))==null?void 0:a[1]:""});return t=t.filter(r=>r.length>0),t}function computeNodeFlags(n){return{class:[],individual:[],"dt-property":["functional"],composition:[]}[n]||[]}function computeEdgeFlags(n,t,r){let a=n;return n==="property"&&(a=`${n}-${t}-${r}`),{subclass:[],equivalent:[],"property-class-class":["Fucntional","Inverse","Asymmetric","Irreflexive","Reflexive","Symmetric","Transitive"],compose:[],connectiom:[]}[a]||[]}function isNodeAllowedDomains(n){return{class:!0,individual:!0,"dt-property":!0,composition:!1}[n]||!1}function isEdgeAllowedDomains(n){return{subclass:!1,equivalent:!1,property:!0,compose:!1,connection:!1,type:!1}[n]||!1}function isNodeAllowedRestrictions(n){return{class:null,individual:null,composition:null,"dt-property":{domain:{type:["Existential:exists"],relationship:["Inclusion","Equivalence"]},range:{datatype:["unknown","string","boolean","float","double","integer","dateTime","date","time"]}}}[n]||null}function isEdgeTypeAllowedRestrictions(n){return{subclass:null,equivalent:null,compose:null,connection:null,type:null,"property-individual-individual":null,"property-class-class":{domain:{type:["Existential:exists","Universal:forall","Cardinality:min,max","Self:self"],relationship:["Inclusion","Equivalence","Restriction"]},range:{type:["Existential:exists","Universal:forall","Cardinality:min,max","Self:self"],relationship:["Inclusion","Equivalence","Restriction"]}}}[n]||null}function isEdgeAllowedRestrictions(n){let t=n.data("type");if(t=="property"){let r=n.source().data("type"),a=n.target().data("type");r=="class"&&a=="class"?t="property-class-class":r=="individual"&&a=="individual"&&(t="property-individual-individual")}return isEdgeTypeAllowedRestrictions(t)}const domains=[{id:"myonto",uri:"http://local/onto/myonto#",color:"#FFFFFF",description:"ontologia di prova",local:!0,visible:!0},{id:"mytax",uri:"http://local/taxonomy/mytax#",color:"#2222ee",description:"tassonomia di prova",local:!1,visible:!0},{id:"rdfs",uri:"http://www.w3.org/2000/01/rdf-schema#",color:"#FF0000",description:"RDF Schema",local:!1,visible:!1},{id:"owl",uri:"http://www.w3.org/2002/07/owl#",color:"#FF0000",description:"OWL ontology language",local:!1,visible:!1},{id:"rdf",uri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",color:"#FF0000",description:"RDF framework",local:!1,visible:!1},{id:"xsd",uri:"http://www.w3.org/2001/XMLSchema#",color:"#FF0000",description:"XML Schema",local:!1,visible:!1}],compositionOps=["xor","or","and"],collectionOps=["oneof"];function getAllowedEdgeTypes(n,t,r){let a=n;return(n==="property"||n==="subclass"||n==="equivalent")&&(a=`${n}-${t}-${r}`),{"subclass-class-composition":["subclass","equivalent"],"equivalent-composition-class":["subclass","equivalent"],"subclass-composition-class":["subclass","equivalent"],"equivalent-class-composition":["subclass","equivalent"],"subclass-class-collection":["subclass","equivalent"],"equivalent-collection-class":["subclass","equivalent"],"subclass-collection-class":["subclass","equivalent"],"equivalent-class-collection":["subclass","equivalent"],"subclass-class-class":["subclass","equivalent","property"],"equivalent-class-class":["subclass","equivalent","property"],"property-class-class":["subclass","equivalent","property"],"property-individual-individual":["property"],compose:["compose","subclass","equivalent"],connection:["connection"],type:["type"],"":["subclass","equivalent","property","compose","connection","type"]}[a]||[]}function computeEdgeType(n,t){const r={"class-individual":{},"individual-class":{type:"type",label:"type"},"class-class":{type:"subclass",label:""},"class-dt-property":{type:"connection",label:""},"dt-property-class":{},"class-composition":{type:"compose",label:""},"individual-individual":{type:"property",label:""},"individual-collection":{type:"compose",label:""},"class-collection":{type:"subclass",label:""}};let a={};const o=n.data("type"),u=t.data("type"),s=`${o}-${u}`;let c=r[s];return c&&c.type?a=c:a=null,a}const config={cytoscapeConfig,toolTypes,nodeTypes};var root_3$2=template("<option> </option>"),root_1$3=template('<div class="duecolonne svelte-nl3uvs"><label class="labeled-input svelte-nl3uvs"><span class="svelte-nl3uvs">Domain:</span> <select></select></label></div>'),root_4$2=template('<div class="duecolonne svelte-nl3uvs"><label class="labeled-input svelte-nl3uvs"><span class="svelte-nl3uvs">Name:</span> <input type="text" class="svelte-nl3uvs"></label></div>'),root_6$1=template("<option> </option>"),root_5$2=template('<span class="svelte-nl3uvs">Composition:</span> <select></select>',1),root_9$2=template("<option> </option>"),root_8$1=template('<span class="svelte-nl3uvs">Collection:</span> <select></select>',1),root_10$1=template('<span class="svelte-nl3uvs">Label:</span> <input type="text" class="svelte-nl3uvs">',1),root_12$2=template('<div class="column svelte-nl3uvs"><input type="checkbox"> </div>'),root_11$2=template('<fieldset class="duecolonne svelte-nl3uvs"><legend class="svelte-nl3uvs">Flags</legend> <div id="flags" class="flags svelte-nl3uvs"></div></fieldset>'),root_15$1=template("<option> </option>"),root_16$1=template("<option> </option>"),root_14=template('<fieldset><legend class="svelte-nl3uvs">Domain Restrictions</legend> <span>Restiction Type</span> <select></select> <br> <span>Domain Relationship</span> <select></select></fieldset> <fieldset><legend class="svelte-nl3uvs">values</legend> <input type="number" min="0" step="1" id="min" style="width: 50%;" placeholder="min"> <input type="number" min="0" step="1" id="max" style="width: 50%;" placeholder="max"></fieldset>',1),root_19=template("<option> </option>"),root_18$1=template('<fieldset class="duecolonne svelte-nl3uvs"><legend class="svelte-nl3uvs">Range Restrictions</legend> <span>Attribute Datatype</span> <select></select></fieldset>'),root_20=template('<fieldset><legend class="svelte-nl3uvs">Range Restrictions</legend></fieldset>'),root_13$1=template("<!> <!>",1),root$4=template('<main><div class="modal-overlay svelte-nl3uvs"><div class="editor constraint svelte-nl3uvs"><!> <!> <div class="duecolonne svelte-nl3uvs"><label class="labeled-input svelte-nl3uvs"><!></label> <label class="labeled-input svelte-nl3uvs"><span class="svelte-nl3uvs">Description:</span> <textarea rows="3" class="svelte-nl3uvs"></textarea></label></div> <!> <!> <div class="duecolonne svelte-nl3uvs"><label class="labeled-input svelte-nl3uvs"><span class="svelte-nl3uvs">Color:</span> <input type="color" class="svelte-nl3uvs"></label> <div class="button-group svelte-nl3uvs"><button class="button-save svelte-nl3uvs">Save</button> <button class="button-delete svelte-nl3uvs">Delete</button> <button class="button-close svelte-nl3uvs">Close</button></div></div></div></div></main>');function NodeEditor(n,t){push$2(t,!1);const[r,a]=setup_stores(),o=()=>store_get(nodeFlags,"$nodeFlags",r),u=()=>store_get(nodeRestrictions,"$nodeRestrictions",r),s=()=>store_get(selectedNode,"$selectedNode",r),c=()=>store_get(nodeLabel,"$nodeLabel",r),l=()=>store_get(nodeName,"$nodeName",r),d=()=>store_get(nodeDescription,"$nodeDescription",r),f=()=>store_get(nodeColor,"$nodeColor",r),h=()=>store_get(nodeDomain,"$nodeDomain",r),v=()=>store_get(nodeType,"$nodeType",r),g=()=>store_get(data$2,"$data",r);let b=prop(t,"addDoc",8),_=prop(t,"delDoc",8),S=mutable_state(),T=mutable_state(),w=mutable_state(!1);function A(){console.log("UPDATE NODE"),N(),O(),C(),M(),store_set(nodeFlags,get$4(S)),store_set(nodeRestrictions,get$4(T)),selectedNode&&(s().data({label:c(),name:l(),description:d(),color:f(),domain:h(),flags:o(),restrictions:u()}),store_set(showNodeEditor,!1),b()(s().data()),v()==="dt-property"&&(console.log("salvo la lebel della connessione:",R(),E()),s().connectedEdges()[0].data("sourcelabel",R()),s().connectedEdges()[0].data("targetlabel",E())))}function R(){let me=Object.keys(u().domain.relationship).filter(Pe=>u().domain.relationship[Pe]),Ie=Object.keys(u().domain.type).filter(Pe=>u().domain.type[Pe]);return Ie.length>0&&me.length>0?(Ie=Ie[0].split(":"),Ie[1]==="min,max"?u().domain.min+","+u().domain.max+" ("+me[0].substring(0,1)+")":Ie[1]+" ("+me[0].substring(0,1)+")"):""}function E(){let me=Object.keys(u().range.datatype).filter(Ie=>u().range.datatype[Ie]);return me.length>0?me[0]:""}function I(){if(s()&&confirm("Sei sicuro di voler eliminare il nodo selezionato?")){const me=s().id();_()(s().data()),s().remove(),store_mutate(data$2,untrack(g).nodes=g().nodes.filter(Ie=>Ie.data.id!==me),untrack(g)),L(),store_set(selectedNode,null),store_set(selectedSourceNode,null)}}function L(){store_set(showNodeEditor,!1)}function F(){let me=domains.filter(Ie=>Ie.id===h());me.length>0&&store_set(nodeColor,me[0].color)}function D(){if(set$4(S,{...o()}),u()!=null?set$4(T,JSON.parse(JSON.stringify(u()))):set$4(T,null),get$4(S)==null||Object.keys(get$4(S)).length==0){let me={};computeNodeFlags(s().data("type")).forEach(Pe=>me[Pe]=!1),set$4(S,me)}get$4(T)==null||Object.keys(get$4(T)).length==0?set$4(T,{domain:{type:{},relationship:{},min:0,max:0},range:{datatype:{}}}):(set$4(P,Object.keys(get$4(T).domain.relationship).filter(me=>get$4(T).domain.relationship[me])[0]),set$4($,Object.keys(get$4(T).domain.type).filter(me=>get$4(T).domain.type[me])[0]),set$4(q,Object.keys(get$4(T).range.datatype).filter(me=>get$4(T).range.datatype[me])[0])),O(),C(),M()}let $=mutable_state();function O(){let me=isNodeAllowedRestrictions(v());me&&(me.domain.type.forEach(Pe=>{Pe==get$4($)?(set$4(w,Pe==="Cardinality:min,max"),mutate(T,get$4(T).domain.type[Pe]=!0)):mutate(T,get$4(T).domain.type[Pe]=!1)}),get$4(w)||(mutate(T,get$4(T).domain.min=0),mutate(T,get$4(T).domain.max=0)))}let P=mutable_state();function C(){let me=isNodeAllowedRestrictions(v());me&&me.domain.relationship.forEach(Pe=>{Pe==get$4(P)?mutate(T,get$4(T).domain.relationship[Pe]=!0):mutate(T,get$4(T).domain.relationship[Pe]=!1)})}let q=mutable_state();function M(){let me=isNodeAllowedRestrictions(v());me&&me.range.datatype.forEach(Pe=>{Pe==get$4(q)?mutate(T,get$4(T).range.datatype[Pe]=!0):mutate(T,get$4(T).range.datatype[Pe]=!1)})}function N(){s().data("type")!="composition"&&s().data("type")!="collection"}legacy_pre_effect(()=>showNodeEditor,()=>{showNodeEditor&&D()}),legacy_pre_effect_reset(),init$2();var G=root$4(),X=child(G),Y=child(X),W=child(Y);{var te=me=>{var Ie=root_1$3(),Pe=child(Ie),Ce=sibling(child(Pe),2);template_effect(()=>{h(),invalidate_inner_signals(()=>{})}),each$g(Ce,5,()=>domains,index,(pe,H)=>{var V=comment(),Q=first_child(V);{var ee=ae=>{var be=root_3$2(),le={},we=child(be);template_effect(()=>{le!==(le=get$4(H).id)&&(be.value=(be.__value=get$4(H).id)==null?"":get$4(H).id),set_text(we,get$4(H).description)}),append(ae,be)};if_block(Q,ae=>{get$4(H).visible&&ae(ee)})}append(pe,V)}),bind_select_value(Ce,h,pe=>store_set(nodeDomain,pe)),event$1("change",Ce,F),append(me,Ie)};if_block(W,me=>{isNodeAllowedDomains(s().data("type"))&&me(te)})}var ue=sibling(W,2);{var fe=me=>{var Ie=root_4$2(),Pe=child(Ie),Ce=sibling(child(Pe),2);bind_value(Ce,l,pe=>store_set(nodeName,pe)),append(me,Ie)};if_block(ue,me=>{s()&&s().data("type")!="composition"&&s().data("type")!="collection"&&me(fe)})}var re=sibling(ue,2),ye=child(re),Te=child(ye);{var Re=me=>{var Ie=root_5$2(),Pe=sibling(first_child(Ie),2);template_effect(()=>{c(),invalidate_inner_signals(()=>{})}),each$g(Pe,5,()=>compositionOps,index,(Ce,pe)=>{var H=root_6$1(),V={},Q=child(H);template_effect(()=>{V!==(V=get$4(pe))&&(H.value=(H.__value=get$4(pe))==null?"":get$4(pe)),set_text(Q,get$4(pe))}),append(Ce,H)}),bind_select_value(Pe,c,Ce=>store_set(nodeLabel,Ce)),append(me,Ie)},ve=me=>{var Ie=comment(),Pe=first_child(Ie);{var Ce=H=>{var V=root_8$1(),Q=sibling(first_child(V),2);template_effect(()=>{c(),invalidate_inner_signals(()=>{})}),each$g(Q,5,()=>collectionOps,index,(ee,ae)=>{var be=root_9$2(),le={},we=child(be);template_effect(()=>{le!==(le=get$4(ae))&&(be.value=(be.__value=get$4(ae))==null?"":get$4(ae)),set_text(we,get$4(ae))}),append(ee,be)}),bind_select_value(Q,c,ee=>store_set(nodeLabel,ee)),append(H,V)},pe=H=>{var V=root_10$1(),Q=sibling(first_child(V),2);bind_value(Q,c,ee=>store_set(nodeLabel,ee)),event$1("change",Q,N),append(H,V)};if_block(Pe,H=>{s()&&s().data("type")==="collection"?H(Ce):H(pe,!1)},!0)}append(me,Ie)};if_block(Te,me=>{s()&&s().data("type")==="composition"?me(Re):me(ve,!1)})}var ce=sibling(ye,2),J=sibling(child(ce),2),j=sibling(re,2);{var z=me=>{var Ie=root_11$2(),Pe=sibling(child(Ie),2);each$g(Pe,5,()=>Object.keys(get$4(S)),index,(Ce,pe)=>{var H=root_12$2(),V=child(H),Q=sibling(V,1,!0);template_effect(()=>set_text(Q,get$4(pe))),bind_checked(V,()=>get$4(S)[get$4(pe)],ee=>mutate(S,get$4(S)[get$4(pe)]=ee)),append(Ce,H)}),append(me,Ie)};if_block(j,me=>{get$4(S)&&Object.keys(get$4(S)).length>0&&me(z)})}var B=sibling(j,2);{var U=me=>{var Ie=root_13$1(),Pe=first_child(Ie);{var Ce=V=>{var Q=root_14(),ee=first_child(Q),ae=sibling(child(ee),4);template_effect(()=>{get$4($),invalidate_inner_signals(()=>{v(),get$4(T)})}),each$g(ae,5,()=>isNodeAllowedRestrictions(v()).domain.type,index,(Fe,Ne)=>{var de=root_15$1(),Le={},$e=child(de);template_effect(()=>{Le!==(Le=get$4(Ne))&&(de.value=(de.__value=get$4(Ne))==null?"":get$4(Ne)),set_selected(de,get$4(T).domain.type[get$4(Ne)]===!0),set_text($e,get$4(Ne))}),append(Fe,de)});var be=sibling(ae,6);template_effect(()=>{get$4(P),invalidate_inner_signals(()=>{v(),get$4(T)})}),each$g(be,5,()=>isNodeAllowedRestrictions(v()).domain.relationship,index,(Fe,Ne)=>{var de=root_16$1(),Le={},$e=child(de);template_effect(()=>{Le!==(Le=get$4(Ne))&&(de.value=(de.__value=get$4(Ne))==null?"":get$4(Ne)),set_selected(de,get$4(T).domain.relationship[get$4(Ne)]===!0),set_text($e,get$4(Ne))}),append(Fe,de)});var le=sibling(ee,2),we=sibling(child(le),2),De=sibling(we,2);template_effect(()=>{we.disabled=!get$4(w),De.disabled=!get$4(w)}),bind_select_value(ae,()=>get$4($),Fe=>set$4($,Fe)),event$1("change",ae,O),bind_select_value(be,()=>get$4(P),Fe=>set$4(P,Fe)),event$1("change",be,C),bind_value(we,()=>get$4(T).domain.min,Fe=>mutate(T,get$4(T).domain.min=Fe)),bind_value(De,()=>get$4(T).domain.max,Fe=>mutate(T,get$4(T).domain.max=Fe)),append(V,Q)};if_block(Pe,V=>{isNodeAllowedRestrictions(v()).domain!=null&&V(Ce)})}var pe=sibling(Pe,2);{var H=V=>{var Q=comment(),ee=first_child(Q);{var ae=le=>{var we=root_18$1(),De=sibling(child(we),4);template_effect(()=>{get$4(q),invalidate_inner_signals(()=>{v(),get$4(T)})}),each$g(De,5,()=>isNodeAllowedRestrictions(v()).range.datatype,index,(Fe,Ne)=>{var de=root_19(),Le={},$e=child(de);template_effect(()=>{Le!==(Le=get$4(Ne))&&(de.value=(de.__value=get$4(Ne))==null?"":get$4(Ne)),set_selected(de,get$4(T).range.datatype[get$4(Ne)]===!0),set_text($e,get$4(Ne))}),append(Fe,de)}),bind_select_value(De,()=>get$4(q),Fe=>set$4(q,Fe)),event$1("change",De,M),append(le,we)},be=le=>{var we=root_20();append(le,we)};if_block(ee,le=>{isNodeAllowedRestrictions(v()).range.datatype!=null?le(ae):le(be,!1)})}append(V,Q)};if_block(pe,V=>{isNodeAllowedRestrictions(v()).range!=null&&V(H)})}append(me,Ie)};if_block(B,me=>{isNodeAllowedRestrictions(v())!=null&&me(U)})}var Z=sibling(B,2),oe=child(Z),ie=sibling(child(oe),2),se=sibling(oe,2),ne=child(se),he=sibling(ne,2),xe=sibling(he,2);bind_value(J,d,me=>store_set(nodeDescription,me)),bind_value(ie,f,me=>store_set(nodeColor,me)),event$1("click",ne,A),event$1("click",he,I),event$1("click",xe,L),append(n,G),pop$1(),a()}var root_3$1=template('<td class="tooltip svelte-171zk95"> <span class="tooltiptext svelte-171zk95"> </span></td>'),root_4$1=template("<td> </td>"),root_5$1=template('<img src="square.svg" width="20" alt="" class="svelte-171zk95">'),root_7$1=template('<img src="circle.svg" width="20" alt="" class="svelte-171zk95">'),root_9$1=template('<img src="rhombus.svg" width="20" alt="" class="svelte-171zk95">'),root_11$1=template('<img src="pentagon.svg" width="20" alt="" class="svelte-171zk95">'),root_12$1=template('<img src="arrow.svg" width="20" alt="" class="svelte-171zk95">'),root_2$1=template('<tr class="svelte-171zk95"><!><td style="width:10%"><button><!></button></td></tr>'),root_1$2=template('<div class="button-group duecolonne svelte-171zk95"><table class="svelte-171zk95"><tbody></tbody></table></div>'),root$3=template('<main><div class="modal-overlay svelte-171zk95"><div class="editor svelte-171zk95"><div class="duecolonne svelte-171zk95"><label class="labeled-input svelte-171zk95"><span class="svelte-171zk95">Cerca</span> <input type="text" class="svelte-171zk95"></label></div> <!> <div class="button-group duecolonne svelte-171zk95"><button class="button-search svelte-171zk95">Search</button> <button class="button-close svelte-171zk95">Close</button></div></div></div></main>');function SearchEditor(n,t){push$2(t,!1);const[r,a]=setup_stores(),o=()=>store_get(searchDocuments,"$searchDocuments",r);let u=prop(t,"centerNode",8),s=prop(t,"searchDoc",8);onMount(()=>{console.log("SearchEditor, documents:",o().length),get$4(h).focus()});function c(){store_set(showSearchEditor,!1)}const l=30;let d=mutable_state(),f=mutable_state(),h=mutable_state();init$2();var v=root$3(),g=child(v),b=child(g),_=child(b),S=child(_),T=sibling(child(S),2);bind_this(T,L=>set$4(h,L),()=>get$4(h));var w=sibling(_,2);{var A=L=>{var F=root_1$2(),D=child(F),$=child(D);each$g($,5,()=>get$4(f),index,(O,P)=>{var C=root_2$1(),q=child(C);{var M=ue=>{var fe=root_3$1(),re=child(fe),ye=sibling(re),Te=child(ye);template_effect(Re=>{set_text(re,`${Re??""} `),set_text(Te,get$4(P).label)},[()=>get$4(P).label.substring(0,l)+"..."],derived_safe_equal),append(ue,fe)},N=ue=>{var fe=root_4$1(),re=child(fe);template_effect(()=>set_text(re,get$4(P).label)),append(ue,fe)};if_block(q,ue=>{get$4(P).label.length>l?ue(M):ue(N,!1)})}var G=sibling(q),X=child(G),Y=child(X);{var W=ue=>{var fe=root_5$1();append(ue,fe)},te=ue=>{var fe=comment(),re=first_child(fe);{var ye=Re=>{var ve=root_7$1();append(Re,ve)},Te=Re=>{var ve=comment(),ce=first_child(ve);{var J=z=>{var B=root_9$1();append(z,B)},j=z=>{var B=comment(),U=first_child(B);{var Z=ie=>{var se=root_11$1();append(ie,se)},oe=ie=>{var se=root_12$1();append(ie,se)};if_block(U,ie=>{get$4(P).type=="collection"?ie(Z):ie(oe,!1)},!0)}append(z,B)};if_block(ce,z=>{get$4(P).type=="composition"?z(J):z(j,!1)},!0)}append(Re,ve)};if_block(re,Re=>{get$4(P).type=="dt-property"?Re(ye):Re(Te,!1)},!0)}append(ue,fe)};if_block(Y,ue=>{get$4(P).type=="class"||get$4(P).type=="individual"?ue(W):ue(te,!1)})}event$1("click",X,ue=>u()(get$4(P).id)),append(O,C)}),append(L,F)};if_block(w,L=>{get$4(f)&&get$4(f).length>0&&L(A)})}var R=sibling(w,2),E=child(R),I=sibling(E,2);bind_value(T,()=>get$4(d),L=>set$4(d,L)),event$1("keydown",T,L=>{L.key==="Enter"&&get$4(d)&&set$4(f,s()(get$4(d)))}),event$1("click",E,()=>{get$4(d)&&set$4(f,s()(get$4(d)))}),event$1("click",I,c),append(n,v),pop$1(),a()}let Store$1=class{async storeLoad(t,r){const a=new N3Parser;let o=0;return new Promise((u,s)=>{a.parse(r,async(c,l,d)=>{l?(t.addQuad(l),o++):c?(console.log("ERROR",c),s(c)):(console.log("parsing done."),console.log("storing done, quads:",o),u(o))})})}async executeStoreQuery(t,r){const o=await new indexBrowserExports.QueryEngine().queryBindings(t,{sources:[r]});try{const u=await Array.fromAsync(o);return{count:u.length,bindings:u}}catch(u){throw console.error(u),u}}getResultSet(t){let r=[];for(let a=0;a<t.length;a++){let o={};for(const[u,s]of t[a]){let c;s instanceof Literal?c=s.id.replaceAll('"',""):s instanceof NamedNode?c=s.id:c=s.value,o[u.value]=c}r.push(o)}return r}};const storeInstance=new Store$1;storeInstance.getResultSet.bind(storeInstance);storeInstance.executeStoreQuery.bind(storeInstance);storeInstance.storeLoad.bind(storeInstance);const{DataFactory,Parser,Store}=N3,{namedNode,literal,quad}=DataFactory,ENTRIES="ENTRIES",KEYS="KEYS",VALUES="VALUES",LEAF="";class TreeIterator{constructor(t,r){const a=t._tree,o=Array.from(a.keys());this.set=t,this._type=r,this._path=o.length>0?[{node:a,keys:o}]:[]}next(){const t=this.dive();return this.backtrack(),t}dive(){if(this._path.length===0)return{done:!0,value:void 0};const{node:t,keys:r}=last$1(this._path);if(last$1(r)===LEAF)return{done:!1,value:this.result()};const a=t.get(last$1(r));return this._path.push({node:a,keys:Array.from(a.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;const t=last$1(this._path).keys;t.pop(),!(t.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:t})=>last$1(t)).filter(t=>t!==LEAF).join("")}value(){return last$1(this._path).node.get(LEAF)}result(){switch(this._type){case VALUES:return this.value();case KEYS:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}}const last$1=n=>n[n.length-1],fuzzySearch=(n,t,r)=>{const a=new Map;if(t===void 0)return a;const o=t.length+1,u=o+r,s=new Uint8Array(u*o).fill(r+1);for(let c=0;c<o;++c)s[c]=c;for(let c=1;c<u;++c)s[c*o]=c;return recurse(n,t,r,a,s,1,o,""),a},recurse=(n,t,r,a,o,u,s,c)=>{const l=u*s;e:for(const d of n.keys())if(d===LEAF){const f=o[l-1];f<=r&&a.set(c,[n.get(d),f])}else{let f=u;for(let h=0;h<d.length;++h,++f){const v=d[h],g=s*f,b=g-s;let _=o[g];const S=Math.max(0,f-r-1),T=Math.min(s-1,f+r);for(let w=S;w<T;++w){const A=v!==t[w],R=o[b+w]+ +A,E=o[b+w+1]+1,I=o[g+w]+1,L=o[g+w+1]=Math.min(R,E,I);L<_&&(_=L)}if(_>r)continue e}recurse(n.get(d),t,r,a,o,f,s,c+d)}};class SearchableMap{constructor(t=new Map,r=""){this._size=void 0,this._tree=t,this._prefix=r}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");const[r,a]=trackDown(this._tree,t.slice(this._prefix.length));if(r===void 0){const[o,u]=last(a);for(const s of o.keys())if(s!==LEAF&&s.startsWith(u)){const c=new Map;return c.set(s.slice(u.length),o.get(s)),new SearchableMap(c,t)}}return new SearchableMap(r,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,remove(this._tree,t)}entries(){return new TreeIterator(this,ENTRIES)}forEach(t){for(const[r,a]of this)t(r,a,this)}fuzzyGet(t,r){return fuzzySearch(this._tree,t,r)}get(t){const r=lookup(this._tree,t);return r!==void 0?r.get(LEAF):void 0}has(t){const r=lookup(this._tree,t);return r!==void 0&&r.has(LEAF)}keys(){return new TreeIterator(this,KEYS)}set(t,r){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,createPath(this._tree,t).set(LEAF,r),this}get size(){if(this._size)return this._size;this._size=0;const t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,r){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const a=createPath(this._tree,t);return a.set(LEAF,r(a.get(LEAF))),this}fetch(t,r){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const a=createPath(this._tree,t);let o=a.get(LEAF);return o===void 0&&a.set(LEAF,o=r()),o}values(){return new TreeIterator(this,VALUES)}[Symbol.iterator](){return this.entries()}static from(t){const r=new SearchableMap;for(const[a,o]of t)r.set(a,o);return r}static fromObject(t){return SearchableMap.from(Object.entries(t))}}const trackDown=(n,t,r=[])=>{if(t.length===0||n==null)return[n,r];for(const a of n.keys())if(a!==LEAF&&t.startsWith(a))return r.push([n,a]),trackDown(n.get(a),t.slice(a.length),r);return r.push([n,t]),trackDown(void 0,"",r)},lookup=(n,t)=>{if(t.length===0||n==null)return n;for(const r of n.keys())if(r!==LEAF&&t.startsWith(r))return lookup(n.get(r),t.slice(r.length))},createPath=(n,t)=>{const r=t.length;e:for(let a=0;n&&a<r;){for(const u of n.keys())if(u!==LEAF&&t[a]===u[0]){const s=Math.min(r-a,u.length);let c=1;for(;c<s&&t[a+c]===u[c];)++c;const l=n.get(u);if(c===u.length)n=l;else{const d=new Map;d.set(u.slice(c),l),n.set(t.slice(a,a+c),d),n.delete(u),n=d}a+=c;continue e}const o=new Map;return n.set(t.slice(a),o),o}return n},remove=(n,t)=>{const[r,a]=trackDown(n,t);if(r!==void 0){if(r.delete(LEAF),r.size===0)cleanup(a);else if(r.size===1){const[o,u]=r.entries().next().value;merge(a,o,u)}}},cleanup=n=>{if(n.length===0)return;const[t,r]=last(n);if(t.delete(r),t.size===0)cleanup(n.slice(0,-1));else if(t.size===1){const[a,o]=t.entries().next().value;a!==LEAF&&merge(n.slice(0,-1),a,o)}},merge=(n,t,r)=>{if(n.length===0)return;const[a,o]=last(n);a.set(o+t,r),a.delete(o)},last=n=>n[n.length-1],OR="or",AND="and",AND_NOT="and_not";class MiniSearch{constructor(t){if((t==null?void 0:t.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');const r=t.autoVacuum==null||t.autoVacuum===!0?defaultAutoVacuumOptions:t.autoVacuum;this._options={...defaultOptions,...t,autoVacuum:r,searchOptions:{...defaultSearchOptions,...t.searchOptions||{}},autoSuggestOptions:{...defaultAutoSuggestOptions,...t.autoSuggestOptions||{}}},this._index=new SearchableMap,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=defaultVacuumConditions,this.addFields(this._options.fields)}add(t){const{extractField:r,tokenize:a,processTerm:o,fields:u,idField:s}=this._options,c=r(t,s);if(c==null)throw new Error(`MiniSearch: document does not have ID field "${s}"`);if(this._idToShortId.has(c))throw new Error(`MiniSearch: duplicate ID ${c}`);const l=this.addDocumentId(c);this.saveStoredFields(l,t);for(const d of u){const f=r(t,d);if(f==null)continue;const h=a(f.toString(),d),v=this._fieldIds[d],g=new Set(h).size;this.addFieldLength(l,v,this._documentCount-1,g);for(const b of h){const _=o(b,d);if(Array.isArray(_))for(const S of _)this.addTerm(v,l,S);else _&&this.addTerm(v,l,_)}}}addAll(t){for(const r of t)this.add(r)}addAllAsync(t,r={}){const{chunkSize:a=10}=r,o={chunk:[],promise:Promise.resolve()},{chunk:u,promise:s}=t.reduce(({chunk:c,promise:l},d,f)=>(c.push(d),(f+1)%a===0?{chunk:[],promise:l.then(()=>new Promise(h=>setTimeout(h,0))).then(()=>this.addAll(c))}:{chunk:c,promise:l}),o);return s.then(()=>this.addAll(u))}remove(t){const{tokenize:r,processTerm:a,extractField:o,fields:u,idField:s}=this._options,c=o(t,s);if(c==null)throw new Error(`MiniSearch: document does not have ID field "${s}"`);const l=this._idToShortId.get(c);if(l==null)throw new Error(`MiniSearch: cannot remove document with ID ${c}: it is not in the index`);for(const d of u){const f=o(t,d);if(f==null)continue;const h=r(f.toString(),d),v=this._fieldIds[d],g=new Set(h).size;this.removeFieldLength(l,v,this._documentCount,g);for(const b of h){const _=a(b,d);if(Array.isArray(_))for(const S of _)this.removeTerm(v,l,S);else _&&this.removeTerm(v,l,_)}}this._storedFields.delete(l),this._documentIds.delete(l),this._idToShortId.delete(c),this._fieldLength.delete(l),this._documentCount-=1}removeAll(t){if(t)for(const r of t)this.remove(r);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new SearchableMap,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){const r=this._idToShortId.get(t);if(r==null)throw new Error(`MiniSearch: cannot discard document with ID ${t}: it is not in the index`);this._idToShortId.delete(t),this._documentIds.delete(r),this._storedFields.delete(r),(this._fieldLength.get(r)||[]).forEach((a,o)=>{this.removeFieldLength(r,o,this._documentCount,a)}),this._fieldLength.delete(r),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;const{minDirtFactor:t,minDirtCount:r,batchSize:a,batchWait:o}=this._options.autoVacuum;this.conditionalVacuum({batchSize:a,batchWait:o},{minDirtCount:r,minDirtFactor:t})}discardAll(t){const r=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(const a of t)this.discard(a)}finally{this._options.autoVacuum=r}this.maybeAutoVacuum()}replace(t){const{idField:r,extractField:a}=this._options,o=a(t,r);this.discard(o),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,r){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&r,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{const a=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=defaultVacuumConditions,this.performVacuuming(t,a)}),this._enqueuedVacuum)):this.vacuumConditionsMet(r)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}async performVacuuming(t,r){const a=this._dirtCount;if(this.vacuumConditionsMet(r)){const o=t.batchSize||defaultVacuumOptions.batchSize,u=t.batchWait||defaultVacuumOptions.batchWait;let s=1;for(const[c,l]of this._index){for(const[d,f]of l)for(const[h]of f)this._documentIds.has(h)||(f.size<=1?l.delete(d):f.delete(h));this._index.get(c).size===0&&this._index.delete(c),s%o===0&&await new Promise(d=>setTimeout(d,u)),s+=1}this._dirtCount-=a}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:r,minDirtFactor:a}=t;return r=r||defaultAutoVacuumOptions.minDirtCount,a=a||defaultAutoVacuumOptions.minDirtFactor,this.dirtCount>=r&&this.dirtFactor>=a}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){const r=this._idToShortId.get(t);if(r!=null)return this._storedFields.get(r)}search(t,r={}){const{searchOptions:a}=this._options,o={...a,...r},u=this.executeQuery(t,r),s=[];for(const[c,{score:l,terms:d,match:f}]of u){const h=d.length||1,v={id:this._documentIds.get(c),score:l*h,terms:Object.keys(f),queryTerms:d,match:f};Object.assign(v,this._storedFields.get(c)),(o.filter==null||o.filter(v))&&s.push(v)}return t===MiniSearch.wildcard&&o.boostDocument==null||s.sort(byScore),s}autoSuggest(t,r={}){r={...this._options.autoSuggestOptions,...r};const a=new Map;for(const{score:u,terms:s}of this.search(t,r)){const c=s.join(" "),l=a.get(c);l!=null?(l.score+=u,l.count+=1):a.set(c,{score:u,terms:s,count:1})}const o=[];for(const[u,{score:s,terms:c,count:l}]of a)o.push({suggestion:u,terms:c,score:s/l});return o.sort(byScore),o}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,r){if(r==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),r)}static async loadJSONAsync(t,r){if(r==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),r)}static getDefault(t){if(defaultOptions.hasOwnProperty(t))return getOwnProperty(defaultOptions,t);throw new Error(`MiniSearch: unknown option "${t}"`)}static loadJS(t,r){const{index:a,documentIds:o,fieldLength:u,storedFields:s,serializationVersion:c}=t,l=this.instantiateMiniSearch(t,r);l._documentIds=objectToNumericMap(o),l._fieldLength=objectToNumericMap(u),l._storedFields=objectToNumericMap(s);for(const[d,f]of l._documentIds)l._idToShortId.set(f,d);for(const[d,f]of a){const h=new Map;for(const v of Object.keys(f)){let g=f[v];c===1&&(g=g.ds),h.set(parseInt(v,10),objectToNumericMap(g))}l._index.set(d,h)}return l}static async loadJSAsync(t,r){const{index:a,documentIds:o,fieldLength:u,storedFields:s,serializationVersion:c}=t,l=this.instantiateMiniSearch(t,r);l._documentIds=await objectToNumericMapAsync(o),l._fieldLength=await objectToNumericMapAsync(u),l._storedFields=await objectToNumericMapAsync(s);for(const[f,h]of l._documentIds)l._idToShortId.set(h,f);let d=0;for(const[f,h]of a){const v=new Map;for(const g of Object.keys(h)){let b=h[g];c===1&&(b=b.ds),v.set(parseInt(g,10),await objectToNumericMapAsync(b))}++d%1e3===0&&await wait(0),l._index.set(f,v)}return l}static instantiateMiniSearch(t,r){const{documentCount:a,nextId:o,fieldIds:u,averageFieldLength:s,dirtCount:c,serializationVersion:l}=t;if(l!==1&&l!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");const d=new MiniSearch(r);return d._documentCount=a,d._nextId=o,d._idToShortId=new Map,d._fieldIds=u,d._avgFieldLength=s,d._dirtCount=c||0,d._index=new SearchableMap,d}executeQuery(t,r={}){if(t===MiniSearch.wildcard)return this.executeWildcardQuery(r);if(typeof t!="string"){const v={...r,...t,queries:void 0},g=t.queries.map(b=>this.executeQuery(b,v));return this.combineResults(g,v.combineWith)}const{tokenize:a,processTerm:o,searchOptions:u}=this._options,s={tokenize:a,processTerm:o,...u,...r},{tokenize:c,processTerm:l}=s,h=c(t).flatMap(v=>l(v)).filter(v=>!!v).map(termToQuerySpec(s)).map(v=>this.executeQuerySpec(v,s));return this.combineResults(h,s.combineWith)}executeQuerySpec(t,r){const a={...this._options.searchOptions,...r},o=(a.fields||this._options.fields).reduce((_,S)=>({..._,[S]:getOwnProperty(a.boost,S)||1}),{}),{boostDocument:u,weights:s,maxFuzzy:c,bm25:l}=a,{fuzzy:d,prefix:f}={...defaultSearchOptions.weights,...s},h=this._index.get(t.term),v=this.termResults(t.term,t.term,1,t.termBoost,h,o,u,l);let g,b;if(t.prefix&&(g=this._index.atPrefix(t.term)),t.fuzzy){const _=t.fuzzy===!0?.2:t.fuzzy,S=_<1?Math.min(c,Math.round(t.term.length*_)):_;S&&(b=this._index.fuzzyGet(t.term,S))}if(g)for(const[_,S]of g){const T=_.length-t.term.length;if(!T)continue;b==null||b.delete(_);const w=f*_.length/(_.length+.3*T);this.termResults(t.term,_,w,t.termBoost,S,o,u,l,v)}if(b)for(const _ of b.keys()){const[S,T]=b.get(_);if(!T)continue;const w=d*_.length/(_.length+T);this.termResults(t.term,_,w,t.termBoost,S,o,u,l,v)}return v}executeWildcardQuery(t){const r=new Map,a={...this._options.searchOptions,...t};for(const[o,u]of this._documentIds){const s=a.boostDocument?a.boostDocument(u,"",this._storedFields.get(o)):1;r.set(o,{score:s,terms:[],match:{}})}return r}combineResults(t,r=OR){if(t.length===0)return new Map;const a=r.toLowerCase(),o=combinators[a];if(!o)throw new Error(`Invalid combination operator: ${r}`);return t.reduce(o)||new Map}toJSON(){const t=[];for(const[r,a]of this._index){const o={};for(const[u,s]of a)o[u]=Object.fromEntries(s);t.push([r,o])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,r,a,o,u,s,c,l,d=new Map){if(u==null)return d;for(const f of Object.keys(s)){const h=s[f],v=this._fieldIds[f],g=u.get(v);if(g==null)continue;let b=g.size;const _=this._avgFieldLength[v];for(const S of g.keys()){if(!this._documentIds.has(S)){this.removeTerm(v,S,r),b-=1;continue}const T=c?c(this._documentIds.get(S),r,this._storedFields.get(S)):1;if(!T)continue;const w=g.get(S),A=this._fieldLength.get(S)[v],R=calcBM25Score(w,b,this._documentCount,A,_,l),E=a*o*h*T*R,I=d.get(S);if(I){I.score+=E,assignUniqueTerm(I.terms,t);const L=getOwnProperty(I.match,r);L?L.push(f):I.match[r]=[f]}else d.set(S,{score:E,terms:[t],match:{[r]:[f]}})}}return d}addTerm(t,r,a){const o=this._index.fetch(a,createMap);let u=o.get(t);if(u==null)u=new Map,u.set(r,1),o.set(t,u);else{const s=u.get(r);u.set(r,(s||0)+1)}}removeTerm(t,r,a){if(!this._index.has(a)){this.warnDocumentChanged(r,t,a);return}const o=this._index.fetch(a,createMap),u=o.get(t);u==null||u.get(r)==null?this.warnDocumentChanged(r,t,a):u.get(r)<=1?u.size<=1?o.delete(t):u.delete(r):u.set(r,u.get(r)-1),this._index.get(a).size===0&&this._index.delete(a)}warnDocumentChanged(t,r,a){for(const o of Object.keys(this._fieldIds))if(this._fieldIds[o]===r){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(t)} has changed before removal: term "${a}" was not present in field "${o}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(t){const r=this._nextId;return this._idToShortId.set(t,r),this._documentIds.set(r,t),this._documentCount+=1,this._nextId+=1,r}addFields(t){for(let r=0;r<t.length;r++)this._fieldIds[t[r]]=r}addFieldLength(t,r,a,o){let u=this._fieldLength.get(t);u==null&&this._fieldLength.set(t,u=[]),u[r]=o;const c=(this._avgFieldLength[r]||0)*a+o;this._avgFieldLength[r]=c/(a+1)}removeFieldLength(t,r,a,o){if(a===1){this._avgFieldLength[r]=0;return}const u=this._avgFieldLength[r]*a-o;this._avgFieldLength[r]=u/(a-1)}saveStoredFields(t,r){const{storeFields:a,extractField:o}=this._options;if(a==null||a.length===0)return;let u=this._storedFields.get(t);u==null&&this._storedFields.set(t,u={});for(const s of a){const c=o(r,s);c!==void 0&&(u[s]=c)}}}MiniSearch.wildcard=Symbol("*");const getOwnProperty=(n,t)=>Object.prototype.hasOwnProperty.call(n,t)?n[t]:void 0,combinators={[OR]:(n,t)=>{for(const r of t.keys()){const a=n.get(r);if(a==null)n.set(r,t.get(r));else{const{score:o,terms:u,match:s}=t.get(r);a.score=a.score+o,a.match=Object.assign(a.match,s),assignUniqueTerms(a.terms,u)}}return n},[AND]:(n,t)=>{const r=new Map;for(const a of t.keys()){const o=n.get(a);if(o==null)continue;const{score:u,terms:s,match:c}=t.get(a);assignUniqueTerms(o.terms,s),r.set(a,{score:o.score+u,terms:o.terms,match:Object.assign(o.match,c)})}return r},[AND_NOT]:(n,t)=>{for(const r of t.keys())n.delete(r);return n}},defaultBM25params={k:1.2,b:.7,d:.5},calcBM25Score=(n,t,r,a,o,u)=>{const{k:s,b:c,d:l}=u;return Math.log(1+(r-t+.5)/(t+.5))*(l+n*(s+1)/(n+s*(1-c+c*a/o)))},termToQuerySpec=n=>(t,r,a)=>{const o=typeof n.fuzzy=="function"?n.fuzzy(t,r,a):n.fuzzy||!1,u=typeof n.prefix=="function"?n.prefix(t,r,a):n.prefix===!0,s=typeof n.boostTerm=="function"?n.boostTerm(t,r,a):1;return{term:t,fuzzy:o,prefix:u,termBoost:s}},defaultOptions={idField:"id",extractField:(n,t)=>n[t],tokenize:n=>n.split(SPACE_OR_PUNCTUATION),processTerm:n=>n.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(n,t)=>{typeof(console==null?void 0:console[n])=="function"&&console[n](t)},autoVacuum:!0},defaultSearchOptions={combineWith:OR,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:defaultBM25params},defaultAutoSuggestOptions={combineWith:AND,prefix:(n,t,r)=>t===r.length-1},defaultVacuumOptions={batchSize:1e3,batchWait:10},defaultVacuumConditions={minDirtFactor:.1,minDirtCount:20},defaultAutoVacuumOptions={...defaultVacuumOptions,...defaultVacuumConditions},assignUniqueTerm=(n,t)=>{n.includes(t)||n.push(t)},assignUniqueTerms=(n,t)=>{for(const r of t)n.includes(r)||n.push(r)},byScore=({score:n},{score:t})=>t-n,createMap=()=>new Map,objectToNumericMap=n=>{const t=new Map;for(const r of Object.keys(n))t.set(parseInt(r,10),n[r]);return t},objectToNumericMapAsync=async n=>{const t=new Map;let r=0;for(const a of Object.keys(n))t.set(parseInt(a,10),n[a]),++r%1e3===0&&await wait(0);return t},wait=n=>new Promise(t=>setTimeout(t,n)),SPACE_OR_PUNCTUATION=/[\n\r\p{Z}\p{P}]+/u;var cytoscapeCola$1={exports:{}},dist={},adaptor={},layout={},powergraph={},hasRequiredPowergraph;function requirePowergraph(){if(hasRequiredPowergraph)return powergraph;hasRequiredPowergraph=1,Object.defineProperty(powergraph,"__esModule",{value:!0});var n=function(){function l(d,f,h){this.source=d,this.target=f,this.type=h}return l}();powergraph.PowerEdge=n;var t=function(){function l(d,f,h,v){var g=this;if(this.linkAccessor=h,this.modules=new Array(d),this.roots=[],v)this.initModulesFromGroup(v);else{this.roots.push(new u);for(var b=0;b<d;++b)this.roots[0].add(this.modules[b]=new a(b))}this.R=f.length,f.forEach(function(_){var S=g.modules[h.getSourceIndex(_)],T=g.modules[h.getTargetIndex(_)],w=h.getType(_);S.outgoing.add(w,T),T.incoming.add(w,S)})}return l.prototype.initModulesFromGroup=function(d){var f=new u;this.roots.push(f);for(var h=0;h<d.leaves.length;++h){var v=d.leaves[h],g=new a(v.id);this.modules[v.id]=g,f.add(g)}if(d.groups)for(var b=0;b<d.groups.length;++b){var _=d.groups[b],S={};for(var T in _)T!=="leaves"&&T!=="groups"&&_.hasOwnProperty(T)&&(S[T]=_[T]);f.add(new a(-1-b,new s,new s,this.initModulesFromGroup(_),S))}return f},l.prototype.merge=function(d,f,h){h===void 0&&(h=0);var v=d.incoming.intersection(f.incoming),g=d.outgoing.intersection(f.outgoing),b=new u;b.add(d),b.add(f);var _=new a(this.modules.length,g,v,b);this.modules.push(_);var S=function(T,w,A){T.forAll(function(R,E){R.forAll(function(I){var L=I[w];L.add(E,_),L.remove(E,d),L.remove(E,f),d[A].remove(E,I),f[A].remove(E,I)})})};return S(g,"incoming","outgoing"),S(v,"outgoing","incoming"),this.R-=v.count()+g.count(),this.roots[h].remove(d),this.roots[h].remove(f),this.roots[h].add(_),_},l.prototype.rootMerges=function(d){d===void 0&&(d=0);for(var f=this.roots[d].modules(),h=f.length,v=new Array(h*(h-1)),g=0,b=0,_=h-1;b<_;++b)for(var S=b+1;S<h;++S){var T=f[b],w=f[S];v[g]={id:g,nEdges:this.nEdges(T,w),a:T,b:w},g++}return v},l.prototype.greedyMerge=function(){for(var d=0;d<this.roots.length;++d)if(!(this.roots[d].modules().length<2)){var f=this.rootMerges(d).sort(function(v,g){return v.nEdges==g.nEdges?v.id-g.id:v.nEdges-g.nEdges}),h=f[0];if(!(h.nEdges>=this.R))return this.merge(h.a,h.b,d),!0}},l.prototype.nEdges=function(d,f){var h=d.incoming.intersection(f.incoming),v=d.outgoing.intersection(f.outgoing);return this.R-h.count()-v.count()},l.prototype.getGroupHierarchy=function(d){var f=this,h=[],v={};r(this.roots[0],v,h);var g=this.allEdges();return g.forEach(function(b){var _=f.modules[b.source],S=f.modules[b.target];d.push(new n(typeof _.gid>"u"?b.source:h[_.gid],typeof S.gid>"u"?b.target:h[S.gid],b.type))}),h},l.prototype.allEdges=function(){var d=[];return l.getEdges(this.roots[0],d),d},l.getEdges=function(d,f){d.forAll(function(h){h.getEdges(f),l.getEdges(h.children,f)})},l}();powergraph.Configuration=t;function r(l,d,f){l.forAll(function(h){if(h.isLeaf())d.leaves||(d.leaves=[]),d.leaves.push(h.id);else{var v=d;if(h.gid=f.length,!h.isIsland()||h.isPredefined()){if(v={id:h.gid},h.isPredefined())for(var g in h.definition)v[g]=h.definition[g];d.groups||(d.groups=[]),d.groups.push(h.gid),f.push(v)}r(h.children,v,f)}})}var a=function(){function l(d,f,h,v,g){f===void 0&&(f=new s),h===void 0&&(h=new s),v===void 0&&(v=new u),this.id=d,this.outgoing=f,this.incoming=h,this.children=v,this.definition=g}return l.prototype.getEdges=function(d){var f=this;this.outgoing.forAll(function(h,v){h.forAll(function(g){d.push(new n(f.id,g.id,v))})})},l.prototype.isLeaf=function(){return this.children.count()===0},l.prototype.isIsland=function(){return this.outgoing.count()===0&&this.incoming.count()===0},l.prototype.isPredefined=function(){return typeof this.definition<"u"},l}();powergraph.Module=a;function o(l,d){var f={};for(var h in l)h in d&&(f[h]=l[h]);return f}var u=function(){function l(){this.table={}}return l.prototype.count=function(){return Object.keys(this.table).length},l.prototype.intersection=function(d){var f=new l;return f.table=o(this.table,d.table),f},l.prototype.intersectionCount=function(d){return this.intersection(d).count()},l.prototype.contains=function(d){return d in this.table},l.prototype.add=function(d){this.table[d.id]=d},l.prototype.remove=function(d){delete this.table[d.id]},l.prototype.forAll=function(d){for(var f in this.table)d(this.table[f])},l.prototype.modules=function(){var d=[];return this.forAll(function(f){f.isPredefined()||d.push(f)}),d},l}();powergraph.ModuleSet=u;var s=function(){function l(){this.sets={},this.n=0}return l.prototype.count=function(){return this.n},l.prototype.contains=function(d){var f=!1;return this.forAllModules(function(h){!f&&h.id==d&&(f=!0)}),f},l.prototype.add=function(d,f){var h=d in this.sets?this.sets[d]:this.sets[d]=new u;h.add(f),++this.n},l.prototype.remove=function(d,f){var h=this.sets[d];h.remove(f),h.count()===0&&delete this.sets[d],--this.n},l.prototype.forAll=function(d){for(var f in this.sets)d(this.sets[f],Number(f))},l.prototype.forAllModules=function(d){this.forAll(function(f,h){return f.forAll(d)})},l.prototype.intersection=function(d){var f=new l;return this.forAll(function(h,v){if(v in d.sets){var g=h.intersection(d.sets[v]),b=g.count();b>0&&(f.sets[v]=g,f.n+=b)}}),f},l}();powergraph.LinkSets=s;function c(l,d,f,h){for(var v=l.length,g=new t(v,d,f,h);g.greedyMerge(););var b=[],_=g.getGroupHierarchy(b);return b.forEach(function(S){var T=function(w){var A=S[w];typeof A=="number"&&(S[w]=l[A])};T("source"),T("target")}),{groups:_,powerEdges:b}}return powergraph.getGroups=c,powergraph}var linklengths={},hasRequiredLinklengths;function requireLinklengths(){if(hasRequiredLinklengths)return linklengths;hasRequiredLinklengths=1,Object.defineProperty(linklengths,"__esModule",{value:!0});function n(l,d){var f={};for(var h in l)f[h]={};for(var h in d)f[h]={};return Object.keys(f).length}function t(l,d){var f=0;for(var h in l)typeof d[h]<"u"&&++f;return f}function r(l,d){var f={},h=function(v,g){typeof f[v]>"u"&&(f[v]={}),f[v][g]={}};return l.forEach(function(v){var g=d.getSourceIndex(v),b=d.getTargetIndex(v);h(g,b),h(b,g)}),f}function a(l,d,f,h){var v=r(l,h);l.forEach(function(g){var b=v[h.getSourceIndex(g)],_=v[h.getTargetIndex(g)];h.setLength(g,1+d*f(b,_))})}function o(l,d,f){f===void 0&&(f=1),a(l,f,function(h,v){return Math.sqrt(n(h,v)-t(h,v))},d)}linklengths.symmetricDiffLinkLengths=o;function u(l,d,f){f===void 0&&(f=1),a(l,f,function(h,v){return Math.min(Object.keys(h).length,Object.keys(v).length)<1.1?0:t(h,v)/n(h,v)},d)}linklengths.jaccardLinkLengths=u;function s(l,d,f,h){var v=c(l,d,h),g={};v.forEach(function(_,S){return _.forEach(function(T){return g[T]=S})});var b=[];return d.forEach(function(_){var S=h.getSourceIndex(_),T=h.getTargetIndex(_),w=g[S],A=g[T];w!==A&&b.push({axis:f,left:S,right:T,gap:h.getMinSeparation(_)})}),b}linklengths.generateDirectedEdgeConstraints=s;function c(l,d,f){var h=[],v=0,g=[],b=[];function _(D){D.index=D.lowlink=v++,g.push(D),D.onStack=!0;for(var $=0,O=D.out;$<O.length;$++){var P=O[$];typeof P.index>"u"?(_(P),D.lowlink=Math.min(D.lowlink,P.lowlink)):P.onStack&&(D.lowlink=Math.min(D.lowlink,P.index))}if(D.lowlink===D.index){for(var C=[];g.length&&(P=g.pop(),P.onStack=!1,C.push(P),P!==D););b.push(C.map(function(q){return q.id}))}}for(var S=0;S<l;S++)h.push({id:S,out:[]});for(var T=0,w=d;T<w.length;T++){var A=w[T],R=h[f.getSourceIndex(A)],E=h[f.getTargetIndex(A)];R.out.push(E)}for(var I=0,L=h;I<L.length;I++){var F=L[I];typeof F.index>"u"&&_(F)}return b}return linklengths.stronglyConnectedComponents=c,linklengths}var descent={},hasRequiredDescent;function requireDescent(){if(hasRequiredDescent)return descent;hasRequiredDescent=1,Object.defineProperty(descent,"__esModule",{value:!0});var n=function(){function a(){this.locks={}}return a.prototype.add=function(o,u){this.locks[o]=u},a.prototype.clear=function(){this.locks={}},a.prototype.isEmpty=function(){for(var o in this.locks)return!1;return!0},a.prototype.apply=function(o){for(var u in this.locks)o(Number(u),this.locks[u])},a}();descent.Locks=n;var t=function(){function a(o,u,s){s===void 0&&(s=null),this.D=u,this.G=s,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new r,this.project=null,this.x=o,this.k=o.length;var c=this.n=o[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new n,this.minD=Number.MAX_VALUE;for(var l=c,d;l--;)for(d=c;--d>l;){var f=u[l][d];f>0&&f<this.minD&&(this.minD=f)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),l=this.k;l--;){for(this.g[l]=new Array(c),this.H[l]=new Array(c),d=c;d--;)this.H[l][d]=new Array(c);this.Hd[l]=new Array(c),this.a[l]=new Array(c),this.b[l]=new Array(c),this.c[l]=new Array(c),this.d[l]=new Array(c),this.e[l]=new Array(c),this.ia[l]=new Array(c),this.ib[l]=new Array(c),this.xtmp[l]=new Array(c)}}return a.createSquareMatrix=function(o,u){for(var s=new Array(o),c=0;c<o;++c){s[c]=new Array(o);for(var l=0;l<o;++l)s[c][l]=u(c,l)}return s},a.prototype.offsetDir=function(){for(var o=this,u=new Array(this.k),s=0,c=0;c<this.k;++c){var l=u[c]=this.random.getNextBetween(.01,1)-.5;s+=l*l}return s=Math.sqrt(s),u.map(function(d){return d*=o.minD/s})},a.prototype.computeDerivatives=function(o){var u=this,s=this.n;if(!(s<1)){for(var c,l=new Array(this.k),d=new Array(this.k),f=new Array(this.k),h=0,v=0;v<s;++v){for(c=0;c<this.k;++c)f[c]=this.g[c][v]=0;for(var g=0;g<s;++g)if(v!==g){for(var b=s;b--;){var _=0;for(c=0;c<this.k;++c){var S=l[c]=o[c][v]-o[c][g];_+=d[c]=S*S}if(_>1e-9)break;var T=this.offsetDir();for(c=0;c<this.k;++c)o[c][g]+=T[c]}var w=Math.sqrt(_),A=this.D[v][g],R=this.G!=null?this.G[v][g]:1;if(R>1&&w>A||!isFinite(A)){for(c=0;c<this.k;++c)this.H[c][v][g]=0;continue}R>1&&(R=1);var E=A*A,I=2*R*(w-A)/(E*w),L=w*w*w,F=2*-R/(E*L);for(isFinite(I)||console.log(I),c=0;c<this.k;++c)this.g[c][v]+=l[c]*I,f[c]-=this.H[c][v][g]=F*(L+A*(d[c]-_)+w*_)}for(c=0;c<this.k;++c)h=Math.max(h,this.H[c][v][v]=f[c])}for(var D=this.snapGridSize/2,$=this.snapGridSize,O=this.snapStrength,P=O/(D*D),C=this.numGridSnapNodes,v=0;v<C;++v)for(c=0;c<this.k;++c){var q=this.x[c][v],M=q/$,N=M%1,G=M-N,X=Math.abs(N),S=X<=.5?q-G*$:q>0?q-(G+1)*$:q-(G-1)*$;-D<S&&S<=D&&(this.scaleSnapByMaxH?(this.g[c][v]+=h*P*S,this.H[c][v][v]+=h*P):(this.g[c][v]+=P*S,this.H[c][v][v]+=P))}this.locks.isEmpty()||this.locks.apply(function(Y,W){for(c=0;c<u.k;++c)u.H[c][Y][Y]+=h,u.g[c][Y]-=h*(W[c]-o[c][Y])})}},a.dotProd=function(o,u){for(var s=0,c=o.length;c--;)s+=o[c]*u[c];return s},a.rightMultiply=function(o,u,s){for(var c=o.length;c--;)s[c]=a.dotProd(o[c],u)},a.prototype.computeStepSize=function(o){for(var u=0,s=0,c=0;c<this.k;++c)u+=a.dotProd(this.g[c],o[c]),a.rightMultiply(this.H[c],o[c],this.Hd[c]),s+=a.dotProd(o[c],this.Hd[c]);return s===0||!isFinite(s)?0:1*u/s},a.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var o=this.computeStepSize(this.g),u=0;u<this.k;++u)this.takeDescentStep(this.x[u],this.g[u],o);return this.computeStress()},a.copy=function(o,u){for(var s=o.length,c=u[0].length,l=0;l<s;++l)for(var d=0;d<c;++d)u[l][d]=o[l][d]},a.prototype.stepAndProject=function(o,u,s,c){a.copy(o,u),this.takeDescentStep(u[0],s[0],c),this.project&&this.project[0](o[0],o[1],u[0]),this.takeDescentStep(u[1],s[1],c),this.project&&this.project[1](u[0],o[1],u[1]);for(var l=2;l<this.k;l++)this.takeDescentStep(u[l],s[l],c)},a.mApply=function(o,u,s){for(var c=o;c-- >0;)for(var l=u;l-- >0;)s(c,l)},a.prototype.matrixApply=function(o){a.mApply(this.k,this.n,o)},a.prototype.computeNextPosition=function(o,u){var s=this;this.computeDerivatives(o);var c=this.computeStepSize(this.g);if(this.stepAndProject(o,u,this.g,c),this.project){this.matrixApply(function(d,f){return s.e[d][f]=o[d][f]-u[d][f]});var l=this.computeStepSize(this.e);l=Math.max(.2,Math.min(l,1)),this.stepAndProject(o,u,this.e,l)}},a.prototype.run=function(o){for(var u=Number.MAX_VALUE,s=!1;!s&&o-- >0;){var c=this.rungeKutta();s=Math.abs(u/c-1)<this.threshold,u=c}return u},a.prototype.rungeKutta=function(){var o=this;this.computeNextPosition(this.x,this.a),a.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),a.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var u=0;return this.matrixApply(function(s,c){var l=(o.a[s][c]+2*o.b[s][c]+2*o.c[s][c]+o.d[s][c])/6,d=o.x[s][c]-l;u+=d*d,o.x[s][c]=l}),u},a.mid=function(o,u,s){a.mApply(o.length,o[0].length,function(c,l){return s[c][l]=o[c][l]+(u[c][l]-o[c][l])/2})},a.prototype.takeDescentStep=function(o,u,s){for(var c=0;c<this.n;++c)o[c]=o[c]-s*u[c]},a.prototype.computeStress=function(){for(var o=0,u=0,s=this.n-1;u<s;++u)for(var c=u+1,l=this.n;c<l;++c){for(var d=0,f=0;f<this.k;++f){var h=this.x[f][u]-this.x[f][c];d+=h*h}d=Math.sqrt(d);var v=this.D[u][c];if(isFinite(v)){var g=v-d,b=v*v;o+=g*g/b}}return o},a.zeroDistance=1e-10,a}();descent.Descent=t;var r=function(){function a(o){o===void 0&&(o=1),this.seed=o,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return a.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},a.prototype.getNextBetween=function(o,u){return o+this.getNext()*(u-o)},a}();return descent.PseudoRandom=r,descent}var rectangle={},vpsc={},hasRequiredVpsc;function requireVpsc(){if(hasRequiredVpsc)return vpsc;hasRequiredVpsc=1,Object.defineProperty(vpsc,"__esModule",{value:!0});var n=function(){function c(l){this.scale=l,this.AB=0,this.AD=0,this.A2=0}return c.prototype.addVariable=function(l){var d=this.scale/l.scale,f=l.offset/l.scale,h=l.weight;this.AB+=h*d*f,this.AD+=h*d*l.desiredPosition,this.A2+=h*d*d},c.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},c}();vpsc.PositionStats=n;var t=function(){function c(l,d,f,h){h===void 0&&(h=!1),this.left=l,this.right=d,this.gap=f,this.equality=h,this.active=!1,this.unsatisfiable=!1,this.left=l,this.right=d,this.gap=f,this.equality=h}return c.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},c}();vpsc.Constraint=t;var r=function(){function c(l,d,f){d===void 0&&(d=1),f===void 0&&(f=1),this.desiredPosition=l,this.weight=d,this.scale=f,this.offset=0}return c.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},c.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},c.prototype.visitNeighbours=function(l,d){var f=function(h,v){return h.active&&l!==v&&d(h,v)};this.cOut.forEach(function(h){return f(h,h.right)}),this.cIn.forEach(function(h){return f(h,h.left)})},c}();vpsc.Variable=r;var a=function(){function c(l){this.vars=[],l.offset=0,this.ps=new n(l.scale),this.addVariable(l)}return c.prototype.addVariable=function(l){l.block=this,this.vars.push(l),this.ps.addVariable(l),this.posn=this.ps.getPosn()},c.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var l=0,d=this.vars.length;l<d;++l)this.ps.addVariable(this.vars[l]);this.posn=this.ps.getPosn()},c.prototype.compute_lm=function(l,d,f){var h=this,v=l.dfdv();return l.visitNeighbours(d,function(g,b){var _=h.compute_lm(b,l,f);b===g.right?(v+=_*g.left.scale,g.lm=_):(v+=_*g.right.scale,g.lm=-_),f(g)}),v/l.scale},c.prototype.populateSplitBlock=function(l,d){var f=this;l.visitNeighbours(d,function(h,v){v.offset=l.offset+(v===h.right?h.gap:-h.gap),f.addVariable(v),f.populateSplitBlock(v,l)})},c.prototype.traverse=function(l,d,f,h){var v=this;f===void 0&&(f=this.vars[0]),h===void 0&&(h=null),f.visitNeighbours(h,function(g,b){d.push(l(g)),v.traverse(l,d,b,f)})},c.prototype.findMinLM=function(){var l=null;return this.compute_lm(this.vars[0],null,function(d){!d.equality&&(l===null||d.lm<l.lm)&&(l=d)}),l},c.prototype.findMinLMBetween=function(l,d){this.compute_lm(l,null,function(){});var f=null;return this.findPath(l,null,d,function(h,v){!h.equality&&h.right===v&&(f===null||h.lm<f.lm)&&(f=h)}),f},c.prototype.findPath=function(l,d,f,h){var v=this,g=!1;return l.visitNeighbours(d,function(b,_){!g&&(_===f||v.findPath(_,l,f,h))&&(g=!0,h(b,_))}),g},c.prototype.isActiveDirectedPathBetween=function(l,d){if(l===d)return!0;for(var f=l.cOut.length;f--;){var h=l.cOut[f];if(h.active&&this.isActiveDirectedPathBetween(h.right,d))return!0}return!1},c.split=function(l){return l.active=!1,[c.createSplitBlock(l.left),c.createSplitBlock(l.right)]},c.createSplitBlock=function(l){var d=new c(l);return d.populateSplitBlock(l,null),d},c.prototype.splitBetween=function(l,d){var f=this.findMinLMBetween(l,d);if(f!==null){var h=c.split(f);return{constraint:f,lb:h[0],rb:h[1]}}return null},c.prototype.mergeAcross=function(l,d,f){d.active=!0;for(var h=0,v=l.vars.length;h<v;++h){var g=l.vars[h];g.offset+=f,this.addVariable(g)}this.posn=this.ps.getPosn()},c.prototype.cost=function(){for(var l=0,d=this.vars.length;d--;){var f=this.vars[d],h=f.position()-f.desiredPosition;l+=h*h*f.weight}return l},c}();vpsc.Block=a;var o=function(){function c(l){this.vs=l;var d=l.length;for(this.list=new Array(d);d--;){var f=new a(l[d]);this.list[d]=f,f.blockInd=d}}return c.prototype.cost=function(){for(var l=0,d=this.list.length;d--;)l+=this.list[d].cost();return l},c.prototype.insert=function(l){l.blockInd=this.list.length,this.list.push(l)},c.prototype.remove=function(l){var d=this.list.length-1,f=this.list[d];this.list.length=d,l!==f&&(this.list[l.blockInd]=f,f.blockInd=l.blockInd)},c.prototype.merge=function(l){var d=l.left.block,f=l.right.block,h=l.right.offset-l.left.offset-l.gap;d.vars.length<f.vars.length?(f.mergeAcross(d,l,h),this.remove(d)):(d.mergeAcross(f,l,-h),this.remove(f))},c.prototype.forEach=function(l){this.list.forEach(l)},c.prototype.updateBlockPositions=function(){this.list.forEach(function(l){return l.updateWeightedPosition()})},c.prototype.split=function(l){var d=this;this.updateBlockPositions(),this.list.forEach(function(f){var h=f.findMinLM();h!==null&&h.lm<u.LAGRANGIAN_TOLERANCE&&(f=h.left.block,a.split(h).forEach(function(v){return d.insert(v)}),d.remove(f),l.push(h))})},c}();vpsc.Blocks=o;var u=function(){function c(l,d){this.vs=l,this.cs=d,this.vs=l,l.forEach(function(f){f.cIn=[],f.cOut=[]}),this.cs=d,d.forEach(function(f){f.left.cOut.push(f),f.right.cIn.push(f)}),this.inactive=d.map(function(f){return f.active=!1,f}),this.bs=null}return c.prototype.cost=function(){return this.bs.cost()},c.prototype.setStartingPositions=function(l){this.inactive=this.cs.map(function(d){return d.active=!1,d}),this.bs=new o(this.vs),this.bs.forEach(function(d,f){return d.posn=l[f]})},c.prototype.setDesiredPositions=function(l){this.vs.forEach(function(d,f){return d.desiredPosition=l[f]})},c.prototype.mostViolated=function(){for(var l=Number.MAX_VALUE,d=null,f=this.inactive,h=f.length,v=h,g=0;g<h;++g){var b=f[g];if(!b.unsatisfiable){var _=b.slack();if((b.equality||_<l)&&(l=_,d=b,v=g,b.equality))break}}return v!==h&&(l<c.ZERO_UPPERBOUND&&!d.active||d.equality)&&(f[v]=f[h-1],f.length=h-1),d},c.prototype.satisfy=function(){this.bs==null&&(this.bs=new o(this.vs)),this.bs.split(this.inactive);for(var l=null;(l=this.mostViolated())&&(l.equality||l.slack()<c.ZERO_UPPERBOUND&&!l.active);){var d=l.left.block,f=l.right.block;if(d!==f)this.bs.merge(l);else{if(d.isActiveDirectedPathBetween(l.right,l.left)){l.unsatisfiable=!0;continue}var h=d.splitBetween(l.left,l.right);if(h!==null)this.bs.insert(h.lb),this.bs.insert(h.rb),this.bs.remove(d),this.inactive.push(h.constraint);else{l.unsatisfiable=!0;continue}l.slack()>=0?this.inactive.push(l):this.bs.merge(l)}}},c.prototype.solve=function(){this.satisfy();for(var l=Number.MAX_VALUE,d=this.bs.cost();Math.abs(l-d)>1e-4;)this.satisfy(),l=d,d=this.bs.cost();return d},c.LAGRANGIAN_TOLERANCE=-1e-4,c.ZERO_UPPERBOUND=-1e-10,c}();vpsc.Solver=u;function s(c,l,d){for(var f=c.map(function(L){return new r(L.desiredCenter)}),h=[],v=c.length,g=0;g<v-1;g++){var b=c[g],_=c[g+1];h.push(new t(f[g],f[g+1],(b.size+_.size)/2))}var S=f[0],T=f[v-1],w=c[0].size/2,A=c[v-1].size/2,R=null,E=null;l&&(R=new r(l,S.weight*1e3),f.push(R),h.push(new t(R,S,w))),d&&(E=new r(d,T.weight*1e3),f.push(E),h.push(new t(T,E,A)));var I=new u(f,h);return I.solve(),{newCenters:f.slice(0,c.length).map(function(L){return L.position()}),lowerBound:R?R.position():S.position()-w,upperBound:E?E.position():T.position()+A}}return vpsc.removeOverlapInOneDimension=s,vpsc}var rbtree={},hasRequiredRbtree;function requireRbtree(){if(hasRequiredRbtree)return rbtree;hasRequiredRbtree=1;var n=rbtree&&rbtree.__extends||function(){var u=function(s,c){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,d){l.__proto__=d}||function(l,d){for(var f in d)d.hasOwnProperty(f)&&(l[f]=d[f])},u(s,c)};return function(s,c){u(s,c);function l(){this.constructor=s}s.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)}}();Object.defineProperty(rbtree,"__esModule",{value:!0});var t=function(){function u(){this.findIter=function(s){for(var c=this._root,l=this.iterator();c!==null;){var d=this._comparator(s,c.data);if(d===0)return l._cursor=c,l;l._ancestors.push(c),c=c.get_child(d>0)}return null}}return u.prototype.clear=function(){this._root=null,this.size=0},u.prototype.find=function(s){for(var c=this._root;c!==null;){var l=this._comparator(s,c.data);if(l===0)return c.data;c=c.get_child(l>0)}return null},u.prototype.lowerBound=function(s){return this._bound(s,this._comparator)},u.prototype.upperBound=function(s){var c=this._comparator;function l(d,f){return c(f,d)}return this._bound(s,l)},u.prototype.min=function(){var s=this._root;if(s===null)return null;for(;s.left!==null;)s=s.left;return s.data},u.prototype.max=function(){var s=this._root;if(s===null)return null;for(;s.right!==null;)s=s.right;return s.data},u.prototype.iterator=function(){return new r(this)},u.prototype.each=function(s){for(var c=this.iterator(),l;(l=c.next())!==null;)s(l)},u.prototype.reach=function(s){for(var c=this.iterator(),l;(l=c.prev())!==null;)s(l)},u.prototype._bound=function(s,c){for(var l=this._root,d=this.iterator();l!==null;){var f=this._comparator(s,l.data);if(f===0)return d._cursor=l,d;d._ancestors.push(l),l=l.get_child(f>0)}for(var h=d._ancestors.length-1;h>=0;--h)if(l=d._ancestors[h],c(s,l.data)>0)return d._cursor=l,d._ancestors.length=h,d;return d._ancestors.length=0,d},u}();rbtree.TreeBase=t;var r=function(){function u(s){this._tree=s,this._ancestors=[],this._cursor=null}return u.prototype.data=function(){return this._cursor!==null?this._cursor.data:null},u.prototype.next=function(){if(this._cursor===null){var s=this._tree._root;s!==null&&this._minNode(s)}else if(this._cursor.right===null){var c;do if(c=this._cursor,this._ancestors.length)this._cursor=this._ancestors.pop();else{this._cursor=null;break}while(this._cursor.right===c)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return this._cursor!==null?this._cursor.data:null},u.prototype.prev=function(){if(this._cursor===null){var s=this._tree._root;s!==null&&this._maxNode(s)}else if(this._cursor.left===null){var c;do if(c=this._cursor,this._ancestors.length)this._cursor=this._ancestors.pop();else{this._cursor=null;break}while(this._cursor.left===c)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return this._cursor!==null?this._cursor.data:null},u.prototype._minNode=function(s){for(;s.left!==null;)this._ancestors.push(s),s=s.left;this._cursor=s},u.prototype._maxNode=function(s){for(;s.right!==null;)this._ancestors.push(s),s=s.right;this._cursor=s},u}();rbtree.Iterator=r;var a=function(){function u(s){this.data=s,this.left=null,this.right=null,this.red=!0}return u.prototype.get_child=function(s){return s?this.right:this.left},u.prototype.set_child=function(s,c){s?this.right=c:this.left=c},u}(),o=function(u){n(s,u);function s(c){var l=u.call(this)||this;return l._root=null,l._comparator=c,l.size=0,l}return s.prototype.insert=function(c){var l=!1;if(this._root===null)this._root=new a(c),l=!0,this.size++;else{var d=new a(void 0),f=!1,h=!1,v=null,g=d,b=null,_=this._root;for(g.right=this._root;;){if(_===null?(_=new a(c),b.set_child(f,_),l=!0,this.size++):s.is_red(_.left)&&s.is_red(_.right)&&(_.red=!0,_.left.red=!1,_.right.red=!1),s.is_red(_)&&s.is_red(b)){var S=g.right===v;_===b.get_child(h)?g.set_child(S,s.single_rotate(v,!h)):g.set_child(S,s.double_rotate(v,!h))}var T=this._comparator(_.data,c);if(T===0)break;h=f,f=T<0,v!==null&&(g=v),v=b,b=_,_=_.get_child(f)}this._root=d.right}return this._root.red=!1,l},s.prototype.remove=function(c){if(this._root===null)return!1;var l=new a(void 0),d=l;d.right=this._root;for(var f=null,h=null,v=null,g=!0;d.get_child(g)!==null;){var b=g;h=f,f=d,d=d.get_child(g);var _=this._comparator(c,d.data);if(g=_>0,_===0&&(v=d),!s.is_red(d)&&!s.is_red(d.get_child(g))){if(s.is_red(d.get_child(!g))){var S=s.single_rotate(d,g);f.set_child(b,S),f=S}else if(!s.is_red(d.get_child(!g))){var T=f.get_child(!b);if(T!==null)if(!s.is_red(T.get_child(!b))&&!s.is_red(T.get_child(b)))f.red=!1,T.red=!0,d.red=!0;else{var w=h.right===f;s.is_red(T.get_child(b))?h.set_child(w,s.double_rotate(f,b)):s.is_red(T.get_child(!b))&&h.set_child(w,s.single_rotate(f,b));var A=h.get_child(w);A.red=!0,d.red=!0,A.left.red=!1,A.right.red=!1}}}}return v!==null&&(v.data=d.data,f.set_child(f.right===d,d.get_child(d.left===null)),this.size--),this._root=l.right,this._root!==null&&(this._root.red=!1),v!==null},s.is_red=function(c){return c!==null&&c.red},s.single_rotate=function(c,l){var d=c.get_child(!l);return c.set_child(!l,d.get_child(l)),d.set_child(l,c),c.red=!0,d.red=!1,d},s.double_rotate=function(c,l){return c.set_child(!l,s.single_rotate(c.get_child(!l),!l)),s.single_rotate(c,l)},s}(t);return rbtree.RBTree=o,rbtree}var hasRequiredRectangle;function requireRectangle(){if(hasRequiredRectangle)return rectangle;hasRequiredRectangle=1;var n=rectangle&&rectangle.__extends||function(){var F=function(D,$){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,P){O.__proto__=P}||function(O,P){for(var C in P)P.hasOwnProperty(C)&&(O[C]=P[C])},F(D,$)};return function(D,$){F(D,$);function O(){this.constructor=D}D.prototype=$===null?Object.create($):(O.prototype=$.prototype,new O)}}();Object.defineProperty(rectangle,"__esModule",{value:!0});var t=requireVpsc(),r=requireRbtree();function a(F){return F.bounds=typeof F.leaves<"u"?F.leaves.reduce(function(D,$){return $.bounds.union(D)},o.empty()):o.empty(),typeof F.groups<"u"&&(F.bounds=F.groups.reduce(function(D,$){return a($).union(D)},F.bounds)),F.bounds=F.bounds.inflate(F.padding),F.bounds}rectangle.computeGroupBounds=a;var o=function(){function F(D,$,O,P){this.x=D,this.X=$,this.y=O,this.Y=P}return F.empty=function(){return new F(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},F.prototype.cx=function(){return(this.x+this.X)/2},F.prototype.cy=function(){return(this.y+this.Y)/2},F.prototype.overlapX=function(D){var $=this.cx(),O=D.cx();return $<=O&&D.x<this.X?this.X-D.x:O<=$&&this.x<D.X?D.X-this.x:0},F.prototype.overlapY=function(D){var $=this.cy(),O=D.cy();return $<=O&&D.y<this.Y?this.Y-D.y:O<=$&&this.y<D.Y?D.Y-this.y:0},F.prototype.setXCentre=function(D){var $=D-this.cx();this.x+=$,this.X+=$},F.prototype.setYCentre=function(D){var $=D-this.cy();this.y+=$,this.Y+=$},F.prototype.width=function(){return this.X-this.x},F.prototype.height=function(){return this.Y-this.y},F.prototype.union=function(D){return new F(Math.min(this.x,D.x),Math.max(this.X,D.X),Math.min(this.y,D.y),Math.max(this.Y,D.Y))},F.prototype.lineIntersections=function(D,$,O,P){for(var C=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],q=[],M=0;M<4;++M){var N=F.lineIntersection(D,$,O,P,C[M][0],C[M][1],C[M][2],C[M][3]);N!==null&&q.push({x:N.x,y:N.y})}return q},F.prototype.rayIntersection=function(D,$){var O=this.lineIntersections(this.cx(),this.cy(),D,$);return O.length>0?O[0]:null},F.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},F.lineIntersection=function(D,$,O,P,C,q,M,N){var G=O-D,X=M-C,Y=P-$,W=N-q,te=W*G-X*Y;if(te==0)return null;var ue=D-C,fe=$-q,re=X*fe-W*ue,ye=re/te,Te=G*fe-Y*ue,Re=Te/te;return ye>=0&&ye<=1&&Re>=0&&Re<=1?{x:D+ye*G,y:$+ye*Y}:null},F.prototype.inflate=function(D){return new F(this.x-D,this.X+D,this.y-D,this.Y+D)},F}();rectangle.Rectangle=o;function u(F,D,$){var O=F.rayIntersection(D.cx(),D.cy())||{x:F.cx(),y:F.cy()},P=D.rayIntersection(F.cx(),F.cy())||{x:D.cx(),y:D.cy()},C=P.x-O.x,q=P.y-O.y,M=Math.sqrt(C*C+q*q),N=M-$;return{sourceIntersection:O,targetIntersection:P,arrowStart:{x:O.x+N*C/M,y:O.y+N*q/M}}}rectangle.makeEdgeBetween=u;function s(F,D,$){var O=D.rayIntersection(F.x,F.y);O||(O={x:D.cx(),y:D.cy()});var P=O.x-F.x,C=O.y-F.y,q=Math.sqrt(P*P+C*C);return{x:O.x-$*P/q,y:O.y-$*C/q}}rectangle.makeEdgeTo=s;var c=function(){function F(D,$,O){this.v=D,this.r=$,this.pos=O,this.prev=f(),this.next=f()}return F}(),l=function(){function F(D,$,O){this.isOpen=D,this.v=$,this.pos=O}return F}();function d(F,D){return F.pos>D.pos?1:F.pos<D.pos||F.isOpen?-1:D.isOpen?1:0}function f(){return new r.RBTree(function(F,D){return F.pos-D.pos})}var h={getCentre:function(F){return F.cx()},getOpen:function(F){return F.y},getClose:function(F){return F.Y},getSize:function(F){return F.width()},makeRect:function(F,D,$,O){return new o($-O/2,$+O/2,F,D)},findNeighbours:_},v={getCentre:function(F){return F.cy()},getOpen:function(F){return F.x},getClose:function(F){return F.X},getSize:function(F){return F.height()},makeRect:function(F,D,$,O){return new o(F,D,$-O/2,$+O/2)},findNeighbours:S};function g(F,D,$,O){O===void 0&&(O=!1);var P=F.padding,C=typeof F.groups<"u"?F.groups.length:0,q=typeof F.leaves<"u"?F.leaves.length:0,M=C?F.groups.reduce(function(ce,J){return ce.concat(g(J,D,$,!0))},[]):[],N=(O?2:0)+q+C,G=new Array(N),X=new Array(N),Y=0,W=function(ce,J){X[Y]=ce,G[Y++]=J};if(O){var te=F.bounds,ue=D.getCentre(te),fe=D.getSize(te)/2,re=D.getOpen(te),ye=D.getClose(te),Te=ue-fe+P/2,Re=ue+fe-P/2;F.minVar.desiredPosition=Te,W(D.makeRect(re,ye,Te,P),F.minVar),F.maxVar.desiredPosition=Re,W(D.makeRect(re,ye,Re,P),F.maxVar)}q&&F.leaves.forEach(function(ce){return W(ce.bounds,ce.variable)}),C&&F.groups.forEach(function(ce){var J=ce.bounds;W(D.makeRect(D.getOpen(J),D.getClose(J),D.getCentre(J),D.getSize(J)),ce.minVar)});var ve=b(X,G,D,$);return C&&(G.forEach(function(ce){ce.cOut=[],ce.cIn=[]}),ve.forEach(function(ce){ce.left.cOut.push(ce),ce.right.cIn.push(ce)}),F.groups.forEach(function(ce){var J=(ce.padding-D.getSize(ce.bounds))/2;ce.minVar.cIn.forEach(function(j){return j.gap+=J}),ce.minVar.cOut.forEach(function(j){j.left=ce.maxVar,j.gap+=J})})),M.concat(ve)}function b(F,D,$,O){var P,C=F.length,q=2*C;console.assert(D.length>=C);var M=new Array(q);for(P=0;P<C;++P){var N=F[P],G=new c(D[P],N,$.getCentre(N));M[P]=new l(!0,G,$.getOpen(N)),M[P+C]=new l(!1,G,$.getClose(N))}M.sort(d);var X=new Array,Y=f();for(P=0;P<q;++P){var W=M[P],G=W.v;if(W.isOpen)Y.insert(G),$.findNeighbours(G,Y);else{Y.remove(G);var te=function(re,ye){var Te=($.getSize(re.r)+$.getSize(ye.r))/2+O;X.push(new t.Constraint(re.v,ye.v,Te))},ue=function(re,ye,Te){for(var Re,ve=G[re].iterator();(Re=ve[re]())!==null;)Te(Re,G),Re[ye].remove(G)};ue("prev","next",function(re,ye){return te(re,ye)}),ue("next","prev",function(re,ye){return te(ye,re)})}}return console.assert(Y.size===0),X}function _(F,D){var $=function(O,P){for(var C=D.findIter(F),q;(q=C[O]())!==null;){var M=q.r.overlapX(F.r);if((M<=0||M<=q.r.overlapY(F.r))&&(F[O].insert(q),q[P].insert(F)),M<=0)break}};$("next","prev"),$("prev","next")}function S(F,D){var $=function(O,P){var C=D.findIter(F)[O]();C!==null&&C.r.overlapX(F.r)>0&&(F[O].insert(C),C[P].insert(F))};$("next","prev"),$("prev","next")}function T(F,D){return b(F,D,h,1e-6)}rectangle.generateXConstraints=T;function w(F,D){return b(F,D,v,1e-6)}rectangle.generateYConstraints=w;function A(F){return g(F,h,1e-6)}rectangle.generateXGroupConstraints=A;function R(F){return g(F,v,1e-6)}rectangle.generateYGroupConstraints=R;function E(F){var D=F.map(function(P){return new t.Variable(P.cx())}),$=T(F,D),O=new t.Solver(D,$);O.solve(),D.forEach(function(P,C){return F[C].setXCentre(P.position())}),D=F.map(function(P){return new t.Variable(P.cy())}),$=w(F,D),O=new t.Solver(D,$),O.solve(),D.forEach(function(P,C){return F[C].setYCentre(P.position())})}rectangle.removeOverlaps=E;var I=function(F){n(D,F);function D($,O){var P=F.call(this,0,O)||this;return P.index=$,P}return D}(t.Variable);rectangle.IndexedVariable=I;var L=function(){function F(D,$,O,P,C){var q=this;if(O===void 0&&(O=null),P===void 0&&(P=null),C===void 0&&(C=!1),this.nodes=D,this.groups=$,this.rootGroup=O,this.avoidOverlaps=C,this.variables=D.map(function(N,G){return N.variable=new I(G,1)}),P&&this.createConstraints(P),C&&O&&typeof O.groups<"u"){D.forEach(function(N){if(!N.width||!N.height){N.bounds=new o(N.x,N.x,N.y,N.y);return}var G=N.width/2,X=N.height/2;N.bounds=new o(N.x-G,N.x+G,N.y-X,N.y+X)}),a(O);var M=D.length;$.forEach(function(N){q.variables[M]=N.minVar=new I(M++,typeof N.stiffness<"u"?N.stiffness:.01),q.variables[M]=N.maxVar=new I(M++,typeof N.stiffness<"u"?N.stiffness:.01)})}}return F.prototype.createSeparation=function(D){return new t.Constraint(this.nodes[D.left].variable,this.nodes[D.right].variable,D.gap,typeof D.equality<"u"?D.equality:!1)},F.prototype.makeFeasible=function(D){var $=this;if(this.avoidOverlaps){var O="x",P="width";D.axis==="x"&&(O="y",P="height");var C=D.offsets.map(function(M){return $.nodes[M.node]}).sort(function(M,N){return M[O]-N[O]}),q=null;C.forEach(function(M){if(q){var N=q[O]+q[P];N>M[O]&&(M[O]=N)}q=M})}},F.prototype.createAlignment=function(D){var $=this,O=this.nodes[D.offsets[0].node].variable;this.makeFeasible(D);var P=D.axis==="x"?this.xConstraints:this.yConstraints;D.offsets.slice(1).forEach(function(C){var q=$.nodes[C.node].variable;P.push(new t.Constraint(O,q,C.offset,!0))})},F.prototype.createConstraints=function(D){var $=this,O=function(P){return typeof P.type>"u"||P.type==="separation"};this.xConstraints=D.filter(function(P){return P.axis==="x"&&O(P)}).map(function(P){return $.createSeparation(P)}),this.yConstraints=D.filter(function(P){return P.axis==="y"&&O(P)}).map(function(P){return $.createSeparation(P)}),D.filter(function(P){return P.type==="alignment"}).forEach(function(P){return $.createAlignment(P)})},F.prototype.setupVariablesAndBounds=function(D,$,O,P){this.nodes.forEach(function(C,q){C.fixed?(C.variable.weight=C.fixedWeight?C.fixedWeight:1e3,O[q]=P(C)):C.variable.weight=1;var M=(C.width||0)/2,N=(C.height||0)/2,G=D[q],X=$[q];C.bounds=new o(G-M,G+M,X-N,X+N)})},F.prototype.xProject=function(D,$,O){!this.rootGroup&&!(this.avoidOverlaps||this.xConstraints)||this.project(D,$,D,O,function(P){return P.px},this.xConstraints,A,function(P){return P.bounds.setXCentre(O[P.variable.index]=P.variable.position())},function(P){var C=O[P.minVar.index]=P.minVar.position(),q=O[P.maxVar.index]=P.maxVar.position(),M=P.padding/2;P.bounds.x=C-M,P.bounds.X=q+M})},F.prototype.yProject=function(D,$,O){!this.rootGroup&&!this.yConstraints||this.project(D,$,$,O,function(P){return P.py},this.yConstraints,R,function(P){return P.bounds.setYCentre(O[P.variable.index]=P.variable.position())},function(P){var C=O[P.minVar.index]=P.minVar.position(),q=O[P.maxVar.index]=P.maxVar.position(),M=P.padding/2;P.bounds.y=C-M,P.bounds.Y=q+M})},F.prototype.projectFunctions=function(){var D=this;return[function($,O,P){return D.xProject($,O,P)},function($,O,P){return D.yProject($,O,P)}]},F.prototype.project=function(D,$,O,P,C,q,M,N,G){this.setupVariablesAndBounds(D,$,P,C),this.rootGroup&&this.avoidOverlaps&&(a(this.rootGroup),q=q.concat(M(this.rootGroup))),this.solve(this.variables,q,O,P),this.nodes.forEach(N),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(G),a(this.rootGroup))},F.prototype.solve=function(D,$,O,P){var C=new t.Solver(D,$);C.setStartingPositions(O),C.setDesiredPositions(P),C.solve()},F}();return rectangle.Projection=L,rectangle}var shortestpaths={},pqueue={},hasRequiredPqueue;function requirePqueue(){if(hasRequiredPqueue)return pqueue;hasRequiredPqueue=1,Object.defineProperty(pqueue,"__esModule",{value:!0});var n=function(){function r(a){this.elem=a,this.subheaps=[]}return r.prototype.toString=function(a){for(var o="",u=!1,s=0;s<this.subheaps.length;++s){var c=this.subheaps[s];if(!c.elem){u=!1;continue}u&&(o=o+","),o=o+c.toString(a),u=!0}return o!==""&&(o="("+o+")"),(this.elem?a(this.elem):"")+o},r.prototype.forEach=function(a){this.empty()||(a(this.elem,this),this.subheaps.forEach(function(o){return o.forEach(a)}))},r.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce(function(a,o){return a+o.count()},0)},r.prototype.min=function(){return this.elem},r.prototype.empty=function(){return this.elem==null},r.prototype.contains=function(a){if(this===a)return!0;for(var o=0;o<this.subheaps.length;o++)if(this.subheaps[o].contains(a))return!0;return!1},r.prototype.isHeap=function(a){var o=this;return this.subheaps.every(function(u){return a(o.elem,u.elem)&&u.isHeap(a)})},r.prototype.insert=function(a,o){return this.merge(new r(a),o)},r.prototype.merge=function(a,o){return this.empty()?a:a.empty()?this:o(this.elem,a.elem)?(this.subheaps.push(a),this):(a.subheaps.push(this),a)},r.prototype.removeMin=function(a){return this.empty()?null:this.mergePairs(a)},r.prototype.mergePairs=function(a){if(this.subheaps.length==0)return new r(null);if(this.subheaps.length==1)return this.subheaps[0];var o=this.subheaps.pop().merge(this.subheaps.pop(),a),u=this.mergePairs(a);return o.merge(u,a)},r.prototype.decreaseKey=function(a,o,u,s){var c=a.removeMin(s);a.elem=c.elem,a.subheaps=c.subheaps,u!==null&&c.elem!==null&&u(a.elem,a);var l=new r(o);return u!==null&&u(o,l),this.merge(l,s)},r}();pqueue.PairingHeap=n;var t=function(){function r(a){this.lessThan=a}return r.prototype.top=function(){return this.empty()?null:this.root.elem},r.prototype.push=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];for(var u,s=0,c;c=a[s];++s)u=new n(c),this.root=this.empty()?u:this.root.merge(u,this.lessThan);return u},r.prototype.empty=function(){return!this.root||!this.root.elem},r.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},r.prototype.forEach=function(a){this.root.forEach(a)},r.prototype.pop=function(){if(this.empty())return null;var a=this.root.min();return this.root=this.root.removeMin(this.lessThan),a},r.prototype.reduceKey=function(a,o,u){u===void 0&&(u=null),this.root=this.root.decreaseKey(a,o,u,this.lessThan)},r.prototype.toString=function(a){return this.root.toString(a)},r.prototype.count=function(){return this.root.count()},r}();return pqueue.PriorityQueue=t,pqueue}var hasRequiredShortestpaths;function requireShortestpaths(){if(hasRequiredShortestpaths)return shortestpaths;hasRequiredShortestpaths=1,Object.defineProperty(shortestpaths,"__esModule",{value:!0});var n=requirePqueue(),t=function(){function u(s,c){this.id=s,this.distance=c}return u}(),r=function(){function u(s){this.id=s,this.neighbours=[]}return u}(),a=function(){function u(s,c,l){this.node=s,this.prev=c,this.d=l}return u}(),o=function(){function u(s,c,l,d,f){this.n=s,this.es=c,this.neighbours=new Array(this.n);for(var h=this.n;h--;)this.neighbours[h]=new r(h);for(h=this.es.length;h--;){var v=this.es[h],g=l(v),b=d(v),_=f(v);this.neighbours[g].neighbours.push(new t(b,_)),this.neighbours[b].neighbours.push(new t(g,_))}}return u.prototype.DistanceMatrix=function(){for(var s=new Array(this.n),c=0;c<this.n;++c)s[c]=this.dijkstraNeighbours(c);return s},u.prototype.DistancesFromNode=function(s){return this.dijkstraNeighbours(s)},u.prototype.PathFromNodeToNode=function(s,c){return this.dijkstraNeighbours(s,c)},u.prototype.PathFromNodeToNodeWithPrevCost=function(s,c,l){var d=new n.PriorityQueue(function(R,E){return R.d<=E.d}),f=this.neighbours[s],h=new a(f,null,0),v={};for(d.push(h);!d.empty()&&(h=d.pop(),f=h.node,f.id!==c);)for(var g=f.neighbours.length;g--;){var b=f.neighbours[g],_=this.neighbours[b.id];if(!(h.prev&&_.id===h.prev.node.id)){var S=_.id+","+f.id;if(!(S in v&&v[S]<=h.d)){var T=h.prev?l(h.prev.node.id,f.id,_.id):0,w=h.d+b.distance+T;v[S]=w,d.push(new a(_,h,w))}}}for(var A=[];h.prev;)h=h.prev,A.push(h.node.id);return A},u.prototype.dijkstraNeighbours=function(s,c){c===void 0&&(c=-1);for(var l=new n.PriorityQueue(function(T,w){return T.d<=w.d}),d=this.neighbours.length,f=new Array(d);d--;){var h=this.neighbours[d];h.d=d===s?0:Number.POSITIVE_INFINITY,h.q=l.push(h)}for(;!l.empty();){var v=l.pop();if(f[v.id]=v.d,v.id===c){for(var g=[],b=v;typeof b.prev<"u";)g.push(b.prev.id),b=b.prev;return g}for(d=v.neighbours.length;d--;){var _=v.neighbours[d],b=this.neighbours[_.id],S=v.d+_.distance;v.d!==Number.MAX_VALUE&&b.d>S&&(b.d=S,b.prev=v,l.reduceKey(b.q,b,function(w,A){return w.q=A}))}}return f},u}();return shortestpaths.Calculator=o,shortestpaths}var geom={},hasRequiredGeom;function requireGeom(){if(hasRequiredGeom)return geom;hasRequiredGeom=1;var n=geom&&geom.__extends||function(){var C=function(q,M){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,G){N.__proto__=G}||function(N,G){for(var X in G)G.hasOwnProperty(X)&&(N[X]=G[X])},C(q,M)};return function(q,M){C(q,M);function N(){this.constructor=q}q.prototype=M===null?Object.create(M):(N.prototype=M.prototype,new N)}}();Object.defineProperty(geom,"__esModule",{value:!0});var t=requireRectangle(),r=function(){function C(){}return C}();geom.Point=r;var a=function(){function C(q,M,N,G){this.x1=q,this.y1=M,this.x2=N,this.y2=G}return C}();geom.LineSegment=a;var o=function(C){n(q,C);function q(){return C!==null&&C.apply(this,arguments)||this}return q}(r);geom.PolyPoint=o;function u(C,q,M){return(q.x-C.x)*(M.y-C.y)-(M.x-C.x)*(q.y-C.y)}geom.isLeft=u;function s(C,q,M){return u(C,q,M)>0}function c(C,q,M){return u(C,q,M)<0}function l(C){var q=C.slice(0).sort(function(ye,Te){return ye.x!==Te.x?Te.x-ye.x:Te.y-ye.y}),M=C.length,N,G=0,X=q[0].x;for(N=1;N<M&&q[N].x===X;++N);var Y=N-1,W=[];if(W.push(q[G]),Y===M-1)q[Y].y!==q[G].y&&W.push(q[Y]);else{var te,ue=M-1,fe=q[M-1].x;for(N=M-2;N>=0&&q[N].x===fe;N--);for(te=N+1,N=Y;++N<=te;)if(!(u(q[G],q[te],q[N])>=0&&N<te)){for(;W.length>1&&!(u(W[W.length-2],W[W.length-1],q[N])>0);)W.length-=1;N!=G&&W.push(q[N])}ue!=te&&W.push(q[ue]);var re=W.length;for(N=te;--N>=Y;)if(!(u(q[ue],q[Y],q[N])>=0&&N>Y)){for(;W.length>re&&!(u(W[W.length-2],W[W.length-1],q[N])>0);)W.length-=1;N!=G&&W.push(q[N])}}return W}geom.ConvexHull=l;function d(C,q,M){q.slice(0).sort(function(N,G){return Math.atan2(N.y-C.y,N.x-C.x)-Math.atan2(G.y-C.y,G.x-C.x)}).forEach(M)}geom.clockwiseRadialSweep=d;function f(C,q){var M=q.slice(0);return M.push(q[0]),{rtan:h(C,M),ltan:v(C,M)}}function h(C,q){var M=q.length-1,N,G,X,Y,W;if(c(C,q[1],q[0])&&!s(C,q[M-1],q[0]))return 0;for(N=0,G=M;;){if(G-N===1)return s(C,q[N],q[G])?N:G;if(X=Math.floor((N+G)/2),W=c(C,q[X+1],q[X]),W&&!s(C,q[X-1],q[X]))return X;Y=s(C,q[N+1],q[N]),Y?W||s(C,q[N],q[X])?G=X:N=X:W&&c(C,q[N],q[X])?G=X:N=X}}function v(C,q){var M=q.length-1,N,G,X,Y,W;if(s(C,q[M-1],q[0])&&!c(C,q[1],q[0]))return 0;for(N=0,G=M;;){if(G-N===1)return c(C,q[N],q[G])?N:G;if(X=Math.floor((N+G)/2),W=c(C,q[X+1],q[X]),s(C,q[X-1],q[X])&&!W)return X;Y=c(C,q[N+1],q[N]),Y?W?c(C,q[N],q[X])?G=X:N=X:G=X:W?N=X:s(C,q[N],q[X])?G=X:N=X}}function g(C,q,M,N,G,X){var Y,W;Y=M(q[0],C),W=N(C[Y],q);for(var te=!1;!te;){for(te=!0;Y===C.length-1&&(Y=0),!G(q[W],C[Y],C[Y+1]);)++Y;for(;W===0&&(W=q.length-1),!X(C[Y],q[W],q[W-1]);)--W,te=!1}return{t1:Y,t2:W}}geom.tangent_PolyPolyC=g;function b(C,q){var M=_(q,C);return{t1:M.t2,t2:M.t1}}geom.LRtangent_PolyPolyC=b;function _(C,q){return g(C,q,h,v,s,c)}geom.RLtangent_PolyPolyC=_;function S(C,q){return g(C,q,v,v,c,c)}geom.LLtangent_PolyPolyC=S;function T(C,q){return g(C,q,h,h,s,s)}geom.RRtangent_PolyPolyC=T;var w=function(){function C(q,M){this.t1=q,this.t2=M}return C}();geom.BiTangent=w;var A=function(){function C(){}return C}();geom.BiTangents=A;var R=function(C){n(q,C);function q(){return C!==null&&C.apply(this,arguments)||this}return q}(r);geom.TVGPoint=R;var E=function(){function C(q,M,N,G){this.id=q,this.polyid=M,this.polyvertid=N,this.p=G,G.vv=this}return C}();geom.VisibilityVertex=E;var I=function(){function C(q,M){this.source=q,this.target=M}return C.prototype.length=function(){var q=this.source.p.x-this.target.p.x,M=this.source.p.y-this.target.p.y;return Math.sqrt(q*q+M*M)},C}();geom.VisibilityEdge=I;var L=function(){function C(q,M){if(this.P=q,this.V=[],this.E=[],M)this.V=M.V.slice(0),this.E=M.E.slice(0);else{for(var N=q.length,G=0;G<N;G++){for(var X=q[G],Y=0;Y<X.length;++Y){var W=X[Y],te=new E(this.V.length,G,Y,W);this.V.push(te),Y>0&&this.E.push(new I(X[Y-1].vv,te))}X.length>1&&this.E.push(new I(X[0].vv,X[X.length-1].vv))}for(var G=0;G<N-1;G++)for(var ue=q[G],Y=G+1;Y<N;Y++){var fe=q[Y],re=D(ue,fe);for(var ye in re){var Te=re[ye],Re=ue[Te.t1],ve=fe[Te.t2];this.addEdgeIfVisible(Re,ve,G,Y)}}}}return C.prototype.addEdgeIfVisible=function(q,M,N,G){this.intersectsPolys(new a(q.x,q.y,M.x,M.y),N,G)||this.E.push(new I(q.vv,M.vv))},C.prototype.addPoint=function(q,M){var N=this.P.length;this.V.push(new E(this.V.length,N,0,q));for(var G=0;G<N;++G)if(G!==M){var X=this.P[G],Y=f(q,X);this.addEdgeIfVisible(q,X[Y.ltan],M,G),this.addEdgeIfVisible(q,X[Y.rtan],M,G)}return q.vv},C.prototype.intersectsPolys=function(q,M,N){for(var G=0,X=this.P.length;G<X;++G)if(G!=M&&G!=N&&F(q,this.P[G]).length>0)return!0;return!1},C}();geom.TangentVisibilityGraph=L;function F(C,q){for(var M=[],N=1,G=q.length;N<G;++N){var X=t.Rectangle.lineIntersection(C.x1,C.y1,C.x2,C.y2,q[N-1].x,q[N-1].y,q[N].x,q[N].y);X&&M.push(X)}return M}function D(C,q){for(var M=C.length-1,N=q.length-1,G=new A,X=0;X<M;++X)for(var Y=0;Y<N;++Y){var W=C[X==0?M-1:X-1],te=C[X],ue=C[X+1],fe=q[Y==0?N-1:Y-1],re=q[Y],ye=q[Y+1],Te=u(W,te,re),Re=u(te,fe,re),ve=u(te,re,ye),ce=u(fe,re,te),J=u(re,W,te),j=u(re,te,ue);Te>=0&&Re>=0&&ve<0&&ce>=0&&J>=0&&j<0?G.ll=new w(X,Y):Te<=0&&Re<=0&&ve>0&&ce<=0&&J<=0&&j>0?G.rr=new w(X,Y):Te<=0&&Re>0&&ve<=0&&ce>=0&&J<0&&j>=0?G.rl=new w(X,Y):Te>=0&&Re<0&&ve>=0&&ce<=0&&J>0&&j<=0&&(G.lr=new w(X,Y))}return G}geom.tangents=D;function $(C,q){for(var M=1,N=q.length;M<N;++M)if(c(q[M-1],q[M],C))return!1;return!0}function O(C,q){return!C.every(function(M){return!$(M,q)})}function P(C,q){if(O(C,q)||O(q,C))return!0;for(var M=1,N=C.length;M<N;++M){var G=C[M],X=C[M-1];if(F(new a(X.x,X.y,G.x,G.y),q).length>0)return!0}return!1}return geom.polysOverlap=P,geom}var handledisconnected={},hasRequiredHandledisconnected;function requireHandledisconnected(){if(hasRequiredHandledisconnected)return handledisconnected;hasRequiredHandledisconnected=1,Object.defineProperty(handledisconnected,"__esModule",{value:!0});var n={PADDING:10,GOLDEN_SECTION:(1+Math.sqrt(5))/2,FLOAT_EPSILON:1e-4};function t(a,o,u,b,g,l){g===void 0&&(g=1),l===void 0&&(l=!0);var d=0,f=0,h=o,v=u,g=typeof g<"u"?g:1,b=typeof b<"u"?b:0,_=0,S=0,T=0,w=0,A=[];if(a.length==0)return;R(a),I(a),l&&E(a);function R(O){O.forEach(function(C){P(C)});function P(C){var q=Number.MAX_VALUE,M=Number.MAX_VALUE,N=0,G=0;C.array.forEach(function(X){var Y=typeof X.width<"u"?X.width:b,W=typeof X.height<"u"?X.height:b;Y/=2,W/=2,N=Math.max(X.x+Y,N),q=Math.min(X.x-Y,q),G=Math.max(X.y+W,G),M=Math.min(X.y-W,M)}),C.width=N-q,C.height=G-M}}function E(O){O.forEach(function(P){var C={x:0,y:0};P.array.forEach(function(N){C.x+=N.x,C.y+=N.y}),C.x/=P.array.length,C.y/=P.array.length;var q={x:C.x-P.width/2,y:C.y-P.height/2},M={x:P.x-q.x+h/2-_/2,y:P.y-q.y+v/2-S/2};P.array.forEach(function(N){N.x+=M.x,N.y+=M.y})})}function I(O,P){var C=Number.POSITIVE_INFINITY,q=0;O.sort(function(ye,Te){return Te.height-ye.height}),T=O.reduce(function(ye,Te){return ye.width<Te.width?ye.width:Te.width});for(var M=fe=T,N=re=D(O),G=0,X=Number.MAX_VALUE,Y=Number.MAX_VALUE,W=-1,te=Number.MAX_VALUE,ue=Number.MAX_VALUE;te>T||ue>n.FLOAT_EPSILON;){if(W!=1)var fe=N-(N-M)/n.GOLDEN_SECTION,X=L(O,fe);if(W!=0)var re=M+(N-M)/n.GOLDEN_SECTION,Y=L(O,re);if(te=Math.abs(fe-re),ue=Math.abs(X-Y),X<C&&(C=X,q=fe),Y<C&&(C=Y,q=re),X>Y?(M=fe,fe=re,X=Y,W=1):(N=re,re=fe,Y=X,W=0),G++>100)break}L(O,q)}function L(O,P){A=[],_=0,S=0,w=f;for(var C=0;C<O.length;C++){var q=O[C];F(q,P)}return Math.abs($()-g)}function F(O,P){for(var C=void 0,q=0;q<A.length;q++)if(A[q].space_left>=O.height&&A[q].x+A[q].width+O.width+n.PADDING-P<=n.FLOAT_EPSILON){C=A[q];break}A.push(O),C!==void 0?(O.x=C.x+C.width+n.PADDING,O.y=C.bottom,O.space_left=O.height,O.bottom=O.y,C.space_left-=O.height+n.PADDING,C.bottom+=O.height+n.PADDING):(O.y=w,w+=O.height+n.PADDING,O.x=d,O.bottom=O.y,O.space_left=O.height),O.y+O.height-S>-1e-4&&(S=O.y+O.height-f),O.x+O.width-_>-1e-4&&(_=O.x+O.width-d)}function D(O){var P=0;return O.forEach(function(C){return P+=C.width+n.PADDING}),P}function $(){return _/S}}handledisconnected.applyPacking=t;function r(a,o){for(var u={},s={},c=[],l=0,d=0;d<o.length;d++){var f=o[d],h=f.source,v=f.target;s[h.index]?s[h.index].push(v):s[h.index]=[v],s[v.index]?s[v.index].push(h):s[v.index]=[h]}for(var d=0;d<a.length;d++){var g=a[d];u[g.index]||b(g,!0)}function b(_,S){if(u[_.index]===void 0){S&&(l++,c.push({array:[]})),u[_.index]=l,c[l-1].array.push(_);var T=s[_.index];if(T)for(var w=0;w<T.length;w++)b(T[w],!1)}}return c}return handledisconnected.separateGraphs=r,handledisconnected}var hasRequiredLayout;function requireLayout(){return hasRequiredLayout||(hasRequiredLayout=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=requirePowergraph(),r=requireLinklengths(),a=requireDescent(),o=requireRectangle(),u=requireShortestpaths(),s=requireGeom(),c=requireHandledisconnected(),l;(function(h){h[h.start=0]="start",h[h.tick=1]="tick",h[h.end=2]="end"})(l=n.EventType||(n.EventType={}));function d(h){return typeof h.leaves<"u"||typeof h.groups<"u"}var f=function(){function h(){var v=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:h.getSourceIndex,getTargetIndex:h.getTargetIndex,setLength:h.setLinkLength,getType:function(g){return typeof v._linkType=="function"?v._linkType(g):0}}}return h.prototype.on=function(v,g){return this.event||(this.event={}),typeof v=="string"?this.event[l[v]]=g:this.event[v]=g,this},h.prototype.trigger=function(v){this.event&&typeof this.event[v.type]<"u"&&this.event[v.type](v)},h.prototype.kick=function(){for(;!this.tick(););},h.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:l.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var v=this._nodes.length;this._links.length;var g,b;for(this._descent.locks.clear(),b=0;b<v;++b)if(g=this._nodes[b],g.fixed){(typeof g.px>"u"||typeof g.py>"u")&&(g.px=g.x,g.py=g.y);var _=[g.px,g.py];this._descent.locks.add(b,_)}var S=this._descent.rungeKutta();return S===0?this._alpha=0:typeof this._lastStress<"u"&&(this._alpha=S),this._lastStress=S,this.updateNodePositions(),this.trigger({type:l.tick,alpha:this._alpha,stress:this._lastStress}),!1},h.prototype.updateNodePositions=function(){for(var v=this._descent.x[0],g=this._descent.x[1],b,_=this._nodes.length;_--;)b=this._nodes[_],b.x=v[_],b.y=g[_]},h.prototype.nodes=function(v){if(!v){if(this._nodes.length===0&&this._links.length>0){var g=0;this._links.forEach(function(_){g=Math.max(g,_.source,_.target)}),this._nodes=new Array(++g);for(var b=0;b<g;++b)this._nodes[b]={}}return this._nodes}return this._nodes=v,this},h.prototype.groups=function(v){var g=this;return v?(this._groups=v,this._rootGroup={},this._groups.forEach(function(b){typeof b.padding>"u"&&(b.padding=1),typeof b.leaves<"u"&&b.leaves.forEach(function(_,S){typeof _=="number"&&((b.leaves[S]=g._nodes[_]).parent=b)}),typeof b.groups<"u"&&b.groups.forEach(function(_,S){typeof _=="number"&&((b.groups[S]=g._groups[_]).parent=b)})}),this._rootGroup.leaves=this._nodes.filter(function(b){return typeof b.parent>"u"}),this._rootGroup.groups=this._groups.filter(function(b){return typeof b.parent>"u"}),this):this._groups},h.prototype.powerGraphGroups=function(v){var g=t.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(g.groups),v(g),this},h.prototype.avoidOverlaps=function(v){return arguments.length?(this._avoidOverlaps=v,this):this._avoidOverlaps},h.prototype.handleDisconnected=function(v){return arguments.length?(this._handleDisconnected=v,this):this._handleDisconnected},h.prototype.flowLayout=function(v,g){return arguments.length||(v="y"),this._directedLinkConstraints={axis:v,getMinSeparation:typeof g=="number"?function(){return g}:g},this},h.prototype.links=function(v){return arguments.length?(this._links=v,this):this._links},h.prototype.constraints=function(v){return arguments.length?(this._constraints=v,this):this._constraints},h.prototype.distanceMatrix=function(v){return arguments.length?(this._distanceMatrix=v,this):this._distanceMatrix},h.prototype.size=function(v){return v?(this._canvasSize=v,this):this._canvasSize},h.prototype.defaultNodeSize=function(v){return v?(this._defaultNodeSize=v,this):this._defaultNodeSize},h.prototype.groupCompactness=function(v){return v?(this._groupCompactness=v,this):this._groupCompactness},h.prototype.linkDistance=function(v){return v?(this._linkDistance=typeof v=="function"?v:+v,this._linkLengthCalculator=null,this):this._linkDistance},h.prototype.linkType=function(v){return this._linkType=v,this},h.prototype.convergenceThreshold=function(v){return v?(this._threshold=typeof v=="function"?v:+v,this):this._threshold},h.prototype.alpha=function(v){return arguments.length?(v=+v,this._alpha?v>0?this._alpha=v:this._alpha=0:v>0&&(this._running||(this._running=!0,this.trigger({type:l.start,alpha:this._alpha=v}),this.kick())),this):this._alpha},h.prototype.getLinkLength=function(v){return typeof this._linkDistance=="function"?+this._linkDistance(v):this._linkDistance},h.setLinkLength=function(v,g){v.length=g},h.prototype.getLinkType=function(v){return typeof this._linkType=="function"?this._linkType(v):0},h.prototype.symmetricDiffLinkLengths=function(v,g){var b=this;return g===void 0&&(g=1),this.linkDistance(function(_){return v*_.length}),this._linkLengthCalculator=function(){return r.symmetricDiffLinkLengths(b._links,b.linkAccessor,g)},this},h.prototype.jaccardLinkLengths=function(v,g){var b=this;return g===void 0&&(g=1),this.linkDistance(function(_){return v*_.length}),this._linkLengthCalculator=function(){return r.jaccardLinkLengths(b._links,b.linkAccessor,g)},this},h.prototype.start=function(v,g,b,_,S,T){var w=this;v===void 0&&(v=0),g===void 0&&(g=0),b===void 0&&(b=0),_===void 0&&(_=0),S===void 0&&(S=!0),T===void 0&&(T=!0);var A,R=this.nodes().length,E=R+2*this._groups.length;this._links.length;var I=this._canvasSize[0],L=this._canvasSize[1],F=new Array(E),D=new Array(E),$=null,O=this._avoidOverlaps;this._nodes.forEach(function(Y,W){Y.index=W,typeof Y.x>"u"&&(Y.x=I/2,Y.y=L/2),F[W]=Y.x,D[W]=Y.y}),this._linkLengthCalculator&&this._linkLengthCalculator();var P;this._distanceMatrix?P=this._distanceMatrix:(P=new u.Calculator(E,this._links,h.getSourceIndex,h.getTargetIndex,function(Y){return w.getLinkLength(Y)}).DistanceMatrix(),$=a.Descent.createSquareMatrix(E,function(){return 2}),this._links.forEach(function(Y){typeof Y.source=="number"&&(Y.source=w._nodes[Y.source]),typeof Y.target=="number"&&(Y.target=w._nodes[Y.target])}),this._links.forEach(function(Y){var W=h.getSourceIndex(Y),te=h.getTargetIndex(Y);$[W][te]=$[te][W]=Y.weight||1}));var C=a.Descent.createSquareMatrix(E,function(Y,W){return P[Y][W]});if(this._rootGroup&&typeof this._rootGroup.groups<"u"){var A=R,q=function(W,te,ue,fe){$[W][te]=$[te][W]=ue,C[W][te]=C[te][W]=fe};this._groups.forEach(function(W){q(A,A+1,w._groupCompactness,.1),F[A]=0,D[A++]=0,F[A]=0,D[A++]=0})}else this._rootGroup={leaves:this._nodes,groups:[]};var M=this._constraints||[];this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,M=M.concat(r.generateDirectedEdgeConstraints(R,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new a.Descent([F,D],C),this._descent.locks.clear();for(var A=0;A<R;++A){var N=this._nodes[A];if(N.fixed){N.px=N.x,N.py=N.y;var G=[N.x,N.y];this._descent.locks.add(A,G)}}if(this._descent.threshold=this._threshold,this.initialLayout(v,F,D),M.length>0&&(this._descent.project=new o.Projection(this._nodes,this._groups,this._rootGroup,M).projectFunctions()),this._descent.run(g),this.separateOverlappingComponents(I,L,T),this.avoidOverlaps(O),O&&(this._nodes.forEach(function(Y,W){Y.x=F[W],Y.y=D[W]}),this._descent.project=new o.Projection(this._nodes,this._groups,this._rootGroup,M,!0).projectFunctions(),this._nodes.forEach(function(Y,W){F[W]=Y.x,D[W]=Y.y})),this._descent.G=$,this._descent.run(b),_){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=R,this._descent.scaleSnapByMaxH=R!=E;var X=a.Descent.createSquareMatrix(E,function(Y,W){return Y>=R||W>=R?$[Y][W]:0});this._descent.G=X,this._descent.run(_)}return this.updateNodePositions(),this.separateOverlappingComponents(I,L,T),S?this.resume():this},h.prototype.initialLayout=function(v,g,b){if(this._groups.length>0&&v>0){var _=this._nodes.length,S=this._links.map(function(w){return{source:w.source.index,target:w.target.index}}),T=this._nodes.map(function(w){return{index:w.index}});this._groups.forEach(function(w,A){T.push({index:w.index=_+A})}),this._groups.forEach(function(w,A){typeof w.leaves<"u"&&w.leaves.forEach(function(R){return S.push({source:w.index,target:R.index})}),typeof w.groups<"u"&&w.groups.forEach(function(R){return S.push({source:w.index,target:R.index})})}),new h().size(this.size()).nodes(T).links(S).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(v,0,0,0,!1),this._nodes.forEach(function(w){g[w.index]=T[w.index].x,b[w.index]=T[w.index].y})}else this._descent.run(v)},h.prototype.separateOverlappingComponents=function(v,g,b){var _=this;if(b===void 0&&(b=!0),!this._distanceMatrix&&this._handleDisconnected){var S=this._descent.x[0],T=this._descent.x[1];this._nodes.forEach(function(A,R){A.x=S[R],A.y=T[R]});var w=c.separateGraphs(this._nodes,this._links);c.applyPacking(w,v,g,this._defaultNodeSize,1,b),this._nodes.forEach(function(A,R){_._descent.x[0][R]=A.x,_._descent.x[1][R]=A.y,A.bounds&&(A.bounds.setXCentre(A.x),A.bounds.setYCentre(A.y))})}},h.prototype.resume=function(){return this.alpha(.1)},h.prototype.stop=function(){return this.alpha(0)},h.prototype.prepareEdgeRouting=function(v){v===void 0&&(v=0),this._visibilityGraph=new s.TangentVisibilityGraph(this._nodes.map(function(g){return g.bounds.inflate(-v).vertices()}))},h.prototype.routeEdge=function(v,g,b){g===void 0&&(g=5);var _=[],S=new s.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),T={x:v.source.x,y:v.source.y},w={x:v.target.x,y:v.target.y},A=S.addPoint(T,v.source.index),R=S.addPoint(w,v.target.index);S.addEdgeIfVisible(T,w,v.source.index,v.target.index),typeof b<"u"&&b(S);var E=function(M){return M.source.id},I=function(M){return M.target.id},L=function(M){return M.length()},F=new u.Calculator(S.V.length,S.E,E,I,L),D=F.PathFromNodeToNode(A.id,R.id);if(D.length===1||D.length===S.V.length){var $=o.makeEdgeBetween(v.source.innerBounds,v.target.innerBounds,g);_=[$.sourceIntersection,$.arrowStart]}else{for(var O=D.length-2,P=S.V[D[O]].p,C=S.V[D[0]].p,_=[v.source.innerBounds.rayIntersection(P.x,P.y)],q=O;q>=0;--q)_.push(S.V[D[q]].p);_.push(o.makeEdgeTo(C,v.target.innerBounds,g))}return _},h.getSourceIndex=function(v){return typeof v.source=="number"?v.source:v.source.index},h.getTargetIndex=function(v){return typeof v.target=="number"?v.target:v.target.index},h.linkId=function(v){return h.getSourceIndex(v)+"-"+h.getTargetIndex(v)},h.dragStart=function(v){d(v)?h.storeOffset(v,h.dragOrigin(v)):(h.stopNode(v),v.fixed|=2)},h.stopNode=function(v){v.px=v.x,v.py=v.y},h.storeOffset=function(v,g){typeof v.leaves<"u"&&v.leaves.forEach(function(b){b.fixed|=2,h.stopNode(b),b._dragGroupOffsetX=b.x-g.x,b._dragGroupOffsetY=b.y-g.y}),typeof v.groups<"u"&&v.groups.forEach(function(b){return h.storeOffset(b,g)})},h.dragOrigin=function(v){return d(v)?{x:v.bounds.cx(),y:v.bounds.cy()}:v},h.drag=function(v,g){d(v)?(typeof v.leaves<"u"&&v.leaves.forEach(function(b){v.bounds.setXCentre(g.x),v.bounds.setYCentre(g.y),b.px=b._dragGroupOffsetX+g.x,b.py=b._dragGroupOffsetY+g.y}),typeof v.groups<"u"&&v.groups.forEach(function(b){return h.drag(b,g)})):(v.px=g.x,v.py=g.y)},h.dragEnd=function(v){d(v)?(typeof v.leaves<"u"&&v.leaves.forEach(function(g){h.dragEnd(g),delete g._dragGroupOffsetX,delete g._dragGroupOffsetY}),typeof v.groups<"u"&&v.groups.forEach(h.dragEnd)):v.fixed&=-7},h.mouseOver=function(v){v.fixed|=4,v.px=v.x,v.py=v.y},h.mouseOut=function(v){v.fixed&=-5},h}();n.Layout=f}(layout)),layout}var hasRequiredAdaptor;function requireAdaptor(){if(hasRequiredAdaptor)return adaptor;hasRequiredAdaptor=1;var n=adaptor&&adaptor.__extends||function(){var o=function(u,s){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var d in l)l.hasOwnProperty(d)&&(c[d]=l[d])},o(u,s)};return function(u,s){o(u,s);function c(){this.constructor=u}u.prototype=s===null?Object.create(s):(c.prototype=s.prototype,new c)}}();Object.defineProperty(adaptor,"__esModule",{value:!0});var t=requireLayout(),r=function(o){n(u,o);function u(s){var c=o.call(this)||this,l=s;return l.trigger&&(c.trigger=l.trigger),l.kick&&(c.kick=l.kick),l.drag&&(c.drag=l.drag),l.on&&(c.on=l.on),c.dragstart=c.dragStart=t.Layout.dragStart,c.dragend=c.dragEnd=t.Layout.dragEnd,c}return u.prototype.trigger=function(s){},u.prototype.kick=function(){},u.prototype.drag=function(){},u.prototype.on=function(s,c){return this},u}(t.Layout);adaptor.LayoutAdaptor=r;function a(o){return new r(o)}return adaptor.adaptor=a,adaptor}var d3adaptor={},d3v3adaptor={},hasRequiredD3v3adaptor;function requireD3v3adaptor(){if(hasRequiredD3v3adaptor)return d3v3adaptor;hasRequiredD3v3adaptor=1;var n=d3v3adaptor&&d3v3adaptor.__extends||function(){var o=function(u,s){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,l){c.__proto__=l}||function(c,l){for(var d in l)l.hasOwnProperty(d)&&(c[d]=l[d])},o(u,s)};return function(u,s){o(u,s);function c(){this.constructor=u}u.prototype=s===null?Object.create(s):(c.prototype=s.prototype,new c)}}();Object.defineProperty(d3v3adaptor,"__esModule",{value:!0});var t=requireLayout(),r=function(o){n(u,o);function u(){var s=o.call(this)||this;s.event=d3.dispatch(t.EventType[t.EventType.start],t.EventType[t.EventType.tick],t.EventType[t.EventType.end]);var c=s;return s.drag=function(){if(!l)var l=d3.behavior.drag().origin(t.Layout.dragOrigin).on("dragstart.d3adaptor",t.Layout.dragStart).on("drag.d3adaptor",function(d){t.Layout.drag(d,d3.event),c.resume()}).on("dragend.d3adaptor",t.Layout.dragEnd);if(!arguments.length)return l;this.call(l)},s}return u.prototype.trigger=function(s){var c={type:t.EventType[s.type],alpha:s.alpha,stress:s.stress};this.event[c.type](c)},u.prototype.kick=function(){var s=this;d3.timer(function(){return o.prototype.tick.call(s)})},u.prototype.on=function(s,c){return typeof s=="string"?this.event.on(s,c):this.event.on(t.EventType[s],c),this},u}(t.Layout);d3v3adaptor.D3StyleLayoutAdaptor=r;function a(){return new r}return d3v3adaptor.d3adaptor=a,d3v3adaptor}var d3v4adaptor={},hasRequiredD3v4adaptor;function requireD3v4adaptor(){if(hasRequiredD3v4adaptor)return d3v4adaptor;hasRequiredD3v4adaptor=1;var n=d3v4adaptor&&d3v4adaptor.__extends||function(){var a=function(o,u){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,c){s.__proto__=c}||function(s,c){for(var l in c)c.hasOwnProperty(l)&&(s[l]=c[l])},a(o,u)};return function(o,u){a(o,u);function s(){this.constructor=o}o.prototype=u===null?Object.create(u):(s.prototype=u.prototype,new s)}}();Object.defineProperty(d3v4adaptor,"__esModule",{value:!0});var t=requireLayout(),r=function(a){n(o,a);function o(u){var s=a.call(this)||this;s.d3Context=u,s.event=u.dispatch(t.EventType[t.EventType.start],t.EventType[t.EventType.tick],t.EventType[t.EventType.end]);var c=s;return s.drag=function(){if(!l)var l=u.drag().subject(t.Layout.dragOrigin).on("start.d3adaptor",t.Layout.dragStart).on("drag.d3adaptor",function(d){t.Layout.drag(d,u.event),c.resume()}).on("end.d3adaptor",t.Layout.dragEnd);if(!arguments.length)return l;arguments[0].call(l)},s}return o.prototype.trigger=function(u){var s={type:t.EventType[u.type],alpha:u.alpha,stress:u.stress};this.event.call(s.type,s)},o.prototype.kick=function(){var u=this,s=this.d3Context.timer(function(){return a.prototype.tick.call(u)&&s.stop()})},o.prototype.on=function(u,s){return typeof u=="string"?this.event.on(u,s):this.event.on(t.EventType[u],s),this},o}(t.Layout);return d3v4adaptor.D3StyleLayoutAdaptor=r,d3v4adaptor}var hasRequiredD3adaptor;function requireD3adaptor(){if(hasRequiredD3adaptor)return d3adaptor;hasRequiredD3adaptor=1,Object.defineProperty(d3adaptor,"__esModule",{value:!0});var n=requireD3v3adaptor(),t=requireD3v4adaptor();function r(o){return!o||a(o)?new n.D3StyleLayoutAdaptor:new t.D3StyleLayoutAdaptor(o)}d3adaptor.d3adaptor=r;function a(o){var u=/^3\./;return o.version&&o.version.match(u)!==null}return d3adaptor}var gridrouter={},hasRequiredGridrouter;function requireGridrouter(){if(hasRequiredGridrouter)return gridrouter;hasRequiredGridrouter=1,Object.defineProperty(gridrouter,"__esModule",{value:!0});var n=requireRectangle(),t=requireVpsc(),r=requireShortestpaths(),a=function(){function c(l,d,f){this.id=l,this.rect=d,this.children=f,this.leaf=typeof f>"u"||f.length===0}return c}();gridrouter.NodeWrapper=a;var o=function(){function c(l,d,f,h,v){h===void 0&&(h=null),v===void 0&&(v=null),this.id=l,this.x=d,this.y=f,this.node=h,this.line=v}return c}();gridrouter.Vert=o;var u=function(){function c(l,d){this.s=l,this.t=d;var f=c.findMatch(l,d),h=d.slice(0).reverse(),v=c.findMatch(l,h);f.length>=v.length?(this.length=f.length,this.si=f.si,this.ti=f.ti,this.reversed=!1):(this.length=v.length,this.si=v.si,this.ti=d.length-v.ti-v.length,this.reversed=!0)}return c.findMatch=function(l,d){for(var f=l.length,h=d.length,v={length:0,si:-1,ti:-1},g=new Array(f),b=0;b<f;b++){g[b]=new Array(h);for(var _=0;_<h;_++)if(l[b]===d[_]){var S=g[b][_]=b===0||_===0?1:g[b-1][_-1]+1;S>v.length&&(v.length=S,v.si=b-S+1,v.ti=_-S+1)}else g[b][_]=0}return v},c.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},c}();gridrouter.LongestCommonSubsequence=u;var s=function(){function c(l,d,f){var h=this;f===void 0&&(f=12),this.originalnodes=l,this.groupPadding=f,this.leaves=null,this.nodes=l.map(function(I,L){return new a(L,d.getBounds(I),d.getChildren(I))}),this.leaves=this.nodes.filter(function(I){return I.leaf}),this.groups=this.nodes.filter(function(I){return!I.leaf}),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach(function(I){return I.children.forEach(function(L){return h.nodes[L].parent=I})}),this.root={children:[]},this.nodes.forEach(function(I){typeof I.parent>"u"&&(I.parent=h.root,h.root.children.push(I.id)),I.ports=[]}),this.backToFront=this.nodes.slice(0),this.backToFront.sort(function(I,L){return h.getDepth(I)-h.getDepth(L)});var v=this.backToFront.slice(0).reverse().filter(function(I){return!I.leaf});v.forEach(function(I){var L=n.Rectangle.empty();I.children.forEach(function(F){return L=L.union(h.nodes[F].rect)}),I.rect=L.inflate(h.groupPadding)});var g=this.midPoints(this.cols.map(function(I){return I.pos})),b=this.midPoints(this.rows.map(function(I){return I.pos})),_=g[0],S=g[g.length-1],T=b[0],w=b[b.length-1],A=this.rows.map(function(I){return{x1:_,x2:S,y1:I.pos,y2:I.pos}}).concat(b.map(function(I){return{x1:_,x2:S,y1:I,y2:I}})),R=this.cols.map(function(I){return{x1:I.pos,x2:I.pos,y1:T,y2:w}}).concat(g.map(function(I){return{x1:I,x2:I,y1:T,y2:w}})),E=A.concat(R);E.forEach(function(I){return I.verts=[]}),this.verts=[],this.edges=[],A.forEach(function(I){return R.forEach(function(L){var F=new o(h.verts.length,L.x1,I.y1);I.verts.push(F),L.verts.push(F),h.verts.push(F);for(var D=h.backToFront.length;D-- >0;){var $=h.backToFront[D],O=$.rect,P=Math.abs(F.x-O.cx()),C=Math.abs(F.y-O.cy());if(P<O.width()/2&&C<O.height()/2){F.node=$;break}}})}),E.forEach(function(I,L){h.nodes.forEach(function(C,q){C.rect.lineIntersections(I.x1,I.y1,I.x2,I.y2).forEach(function(M,N){var G=new o(h.verts.length,M.x,M.y,C,I);h.verts.push(G),I.verts.push(G),C.ports.push(G)})});var F=Math.abs(I.y1-I.y2)<.1,D=function(C,q){return F?q.x-C.x:q.y-C.y};I.verts.sort(D);for(var $=1;$<I.verts.length;$++){var O=I.verts[$-1],P=I.verts[$];O.node&&O.node===P.node&&O.node.leaf||h.edges.push({source:O.id,target:P.id,length:Math.abs(D(O,P))})}})}return c.prototype.avg=function(l){return l.reduce(function(d,f){return d+f})/l.length},c.prototype.getGridLines=function(l){for(var d=[],f=this.leaves.slice(0,this.leaves.length);f.length>0;){var h=f.filter(function(g){return g.rect["overlap"+l.toUpperCase()](f[0].rect)}),v={nodes:h,pos:this.avg(h.map(function(g){return g.rect["c"+l]()}))};d.push(v),v.nodes.forEach(function(g){return f.splice(f.indexOf(g),1)})}return d.sort(function(g,b){return g.pos-b.pos}),d},c.prototype.getDepth=function(l){for(var d=0;l.parent!==this.root;)d++,l=l.parent;return d},c.prototype.midPoints=function(l){for(var d=l[1]-l[0],f=[l[0]-d/2],h=1;h<l.length;h++)f.push((l[h]+l[h-1])/2);return f.push(l[l.length-1]+d/2),f},c.prototype.findLineage=function(l){var d=[l];do l=l.parent,d.push(l);while(l!==this.root);return d.reverse()},c.prototype.findAncestorPathBetween=function(l,d){for(var f=this.findLineage(l),h=this.findLineage(d),v=0;f[v]===h[v];)v++;return{commonAncestor:f[v-1],lineages:f.slice(v).concat(h.slice(v))}},c.prototype.siblingObstacles=function(l,d){var f=this,h=this.findAncestorPathBetween(l,d),v={};h.lineages.forEach(function(b){return v[b.id]={}});var g=h.commonAncestor.children.filter(function(b){return!(b in v)});return h.lineages.filter(function(b){return b.parent!==h.commonAncestor}).forEach(function(b){return g=g.concat(b.parent.children.filter(function(_){return _!==b.id}))}),g.map(function(b){return f.nodes[b]})},c.getSegmentSets=function(l,d,f){for(var h=[],v=0;v<l.length;v++)for(var g=l[v],b=0;b<g.length;b++){var _=g[b];_.edgeid=v,_.i=b;var S=_[1][d]-_[0][d];Math.abs(S)<.1&&h.push(_)}h.sort(function(R,E){return R[0][d]-E[0][d]});for(var T=[],w=null,A=0;A<h.length;A++){var _=h[A];(!w||Math.abs(_[0][d]-w.pos)>.1)&&(w={pos:_[0][d],segments:[]},T.push(w)),w.segments.push(_)}return T},c.nudgeSegs=function(l,d,f,h,v,g){var b=h.length;if(!(b<=1)){for(var _=h.map(function($){return new t.Variable($[0][l])}),S=[],T=0;T<b;T++)for(var w=0;w<b;w++)if(T!==w){var A=h[T],R=h[w],E=A.edgeid,I=R.edgeid,L=-1,F=-1;l=="x"?v(E,I)&&(A[0][d]<A[1][d]?(L=w,F=T):(L=T,F=w)):v(E,I)&&(A[0][d]<A[1][d]?(L=T,F=w):(L=w,F=T)),L>=0&&S.push(new t.Constraint(_[L],_[F],g))}var D=new t.Solver(_,S);D.solve(),_.forEach(function($,O){var P=h[O],C=$.position();P[0][l]=P[1][l]=C;var q=f[P.edgeid];P.i>0&&(q[P.i-1][1][l]=C),P.i<q.length-1&&(q[P.i+1][0][l]=C)})}},c.nudgeSegments=function(l,d,f,h,v){for(var g=c.getSegmentSets(l,d,f),b=0;b<g.length;b++){for(var _=g[b],S=[],T=0;T<_.segments.length;T++){var w=_.segments[T];S.push({type:0,s:w,pos:Math.min(w[0][f],w[1][f])}),S.push({type:1,s:w,pos:Math.max(w[0][f],w[1][f])})}S.sort(function(E,I){return E.pos-I.pos+E.type-I.type});var A=[],R=0;S.forEach(function(E){E.type===0?(A.push(E.s),R++):R--,R==0&&(c.nudgeSegs(d,f,l,A,h,v),A=[])})}},c.prototype.routeEdges=function(l,d,f,h){var v=this,g=l.map(function(S){return v.route(f(S),h(S))}),b=c.orderEdges(g),_=g.map(function(S){return c.makeSegments(S)});return c.nudgeSegments(_,"x","y",b,d),c.nudgeSegments(_,"y","x",b,d),c.unreverseEdges(_,g),_},c.unreverseEdges=function(l,d){l.forEach(function(f,h){var v=d[h];v.reversed&&(f.reverse(),f.forEach(function(g){g.reverse()}))})},c.angleBetween2Lines=function(l,d){var f=Math.atan2(l[0].y-l[1].y,l[0].x-l[1].x),h=Math.atan2(d[0].y-d[1].y,d[0].x-d[1].x),v=f-h;return(v>Math.PI||v<-Math.PI)&&(v=h-f),v},c.isLeft=function(l,d,f){return(d.x-l.x)*(f.y-l.y)-(d.y-l.y)*(f.x-l.x)<=0},c.getOrder=function(l){for(var d={},f=0;f<l.length;f++){var h=l[f];typeof d[h.l]>"u"&&(d[h.l]={}),d[h.l][h.r]=!0}return function(v,g){return typeof d[v]<"u"&&d[v][g]}},c.orderEdges=function(l){for(var d=[],f=0;f<l.length-1;f++)for(var h=f+1;h<l.length;h++){var v=l[f],g=l[h],b=new u(v,g),_,S,T;if(b.length!==0){if(b.reversed&&(g.reverse(),g.reversed=!0,b=new u(v,g)),(b.si<=0||b.ti<=0)&&(b.si+b.length>=v.length||b.ti+b.length>=g.length)){d.push({l:f,r:h});continue}b.si+b.length>=v.length||b.ti+b.length>=g.length?(_=v[b.si+1],T=v[b.si-1],S=g[b.ti-1]):(_=v[b.si+b.length-2],S=v[b.si+b.length],T=g[b.ti+b.length]),c.isLeft(_,S,T)?d.push({l:h,r:f}):d.push({l:f,r:h})}}return c.getOrder(d)},c.makeSegments=function(l){function d(S){return{x:S.x,y:S.y}}for(var f=function(S,T,w){return Math.abs((T.x-S.x)*(w.y-S.y)-(T.y-S.y)*(w.x-S.x))<.001},h=[],v=d(l[0]),g=1;g<l.length;g++){var b=d(l[g]),_=g<l.length-1?l[g+1]:null;(!_||!f(v,b,_))&&(h.push([v,b]),v=b)}return h},c.prototype.route=function(l,d){var f=this,h=this.nodes[l],v=this.nodes[d];this.obstacles=this.siblingObstacles(h,v);var g={};this.obstacles.forEach(function(F){return g[F.id]=F}),this.passableEdges=this.edges.filter(function(F){var D=f.verts[F.source],$=f.verts[F.target];return!(D.node&&D.node.id in g||$.node&&$.node.id in g)});for(var b=1;b<h.ports.length;b++){var _=h.ports[0].id,S=h.ports[b].id;this.passableEdges.push({source:_,target:S,length:0})}for(var b=1;b<v.ports.length;b++){var _=v.ports[0].id,S=v.ports[b].id;this.passableEdges.push({source:_,target:S,length:0})}var T=function(F){return F.source},w=function(F){return F.target},A=function(F){return F.length},R=new r.Calculator(this.verts.length,this.passableEdges,T,w,A),E=function(F,D,$){var O=f.verts[F],P=f.verts[D],C=f.verts[$],q=Math.abs(C.x-O.x),M=Math.abs(C.y-O.y);return O.node===h&&O.node===P.node||P.node===v&&P.node===C.node?0:q>1&&M>1?1e3:0},I=R.PathFromNodeToNodeWithPrevCost(h.ports[0].id,v.ports[0].id,E),L=I.reverse().map(function(F){return f.verts[F]});return L.push(this.nodes[v.id].ports[0]),L.filter(function(F,D){return!(D<L.length-1&&L[D+1].node===h&&F.node===h||D>0&&F.node===v&&L[D-1].node===v)})},c.getRoutePath=function(l,d,f,h){var v={routepath:"M "+l[0][0].x+" "+l[0][0].y+" ",arrowpath:""};if(l.length>1)for(var g=0;g<l.length;g++){var b=l[g],_=b[1].x,S=b[1].y,T=_-b[0].x,w=S-b[0].y;if(g<l.length-1){Math.abs(T)>0?_-=T/Math.abs(T)*d:S-=w/Math.abs(w)*d,v.routepath+="L "+_+" "+S+" ";var A=l[g+1],R=A[0].x,E=A[0].y,I=A[1].x,L=A[1].y;T=I-R,w=L-E;var F=c.angleBetween2Lines(b,A)<0?1:0,D,$;Math.abs(T)>0?(D=R+T/Math.abs(T)*d,$=E):(D=R,$=E+w/Math.abs(w)*d);var O=Math.abs(D-_),P=Math.abs($-S);v.routepath+="A "+O+" "+P+" 0 0 "+F+" "+D+" "+$+" "}else{var C=[_,S],q,M;Math.abs(T)>0?(_-=T/Math.abs(T)*h,q=[_,S+f],M=[_,S-f]):(S-=w/Math.abs(w)*h,q=[_+f,S],M=[_-f,S]),v.routepath+="L "+_+" "+S+" ",h>0&&(v.arrowpath="M "+C[0]+" "+C[1]+" L "+q[0]+" "+q[1]+" L "+M[0]+" "+M[1])}}else{var b=l[0],_=b[1].x,S=b[1].y,T=_-b[0].x,w=S-b[0].y,C=[_,S],q,M;Math.abs(T)>0?(_-=T/Math.abs(T)*h,q=[_,S+f],M=[_,S-f]):(S-=w/Math.abs(w)*h,q=[_+f,S],M=[_-f,S]),v.routepath+="L "+_+" "+S+" ",h>0&&(v.arrowpath="M "+C[0]+" "+C[1]+" L "+q[0]+" "+q[1]+" L "+M[0]+" "+M[1])}return v},c}();return gridrouter.GridRouter=s,gridrouter}var layout3d={},hasRequiredLayout3d;function requireLayout3d(){if(hasRequiredLayout3d)return layout3d;hasRequiredLayout3d=1,Object.defineProperty(layout3d,"__esModule",{value:!0});var n=requireShortestpaths(),t=requireDescent(),r=requireRectangle(),a=requireLinklengths(),o=function(){function l(d,f){this.source=d,this.target=f}return l.prototype.actualLength=function(d){var f=this;return Math.sqrt(d.reduce(function(h,v){var g=v[f.target]-v[f.source];return h+g*g},0))},l}();layout3d.Link3D=o;var u=function(){function l(d,f,h){d===void 0&&(d=0),f===void 0&&(f=0),h===void 0&&(h=0),this.x=d,this.y=f,this.z=h}return l}();layout3d.Node3D=u;var s=function(){function l(d,f,h){var v=this;h===void 0&&(h=1),this.nodes=d,this.links=f,this.idealLinkLength=h,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(l.k);for(var g=0;g<l.k;++g)this.result[g]=new Array(d.length);d.forEach(function(b,_){for(var S=0,T=l.dims;S<T.length;S++){var w=T[S];typeof b[w]>"u"&&(b[w]=Math.random())}v.result[0][_]=b.x,v.result[1][_]=b.y,v.result[2][_]=b.z})}return l.prototype.linkLength=function(d){return d.actualLength(this.result)},l.prototype.start=function(d){var f=this;d===void 0&&(d=100);var h=this.nodes.length,v=new c;this.useJaccardLinkLengths&&a.jaccardLinkLengths(this.links,v,1.5),this.links.forEach(function(w){return w.length*=f.idealLinkLength});var g=new n.Calculator(h,this.links,function(w){return w.source},function(w){return w.target},function(w){return w.length}).DistanceMatrix(),b=t.Descent.createSquareMatrix(h,function(w,A){return g[w][A]}),_=t.Descent.createSquareMatrix(h,function(){return 2});this.links.forEach(function(w){var A=w.source,R=w.target;return _[A][R]=_[R][A]=1}),this.descent=new t.Descent(this.result,b),this.descent.threshold=.001,this.descent.G=_,this.constraints&&(this.descent.project=new r.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var S=0;S<this.nodes.length;S++){var T=this.nodes[S];T.fixed&&this.descent.locks.add(S,[T.x,T.y,T.z])}return this.descent.run(d),this},l.prototype.tick=function(){this.descent.locks.clear();for(var d=0;d<this.nodes.length;d++){var f=this.nodes[d];f.fixed&&this.descent.locks.add(d,[f.x,f.y,f.z])}return this.descent.rungeKutta()},l.dims=["x","y","z"],l.k=l.dims.length,l}();layout3d.Layout3D=s;var c=function(){function l(){}return l.prototype.getSourceIndex=function(d){return d.source},l.prototype.getTargetIndex=function(d){return d.target},l.prototype.getLength=function(d){return d.length},l.prototype.setLength=function(d,f){d.length=f},l}();return layout3d}var batch={},hasRequiredBatch;function requireBatch(){if(hasRequiredBatch)return batch;hasRequiredBatch=1,Object.defineProperty(batch,"__esModule",{value:!0});var n=requireLayout(),t=requireGridrouter();function r(u,s,c,l){u.cola.start(0,0,0,10,!1);var d=a(u.cola.nodes(),u.cola.groups(),c,l);return d.routeEdges(u.powerGraph.powerEdges,s,function(f){return f.source.routerNode.id},function(f){return f.target.routerNode.id})}batch.gridify=r;function a(u,s,c,l){u.forEach(function(f){f.routerNode={name:f.name,bounds:f.bounds.inflate(-c)}}),s.forEach(function(f){f.routerNode={bounds:f.bounds.inflate(-l),children:(typeof f.groups<"u"?f.groups.map(function(h){return u.length+h.id}):[]).concat(typeof f.leaves<"u"?f.leaves.map(function(h){return h.index}):[])}});var d=u.concat(s).map(function(f,h){return f.routerNode.id=h,f.routerNode});return new t.GridRouter(d,{getChildren:function(f){return f.children},getBounds:function(f){return f.bounds}},c-l)}function o(u,s,c){var l;u.nodes.forEach(function(v,g){return v.index=g}),new n.Layout().avoidOverlaps(!1).nodes(u.nodes).links(u.links).powerGraphGroups(function(v){l=v,l.groups.forEach(function(g){return g.padding=c})});var d=u.nodes.length,f=[],h=u.nodes.slice(0);return h.forEach(function(v,g){return v.index=g}),l.groups.forEach(function(v){var g=v.index=v.id+d;h.push(v),typeof v.leaves<"u"&&v.leaves.forEach(function(b){return f.push({source:g,target:b.index})}),typeof v.groups<"u"&&v.groups.forEach(function(b){return f.push({source:g,target:b.id+d})})}),l.powerEdges.forEach(function(v){f.push({source:v.source.index,target:v.target.index})}),new n.Layout().size(s).nodes(h).links(f).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:new n.Layout().convergenceThreshold(.001).size(s).avoidOverlaps(!0).nodes(u.nodes).links(u.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups(function(v){l=v,l.groups.forEach(function(g){g.padding=c})}).start(50,0,100,0,!1),powerGraph:l}}return batch.powerGraphGridLayout=o,batch}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(n){function t(r){for(var a in r)n.hasOwnProperty(a)||(n[a]=r[a])}Object.defineProperty(n,"__esModule",{value:!0}),t(requireAdaptor()),t(requireD3adaptor()),t(requireDescent()),t(requireGeom()),t(requireGridrouter()),t(requireHandledisconnected()),t(requireLayout()),t(requireLayout3d()),t(requireLinklengths()),t(requirePowergraph()),t(requirePqueue()),t(requireRbtree()),t(requireRectangle()),t(requireShortestpaths()),t(requireVpsc()),t(requireBatch())}(dist)),dist}var cytoscapeCola=cytoscapeCola$1.exports,hasRequiredCytoscapeCola;function requireCytoscapeCola(){return hasRequiredCytoscapeCola||(hasRequiredCytoscapeCola=1,function(n,t){(function(a,o){n.exports=o(requireDist())})(cytoscapeCola,function(r){return function(a){var o={};function u(s){if(o[s])return o[s].exports;var c=o[s]={i:s,l:!1,exports:{}};return a[s].call(c.exports,c,c.exports,u),c.l=!0,c.exports}return u.m=a,u.c=o,u.i=function(s){return s},u.d=function(s,c,l){u.o(s,c)||Object.defineProperty(s,c,{configurable:!1,enumerable:!0,get:l})},u.n=function(s){var c=s&&s.__esModule?function(){return s.default}:function(){return s};return u.d(c,"a",c),c},u.o=function(s,c){return Object.prototype.hasOwnProperty.call(s,c)},u.p="",u(u.s=3)}([function(a,o,u){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},c=u(1),l=u(2),d=u(5)||(typeof window<"u"?window.cola:null),f=u(4),h=function(A){return(typeof A>"u"?"undefined":s(A))===s("")},v=function(A){return(typeof A>"u"?"undefined":s(A))===s(0)},g=function(A){return A!=null&&(typeof A>"u"?"undefined":s(A))===s({})},b=function(A){return A!=null&&(typeof A>"u"?"undefined":s(A))===s(function(){})},_=function(){},S=function(A,R){if(b(A)){var E=A;return E.apply(R,[R])}else return A};function T(w){this.options=c({},l,w)}T.prototype.run=function(){var w=this,A=this.options;w.manuallyStopped=!1;var R=A.cy,E=A.eles,I=E.nodes(),L=E.edges(),F=!1,D=function(z){return z.isParent()},$=I.filter(D),O=I.subtract($),P=A.boundingBox||{x1:0,y1:0,w:R.width(),h:R.height()};P.x2===void 0&&(P.x2=P.x1+P.w),P.w===void 0&&(P.w=P.x2-P.x1),P.y2===void 0&&(P.y2=P.y1+P.h),P.h===void 0&&(P.h=P.y2-P.y1);var C=function(){for(var z=0;z<I.length;z++){var B=I[z],U=B.layoutDimensions(A),Z=B.scratch("cola");if(!Z.updatedDims){var oe=S(A.nodeSpacing,B);Z.width=U.w+2*oe,Z.height=U.h+2*oe}}I.positions(function(ie){var se=ie.scratch().cola,ne=void 0;return!ie.grabbed()&&O.contains(ie)&&(ne={x:P.x1+se.x,y:P.y1+se.y},(!v(ne.x)||!v(ne.y))&&(ne=void 0)),ne}),I.updateCompoundBounds(),F||(M(),F=!0),A.fit&&R.fit(A.padding)},q=function(){A.ungrabifyWhileSimulating&&X.grabify(),R.off("destroy",Y),I.off("grab free position",W),I.off("lock unlock",te),w.one("layoutstop",A.stop),w.trigger({type:"layoutstop",layout:w})},M=function(){w.one("layoutready",A.ready),w.trigger({type:"layoutready",layout:w})},N=A.refresh;A.refresh<0?N=1:N=Math.max(1,N);var G=w.adaptor=d.adaptor({trigger:function(z){var B=d.EventType?d.EventType.tick:null,U=d.EventType?d.EventType.end:null;switch(z.type){case"tick":case B:A.animate&&C();break;case"end":case U:C(),A.infinite||q();break}},kick:function(){var z=!0,B=function(){if(w.manuallyStopped)return q(),!0;var ie=G.tick();return!A.infinite&&!z&&G.convergenceThreshold(A.convergenceThreshold),z=!1,ie&&A.infinite&&G.resume(),ie},U=function(){for(var ie=void 0,se=0;se<N&&!ie;se++)ie=ie||B();return ie};if(A.animate){var Z=function oe(){U()||f(oe)};f(Z)}else for(;!B(););},on:_,drag:_});w.adaptor=G;var X=I.filter(":grabbable");A.ungrabifyWhileSimulating&&X.ungrabify();var Y=void 0;R.one("destroy",Y=function(){w.stop()});var W=void 0;I.on("grab free position",W=function(z){var B=this,U=B.scratch().cola,Z=B.position(),oe=z.cyTarget===B||z.target===B;if(oe)switch(z.type){case"grab":G.dragstart(U);break;case"free":G.dragend(U);break;case"position":(U.px!==Z.x-P.x1||U.py!==Z.y-P.y1)&&(U.px=Z.x-P.x1,U.py=Z.y-P.y1);break}});var te=void 0;I.on("lock unlock",te=function(){var z=this,B=z.scratch().cola;B.fixed=z.locked(),z.locked()?G.dragstart(B):G.dragend(B)}),G.nodes(O.map(function(j,z){var B=S(A.nodeSpacing,j),U=j.position(),Z=j.layoutDimensions(A),oe=j.scratch().cola={x:A.randomize&&!j.locked()||U.x===void 0?Math.round(Math.random()*P.w):U.x,y:A.randomize&&!j.locked()||U.y===void 0?Math.round(Math.random()*P.h):U.y,width:Z.w+2*B,height:Z.h+2*B,index:z,fixed:j.locked()};return oe}));var ue=[];if(A.alignment){if(A.alignment.vertical){var fe=A.alignment.vertical;fe.forEach(function(j){var z=[];j.forEach(function(B){var U=B.node,Z=U.scratch().cola,oe=Z.index;z.push({node:oe,offset:B.offset?B.offset:0})}),ue.push({type:"alignment",axis:"x",offsets:z})})}if(A.alignment.horizontal){var re=A.alignment.horizontal;re.forEach(function(j){var z=[];j.forEach(function(B){var U=B.node,Z=U.scratch().cola,oe=Z.index;z.push({node:oe,offset:B.offset?B.offset:0})}),ue.push({type:"alignment",axis:"y",offsets:z})})}}A.gapInequalities&&A.gapInequalities.forEach(function(j){var z=j.left.scratch().cola.index,B=j.right.scratch().cola.index;ue.push({axis:j.axis,left:z,right:B,gap:j.gap,equality:j.equality})}),ue.length>0&&G.constraints(ue),G.groups($.map(function(j,z){var B=S(A.nodeSpacing,j),U=function(he){return parseFloat(j.style("padding-"+he))},Z=U("left")+B,oe=U("right")+B,ie=U("top")+B,se=U("bottom")+B;return j.scratch().cola={index:z,padding:Math.max(Z,oe,ie,se),leaves:j.children().intersection(O).map(function(ne){return ne[0].scratch().cola.index}),fixed:j.locked()},j}).map(function(j){return j.scratch().cola.groups=j.children().intersection($).map(function(z){return z.scratch().cola.index}),j.scratch().cola}));var ye=void 0,Te=void 0;A.edgeLength!=null?(ye=A.edgeLength,Te="linkDistance"):A.edgeSymDiffLength!=null?(ye=A.edgeSymDiffLength,Te="symmetricDiffLinkLengths"):A.edgeJaccardLength!=null?(ye=A.edgeJaccardLength,Te="jaccardLinkLengths"):(ye=100,Te="linkDistance");var Re=function(z){return z.calcLength};if(G.links(L.stdFilter(function(j){return O.contains(j.source())&&O.contains(j.target())}).map(function(j){var z=j.scratch().cola={source:j.source()[0].scratch().cola.index,target:j.target()[0].scratch().cola.index};return ye!=null&&(z.calcLength=S(ye,j)),z})),G.size([P.w,P.h]),ye!=null&&G[Te](Re),A.flow){var ve=void 0,ce="y",J=50;h(A.flow)?ve={axis:A.flow,minSeparation:J}:v(A.flow)?ve={axis:ce,minSeparation:A.flow}:g(A.flow)?(ve=A.flow,ve.axis=ve.axis||ce,ve.minSeparation=ve.minSeparation!=null?ve.minSeparation:J):ve={axis:ce,minSeparation:J},G.flowLayout(ve.axis,ve.minSeparation)}return w.trigger({type:"layoutstart",layout:w}),G.avoidOverlaps(A.avoidOverlap).handleDisconnected(A.handleDisconnected).start(A.unconstrIter,A.userConstIter,A.allConstIter,void 0,void 0,A.centerGraph),A.infinite||setTimeout(function(){w.manuallyStopped||G.stop()},A.maxSimulationTime),this},T.prototype.stop=function(){return this.adaptor&&(this.manuallyStopped=!0,this.adaptor.stop()),this},a.exports=T},function(a,o,u){a.exports=Object.assign!=null?Object.assign.bind(Object):function(s){for(var c=arguments.length,l=Array(c>1?c-1:0),d=1;d<c;d++)l[d-1]=arguments[d];return l.filter(function(f){return f!=null}).forEach(function(f){Object.keys(f).forEach(function(h){return s[h]=f[h]})}),s}},function(a,o,u){var s={animate:!0,refresh:1,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,ready:function(){},stop:function(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,convergenceThreshold:.01,nodeSpacing:function(l){return 10},flow:void 0,alignment:void 0,gapInequalities:void 0,centerGraph:!0,edgeLength:void 0,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0,infinite:!1};a.exports=s},function(a,o,u){var s=u(0),c=function(d){d&&d("layout","cola",s)};typeof cytoscape<"u"&&c(cytoscape),a.exports=c},function(a,o,u){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},c=void 0;(typeof window>"u"?"undefined":s(window))!=="undefined"?c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(l){return setTimeout(l,16)}:c=function(d){d()},a.exports=c},function(a,o){a.exports=r}])})}(cytoscapeCola$1)),cytoscapeCola$1.exports}var cytoscapeColaExports=requireCytoscapeCola();const cola=getDefaultExportFromCjs(cytoscapeColaExports);var root_3=template("<option> </option>"),root_1$1=template('<div class="duecolonne svelte-jhjhu6"><label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Domain:</span> <select class="svelte-jhjhu6"></select></label></div>'),root_4=template('<div class="duecolonne svelte-jhjhu6"><label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Name:</span> <input type="text" class="svelte-jhjhu6"></label></div>'),root_6=template('<div class="column svelte-jhjhu6"><input type="checkbox"> </div>'),root_5=template('<fieldset class="duecolonne svelte-jhjhu6"><legend class="svelte-jhjhu6">Flags</legend> <div id="flags" class="flags svelte-jhjhu6"></div></fieldset>'),root_8=template("<option> </option>"),root_9=template("<option> </option>"),root_7=template('<fieldset><legend class="svelte-jhjhu6">Domain Restrictions</legend> <span>Restiction Type</span> <select></select> <br> <span>Domain Relationship</span> <select></select></fieldset> <fieldset><legend class="svelte-jhjhu6">values</legend> <input type="number" min="0" step="1" id="min" style="width: 50%;" placeholder="min"> <input type="number" min="0" step="1" id="max" style="width: 50%;" placeholder="max"></fieldset>',1),root_11=template("<option> </option>"),root_12=template("<option> </option>"),root_10=template('<fieldset><legend class="svelte-jhjhu6">Range Restrictions</legend> <span>Restiction Type</span> <select></select> <br> <span>Range Relationship</span> <select></select></fieldset> <fieldset><legend class="svelte-jhjhu6">values</legend> <input type="number" min="0" step="1" id="min" style="width: 50%;" placeholder="min"> <input type="number" min="0" step="1" id="max" style="width: 50%;" placeholder="max"></fieldset>',1),root_15=template("<option selected disabled> </option>"),root_16=template("<option> </option>"),root_13=template('<select class="svelte-jhjhu6"></select>'),root_18=template("<option> </option>"),root_17=template('<select class="svelte-jhjhu6"></select>'),root$2=template('<main><div class="modal-overlay svelte-jhjhu6"><div class="editor constraint svelte-jhjhu6"><!> <!> <div class="duecolonne svelte-jhjhu6"><label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Label:</span> <input type="text" class="svelte-jhjhu6"></label> <label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Description:</span> <textarea rows="3" class="svelte-jhjhu6"></textarea></label></div> <!> <!> <!> <div class="duecolonne svelte-jhjhu6"><label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Color:</span> <input type="color" class="svelte-jhjhu6"></label> <label class="labeled-input svelte-jhjhu6"><span class="svelte-jhjhu6">Type:</span> <!></label></div> <div class="button-group duecolonne svelte-jhjhu6"><button class="button-save svelte-jhjhu6">Save</button> <button class="button-delete svelte-jhjhu6">Delete</button> <button class="button-close svelte-jhjhu6">Close</button></div></div></div></main>');function EdgeEditor(n,t){push$2(t,!1);const[r,a]=setup_stores(),o=()=>store_get(edgeType,"$edgeType",r),u=()=>store_get(selectedEdge,"$selectedEdge",r),s=()=>store_get(showEdgeEditor,"$showEdgeEditor",r),c=()=>store_get(edgeFlags,"$edgeFlags",r),l=()=>store_get(edgeRestrictions,"$edgeRestrictions",r),d=()=>store_get(edgeLabel,"$edgeLabel",r),f=()=>store_get(edgeName,"$edgeName",r),h=()=>store_get(edgeDescription,"$edgeDescription",r),v=()=>store_get(edgeColor,"$edgeColor",r),g=()=>store_get(edgeDomain,"$edgeDomain",r),b=()=>store_get(data$2,"$data",r);let _=prop(t,"getNodeType",8),S=prop(t,"addDoc",8),T=prop(t,"delDoc",8),w=mutable_state(),A=mutable_state(),R=mutable_state([]),E=mutable_state(!1);function I(){console.log("UPDATE EDGE"),fe(),N(),X(),W(),ue(),store_set(edgeFlags,get$4(w)),store_set(edgeRestrictions,get$4(A)),u()&&(u().data({label:d(),name:f(),description:h(),color:v(),type:o(),flags:c(),restrictions:l(),sourcelabel:L(),targetlabel:F(),domain:g()}),store_set(showEdgeEditor,!1),S()(u().data()))}function L(){let le=Object.keys(l().domain.relationship).filter(De=>l().domain.relationship[De]),we=Object.keys(l().domain.type).filter(De=>l().domain.type[De]);return we.length>0&&le.length>0?(we=we[0].split(":"),we[1]==="min,max"?l().domain.min+","+l().domain.max+" ("+le[0].substring(0,1)+")":we[1]+" ("+le[0].substring(0,1)+")"):""}function F(){let le=Object.keys(l().range.relationship).filter(De=>l().range.relationship[De]),we=Object.keys(l().range.type).filter(De=>l().range.type[De]);return we.length>0&&le.length>0?(we=we[0].split(":"),we[1]==="min,max"?l().range.min+","+l().range.max+" ("+le[0].substring(0,1)+")":we[1]+" ("+le[0].substring(0,1)+")"):""}function D(){if(u()&&confirm("Sei sicuro di voler eliminare l'arco selezionato?")){const le=u().id();T()(u().data()),u().remove(),store_mutate(data$2,untrack(b).edges=b().edges.filter(we=>we.data.id!==le),untrack(b)),store_set(showEdgeEditor,!1),store_set(selectedEdge,null)}}function $(){store_set(showEdgeEditor,!1)}function O(){store_set(edgeFlags,null),set$4(w,null),store_set(edgeRestrictions,null),set$4(A,null),P()}function P(){if(set$4(w,{...c()}),l()!=null?set$4(A,JSON.parse(JSON.stringify(l()))):set$4(A,null),get$4(w)==null||Object.keys(get$4(w)).length==0){let le={};computeEdgeFlags(o(),_()(u().data("source")),_()(u().data("target"))).forEach(De=>le[De]=!1),set$4(w,le)}if(get$4(A)==null||Object.keys(get$4(A)).length==0){set$4(A,{domain:{type:{},relationship:{},min:0,max:0},range:{type:{},relationship:{},min:0,max:0}}),u().data("type",o());const le=isEdgeAllowedRestrictions(u());le&&le.domain&&(set$4(G,le.domain.relationship[0]),set$4(C,le.domain.type[0])),le&&le.range&&(set$4(te,le.range.relationship[0]),set$4(Y,le.range.type[0]))}else console.log("Edge Editor INIT UI ELSE",get$4(A)),set$4(G,Object.keys(get$4(A).domain.relationship).filter(le=>get$4(A).domain.relationship[le])[0]),set$4(C,Object.keys(get$4(A).domain.type).filter(le=>get$4(A).domain.type[le])[0]),set$4(te,Object.keys(get$4(A).range.relationship).filter(le=>get$4(A).range.relationship[le])[0]),set$4(Y,Object.keys(get$4(A).range.type).filter(le=>get$4(A).range.type[le])[0]);N(),X(),W(),ue(),set$4(E,isEdgeAllowedDomains(o())),console.log(get$4(A))}let C=mutable_state(),q=mutable_state(!1),M=mutable_state(!1);function N(){let le=isEdgeAllowedRestrictions(u());le&&(le.domain.type.forEach(De=>{De==get$4(C)?(set$4(q,De==="Cardinality:min,max"),mutate(A,get$4(A).domain.type[De]=!0)):mutate(A,get$4(A).domain.type[De]=!1)}),get$4(q)||(mutate(A,get$4(A).domain.min=0),mutate(A,get$4(A).domain.max=0)))}let G=mutable_state();function X(){let le=isEdgeAllowedRestrictions(u());le&&le.domain.relationship.forEach(De=>{De==get$4(G)?mutate(A,get$4(A).domain.relationship[De]=!0):mutate(A,get$4(A).domain.relationship[De]=!1)})}let Y=mutable_state();function W(){let le=isEdgeAllowedRestrictions(u());le&&(le.range.type.forEach(De=>{De==get$4(Y)?(set$4(M,De==="Cardinality:min,max"),mutate(A,get$4(A).range.type[De]=!0)):mutate(A,get$4(A).range.type[De]=!1)}),get$4(M)||(mutate(A,get$4(A).range.min=0),mutate(A,get$4(A).range.max=0)))}let te=mutable_state();function ue(){let le=isEdgeAllowedRestrictions(u());le&&le.range.relationship.forEach(De=>{De==get$4(te)?mutate(A,get$4(A).range.relationship[De]=!0):mutate(A,get$4(A).range.relationship[De]=!1)})}function fe(){u().data("type")=="property"}legacy_pre_effect(()=>(o(),deep_read_state(_()),u()),()=>{set$4(R,getAllowedEdgeTypes(o(),_()(u().data("source")),_()(u().data("target"))))}),legacy_pre_effect(()=>s(),()=>{s()&&P()}),legacy_pre_effect_reset(),init$2();var re=root$2(),ye=child(re),Te=child(ye),Re=child(Te);{var ve=le=>{var we=root_1$1(),De=child(we),Fe=sibling(child(De),2);template_effect(()=>{g(),invalidate_inner_signals(()=>{})}),each$g(Fe,5,()=>domains,index,(Ne,de)=>{var Le=comment(),$e=first_child(Le);{var je=Me=>{var ze=root_3(),Je={},Ke=child(ze);template_effect(()=>{Je!==(Je=get$4(de).id)&&(ze.value=(ze.__value=get$4(de).id)==null?"":get$4(de).id),set_text(Ke,get$4(de).description)}),append(Me,ze)};if_block($e,Me=>{get$4(de).visible&&Me(je)})}append(Ne,Le)}),bind_select_value(Fe,g,Ne=>store_set(edgeDomain,Ne)),append(le,we)};if_block(Re,le=>{get$4(E)&&le(ve)})}var ce=sibling(Re,2);{var J=le=>{var we=root_4(),De=child(we),Fe=sibling(child(De),2);bind_value(Fe,f,Ne=>store_set(edgeName,Ne)),append(le,we)};if_block(ce,le=>{u()&&o()=="property"&&le(J)})}var j=sibling(ce,2),z=child(j),B=sibling(child(z),2),U=sibling(z,2),Z=sibling(child(U),2),oe=sibling(j,2);{var ie=le=>{var we=root_5(),De=sibling(child(we),2);each$g(De,5,()=>Object.keys(get$4(w)),index,(Fe,Ne)=>{var de=root_6(),Le=child(de),$e=sibling(Le,1,!0);template_effect(()=>set_text($e,get$4(Ne))),bind_checked(Le,()=>get$4(w)[get$4(Ne)],je=>mutate(w,get$4(w)[get$4(Ne)]=je)),append(Fe,de)}),append(le,we)};if_block(oe,le=>{get$4(w)&&Object.keys(get$4(w)).length>0&&le(ie)})}var se=sibling(oe,2);{var ne=le=>{var we=root_7(),De=first_child(we),Fe=sibling(child(De),4);template_effect(()=>{get$4(C),invalidate_inner_signals(()=>{get$4(A)})}),each$g(Fe,5,()=>Object.keys(get$4(A).domain.type),index,(je,Me)=>{var ze=root_8(),Je={},Ke=child(ze);template_effect(()=>{Je!==(Je=get$4(Me))&&(ze.value=(ze.__value=get$4(Me))==null?"":get$4(Me)),set_selected(ze,get$4(A).domain.type[get$4(Me)]===!0),set_text(Ke,get$4(Me))}),append(je,ze)});var Ne=sibling(Fe,6);template_effect(()=>{get$4(G),invalidate_inner_signals(()=>{get$4(A)})}),each$g(Ne,5,()=>Object.keys(get$4(A).domain.relationship),index,(je,Me)=>{var ze=root_9(),Je={},Ke=child(ze);template_effect(()=>{Je!==(Je=get$4(Me))&&(ze.value=(ze.__value=get$4(Me))==null?"":get$4(Me)),set_selected(ze,get$4(A).domain.relationship[get$4(Me)]===!0),set_text(Ke,get$4(Me))}),append(je,ze)});var de=sibling(De,2),Le=sibling(child(de),2),$e=sibling(Le,2);template_effect(()=>{Le.disabled=!get$4(q),$e.disabled=!get$4(q)}),bind_select_value(Fe,()=>get$4(C),je=>set$4(C,je)),event$1("change",Fe,N),bind_select_value(Ne,()=>get$4(G),je=>set$4(G,je)),event$1("change",Ne,X),bind_value(Le,()=>get$4(A).domain.min,je=>mutate(A,get$4(A).domain.min=je)),bind_value($e,()=>get$4(A).domain.max,je=>mutate(A,get$4(A).domain.max=je)),append(le,we)};if_block(se,le=>{get$4(A)&&Object.keys(get$4(A)).length>0&&Object.keys(get$4(A).domain.relationship).length>0&&le(ne)})}var he=sibling(se,2);{var xe=le=>{var we=root_10(),De=first_child(we),Fe=sibling(child(De),4);template_effect(()=>{get$4(Y),invalidate_inner_signals(()=>{get$4(A)})}),each$g(Fe,5,()=>Object.keys(get$4(A).range.type),index,(je,Me)=>{var ze=root_11(),Je={},Ke=child(ze);template_effect(()=>{Je!==(Je=get$4(Me))&&(ze.value=(ze.__value=get$4(Me))==null?"":get$4(Me)),set_selected(ze,get$4(A).range.type[get$4(Me)]===!0),set_text(Ke,get$4(Me))}),append(je,ze)});var Ne=sibling(Fe,6);template_effect(()=>{get$4(te),invalidate_inner_signals(()=>{get$4(A)})}),each$g(Ne,5,()=>Object.keys(get$4(A).range.relationship),index,(je,Me)=>{var ze=root_12(),Je={},Ke=child(ze);template_effect(()=>{Je!==(Je=get$4(Me))&&(ze.value=(ze.__value=get$4(Me))==null?"":get$4(Me)),set_selected(ze,get$4(A).range.relationship[get$4(Me)]===!0),set_text(Ke,get$4(Me))}),append(je,ze)});var de=sibling(De,2),Le=sibling(child(de),2),$e=sibling(Le,2);template_effect(()=>{Le.disabled=!get$4(M),$e.disabled=!get$4(M)}),bind_select_value(Fe,()=>get$4(Y),je=>set$4(Y,je)),event$1("change",Fe,W),bind_select_value(Ne,()=>get$4(te),je=>set$4(te,je)),event$1("change",Ne,ue),bind_value(Le,()=>get$4(A).range.min,je=>mutate(A,get$4(A).range.min=je)),bind_value($e,()=>get$4(A).range.max,je=>mutate(A,get$4(A).range.max=je)),append(le,we)};if_block(he,le=>{get$4(A)&&Object.keys(get$4(A).range.relationship).length>0&&le(xe)})}var me=sibling(he,2),Ie=child(me),Pe=sibling(child(Ie),2),Ce=sibling(Ie,2),pe=sibling(child(Ce),2);{var H=le=>{var we=root_13();template_effect(()=>{o(),invalidate_inner_signals(()=>{get$4(R)})}),each$g(we,5,()=>get$4(R),index,(De,Fe)=>{var Ne=comment(),de=first_child(Ne);{var Le=je=>{var Me=root_15(),ze={},Je=child(Me);template_effect(Ke=>{ze!==(ze=Ke)&&(Me.value=(Me.__value=Ke)==null?"":Ke),set_text(Je,Ke)},[()=>get$4(Fe).substring(1)],derived_safe_equal),append(je,Me)},$e=je=>{var Me=root_16(),ze={},Je=child(Me);template_effect(()=>{ze!==(ze=get$4(Fe))&&(Me.value=(Me.__value=get$4(Fe))==null?"":get$4(Fe)),set_text(Je,get$4(Fe))}),append(je,Me)};if_block(de,je=>{get$4(Fe).startsWith("*")?je(Le):je($e,!1)})}append(De,Ne)}),bind_select_value(we,o,De=>store_set(edgeType,De)),event$1("change",we,O),append(le,we)},V=le=>{var we=root_17();template_effect(()=>{o(),invalidate_inner_signals(()=>{})}),each$g(we,5,getEdgeTypes,index,(De,Fe)=>{var Ne=root_18(),de={},Le=child(Ne);template_effect(()=>{de!==(de=get$4(Fe))&&(Ne.value=(Ne.__value=get$4(Fe))==null?"":get$4(Fe)),set_text(Le,get$4(Fe))}),append(De,Ne)}),bind_select_value(we,o,De=>store_set(edgeType,De)),append(le,we)};if_block(pe,le=>{o()!=null?le(H):le(V,!1)})}var Q=sibling(me,2),ee=child(Q),ae=sibling(ee,2),be=sibling(ae,2);bind_value(B,d,le=>store_set(edgeLabel,le)),event$1("change",B,fe),bind_value(Z,h,le=>store_set(edgeDescription,le)),bind_value(Pe,v,le=>store_set(edgeColor,le)),event$1("click",ee,I),event$1("click",ae,D),event$1("click",be,$),append(n,re),pop$1(),a()}var root_1=template('<div class="node-type svelte-1cagsne" role="application" draggable="true"><img style="width: 20px; height:20px;"></div>'),root_2=template('<button class="node-type svelte-1cagsne"><img style="width: 20px; height:20px;"></button>'),root$1=template('<main><div style="position: relative;"><div class="palette svelte-1cagsne" style="top: 10px; left:10px;"></div> <div class="palette svelte-1cagsne" style="top: 220px; left:10px;"></div> <div class="cy-container svelte-1cagsne" role="application"></div></div> <!> <!> <!></main>');function DiagramEditor($$anchor,$$props){push$2($$props,!1);const[$$stores,$$cleanup]=setup_stores(),$data=()=>store_get(data$2,"$data",$$stores),$selectedNode=()=>store_get(selectedNode,"$selectedNode",$$stores),$showNodeEditor=()=>store_get(showNodeEditor,"$showNodeEditor",$$stores),$selectedSourceNode=()=>store_get(selectedSourceNode,"$selectedSourceNode",$$stores),$selectedEdge=()=>store_get(selectedEdge,"$selectedEdge",$$stores),$edgeLabel=()=>store_get(edgeLabel,"$edgeLabel",$$stores),$edgeName=()=>store_get(edgeName,"$edgeName",$$stores),$edgeDescription=()=>store_get(edgeDescription,"$edgeDescription",$$stores),$edgeType=()=>store_get(edgeType,"$edgeType",$$stores),$showEdgeEditor=()=>store_get(showEdgeEditor,"$showEdgeEditor",$$stores),$showSearchEditor=()=>store_get(showSearchEditor,"$showSearchEditor",$$stores),$searchDocuments=()=>store_get(searchDocuments,"$searchDocuments",$$stores);cytoscape$1.use(cola);let cyInstance,chartCanvas=mutable_state(),edgeCounter=0,miniSearch;function handleDragStart(n,t){n.dataTransfer.setData("nodeType",JSON.stringify(t))}function handleDrop(n){if(n.preventDefault(),n.dataTransfer.getData("nodeType")){const r=JSON.parse(n.dataTransfer.getData("nodeType")),o=document.getElementsByClassName("cy-container")[0].getBoundingClientRect(),u=n.clientX-o.left,s=n.clientY-o.top,c=cyInstance.zoom(),l=cyInstance.pan(),d=(u-l.x)/c,f=(s-l.y)/c,h={group:"nodes",data:{id:`${r.id}-${Date.now()}`,label:r.label,name:r.label,description:r.description,color:r.id=="class"?domains[0].color:r.color,type:r.id,domain:r.id=="class"?domains[0].id:""},position:{x:d,y:f}};store_mutate(data$2,untrack($data).nodes=[...$data().nodes,h],untrack($data)),cyInstance.add(h),addDoc(h.data)}}function handleDragOver(n){n.preventDefault()}function newGraph(){store_set(data$2,{nodes:[],edges:[]}),cyInstance=cytoscape$1({container:get$4(chartCanvas),elements:$data(),style:config.cytoscapeConfig.style,layout:config.cytoscapeConfig.layout,wheelSensitivity:.05,minZoom:.1,maxZoom:10,zoom:1}),setTimeout(()=>{injectStyles(),cyInstance.resize(),cyInstance.fit()},100);var n=250,t;cyInstance.on("doubleTap",function(r,a){var o=r.target;o.constructor.name=="Core2"?console.log("double tap on canvas"):o.isNode()?(console.log("double tap on node ",o.data()),store_set(selectedNode,o),$selectedNode().select(),store_set(nodeLabel,$selectedNode().data("label")),store_set(nodeName,$selectedNode().data("name")),store_set(nodeDescription,$selectedNode().data("description")),store_set(nodeColor,$selectedNode().data("color")),store_set(nodeDomain,$selectedNode().data("domain")),store_set(nodeFlags,$selectedNode().data("flags")),store_set(nodeType,$selectedNode().data("type")),store_set(nodeRestrictions,$selectedNode().data("restrictions")),store_set(showNodeEditor,!0),store_set(selectedSourceNode,null)):o.isEdge()&&(console.log("double tap on edge ",o.data()),store_set(selectedEdge,o),store_set(edgeLabel,$selectedEdge().data("label")),store_set(edgeName,$selectedEdge().data("name")),store_set(edgeDescription,$selectedEdge().data("description")),store_set(edgeColor,$selectedEdge().data("color")),store_set(edgeType,$selectedEdge().data("type")),store_set(edgeFlags,$selectedEdge().data("flags")),store_set(edgeRestrictions,$selectedEdge().data("restrictions")),store_set(showEdgeEditor,!0))}),cyInstance.on("tap",r=>{var a=r.timeStamp,o=a-t;if(o<n)r.target.trigger("doubleTap",r);else{var u=r.target;if(u.constructor.name=="Core2")console.log("tap on canvas"),store_set(selectedNode,null),store_set(selectedSourceNode,null);else if(u.isNode())if(console.log("tap on node ",u.data()),!$selectedSourceNode())store_set(selectedSourceNode,u);else{let s=computeEdgeType($selectedSourceNode(),u);if(s==null){console.log("i due nodi non possono essere collegati"),store_set(selectedNode,null),store_set(selectedSourceNode,null);return}if(s.type=="connection"&&$selectedSourceNode().data("type")=="class"&&u.data("type")=="dt-property"&&u.connectedEdges().length>0){console.log("una property non pu essere collegata a due nodi"),store_set(selectedNode,null),store_set(selectedSourceNode,null);return}store_set(edgeType,s.type),store_set(edgeLabel,s.label);const c=cyInstance.edges().filter(d=>d.data("source")===$selectedSourceNode().id()&&d.data("target")===u.id()&&d.data("type")===$edgeType()||d.data("source")===u.id()&&d.data("target")===$selectedSourceNode().id()&&d.data("type")===$edgeType());if(($edgeType()==="connection"||$edgeType()==="subclass"||$edgeType()==="compose"||$edgeType()==="equivalence")&&c.length>0){console.log("Arco di tipo "+$edgeType()+" gi esistente tra i due nodi"),store_set(selectedNode,null),store_set(selectedSourceNode,null);return}let l={group:"edges",data:{id:`edge-${$selectedSourceNode().id()}-${u.id()}-${edgeCounter++}`,source:$selectedSourceNode().id(),target:u.id(),label:$edgeLabel(),name:$edgeName(),sourcelabel:"",targetlabel:"",description:$edgeDescription(),color:"#bbbbbb",type:$edgeType()}};store_mutate(data$2,untrack($data).edges=[...$data().edges,l],untrack($data)),cyInstance.add(l),addDoc(l.data),store_set(selectedSourceNode,null)}else u.isEdge()&&console.log("tap on edge ",u.data())}t=a})}onMount(async()=>{miniSearch=new MiniSearch({fields:["label","name","description"],storeFields:["label","name","type"]}),newGraph()});function getNodeType(n){return cyInstance.getElementById(n).data("type")}function injectStyles(){const n=document.createElement("style");n.innerHTML=`
    .cy-container > div {
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      overflow: hidden !important;
    }
    canvas {
      width: 100% !important;
      height: 100% !important;
      position: absolute !important;
      top: 0;
      left: 0;
    }
  `,document.head.appendChild(n)}function centerNode(n){let t=cyInstance.$(`#${n}`);t.length>0&&(t.position(),cyInstance.animate({center:{eles:t},zoom:1.5,duration:500}))}const addDoc=n=>{miniSearch.has(n.id)?(miniSearch.replace(n),store_set(searchDocuments,$searchDocuments().filter(t=>t.id!=n.id)),$searchDocuments().push(n)):(miniSearch.add(n),n.visible=!0,$searchDocuments().push(n))},delDoc=n=>{console.log("delDoc",n.id),miniSearch.has(n.id)?(miniSearch.remove(n),store_set(searchDocuments,$searchDocuments().filter(t=>t.id!=n.id))):console.log("not found")},searchDoc=n=>miniSearch.search(n,{fuzzy:.2}).slice(0,10);init$2();var main=root$1(),div=child(main),div_1=child(div);each$g(div_1,5,()=>config.nodeTypes,index,(n,t,r,a)=>{var o=root_1(),u=child(o);template_effect(()=>{set_attribute(o,"style",`background-color: ${get$4(t).color??""};`),set_attribute(u,"src",get$4(t).icon),set_attribute(u,"alt",get$4(t).label),set_attribute(u,"title",get$4(t).label)}),event$1("dragstart",o,s=>handleDragStart(s,get$4(t))),append(n,o)});var div_3=sibling(div_1,2);each$g(div_3,5,()=>config.toolTypes,index,($$anchor,toolType)=>{var button=root_2(),event_handler=derived(()=>eval(get$4(toolType).onclick)),img_1=child(button);template_effect(()=>{set_attribute(button,"style",`background-color: ${get$4(toolType).color??""};`),set_attribute(img_1,"src",get$4(toolType).icon),set_attribute(img_1,"alt",get$4(toolType).label),set_attribute(img_1,"title",get$4(toolType).label)}),event$1("click",button,function(...n){var t;(t=get$4(event_handler))==null||t.apply(this,n)}),append($$anchor,button)});var div_4=sibling(div_3,2);bind_this(div_4,n=>set$4(chartCanvas,n),()=>get$4(chartCanvas));var node=sibling(div,2);{var consequent=n=>{NodeEditor(n,{addDoc,delDoc})};if_block(node,n=>{$showNodeEditor()&&n(consequent)})}var node_1=sibling(node,2);{var consequent_1=n=>{EdgeEditor(n,{getNodeType,addDoc,delDoc})};if_block(node_1,n=>{$showEdgeEditor()&&n(consequent_1)})}var node_2=sibling(node_1,2);{var consequent_2=n=>{SearchEditor(n,{centerNode,searchDoc})};if_block(node_2,n=>{$showSearchEditor()&&n(consequent_2)})}event$1("drop",div_4,handleDrop),event$1("dragover",div_4,handleDragOver),append($$anchor,main),pop$1(),$$cleanup()}var root=template('<main><!> <p class="read-the-docs svelte-cjkinp">2025 - DDP</p></main>');function App(n,t){push$2(t,!1),onMount(async()=>{}),init$2();var r=root(),a=child(r);DiagramEditor(a,{}),append(n,r),pop$1()}mount(App,{target:document.getElementById("app")});
